# üîç Code Review - 12/9/2025, 7:11:21 AM

**Project:** AI Visual Code Review
**Generated by:** AI Visual Code Review v2.0

## üìä Change Summary

```
AI_REVIEW.md                         | 11664 +++++----------------------------
 codebase_audit/migration_analysis.md |    21 +
 index.html                           |    35 -
 package-lock.json                    |  1416 +++-
 package.json                         |     7 +-
 script.js                            |    89 +-
 6 files changed, 3073 insertions(+), 10159 deletions(-)
```

## üìù Files Changed (6/6 selected)


### üìÑ `AI_REVIEW.md`

**Type:** Documentation üìñ

```diff
@@ -1,4 +1,4 @@
  1     -# üîç Code Review - 12/9/2025, 7:04:12 AM
      1 +# üîç Code Review - 12/9/2025, 7:05:49 AM
  2   2  
  3   3  **Project:** AI Visual Code Review
  4   4  **Generated by:** AI Visual Code Review v2.0
@@ -6,8503 +6,16 @@
  6   6  ## üìä Change Summary
  7   7  
  8   8  ```
  9     -.agent/workflows/code-change-workflow.md |   13 +
 10     - AI_REVIEW.md                             | 8282 +++++++++++++++++-------------
 11     - package-lock.json                        |   17 +
 12     - package.json                             |    1 +
 13     - script.js                                | 1454 +++---
 14     - 5 files changed, 5530 insertions(+), 4237 deletions(-)
      9 +AI_REVIEW.md | 14895 ++++++++++++++++++++++++++++++++++++++-------------------
     10 + script.js    |  1463 +++---
     11 + 2 files changed, 10790 insertions(+), 5568 deletions(-)
 15  12  ```
 16  13  
 17     -## üìù Files Changed (5/5 selected)
     14 +## üìù Files Changed (1/2 selected)
 18  15  
 19     -
 20     -### ‚ú® `.agent/workflows/code-change-workflow.md` **[ADDED]**
 21     -
 22     -**Status:** ‚úÖ **NEW FILE** - This file has been newly created
 23     -
 24     -**Type:** Documentation üìñ
 25     -
 26     -```diff
 27     -@@ -0,0 +1,13 @@
 28     -      1 +---
 29     -      2 +description: Standard process for making code changes with AI review validation
 30     -      3 +---
 31     -      4 +
 32     -      5 +# Code Change Process
 33     -      6 +
 34     -      7 +1. **Make Code Changes**: Apply fixes or new features.
 35     -      8 +2. **Stage Changes**: `git add .`
 36     -      9 +3. **AI Validation**: `npx ai-review quick`
 37     -     10 +4. **Self/User Review**: Read `AI_REVIEW.md` and verify changes.
 38     -     11 +5. **Fix Issues**: If review finds issues, repeat steps 1-4.
 39     -     12 +6. **Commit**: Only commit after a passing review.
 40     -     13 +   `git commit -m "feat: description"`
 41     -     14  
 42     -
 43     -```
 44     -
 45     -
 46     -### üìÑ `AI_REVIEW.md`
 47     -
 48     -**Type:** Documentation üìñ
 49     -
 50     -```diff
 51     -@@ -1,4 +1,4 @@
 52     -  1     -# üîç Code Review - 12/7/2025, 9:59:24 AM
 53     -      1 +# üîç Code Review - 12/9/2025, 7:02:00 AM
 54     -  2   2  
 55     -  3   3  **Project:** AI Visual Code Review
 56     -  4   4  **Generated by:** AI Visual Code Review v2.0
 57     -@@ -6,28 +6,23 @@
 58     -  6   6  ## üìä Change Summary
 59     -  7   7  
 60     -  8   8  ```
 61     -  9     -AI_REVIEW.md                                       | 428 +++++++++++++++++----
 62     - 10     - docs/02-architecture/mermaid-theme-architecture.md | 208 ++++++++++
 63     - 11     - docs/02-architecture/prism-token-architecture.md   | 226 +++++++++++
 64     - 12     - script.js                                          |  52 ++-
 65     - 13     - src/js/services/MermaidService.js                  | 230 +++++++++--
 66     - 14     - style.css                                          | 147 ++++---
 67     - 15     - themes/default-dark.css                            | 186 ++++++++-
 68     - 16     - themes/default-light.css                           | 186 ++++++++-
 69     - 17     - themes/forest-dark.css                             | 167 ++++++--
 70     - 18     - themes/forest-light.css                            | 138 ++++++-
 71     - 19     - themes/neon-dark.css                               | 166 ++++++--
 72     - 20     - themes/neon-light.css                              | 138 ++++++-
 73     - 21     - themes/obsidian-dark.css                           | 138 ++++++-
 74     - 22     - themes/obsidian-light.css                          | 138 ++++++-
 75     - 23     - themes/ocean-dark.css                              | 138 ++++++-
 76     - 24     - themes/ocean-light.css                             | 138 ++++++-
 77     - 25     - themes/sunset-dark.css                             | 138 ++++++-
 78     - 26     - themes/sunset-light.css                            | 138 ++++++-
 79     - 27     - 18 files changed, 2762 insertions(+), 338 deletions(-)
 80     -      9 +AI_REVIEW.md                                       | 3926 ++++++++++++++++++--
 81     -     10 + codebase_audit/audit_summary.md                    |   49 +
 82     -     11 + .../deep_dive_reviews/mermaid_service_review.md    |   47 +
 83     -     12 + .../deep_dive_reviews/script_js_review.md          |  121 +
 84     -     13 + .../deep_dive_reviews/theme_manager_review.md      |   53 +
 85     -     14 + codebase_audit/docs_summary.json                   |   12 +
 86     -     15 + codebase_audit/future_enhancements_roadmap.md      |   87 +
 87     -     16 + codebase_audit/phase3_codebase_review.json         |   68 +
 88     -     17 + codebase_audit/phase4_consolidated_findings.md     |   31 +
 89     -     18 + codebase_audit/phase4_implementation_plan.md       |   71 +
 90     -     19 + codebase_audit/phase5_recommendations.md           |   41 +
 91     -     20 + codebase_audit/phase6_final_deliverables.md        |   44 +
 92     -     21 + codebase_audit/repo_manifest.json                  |   74 +
 93     -     22 + 13 files changed, 4282 insertions(+), 342 deletions(-)
 94     - 28  23  ```
 95     - 29  24  
 96     - 30     -## üìù Files Changed (18/18 selected)
 97     -     25 +## üìù Files Changed (13/13 selected)
 98     - 31  26  
 99     - 32  27  
100     - 33  28  ### üìÑ `AI_REVIEW.md`
101     -@@ -36,3588 +31,4827 @@ AI_REVIEW.md                                       | 428 +++++++++++++++++----
102     - 36  31  
103     - 37  32  ```diff
104     - 38  33  @@ -1,4 +1,4 @@
105     - 39     -  1     -# üîç Code Review - 12/7/2025, 4:25:31 AM
106     - 40     -      1 +# üîç Code Review - 12/7/2025, 8:27:20 AM
107     -     34 +  1     -# üîç Code Review - 12/7/2025, 8:27:20 AM
108     -     35 +      1 +# üîç Code Review - 12/7/2025, 9:59:24 AM
109     - 41  36    2   2  
110     - 42  37    3   3  **Project:** AI Visual Code Review
111     - 43  38    4   4  **Generated by:** AI Visual Code Review v2.0
112     - 44     -@@ -6,38 +6,80 @@
113     -     39 +@@ -6,80 +6,953 @@
114     - 45  40    6   6  ## üìä Change Summary
115     - 46  41    7   7  
116     - 47  42    8   8  ```
117     - 48     -  9     -index.html | 11 +++++++++++
118     - 49     - 10     - script.js  | 21 ++++++++++++++++++++-
119     - 50     - 11     - 2 files changed, 31 insertions(+), 1 deletion(-)
120     - 51     -      9 +memory-bank/activeContext.md |  52 +++++++++-
121     - 52     -     10 + script.js                    | 231 +++++--------------------------------------
122     - 53     -     11 + themes/sunset-dark.css       |   2 +-
123     - 54     -     12 + 3 files changed, 75 insertions(+), 210 deletions(-)
124     - 55     - 12  13  ```
125     - 56     - 13  14  
126     - 57     - 14     -## üìù Files Changed (2/2 selected)
127     - 58     -     15 +## üìù Files Changed (3/3 selected)
128     - 59     - 15  16  
129     - 60     - 16  17  
130     - 61     - 17     -### üìÑ `index.html`
131     - 62     -     18 +### üìÑ `memory-bank/activeContext.md`
132     - 63     - 18  19  
133     - 64     - 19     -**Type:** HTML Template üåê
134     - 65     -     20 +**Type:** Documentation üìñ
135     - 66     - 20  21  
136     - 67     - 21  22  ```diff
137     - 68     - 22     -@@ -55,6 +55,17 @@
138     - 69     - 23     - 55  55              üìÅ Open Folder
139     - 70     - 24     - 56  56            </button>
140     - 71     - 25     - 57  57  
141     - 72     - 26     -     58 +          <!-- Collapse/Expand Sidebar -->
142     - 73     - 27     -     59 +          <button
143     - 74     - 28     -     60 +            class="btn"
144     - 75     - 29     -     61 +            id="toggle-sidebar-btn"
145     - 76     - 30     -     62 +            title="Toggle File Browser"
146     - 77     - 31     -     63 +            aria-label="Toggle File Browser Sidebar"
147     - 78     - 32     -     64 +            style="display: none"
148     - 79     - 33     -     65 +          >
149     - 80     - 34     -     66 +            ‚óÄ Hide Files
150     - 81     - 35     -     67 +          </button>
151     - 82     - 36     -     68 +
152     - 83     - 37     - 58  69            <!-- View Mode Buttons -->
153     - 84     - 38     - 59  70            <div class="view-mode-buttons">
154     - 85     - 39     - 60  71              <button
155     - 86     - 40     - 61  72  
156     - 87     -     23 +@@ -202,7 +202,57 @@ html = restoreLatexEnvironments(html);
157     - 88     -     24 +202 202  
158     - 89     -     25 +203 203  ## Open Questions
159     - 90     -     26 +204 204  
160     - 91     -     27 +205     -None - All LaTeX rendering issues resolved
161     - 92     -     28 +    205 +None - All issues resolved
162     - 93     -     29 +    206 +
163     - 94     -     30 +    207 +## Recent Fixes (Latest Session)
164     - 95     -     31 +    208 +
165     - 96     -     32 +    209 +### Theme Dropdown Sync Fix ‚úÖ
166     - 97     -     33 +    210 +
167     - 98     -     34 +    211 +**Problem:** Theme dropdown showing "Default Light" even when sunset-dark theme was loaded from LocalStorage.
168     - 99     -     35 +    212 +
169     -100     -     36 +    213 +**Root Cause:** Race condition in theme loading - dropdown was being set BEFORE async theme load completed.
170     -101     -     37 +    214 +
171     -102     -     38 +    215 +**Solution:**
172     -103     -     39 +    216 +
173     -104     -     40 +    217 +```javascript
174     -105     -     41 +    218 +// OLD (buggy):
175     -106     -     42 +    219 +if (savedTheme) {
176     -107     -     43 +    220 +  themeSelector.value = savedTheme; // Sets immediately
177     -108     -     44 +    221 +  themeManager.loadTheme(savedTheme); // Async, not awaited
178     -109     -     45 +    222 +}
179     -110     -     46 +    223 +
180     -111     -     47 +    224 +// NEW (fixed):
181     -112     -     48 +    225 +if (savedTheme) {
182     -113     -     49 +    226 +  themeManager
183     -114     -     50 +    227 +    .loadTheme(savedTheme)
184     -115     -     51 +    228 +    .then(() => {
185     -116     -     52 +    229 +      themeSelector.value = savedTheme; // Only after successful load
186     -117     -     53 +    230 +      console.log(`‚úÖ Theme restored: ${savedTheme}`);
187     -118     -     54 +    231 +    })
188     -119     -     55 +    232 +    .catch(err => {
189     -120     -     56 +    233 +      // Fallback with proper sync
190     -121     -     57 +    234 +      themeManager.loadTheme('default-light').then(() => {
191     -122     -     58 +    235 +        themeSelector.value = 'default-light';
192     -123     -     59 +    236 +      });
193     -124     -     60 +    237 +    });
194     -125     -     61 +    238 +}
195     -126     -     62 +    239 +```
196     -127     -     63 +    240 +
197     -128     -     64 +    241 +**Key Changes:**
198     -129     -     65 +    242 +
199     -130     -     66 +    243 +1. Await theme load completion before syncing dropdown
200     -131     -     67 +    244 +2. Added success callback for dropdown update
201     -132     -     68 +    245 +3. Added error handling with fallback
202     -133     -     69 +    246 +4. Added console logging for debugging
203     -134     -     70 +    247 +
204     -135     -     71 +    248 +**Results:**
205     -136     -     72 +    249 +
206     -137     -     73 +    250 +- ‚úÖ Dropdown now syncs correctly with all themes
207     -138     -     74 +    251 +- ‚úÖ No more race conditions
208     -139     -     75 +    252 +- ‚úÖ Proper error handling
209     -140     -     76 +    253 +- ‚úÖ Works for all 12 themes (6 theme families √ó 2 variants)
210     -141     -     77 +    254 +
211     -142     -     78 +    255 +**Files Modified:** `script.js` (lines 1167-1183)
212     -143     -     79 +206 256  
213     -144     -     80 +207 257  ## Performance Observations
214     -145     -     81 +208 258  
215     -146     -     82 +209 259  
216     -147     - 41  83  
217     -148     - 42  84  ```
218     -149     - 43  85  
219     -150     -@@ -47,51 +89,293 @@ index.html | 11 +++++++++++
220     -151     - 47  89  **Type:** JavaScript Source File üü®
221     -152     - 48  90  
222     -153     - 49  91  ```diff
223     -154     - 50     -@@ -796,6 +796,7 @@ graph TD
224     -155     - 51     -796 796    // Folder browser DOM elements
225     -156     - 52     -797 797    const fileBrowser = document.getElementById('file-browser');
226     -157     - 53     -798 798    const openFolderBtn = document.getElementById('open-folder-btn');
227     -158     - 54     -    799 +  const toggleSidebarBtn = document.getElementById('toggle-sidebar-btn');
228     -159     - 55     -799 800    const closeBrowserBtn = document.getElementById('close-browser-btn');
229     -160     - 56     -800 801    const fileTree = document.getElementById('file-tree');
230     -161     - 57     -801 802    const currentFolderNameEl = document.getElementById('current-folder-name');
231     -162     - 58     -@@ -804,6 +805,7 @@ graph TD
232     -163     - 59     -804 805    // Folder browser state (using let to allow reassignment)
233     -164     - 60     -805 806    let folderFiles = [];
234     -165     - 61     -806 807    let activeFileHandle = null;
235     -166     - 62     -    808 +  const sidebarCollapsed = false;
236     -167     - 63     -807 809  
237     -168     - 64     -808 810    // Open folder handler
238     -169     - 65     -809 811    openFolderBtn.addEventListener('click', async () => {
239     -170     - 66     -@@ -843,9 +845,26 @@ graph TD
240     -171     - 67     -843 845      console.log(`‚úÖ Loaded ${result.totalFiles} markdown files from ${result.folderName}`);
241     -172     - 68     -844 846    });
242     -173     - 69     -845 847  
243     -174     - 70     -846     -  // Close browser handler
244     -175     - 71     -    848 +  // Toggle sidebar collapse/expand
245     -176     - 72     -    849 +  toggleSidebarBtn.addEventListener('click', () => {
246     -177     - 73     -    850 +    if (fileBrowser.style.display === 'none') {
247     -178     - 74     -    851 +      // Expand sidebar
248     -179     - 75     -    852 +      fileBrowser.style.display = 'flex';
249     -180     - 76     -    853 +      toggleSidebarBtn.textContent = '‚óÄ Hide Files';
250     -181     - 77     -    854 +      toggleSidebarBtn.title = 'Hide File Browser';
251     -182     - 78     -    855 +    } else {
252     -183     - 79     -    856 +      // Collapse sidebar (keep data)
253     -184     - 80     -    857 +      fileBrowser.style.display = 'none';
254     -185     - 81     -    858 +      toggleSidebarBtn.textContent = '‚ñ∂ Show Files';
255     -186     - 82     -    859 +      toggleSidebarBtn.title = 'Show File Browser';
256     -187     - 83     -    860 +    }
257     -188     - 84     -    861 +  });
258     -189     - 85     -    862 +
259     -190     - 86     -    863 +  // Close browser handler (clears data)
260     -191     - 87     -847 864    closeBrowserBtn.addEventListener('click', () => {
261     -192     - 88     -848 865      fileBrowser.style.display = 'none';
262     -193     - 89     -    866 +    toggleSidebarBtn.style.display = 'none';
263     -194     - 90     -    867 +    openFolderBtn.style.display = 'inline-block';
264     -195     - 91     -849 868      folderFiles = [];
265     -196     - 92     -850 869      activeFileHandle = null;
266     -197     - 93     -851 870    });
267     -198     - 94     -852 871  
268     -199     -     92 +@@ -145,101 +145,10 @@ function configureMarkedExtensions() {
269     -200     -     93 +145 145      return;
270     -201     -     94 +146 146    }
271     -202     -     95 +147 147  
272     -203     -     96 +148     -  // Add LaTeX environment extensions
273     -204     -     97 +    148 +  // Add inline math and text formatting extensions only
274     -205     -     98 +    149 +  // LaTeX environments (align, gather, etc.) are not supported by KaTeX
275     -206     -     99 +149 150    marked.use({
276     -207     -    100 +150 151      extensions: [
277     -208     -    101 +151     -      {
278     -209     -    102 +152     -        name: 'latexEnvironment',
279     -210     -    103 +153     -        level: 'block',
280     -211     -    104 +154     -        start(src) {
281     -212     -    105 +155     -          return src.match(/^\\begin\{/)?.index;
282     -213     -    106 +156     -        },
283     -214     -    107 +157     -        tokenizer(src) {
284     -215     -    108 +158     -          const match = src.match(/^\\begin\{([^}]+)\}([\s\S]*?)\\end\{\1\}/);
285     -216     -    109 +159     -          if (match) {
286     -217     -    110 +160     -            return {
287     -218     -    111 +161     -              type: 'latexEnvironment',
288     -219     -    112 +162     -              raw: match[0],
289     -220     -    113 +163     -              text: match[0],
290     -221     -    114 +164     -            };
291     -222     -    115 +165     -          }
292     -223     -    116 +166     -        },
293     -224     -    117 +167     -        renderer(token) {
294     -225     -    118 +168     -          try {
295     -226     -    119 +169     -            const rendered = katex.renderToString(token.text, {
296     -227     -    120 +170     -              displayMode: true,
297     -228     -    121 +171     -              throwOnError: false,
298     -229     -    122 +172     -              trust: true,
299     -230     -    123 +173     -              strict: false,
300     -231     -    124 +174     -            });
301     -232     -    125 +175     -            return `<div class="katex-display">${rendered}</div>`;
302     -233     -    126 +176     -          } catch (e) {
303     -234     -    127 +177     -            console.warn('KaTeX environment render error:', e);
304     -235     -    128 +178     -            return `<div style="color: red; padding: 10px;">LaTeX Error: ${e.message}</div>`;
305     -236     -    129 +179     -          }
306     -237     -    130 +180     -        },
307     -238     -    131 +181     -      },
308     -239     -    132 +182     -      {
309     -240     -    133 +183     -        name: 'latexDisplayBracket',
310     -241     -    134 +184     -        level: 'block',
311     -242     -    135 +185     -        start(src) {
312     -243     -    136 +186     -          return src.match(/^\\\[/)?.index;
313     -244     -    137 +187     -        },
314     -245     -    138 +188     -        tokenizer(src) {
315     -246     -    139 +189     -          const match = src.match(/^\\\[([\s\S]*?)\\\]/);
316     -247     -    140 +190     -          if (match) {
317     -248     -    141 +191     -            return {
318     -249     -    142 +192     -              type: 'latexDisplayBracket',
319     -250     -    143 +193     -              raw: match[0],
320     -251     -    144 +194     -              text: match[1].trim(),
321     -252     -    145 +195     -            };
322     -253     -    146 +196     -          }
323     -254     -    147 +197     -        },
324     -255     -    148 +198     -        renderer(token) {
325     -256     -    149 +199     -          try {
326     -257     -    150 +200     -            const rendered = katex.renderToString(token.text, {
327     -258     -    151 +201     -              displayMode: true,
328     -259     -    152 +202     -              throwOnError: false,
329     -260     -    153 +203     -              trust: true,
330     -261     -    154 +204     -              strict: false,
331     -262     -    155 +205     -            });
332     -263     -    156 +206     -            return `<div class="katex-display">${rendered}</div>`;
333     -264     -    157 +207     -          } catch (e) {
334     -265     -    158 +208     -            console.warn('KaTeX bracket render error:', e);
335     -266     -    159 +209     -            return `<div style="color: red; padding: 10px;">LaTeX Error: ${e.message}</div>`;
336     -267     -    160 +210     -          }
337     -268     -    161 +211     -        },
338     -269     -    162 +212     -      },
339     -270     -    163 +213     -      {
340     -271     -    164 +214     -        name: 'latexInlineParen',
341     -272     -    165 +215     -        level: 'inline',
342     -273     -    166 +216     -        start(src) {
343     -274     -    167 +217     -          return src.match(/\\\(/)?.index;
344     -275     -    168 +218     -        },
345     -276     -    169 +219     -        tokenizer(src) {
346     -277     -    170 +220     -          const match = src.match(/^\\\(([\s\S]*?)\\\)/);
347     -278     -    171 +221     -          if (match) {
348     -279     -    172 +222     -            return {
349     -280     -    173 +223     -              type: 'latexInlineParen',
350     -281     -    174 +224     -              raw: match[0],
351     -282     -    175 +225     -              text: match[1].trim(),
352     -283     -    176 +226     -            };
353     -284     -    177 +227     -          }
354     -285     -    178 +228     -        },
355     -286     -    179 +229     -        renderer(token) {
356     -287     -    180 +230     -          try {
357     -288     -    181 +231     -            return katex.renderToString(token.text, {
358     -289     -    182 +232     -              displayMode: false,
359     -290     -    183 +233     -              throwOnError: false,
360     -291     -    184 +234     -              trust: true,
361     -292     -    185 +235     -              strict: false,
362     -293     -    186 +236     -            });
363     -294     -    187 +237     -          } catch (e) {
364     -295     -    188 +238     -            console.warn('KaTeX paren render error:', e);
365     -296     -    189 +239     -            return `<span style="color: red;">LaTeX Error</span>`;
366     -297     -    190 +240     -          }
367     -298     -    191 +241     -        },
368     -299     -    192 +242     -      },
369     -300     -    193 +243 152        {
370     -301     -    194 +244 153          name: 'mathBlock',
371     -302     -    195 +245 154          level: 'block',
372     -303     -    196 +@@ -503,101 +412,10 @@ graph TD
373     -304     -    197 +503 412      return textarea.value;
374     -305     -    198 +504 413    }
375     -306     -    199 +505 414  
376     -307     -    200 +506     -  // Add LaTeX environment extensions that render directly with KaTeX
377     -308     -    201 +    415 +  // Keep only subscript and superscript extensions
378     -309     -    202 +    416 +  // Remove LaTeX environment extensions that don't work with KaTeX
379     -310     -    203 +507 417    marked.use({
380     -311     -    204 +508 418      extensions: [
381     -312     -    205 +509     -      {
382     -313     -    206 +510     -        name: 'latexEnvironment',
383     -314     -    207 +511     -        level: 'block',
384     -315     -    208 +512     -        start(src) {
385     -316     -    209 +513     -          return src.match(/^\\begin\{/)?.index;
386     -317     -    210 +514     -        },
387     -318     -    211 +515     -        tokenizer(src) {
388     -319     -    212 +516     -          const match = src.match(/^\\begin\{([^}]+)\}([\s\S]*?)\\end\{\1\}/);
389     -320     -    213 +517     -          if (match) {
390     -321     -    214 +518     -            return {
391     -322     -    215 +519     -              type: 'latexEnvironment',
392     -323     -    216 +520     -              raw: match[0],
393     -324     -    217 +521     -              text: match[0],
394     -325     -    218 +522     -            };
395     -326     -    219 +523     -          }
396     -327     -    220 +524     -        },
397     -328     -    221 +525     -        renderer(token) {
398     -329     -    222 +526     -          try {
399     -330     -    223 +527     -            const rendered = katex.renderToString(token.text, {
400     -331     -    224 +528     -              displayMode: true,
401     -332     -    225 +529     -              throwOnError: false,
402     -333     -    226 +530     -              trust: true,
403     -334     -    227 +531     -              strict: false,
404     -335     -    228 +532     -            });
405     -336     -    229 +533     -            return `<div class="katex-display">${rendered}</div>`;
406     -337     -    230 +534     -          } catch (e) {
407     -338     -    231 +535     -            console.warn('KaTeX environment render error:', e);
408     -339     -    232 +536     -            return `<div style="color: red; padding: 10px;">LaTeX Error: ${e.message}</div>`;
409     -340     -    233 +537     -          }
410     -341     -    234 +538     -        },
411     -342     -    235 +539     -      },
412     -343     -    236 +540     -      {
413     -344     -    237 +541     -        name: 'latexDisplayBracket',
414     -345     -    238 +542     -        level: 'block',
415     -346     -    239 +543     -        start(src) {
416     -347     -    240 +544     -          return src.match(/^\\\[/)?.index;
417     -348     -    241 +545     -        },
418     -349     -    242 +546     -        tokenizer(src) {
419     -350     -    243 +547     -          const match = src.match(/^\\\[([\s\S]*?)\\\]/);
420     -351     -    244 +548     -          if (match) {
421     -352     -    245 +549     -            return {
422     -353     -    246 +550     -              type: 'latexDisplayBracket',
423     -354     -    247 +551     -              raw: match[0],
424     -355     -    248 +552     -              text: match[1].trim(),
425     -356     -    249 +553     -            };
426     -357     -    250 +554     -          }
427     -358     -    251 +555     -        },
428     -359     -    252 +556     -        renderer(token) {
429     -360     -    253 +557     -          try {
430     -361     -    254 +558     -            const rendered = katex.renderToString(token.text, {
431     -362     -    255 +559     -              displayMode: true,
432     -363     -    256 +560     -              throwOnError: false,
433     -364     -    257 +561     -              trust: true,
434     -365     -    258 +562     -              strict: false,
435     -366     -    259 +563     -            });
436     -367     -    260 +564     -            return `<div class="katex-display">${rendered}</div>`;
437     -368     -    261 +565     -          } catch (e) {
438     -369     -    262 +566     -            console.warn('KaTeX bracket render error:', e);
439     -370     -    263 +567     -            return `<div style="color: red; padding: 10px;">LaTeX Error: ${e.message}</div>`;
440     -371     -    264 +568     -          }
441     -372     -    265 +569     -        },
442     -373     -    266 +570     -      },
443     -374     -    267 +571     -      {
444     -375     -    268 +572     -        name: 'latexInlineParen',
445     -376     -    269 +573     -        level: 'inline',
446     -377     -    270 +574     -        start(src) {
447     -378     -    271 +575     -          return src.match(/\\\(/)?.index;
448     -379     -    272 +576     -        },
449     -380     -    273 +577     -        tokenizer(src) {
450     -381     -    274 +578     -          const match = src.match(/^\\\(([\s\S]*?)\\\)/);
451     -382     -    275 +579     -          if (match) {
452     -383     -    276 +580     -            return {
453     -384     -    277 +581     -              type: 'latexInlineParen',
454     -385     -    278 +582     -              raw: match[0],
455     -386     -    279 +583     -              text: match[1].trim(),
456     -387     -    280 +584     -            };
457     -388     -    281 +585     -          }
458     -389     -    282 +586     -        },
459     -390     -    283 +587     -        renderer(token) {
460     -391     -    284 +588     -          try {
461     -392     -    285 +589     -            return katex.renderToString(token.text, {
462     -393     -    286 +590     -              displayMode: false,
463     -394     -    287 +591     -              throwOnError: false,
464     -395     -    288 +592     -              trust: true,
465     -396     -    289 +593     -              strict: false,
466     -397     -    290 +594     -            });
467     -398     -    291 +595     -          } catch (e) {
468     -399     -    292 +596     -            console.warn('KaTeX paren render error:', e);
469     -400     -    293 +597     -            return `<span style="color: red;">LaTeX Error</span>`;
470     -401     -    294 +598     -          }
471     -402     -    295 +599     -        },
472     -403     -    296 +600     -      },
473     -404     -    297 +601 419        {
474     -405     -    298 +602 420          name: 'subscript',
475     -406     -    299 +603 421          level: 'inline',
476     -407     -    300 +@@ -641,7 +459,7 @@ graph TD
477     -408     -    301 +641 459      ],
478     -409     -    302 +642 460    });
479     -410     -    303 +643 461  
480     -411     -    304 +644     -  console.log('‚úÖ LaTeX environments, subscript, and superscript enabled');
481     -412     -    305 +    462 +  console.log('‚úÖ Subscript and superscript enabled (LaTeX environments display as-is)');
482     -413     -    306 +645 463  
483     -414     -    307 +646 464    // Render markdown
484     -415     -    308 +647 465    function renderMarkdown() {
485     -416     -    309 +@@ -685,22 +503,9 @@ graph TD
486     -417     -    310 +685 503        // Apply Prism syntax highlighting using PrismService
487     -418     -    311 +686 504        prismService.highlightAll(preview);
488     -419     -    312 +687 505  
489     -420     -    313 +688     -      // Apply KaTeX auto-render only for any remaining $...$ syntax
490     -421     -    314 +689     -      if (typeof renderMathInElement !== 'undefined') {
491     -422     -    315 +690     -        try {
492     -423     -    316 +691     -          renderMathInElement(preview, {
493     -424     -    317 +692     -            delimiters: [
494     -425     -    318 +693     -              { left: '$$', right: '$$', display: true },
495     -426     -    319 +694     -              { left: '$', right: '$', display: false },
496     -427     -    320 +695     -            ],
497     -428     -    321 +696     -            throwOnError: false,
498     -429     -    322 +697     -            trust: true,
499     -430     -    323 +698     -            strict: false,
500     -431     -    324 +699     -          });
501     -432     -    325 +700     -        } catch (e) {
502     -433     -    326 +701     -          console.warn('KaTeX auto-render error:', e);
503     -434     -    327 +702     -        }
504     -435     -    328 +703     -      }
505     -436     -    329 +    506 +      // NOTE: KaTeX auto-render is DISABLED
506     -437     -    330 +    507 +      // We handle all math via marked.js extensions ($...$ and $$...$$)
507     -438     -    331 +    508 +      // KaTeX auto-render was causing issues with unsupported LaTeX environments
508     -439     -    332 +704 509  
509     -440     -    333 +705 510        // Save content using StorageManager
510     -441     -    334 +706 511        storageManager.set('markdownContent', markdownText);
511     -442     -    335 +@@ -1167,11 +972,21 @@ graph TD
512     -443     -    336 +1167 972    // Load saved theme using ThemeManager
513     -444     -    337 +1168 973    const savedTheme = storageManager.get('selectedTheme');
514     -445     -    338 +1169 974    if (savedTheme) {
515     -446     -    339 +1170     -    themeSelector.value = savedTheme;
516     -447     -    340 +1171     -    themeManager.loadTheme(savedTheme).catch(err => {
517     -448     -    341 +1172     -      console.error('Failed to load saved theme:', err);
518     -449     -    342 +1173     -      themeManager.loadTheme('default-light');
519     -450     -    343 +1174     -    });
520     -451     -    344 +    975 +    // Load theme first, then sync dropdown only on success
521     -452     -    345 +    976 +    themeManager
522     -453     -    346 +    977 +      .loadTheme(savedTheme)
523     -454     -    347 +    978 +      .then(() => {
524     -455     -    348 +    979 +        // Theme loaded successfully - sync dropdown
525     -456     -    349 +    980 +        themeSelector.value = savedTheme;
526     -457     -    350 +    981 +        console.log(`‚úÖ Theme restored: ${savedTheme}`);
527     -458     -    351 +    982 +      })
528     -459     -    352 +    983 +      .catch(err => {
529     -460     -    353 +    984 +        console.error('Failed to load saved theme:', err);
530     -461     -    354 +    985 +        // Fallback to default-light on error
531     -462     -    355 +    986 +        themeManager.loadTheme('default-light').then(() => {
532     -463     -    356 +    987 +          themeSelector.value = 'default-light';
533     -464     -    357 +    988 +        });
534     -465     -    358 +    989 +      });
535     -466     -    359 +1175 990    }
536     -467     -    360 +1176 991  
537     -468     -    361 +1177 992    // Zoom functionality
538     -469     -    362 +1178 993  
539     -470     -    363 +
540     -471     -    364 +```
541     -472     -    365 +
542     -473     -    366 +
543     -474     -    367 +### üìÑ `themes/sunset-dark.css`
544     -475     -    368 +
545     -476     -    369 +**Type:** Stylesheet üé®
546     -477     -    370 +
547     -478     -    371 +```diff
548     -479     -    372 +@@ -1,4 +1,4 @@
549     -480     -    373 +  1     -r/* Sunset Dark Theme */
550     -481     -    374 +      1 +/* Sunset Dark Theme */
551     -482     -    375 +  2   2  :root {
552     -483     -    376 +  3   3    --bg-primary: #1c0a00;
553     -484     -    377 +  4   4    --bg-secondary: #2d1b0e;
554     -485     -    378 +  5   5  
555     -486     - 95 379  
556     -487     - 96 380  ```
557     -488     - 97 381  
558     -489     -@@ -137,4 +421,4 @@ Please provide specific feedback on:
559     -490     -137 421  
560     -491     -138 422  ---
561     -492     -139 423  *Generated by AI Visual Code Review v2.0 - Unified Export Script*
562     -493     -140     -*Files processed: 2/2 | Errors: 0 | Generated: 2025-12-06T22:55:31.083Z*
563     -494     -    424 +*Files processed: 3/3 | Errors: 0 | Generated: 2025-12-07T02:57:20.361Z*
564     -495     -141 425  
565     -     43 +  9     -memory-bank/activeContext.md |  52 +++++++++-
566     -     44 + 10     - script.js                    | 231 +++++--------------------------------------
567     -     45 + 11     - themes/sunset-dark.css       |   2 +-
568     -     46 + 12     - 3 files changed, 75 insertions(+), 210 deletions(-)
569     -     47 +      9 +AI_REVIEW.md                                       | 428 +++++++++++++++++----
570     -     48 +     10 + docs/02-architecture/mermaid-theme-architecture.md | 208 ++++++++++
571     -     49 +     11 + docs/02-architecture/prism-token-architecture.md   | 226 +++++++++++
572     -     50 +     12 + script.js                                          |  52 ++-
573     -     51 +     13 + src/js/services/MermaidService.js                  | 230 +++++++++--
574     -     52 +     14 + style.css                                          | 147 ++++---
575     -     53 +     15 + themes/default-dark.css                            | 186 ++++++++-
576     -     54 +     16 + themes/default-light.css                           | 186 ++++++++-
577     -     55 +     17 + themes/forest-dark.css                             | 167 ++++++--
578     -     56 +     18 + themes/forest-light.css                            | 138 ++++++-
579     -     57 +     19 + themes/neon-dark.css                               | 166 ++++++--
580     -     58 +     20 + themes/neon-light.css                              | 138 ++++++-
581     -     59 +     21 + themes/obsidian-dark.css                           | 138 ++++++-
582     -     60 +     22 + themes/obsidian-light.css                          | 138 ++++++-
583     -     61 +     23 + themes/ocean-dark.css                              | 138 ++++++-
584     -     62 +     24 + themes/ocean-light.css                             | 138 ++++++-
585     -     63 +     25 + themes/sunset-dark.css                             | 138 ++++++-
586     -     64 +     26 + themes/sunset-light.css                            | 138 ++++++-
587     -     65 +     27 + 18 files changed, 2762 insertions(+), 338 deletions(-)
588     -     66 + 13  28  ```
589     -     67 + 14  29  
590     -     68 + 15     -## üìù Files Changed (3/3 selected)
591     -     69 +     30 +## üìù Files Changed (18/18 selected)
592     -     70 + 16  31  
593     -     71 + 17  32  
594     -     72 + 18     -### üìÑ `memory-bank/activeContext.md`
595     -     73 +     33 +### üìÑ `AI_REVIEW.md`
596     -     74 + 19  34  
597     -     75 + 20  35  **Type:** Documentation üìñ
598     -     76 + 21  36  
599     -     77 + 22  37  ```diff
600     -     78 + 23     -@@ -202,7 +202,57 @@ html = restoreLatexEnvironments(html);
601     -     79 + 24     -202 202  
602     -     80 + 25     -203 203  ## Open Questions
603     -     81 + 26     -204 204  
604     -     82 + 27     -205     -None - All LaTeX rendering issues resolved
605     -     83 + 28     -    205 +None - All issues resolved
606     -     84 +     38 +@@ -1,4 +1,4 @@
607     -     85 +     39 +  1     -# üîç Code Review - 12/7/2025, 4:25:31 AM
608     -     86 +     40 +      1 +# üîç Code Review - 12/7/2025, 8:27:20 AM
609     -     87 +     41 +  2   2  
610     -     88 +     42 +  3   3  **Project:** AI Visual Code Review
611     -     89 +     43 +  4   4  **Generated by:** AI Visual Code Review v2.0
612     -     90 +     44 +@@ -6,38 +6,80 @@
613     -     91 +     45 +  6   6  ## üìä Change Summary
614     -     92 +     46 +  7   7  
615     -     93 +     47 +  8   8  ```
616     -     94 +     48 +  9     -index.html | 11 +++++++++++
617     -     95 +     49 + 10     - script.js  | 21 ++++++++++++++++++++-
618     -     96 +     50 + 11     - 2 files changed, 31 insertions(+), 1 deletion(-)
619     -     97 +     51 +      9 +memory-bank/activeContext.md |  52 +++++++++-
620     -     98 +     52 +     10 + script.js                    | 231 +++++--------------------------------------
621     -     99 +     53 +     11 + themes/sunset-dark.css       |   2 +-
622     -    100 +     54 +     12 + 3 files changed, 75 insertions(+), 210 deletions(-)
623     -    101 +     55 + 12  13  ```
624     -    102 +     56 + 13  14  
625     -    103 +     57 + 14     -## üìù Files Changed (2/2 selected)
626     -    104 +     58 +     15 +## üìù Files Changed (3/3 selected)
627     -    105 +     59 + 15  16  
628     -    106 +     60 + 16  17  
629     -    107 +     61 + 17     -### üìÑ `index.html`
630     -    108 +     62 +     18 +### üìÑ `memory-bank/activeContext.md`
631     -    109 +     63 + 18  19  
632     -    110 +     64 + 19     -**Type:** HTML Template üåê
633     -    111 +     65 +     20 +**Type:** Documentation üìñ
634     -    112 +     66 + 20  21  
635     -    113 +     67 + 21  22  ```diff
636     -    114 +     68 + 22     -@@ -55,6 +55,17 @@
637     -    115 +     69 + 23     - 55  55              üìÅ Open Folder
638     -    116 +     70 + 24     - 56  56            </button>
639     -    117 +     71 + 25     - 57  57  
640     -    118 +     72 + 26     -     58 +          <!-- Collapse/Expand Sidebar -->
641     -    119 +     73 + 27     -     59 +          <button
642     -    120 +     74 + 28     -     60 +            class="btn"
643     -    121 +     75 + 29     -     61 +            id="toggle-sidebar-btn"
644     -    122 +     76 + 30     -     62 +            title="Toggle File Browser"
645     -    123 +     77 + 31     -     63 +            aria-label="Toggle File Browser Sidebar"
646     -    124 +     78 + 32     -     64 +            style="display: none"
647     -    125 +     79 + 33     -     65 +          >
648     -    126 +     80 + 34     -     66 +            ‚óÄ Hide Files
649     -    127 +     81 + 35     -     67 +          </button>
650     -    128 +     82 + 36     -     68 +
651     -    129 +     83 + 37     - 58  69            <!-- View Mode Buttons -->
652     -    130 +     84 + 38     - 59  70            <div class="view-mode-buttons">
653     -    131 +     85 + 39     - 60  71              <button
654     -    132 +     86 + 40     - 61  72  
655     -    133 +     87 +     23 +@@ -202,7 +202,57 @@ html = restoreLatexEnvironments(html);
656     -    134 +     88 +     24 +202 202  
657     -    135 +     89 +     25 +203 203  ## Open Questions
658     -    136 +     90 +     26 +204 204  
659     -    137 +     91 +     27 +205     -None - All LaTeX rendering issues resolved
660     -    138 +     92 +     28 +    205 +None - All issues resolved
661     -    139 +     93 +     29 +    206 +
662     -    140 +     94 +     30 +    207 +## Recent Fixes (Latest Session)
663     -    141 +     95 +     31 +    208 +
664     -    142 +     96 +     32 +    209 +### Theme Dropdown Sync Fix ‚úÖ
665     -    143 +     97 +     33 +    210 +
666     -    144 +     98 +     34 +    211 +**Problem:** Theme dropdown showing "Default Light" even when sunset-dark theme was loaded from LocalStorage.
667     -    145 +     99 +     35 +    212 +
668     -    146 +    100 +     36 +    213 +**Root Cause:** Race condition in theme loading - dropdown was being set BEFORE async theme load completed.
669     -    147 +    101 +     37 +    214 +
670     -    148 +    102 +     38 +    215 +**Solution:**
671     -    149 +    103 +     39 +    216 +
672     -    150 +    104 +     40 +    217 +```javascript
673     -    151 +    105 +     41 +    218 +// OLD (buggy):
674     -    152 +    106 +     42 +    219 +if (savedTheme) {
675     -    153 +    107 +     43 +    220 +  themeSelector.value = savedTheme; // Sets immediately
676     -    154 +    108 +     44 +    221 +  themeManager.loadTheme(savedTheme); // Async, not awaited
677     -    155 +    109 +     45 +    222 +}
678     -    156 +    110 +     46 +    223 +
679     -    157 +    111 +     47 +    224 +// NEW (fixed):
680     -    158 +    112 +     48 +    225 +if (savedTheme) {
681     -    159 +    113 +     49 +    226 +  themeManager
682     -    160 +    114 +     50 +    227 +    .loadTheme(savedTheme)
683     -    161 +    115 +     51 +    228 +    .then(() => {
684     -    162 +    116 +     52 +    229 +      themeSelector.value = savedTheme; // Only after successful load
685     -    163 +    117 +     53 +    230 +      console.log(`‚úÖ Theme restored: ${savedTheme}`);
686     -    164 +    118 +     54 +    231 +    })
687     -    165 +    119 +     55 +    232 +    .catch(err => {
688     -    166 +    120 +     56 +    233 +      // Fallback with proper sync
689     -    167 +    121 +     57 +    234 +      themeManager.loadTheme('default-light').then(() => {
690     -    168 +    122 +     58 +    235 +        themeSelector.value = 'default-light';
691     -    169 +    123 +     59 +    236 +      });
692     -    170 +    124 +     60 +    237 +    });
693     -    171 +    125 +     61 +    238 +}
694     -    172 +    126 +     62 +    239 +```
695     -    173 +    127 +     63 +    240 +
696     -    174 +    128 +     64 +    241 +**Key Changes:**
697     -    175 +    129 +     65 +    242 +
698     -    176 +    130 +     66 +    243 +1. Await theme load completion before syncing dropdown
699     -    177 +    131 +     67 +    244 +2. Added success callback for dropdown update
700     -    178 +    132 +     68 +    245 +3. Added error handling with fallback
701     -    179 +    133 +     69 +    246 +4. Added console logging for debugging
702     -    180 +    134 +     70 +    247 +
703     -    181 +    135 +     71 +    248 +**Results:**
704     -    182 +    136 +     72 +    249 +
705     -    183 +    137 +     73 +    250 +- ‚úÖ Dropdown now syncs correctly with all themes
706     -    184 +    138 +     74 +    251 +- ‚úÖ No more race conditions
707     -    185 +    139 +     75 +    252 +- ‚úÖ Proper error handling
708     -    186 +    140 +     76 +    253 +- ‚úÖ Works for all 12 themes (6 theme families √ó 2 variants)
709     -    187 +    141 +     77 +    254 +
710     -    188 +    142 +     78 +    255 +**Files Modified:** `script.js` (lines 1167-1183)
711     -    189 +    143 +     79 +206 256  
712     -    190 +    144 +     80 +207 257  ## Performance Observations
713     -    191 +    145 +     81 +208 258  
714     -    192 +    146 +     82 +209 259  
715     -    193 +    147 + 41  83  
716     -    194 +    148 + 42  84  ```
717     -    195 +    149 + 43  85  
718     -    196 +    150 +@@ -47,51 +89,293 @@ index.html | 11 +++++++++++
719     -    197 +    151 + 47  89  **Type:** JavaScript Source File üü®
720     -    198 +    152 + 48  90  
721     -    199 +    153 + 49  91  ```diff
722     -    200 +    154 + 50     -@@ -796,6 +796,7 @@ graph TD
723     -    201 +    155 + 51     -796 796    // Folder browser DOM elements
724     -    202 +    156 + 52     -797 797    const fileBrowser = document.getElementById('file-browser');
725     -    203 +    157 + 53     -798 798    const openFolderBtn = document.getElementById('open-folder-btn');
726     -    204 +    158 + 54     -    799 +  const toggleSidebarBtn = document.getElementById('toggle-sidebar-btn');
727     -    205 +    159 + 55     -799 800    const closeBrowserBtn = document.getElementById('close-browser-btn');
728     -    206 +    160 + 56     -800 801    const fileTree = document.getElementById('file-tree');
729     -    207 +    161 + 57     -801 802    const currentFolderNameEl = document.getElementById('current-folder-name');
730     -    208 +    162 + 58     -@@ -804,6 +805,7 @@ graph TD
731     -    209 +    163 + 59     -804 805    // Folder browser state (using let to allow reassignment)
732     -    210 +    164 + 60     -805 806    let folderFiles = [];
733     -    211 +    165 + 61     -806 807    let activeFileHandle = null;
734     -    212 +    166 + 62     -    808 +  const sidebarCollapsed = false;
735     -    213 +    167 + 63     -807 809  
736     -    214 +    168 + 64     -808 810    // Open folder handler
737     -    215 +    169 + 65     -809 811    openFolderBtn.addEventListener('click', async () => {
738     -    216 +    170 + 66     -@@ -843,9 +845,26 @@ graph TD
739     -    217 +    171 + 67     -843 845      console.log(`‚úÖ Loaded ${result.totalFiles} markdown files from ${result.folderName}`);
740     -    218 +    172 + 68     -844 846    });
741     -    219 +    173 + 69     -845 847  
742     -    220 +    174 + 70     -846     -  // Close browser handler
743     -    221 +    175 + 71     -    848 +  // Toggle sidebar collapse/expand
744     -    222 +    176 + 72     -    849 +  toggleSidebarBtn.addEventListener('click', () => {
745     -    223 +    177 + 73     -    850 +    if (fileBrowser.style.display === 'none') {
746     -    224 +    178 + 74     -    851 +      // Expand sidebar
747     -    225 +    179 + 75     -    852 +      fileBrowser.style.display = 'flex';
748     -    226 +    180 + 76     -    853 +      toggleSidebarBtn.textContent = '‚óÄ Hide Files';
749     -    227 +    181 + 77     -    854 +      toggleSidebarBtn.title = 'Hide File Browser';
750     -    228 +    182 + 78     -    855 +    } else {
751     -    229 +    183 + 79     -    856 +      // Collapse sidebar (keep data)
752     -    230 +    184 + 80     -    857 +      fileBrowser.style.display = 'none';
753     -    231 +    185 + 81     -    858 +      toggleSidebarBtn.textContent = '‚ñ∂ Show Files';
754     -    232 +    186 + 82     -    859 +      toggleSidebarBtn.title = 'Show File Browser';
755     -    233 +    187 + 83     -    860 +    }
756     -    234 +    188 + 84     -    861 +  });
757     -    235 +    189 + 85     -    862 +
758     -    236 +    190 + 86     -    863 +  // Close browser handler (clears data)
759     -    237 +    191 + 87     -847 864    closeBrowserBtn.addEventListener('click', () => {
760     -    238 +    192 + 88     -848 865      fileBrowser.style.display = 'none';
761     -    239 +    193 + 89     -    866 +    toggleSidebarBtn.style.display = 'none';
762     -    240 +    194 + 90     -    867 +    openFolderBtn.style.display = 'inline-block';
763     -    241 +    195 + 91     -849 868      folderFiles = [];
764     -    242 +    196 + 92     -850 869      activeFileHandle = null;
765     -    243 +    197 + 93     -851 870    });
766     -    244 +    198 + 94     -852 871  
767     -    245 +    199 +     92 +@@ -145,101 +145,10 @@ function configureMarkedExtensions() {
768     -    246 +    200 +     93 +145 145      return;
769     -    247 +    201 +     94 +146 146    }
770     -    248 +    202 +     95 +147 147  
771     -    249 +    203 +     96 +148     -  // Add LaTeX environment extensions
772     -    250 +    204 +     97 +    148 +  // Add inline math and text formatting extensions only
773     -    251 +    205 +     98 +    149 +  // LaTeX environments (align, gather, etc.) are not supported by KaTeX
774     -    252 +    206 +     99 +149 150    marked.use({
775     -    253 +    207 +    100 +150 151      extensions: [
776     -    254 +    208 +    101 +151     -      {
777     -    255 +    209 +    102 +152     -        name: 'latexEnvironment',
778     -    256 +    210 +    103 +153     -        level: 'block',
779     -    257 +    211 +    104 +154     -        start(src) {
780     -    258 +    212 +    105 +155     -          return src.match(/^\\begin\{/)?.index;
781     -    259 +    213 +    106 +156     -        },
782     -    260 +    214 +    107 +157     -        tokenizer(src) {
783     -    261 +    215 +    108 +158     -          const match = src.match(/^\\begin\{([^}]+)\}([\s\S]*?)\\end\{\1\}/);
784     -    262 +    216 +    109 +159     -          if (match) {
785     -    263 +    217 +    110 +160     -            return {
786     -    264 +    218 +    111 +161     -              type: 'latexEnvironment',
787     -    265 +    219 +    112 +162     -              raw: match[0],
788     -    266 +    220 +    113 +163     -              text: match[0],
789     -    267 +    221 +    114 +164     -            };
790     -    268 +    222 +    115 +165     -          }
791     -    269 +    223 +    116 +166     -        },
792     -    270 +    224 +    117 +167     -        renderer(token) {
793     -    271 +    225 +    118 +168     -          try {
794     -    272 +    226 +    119 +169     -            const rendered = katex.renderToString(token.text, {
795     -    273 +    227 +    120 +170     -              displayMode: true,
796     -    274 +    228 +    121 +171     -              throwOnError: false,
797     -    275 +    229 +    122 +172     -              trust: true,
798     -    276 +    230 +    123 +173     -              strict: false,
799     -    277 +    231 +    124 +174     -            });
800     -    278 +    232 +    125 +175     -            return `<div class="katex-display">${rendered}</div>`;
801     -    279 +    233 +    126 +176     -          } catch (e) {
802     -    280 +    234 +    127 +177     -            console.warn('KaTeX environment render error:', e);
803     -    281 +    235 +    128 +178     -            return `<div style="color: red; padding: 10px;">LaTeX Error: ${e.message}</div>`;
804     -    282 +    236 +    129 +179     -          }
805     -    283 +    237 +    130 +180     -        },
806     -    284 +    238 +    131 +181     -      },
807     -    285 +    239 +    132 +182     -      {
808     -    286 +    240 +    133 +183     -        name: 'latexDisplayBracket',
809     -    287 +    241 +    134 +184     -        level: 'block',
810     -    288 +    242 +    135 +185     -        start(src) {
811     -    289 +    243 +    136 +186     -          return src.match(/^\\\[/)?.index;
812     -    290 +    244 +    137 +187     -        },
813     -    291 +    245 +    138 +188     -        tokenizer(src) {
814     -    292 +    246 +    139 +189     -          const match = src.match(/^\\\[([\s\S]*?)\\\]/);
815     -    293 +    247 +    140 +190     -          if (match) {
816     -    294 +    248 +    141 +191     -            return {
817     -    295 +    249 +    142 +192     -              type: 'latexDisplayBracket',
818     -    296 +    250 +    143 +193     -              raw: match[0],
819     -    297 +    251 +    144 +194     -              text: match[1].trim(),
820     -    298 +    252 +    145 +195     -            };
821     -    299 +    253 +    146 +196     -          }
822     -    300 +    254 +    147 +197     -        },
823     -    301 +    255 +    148 +198     -        renderer(token) {
824     -    302 +    256 +    149 +199     -          try {
825     -    303 +    257 +    150 +200     -            const rendered = katex.renderToString(token.text, {
826     -    304 +    258 +    151 +201     -              displayMode: true,
827     -    305 +    259 +    152 +202     -              throwOnError: false,
828     -    306 +    260 +    153 +203     -              trust: true,
829     -    307 +    261 +    154 +204     -              strict: false,
830     -    308 +    262 +    155 +205     -            });
831     -    309 +    263 +    156 +206     -            return `<div class="katex-display">${rendered}</div>`;
832     -    310 +    264 +    157 +207     -          } catch (e) {
833     -    311 +    265 +    158 +208     -            console.warn('KaTeX bracket render error:', e);
834     -    312 +    266 +    159 +209     -            return `<div style="color: red; padding: 10px;">LaTeX Error: ${e.message}</div>`;
835     -    313 +    267 +    160 +210     -          }
836     -    314 +    268 +    161 +211     -        },
837     -    315 +    269 +    162 +212     -      },
838     -    316 +    270 +    163 +213     -      {
839     -    317 +    271 +    164 +214     -        name: 'latexInlineParen',
840     -    318 +    272 +    165 +215     -        level: 'inline',
841     -    319 +    273 +    166 +216     -        start(src) {
842     -    320 +    274 +    167 +217     -          return src.match(/\\\(/)?.index;
843     -    321 +    275 +    168 +218     -        },
844     -    322 +    276 +    169 +219     -        tokenizer(src) {
845     -    323 +    277 +    170 +220     -          const match = src.match(/^\\\(([\s\S]*?)\\\)/);
846     -    324 +    278 +    171 +221     -          if (match) {
847     -    325 +    279 +    172 +222     -            return {
848     -    326 +    280 +    173 +223     -              type: 'latexInlineParen',
849     -    327 +    281 +    174 +224     -              raw: match[0],
850     -    328 +    282 +    175 +225     -              text: match[1].trim(),
851     -    329 +    283 +    176 +226     -            };
852     -    330 +    284 +    177 +227     -          }
853     -    331 +    285 +    178 +228     -        },
854     -    332 +    286 +    179 +229     -        renderer(token) {
855     -    333 +    287 +    180 +230     -          try {
856     -    334 +    288 +    181 +231     -            return katex.renderToString(token.text, {
857     -    335 +    289 +    182 +232     -              displayMode: false,
858     -    336 +    290 +    183 +233     -              throwOnError: false,
859     -    337 +    291 +    184 +234     -              trust: true,
860     -    338 +    292 +    185 +235     -              strict: false,
861     -    339 +    293 +    186 +236     -            });
862     -    340 +    294 +    187 +237     -          } catch (e) {
863     -    341 +    295 +    188 +238     -            console.warn('KaTeX paren render error:', e);
864     -    342 +    296 +    189 +239     -            return `<span style="color: red;">LaTeX Error</span>`;
865     -    343 +    297 +    190 +240     -          }
866     -    344 +    298 +    191 +241     -        },
867     -    345 +    299 +    192 +242     -      },
868     -    346 +    300 +    193 +243 152        {
869     -    347 +    301 +    194 +244 153          name: 'mathBlock',
870     -    348 +    302 +    195 +245 154          level: 'block',
871     -    349 +    303 +    196 +@@ -503,101 +412,10 @@ graph TD
872     -    350 +    304 +    197 +503 412      return textarea.value;
873     -    351 +    305 +    198 +504 413    }
874     -    352 +    306 +    199 +505 414  
875     -    353 +    307 +    200 +506     -  // Add LaTeX environment extensions that render directly with KaTeX
876     -    354 +    308 +    201 +    415 +  // Keep only subscript and superscript extensions
877     -    355 +    309 +    202 +    416 +  // Remove LaTeX environment extensions that don't work with KaTeX
878     -    356 +    310 +    203 +507 417    marked.use({
879     -    357 +    311 +    204 +508 418      extensions: [
880     -    358 +    312 +    205 +509     -      {
881     -    359 +    313 +    206 +510     -        name: 'latexEnvironment',
882     -    360 +    314 +    207 +511     -        level: 'block',
883     -    361 +    315 +    208 +512     -        start(src) {
884     -    362 +    316 +    209 +513     -          return src.match(/^\\begin\{/)?.index;
885     -    363 +    317 +    210 +514     -        },
886     -    364 +    318 +    211 +515     -        tokenizer(src) {
887     -    365 +    319 +    212 +516     -          const match = src.match(/^\\begin\{([^}]+)\}([\s\S]*?)\\end\{\1\}/);
888     -    366 +    320 +    213 +517     -          if (match) {
889     -    367 +    321 +    214 +518     -            return {
890     -    368 +    322 +    215 +519     -              type: 'latexEnvironment',
891     -    369 +    323 +    216 +520     -              raw: match[0],
892     -    370 +    324 +    217 +521     -              text: match[0],
893     -    371 +    325 +    218 +522     -            };
894     -    372 +    326 +    219 +523     -          }
895     -    373 +    327 +    220 +524     -        },
896     -    374 +    328 +    221 +525     -        renderer(token) {
897     -    375 +    329 +    222 +526     -          try {
898     -    376 +    330 +    223 +527     -            const rendered = katex.renderToString(token.text, {
899     -    377 +    331 +    224 +528     -              displayMode: true,
900     -    378 +    332 +    225 +529     -              throwOnError: false,
901     -    379 +    333 +    226 +530     -              trust: true,
902     -    380 +    334 +    227 +531     -              strict: false,
903     -    381 +    335 +    228 +532     -            });
904     -    382 +    336 +    229 +533     -            return `<div class="katex-display">${rendered}</div>`;
905     -    383 +    337 +    230 +534     -          } catch (e) {
906     -    384 +    338 +    231 +535     -            console.warn('KaTeX environment render error:', e);
907     -    385 +    339 +    232 +536     -            return `<div style="color: red; padding: 10px;">LaTeX Error: ${e.message}</div>`;
908     -    386 +    340 +    233 +537     -          }
909     -    387 +    341 +    234 +538     -        },
910     -    388 +    342 +    235 +539     -      },
911     -    389 +    343 +    236 +540     -      {
912     -    390 +    344 +    237 +541     -        name: 'latexDisplayBracket',
913     -    391 +    345 +    238 +542     -        level: 'block',
914     -    392 +    346 +    239 +543     -        start(src) {
915     -    393 +    347 +    240 +544     -          return src.match(/^\\\[/)?.index;
916     -    394 +    348 +    241 +545     -        },
917     -    395 +    349 +    242 +546     -        tokenizer(src) {
918     -    396 +    350 +    243 +547     -          const match = src.match(/^\\\[([\s\S]*?)\\\]/);
919     -    397 +    351 +    244 +548     -          if (match) {
920     -    398 +    352 +    245 +549     -            return {
921     -    399 +    353 +    246 +550     -              type: 'latexDisplayBracket',
922     -    400 +    354 +    247 +551     -              raw: match[0],
923     -    401 +    355 +    248 +552     -              text: match[1].trim(),
924     -    402 +    356 +    249 +553     -            };
925     -    403 +    357 +    250 +554     -          }
926     -    404 +    358 +    251 +555     -        },
927     -    405 +    359 +    252 +556     -        renderer(token) {
928     -    406 +    360 +    253 +557     -          try {
929     -    407 +    361 +    254 +558     -            const rendered = katex.renderToString(token.text, {
930     -    408 +    362 +    255 +559     -              displayMode: true,
931     -    409 +    363 +    256 +560     -              throwOnError: false,
932     -    410 +    364 +    257 +561     -              trust: true,
933     -    411 +    365 +    258 +562     -              strict: false,
934     -    412 +    366 +    259 +563     -            });
935     -    413 +    367 +    260 +564     -            return `<div class="katex-display">${rendered}</div>`;
936     -    414 +    368 +    261 +565     -          } catch (e) {
937     -    415 +    369 +    262 +566     -            console.warn('KaTeX bracket render error:', e);
938     -    416 +    370 +    263 +567     -            return `<div style="color: red; padding: 10px;">LaTeX Error: ${e.message}</div>`;
939     -    417 +    371 +    264 +568     -          }
940     -    418 +    372 +    265 +569     -        },
941     -    419 +    373 +    266 +570     -      },
942     -    420 +    374 +    267 +571     -      {
943     -    421 +    375 +    268 +572     -        name: 'latexInlineParen',
944     -    422 +    376 +    269 +573     -        level: 'inline',
945     -    423 +    377 +    270 +574     -        start(src) {
946     -    424 +    378 +    271 +575     -          return src.match(/\\\(/)?.index;
947     -    425 +    379 +    272 +576     -        },
948     -    426 +    380 +    273 +577     -        tokenizer(src) {
949     -    427 +    381 +    274 +578     -          const match = src.match(/^\\\(([\s\S]*?)\\\)/);
950     -    428 +    382 +    275 +579     -          if (match) {
951     -    429 +    383 +    276 +580     -            return {
952     -    430 +    384 +    277 +581     -              type: 'latexInlineParen',
953     -    431 +    385 +    278 +582     -              raw: match[0],
954     -    432 +    386 +    279 +583     -              text: match[1].trim(),
955     -    433 +    387 +    280 +584     -            };
956     -    434 +    388 +    281 +585     -          }
957     -    435 +    389 +    282 +586     -        },
958     -    436 +    390 +    283 +587     -        renderer(token) {
959     -    437 +    391 +    284 +588     -          try {
960     -    438 +    392 +    285 +589     -            return katex.renderToString(token.text, {
961     -    439 +    393 +    286 +590     -              displayMode: false,
962     -    440 +    394 +    287 +591     -              throwOnError: false,
963     -    441 +    395 +    288 +592     -              trust: true,
964     -    442 +    396 +    289 +593     -              strict: false,
965     -    443 +    397 +    290 +594     -            });
966     -    444 +    398 +    291 +595     -          } catch (e) {
967     -    445 +    399 +    292 +596     -            console.warn('KaTeX paren render error:', e);
968     -    446 +    400 +    293 +597     -            return `<span style="color: red;">LaTeX Error</span>`;
969     -    447 +    401 +    294 +598     -          }
970     -    448 +    402 +    295 +599     -        },
971     -    449 +    403 +    296 +600     -      },
972     -    450 +    404 +    297 +601 419        {
973     -    451 +    405 +    298 +602 420          name: 'subscript',
974     -    452 +    406 +    299 +603 421          level: 'inline',
975     -    453 +    407 +    300 +@@ -641,7 +459,7 @@ graph TD
976     -    454 +    408 +    301 +641 459      ],
977     -    455 +    409 +    302 +642 460    });
978     -    456 +    410 +    303 +643 461  
979     -    457 +    411 +    304 +644     -  console.log('‚úÖ LaTeX environments, subscript, and superscript enabled');
980     -    458 +    412 +    305 +    462 +  console.log('‚úÖ Subscript and superscript enabled (LaTeX environments display as-is)');
981     -    459 +    413 +    306 +645 463  
982     -    460 +    414 +    307 +646 464    // Render markdown
983     -    461 +    415 +    308 +647 465    function renderMarkdown() {
984     -    462 +    416 +    309 +@@ -685,22 +503,9 @@ graph TD
985     -    463 +    417 +    310 +685 503        // Apply Prism syntax highlighting using PrismService
986     -    464 +    418 +    311 +686 504        prismService.highlightAll(preview);
987     -    465 +    419 +    312 +687 505  
988     -    466 +    420 +    313 +688     -      // Apply KaTeX auto-render only for any remaining $...$ syntax
989     -    467 +    421 +    314 +689     -      if (typeof renderMathInElement !== 'undefined') {
990     -    468 +    422 +    315 +690     -        try {
991     -    469 +    423 +    316 +691     -          renderMathInElement(preview, {
992     -    470 +    424 +    317 +692     -            delimiters: [
993     -    471 +    425 +    318 +693     -              { left: '$$', right: '$$', display: true },
994     -    472 +    426 +    319 +694     -              { left: '$', right: '$', display: false },
995     -    473 +    427 +    320 +695     -            ],
996     -    474 +    428 +    321 +696     -            throwOnError: false,
997     -    475 +    429 +    322 +697     -            trust: true,
998     -    476 +    430 +    323 +698     -            strict: false,
999     -    477 +    431 +    324 +699     -          });
1000     -    478 +    432 +    325 +700     -        } catch (e) {
1001     -    479 +    433 +    326 +701     -          console.warn('KaTeX auto-render error:', e);
1002     -    480 +    434 +    327 +702     -        }
1003     -    481 +    435 +    328 +703     -      }
1004     -    482 +    436 +    329 +    506 +      // NOTE: KaTeX auto-render is DISABLED
1005     -    483 +    437 +    330 +    507 +      // We handle all math via marked.js extensions ($...$ and $$...$$)
1006     -    484 +    438 +    331 +    508 +      // KaTeX auto-render was causing issues with unsupported LaTeX environments
1007     -    485 +    439 +    332 +704 509  
1008     -    486 +    440 +    333 +705 510        // Save content using StorageManager
1009     -    487 +    441 +    334 +706 511        storageManager.set('markdownContent', markdownText);
1010     -    488 +    442 +    335 +@@ -1167,11 +972,21 @@ graph TD
1011     -    489 +    443 +    336 +1167 972    // Load saved theme using ThemeManager
1012     -    490 +    444 +    337 +1168 973    const savedTheme = storageManager.get('selectedTheme');
1013     -    491 +    445 +    338 +1169 974    if (savedTheme) {
1014     -    492 +    446 +    339 +1170     -    themeSelector.value = savedTheme;
1015     -    493 +    447 +    340 +1171     -    themeManager.loadTheme(savedTheme).catch(err => {
1016     -    494 +    448 +    341 +1172     -      console.error('Failed to load saved theme:', err);
1017     -    495 +    449 +    342 +1173     -      themeManager.loadTheme('default-light');
1018     -    496 +    450 +    343 +1174     -    });
1019     -    497 +    451 +    344 +    975 +    // Load theme first, then sync dropdown only on success
1020     -    498 +    452 +    345 +    976 +    themeManager
1021     -    499 +    453 +    346 +    977 +      .loadTheme(savedTheme)
1022     -    500 +    454 +    347 +    978 +      .then(() => {
1023     -    501 +    455 +    348 +    979 +        // Theme loaded successfully - sync dropdown
1024     -    502 +    456 +    349 +    980 +        themeSelector.value = savedTheme;
1025     -    503 +    457 +    350 +    981 +        console.log(`‚úÖ Theme restored: ${savedTheme}`);
1026     -    504 +    458 +    351 +    982 +      })
1027     -    505 +    459 +    352 +    983 +      .catch(err => {
1028     -    506 +    460 +    353 +    984 +        console.error('Failed to load saved theme:', err);
1029     -    507 +    461 +    354 +    985 +        // Fallback to default-light on error
1030     -    508 +    462 +    355 +    986 +        themeManager.loadTheme('default-light').then(() => {
1031     -    509 +    463 +    356 +    987 +          themeSelector.value = 'default-light';
1032     -    510 +    464 +    357 +    988 +        });
1033     -    511 +    465 +    358 +    989 +      });
1034     -    512 +    466 +    359 +1175 990    }
1035     -    513 +    467 +    360 +1176 991  
1036     -    514 +    468 +    361 +1177 992    // Zoom functionality
1037     -    515 +    469 +    362 +1178 993  
1038     -    516 +    470 +    363 +
1039     -    517 +    471 +    364 +```
1040     -    518 +    472 +    365 +
1041     -    519 +    473 +    366 +
1042     -    520 +    474 +    367 +### üìÑ `themes/sunset-dark.css`
1043     -    521 +    475 +    368 +
1044     -    522 +    476 +    369 +**Type:** Stylesheet üé®
1045     -    523 +    477 +    370 +
1046     -    524 +    478 +    371 +```diff
1047     -    525 +    479 +    372 +@@ -1,4 +1,4 @@
1048     -    526 +    480 +    373 +  1     -r/* Sunset Dark Theme */
1049     -    527 +    481 +    374 +      1 +/* Sunset Dark Theme */
1050     -    528 +    482 +    375 +  2   2  :root {
1051     -    529 +    483 +    376 +  3   3    --bg-primary: #1c0a00;
1052     -    530 +    484 +    377 +  4   4    --bg-secondary: #2d1b0e;
1053     -    531 +    485 +    378 +  5   5  
1054     -    532 +    486 + 95 379  
1055     -    533 +    487 + 96 380  ```
1056     -    534 +    488 + 97 381  
1057     -    535 +    489 +@@ -137,4 +421,4 @@ Please provide specific feedback on:
1058     -    536 +    490 +137 421  
1059     -    537 +    491 +138 422  ---
1060     -    538 +    492 +139 423  *Generated by AI Visual Code Review v2.0 - Unified Export Script*
1061     -    539 +    493 +140     -*Files processed: 2/2 | Errors: 0 | Generated: 2025-12-06T22:55:31.083Z*
1062     -    540 +    494 +    424 +*Files processed: 3/3 | Errors: 0 | Generated: 2025-12-07T02:57:20.361Z*
1063     -    541 +    495 +141 425  
1064     -    542 +    496 +
1065     -    543 +    497 +```
1066     -    544 +    498 +
1067     -    545 +    499 +
1068     -    546 +    500 +### ‚ú® `docs/02-architecture/mermaid-theme-architecture.md` **[ADDED]**
1069     -    547 +    501 +
1070     -    548 +    502 +**Status:** ‚úÖ **NEW FILE** - This file has been newly created
1071     -    549 +    503 +
1072     -    550 +    504 +**Type:** Documentation üìñ
1073     -    551 +    505 +
1074     -    552 +    506 +```diff
1075     -    553 +    507 +@@ -0,0 +1,208 @@
1076     -    554 +    508 +      1 +# Mermaid Theme Architecture - Comprehensive Reference
1077     -    555 +    509 +      2 +
1078     -    556 +    510 +      3 +**Last Updated:** 12/7/2025
1079     -    557 +    511 +      4 +**Source:** Official Mermaid.js theming documentation
1080     -    558 +    512 +      5 +
1081     -    559 +    513 +      6 +## Complete Mermaid Theme Variables
1082     -    560 +    514 +      7 +
1083     -    561 +    515 +      8 +### Core Global Variables
1084     -    562 +    516 +      9 +
1085     -    563 +    517 +     10 +| Variable     | Type       | Description                  | Default                        |
1086     -    564 +    518 +     11 +| ------------ | ---------- | ---------------------------- | ------------------------------ |
1087     -    565 +    519 +     12 +| `background` | Background | Page background              | `#f4f4f4`                      |
1088     -    566 +    520 +     13 +| `fontFamily` | Text       | Font family                  | `trebuchet ms, verdana, arial` |
1089     -    567 +    521 +     14 +| `fontSize`   | Text       | Font size                    | `16px`                         |
1090     -    568 +    522 +     15 +| `darkMode`   | Boolean    | Affects color calculations   | `false`                        |
1091     -    569 +    523 +     16 +| `textColor`  | Text       | General text over background | calculated                     |
1092     -    570 +    524 +     17 +| `lineColor`  | Line       | Lines and connections        | calculated                     |
1093     -    571 +    525 +     18 +| `mainBkg`    | Background | Main background for objects  | calculated                     |
1094     -    572 +    526 +     19 +
1095     -    573 +    527 +     20 +### Primary/Secondary/Tertiary Color Sets
1096     -    574 +    528 +     21 +
1097     -    575 +    529 +     22 +Each set has 3 variables (background, text, border):
1098     -    576 +    530 +     23 +
1099     -    577 +    531 +     24 +| Variable               | Type       | Description                |
1100     -    578 +    532 +     25 +| ---------------------- | ---------- | -------------------------- |
1101     -    579 +    533 +     26 +| `primaryColor`         | Background | Primary node background    |
1102     -    580 +    534 +     27 +| `primaryTextColor`     | Text       | Text in primary nodes      |
1103     -    581 +    535 +     28 +| `primaryBorderColor`   | Border     | Border for primary nodes   |
1104     -    582 +    536 +     29 +| `secondaryColor`       | Background | Secondary node background  |
1105     -    583 +    537 +     30 +| `secondaryTextColor`   | Text       | Text in secondary nodes    |
1106     -    584 +    538 +     31 +| `secondaryBorderColor` | Border     | Border for secondary nodes |
1107     -    585 +    539 +     32 +| `tertiaryColor`        | Background | Tertiary node background   |
1108     -    586 +    540 +     33 +| `tertiaryTextColor`    | Text       | Text in tertiary nodes     |
1109     -    587 +    541 +     34 +| `tertiaryBorderColor`  | Border     | Border for tertiary nodes  |
1110     -    588 +    542 +     35 +
1111     -    589 +    543 +     36 +### Flowchart-Specific Variables
1112     -    590 +    544 +     37 +
1113     -    591 +    545 +     38 +| Variable              | Type       | Description           |
1114     -    592 +    546 +     39 +| --------------------- | ---------- | --------------------- |
1115     -    593 +    547 +     40 +| `nodeBorder`          | Border     | Node border color     |
1116     -    594 +    548 +     41 +| `clusterBkg`          | Background | Subgraph background   |
1117     -    595 +    549 +     42 +| `clusterBorder`       | Border     | Subgraph border       |
1118     -    596 +    550 +     43 +| `defaultLinkColor`    | Line       | Link/edge color       |
1119     -    597 +    551 +     44 +| `titleColor`          | Text       | Title text color      |
1120     -    598 +    552 +     45 +| `edgeLabelBackground` | Background | Edge label background |
1121     -    599 +    553 +     46 +| `nodeTextColor`       | Text       | Text inside nodes     |
1122     -    600 +    554 +     47 +
1123     -    601 +    555 +     48 +### Sequence Diagram Variables
1124     -    602 +    556 +     49 +
1125     -    603 +    557 +     50 +| Variable                | Type       | Description           |
1126     -    604 +    558 +     51 +| ----------------------- | ---------- | --------------------- |
1127     -    605 +    559 +     52 +| `actorBkg`              | Background | Actor box background  |
1128     -    606 +    560 +     53 +| `actorBorder`           | Border     | Actor box border      |
1129     -    607 +    561 +     54 +| `actorTextColor`        | Text       | Actor text            |
1130     -    608 +    562 +     55 +| `actorLineColor`        | Line       | Actor lifeline        |
1131     -    609 +    563 +     56 +| `signalColor`           | Line       | Signal arrows         |
1132     -    610 +    564 +     57 +| `signalTextColor`       | Text       | Signal labels         |
1133     -    611 +    565 +     58 +| `labelBoxBkgColor`      | Background | Label box background  |
1134     -    612 +    566 +     59 +| `labelBoxBorderColor`   | Border     | Label box border      |
1135     -    613 +    567 +     60 +| `labelTextColor`        | Text       | Label text            |
1136     -    614 +    568 +     61 +| `loopTextColor`         | Text       | Loop text             |
1137     -    615 +    569 +     62 +| `activationBorderColor` | Border     | Activation border     |
1138     -    616 +    570 +     63 +| `activationBkgColor`    | Background | Activation background |
1139     -    617 +    571 +     64 +| `sequenceNumberColor`   | Text       | Sequence numbers      |
1140     -    618 +    572 +     65 +
1141     -    619 +    573 +     66 +### Pie Chart Variables
1142     -    620 +    574 +     67 +
1143     -    621 +    575 +     68 +| Variable              | Type       | Description                           |
1144     -    622 +    576 +     69 +| --------------------- | ---------- | ------------------------------------- |
1145     -    623 +    577 +     70 +| `pie1` - `pie12`      | Background | Fill colors for sections              |
1146     -    624 +    578 +     71 +| `pieTitleTextSize`    | Text       | Title font size (default: `25px`)     |
1147     -    625 +    579 +     72 +| `pieTitleTextColor`   | Text       | Title text color                      |
1148     -    626 +    580 +     73 +| `pieSectionTextSize`  | Text       | Section label size (default: `17px`)  |
1149     -    627 +    581 +     74 +| `pieSectionTextColor` | Text       | **Section label color (ON SLICES!)**  |
1150     -    628 +    582 +     75 +| `pieLegendTextSize`   | Text       | Legend font size (default: `17px`)    |
1151     -    629 +    583 +     76 +| `pieLegendTextColor`  | Text       | Legend text color                     |
1152     -    630 +    584 +     77 +| `pieStrokeColor`      | Border     | Slice borders (default: `black`)      |
1153     -    631 +    585 +     78 +| `pieStrokeWidth`      | Border     | Slice border width (default: `2px`)   |
1154     -    632 +    586 +     79 +| `pieOuterStrokeWidth` | Border     | Outer circle width (default: `2px`)   |
1155     -    633 +    587 +     80 +| `pieOuterStrokeColor` | Border     | Outer circle color (default: `black`) |
1156     -    634 +    588 +     81 +| `pieOpacity`          | Visual     | Slice opacity (default: `0.7`)        |
1157     -    635 +    589 +     82 +
1158     -    636 +    590 +     83 +### State Diagram Variables
1159     -    637 +    591 +     84 +
1160     -    638 +    592 +     85 +| Variable        | Type       | Description                |
1161     -    639 +    593 +     86 +| --------------- | ---------- | -------------------------- |
1162     -    640 +    594 +     87 +| `labelColor`    | Text       | State label color          |
1163     -    641 +    595 +     88 +| `altBackground` | Background | Composite state background |
1164     -    642 +    596 +     89 +
1165     -    643 +    597 +     90 +### Class Diagram Variables
1166     -    644 +    598 +     91 +
1167     -    645 +    599 +     92 +| Variable    | Type | Description      |
1168     -    646 +    600 +     93 +| ----------- | ---- | ---------------- |
1169     -    647 +    601 +     94 +| `classText` | Text | Class text color |
1170     -    648 +    602 +     95 +
1171     -    649 +    603 +     96 +### User Journey Variables
1172     -    650 +    604 +     97 +
1173     -    651 +    605 +     98 +| Variable                  | Type       | Description   |
1174     -    652 +    606 +     99 +| ------------------------- | ---------- | ------------- |
1175     -    653 +    607 +    100 +| `fillType0` - `fillType7` | Background | Section fills |
1176     -    654 +    608 +    101 +
1177     -    655 +    609 +    102 +## Critical Insights
1178     -    656 +    610 +    103 +
1179     -    657 +    611 +    104 +### 1. Pie Section Text Contrast Issue
1180     -    658 +    612 +    105 +
1181     -    659 +    613 +    106 +**Problem:** `pieSectionTextColor` is text **ON** the colored pie slices!
1182     -    660 +    614 +    107 +
1183     -    661 +    615 +    108 +- If slices are dark and text is dark ‚Üí **UNREADABLE**
1184     -    662 +    616 +    109 +- If slices are light and text is light ‚Üí **UNREADABLE**
1185     -    663 +    617 +    110 +
1186     -    664 +    618 +    111 +**Solution:** `pieSectionTextColor` must contrast with `pie1-pie12` colors!
1187     -    665 +    619 +    112 +
1188     -    666 +    620 +    113 +### 2. Background vs Text Variables
1189     -    667 +    621 +    114 +
1190     -    668 +    622 +    115 +- **Background variables** (end with `Bkg`, `Color`, or are named `pie1-12`)
1191     -    669 +    623 +    116 +- **Text variables** (contain `Text` or `textColor`)
1192     -    670 +    624 +    117 +- **Border variables** (contain `Border` or `Stroke`)
1193     -    671 +    625 +    118 +- **Line variables** (contain `Line` or `lineColor`)
1194     -    672 +    626 +    119 +
1195     -    673 +    627 +    120 +### 3. Calculated vs Explicit
1196     -    674 +    628 +    121 +
1197     -    675 +    629 +    122 +- Mermaid **calculates** many colors if not provided
1198     -    676 +    630 +    123 +- But calculation may not match our theme aesthetics
1199     -    677 +    631 +    124 +- **We should set ALL critical variables explicitly**
1200     -    678 +    632 +    125 +
1201     -    679 +    633 +    126 +## Implementation Strategy
1202     -    680 +    634 +    127 +
1203     -    681 +    635 +    128 +### For Each Theme, Define
1204     -    682 +    636 +    129 +
1205     -    683 +    637 +    130 +1. **Core Backgrounds** (3 levels for hierarchy)
1206     -    684 +    638 +    131 +   - `primaryColor`, `secondaryColor`, `tertiaryColor`
1207     -    685 +    639 +    132 +
1208     -    686 +    640 +    133 +2. **All Text Colors** (must contrast with their backgrounds!)
1209     -    687 +    641 +    134 +   - `primaryTextColor`, `secondaryTextColor`, `tertiaryTextColor`
1210     -    688 +    642 +    135 +   - `nodeTextColor`, `actorTextColor`, `signalTextColor`
1211     -    689 +    643 +    136 +   - `pieTitleTextColor`, `pieSectionTextColor`, `pieLegendTextColor`
1212     -    690 +    644 +    137 +
1213     -    691 +    645 +    138 +3. **All Border Colors** (visible against backgrounds)
1214     -    692 +    646 +    139 +   - `primaryBorderColor`, `secondaryBorderColor`, `tertiaryBorderColor`
1215     -    693 +    647 +    140 +   - `nodeBorder`, `actorBorder`, `clusterBorder`
1216     -    694 +    648 +    141 +   - `pieStrokeColor`, `pieOuterStrokeColor`
1217     -    695 +    649 +    142 +
1218     -    696 +    650 +    143 +4. **Line/Connection Colors**
1219     -    697 +    651 +    144 +   - `lineColor`, `defaultLinkColor`
1220     -    698 +    652 +    145 +   - `signalColor`, `actorLineColor`
1221     -    699 +    653 +    146 +
1222     -    700 +    654 +    147 +5. **Pie Slice Backgrounds** (12 distinct colors)
1223     -    701 +    655 +    148 +   - `pie1` through `pie12` - must be DISTINCT from text color!
1224     -    702 +    656 +    149 +
1225     -    703 +    657 +    150 +## Architecture Pattern
1226     -    704 +    658 +    151 +
1227     -    705 +    659 +    152 +```javascript
1228     -    706 +    660 +    153 +mermaid.initialize({
1229     -    707 +    661 +    154 +  theme: 'base',
1230     -    708 +    662 +    155 +  themeVariables: {
1231     -    709 +    663 +    156 +    // Core (affects ALL diagrams)
1232     -    710 +    664 +    157 +    background: bgPrimary,
1233     -    711 +    665 +    158 +    fontFamily: '...',
1234     -    712 +    666 +    159 +    fontSize: '16px',
1235     -    713 +    667 +    160 +
1236     -    714 +    668 +    161 +    // Primary set (most nodes)
1237     -    715 +    669 +    162 +    primaryColor: [BACKGROUND],
1238     -    716 +    670 +    163 +    primaryTextColor: [TEXT - must contrast!],
1239     -    717 +    671 +    164 +    primaryBorderColor: [BORDER - visible],
1240     -    718 +    672 +    165 +
1241     -    719 +    673 +    166 +    // Secondary set (clusters, special nodes)
1242     -    720 +    674 +    167 +    secondaryColor: [BACKGROUND],
1243     -    721 +    675 +    168 +    secondaryTextColor: [TEXT - must contrast!],
1244     -    722 +    676 +    169 +    secondaryBorderColor: [BORDER - visible],
1245     -    723 +    677 +    170 +
1246     -    724 +    678 +    171 +    // Tertiary set (nested elements)
1247     -    725 +    679 +    172 +    tertiaryColor: [BACKGROUND],
1248     -    726 +    680 +    173 +    tertiaryTextColor: [TEXT - must contrast!],
1249     -    727 +    681 +    174 +    tertiaryBorderColor: [BORDER - visible],
1250     -    728 +    682 +    175 +
1251     -    729 +    683 +    176 +    // Flowchart specific
1252     -    730 +    684 +    177 +    nodeBorder: [VISIBLE],
1253     -    731 +    685 +    178 +    nodeTextColor: [CONTRASTING],
1254     -    732 +    686 +    179 +    edgeLabelBackground: [BACKGROUND],
1255     -    733 +    687 +    180 +
1256     -    734 +    688 +    181 +    // Sequence diagram specific
1257     -    735 +    689 +    182 +    actorBkg: [BACKGROUND],
1258     -    736 +    690 +    183 +    actorTextColor: [CONTRASTING],
1259     -    737 +    691 +    184 +
1260     -    738 +    692 +    185 +    // Pie chart specific
1261     -    739 +    693 +    186 +    pie1-12: [12 DISTINCT COLORS],
1262     -    740 +    694 +    187 +    pieSectionTextColor: [CONTRASTS WITH pie1-12!],
1263     -    741 +    695 +    188 +
1264     -    742 +    696 +    189 +    // Lines
1265     -    743 +    697 +    190 +    lineColor: [VISIBLE],
1266     -    744 +    698 +    191 +    signalColor: [VISIBLE],
1267     -    745 +    699 +    192 +  }
1268     -    746 +    700 +    193 +});
1269     -    747 +    701 +    194 +```
1270     -    748 +    702 +    195 +
1271     -    749 +    703 +    196 +## Testing Checklist
1272     -    750 +    704 +    197 +
1273     -    751 +    705 +    198 +- [ ] Flowchart - nodes, clusters, edges readable
1274     -    752 +    706 +    199 +- [ ] Sequence diagram - actors, signals, loops readable
1275     -    753 +    707 +    200 +- [ ] Pie chart - slices, percentages, legend readable
1276     -    754 +    708 +    201 +- [ ] State diagram - states, transitions readable
1277     -    755 +    709 +    202 +- [ ] Class diagram - classes, methods readable
1278     -    756 +    710 +    203 +- [ ] User journey - tasks, emotions readable
1279     -    757 +    711 +    204 +
1280     -    758 +    712 +    205 +## References
1281     -    759 + 29 713      206 +
1282     -    760 + 30     -    207 +## Recent Fixes (Latest Session)
1283     -    761 + 31     -    208 +
1284     -    762 + 32     -    209 +### Theme Dropdown Sync Fix ‚úÖ
1285     -    763 +    714 +    207 +- [Mermaid Theming Documentation](https://mermaid.js.org/config/theming.html)
1286     -    764 +    715 +    208 +- [Base Theme Source](https://github.com/mermaid-js/mermaid/blob/develop/packages/mermaid/src/themes/theme-base.js)
1287     -    765 +    716 +    209  
1288     -    766 +    717 +
1289     -    767 +    718 +```
1290     -    768 +    719 +
1291     -    769 +    720 +
1292     -    770 +    721 +### ‚ú® `docs/02-architecture/prism-token-architecture.md` **[ADDED]**
1293     -    771 +    722 +
1294     -    772 +    723 +**Status:** ‚úÖ **NEW FILE** - This file has been newly created
1295     -    773 +    724 +
1296     -    774 +    725 +**Type:** Documentation üìñ
1297     -    775 +    726 +
1298     -    776 +    727 +```diff
1299     -    777 +    728 +@@ -0,0 +1,226 @@
1300     -    778 +    729 +      1 +# Prism Token Architecture - Comprehensive Reference
1301     -    779 +    730 +      2 +
1302     -    780 +    731 +      3 +**Last Updated:** 12/7/2025
1303     -    781 +    732 +      4 +**Source:** Official Prism.js documentation + One Dark theme analysis
1304     -    782 +    733 +      5 +
1305     -    783 +    734 +      6 +## Standard Token Classes
1306     -    784 +    735 +      7 +
1307     -    785 +    736 +      8 +### Core Language Constructs
1308     -    786 +    737 +      9 +
1309     -    787 +    738 +     10 +| Token Class   | Purpose                    | Example                                  | Recommended Color Hue             |
1310     -    788 +    739 +     11 +| ------------- | -------------------------- | ---------------------------------------- | --------------------------------- |
1311     -    789 +    740 +     12 +| `keyword`     | Reserved words             | `if`, `else`, `class`, `final`, `sealed` | Purple/Magenta (286¬∞)             |
1312     -    790 +    741 +     13 +| `builtin`     | Built-in functions/types   | `String`, `Array`, `Console`             | Green (95¬∞)                       |
1313     -    791 +    742 +     14 +| `class-name`  | Class/Interface/Type names | `Rectangle`, `Shape`, `Person`           | Orange (29¬∞)                      |
1314     -    792 +    743 +     15 +| `function`    | Function/method names      | `main`, `println`, `forEach`             | Blue (207¬∞)                       |
1315     -    793 +    744 +     16 +| `boolean`     | True/false values          | `true`, `false`                          | Orange (29¬∞)                      |
1316     -    794 +    745 +     17 +| `number`      | Numeric literals           | `42`, `3.14`, `0xDEADBEEF`               | Orange (29¬∞)                      |
1317     -    795 +    746 +     18 +| `string`      | String literals            | `"Hello"`, `'World'`                     | Green (95¬∞)                       |
1318     -    796 +    747 +     19 +| `char`        | Character literals         | `'A'`, `'\n'`                            | Green (95¬∞)                       |
1319     -    797 +    748 +     20 +| `symbol`      | Symbols (Smalltalk, Ruby)  | `:mySymbol`                              | Green (95¬∞)                       |
1320     -    798 +    749 +     21 +| `regex`       | Regular expressions        | `/[a-z]+/i`                              | Green (95¬∞)                       |
1321     -    799 +    750 +     22 +| `operator`    | Operators                  | `+`, `-`, `*`, `/`, `=`, `==`            | Purple (286¬∞)                     |
1322     -    800 +    751 +     23 +| `variable`    | Variable names (special)   | Less/Bash variables                      | Blue (207¬∞)                       |
1323     -    801 +    752 +     24 +| `constant`    | Constants                  | `PI`, `MAX_SIZE`, `stdout`               | Orange (29¬∞)                      |
1324     -    802 +    753 +     25 +| `property`    | Object properties          | CSS properties, JSON keys                | Red (355¬∞)                        |
1325     -    803 +    754 +     26 +| `punctuation` | Delimiters                 | `{`, `}`, `;`, `,`                       | Gray/White                        |
1326     -    804 +    755 +     27 +| `comment`     | Code comments              | `// comment`, `/* block */`              | Muted gray (220¬∞, low saturation) |
1327     -    805 +    756 +     28 +
1328     -    806 +    757 +     29 +### Markup-Specific Tokens
1329     -    807 +    758 +     30 +
1330     -    808 +    759 +     31 +| Token Class  | Purpose             | Example                     |
1331     -    809 +    760 +     32 +| ------------ | ------------------- | --------------------------- |
1332     -    810 +    761 +     33 +| `tag`        | HTML/XML tags       | `<div>`, `<p>`              |
1333     -    811 +    762 +     34 +| `attr-name`  | Attribute names     | `id`, `class`, `href`       |
1334     -    812 +    763 +     35 +| `attr-value` | Attribute values    | `"header"`, `"https://..."` |
1335     -    813 +    764 +     36 +| `namespace`  | XML namespaces      | `html:p`, `foo:bar`         |
1336     -    814 +    765 +     37 +| `prolog`     | XML prolog          | `<?xml version="1.0"?>`     |
1337     -    815 +    766 +     38 +| `doctype`    | DOCTYPE declaration | `<!DOCTYPE html>`           |
1338     -    816 +    767 +     39 +| `cdata`      | CDATA sections      | `<![CDATA[...]]>`           |
1339     -    817 +    768 +     40 +| `entity`     | HTML entities       | `&amp;`, `&#x2665;`         |
1340     -    818 +    769 +     41 +
1341     -    819 +    770 +     42 +### Document Markup Tokens
1342     -    820 +    771 +     43 +
1343     -    821 +    772 +     44 +| Token Class | Purpose         | Example      |
1344     -    822 +    773 +     45 +| ----------- | --------------- | ------------ |
1345     -    823 +    774 +     46 +| `bold`      | Bold text       | `**bold**`   |
1346     -    824 +    775 +     47 +| `italic`    | Italic text     | `*italic*`   |
1347     -    825 +    776 +     48 +| `important` | Important (CSS) | `!important` |
1348     -    826 +    777 +     49 +
1349     -    827 +    778 +     50 +### Stylesheet Tokens
1350     -    828 +    779 +     51 +
1351     -    829 +    780 +     52 +| Token Class | Purpose       | Example                  |
1352     -    830 +    781 +     53 +| ----------- | ------------- | ------------------------ |
1353     -    831 +    782 +     54 +| `atrule`    | CSS @ rules   | `@media`, `@import`      |
1354     -    832 +    783 +     55 +| `selector`  | CSS selectors | `.class`, `#id`, `div p` |
1355     -    833 +    784 +     56 +| `url`       | URLs          | `url(image.png)`         |
1356     -    834 +    785 +     57 +
1357     -    835 +    786 +     58 +### Diff Tokens
1358     -    836 +    787 +     59 +
1359     -    837 +    788 +     60 +| Token Class | Purpose       |
1360     -    838 +    789 +     61 +| ----------- | ------------- |
1361     -    839 +    790 +     62 +| `inserted`  | Added lines   |
1362     -    840 +    791 +     63 +| `deleted`   | Removed lines |
1363     -    841 +    792 +     64 +
1364     -    842 +    793 +     65 +## Professional Theme Analysis (One Dark)
1365     -    843 +    794 +     66 +
1366     -    844 +    795 +     67 +### Color Grouping Strategy
1367     -    845 +    796 +     68 +
1368     -    846 +    797 +     69 +One Dark uses **7 core hues** systematically:
1369     -    847 +    798 +     70 +
1370     -    848 +    799 +     71 +1. **mono-1** (220¬∞, 14%, 71%) - Default text
1371     -    849 +    800 +     72 +2. **mono-2** (220¬∞, 9%, 55%) - Secondary text
1372     -    850 +    801 +     73 +3. **mono-3** (220¬∞, 10%, 40%) - Comments
1373     -    851 +    802 +     74 +4. **hue-1** (187¬∞, 47%, 55%) - Cyan - URLs
1374     -    852 +    803 +     75 +5. **hue-2** (207¬∞, 82%, 66%) - Blue - Variables, operators, functions
1375     -    853 +    804 +     76 +6. **hue-3** (286¬∞, 60%, 67%) - Purple - Keywords
1376     -    854 +    805 +     77 +7. **hue-4** (95¬∞, 38%, 62%) - Green - Strings
1377     -    855 +    806 +     78 +8. **hue-5** (355¬∞, 65%, 65%) - Red - Properties, tags, symbols
1378     -    856 +    807 +     79 +9. **hue-6** (29¬∞, 54%, 61%) - Orange - Class names, constants, numbers
1379     -    857 +    808 +     80 +
1380     -    858 +    809 +     81 +### Token Grouping
1381     -    859 +    810 +     82 +
1382     -    860 +    811 +     83 +```css
1383     -    861 +    812 +     84 +/* Group 1: Comments */
1384     -    862 +    813 +     85 +.token.comment, .token.prolog, .token.cdata
1385     -    863 +    814 +     86 +
1386     -    864 +    815 +     87 +/* Group 2: Neutral (inherit default color) */
1387     -    865 +    816 +     88 +.token.doctype, .token.punctuation, .token.entity
1388     -    866 +    817 +     89 +
1389     -    867 +    818 +     90 +/* Group 3: Orange - Class names, constants, numbers */
1390     -    868 +    819 +     91 +.token.attr-name, .token.class-name, .token.boolean,
1391     -    869 +    820 +     92 +.token.constant, .token.number, .token.atrule
1392     -    870 +    821 +     93 +
1393     -    871 +    822 +     94 +/* Group 4: Purple - Keywords */
1394     -    872 +    823 +     95 +.token.keyword
1395     -    873 +    824 +     96 +
1396     -    874 +    825 +     97 +/* Group 5: Red - Properties, tags */
1397     -    875 +    826 +     98 +.token.property, .token.tag, .token.symbol,
1398     -    876 +    827 +     99 +.token.deleted, .token.important
1399     -    877 +    828 +    100 +
1400     -    878 +    829 +    101 +/* Group 6: Green - Strings, builtins */
1401     -    879 +    830 +    102 +.token.selector, .token.string, .token.char,
1402     -    880 +    831 +    103 +.token.builtin, .token.inserted, .token.regex,
1403     -    881 +    832 +    104 +.token.attr-value
1404     -    882 +    833 +    105 +
1405     -    883 +    834 +    106 +/* Group 7: Blue - Variables, operators, functions */
1406     -    884 +    835 +    107 +.token.variable, .token.operator, .token.function
1407     -    885 +    836 +    108 +
1408     -    886 +    837 +    109 +/* Group 8: Cyan - URLs */
1409     -    887 +    838 +    110 +.token.url
1410     -    888 +    839 +    111 +```
1411     -    889 +    840 +    112 +
1412     -    890 +    841 +    113 +### Language-Specific Overrides
1413     -    891 +    842 +    114 +
1414     -    892 +    843 +    115 +Professional themes use **cascading specificity** for language-specific rules:
1415     -    893 +    844 +    116 +
1416     -    894 +    845 +    117 +```css
1417     -    895 +    846 +    118 +/* JavaScript overrides */
1418     -    896 +    847 +    119 +.language-javascript .token.operator { color: purple; }
1419     -    897 +    848 +    120 +.language-javascript .token.template-string > .token.interpolation { ... }
1420     -    898 +    849 +    121 +
1421     -    899 +    850 +    122 +/* CSS overrides */
1422     -    900 +    851 +    123 +.language-css .token.selector { color: red; }
1423     -    901 +    852 +    124 +.language-css .token.property { color: gray; }
1424     -    902 +    853 +    125 +
1425     -    903 +    854 +    126 +/* JSON overrides */
1426     -    904 +    855 +    127 +.language-json .token.null.keyword { color: orange; }
1427     -    905 +    856 +    128 +
1428     -    906 +    857 +    129 +/* Markdown overrides */
1429     -    907 +    858 +    130 +.language-markdown .token.url { ... }
1430     -    908 +    859 +    131 +```
1431     -    909 +    860 +    132 +
1432     -    910 +    861 +    133 +## Implementation Architecture
1433     -    911 +    862 +    134 +
1434     -    912 +    863 +    135 +### CSS Specificity Levels
1435     -    913 +    864 +    136 +
1436     -    914 +    865 +    137 +1. **Base tokens** - All languages
1437     -    915 +    866 +    138 +2. **Language-specific overrides** - `.language-xxx .token.yyy`
1438     -    916 +    867 +    139 +3. **Nested tokens** - `.token.xxx > .token.yyy`
1439     -    917 +    868 +    140 +4. **Plugin overrides** - `.rainbow-braces`, `.diff-highlight`, etc.
1440     -    918 +    869 +    141 +
1441     -    919 +    870 +    142 +### Variable Mapping Strategy
1442     -    920 +    871 +    143 +
1443     -    921 +    872 +    144 +```css
1444     -    922 +    873 +    145 +/* Map standard Prism tokens to theme CSS variables */
1445     -    923 +    874 +    146 +.token.keyword {
1446     -    924 +    875 +    147 +  color: var(--syntax-keyword);
1447     -    925 +    876 +    148 +}
1448     -    926 +    877 +    149 +.token.string {
1449     -    927 +    878 +    150 +  color: var(--syntax-string);
1450     -    928 +    879 +    151 +}
1451     -    929 +    880 +    152 +.token.class-name {
1452     -    930 +    881 +    153 +  color: var(--syntax-class-name); /* Distinct variable! */
1453     -    931 +    882 +    154 +}
1454     -    932 +    883 +    155 +```
1455     -    933 +    884 +    156 +
1456     -    934 +    885 +    157 +### Token Aliases
1457     -    935 +    886 +    158 +
1458     -    936 +    887 +    159 +Prism uses aliases to group similar tokens:
1459     -    937 +    888 +    160 +
1460     -    938 +    889 +    161 +- `attr-value` can contain nested `punctuation` tokens
1461     -    939 +    890 +    162 +- `template-string` can contain `interpolation` with nested tokens
1462     -    940 +    891 +    163 +- Language definitions use `alias` property to inherit styles
1463     -    941 +    892 +    164 +
1464     -    942 +    893 +    165 +## Best Practices
1465     -    943 +    894 +    166 +
1466     -    944 +    895 +    167 +1. **Use Distinct Variables** - Don't reuse variables across semantically different tokens
1467     -    945 +    896 +    168 +2. **Follow Standards** - Match Prism's standard token names
1468     -    946 +    897 +    169 +3. **Language Overrides** - Use when default grouping doesn't fit
1469     -    947 +    898 +    170 +4. **Test Comprehensively** - Verify with multiple languages (Java, Python, JS, CSS, etc.)
1470     -    948 +    899 +    171 +5. **Font Weight** - Use bold/normal strategically for visual hierarchy
1471     -    949 +    900 +    172 +6. **Color Contrast** - Ensure WCAG AA compliance (4.5:1 for text)
1472     -    950 +    901 +    173 +
1473     -    951 +    902 +    174 +## Token Coverage Checklist
1474     -    952 +    903 +    175 +
1475     -    953 +    904 +    176 +### Must Cover (Core)
1476     -    954 +    905 +    177 +
1477     -    955 +    906 +    178 +- [ ] keyword
1478     -    956 +    907 +    179 +- [ ] builtin
1479     -    957 +    908 +    180 +- [ ] class-name (distinct from keyword!)
1480     -    958 +    909 +    181 +- [ ] function
1481     -    959 +    910 +    182 +- [ ] string
1482     -    960 +    911 +    183 +- [ ] number
1483     -    961 +    912 +    184 +- [ ] boolean
1484     -    962 +    913 +    185 +- [ ] comment
1485     -    963 +    914 +    186 +- [ ] operator
1486     -    964 +    915 +    187 +- [ ] punctuation
1487     -    965 +    916 +    188 +- [ ] variable
1488     -    966 +    917 +    189 +- [ ] property
1489     -    967 +    918 +    190 +- [ ] constant
1490     -    968 +    919 +    191 +- [ ] regex
1491     -    969 +    920 +    192 +
1492     -    970 +    921 +    193 +### Markup Languages
1493     -    971 +    922 +    194 +
1494     -    972 +    923 +    195 +- [ ] tag
1495     -    973 +    924 +    196 +- [ ] attr-name
1496     -    974 +    925 +    197 +- [ ] attr-value
1497     -    975 +    926 +    198 +- [ ] namespace
1498     -    976 +    927 +    199 +- [ ] doctype
1499     -    977 +    928 +    200 +- [ ] entity
1500     -    978 +    929 +    201 +
1501     -    979 +    930 +    202 +### Advanced
1502     -    980 +    931 +    203 +
1503     -    981 +    932 +    204 +- [ ] atrule (CSS)
1504     -    982 +    933 +    205 +- [ ] selector (CSS)
1505     -    983 +    934 +    206 +- [ ] url
1506     -    984 +    935 +    207 +- [ ] inserted/deleted (Diff)
1507     -    985 +    936 +    208 +- [ ] bold/italic (Markdown)
1508     -    986 +    937 +    209 +- [ ] important (CSS)
1509     -    987 + 33 938      210 +
1510     -    988 + 34     -    211 +**Problem:** Theme dropdown showing "Default Light" even when sunset-dark theme was loaded from LocalStorage.
1511     -    989 +    939 +    211 +## Implementation Checklist
1512     -    990 + 35 940      212 +
1513     -    991 + 36     -    213 +**Root Cause:** Race condition in theme loading - dropdown was being set BEFORE async theme load completed.
1514     -    992 + 37     -    214 +
1515     -    993 + 38     -    215 +**Solution:**
1516     -    994 + 39     -    216 +
1517     -    995 + 40     -    217 +```javascript
1518     -    996 + 41     -    218 +// OLD (buggy):
1519     -    997 + 42     -    219 +if (savedTheme) {
1520     -    998 + 43     -    220 +  themeSelector.value = savedTheme; // Sets immediately
1521     -    999 + 44     -    221 +  themeManager.loadTheme(savedTheme); // Async, not awaited
1522     -    1000 + 45     -    222 +}
1523     -    1001 +    941 +    213 +- [ ] Define comprehensive CSS variable palette (8-10 distinct hues)
1524     -    1002 +    942 +    214 +- [ ] Map ALL standard tokens to variables
1525     -    1003 +    943 +    215 +- [ ] Add language-specific overrides where needed
1526     -    1004 +    944 +    216 +- [ ] Test with Java (most complex token usage)
1527     -    1005 +    945 +    217 +- [ ] Test with Python, JavaScript, CSS
1528     -    1006 +    946 +    218 +- [ ] Verify font-weight hierarchy
1529     -    1007 +    947 +    219 +- [ ] Check color contrast ratios
1530     -    1008 +    948 +    220 +- [ ] Document color semantics
1531     -    1009 +    949 +    221 +
1532     -    1010 +    950 +    222 +## References
1533     -    1011 + 46 951      223 +
1534     -    1012 + 47     -    224 +// NEW (fixed):
1535     -    1013 + 48     -    225 +if (savedTheme) {
1536     -    1014 + 49     -    226 +  themeManager
1537     -    1015 + 50     -    227 +    .loadTheme(savedTheme)
1538     -    1016 + 51     -    228 +    .then(() => {
1539     -    1017 + 52     -    229 +      themeSelector.value = savedTheme; // Only after successful load
1540     -    1018 + 53     -    230 +      console.log(`‚úÖ Theme restored: ${savedTheme}`);
1541     -    1019 + 54     -    231 +    })
1542     -    1020 + 55     -    232 +    .catch(err => {
1543     -    1021 + 56     -    233 +      // Fallback with proper sync
1544     -    1022 + 57     -    234 +      themeManager.loadTheme('default-light').then(() => {
1545     -    1023 + 58     -    235 +        themeSelector.value = 'default-light';
1546     -    1024 + 59     -    236 +      });
1547     -    1025 + 60     -    237 +    });
1548     -    1026 + 61     -    238 +}
1549     -    1027 + 62     -    239 +```
1550     -    1028 + 63     -    240 +
1551     -    1029 + 64     -    241 +**Key Changes:**
1552     -    1030 + 65     -    242 +
1553     -    1031 + 66     -    243 +1. Await theme load completion before syncing dropdown
1554     -    1032 + 67     -    244 +2. Added success callback for dropdown update
1555     -    1033 + 68     -    245 +3. Added error handling with fallback
1556     -    1034 + 69     -    246 +4. Added console logging for debugging
1557     -    1035 + 70     -    247 +
1558     -    1036 + 71     -    248 +**Results:**
1559     -    1037 + 72     -    249 +
1560     -    1038 + 73     -    250 +- ‚úÖ Dropdown now syncs correctly with all themes
1561     -    1039 + 74     -    251 +- ‚úÖ No more race conditions
1562     -    1040 + 75     -    252 +- ‚úÖ Proper error handling
1563     -    1041 + 76     -    253 +- ‚úÖ Works for all 12 themes (6 theme families √ó 2 variants)
1564     -    1042 + 77     -    254 +
1565     -    1043 + 78     -    255 +**Files Modified:** `script.js` (lines 1167-1183)
1566     -    1044 + 79     -206 256  
1567     -    1045 + 80     -207 257  ## Performance Observations
1568     -    1046 + 81     -208 258  
1569     -    1047 + 82     -209 259  
1570     -    1048 +    952 +    224 +- [Prism Standard Tokens](https://prismjs.com/tokens.html)
1571     -    1049 +    953 +    225 +- [Prism Theme: One Dark](https://github.com/PrismJS/prism-themes/blob/master/themes/prism-one-dark.css)
1572     -    1050 +    954 +    226 +- [Atom One Dark Colors](https://github.com/atom/atom/tree/master/packages/one-dark-syntax)
1573     -    1051 +    955 +    227  
1574     -    1052 + 83 956  
1575     -    1053 + 84 957  ```
1576     -    1054 + 85 958  
1577     -    1055 +@@ -89,277 +962,2340 @@ memory-bank/activeContext.md |  52 +++++++++-
1578     -    1056 + 89 962  **Type:** JavaScript Source File üü®
1579     -    1057 + 90 963  
1580     -    1058 + 91 964  ```diff
1581     -    1059 + 92     -@@ -145,101 +145,10 @@ function configureMarkedExtensions() {
1582     -    1060 + 93     -145 145      return;
1583     -    1061 + 94     -146 146    }
1584     -    1062 + 95     -147 147  
1585     -    1063 + 96     -148     -  // Add LaTeX environment extensions
1586     -    1064 + 97     -    148 +  // Add inline math and text formatting extensions only
1587     -    1065 + 98     -    149 +  // LaTeX environments (align, gather, etc.) are not supported by KaTeX
1588     -    1066 + 99     -149 150    marked.use({
1589     -    1067 +100     -150 151      extensions: [
1590     -    1068 +101     -151     -      {
1591     -    1069 +102     -152     -        name: 'latexEnvironment',
1592     -    1070 +103     -153     -        level: 'block',
1593     -    1071 +104     -154     -        start(src) {
1594     -    1072 +105     -155     -          return src.match(/^\\begin\{/)?.index;
1595     -    1073 +106     -156     -        },
1596     -    1074 +107     -157     -        tokenizer(src) {
1597     -    1075 +108     -158     -          const match = src.match(/^\\begin\{([^}]+)\}([\s\S]*?)\\end\{\1\}/);
1598     -    1076 +109     -159     -          if (match) {
1599     -    1077 +110     -160     -            return {
1600     -    1078 +111     -161     -              type: 'latexEnvironment',
1601     -    1079 +112     -162     -              raw: match[0],
1602     -    1080 +113     -163     -              text: match[0],
1603     -    1081 +114     -164     -            };
1604     -    1082 +115     -165     -          }
1605     -    1083 +116     -166     -        },
1606     -    1084 +117     -167     -        renderer(token) {
1607     -    1085 +118     -168     -          try {
1608     -    1086 +119     -169     -            const rendered = katex.renderToString(token.text, {
1609     -    1087 +120     -170     -              displayMode: true,
1610     -    1088 +121     -171     -              throwOnError: false,
1611     -    1089 +122     -172     -              trust: true,
1612     -    1090 +123     -173     -              strict: false,
1613     -    1091 +124     -174     -            });
1614     -    1092 +125     -175     -            return `<div class="katex-display">${rendered}</div>`;
1615     -    1093 +126     -176     -          } catch (e) {
1616     -    1094 +127     -177     -            console.warn('KaTeX environment render error:', e);
1617     -    1095 +128     -178     -            return `<div style="color: red; padding: 10px;">LaTeX Error: ${e.message}</div>`;
1618     -    1096 +129     -179     -          }
1619     -    1097 +130     -180     -        },
1620     -    1098 +131     -181     -      },
1621     -    1099 +132     -182     -      {
1622     -    1100 +133     -183     -        name: 'latexDisplayBracket',
1623     -    1101 +134     -184     -        level: 'block',
1624     -    1102 +135     -185     -        start(src) {
1625     -    1103 +136     -186     -          return src.match(/^\\\[/)?.index;
1626     -    1104 +137     -187     -        },
1627     -    1105 +138     -188     -        tokenizer(src) {
1628     -    1106 +139     -189     -          const match = src.match(/^\\\[([\s\S]*?)\\\]/);
1629     -    1107 +140     -190     -          if (match) {
1630     -    1108 +141     -191     -            return {
1631     -    1109 +142     -192     -              type: 'latexDisplayBracket',
1632     -    1110 +143     -193     -              raw: match[0],
1633     -    1111 +144     -194     -              text: match[1].trim(),
1634     -    1112 +145     -195     -            };
1635     -    1113 +146     -196     -          }
1636     -    1114 +147     -197     -        },
1637     -    1115 +148     -198     -        renderer(token) {
1638     -    1116 +149     -199     -          try {
1639     -    1117 +150     -200     -            const rendered = katex.renderToString(token.text, {
1640     -    1118 +151     -201     -              displayMode: true,
1641     -    1119 +152     -202     -              throwOnError: false,
1642     -    1120 +153     -203     -              trust: true,
1643     -    1121 +154     -204     -              strict: false,
1644     -    1122 +155     -205     -            });
1645     -    1123 +156     -206     -            return `<div class="katex-display">${rendered}</div>`;
1646     -    1124 +157     -207     -          } catch (e) {
1647     -    1125 +158     -208     -            console.warn('KaTeX bracket render error:', e);
1648     -    1126 +159     -209     -            return `<div style="color: red; padding: 10px;">LaTeX Error: ${e.message}</div>`;
1649     -    1127 +160     -210     -          }
1650     -    1128 +161     -211     -        },
1651     -    1129 +162     -212     -      },
1652     -    1130 +163     -213     -      {
1653     -    1131 +164     -214     -        name: 'latexInlineParen',
1654     -    1132 +165     -215     -        level: 'inline',
1655     -    1133 +166     -216     -        start(src) {
1656     -    1134 +167     -217     -          return src.match(/\\\(/)?.index;
1657     -    1135 +168     -218     -        },
1658     -    1136 +169     -219     -        tokenizer(src) {
1659     -    1137 +170     -220     -          const match = src.match(/^\\\(([\s\S]*?)\\\)/);
1660     -    1138 +171     -221     -          if (match) {
1661     -    1139 +172     -222     -            return {
1662     -    1140 +173     -223     -              type: 'latexInlineParen',
1663     -    1141 +174     -224     -              raw: match[0],
1664     -    1142 +175     -225     -              text: match[1].trim(),
1665     -    1143 +176     -226     -            };
1666     -    1144 +177     -227     -          }
1667     -    1145 +178     -228     -        },
1668     -    1146 +179     -229     -        renderer(token) {
1669     -    1147 +180     -230     -          try {
1670     -    1148 +181     -231     -            return katex.renderToString(token.text, {
1671     -    1149 +182     -232     -              displayMode: false,
1672     -    1150 +183     -233     -              throwOnError: false,
1673     -    1151 +184     -234     -              trust: true,
1674     -    1152 +185     -235     -              strict: false,
1675     -    1153 +186     -236     -            });
1676     -    1154 +187     -237     -          } catch (e) {
1677     -    1155 +188     -238     -            console.warn('KaTeX paren render error:', e);
1678     -    1156 +189     -239     -            return `<span style="color: red;">LaTeX Error</span>`;
1679     -    1157 +190     -240     -          }
1680     -    1158 +191     -241     -        },
1681     -    1159 +192     -242     -      },
1682     -    1160 +193     -243 152        {
1683     -    1161 +194     -244 153          name: 'mathBlock',
1684     -    1162 +195     -245 154          level: 'block',
1685     -    1163 +196     -@@ -503,101 +412,10 @@ graph TD
1686     -    1164 +197     -503 412      return textarea.value;
1687     -    1165 +198     -504 413    }
1688     -    1166 +199     -505 414  
1689     -    1167 +200     -506     -  // Add LaTeX environment extensions that render directly with KaTeX
1690     -    1168 +201     -    415 +  // Keep only subscript and superscript extensions
1691     -    1169 +202     -    416 +  // Remove LaTeX environment extensions that don't work with KaTeX
1692     -    1170 +203     -507 417    marked.use({
1693     -    1171 +204     -508 418      extensions: [
1694     -    1172 +205     -509     -      {
1695     -    1173 +206     -510     -        name: 'latexEnvironment',
1696     -    1174 +207     -511     -        level: 'block',
1697     -    1175 +208     -512     -        start(src) {
1698     -    1176 +209     -513     -          return src.match(/^\\begin\{/)?.index;
1699     -    1177 +210     -514     -        },
1700     -    1178 +211     -515     -        tokenizer(src) {
1701     -    1179 +212     -516     -          const match = src.match(/^\\begin\{([^}]+)\}([\s\S]*?)\\end\{\1\}/);
1702     -    1180 +213     -517     -          if (match) {
1703     -    1181 +214     -518     -            return {
1704     -    1182 +215     -519     -              type: 'latexEnvironment',
1705     -    1183 +216     -520     -              raw: match[0],
1706     -    1184 +217     -521     -              text: match[0],
1707     -    1185 +218     -522     -            };
1708     -    1186 +219     -523     -          }
1709     -    1187 +220     -524     -        },
1710     -    1188 +221     -525     -        renderer(token) {
1711     -    1189 +222     -526     -          try {
1712     -    1190 +223     -527     -            const rendered = katex.renderToString(token.text, {
1713     -    1191 +224     -528     -              displayMode: true,
1714     -    1192 +225     -529     -              throwOnError: false,
1715     -    1193 +226     -530     -              trust: true,
1716     -    1194 +227     -531     -              strict: false,
1717     -    1195 +228     -532     -            });
1718     -    1196 +229     -533     -            return `<div class="katex-display">${rendered}</div>`;
1719     -    1197 +230     -534     -          } catch (e) {
1720     -    1198 +231     -535     -            console.warn('KaTeX environment render error:', e);
1721     -    1199 +232     -536     -            return `<div style="color: red; padding: 10px;">LaTeX Error: ${e.message}</div>`;
1722     -    1200 +233     -537     -          }
1723     -    1201 +234     -538     -        },
1724     -    1202 +235     -539     -      },
1725     -    1203 +236     -540     -      {
1726     -    1204 +237     -541     -        name: 'latexDisplayBracket',
1727     -    1205 +238     -542     -        level: 'block',
1728     -    1206 +239     -543     -        start(src) {
1729     -    1207 +240     -544     -          return src.match(/^\\\[/)?.index;
1730     -    1208 +241     -545     -        },
1731     -    1209 +242     -546     -        tokenizer(src) {
1732     -    1210 +243     -547     -          const match = src.match(/^\\\[([\s\S]*?)\\\]/);
1733     -    1211 +244     -548     -          if (match) {
1734     -    1212 +245     -549     -            return {
1735     -    1213 +246     -550     -              type: 'latexDisplayBracket',
1736     -    1214 +247     -551     -              raw: match[0],
1737     -    1215 +248     -552     -              text: match[1].trim(),
1738     -    1216 +249     -553     -            };
1739     -    1217 +250     -554     -          }
1740     -    1218 +251     -555     -        },
1741     -    1219 +252     -556     -        renderer(token) {
1742     -    1220 +253     -557     -          try {
1743     -    1221 +254     -558     -            const rendered = katex.renderToString(token.text, {
1744     -    1222 +255     -559     -              displayMode: true,
1745     -    1223 +256     -560     -              throwOnError: false,
1746     -    1224 +257     -561     -              trust: true,
1747     -    1225 +258     -562     -              strict: false,
1748     -    1226 +259     -563     -            });
1749     -    1227 +260     -564     -            return `<div class="katex-display">${rendered}</div>`;
1750     -    1228 +261     -565     -          } catch (e) {
1751     -    1229 +262     -566     -            console.warn('KaTeX bracket render error:', e);
1752     -    1230 +263     -567     -            return `<div style="color: red; padding: 10px;">LaTeX Error: ${e.message}</div>`;
1753     -    1231 +264     -568     -          }
1754     -    1232 +265     -569     -        },
1755     -    1233 +266     -570     -      },
1756     -    1234 +267     -571     -      {
1757     -    1235 +268     -572     -        name: 'latexInlineParen',
1758     -    1236 +269     -573     -        level: 'inline',
1759     -    1237 +270     -574     -        start(src) {
1760     -    1238 +271     -575     -          return src.match(/\\\(/)?.index;
1761     -    1239 +272     -576     -        },
1762     -    1240 +273     -577     -        tokenizer(src) {
1763     -    1241 +274     -578     -          const match = src.match(/^\\\(([\s\S]*?)\\\)/);
1764     -    1242 +275     -579     -          if (match) {
1765     -    1243 +276     -580     -            return {
1766     -    1244 +277     -581     -              type: 'latexInlineParen',
1767     -    1245 +278     -582     -              raw: match[0],
1768     -    1246 +279     -583     -              text: match[1].trim(),
1769     -    1247 +280     -584     -            };
1770     -    1248 +281     -585     -          }
1771     -    1249 +282     -586     -        },
1772     -    1250 +283     -587     -        renderer(token) {
1773     -    1251 +284     -588     -          try {
1774     -    1252 +285     -589     -            return katex.renderToString(token.text, {
1775     -    1253 +286     -590     -              displayMode: false,
1776     -    1254 +287     -591     -              throwOnError: false,
1777     -    1255 +288     -592     -              trust: true,
1778     -    1256 +289     -593     -              strict: false,
1779     -    1257 +290     -594     -            });
1780     -    1258 +291     -595     -          } catch (e) {
1781     -    1259 +292     -596     -            console.warn('KaTeX paren render error:', e);
1782     -    1260 +293     -597     -            return `<span style="color: red;">LaTeX Error</span>`;
1783     -    1261 +294     -598     -          }
1784     -    1262 +295     -599     -        },
1785     -    1263 +296     -600     -      },
1786     -    1264 +297     -601 419        {
1787     -    1265 +298     -602 420          name: 'subscript',
1788     -    1266 +299     -603 421          level: 'inline',
1789     -    1267 +300     -@@ -641,7 +459,7 @@ graph TD
1790     -    1268 +301     -641 459      ],
1791     -    1269 +302     -642 460    });
1792     -    1270 +303     -643 461  
1793     -    1271 +304     -644     -  console.log('‚úÖ LaTeX environments, subscript, and superscript enabled');
1794     -    1272 +305     -    462 +  console.log('‚úÖ Subscript and superscript enabled (LaTeX environments display as-is)');
1795     -    1273 +306     -645 463  
1796     -    1274 +307     -646 464    // Render markdown
1797     -    1275 +308     -647 465    function renderMarkdown() {
1798     -    1276 +309     -@@ -685,22 +503,9 @@ graph TD
1799     -    1277 +310     -685 503        // Apply Prism syntax highlighting using PrismService
1800     -    1278 +311     -686 504        prismService.highlightAll(preview);
1801     -    1279 +312     -687 505  
1802     -    1280 +313     -688     -      // Apply KaTeX auto-render only for any remaining $...$ syntax
1803     -    1281 +314     -689     -      if (typeof renderMathInElement !== 'undefined') {
1804     -    1282 +315     -690     -        try {
1805     -    1283 +316     -691     -          renderMathInElement(preview, {
1806     -    1284 +317     -692     -            delimiters: [
1807     -    1285 +318     -693     -              { left: '$$', right: '$$', display: true },
1808     -    1286 +319     -694     -              { left: '$', right: '$', display: false },
1809     -    1287 +320     -695     -            ],
1810     -    1288 +321     -696     -            throwOnError: false,
1811     -    1289 +322     -697     -            trust: true,
1812     -    1290 +323     -698     -            strict: false,
1813     -    1291 +324     -699     -          });
1814     -    1292 +325     -700     -        } catch (e) {
1815     -    1293 +326     -701     -          console.warn('KaTeX auto-render error:', e);
1816     -    1294 +327     -702     -        }
1817     -    1295 +328     -703     -      }
1818     -    1296 +329     -    506 +      // NOTE: KaTeX auto-render is DISABLED
1819     -    1297 +330     -    507 +      // We handle all math via marked.js extensions ($...$ and $$...$$)
1820     -    1298 +331     -    508 +      // KaTeX auto-render was causing issues with unsupported LaTeX environments
1821     -    1299 +332     -704 509  
1822     -    1300 +333     -705 510        // Save content using StorageManager
1823     -    1301 +334     -706 511        storageManager.set('markdownContent', markdownText);
1824     -    1302 +335     -@@ -1167,11 +972,21 @@ graph TD
1825     -    1303 +336     -1167 972    // Load saved theme using ThemeManager
1826     -    1304 +337     -1168 973    const savedTheme = storageManager.get('selectedTheme');
1827     -    1305 +338     -1169 974    if (savedTheme) {
1828     -    1306 +339     -1170     -    themeSelector.value = savedTheme;
1829     -    1307 +340     -1171     -    themeManager.loadTheme(savedTheme).catch(err => {
1830     -    1308 +341     -1172     -      console.error('Failed to load saved theme:', err);
1831     -    1309 +342     -1173     -      themeManager.loadTheme('default-light');
1832     -    1310 +343     -1174     -    });
1833     -    1311 +344     -    975 +    // Load theme first, then sync dropdown only on success
1834     -    1312 +345     -    976 +    themeManager
1835     -    1313 +346     -    977 +      .loadTheme(savedTheme)
1836     -    1314 +347     -    978 +      .then(() => {
1837     -    1315 +348     -    979 +        // Theme loaded successfully - sync dropdown
1838     -    1316 +349     -    980 +        themeSelector.value = savedTheme;
1839     -    1317 +350     -    981 +        console.log(`‚úÖ Theme restored: ${savedTheme}`);
1840     -    1318 +351     -    982 +      })
1841     -    1319 +352     -    983 +      .catch(err => {
1842     -    1320 +353     -    984 +        console.error('Failed to load saved theme:', err);
1843     -    1321 +354     -    985 +        // Fallback to default-light on error
1844     -    1322 +355     -    986 +        themeManager.loadTheme('default-light').then(() => {
1845     -    1323 +356     -    987 +          themeSelector.value = 'default-light';
1846     -    1324 +357     -    988 +        });
1847     -    1325 +358     -    989 +      });
1848     -    1326 +359     -1175 990    }
1849     -    1327 +360     -1176 991  
1850     -    1328 +361     -1177 992    // Zoom functionality
1851     -    1329 +362     -1178 993  
1852     -    1330 +    965 +@@ -20,9 +20,20 @@ const folderBrowserService = new FolderBrowserService(storageManager);
1853     -    1331 +    966 + 20  20  const currentFolderFiles = [];
1854     -    1332 +    967 + 21  21  const currentFileHandle = null;
1855     -    1333 +    968 + 22  22  
1856     -    1334 +    969 + 23     -// Configure theme change listener to update Mermaid
1857     -    1335 +    970 +     23 +// Global render function reference (will be set in setupEditor)
1858     -    1336 +    971 +     24 +let globalRenderMarkdown = null;
1859     -    1337 +    972 +     25 +
1860     -    1338 +    973 +     26 +// Configure theme change listener to update Mermaid and force re-render
1861     -    1339 +    974 + 24  27  themeManager.setThemeChangeListener(() => {
1862     -    1340 +    975 + 25  28    mermaidService.reinitialize();
1863     -    1341 +    976 +     29 +
1864     -    1342 +    977 +     30 +  // Force re-render of markdown to apply new Mermaid colors
1865     -    1343 +    978 +     31 +  setTimeout(() => {
1866     -    1344 +    979 +     32 +    if (globalRenderMarkdown) {
1867     -    1345 +    980 +     33 +      console.log('üîÑ Re-rendering diagrams with new theme colors');
1868     -    1346 +    981 +     34 +      globalRenderMarkdown();
1869     -    1347 +    982 +     35 +    }
1870     -    1348 +    983 +     36 +  }, 200);
1871     -    1349 +    984 + 26  37  });
1872     -    1350 +    985 + 27  38  
1873     -    1351 +    986 + 28  39  // Wait for all scripts to load
1874     -    1352 +    987 +@@ -77,8 +88,8 @@ function initializeApp() {
1875     -    1353 +    988 + 77  88    // Configure marked.js extensions
1876     -    1354 +    989 + 78  89    configureMarkedExtensions();
1877     -    1355 +    990 + 79  90  
1878     -    1356 +    991 + 80     -  // Initialize Mermaid with theme-aware configuration
1879     -    1357 +    992 + 81     -  initMermaidTheme();
1880     -    1358 +    993 +     91 +  // DON'T initialize Mermaid here - let saved theme load first
1881     -    1359 +    994 +     92 +  // Mermaid will initialize after theme loads in setupEditor()
1882     -    1360 +    995 + 82  93  
1883     -    1361 +    996 + 83  94    setupEditor();
1884     -    1362 +    997 + 84  95  }
1885     -    1363 +    998 +@@ -461,7 +472,7 @@ graph TD
1886     -    1364 +    999 +461 472  
1887     -    1365 +    1000 +462 473    console.log('‚úÖ Subscript and superscript enabled (LaTeX environments display as-is)');
1888     -    1366 +    1001 +463 474  
1889     -    1367 +    1002 +464     -  // Render markdown
1890     -    1368 +    1003 +    475 +  // Render markdown (expose globally for theme changes)
1891     -    1369 +    1004 +465 476    function renderMarkdown() {
1892     -    1370 +    1005 +466 477      try {
1893     -    1371 +    1006 +467 478        const markdownText = editor.value;
1894     -    1372 +    1007 +@@ -520,8 +531,16 @@ graph TD
1895     -    1373 +    1008 +520 531    async function changeTheme(themeName) {
1896     -    1374 +    1009 +521 532      await themeManager.loadTheme(themeName);
1897     -    1375 +    1010 +522 533  
1898     -    1376 +    1011 +523     -    // Re-render to apply new Mermaid theme (observer already handles reinit)
1899     -    1377 +    1012 +    534 +    // Wait for theme to load, then reinitialize Mermaid and force re-render
1900     -    1378 +    1013 +524 535      setTimeout(() => {
1901     -    1379 +    1014 +    536 +      // Clear existing Mermaid diagrams to force fresh render with new colors
1902     -    1380 +    1015 +    537 +      const mermaidElements = preview.querySelectorAll('.mermaid');
1903     -    1381 +    1016 +    538 +      mermaidElements.forEach(el => {
1904     -    1382 +    1017 +    539 +        // Reset to original code to force re-render
1905     -    1383 +    1018 +    540 +        el.innerHTML = el.dataset.originalCode || '';
1906     -    1384 +    1019 +    541 +      });
1907     -    1385 +    1020 +    542 +
1908     -    1386 +    1021 +    543 +      // Re-render markdown with new theme
1909     -    1387 +    1022 +525 544        renderMarkdown();
1910     -    1388 +    1023 +526 545      }, 100);
1911     -    1389 +    1024 +527 546    }
1912     -    1390 +    1025 +@@ -969,24 +988,36 @@ graph TD
1913     -    1391 +    1026 +969 988    // Initialize visibility
1914     -    1392 +    1027 +970 989    updateSyncScrollVisibility();
1915     -    1393 +    1028 +971 990  
1916     -    1394 +    1029 +972     -  // Load saved theme using ThemeManager
1917     -    1395 +    1030 +    991 +  // Load saved theme FIRST, then initialize Mermaid with correct colors
1918     -    1396 +    1031 +973 992    const savedTheme = storageManager.get('selectedTheme');
1919     -    1397 +    1032 +974 993    if (savedTheme) {
1920     -    1398 +    1033 +975     -    // Load theme first, then sync dropdown only on success
1921     -    1399 +    1034 +    994 +    // Load theme first, then sync dropdown and reinit Mermaid
1922     -    1400 +    1035 +976 995      themeManager
1923     -    1401 +    1036 +977 996        .loadTheme(savedTheme)
1924     -    1402 +    1037 +978 997        .then(() => {
1925     -    1403 +    1038 +979 998          // Theme loaded successfully - sync dropdown
1926     -    1404 +    1039 +980 999          themeSelector.value = savedTheme;
1927     -    1405 +    1040 +981 1000          console.log(`‚úÖ Theme restored: ${savedTheme}`);
1928     -    1406 +    1041 +    1001 +
1929     -    1407 +    1042 +    1002 +        // NOW initialize Mermaid with correct theme colors
1930     -    1408 +    1043 +    1003 +        mermaidService.initialize();
1931     -    1409 +    1044 +    1004 +
1932     -    1410 +    1045 +    1005 +        // Re-render to apply theme
1933     -    1411 +    1046 +    1006 +        renderMarkdown();
1934     -    1412 +    1047 +982 1007        })
1935     -    1413 +    1048 +983 1008        .catch(err => {
1936     -    1414 +    1049 +984 1009          console.error('Failed to load saved theme:', err);
1937     -    1415 +    1050 +985 1010          // Fallback to default-light on error
1938     -    1416 +    1051 +986 1011          themeManager.loadTheme('default-light').then(() => {
1939     -    1417 +    1052 +987 1012            themeSelector.value = 'default-light';
1940     -    1418 +    1053 +    1013 +          mermaidService.initialize();
1941     -    1419 +    1054 +    1014 +          renderMarkdown();
1942     -    1420 +    1055 +988 1015          });
1943     -    1421 +    1056 +989 1016        });
1944     -    1422 +    1057 +    1017 +  } else {
1945     -    1423 +    1058 +    1018 +    // No saved theme - initialize with default-light
1946     -    1424 +    1059 +    1019 +    mermaidService.initialize();
1947     -    1425 +    1060 +    1020 +    renderMarkdown();
1948     -    1426 +    1061 +990 1021    }
1949     -    1427 +    1062 +991 1022  
1950     -    1428 +    1063 +992 1023    // Zoom functionality
1951     -    1429 +    1064 +@@ -1332,6 +1363,9 @@ graph TD
1952     -    1430 +    1065 +1332 1363      console.log(`‚úÖ Loaded file: ${fileItem.name} (${result.size} bytes)`);
1953     -    1431 +    1066 +1333 1364    }
1954     -    1432 +    1067 +1334 1365  
1955     -    1433 +    1068 +1335     -  // Initial render
1956     -    1434 +    1069 +1336     -  renderMarkdown();
1957     -    1435 +    1070 +    1366 +  // Expose renderMarkdown globally for theme changes
1958     -    1436 +    1071 +    1367 +  globalRenderMarkdown = renderMarkdown;
1959     -    1437 +    1072 +    1368 +
1960     -    1438 +    1073 +    1369 +  // DON'T render immediately - wait for theme to load
1961     -    1439 +    1074 +    1370 +  // renderMarkdown will be called after theme loads above
1962     -    1440 +    1075 +1337 1371  }
1963     -    1441 +    1076 +1338 1372  
1964     -    1442 +    1077 +
1965     -    1443 +    1078 +```
1966     -    1444 +    1079 +
1967     -    1445 +    1080 +
1968     -    1446 +    1081 +### üìÑ `src/js/services/MermaidService.js`
1969     -    1447 +    1082 +
1970     -    1448 +    1083 +**Type:** JavaScript Source File üü®
1971     -    1449 +    1084 +
1972     -    1450 +    1085 +```diff
1973     -    1451 +    1086 +@@ -2,12 +2,51 @@
1974     -    1452 +    1087 +  2   2   * MermaidService - Mermaid Diagram Rendering Service
1975     -    1453 +    1088 +  3   3   *
1976     -    1454 +    1089 +  4   4   * Handles all Mermaid diagram rendering with theme-aware configuration.
1977     -    1455 +    1090 +      5 + * Automatically detects light/dark themes and adjusts for optimal readability.
1978     -    1456 +    1091 +  5   6   * Isolated service for better testability and maintainability.
1979     -    1457 +    1092 +  6   7   */
1980     -    1458 +    1093 +  7   8  
1981     -    1459 +    1094 +  8   9  import { MERMAID_CONFIG } from '../config/constants.js';
1982     -    1460 +    1095 +  9  10  import { getCssVariable } from '../utils/colorHelpers.js';
1983     -    1461 +    1096 + 10  11  
1984     -    1462 +    1097 +     12 +/**
1985     -    1463 +    1098 +     13 + * Calculate relative luminance of a color
1986     -    1464 +    1099 +     14 + * Used to detect if theme is light or dark
1987     -    1465 +    1100 +     15 + *
1988     -    1466 +    1101 +     16 + * @param {string} color - Hex color (#rrggbb)
1989     -    1467 +    1102 +     17 + * @returns {number} Luminance value (0-1)
1990     -    1468 +    1103 +     18 + * @private
1991     -    1469 +    1104 +     19 + */
1992     -    1470 +    1105 +     20 +function getRelativeLuminance(color) {
1993     -    1471 +    1106 +     21 +  // Remove # if present
1994     -    1472 +    1107 +     22 +  const hex = color.replace('#', '');
1995     -    1473 +    1108 +     23 +
1996     -    1474 +    1109 +     24 +  // Convert to RGB
1997     -    1475 +    1110 +     25 +  const r = parseInt(hex.substr(0, 2), 16) / 255;
1998     -    1476 +    1111 +     26 +  const g = parseInt(hex.substr(2, 2), 16) / 255;
1999     -    1477 +    1112 +     27 +  const b = parseInt(hex.substr(4, 2), 16) / 255;
2000     -    1478 +    1113 +     28 +
2001     -    1479 +    1114 +     29 +  // Apply sRGB gamma correction
2002     -    1480 +    1115 +     30 +  const rsRGB = r <= 0.03928 ? r / 12.92 : ((r + 0.055) / 1.055) ** 2.4;
2003     -    1481 +    1116 +     31 +  const gsRGB = g <= 0.03928 ? g / 12.92 : ((g + 0.055) / 1.055) ** 2.4;
2004     -    1482 +    1117 +     32 +  const bsRGB = b <= 0.03928 ? b / 12.92 : ((b + 0.055) / 1.055) ** 2.4;
2005     -    1483 +    1118 +     33 +
2006     -    1484 +    1119 +     34 +  // Calculate relative luminance
2007     -    1485 +    1120 +     35 +  return 0.2126 * rsRGB + 0.7152 * gsRGB + 0.0722 * bsRGB;
2008     -    1486 +    1121 +     36 +}
2009     -    1487 +    1122 +     37 +
2010     -    1488 +    1123 +     38 +/**
2011     -    1489 +    1124 +     39 + * Detect if current theme is light or dark
2012     -    1490 +    1125 +     40 + *
2013     -    1491 +    1126 +     41 + * @param {string} bgColor - Background color
2014     -    1492 +    1127 +     42 + * @returns {boolean} True if light theme
2015     -    1493 +    1128 +     43 + * @private
2016     -    1494 +    1129 +     44 + */
2017     -    1495 +    1130 +     45 +function isLightTheme(bgColor) {
2018     -    1496 +    1131 +     46 +  const luminance = getRelativeLuminance(bgColor);
2019     -    1497 +    1132 +     47 +  return luminance > 0.5; // Threshold for light/dark
2020     -    1498 +    1133 +     48 +}
2021     -    1499 +    1134 +     49 +
2022     -    1500 +    1135 + 11  50  /**
2023     -    1501 +    1136 + 12  51   * @class MermaidService
2024     -    1502 +    1137 + 13  52   * @description Service for rendering Mermaid diagrams with theme integration
2025     -    1503 +    1138 +@@ -23,46 +62,187 @@ export class MermaidService {
2026     -    1504 +    1139 + 23  62    }
2027     -    1505 +    1140 + 24  63  
2028     -    1506 +    1141 + 25  64    /**
2029     -    1507 +    1142 + 26     -   * Initialize Mermaid with current theme colors
2030     -    1508 +    1143 + 27     -   * Extracts theme colors from CSS variables and configures Mermaid
2031     -    1509 +    1144 +     65 +   * Initialize Mermaid with COMPREHENSIVE theme configuration
2032     -    1510 +    1145 +     66 +   * Reads ALL 60+ variables from theme CSS with smart fallbacks
2033     -    1511 +    1146 +     67 +   * Based on official Mermaid.js theming documentation
2034     -    1512 +    1147 + 28  68     *
2035     -    1513 +    1148 + 29  69     * @returns {void}
2036     -    1514 +    1149 + 30  70     */
2037     -    1515 +    1150 + 31  71    initialize() {
2038     -    1516 +    1151 + 32     -    // Extract theme colors from CSS variables
2039     -    1517 +    1152 + 33     -    const h1Color = getCssVariable('--h1-color');
2040     -    1518 +    1153 + 34     -    const h2Color = getCssVariable('--h2-color');
2041     -    1519 +    1154 + 35     -    const h3Color = getCssVariable('--h3-color');
2042     -    1520 +    1155 + 36     -    const bgSecondary = getCssVariable('--bg-secondary');
2043     -    1521 +    1156 + 37     -    const textPrimary = getCssVariable('--text-primary');
2044     -    1522 +    1157 +     72 +    // Helper to get variable with fallback
2045     -    1523 +    1158 +     73 +    const get = (varName, fallback) => {
2046     -    1524 +    1159 +     74 +      const value = getCssVariable(varName);
2047     -    1525 +    1160 +     75 +      return value && value.trim() !== '' ? value : fallback;
2048     -    1526 +    1161 +     76 +    };
2049     -    1527 +    1162 +     77 +
2050     -    1528 +    1163 +     78 +    // Extract core theme colors for fallbacks
2051     -    1529 +    1164 +     79 +    const bgPri = getCssVariable('--bg-primary');
2052     -    1530 +    1165 +     80 +    const bgSec = getCssVariable('--bg-secondary');
2053     -    1531 +    1166 +     81 +    const bgTer = getCssVariable('--bg-tertiary');
2054     -    1532 +    1167 +     82 +    const txtPri = getCssVariable('--text-primary');
2055     -    1533 +    1168 +     83 +    const txtSec = getCssVariable('--text-secondary');
2056     -    1534 +    1169 +     84 +    const h1 = getCssVariable('--h1-color');
2057     -    1535 +    1170 +     85 +    const h2 = getCssVariable('--h2-color');
2058     -    1536 +    1171 +     86 +    const h3 = getCssVariable('--h3-color');
2059     -    1537 +    1172 +     87 +
2060     -    1538 +    1173 +     88 +    const isLight = isLightTheme(bgPri);
2061     -    1539 +    1174 +     89 +    const nodeBkg = isLight ? bgTer : bgSec;
2062     -    1540 +    1175 +     90 +    const clusterBkg = isLight ? bgSec : bgTer;
2063     -    1541 +    1176 + 38  91  
2064     -    1542 +    1177 + 39     -    // Configure Mermaid with theme colors
2065     -    1543 +    1178 + 40  92      if (typeof mermaid !== 'undefined') {
2066     -    1544 +    1179 + 41  93        mermaid.initialize({
2067     -    1545 +    1180 + 42  94          startOnLoad: MERMAID_CONFIG.START_ON_LOAD,
2068     -    1546 +    1181 + 43  95          theme: MERMAID_CONFIG.THEME,
2069     -    1547 +    1182 + 44  96          themeVariables: {
2070     -    1548 +    1183 + 45     -          primaryColor: bgSecondary,
2071     -    1549 +    1184 + 46     -          primaryTextColor: textPrimary,
2072     -    1550 +    1185 + 47     -          primaryBorderColor: h1Color,
2073     -    1551 +    1186 + 48     -          lineColor: h2Color,
2074     -    1552 +    1187 + 49     -          secondaryColor: bgSecondary,
2075     -    1553 +    1188 + 50     -          tertiaryColor: bgSecondary,
2076     -    1554 +    1189 + 51     -          background: bgSecondary,
2077     -    1555 +    1190 + 52     -          mainBkg: bgSecondary,
2078     -    1556 +    1191 + 53     -          secondBkg: bgSecondary,
2079     -    1557 +    1192 + 54     -          tertiaryBkg: bgSecondary,
2080     -    1558 +    1193 + 55     -          nodeBorder: h1Color,
2081     -    1559 +    1194 + 56     -          clusterBkg: bgSecondary,
2082     -    1560 +    1195 + 57     -          clusterBorder: h3Color,
2083     -    1561 +    1196 + 58     -          titleColor: textPrimary,
2084     -    1562 +    1197 + 59     -          edgeLabelBackground: bgSecondary,
2085     -    1563 +    1198 + 60     -          nodeTextColor: textPrimary,
2086     -    1564 +    1199 +     97 +          // Core Global
2087     -    1565 +    1200 +     98 +          background: get('--mermaid-background', bgPri),
2088     -    1566 +    1201 + 61  99            fontFamily: '-apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif',
2089     -    1567 +    1202 +    100 +          fontSize: '16px',
2090     -    1568 +    1203 +    101 +          darkMode: !isLight,
2091     -    1569 +    1204 +    102 +          textColor: get('--mermaid-text-color', txtPri),
2092     -    1570 +    1205 +    103 +          lineColor: get('--mermaid-line-color', h2),
2093     -    1571 +    1206 +    104 +          mainBkg: get('--mermaid-main-bkg', nodeBkg),
2094     -    1572 +    1207 +    105 +
2095     -    1573 +    1208 +    106 +          // Primary Set
2096     -    1574 +    1209 +    107 +          primaryColor: get('--mermaid-primary-color', nodeBkg),
2097     -    1575 +    1210 +    108 +          primaryTextColor: get('--mermaid-primary-text-color', txtPri),
2098     -    1576 +    1211 +    109 +          primaryBorderColor: get('--mermaid-primary-border-color', h1),
2099     -    1577 +    1212 +    110 +
2100     -    1578 +    1213 +    111 +          // Secondary Set
2101     -    1579 +    1214 +    112 +          secondaryColor: get('--mermaid-secondary-color', clusterBkg),
2102     -    1580 +    1215 +    113 +          secondaryTextColor: get('--mermaid-secondary-text-color', txtPri),
2103     -    1581 +    1216 +    114 +          secondaryBorderColor: get('--mermaid-secondary-border-color', h2),
2104     -    1582 +    1217 +    115 +
2105     -    1583 +    1218 +    116 +          // Tertiary Set
2106     -    1584 +    1219 +    117 +          tertiaryColor: get('--mermaid-tertiary-color', bgPri),
2107     -    1585 +    1220 +    118 +          tertiaryTextColor: get('--mermaid-tertiary-text-color', txtPri),
2108     -    1586 +    1221 +    119 +          tertiaryBorderColor: get('--mermaid-tertiary-border-color', h3),
2109     -    1587 +    1222 +    120 +
2110     -    1588 +    1223 +    121 +          // Flowchart
2111     -    1589 +    1224 +    122 +          nodeBorder: get('--mermaid-node-border', h1),
2112     -    1590 +    1225 +    123 +          clusterBkg: get('--mermaid-cluster-bkg', clusterBkg),
2113     -    1591 +    1226 +    124 +          clusterBorder: get('--mermaid-cluster-border', h2),
2114     -    1592 +    1227 +    125 +          defaultLinkColor: get('--mermaid-default-link-color', h2),
2115     -    1593 +    1228 +    126 +          titleColor: get('--mermaid-title-color', txtPri),
2116     -    1594 +    1229 +    127 +          edgeLabelBackground: get('--mermaid-edge-label-background', bgPri),
2117     -    1595 +    1230 +    128 +          nodeTextColor: get('--mermaid-node-text-color', txtPri),
2118     -    1596 +    1231 +    129 +
2119     -    1597 +    1232 +    130 +          // Sequence Diagram
2120     -    1598 +    1233 +    131 +          actorBkg: get('--mermaid-actor-bkg', nodeBkg),
2121     -    1599 +    1234 +    132 +          actorBorder: get('--mermaid-actor-border', h1),
2122     -    1600 +    1235 +    133 +          actorTextColor: get('--mermaid-actor-text-color', txtPri),
2123     -    1601 +    1236 +    134 +          actorLineColor: get('--mermaid-actor-line-color', h1),
2124     -    1602 +    1237 +    135 +          signalColor: get('--mermaid-signal-color', h2),
2125     -    1603 +    1238 +    136 +          signalTextColor: get('--mermaid-signal-text-color', txtPri),
2126     -    1604 +    1239 +    137 +          labelBoxBkgColor: get('--mermaid-label-box-bkg-color', nodeBkg),
2127     -    1605 +    1240 +    138 +          labelBoxBorderColor: get('--mermaid-label-box-border-color', h1),
2128     -    1606 +    1241 +    139 +          labelTextColor: get('--mermaid-label-text-color', txtPri),
2129     -    1607 +    1242 +    140 +          loopTextColor: get('--mermaid-loop-text-color', txtPri),
2130     -    1608 +    1243 +    141 +          activationBorderColor: get('--mermaid-activation-border-color', h2),
2131     -    1609 +    1244 +    142 +          activationBkgColor: get('--mermaid-activation-bkg-color', clusterBkg),
2132     -    1610 +    1245 +    143 +          sequenceNumberColor: get('--mermaid-sequence-number-color', txtPri),
2133     -    1611 +    1246 +    144 +
2134     -    1612 +    1247 +    145 +          // Pie Chart
2135     -    1613 +    1248 +    146 +          pie1: get('--mermaid-pie1', h1),
2136     -    1614 +    1249 +    147 +          pie2: get('--mermaid-pie2', h2),
2137     -    1615 +    1250 +    148 +          pie3: get('--mermaid-pie3', h3),
2138     -    1616 +    1251 +    149 +          pie4: get('--mermaid-pie4', txtSec),
2139     -    1617 +    1252 +    150 +          pie5: get('--mermaid-pie5', h1),
2140     -    1618 +    1253 +    151 +          pie6: get('--mermaid-pie6', h2),
2141     -    1619 +    1254 +    152 +          pie7: get('--mermaid-pie7', h3),
2142     -    1620 +    1255 +    153 +          pie8: get('--mermaid-pie8', txtSec),
2143     -    1621 +    1256 +    154 +          pie9: get('--mermaid-pie9', h1),
2144     -    1622 +    1257 +    155 +          pie10: get('--mermaid-pie10', h2),
2145     -    1623 +    1258 +    156 +          pie11: get('--mermaid-pie11', h3),
2146     -    1624 +    1259 +    157 +          pie12: get('--mermaid-pie12', txtSec),
2147     -    1625 +    1260 +    158 +          pieTitleTextSize: '25px',
2148     -    1626 +    1261 +    159 +          pieTitleTextColor: get('--mermaid-pie-title-text-color', txtPri),
2149     -    1627 +    1262 +    160 +          pieSectionTextSize: '17px',
2150     -    1628 +    1263 +    161 +          pieSectionTextColor: get('--mermaid-pie-section-text-color', bgPri),
2151     -    1629 +    1264 +    162 +          pieLegendTextSize: '17px',
2152     -    1630 +    1265 +    163 +          pieLegendTextColor: get('--mermaid-pie-legend-text-color', txtPri),
2153     -    1631 +    1266 +    164 +          pieStrokeColor: get('--mermaid-pie-stroke-color', h1),
2154     -    1632 +    1267 +    165 +          pieStrokeWidth: '2px',
2155     -    1633 +    1268 +    166 +          pieOuterStrokeWidth: '2px',
2156     -    1634 +    1269 +    167 +          pieOuterStrokeColor: get('--mermaid-pie-outer-stroke-color', h1),
2157     -    1635 +    1270 +    168 +          pieOpacity: '0.9',
2158     -    1636 +    1271 +    169 +
2159     -    1637 +    1272 +    170 +          // State Diagram
2160     -    1638 +    1273 +    171 +          labelColor: get('--mermaid-label-color', txtPri),
2161     -    1639 +    1274 +    172 +          altBackground: get('--mermaid-alt-background', clusterBkg),
2162     -    1640 +    1275 +    173 +
2163     -    1641 +    1276 +    174 +          // Class Diagram
2164     -    1642 +    1277 +    175 +          classText: get('--mermaid-class-text', txtPri),
2165     -    1643 +    1278 +    176 +
2166     -    1644 +    1279 +    177 +          // User Journey
2167     -    1645 +    1280 +    178 +          fillType0: get('--mermaid-fill-type0', h1),
2168     -    1646 +    1281 +    179 +          fillType1: get('--mermaid-fill-type1', h2),
2169     -    1647 +    1282 +    180 +          fillType2: get('--mermaid-fill-type2', h3),
2170     -    1648 +    1283 +    181 +          fillType3: get('--mermaid-fill-type3', txtSec),
2171     -    1649 +    1284 +    182 +          fillType4: get('--mermaid-fill-type4', h1),
2172     -    1650 +    1285 +    183 +          fillType5: get('--mermaid-fill-type5', h2),
2173     -    1651 +    1286 +    184 +          fillType6: get('--mermaid-fill-type6', h3),
2174     -    1652 +    1287 +    185 +          fillType7: get('--mermaid-fill-type7', txtSec),
2175     -    1653 +    1288 +    186 +
2176     -    1654 +    1289 +    187 +          // Gantt Chart
2177     -    1655 +    1290 +    188 +          sectionBkgColor: get('--mermaid-section-bkg-color', bgSec),
2178     -    1656 +    1291 +    189 +          altSectionBkgColor: get('--mermaid-alt-section-bkg-color', bgTer),
2179     -    1657 +    1292 +    190 +          sectionBkgColor2: get('--mermaid-section-bkg-color2', bgSec),
2180     -    1658 +    1293 +    191 +          taskTextColor: get('--mermaid-task-text-color', txtPri),
2181     -    1659 +    1294 +    192 +          taskTextLightColor: get('--mermaid-task-text-light-color', txtPri),
2182     -    1660 +    1295 +    193 +          taskTextOutsideColor: get('--mermaid-task-text-outside-color', txtPri),
2183     -    1661 +    1296 +    194 +          taskTextClickableColor: get('--mermaid-task-text-clickable-color', h1),
2184     -    1662 +    1297 +    195 +          activeTaskBkgColor: get('--mermaid-active-task-bkg-color', h1),
2185     -    1663 +    1298 +    196 +          activeTaskBorderColor: get('--mermaid-active-task-border-color', h1),
2186     -    1664 +    1299 +    197 +          doneTaskBkgColor: get('--mermaid-done-task-bkg-color', h3),
2187     -    1665 +    1300 +    198 +          doneTaskBorderColor: get('--mermaid-done-task-border-color', h3),
2188     -    1666 +    1301 +    199 +          critBorderColor: get('--mermaid-crit-border-color', h2),
2189     -    1667 +    1302 +    200 +          critBkgColor: get('--mermaid-crit-bkg-color', h2),
2190     -    1668 +    1303 +    201 +          todayLineColor: get('--mermaid-today-line-color', h2),
2191     -    1669 +    1304 +    202 +          gridColor: get('--mermaid-grid-color', bgTer),
2192     -    1670 +    1305 +    203 +          sectionTextColor: get('--mermaid-section-text-color', txtPri),
2193     -    1671 +    1306 +    204 +          taskBorderColor: get('--mermaid-task-border-color', h1),
2194     -    1672 +    1307 +    205 +
2195     -    1673 +    1308 +    206 +          // ER Diagram
2196     -    1674 +    1309 +    207 +          attributeBackgroundColorOdd: get('--mermaid-attribute-background-color-odd', bgSec),
2197     -    1675 +    1310 +    208 +          attributeBackgroundColorEven: get('--mermaid-attribute-background-color-even', bgPri),
2198     -    1676 +    1311 +    209 +          relationshipLabelBackground: get('--mermaid-relationship-label-background', bgPri),
2199     -    1677 +    1312 +    210 +          relationshipLabelColor: get('--mermaid-relationship-label-color', txtPri),
2200     -    1678 +    1313 +    211 +          entityBackground: get('--mermaid-entity-background', nodeBkg),
2201     -    1679 +    1314 +    212 +          entityBorderColor: get('--mermaid-entity-border-color', h1),
2202     -    1680 +    1315 +    213 +
2203     -    1681 +    1316 +    214 +          // Git Graph
2204     -    1682 +    1317 +    215 +          git0: get('--mermaid-git0', h1),
2205     -    1683 +    1318 +    216 +          git1: get('--mermaid-git1', h2),
2206     -    1684 +    1319 +    217 +          git2: get('--mermaid-git2', h3),
2207     -    1685 +    1320 +    218 +          git3: get('--mermaid-git3', txtSec),
2208     -    1686 +    1321 +    219 +          git4: get('--mermaid-git4', h1),
2209     -    1687 +    1322 +    220 +          git5: get('--mermaid-git5', h2),
2210     -    1688 +    1323 +    221 +          git6: get('--mermaid-git6', h3),
2211     -    1689 +    1324 +    222 +          git7: get('--mermaid-git7', txtSec),
2212     -    1690 +    1325 +    223 +          gitInv0: get('--mermaid-git-inv0', bgPri),
2213     -    1691 +    1326 +    224 +          gitBranchLabel0: get('--mermaid-git-branch-label0', txtPri),
2214     -    1692 +    1327 +    225 +          gitBranchLabel1: get('--mermaid-git-branch-label1', txtPri),
2215     -    1693 +    1328 +    226 +          gitBranchLabel2: get('--mermaid-git-branch-label2', txtPri),
2216     -    1694 +    1329 +    227 +          gitBranchLabel3: get('--mermaid-git-branch-label3', txtPri),
2217     -    1695 +    1330 +    228 +          gitBranchLabel4: get('--mermaid-git-branch-label4', txtPri),
2218     -    1696 +    1331 +    229 +          commitLabelColor: get('--mermaid-commit-label-color', txtPri),
2219     -    1697 +    1332 +    230 +          commitLabelBackground: get('--mermaid-commit-label-background', bgPri),
2220     -    1698 +    1333 +    231 +          tagLabelColor: get('--mermaid-tag-label-color', txtPri),
2221     -    1699 +    1334 +    232 +          tagLabelBackground: get('--mermaid-tag-label-background', nodeBkg),
2222     -    1700 +    1335 +    233 +          tagLabelBorder: get('--mermaid-tag-label-border', h1),
2223     -    1701 +    1336 + 62 234          },
2224     -    1702 +    1337 + 63 235        });
2225     -    1703 +    1338 + 64 236  
2226     -    1704 +    1339 + 65 237        this.initialized = true;
2227     -    1705 +    1340 +    238 +
2228     -    1706 +    1341 +    239 +      // Debug: Log sample of loaded variables
2229     -    1707 +    1342 +    240 +      console.log(`‚úÖ Mermaid initialized`);
2230     -    1708 +    1343 +    241 +      console.log(`  - Background: ${get('--mermaid-background', bgPri)}`);
2231     -    1709 +    1344 +    242 +      console.log(`  - Text: ${get('--mermaid-text-color', txtPri)}`);
2232     -    1710 +    1345 +    243 +      console.log(`  - Line: ${get('--mermaid-line-color', h2)}`);
2233     -    1711 +    1346 +    244 +      console.log(`  - Primary: ${get('--mermaid-primary-color', nodeBkg)}`);
2234     -    1712 +    1347 +    245 +      console.log(`  - Pie1: ${get('--mermaid-pie1', h1)}`);
2235     -    1713 +    1348 + 66 246      } else {
2236     -    1714 +    1349 + 67 247        console.warn('Mermaid library not loaded');
2237     -    1715 +    1350 + 68 248      }
2238     -    1716 +    1351 + 69 249  
2239     -    1717 +    1352 +
2240     -    1718 +    1353 +```
2241     -    1719 +    1354 +
2242     -    1720 +    1355 +
2243     -    1721 +    1356 +### üìÑ `style.css`
2244     -    1722 +    1357 +
2245     -    1723 +    1358 +**Type:** Stylesheet üé®
2246     -    1724 +    1359 +
2247     -    1725 +    1360 +```diff
2248     -    1726 +    1361 +@@ -297,68 +297,119 @@ body {
2249     -    1727 +    1362 +297 297    padding: 0;
2250     -    1728 +    1363 +298 298  }
2251     -    1729 +    1364 +299 299  
2252     -    1730 +    1365 +300     -/* Syntax Highlighting with Custom Variables - Comprehensive Token Coverage */
2253     -    1731 +    1366 +301     -#markdown-preview .token.keyword {
2254     -    1732 +    1367 +302     -  color: var(--syntax-keyword, #c792ea) !important;
2255     -    1733 +    1368 +    300 +/* ==================== PRISM SYNTAX HIGHLIGHTING - PRODUCTION GRADE ==================== */
2256     -    1734 +    1369 +    301 +/* Based on One Dark theme architecture - comprehensive token coverage */
2257     -    1735 +    1370 +    302 +
2258     -    1736 +    1371 +    303 +/* Group 1: Comments and documentation */
2259     -    1737 +    1372 +    304 +#markdown-preview .token.comment,
2260     -    1738 +    1373 +    305 +#markdown-preview .token.prolog,
2261     -    1739 +    1374 +    306 +#markdown-preview .token.cdata {
2262     -    1740 +    1375 +    307 +  color: var(--syntax-comment, #7f85a3);
2263     -    1741 +    1376 +    308 +  font-style: italic;
2264     -    1742 +    1377 +303 309  }
2265     -    1743 +    1378 +304 310  
2266     -    1744 +    1379 +305     -#markdown-preview .token.string {
2267     -    1745 +    1380 +306     -  color: var(--syntax-string, #a5e844) !important;
2268     -    1746 +    1381 +307     -}
2269     -    1747 +    1382 +308     -
2270     -    1748 +    1383 +309     -#markdown-preview .token.number,
2271     -    1749 +    1384 +310     -#markdown-preview .token.boolean {
2272     -    1750 +    1385 +311     -  color: var(--syntax-number, #ffcb6b) !important;
2273     -    1751 +    1386 +312     -}
2274     -    1752 +    1387 +313     -
2275     -    1753 +    1388 +314     -#markdown-preview .token.function,
2276     -    1754 +    1389 +315     -#markdown-preview .token.function-variable,
2277     -    1755 +    1390 +316     -#markdown-preview .token.method,
2278     -    1756 +    1391 +317     -#markdown-preview .token.method-variable {
2279     -    1757 +    1392 +318     -  color: var(--syntax-function, #82aaff) !important;
2280     -    1758 +    1393 +319     -  font-weight: 600;
2281     -    1759 +    1394 +320     -}
2282     -    1760 +    1395 +321     -
2283     -    1761 +    1396 +322     -#markdown-preview .token.comment {
2284     -    1762 +    1397 +323     -  color: var(--syntax-comment, #7f85a3) !important;
2285     -    1763 +    1398 +324     -}
2286     -    1764 +    1399 +325     -
2287     -    1765 +    1400 +326     -#markdown-preview .token.operator {
2288     -    1766 +    1401 +327     -  color: var(--syntax-operator, #89ddff) !important;
2289     -    1767 +    1402 +328     -}
2290     -    1768 +    1403 +329     -
2291     -    1769 +    1404 +330     -#markdown-preview .token.punctuation {
2292     -    1770 +    1405 +331     -  color: var(--syntax-punctuation, #89ddff) !important;
2293     -    1771 +    1406 +    311 +/* Group 2: Neutral tokens (inherit or subtle) */
2294     -    1772 +    1407 +    312 +#markdown-preview .token.doctype,
2295     -    1773 +    1408 +    313 +#markdown-preview .token.punctuation,
2296     -    1774 +    1409 +    314 +#markdown-preview .token.entity {
2297     -    1775 +    1410 +    315 +  color: var(--syntax-punctuation, #64748b);
2298     -    1776 +    1411 +332 316  }
2299     -    1777 +    1412 +333 317  
2300     -    1778 +    1413 +    318 +/* Group 3: Orange hue - Class names, constants, numbers, booleans, atrules */
2301     -    1779 +    1414 +    319 +#markdown-preview .token.attr-name,
2302     -    1780 +    1415 +334 320  #markdown-preview .token.class-name,
2303     -    1781 +    1416 +335     -#markdown-preview .token.type-class-name {
2304     -    1782 +    1417 +336     -  color: var(--syntax-keyword, #ffcb6b) !important;
2305     -    1783 +    1418 +    321 +#markdown-preview .token.boolean,
2306     -    1784 +    1419 +    322 +#markdown-preview .token.constant,
2307     -    1785 +    1420 +    323 +#markdown-preview .token.number,
2308     -    1786 +    1421 +    324 +#markdown-preview .token.atrule {
2309     -    1787 +    1422 +    325 +  color: var(--syntax-class-name, #f97316);
2310     -    1788 +    1423 +337 326    font-weight: 600;
2311     -    1789 +    1424 +338 327  }
2312     -    1790 +    1425 +339 328  
2313     -    1791 +    1426 +340     -/* Variables and Parameters - NEW */
2314     -    1792 +    1427 +341     -#markdown-preview .token.parameter,
2315     -    1793 +    1428 +342     -#markdown-preview .token.variable,
2316     -    1794 +    1429 +343     -#markdown-preview .token.plain {
2317     -    1795 +    1430 +344     -  color: var(--syntax-variable, var(--text-primary)) !important;
2318     -    1796 +    1431 +345     -  font-weight: 500;
2319     -    1797 +    1432 +    329 +/* Group 4: Purple hue - Keywords (distinct from class names!) */
2320     -    1798 +    1433 +    330 +#markdown-preview .token.keyword {
2321     -    1799 +    1434 +    331 +  color: var(--syntax-keyword, #a855f7);
2322     -    1800 +    1435 +    332 +  font-weight: 700;
2323     -    1801 +    1436 +346 333  }
2324     -    1802 +    1437 +347 334  
2325     -    1803 +    1438 +348     -/* Properties and Namespaces - NEW */
2326     -    1804 +    1439 +    335 +/* Group 5: Red hue - Properties, tags, symbols, deleted, important */
2327     -    1805 +    1440 +349 336  #markdown-preview .token.property,
2328     -    1806 +    1441 +350     -#markdown-preview .token.property-access {
2329     -    1807 +    1442 +351     -  color: var(--syntax-property, var(--syntax-function)) !important;
2330     -    1808 +    1443 +    337 +#markdown-preview .token.tag,
2331     -    1809 +    1444 +    338 +#markdown-preview .token.symbol,
2332     -    1810 +    1445 +    339 +#markdown-preview .token.deleted,
2333     -    1811 +    1446 +    340 +#markdown-preview .token.important {
2334     -    1812 +    1447 +    341 +  color: var(--syntax-property, #ef4444);
2335     -    1813 +    1448 +    342 +  font-weight: 600;
2336     -    1814 +    1449 +352 343  }
2337     -    1815 +    1450 +353 344  
2338     -    1816 +    1451 +    345 +/* Group 6: Green hue - Strings, chars, builtins, inserted, regex, selectors */
2339     -    1817 +    1452 +    346 +#markdown-preview .token.selector,
2340     -    1818 +    1453 +    347 +#markdown-preview .token.string,
2341     -    1819 +    1454 +    348 +#markdown-preview .token.char,
2342     -    1820 +    1455 +    349 +#markdown-preview .token.builtin,
2343     -    1821 +    1456 +    350 +#markdown-preview .token.inserted,
2344     -    1822 +    1457 +    351 +#markdown-preview .token.regex,
2345     -    1823 +    1458 +    352 +#markdown-preview .token.attr-value {
2346     -    1824 +    1459 +    353 +  color: var(--syntax-string, #10b981);
2347     -    1825 +    1460 +    354 +}
2348     -    1826 +    1461 +    355 +
2349     -    1827 +    1462 +    356 +/* Nested attr-value punctuation (quotes) */
2350     -    1828 +    1463 +    357 +#markdown-preview .token.attr-value > .token.punctuation {
2351     -    1829 +    1464 +    358 +  color: var(--syntax-string, #10b981);
2352     -    1830 +    1465 +    359 +}
2353     -    1831 +    1466 +    360 +
2354     -    1832 +    1467 +    361 +/* Group 7: Blue hue - Variables, operators, functions */
2355     -    1833 +    1468 +    362 +#markdown-preview .token.variable,
2356     -    1834 +    1469 +    363 +#markdown-preview .token.operator,
2357     -    1835 +    1470 +    364 +#markdown-preview .token.function {
2358     -    1836 +    1471 +    365 +  color: var(--syntax-function, #3b82f6);
2359     -    1837 +    1472 +    366 +  font-weight: 600;
2360     -    1838 +    1473 +    367 +}
2361     -    1839 +    1474 +    368 +
2362     -    1840 +    1475 +    369 +/* Group 8: Cyan hue - URLs */
2363     -    1841 +    1476 +    370 +#markdown-preview .token.url {
2364     -    1842 +    1477 +    371 +  color: var(--syntax-url, #14b8a6);
2365     -    1843 +    1478 +    372 +}
2366     -    1844 +    1479 +    373 +
2367     -    1845 +    1480 +    374 +/* ==================== LANGUAGE-SPECIFIC OVERRIDES ==================== */
2368     -    1846 +    1481 +    375 +
2369     -    1847 +    1482 +    376 +/* JavaScript overrides */
2370     -    1848 +    1483 +    377 +#markdown-preview .language-javascript .token.operator {
2371     -    1849 +    1484 +    378 +  color: var(--syntax-keyword, #a855f7);
2372     -    1850 +    1485 +    379 +}
2373     -    1851 +    1486 +    380 +
2374     -    1852 +    1487 +    381 +/* CSS overrides */
2375     -    1853 +    1488 +    382 +#markdown-preview .language-css .token.selector {
2376     -    1854 +    1489 +    383 +  color: var(--syntax-property, #ef4444);
2377     -    1855 +    1490 +    384 +}
2378     -    1856 +    1491 +    385 +
2379     -    1857 +    1492 +    386 +#markdown-preview .language-css .token.property {
2380     -    1858 +    1493 +    387 +  color: var(--text-primary);
2381     -    1859 +    1494 +    388 +}
2382     -    1860 +    1495 +    389 +
2383     -    1861 +    1496 +    390 +/* JSON overrides */
2384     -    1862 +    1497 +    391 +#markdown-preview .language-json .token.operator {
2385     -    1863 +    1498 +    392 +  color: var(--syntax-punctuation, #64748b);
2386     -    1864 +    1499 +    393 +}
2387     -    1865 +    1500 +    394 +
2388     -    1866 +    1501 +    395 +#markdown-preview .language-json .token.null.keyword {
2389     -    1867 +    1502 +    396 +  color: var(--syntax-number, #fb923c);
2390     -    1868 +    1503 +    397 +}
2391     -    1869 +    1504 +    398 +
2392     -    1870 +    1505 +    399 +/* ==================== VISUAL ENHANCEMENTS ==================== */
2393     -    1871 +    1506 +    400 +
2394     -    1872 +    1507 +    401 +/* Bold/italic styling */
2395     -    1873 +    1508 +    402 +#markdown-preview .token.bold {
2396     -    1874 +    1509 +    403 +  font-weight: bold;
2397     -    1875 +    1510 +    404 +}
2398     -    1876 +    1511 +    405 +
2399     -    1877 +    1512 +    406 +#markdown-preview .token.italic {
2400     -    1878 +    1513 +    407 +  font-style: italic;
2401     -    1879 +    1514 +    408 +}
2402     -    1880 +    1515 +    409 +
2403     -    1881 +    1516 +    410 +/* Namespace opacity */
2404     -    1882 +    1517 +354 411  #markdown-preview .token.namespace {
2405     -    1883 +    1518 +355     -  color: var(--syntax-namespace, var(--syntax-keyword)) !important;
2406     -    1884 +    1519 +356     -  font-weight: 500;
2407     -    1885 +    1520 +357     -}
2408     -    1886 +    1521 +358     -
2409     -    1887 +    1522 +359     -#markdown-preview .token.builtin {
2410     -    1888 +    1523 +360     -  color: var(--syntax-builtin, var(--syntax-function)) !important;
2411     -    1889 +    1524 +361     -  font-weight: 500;
2412     -    1890 +    1525 +    412 +  opacity: 0.8;
2413     -    1891 +    1526 +362 413  }
2414     -    1892 +    1527 +363 414  
2415     -    1893 +    1528 +364 415  #markdown-preview blockquote {
2416     -    1894 +    1529 +365 416  
2417     -    1895 +    1530 +
2418     -    1896 +    1531 +```
2419     -    1897 +    1532 +
2420     -    1898 +    1533 +
2421     -    1899 +    1534 +### üìÑ `themes/default-dark.css`
2422     -    1900 +    1535 +
2423     -    1901 +    1536 +**Type:** Stylesheet üé®
2424     -    1902 +    1537 +
2425     -    1903 +    1538 +```diff
2426     -    1904 +    1539 +@@ -26,24 +26,184 @@
2427     -    1905 +    1540 + 26  26    --code-block-bg: #0d1117;
2428     -    1906 +    1541 + 27  27    --code-border: #30363d;
2429     -    1907 +    1542 + 28  28  
2430     -    1908 +    1543 + 29     -  /* Syntax Highlighting */
2431     -    1909 +    1544 + 30     -  --syntax-keyword: #ff7b72;
2432     -    1910 +    1545 + 31     -  --syntax-string: #a5e844;
2433     -    1911 +    1546 + 32     -  --syntax-number: #79c0ff;
2434     -    1912 +    1547 + 33     -  --syntax-function: #d2a8ff;
2435     -    1913 +    1548 + 34     -  --syntax-comment: #8b949e;
2436     -    1914 +    1549 + 35     -  --syntax-operator: #ff7b72;
2437     -    1915 +    1550 + 36     -  --syntax-punctuation: #7d8590;
2438     -    1916 +    1551 +     29 +  /* Syntax Highlighting - Production-Grade Token Colors (One Dark Architecture) */
2439     -    1917 +    1552 + 37  30  
2440     -    1918 +    1553 + 38     -  /* Additional Token Types */
2441     -    1919 +    1554 + 39     -  --syntax-variable: #79c0ff; /* Variables - blue (distinct from text #e6edf3) */
2442     -    1920 +    1555 + 40     -  --syntax-property: #d2a8ff; /* Properties - purple */
2443     -    1921 +    1556 + 41     -  --syntax-namespace: #ff7b72; /* Namespaces - red */
2444     -    1922 +    1557 + 42     -  --syntax-builtin: #d2a8ff; /* Builtins - purple */
2445     -    1923 +    1558 +     31 +  /* Core hue-1: Cyan - URLs */
2446     -    1924 +    1559 +     32 +  --syntax-url: #56d4dd; /* Cyan for URLs */
2447     -    1925 +    1560 +     33 +
2448     -    1926 +    1561 +     34 +  /* Core hue-2: Blue - Functions, variables */
2449     -    1927 +    1562 +     35 +  --syntax-function: #d2a8ff; /* Purple for functions */
2450     -    1928 +    1563 +     36 +  --syntax-variable: #79c0ff; /* Bright blue for variables */
2451     -    1929 +    1564 +     37 +
2452     -    1930 +    1565 +     38 +  /* Core hue-3: Red - Keywords */
2453     -    1931 +    1566 +     39 +  --syntax-keyword: #ff7b72; /* Coral red for keywords (final, sealed, class) */
2454     -    1932 +    1567 +     40 +
2455     -    1933 +    1568 +     41 +  /* Core hue-4: Green - Strings, builtins */
2456     -    1934 +    1569 +     42 +  --syntax-string: #a5d6ff; /* Light blue-green for strings */
2457     -    1935 +    1570 +     43 +  --syntax-builtin: #7ee787; /* Vibrant green for builtins (String, List) */
2458     -    1936 +    1571 +     44 +  --syntax-char: #a5d6ff; /* Same as strings */
2459     -    1937 +    1572 +     45 +  --syntax-regex: #a5d6ff; /* Same as strings */
2460     -    1938 +    1573 +     46 +  --syntax-inserted: #7ee787; /* For diff */
2461     -    1939 +    1574 +     47 +
2462     -    1940 +    1575 +     48 +  /* Core hue-5: Orange - Properties, tags */
2463     -    1941 +    1576 +     49 +  --syntax-property: #ffa657; /* Orange for properties */
2464     -    1942 +    1577 +     50 +  --syntax-tag: #ff7b72; /* Coral for tags */
2465     -    1943 +    1578 +     51 +  --syntax-deleted: #ff7b72; /* For diff */
2466     -    1944 +    1579 +     52 +  --syntax-important: #ffa657; /* For !important */
2467     -    1945 +    1580 +     53 +
2468     -    1946 +    1581 +     54 +  /* Core hue-6: Yellow - Class names, constants, numbers */
2469     -    1947 +    1582 +     55 +  --syntax-class-name: #ffa657; /* Orange for class names (Rectangle, Shape) */
2470     -    1948 +    1583 +     56 +  --syntax-number: #79c0ff; /* Blue for numbers */
2471     -    1949 +    1584 +     57 +  --syntax-constant: #79c0ff; /* Blue for constants */
2472     -    1950 +    1585 +     58 +  --syntax-boolean: #79c0ff; /* Same as numbers */
2473     -    1951 +    1586 +     59 +  --syntax-atrule: #d2a8ff; /* Purple for CSS @ rules */
2474     -    1952 +    1587 +     60 +
2475     -    1953 +    1588 +     61 +  /* Neutral colors */
2476     -    1954 +    1589 +     62 +  --syntax-comment: #8b949e; /* Gray for comments */
2477     -    1955 +    1590 +     63 +  --syntax-punctuation: #7d8590; /* Muted gray for punctuation */
2478     -    1956 +    1591 +     64 +  --syntax-operator: #ff7b72; /* Coral for operators */
2479     -    1957 +    1592 +     65 +
2480     -    1958 +    1593 +     66 +  /* Markup specific */
2481     -    1959 +    1594 +     67 +  --syntax-attr-name: #ffa657; /* Orange like class-name */
2482     -    1960 +    1595 +     68 +  --syntax-attr-value: #a5d6ff; /* Light blue like strings */
2483     -    1961 +    1596 +     69 +  --syntax-namespace: #d2a8ff; /* Purple */
2484     -    1962 +    1597 +     70 +  --syntax-entity: #7d8590; /* Neutral */
2485     -    1963 +    1598 +     71 +  --syntax-selector: #ffa657; /* Orange like properties */
2486     -    1964 +    1599 + 43  72  
2487     -    1965 +    1600 + 44  73    --blockquote-border: #bc8cff;
2488     -    1966 +    1601 + 45  74    --blockquote-bg: #161b22;
2489     -    1967 +    1602 + 46  75  
2490     -    1968 +    1603 + 47  76    --table-header-bg: #21262d;
2491     -    1969 +    1604 + 48  77    --table-border: #30363d;
2492     -    1970 +    1605 +     78 +
2493     -    1971 +    1606 +     79 +  /* === MERMAID COMPREHENSIVE CONFIGURATION === */
2494     -    1972 +    1607 +     80 +
2495     -    1973 +    1608 +     81 +  /* Core Global */
2496     -    1974 +    1609 +     82 +  --mermaid-background: #0d1117;
2497     -    1975 +    1610 +     83 +  --mermaid-text-color: #e6edf3;
2498     -    1976 +    1611 +     84 +  --mermaid-line-color: #58a6ff;
2499     -    1977 +    1612 +     85 +  --mermaid-main-bkg: #1c2128;
2500     -    1978 +    1613 +     86 +
2501     -    1979 +    1614 +     87 +  /* Primary Set - Main nodes/boxes */
2502     -    1980 +    1615 +     88 +  --mermaid-primary-color: #1c2128;
2503     -    1981 +    1616 +     89 +  --mermaid-primary-text-color: #e6edf3;
2504     -    1982 +    1617 +     90 +  --mermaid-primary-border-color: #58a6ff;
2505     -    1983 +    1618 +     91 +
2506     -    1984 +    1619 +     92 +  /* Secondary Set - Clusters/subgraphs */
2507     -    1985 +    1620 +     93 +  --mermaid-secondary-color: #161b22;
2508     -    1986 +    1621 +     94 +  --mermaid-secondary-text-color: #e6edf3;
2509     -    1987 +    1622 +     95 +  --mermaid-secondary-border-color: #bc8cff;
2510     -    1988 +    1623 +     96 +
2511     -    1989 +    1624 +     97 +  /* Tertiary Set - Edge labels */
2512     -    1990 +    1625 +     98 +  --mermaid-tertiary-color: #0d1117;
2513     -    1991 +    1626 +     99 +  --mermaid-tertiary-text-color: #e6edf3;
2514     -    1992 +    1627 +    100 +  --mermaid-tertiary-border-color: #ff7b72;
2515     -    1993 +    1628 +    101 +
2516     -    1994 +    1629 +    102 +  /* Flowchart */
2517     -    1995 +    1630 +    103 +  --mermaid-node-border: #58a6ff;
2518     -    1996 +    1631 +    104 +  --mermaid-cluster-bkg: #161b22;
2519     -    1997 +    1632 +    105 +  --mermaid-cluster-border: #bc8cff;
2520     -    1998 +    1633 +    106 +  --mermaid-default-link-color: #58a6ff;
2521     -    1999 +    1634 +    107 +  --mermaid-title-color: #e6edf3;
2522     -    2000 +    1635 +    108 +  --mermaid-edge-label-background: #0d1117;
2523     -    2001 +    1636 +    109 +  --mermaid-node-text-color: #e6edf3;
2524     -    2002 +    1637 +    110 +
2525     -    2003 +    1638 +    111 +  /* Sequence Diagram */
2526     -    2004 +    1639 +    112 +  --mermaid-actor-bkg: #1c2128;
2527     -    2005 +    1640 +    113 +  --mermaid-actor-border: #58a6ff;
2528     -    2006 +    1641 +    114 +  --mermaid-actor-text-color: #e6edf3;
2529     -    2007 +    1642 +    115 +  --mermaid-actor-line-color: #58a6ff;
2530     -    2008 +    1643 +    116 +  --mermaid-signal-color: #bc8cff;
2531     -    2009 +    1644 +    117 +  --mermaid-signal-text-color: #e6edf3;
2532     -    2010 +    1645 +    118 +  --mermaid-label-box-bkg-color: #1c2128;
2533     -    2011 +    1646 +    119 +  --mermaid-label-box-border-color: #58a6ff;
2534     -    2012 +    1647 +    120 +  --mermaid-label-text-color: #e6edf3;
2535     -    2013 +    1648 +    121 +  --mermaid-loop-text-color: #e6edf3;
2536     -    2014 +    1649 +    122 +  --mermaid-activation-border-color: #bc8cff;
2537     -    2015 +    1650 +    123 +  --mermaid-activation-bkg-color: #161b22;
2538     -    2016 +    1651 +    124 +  --mermaid-sequence-number-color: #e6edf3;
2539     -    2017 +    1652 +    125 +
2540     -    2018 +    1653 +    126 +  /* Pie Chart - 12 distinct slice colors + text */
2541     -    2019 +    1654 +    127 +  --mermaid-pie1: #58a6ff;
2542     -    2020 +    1655 +    128 +  --mermaid-pie2: #bc8cff;
2543     -    2021 +    1656 +    129 +  --mermaid-pie3: #ff7b72;
2544     -    2022 +    1657 +    130 +  --mermaid-pie4: #3fb950;
2545     -    2023 +    1658 +    131 +  --mermaid-pie5: #ffa657;
2546     -    2024 +    1659 +    132 +  --mermaid-pie6: #d2a8ff;
2547     -    2025 +    1660 +    133 +  --mermaid-pie7: #56d4dd;
2548     -    2026 +    1661 +    134 +  --mermaid-pie8: #7ee787;
2549     -    2027 +    1662 +    135 +  --mermaid-pie9: #a5d6ff;
2550     -    2028 +    1663 +    136 +  --mermaid-pie10: #79c0ff;
2551     -    2029 +    1664 +    137 +  --mermaid-pie11: #d2a8ff;
2552     -    2030 +    1665 +    138 +  --mermaid-pie12: #ffa657;
2553     -    2031 +    1666 +    139 +  --mermaid-pie-title-text-color: #e6edf3;
2554     -    2032 +    1667 +    140 +  --mermaid-pie-section-text-color: #0d1117; /* Dark on vibrant slices */
2555     -    2033 +    1668 +    141 +  --mermaid-pie-legend-text-color: #e6edf3;
2556     -    2034 +    1669 +    142 +  --mermaid-pie-stroke-color: #58a6ff;
2557     -    2035 +    1670 +    143 +  --mermaid-pie-outer-stroke-color: #58a6ff;
2558     -    2036 +    1671 +    144 +
2559     -    2037 +    1672 +    145 +  /* State Diagram */
2560     -    2038 +    1673 +    146 +  --mermaid-label-color: #e6edf3;
2561     -    2039 +    1674 +    147 +  --mermaid-alt-background: #161b22;
2562     -    2040 +    1675 +    148 +
2563     -    2041 +    1676 +    149 +  /* Class Diagram */
2564     -    2042 +    1677 +    150 +  --mermaid-class-text: #e6edf3;
2565     -    2043 +    1678 +    151 +
2566     -    2044 +    1679 +    152 +  /* User Journey - 8 distinct colors */
2567     -    2045 +    1680 +    153 +  --mermaid-fill-type0: #58a6ff;
2568     -    2046 +    1681 +    154 +  --mermaid-fill-type1: #bc8cff;
2569     -    2047 +    1682 +    155 +  --mermaid-fill-type2: #ff7b72;
2570     -    2048 +    1683 +    156 +  --mermaid-fill-type3: #3fb950;
2571     -    2049 +    1684 +    157 +  --mermaid-fill-type4: #ffa657;
2572     -    2050 +    1685 +    158 +  --mermaid-fill-type5: #d2a8ff;
2573     -    2051 +    1686 +    159 +  --mermaid-fill-type6: #56d4dd;
2574     -    2052 +    1687 +    160 +  --mermaid-fill-type7: #7ee787;
2575     -    2053 +    1688 +    161 +
2576     -    2054 +    1689 +    162 +  /* Gantt Chart */
2577     -    2055 +    1690 +    163 +  --mermaid-section-bkg-color: #1c2128;
2578     -    2056 +    1691 +    164 +  --mermaid-alt-section-bkg-color: #161b22;
2579     -    2057 +    1692 +    165 +  --mermaid-section-bkg-color2: #1c2128;
2580     -    2058 +    1693 +    166 +  --mermaid-task-text-color: #e6edf3;
2581     -    2059 +    1694 +    167 +  --mermaid-task-text-light-color: #e6edf3;
2582     -    2060 +    1695 +    168 +  --mermaid-task-text-outside-color: #e6edf3;
2583     -    2061 +    1696 +    169 +  --mermaid-task-text-clickable-color: #58a6ff;
2584     -    2062 +    1697 +    170 +  --mermaid-active-task-bkg-color: #58a6ff;
2585     -    2063 +    1698 +    171 +  --mermaid-active-task-border-color: #58a6ff;
2586     -    2064 +    1699 +    172 +  --mermaid-done-task-bkg-color: #3fb950;
2587     -    2065 +    1700 +    173 +  --mermaid-done-task-border-color: #3fb950;
2588     -    2066 +    1701 +    174 +  --mermaid-crit-border-color: #ff7b72;
2589     -    2067 +    1702 +    175 +  --mermaid-crit-bkg-color: #ff7b72;
2590     -    2068 +    1703 +    176 +  --mermaid-today-line-color: #ff7b72;
2591     -    2069 +    1704 +    177 +  --mermaid-grid-color: #30363d;
2592     -    2070 +    1705 +    178 +  --mermaid-section-text-color: #e6edf3;
2593     -    2071 +    1706 +    179 +  --mermaid-task-border-color: #58a6ff;
2594     -    2072 +    1707 +    180 +
2595     -    2073 +    1708 +    181 +  /* ER Diagram */
2596     -    2074 +    1709 +    182 +  --mermaid-attribute-background-color-odd: #161b22;
2597     -    2075 +    1710 +    183 +  --mermaid-attribute-background-color-even: #0d1117;
2598     -    2076 +    1711 +    184 +  --mermaid-relationship-label-background: #0d1117;
2599     -    2077 +    1712 +    185 +  --mermaid-relationship-label-color: #e6edf3;
2600     -    2078 +    1713 +    186 +  --mermaid-entity-background: #1c2128;
2601     -    2079 +    1714 +    187 +  --mermaid-entity-border-color: #58a6ff;
2602     -    2080 +    1715 +    188 +
2603     -    2081 +    1716 +    189 +  /* Git Graph */
2604     -    2082 +    1717 +    190 +  --mermaid-git0: #58a6ff;
2605     -    2083 +    1718 +    191 +  --mermaid-git1: #bc8cff;
2606     -    2084 +    1719 +    192 +  --mermaid-git2: #ff7b72;
2607     -    2085 +    1720 +    193 +  --mermaid-git3: #3fb950;
2608     -    2086 +    1721 +    194 +  --mermaid-git4: #ffa657;
2609     -    2087 +    1722 +    195 +  --mermaid-git5: #d2a8ff;
2610     -    2088 +    1723 +    196 +  --mermaid-git6: #56d4dd;
2611     -    2089 +    1724 +    197 +  --mermaid-git7: #7ee787;
2612     -    2090 +    1725 +    198 +  --mermaid-git-inv0: #0d1117;
2613     -    2091 +    1726 +    199 +  --mermaid-git-branch-label0: #e6edf3;
2614     -    2092 +    1727 +    200 +  --mermaid-git-branch-label1: #e6edf3;
2615     -    2093 +    1728 +    201 +  --mermaid-git-branch-label2: #e6edf3;
2616     -    2094 +    1729 +    202 +  --mermaid-git-branch-label3: #e6edf3;
2617     -    2095 +    1730 +    203 +  --mermaid-git-branch-label4: #e6edf3;
2618     -    2096 +    1731 +    204 +  --mermaid-commit-label-color: #e6edf3;
2619     -    2097 +    1732 +    205 +  --mermaid-commit-label-background: #0d1117;
2620     -    2098 +    1733 +    206 +  --mermaid-tag-label-color: #e6edf3;
2621     -    2099 +    1734 +    207 +  --mermaid-tag-label-background: #1c2128;
2622     -    2100 +    1735 +    208 +  --mermaid-tag-label-border: #58a6ff;
2623     -    2101 +    1736 + 49 209  }
2624     -    2102 +    1737 + 50 210  
2625     -    2103 +    1738 +
2626     -    2104 +    1739 +```
2627     -    2105 +    1740 +
2628     -    2106 +    1741 +
2629     -    2107 +    1742 +### üìÑ `themes/default-light.css`
2630     -    2108 +    1743 +
2631     -    2109 +    1744 +**Type:** Stylesheet üé®
2632     -    2110 +    1745 +
2633     -    2111 +    1746 +```diff
2634     -    2112 +    1747 +@@ -26,24 +26,184 @@
2635     -    2113 +    1748 + 26  26    --code-block-bg: #f6f8fa;
2636     -    2114 +    1749 + 27  27    --code-border: #d0d7de;
2637     -    2115 +    1750 + 28  28  
2638     -    2116 +    1751 + 29     -  /* Syntax Highlighting - Comprehensive Token Colors */
2639     -    2117 +    1752 + 30     -  --syntax-keyword: #cf222e;
2640     -    2118 +    1753 + 31     -  --syntax-string: #1a7f37;
2641     -    2119 +    1754 + 32     -  --syntax-number: #0550ae;
2642     -    2120 +    1755 + 33     -  --syntax-function: #8250df;
2643     -    2121 +    1756 + 34     -  --syntax-comment: #636c76;
2644     -    2122 +    1757 + 35     -  --syntax-operator: #cf222e;
2645     -    2123 +    1758 + 36     -  --syntax-punctuation: #636c76;
2646     -    2124 +    1759 +     29 +  /* Syntax Highlighting - Production-Grade Token Colors (One Dark Architecture) */
2647     -    2125 +    1760 + 37  30  
2648     -    2126 +    1761 + 38     -  /* Additional Token Types for Full Customization */
2649     -    2127 +    1762 + 39     -  --syntax-variable: #0550ae; /* Variables, parameters */
2650     -    2128 +    1763 + 40     -  --syntax-property: #1a7f37; /* Properties, attributes */
2651     -    2129 +    1764 + 41     -  --syntax-namespace: #cf222e; /* Namespaces */
2652     -    2130 +    1765 + 42     -  --syntax-builtin: #8250df; /* Built-in functions */
2653     -    2131 +    1766 +     31 +  /* Core hue-1: Cyan - URLs */
2654     -    2132 +    1767 +     32 +  --syntax-url: #0969da; /* GitHub blue for URLs */
2655     -    2133 +    1768 +     33 +
2656     -    2134 +    1769 +     34 +  /* Core hue-2: Blue - Functions, variables */
2657     -    2135 +    1770 +     35 +  --syntax-function: #8250df; /* Purple-blue for functions */
2658     -    2136 +    1771 +     36 +  --syntax-variable: #0550ae; /* Deep blue for variables */
2659     -    2137 +    1772 +     37 +
2660     -    2138 +    1773 +     38 +  /* Core hue-3: Red - Keywords */
2661     -    2139 +    1774 +     39 +  --syntax-keyword: #cf222e; /* GitHub red for keywords (final, sealed, class) */
2662     -    2140 +    1775 +     40 +
2663     -    2141 +    1776 +     41 +  /* Core hue-4: Green - Strings, builtins */
2664     -    2142 +    1777 +     42 +  --syntax-string: #1a7f37; /* GitHub green for strings */
2665     -    2143 +    1778 +     43 +  --syntax-builtin: #116329; /* Darker green for builtins (String, List) */
2666     -    2144 +    1779 +     44 +  --syntax-char: #1a7f37; /* Same as strings */
2667     -    2145 +    1780 +     45 +  --syntax-regex: #1a7f37; /* Same as strings */
2668     -    2146 +    1781 +     46 +  --syntax-inserted: #1a7f37; /* For diff */
2669     -    2147 +    1782 +     47 +
2670     -    2148 +    1783 +     48 +  /* Core hue-5: Orange/Brown - Properties, tags */
2671     -    2149 +    1784 +     49 +  --syntax-property: #bc4c00; /* Orange-brown for properties */
2672     -    2150 +    1785 +     50 +  --syntax-tag: #cf222e; /* Red for tags */
2673     -    2151 +    1786 +     51 +  --syntax-deleted: #cf222e; /* For diff */
2674     -    2152 +    1787 +     52 +  --syntax-important: #bc4c00; /* For !important */
2675     -    2153 +    1788 +     53 +
2676     -    2154 +    1789 +     54 +  /* Core hue-6: Blue - Class names, constants, numbers */
2677     -    2155 +    1790 +     55 +  --syntax-class-name: #0969da; /* Bright blue for class names (Rectangle, Shape) */
2678     -    2156 +    1791 +     56 +  --syntax-number: #0550ae; /* Deep blue for numbers */
2679     -    2157 +    1792 +     57 +  --syntax-constant: #0969da; /* Bright blue for constants */
2680     -    2158 +    1793 +     58 +  --syntax-boolean: #0550ae; /* Same as numbers */
2681     -    2159 +    1794 +     59 +  --syntax-atrule: #8250df; /* Purple for CSS @ rules */
2682     -    2160 +    1795 +     60 +
2683     -    2161 +    1796 +     61 +  /* Neutral colors */
2684     -    2162 +    1797 +     62 +  --syntax-comment: #636c76; /* GitHub gray for comments */
2685     -    2163 +    1798 +     63 +  --syntax-punctuation: #636c76; /* Gray for punctuation */
2686     -    2164 +    1799 +     64 +  --syntax-operator: #cf222e; /* Red for operators */
2687     -    2165 +    1800 +     65 +
2688     -    2166 +    1801 +     66 +  /* Markup specific */
2689     -    2167 +    1802 +     67 +  --syntax-attr-name: #0969da; /* Blue like class-name */
2690     -    2168 +    1803 +     68 +  --syntax-attr-value: #1a7f37; /* Green like strings */
2691     -    2169 +    1804 +     69 +  --syntax-namespace: #8250df; /* Purple */
2692     -    2170 +    1805 +     70 +  --syntax-entity: #636c76; /* Neutral */
2693     -    2171 +    1806 +     71 +  --syntax-selector: #bc4c00; /* Orange like properties */
2694     -    2172 +    1807 + 43  72  
2695     -    2173 +    1808 + 44  73    --blockquote-border: #0969da;
2696     -    2174 +    1809 + 45  74    --blockquote-bg: #ddf4ff;
2697     -    2175 +    1810 + 46  75  
2698     -    2176 +    1811 + 47  76    --table-header-bg: #f6f8fa;
2699     -    2177 +    1812 + 48  77    --table-border: #d0d7de;
2700     -    2178 +    1813 +     78 +
2701     -    2179 +    1814 +     79 +  /* === MERMAID COMPREHENSIVE CONFIGURATION === */
2702     -    2180 +    1815 +     80 +
2703     -    2181 +    1816 +     81 +  /* Core Global */
2704     -    2182 +    1817 +     82 +  --mermaid-background: #ffffff;
2705     -    2183 +    1818 +     83 +  --mermaid-text-color: #1f2328;
2706     -    2184 +    1819 +     84 +  --mermaid-line-color: #0969da;
2707     -    2185 +    1820 +     85 +  --mermaid-main-bkg: #eaeef2;
2708     -    2186 +    1821 +     86 +
2709     -    2187 +    1822 +     87 +  /* Primary Set */
2710     -    2188 +    1823 +     88 +  --mermaid-primary-color: #eaeef2;
2711     -    2189 +    1824 +     89 +  --mermaid-primary-text-color: #1f2328;
2712     -    2190 +    1825 +     90 +  --mermaid-primary-border-color: #0969da;
2713     -    2191 +    1826 +     91 +
2714     -    2192 +    1827 +     92 +  /* Secondary Set */
2715     -    2193 +    1828 +     93 +  --mermaid-secondary-color: #f6f8fa;
2716     -    2194 +    1829 +     94 +  --mermaid-secondary-text-color: #1f2328;
2717     -    2195 +    1830 +     95 +  --mermaid-secondary-border-color: #8250df;
2718     -    2196 +    1831 +     96 +
2719     -    2197 +    1832 +     97 +  /* Tertiary Set */
2720     -    2198 +    1833 +     98 +  --mermaid-tertiary-color: #ffffff;
2721     -    2199 +    1834 +     99 +  --mermaid-tertiary-text-color: #1f2328;
2722     -    2200 +    1835 +    100 +  --mermaid-tertiary-border-color: #cf222e;
2723     -    2201 +    1836 +    101 +
2724     -    2202 +    1837 +    102 +  /* Flowchart */
2725     -    2203 +    1838 +    103 +  --mermaid-node-border: #0969da;
2726     -    2204 +    1839 +    104 +  --mermaid-cluster-bkg: #f6f8fa;
2727     -    2205 +    1840 +    105 +  --mermaid-cluster-border: #8250df;
2728     -    2206 +    1841 +    106 +  --mermaid-default-link-color: #0969da;
2729     -    2207 +    1842 +    107 +  --mermaid-title-color: #1f2328;
2730     -    2208 +    1843 +    108 +  --mermaid-edge-label-background: #ffffff;
2731     -    2209 +    1844 +    109 +  --mermaid-node-text-color: #1f2328;
2732     -    2210 +    1845 +    110 +
2733     -    2211 +    1846 +    111 +  /* Sequence Diagram */
2734     -    2212 +    1847 +    112 +  --mermaid-actor-bkg: #eaeef2;
2735     -    2213 +    1848 +    113 +  --mermaid-actor-border: #0969da;
2736     -    2214 +    1849 +    114 +  --mermaid-actor-text-color: #1f2328;
2737     -    2215 +    1850 +    115 +  --mermaid-actor-line-color: #0969da;
2738     -    2216 +    1851 +    116 +  --mermaid-signal-color: #8250df;
2739     -    2217 +    1852 +    117 +  --mermaid-signal-text-color: #1f2328;
2740     -    2218 +    1853 +    118 +  --mermaid-label-box-bkg-color: #eaeef2;
2741     -    2219 +    1854 +    119 +  --mermaid-label-box-border-color: #0969da;
2742     -    2220 +    1855 +    120 +  --mermaid-label-text-color: #1f2328;
2743     -    2221 +    1856 +    121 +  --mermaid-loop-text-color: #1f2328;
2744     -    2222 +    1857 +    122 +  --mermaid-activation-border-color: #8250df;
2745     -    2223 +    1858 +    123 +  --mermaid-activation-bkg-color: #f6f8fa;
2746     -    2224 +    1859 +    124 +  --mermaid-sequence-number-color: #1f2328;
2747     -    2225 +    1860 +    125 +
2748     -    2226 +    1861 +    126 +  /* Pie Chart */
2749     -    2227 +    1862 +    127 +  --mermaid-pie1: #0969da;
2750     -    2228 +    1863 +    128 +  --mermaid-pie2: #8250df;
2751     -    2229 +    1864 +    129 +  --mermaid-pie3: #cf222e;
2752     -    2230 +    1865 +    130 +  --mermaid-pie4: #1a7f37;
2753     -    2231 +    1866 +    131 +  --mermaid-pie5: #bc4c00;
2754     -    2232 +    1867 +    132 +  --mermaid-pie6: #0550ae;
2755     -    2233 +    1868 +    133 +  --mermaid-pie7: #116329;
2756     -    2234 +    1869 +    134 +  --mermaid-pie8: #0969da;
2757     -    2235 +    1870 +    135 +  --mermaid-pie9: #8250df;
2758     -    2236 +    1871 +    136 +  --mermaid-pie10: #cf222e;
2759     -    2237 +    1872 +    137 +  --mermaid-pie11: #1a7f37;
2760     -    2238 +    1873 +    138 +  --mermaid-pie12: #bc4c00;
2761     -    2239 +    1874 +    139 +  --mermaid-pie-title-text-color: #1f2328;
2762     -    2240 +    1875 +    140 +  --mermaid-pie-section-text-color: #ffffff; /* White on vibrant slices */
2763     -    2241 +    1876 +    141 +  --mermaid-pie-legend-text-color: #1f2328;
2764     -    2242 +    1877 +    142 +  --mermaid-pie-stroke-color: #0969da;
2765     -    2243 +    1878 +    143 +  --mermaid-pie-outer-stroke-color: #0969da;
2766     -    2244 +    1879 +    144 +
2767     -    2245 +    1880 +    145 +  /* State Diagram */
2768     -    2246 +    1881 +    146 +  --mermaid-label-color: #1f2328;
2769     -    2247 +    1882 +    147 +  --mermaid-alt-background: #f6f8fa;
2770     -    2248 +    1883 +    148 +
2771     -    2249 +    1884 +    149 +  /* Class Diagram */
2772     -    2250 +    1885 +    150 +  --mermaid-class-text: #1f2328;
2773     -    2251 +    1886 +    151 +
2774     -    2252 +    1887 +    152 +  /* User Journey */
2775     -    2253 +    1888 +    153 +  --mermaid-fill-type0: #0969da;
2776     -    2254 +    1889 +    154 +  --mermaid-fill-type1: #8250df;
2777     -    2255 +    1890 +    155 +  --mermaid-fill-type2: #cf222e;
2778     -    2256 +    1891 +    156 +  --mermaid-fill-type3: #1a7f37;
2779     -    2257 +    1892 +    157 +  --mermaid-fill-type4: #bc4c00;
2780     -    2258 +    1893 +    158 +  --mermaid-fill-type5: #0550ae;
2781     -    2259 +    1894 +    159 +  --mermaid-fill-type6: #116329;
2782     -    2260 +    1895 +    160 +  --mermaid-fill-type7: #0969da;
2783     -    2261 +    1896 +    161 +
2784     -    2262 +    1897 +    162 +  /* Gantt Chart */
2785     -    2263 +    1898 +    163 +  --mermaid-section-bkg-color: #eaeef2;
2786     -    2264 +    1899 +    164 +  --mermaid-alt-section-bkg-color: #f6f8fa;
2787     -    2265 +    1900 +    165 +  --mermaid-section-bkg-color2: #eaeef2;
2788     -    2266 +    1901 +    166 +  --mermaid-task-text-color: #1f2328;
2789     -    2267 +    1902 +    167 +  --mermaid-task-text-light-color: #1f2328;
2790     -    2268 +    1903 +    168 +  --mermaid-task-text-outside-color: #1f2328;
2791     -    2269 +    1904 +    169 +  --mermaid-task-text-clickable-color: #0969da;
2792     -    2270 +    1905 +    170 +  --mermaid-active-task-bkg-color: #0969da;
2793     -    2271 +    1906 +    171 +  --mermaid-active-task-border-color: #0969da;
2794     -    2272 +    1907 +    172 +  --mermaid-done-task-bkg-color: #1a7f37;
2795     -    2273 +    1908 +    173 +  --mermaid-done-task-border-color: #1a7f37;
2796     -    2274 +    1909 +    174 +  --mermaid-crit-border-color: #cf222e;
2797     -    2275 +    1910 +    175 +  --mermaid-crit-bkg-color: #cf222e;
2798     -    2276 +    1911 +    176 +  --mermaid-today-line-color: #cf222e;
2799     -    2277 +    1912 +    177 +  --mermaid-grid-color: #d0d7de;
2800     -    2278 +    1913 +    178 +  --mermaid-section-text-color: #1f2328;
2801     -    2279 +    1914 +    179 +  --mermaid-task-border-color: #0969da;
2802     -    2280 +    1915 +    180 +
2803     -    2281 +    1916 +    181 +  /* ER Diagram */
2804     -    2282 +    1917 +    182 +  --mermaid-attribute-background-color-odd: #f6f8fa;
2805     -    2283 +    1918 +    183 +  --mermaid-attribute-background-color-even: #ffffff;
2806     -    2284 +    1919 +    184 +  --mermaid-relationship-label-background: #ffffff;
2807     -    2285 +    1920 +    185 +  --mermaid-relationship-label-color: #1f2328;
2808     -    2286 +    1921 +    186 +  --mermaid-entity-background: #eaeef2;
2809     -    2287 +    1922 +    187 +  --mermaid-entity-border-color: #0969da;
2810     -    2288 +    1923 +    188 +
2811     -    2289 +    1924 +    189 +  /* Git Graph */
2812     -    2290 +    1925 +    190 +  --mermaid-git0: #0969da;
2813     -    2291 +    1926 +    191 +  --mermaid-git1: #8250df;
2814     -    2292 +    1927 +    192 +  --mermaid-git2: #cf222e;
2815     -    2293 +    1928 +    193 +  --mermaid-git3: #1a7f37;
2816     -    2294 +    1929 +    194 +  --mermaid-git4: #bc4c00;
2817     -    2295 +    1930 +    195 +  --mermaid-git5: #0550ae;
2818     -    2296 +    1931 +    196 +  --mermaid-git6: #116329;
2819     -    2297 +    1932 +    197 +  --mermaid-git7: #0969da;
2820     -    2298 +    1933 +    198 +  --mermaid-git-inv0: #ffffff;
2821     -    2299 +    1934 +    199 +  --mermaid-git-branch-label0: #1f2328;
2822     -    2300 +    1935 +    200 +  --mermaid-git-branch-label1: #1f2328;
2823     -    2301 +    1936 +    201 +  --mermaid-git-branch-label2: #1f2328;
2824     -    2302 +    1937 +    202 +  --mermaid-git-branch-label3: #1f2328;
2825     -    2303 +    1938 +    203 +  --mermaid-git-branch-label4: #1f2328;
2826     -    2304 +    1939 +    204 +  --mermaid-commit-label-color: #1f2328;
2827     -    2305 +    1940 +    205 +  --mermaid-commit-label-background: #ffffff;
2828     -    2306 +    1941 +    206 +  --mermaid-tag-label-color: #1f2328;
2829     -    2307 +    1942 +    207 +  --mermaid-tag-label-background: #eaeef2;
2830     -    2308 +    1943 +    208 +  --mermaid-tag-label-border: #0969da;
2831     -    2309 +    1944 + 49 209  }
2832     -    2310 +    1945 + 50 210  
2833     -    2311 +    1946 +
2834     -    2312 +    1947 +```
2835     -    2313 +    1948 +
2836     -    2314 +    1949 +
2837     -    2315 +    1950 +### üìÑ `themes/forest-dark.css`
2838     -    2316 +    1951 +
2839     -    2317 +    1952 +**Type:** Stylesheet üé®
2840     -    2318 +    1953 +
2841     -    2319 +    1954 +```diff
2842     -    2320 +    1955 +@@ -1,11 +1,11 @@
2843     -    2321 +    1956 +  1     -/* Forest Dark Theme */
2844     -    2322 +    1957 +      1 +/* Forest Dark Theme - Deep Jungle Aesthetic */
2845     -    2323 +    1958 +  2   2  :root {
2846     -    2324 +    1959 +  3     -  --bg-primary: #0f1c0a;
2847     -    2325 +    1960 +  4     -  --bg-secondary: #1a2817;
2848     -    2326 +    1961 +  5     -  --bg-tertiary: #2d4a2b;
2849     -    2327 +    1962 +  6     -  --text-primary: #d9f99d;
2850     -    2328 +    1963 +  7     -  --text-secondary: #a3e635;
2851     -    2329 +    1964 +  8     -  --border-color: #3f6212;
2852     -    2330 +    1965 +      3 +  --bg-primary: #0a1408; /* Deep forest green with blue undertones */
2853     -    2331 +    1966 +      4 +  --bg-secondary: #132118; /* Darker moss green */
2854     -    2332 +    1967 +      5 +  --bg-tertiary: #1e3a29; /* Rich forest green */
2855     -    2333 +    1968 +      6 +  --text-primary: #d9f99d; /* Bright lime (firefly glow) */
2856     -    2334 +    1969 +      7 +  --text-secondary: #a3e635; /* Vibrant lime */
2857     -    2335 +    1970 +      8 +  --border-color: #2d5a3d; /* Forest green border */
2858     -    2336 +    1971 +  9   9  
2859     -    2337 +    1972 + 10  10    --h1-color: #84cc16;
2860     -    2338 +    1973 + 11  11    --h2-color: #a3e635;
2861     -    2339 +    1974 +@@ -17,31 +17,144 @@
2862     -    2340 +    1975 + 17  17    --link-color: #84cc16;
2863     -    2341 +    1976 + 18  18    --link-hover: #a3e635;
2864     -    2342 +    1977 + 19  19  
2865     -    2343 +    1978 + 20     -  /* Code Colors */
2866     -    2344 +    1979 + 21     -  --code-bg: #1a2817;
2867     -    2345 +    1980 +     20 +  /* Code Colors - Organic forest glow */
2868     -    2346 +    1981 +     21 +  --code-bg: rgba(132, 204, 22, 0.12); /* Lime-tinted background */
2869     -    2347 +    1982 + 22  22    --code-text: #a3e635;
2870     -    2348 +    1983 + 23     -  --code-block-bg: #0f1c0a;
2871     -    2349 +    1984 + 24     -  --code-border: #3f6212;
2872     -    2350 +    1985 +     23 +  --code-block-bg: #0d1a11; /* Deep forest with blue-green tint */
2873     -    2351 +    1986 +     24 +  --code-border: rgba(163, 230, 53, 0.3); /* Lime glow border */
2874     -    2352 +    1987 + 25  25  
2875     -    2353 +    1988 + 26     -  /* Syntax Highlighting - Comprehensive Token Colors */
2876     -    2354 +    1989 + 27     -  --syntax-keyword: #84cc16;
2877     -    2355 +    1990 + 28     -  --syntax-string: #a3e635;
2878     -    2356 +    1991 + 29     -  --syntax-number: #bef264;
2879     -    2357 +    1992 + 30     -  --syntax-function: #4ade80;
2880     -    2358 +    1993 + 31     -  --syntax-comment: #737373;
2881     -    2359 +    1994 + 32     -  --syntax-operator: #22c55e;
2882     -    2360 +    1995 + 33     -  --syntax-punctuation: #a3a3a3;
2883     -    2361 +    1996 +     26 +  /* Syntax Highlighting - Production-Grade Token Colors (One Dark Architecture) */
2884     -    2362 +    1997 + 34  27  
2885     -    2363 +    1998 + 35     -  /* Additional Token Types */
2886     -    2364 +    1999 + 36     -  --syntax-variable: #bef264; /* Variables - bright lime (distinct from text #d9f99d) */
2887     -    2365 +    2000 + 37     -  --syntax-property: #4ade80; /* Properties - green */
2888     -    2366 +    2001 + 38     -  --syntax-namespace: #84cc16; /* Namespaces - lime */
2889     -    2367 +    2002 + 39     -  --syntax-builtin: #22c55e; /* Builtins - green */
2890     -    2368 +    2003 +     28 +  /* Core hue-1: Teal - URLs */
2891     -    2369 +    2004 +     29 +  --syntax-url: #5eead4; /* Bright teal for URLs */
2892     -    2370 +    2005 +     30 +
2893     -    2371 +    2006 +     31 +  /* Core hue-2: Green - Functions, variables */
2894     -    2372 +    2007 +     32 +  --syntax-function: #4ade80; /* Bright green for functions */
2895     -    2373 +    2008 +     33 +  --syntax-variable: #22c55e; /* Medium green for variables */
2896     -    2374 +    2009 +     34 +
2897     -    2375 +    2010 +     35 +  /* Core hue-3: Yellow - Keywords */
2898     -    2376 +    2011 +     36 +  --syntax-keyword: #fbbf24; /* Golden yellow for keywords (final, sealed, class) */
2899     -    2377 +    2012 +     37 +
2900     -    2378 +    2013 +     38 +  /* Core hue-4: Lime - Strings, builtins */
2901     -    2379 +    2014 +     39 +  --syntax-string: #a3e635; /* Bright lime for strings */
2902     -    2380 +    2015 +     40 +  --syntax-builtin: #84cc16; /* Lime for builtins (String, List) */
2903     -    2381 +    2016 +     41 +  --syntax-char: #a3e635; /* Same as strings */
2904     -    2382 +    2017 +     42 +  --syntax-regex: #a3e635; /* Same as strings */
2905     -    2383 +    2018 +     43 +  --syntax-inserted: #84cc16; /* For diff */
2906     -    2384 +    2019 +     44 +
2907     -    2385 +    2020 +     45 +  /* Core hue-5: Orange/Amber - Properties, tags */
2908     -    2386 +    2021 +     46 +  --syntax-property: #fb923c; /* Orange for properties */
2909     -    2387 +    2022 +     47 +  --syntax-tag: #f97316; /* Burnt orange for tags */
2910     -    2388 +    2023 +     48 +  --syntax-deleted: #f87171; /* Coral for diff */
2911     -    2389 +    2024 +     49 +  --syntax-important: #fb923c; /* Orange for !important */
2912     -    2390 +    2025 +     50 +
2913     -    2391 +    2026 +     51 +  /* Core hue-6: Yellow-green - Class names, constants, numbers */
2914     -    2392 +    2027 +     52 +  --syntax-class-name: #bef264; /* Bright yellow-green for class names (Rectangle, Shape) */
2915     -    2393 +    2028 +     53 +  --syntax-number: #fde047; /* Bright yellow for numbers */
2916     -    2394 +    2029 +     54 +  --syntax-constant: #84cc16; /* Lime for constants */
2917     -    2395 +    2030 +     55 +  --syntax-boolean: #fde047; /* Same as numbers */
2918     -    2396 +    2031 +     56 +  --syntax-atrule: #a3e635; /* Lime for CSS @ rules */
2919     -    2397 +    2032 +     57 +
2920     -    2398 +    2033 +     58 +  /* Neutral colors */
2921     -    2399 +    2034 +     59 +  --syntax-comment: #737373; /* Gray for comments */
2922     -    2400 +    2035 +     60 +  --syntax-punctuation: #a3a3a3; /* Light gray for punctuation */
2923     -    2401 +    2036 +     61 +  --syntax-operator: #22c55e; /* Green for operators */
2924     -    2402 +    2037 +     62 +
2925     -    2403 +    2038 +     63 +  /* Markup specific */
2926     -    2404 +    2039 +     64 +  --syntax-attr-name: #bef264; /* Yellow-green like class-name */
2927     -    2405 +    2040 +     65 +  --syntax-attr-value: #a3e635; /* Lime like strings */
2928     -    2406 +    2041 +     66 +  --syntax-namespace: #fbbf24; /* Yellow like keywords */
2929     -    2407 +    2042 +     67 +  --syntax-entity: #a3a3a3; /* Neutral */
2930     -    2408 +    2043 +     68 +  --syntax-selector: #fb923c; /* Orange like properties */
2931     -    2409 +    2044 + 40  69  
2932     -    2410 +    2045 + 41  70    --blockquote-border: #84cc16;
2933     -    2411 +    2046 + 42     -  --blockquote-bg: #1a2817;
2934     -    2412 +    2047 +     71 +  --blockquote-bg: rgba(132, 204, 22, 0.08); /* Lime-tinted blockquote */
2935     -    2413 +    2048 + 43  72    --bold-color: #fbbf24;
2936     -    2414 +    2049 + 44  73    --italic-color: #84cc16;
2937     -    2415 +    2050 + 45     -  --table-header-bg: #2d4a2b;
2938     -    2416 +    2051 + 46     -  --table-border: #3f6212;
2939     -    2417 +    2052 +     74 +  --table-header-bg: rgba(74, 222, 128, 0.12); /* Green-tinted table header */
2940     -    2418 +    2053 +     75 +  --table-border: rgba(45, 90, 61, 0.4); /* Forest-tinted border */
2941     -    2419 +    2054 +     76 +
2942     -    2420 +    2055 +     77 +  /* === MERMAID COMPREHENSIVE CONFIGURATION === */
2943     -    2421 +    2056 +     78 +  /* Complete control over ALL diagram elements */
2944     -    2422 +    2057 +     79 +
2945     -    2423 +    2058 +     80 +  /* Core Global */
2946     -    2424 +    2059 +     81 +  --mermaid-background: #0a1408;
2947     -    2425 +    2060 +     82 +  --mermaid-text-color: #d9f99d;
2948     -    2426 +    2061 +     83 +  --mermaid-line-color: #a3e635;
2949     -    2427 +    2062 +     84 +  --mermaid-main-bkg: #2d5a3d;
2950     -    2428 +    2063 +     85 +
2951     -    2429 +    2064 +     86 +  /* Primary Set - Main nodes/boxes */
2952     -    2430 +    2065 +     87 +  --mermaid-primary-color: #2d5a3d;
2953     -    2431 +    2066 +     88 +  --mermaid-primary-text-color: #d9f99d;
2954     -    2432 +    2067 +     89 +  --mermaid-primary-border-color: #84cc16;
2955     -    2433 +    2068 +     90 +
2956     -    2434 +    2069 +     91 +  /* Secondary Set - Clusters/subgraphs */
2957     -    2435 +    2070 +     92 +  --mermaid-secondary-color: #1e3a29;
2958     -    2436 +    2071 +     93 +  --mermaid-secondary-text-color: #d9f99d;
2959     -    2437 +    2072 +     94 +  --mermaid-secondary-border-color: #a3e635;
2960     -    2438 +    2073 +     95 +
2961     -    2439 +    2074 +     96 +  /* Tertiary Set - Edge labels */
2962     -    2440 +    2075 +     97 +  --mermaid-tertiary-color: #0a1408;
2963     -    2441 +    2076 +     98 +  --mermaid-tertiary-text-color: #d9f99d;
2964     -    2442 +    2077 +     99 +  --mermaid-tertiary-border-color: #bef264;
2965     -    2443 +    2078 +    100 +
2966     -    2444 +    2079 +    101 +  /* Flowchart */
2967     -    2445 +    2080 +    102 +  --mermaid-node-border: #84cc16;
2968     -    2446 +    2081 +    103 +  --mermaid-cluster-bkg: #1e3a29;
2969     -    2447 +    2082 +    104 +  --mermaid-cluster-border: #a3e635;
2970     -    2448 +    2083 +    105 +  --mermaid-default-link-color: #a3e635;
2971     -    2449 +    2084 +    106 +  --mermaid-title-color: #d9f99d;
2972     -    2450 +    2085 +    107 +  --mermaid-edge-label-background: #0a1408;
2973     -    2451 +    2086 +    108 +  --mermaid-node-text-color: #d9f99d;
2974     -    2452 +    2087 +    109 +
2975     -    2453 +    2088 +    110 +  /* Sequence Diagram */
2976     -    2454 +    2089 +    111 +  --mermaid-actor-bkg: #2d5a3d;
2977     -    2455 +    2090 +    112 +  --mermaid-actor-border: #84cc16;
2978     -    2456 +    2091 +    113 +  --mermaid-actor-text-color: #d9f99d;
2979     -    2457 +    2092 +    114 +  --mermaid-actor-line-color: #84cc16;
2980     -    2458 +    2093 +    115 +  --mermaid-signal-color: #a3e635;
2981     -    2459 +    2094 +    116 +  --mermaid-signal-text-color: #d9f99d;
2982     -    2460 +    2095 +    117 +  --mermaid-label-box-bkg-color: #2d5a3d;
2983     -    2461 +    2096 +    118 +  --mermaid-label-box-border-color: #84cc16;
2984     -    2462 +    2097 +    119 +  --mermaid-label-text-color: #d9f99d;
2985     -    2463 +    2098 +    120 +  --mermaid-loop-text-color: #d9f99d;
2986     -    2464 +    2099 +    121 +  --mermaid-activation-border-color: #a3e635;
2987     -    2465 +    2100 +    122 +  --mermaid-activation-bkg-color: #1e3a29;
2988     -    2466 +    2101 +    123 +  --mermaid-sequence-number-color: #d9f99d;
2989     -    2467 +    2102 +    124 +
2990     -    2468 +    2103 +    125 +  /* Pie Chart - 12 distinct slice colors + text colors */
2991     -    2469 +    2104 +    126 +  --mermaid-pie1: #4ade80;
2992     -    2470 +    2105 +    127 +  --mermaid-pie2: #fbbf24;
2993     -    2471 +    2106 +    128 +  --mermaid-pie3: #fb923c;
2994     -    2472 +    2107 +    129 +  --mermaid-pie4: #5eead4;
2995     -    2473 +    2108 +    130 +  --mermaid-pie5: #a3e635;
2996     -    2474 +    2109 +    131 +  --mermaid-pie6: #22c55e;
2997     -    2475 +    2110 +    132 +  --mermaid-pie7: #84cc16;
2998     -    2476 +    2111 +    133 +  --mermaid-pie8: #fde047;
2999     -    2477 +    2112 +    134 +  --mermaid-pie9: #4ade80;
3000     -    2478 +    2113 +    135 +  --mermaid-pie10: #fbbf24;
3001     -    2479 +    2114 +    136 +  --mermaid-pie11: #fb923c;
3002     -    2480 +    2115 +    137 +  --mermaid-pie12: #5eead4;
3003     -    2481 +    2116 +    138 +  --mermaid-pie-title-text-color: #d9f99d;
3004     -    2482 +    2117 +    139 +  --mermaid-pie-section-text-color: #0a1408; /* Dark on vibrant slices */
3005     -    2483 +    2118 +    140 +  --mermaid-pie-legend-text-color: #d9f99d;
3006     -    2484 +    2119 +    141 +  --mermaid-pie-stroke-color: #84cc16;
3007     -    2485 +    2120 +    142 +  --mermaid-pie-outer-stroke-color: #84cc16;
3008     -    2486 +    2121 +    143 +
3009     -    2487 +    2122 +    144 +  /* State Diagram */
3010     -    2488 +    2123 +    145 +  --mermaid-label-color: #d9f99d;
3011     -    2489 +    2124 +    146 +  --mermaid-alt-background: #1e3a29;
3012     -    2490 +    2125 +    147 +
3013     -    2491 +    2126 +    148 +  /* Class Diagram */
3014     -    2492 +    2127 +    149 +  --mermaid-class-text: #d9f99d;
3015     -    2493 +    2128 +    150 +
3016     -    2494 +    2129 +    151 +  /* User Journey - 8 distinct colors */
3017     -    2495 +    2130 +    152 +  --mermaid-fill-type0: #4ade80;
3018     -    2496 +    2131 +    153 +  --mermaid-fill-type1: #fbbf24;
3019     -    2497 +    2132 +    154 +  --mermaid-fill-type2: #fb923c;
3020     -    2498 +    2133 +    155 +  --mermaid-fill-type3: #5eead4;
3021     -    2499 +    2134 +    156 +  --mermaid-fill-type4: #a3e635;
3022     -    2500 +    2135 +    157 +  --mermaid-fill-type5: #22c55e;
3023     -    2501 +    2136 +    158 +  --mermaid-fill-type6: #84cc16;
3024     -    2502 +    2137 +    159 +  --mermaid-fill-type7: #fde047;
3025     -    2503 +    2138 + 47 160  }
3026     -    2504 +    2139 + 48 161  
3027     -    2505 +    2140 +
3028     -    2506 +    2141 +```
3029     -    2507 +    2142 +
3030     -    2508 +    2143 +
3031     -    2509 +    2144 +### üìÑ `themes/forest-light.css`
3032     -    2510 +    2145 +
3033     -    2511 +    2146 +**Type:** Stylesheet üé®
3034     -    2512 +    2147 +
3035     -    2513 +    2148 +```diff
3036     -    2514 +    2149 +@@ -23,20 +23,49 @@
3037     -    2515 +    2150 + 23  23    --code-block-bg: #ecfccb; /* Light green background */
3038     -    2516 +    2151 + 24  24    --code-border: #bef264;
3039     -    2517 +    2152 + 25  25  
3040     -    2518 +    2153 + 26     -  /* Syntax Highlighting - Comprehensive Token Colors */
3041     -    2519 +    2154 + 27     -  --syntax-keyword: #15803d;
3042     -    2520 +    2155 + 28     -  --syntax-string: #16a34a;
3043     -    2521 +    2156 + 29     -  --syntax-number: #84cc16;
3044     -    2522 +    2157 + 30     -  --syntax-function: #22c55e;
3045     -    2523 +    2158 + 31     -  --syntax-comment: #737373;
3046     -    2524 +    2159 + 32     -  --syntax-operator: #3f6212;
3047     -    2525 +    2160 + 33     -  --syntax-punctuation: #525252;
3048     -    2526 +    2161 +     26 +  /* Syntax Highlighting - Production-Grade Token Colors (One Dark Architecture) */
3049     -    2527 +    2162 + 34  27  
3050     -    2528 +    2163 + 35     -  /* Additional Token Types for Full Customization */
3051     -    2529 +    2164 + 36     -  --syntax-variable: #15803d; /* Variables - forest green */
3052     -    2530 +    2165 + 37     -  --syntax-property: #16a34a; /* Properties - bright green */
3053     -    2531 +    2166 + 38     -  --syntax-namespace: #84cc16; /* Namespaces - lime */
3054     -    2532 +    2167 + 39     -  --syntax-builtin: #22c55e; /* Builtins - bright green */
3055     -    2533 +    2168 +     28 +  /* Core hue-1: Teal - URLs */
3056     -    2534 +    2169 +     29 +  --syntax-url: #14b8a6; /* Teal for URLs */
3057     -    2535 +    2170 +     30 +
3058     -    2536 +    2171 +     31 +  /* Core hue-2: Green - Functions, variables */
3059     -    2537 +    2172 +     32 +  --syntax-function: #22c55e; /* Bright green for functions */
3060     -    2538 +    2173 +     33 +  --syntax-variable: #16a34a; /* Forest green for variables */
3061     -    2539 +    2174 +     34 +
3062     -    2540 +    2175 +     35 +  /* Core hue-3: Emerald - Keywords */
3063     -    2541 +    2176 +     36 +  --syntax-keyword: #059669; /* Deep emerald for keywords (final, sealed, class) */
3064     -    2542 +    2177 +     37 +
3065     -    2543 +    2178 +     38 +  /* Core hue-4: Lime - Strings, builtins */
3066     -    2544 +    2179 +     39 +  --syntax-string: #84cc16; /* Lime green for strings */
3067     -    2545 +    2180 +     40 +  --syntax-builtin: #65a30d; /* Vibrant lime for builtins (String, List) */
3068     -    2546 +    2181 +     41 +  --syntax-char: #84cc16; /* Same as strings */
3069     -    2547 +    2182 +     42 +  --syntax-regex: #84cc16; /* Same as strings */
3070     -    2548 +    2183 +     43 +  --syntax-inserted: #65a30d; /* For diff */
3071     -    2549 +    2184 +     44 +
3072     -    2550 +    2185 +     45 +  /* Core hue-5: Amber/Brown - Properties, tags */
3073     -    2551 +    2186 +     46 +  --syntax-property: #b45309; /* Amber-brown for properties */
3074     -    2552 +    2187 +     47 +  --syntax-tag: #854d0e; /* Brown for tags */
3075     -    2553 +    2188 +     48 +  --syntax-deleted: #dc2626; /* Red for diff */
3076     -    2554 +    2189 +     49 +  --syntax-important: #b45309; /* Amber for !important */
3077     -    2555 +    2190 +     50 +
3078     -    2556 +    2191 +     51 +  /* Core hue-6: Yellow/Green - Class names, constants, numbers */
3079     -    2557 +    2192 +     52 +  --syntax-class-name: #facc15; /* Bright yellow for class names (Rectangle, Shape) */
3080     -    2558 +    2193 +     53 +  --syntax-number: #eab308; /* Yellow for numbers */
3081     -    2559 +    2194 +     54 +  --syntax-constant: #15803d; /* Forest green for constants */
3082     -    2560 +    2195 +     55 +  --syntax-boolean: #eab308; /* Same as numbers */
3083     -    2561 +    2196 +     56 +  --syntax-atrule: #84cc16; /* Lime for CSS @ rules */
3084     -    2562 +    2197 +     57 +
3085     -    2563 +    2198 +     58 +  /* Neutral colors */
3086     -    2564 +    2199 +     59 +  --syntax-comment: #737373; /* Gray for comments */
3087     -    2565 +    2200 +     60 +  --syntax-punctuation: #525252; /* Dark gray for punctuation */
3088     -    2566 +    2201 +     61 +  --syntax-operator: #3f6212; /* Olive for operators */
3089     -    2567 +    2202 +     62 +
3090     -    2568 +    2203 +     63 +  /* Markup specific */
3091     -    2569 +    2204 +     64 +  --syntax-attr-name: #facc15; /* Yellow like class-name */
3092     -    2570 +    2205 +     65 +  --syntax-attr-value: #84cc16; /* Lime like strings */
3093     -    2571 +    2206 +     66 +  --syntax-namespace: #059669; /* Emerald like keywords */
3094     -    2572 +    2207 +     67 +  --syntax-entity: #525252; /* Neutral */
3095     -    2573 +    2208 +     68 +  --syntax-selector: #b45309; /* Amber like properties */
3096     -    2574 +    2209 + 40  69  
3097     -    2575 +    2210 + 41  70    --blockquote-border: #16a34a;
3098     -    2576 +    2211 + 42  71    --blockquote-bg: #ecfccb;
3099     -    2577 +    2212 +@@ -44,4 +73,87 @@
3100     -    2578 +    2213 + 44  73    --italic-color: #15803d;
3101     -    2579 +    2214 + 45  74    --table-header-bg: #d9f99d;
3102     -    2580 +    2215 + 46  75    --table-border: #bef264;
3103     -    2581 +    2216 +     76 +
3104     -    2582 +    2217 +     77 +  /* === MERMAID COMPREHENSIVE CONFIGURATION === */
3105     -    2583 +    2218 +     78 +
3106     -    2584 +    2219 +     79 +  /* Core Global */
3107     -    2585 +    2220 +     80 +  --mermaid-background: #f7fee7;
3108     -    2586 +    2221 +     81 +  --mermaid-text-color: #1a2e05;
3109     -    2587 +    2222 +     82 +  --mermaid-line-color: #16a34a;
3110     -    2588 +    2223 +     83 +  --mermaid-main-bkg: #d9f99d;
3111     -    2589 +    2224 +     84 +
3112     -    2590 +    2225 +     85 +  /* Primary Set */
3113     -    2591 +    2226 +     86 +  --mermaid-primary-color: #d9f99d;
3114     -    2592 +    2227 +     87 +  --mermaid-primary-text-color: #1a2e05;
3115     -    2593 +    2228 +     88 +  --mermaid-primary-border-color: #15803d;
3116     -    2594 +    2229 +     89 +
3117     -    2595 +    2230 +     90 +  /* Secondary Set */
3118     -    2596 +    2231 +     91 +  --mermaid-secondary-color: #ecfccb;
3119     -    2597 +    2232 +     92 +  --mermaid-secondary-text-color: #1a2e05;
3120     -    2598 +    2233 +     93 +  --mermaid-secondary-border-color: #16a34a;
3121     -    2599 +    2234 +     94 +
3122     -    2600 +    2235 +     95 +  /* Tertiary Set */
3123     -    2601 +    2236 +     96 +  --mermaid-tertiary-color: #f7fee7;
3124     -    2602 +    2237 +     97 +  --mermaid-tertiary-text-color: #1a2e05;
3125     -    2603 +    2238 +     98 +  --mermaid-tertiary-border-color: #22c55e;
3126     -    2604 +    2239 +     99 +
3127     -    2605 +    2240 +    100 +  /* Flowchart */
3128     -    2606 +    2241 +    101 +  --mermaid-node-border: #15803d;
3129     -    2607 +    2242 +    102 +  --mermaid-cluster-bkg: #ecfccb;
3130     -    2608 +    2243 +    103 +  --mermaid-cluster-border: #16a34a;
3131     -    2609 +    2244 +    104 +  --mermaid-default-link-color: #16a34a;
3132     -    2610 +    2245 +    105 +  --mermaid-title-color: #1a2e05;
3133     -    2611 +    2246 +    106 +  --mermaid-edge-label-background: #f7fee7;
3134     -    2612 +    2247 +    107 +  --mermaid-node-text-color: #1a2e05;
3135     -    2613 +    2248 +    108 +
3136     -    2614 +    2249 +    109 +  /* Sequence Diagram */
3137     -    2615 +    2250 +    110 +  --mermaid-actor-bkg: #d9f99d;
3138     -    2616 +    2251 +    111 +  --mermaid-actor-border: #15803d;
3139     -    2617 +    2252 +    112 +  --mermaid-actor-text-color: #1a2e05;
3140     -    2618 +    2253 +    113 +  --mermaid-actor-line-color: #15803d;
3141     -    2619 +    2254 +    114 +  --mermaid-signal-color: #16a34a;
3142     -    2620 +    2255 +    115 +  --mermaid-signal-text-color: #1a2e05;
3143     -    2621 +    2256 +    116 +  --mermaid-label-box-bkg-color: #d9f99d;
3144     -    2622 +    2257 +    117 +  --mermaid-label-box-border-color: #15803d;
3145     -    2623 +    2258 +    118 +  --mermaid-label-text-color: #1a2e05;
3146     -    2624 +    2259 +    119 +  --mermaid-loop-text-color: #1a2e05;
3147     -    2625 +    2260 +    120 +  --mermaid-activation-border-color: #16a34a;
3148     -    2626 +    2261 +    121 +  --mermaid-activation-bkg-color: #ecfccb;
3149     -    2627 +    2262 +    122 +  --mermaid-sequence-number-color: #1a2e05;
3150     -    2628 +    2263 +    123 +
3151     -    2629 +    2264 +    124 +  /* Pie Chart */
3152     -    2630 +    2265 +    125 +  --mermaid-pie1: #15803d;
3153     -    2631 +    2266 +    126 +  --mermaid-pie2: #16a34a;
3154     -    2632 +    2267 +    127 +  --mermaid-pie3: #22c55e;
3155     -    2633 +    2268 +    128 +  --mermaid-pie4: #4ade80;
3156     -    2634 +    2269 +    129 +  --mermaid-pie5: #84cc16;
3157     -    2635 +    2270 +    130 +  --mermaid-pie6: #a3e635;
3158     -    2636 +    2271 +    131 +  --mermaid-pie7: #14b8a6;
3159     -    2637 +    2272 +    132 +  --mermaid-pie8: #facc15;
3160     -    2638 +    2273 +    133 +  --mermaid-pie9: #b45309;
3161     -    2639 +    2274 +    134 +  --mermaid-pie10: #15803d;
3162     -    2640 +    2275 +    135 +  --mermaid-pie11: #16a34a;
3163     -    2641 +    2276 +    136 +  --mermaid-pie12: #22c55e;
3164     -    2642 +    2277 +    137 +  --mermaid-pie-title-text-color: #1a2e05;
3165     -    2643 +    2278 +    138 +  --mermaid-pie-section-text-color: #f7fee7; /* Light on vibrant slices */
3166     -    2644 +    2279 +    139 +  --mermaid-pie-legend-text-color: #1a2e05;
3167     -    2645 +    2280 +    140 +  --mermaid-pie-stroke-color: #15803d;
3168     -    2646 +    2281 +    141 +  --mermaid-pie-outer-stroke-color: #15803d;
3169     -    2647 +    2282 +    142 +
3170     -    2648 +    2283 +    143 +  /* State Diagram */
3171     -    2649 +    2284 +    144 +  --mermaid-label-color: #1a2e05;
3172     -    2650 +    2285 +    145 +  --mermaid-alt-background: #ecfccb;
3173     -    2651 +    2286 +    146 +
3174     -    2652 +    2287 +    147 +  /* Class Diagram */
3175     -    2653 +    2288 +    148 +  --mermaid-class-text: #1a2e05;
3176     -    2654 +    2289 +    149 +
3177     -    2655 +    2290 +    150 +  /* User Journey */
3178     -    2656 +    2291 +    151 +  --mermaid-fill-type0: #15803d;
3179     -    2657 +    2292 +    152 +  --mermaid-fill-type1: #16a34a;
3180     -    2658 +    2293 +    153 +  --mermaid-fill-type2: #22c55e;
3181     -    2659 +    2294 +    154 +  --mermaid-fill-type3: #4ade80;
3182     -    2660 +    2295 +    155 +  --mermaid-fill-type4: #84cc16;
3183     -    2661 +    2296 +    156 +  --mermaid-fill-type5: #a3e635;
3184     -    2662 +    2297 +    157 +  --mermaid-fill-type6: #14b8a6;
3185     -    2663 +    2298 +    158 +  --mermaid-fill-type7: #facc15;
3186     -    2664 +    2299 + 47 159  }
3187     -    2665 +    2300 + 48 160  
3188     -    2666 +    2301 +
3189     -    2667 +    2302 +```
3190     -    2668 +    2303 +
3191     -    2669 +    2304 +
3192     -    2670 +    2305 +### üìÑ `themes/neon-dark.css`
3193     -    2671 +    2306 +
3194     -    2672 +    2307 +**Type:** Stylesheet üé®
3195     -    2673 +    2308 +
3196     -    2674 +    2309 +```diff
3197     -    2675 +    2310 +@@ -1,11 +1,11 @@
3198     -    2676 +    2311 +  1     -/* Neon Dark Theme */
3199     -    2677 +    2312 +      1 +/* Neon Dark Theme - Cyberpunk Aesthetic */
3200     -    2678 +    2313 +  2   2  :root {
3201     -    2679 +    2314 +  3     -  --bg-primary: #0d0d0d;
3202     -    2680 +    2315 +  4     -  --bg-secondary: #1a1a1a;
3203     -    2681 +    2316 +  5     -  --bg-tertiary: #262626;
3204     -    2682 +    2317 +  6     -  --text-primary: #ffffff;
3205     -    2683 +    2318 +  7     -  --text-secondary: #a3a3a3;
3206     -    2684 +    2319 +  8     -  --border-color: #404040;
3207     -    2685 +    2320 +      3 +  --bg-primary: #0a0e1a; /* Dark blue-purple, not pure black */
3208     -    2686 +    2321 +      4 +  --bg-secondary: #141827; /* Dark navy with purple tint */
3209     -    2687 +    2322 +      5 +  --bg-tertiary: #1e2539; /* Lighter navy */
3210     -    2688 +    2323 +      6 +  --text-primary: #e0e7ff; /* Slightly blue-tinted white */
3211     -    2689 +    2324 +      7 +  --text-secondary: #a5b4fc; /* Light indigo */
3212     -    2690 +    2325 +      8 +  --border-color: #4c1d95; /* Purple border for neon feel */
3213     -    2691 +    2326 +  9   9  
3214     -    2692 +    2327 + 10  10    --h1-color: #ff006e;
3215     -    2693 +    2328 + 11  11    --h2-color: #8338ec;
3216     -    2694 +    2329 +@@ -17,31 +17,143 @@
3217     -    2695 +    2330 + 17  17    --link-color: #ff006e;
3218     -    2696 +    2331 + 18  18    --link-hover: #ff1a8c;
3219     -    2697 +    2332 + 19  19  
3220     -    2698 +    2333 + 20     -  /* Code Colors */
3221     -    2699 +    2334 + 21     -  --code-bg: #1a1a1a;
3222     -    2700 +    2335 +     20 +  /* Code Colors - Neonic with purple glow */
3223     -    2701 +    2336 +     21 +  --code-bg: rgba(131, 56, 236, 0.15); /* Purple-tinted background */
3224     -    2702 +    2337 + 22  22    --code-text: #00f5d4;
3225     -    2703 +    2338 + 23     -  --code-block-bg: #0d0d0d;
3226     -    2704 +    2339 + 24     -  --code-border: #404040;
3227     -    2705 +    2340 +     23 +  --code-block-bg: #0f1419; /* Dark blue-black with hint of purple */
3228     -    2706 +    2341 +     24 +  --code-border: rgba(255, 0, 110, 0.3); /* Pink glow border */
3229     -    2707 +    2342 + 25  25  
3230     -    2708 +    2343 + 26     -  /* Syntax Highlighting - Comprehensive Token Colors */
3231     -    2709 +    2344 + 27     -  --syntax-keyword: #ff006e;
3232     -    2710 +    2345 + 28     -  --syntax-string: #00f5d4;
3233     -    2711 +    2346 + 29     -  --syntax-number: #ffbe0b;
3234     -    2712 +    2347 + 30     -  --syntax-function: #8338ec;
3235     -    2713 +    2348 + 31     -  --syntax-comment: #737373;
3236     -    2714 +    2349 + 32     -  --syntax-operator: #ff1a8c;
3237     -    2715 +    2350 + 33     -  --syntax-punctuation: #a3a3a3;
3238     -    2716 +    2351 +     26 +  /* Syntax Highlighting - Production-Grade Token Colors (One Dark Architecture) */
3239     -    2717 +    2352 + 34  27  
3240     -    2718 +    2353 + 35     -  /* Additional Token Types */
3241     -    2719 +    2354 + 36     -  --syntax-variable: #3a86ff; /* Variables - bright blue (distinct from text #ffffff) */
3242     -    2720 +    2355 + 37     -  --syntax-property: #8338ec; /* Properties - purple */
3243     -    2721 +    2356 + 38     -  --syntax-namespace: #ff006e; /* Namespaces - neon pink */
3244     -    2722 +    2357 + 39     -  --syntax-builtin: #00f5d4; /* Builtins - cyan */
3245     -    2723 +    2358 +     28 +  /* Core hue-1: Cyan - URLs */
3246     -    2724 +    2359 +     29 +  --syntax-url: #00f5d4; /* Electric cyan for URLs */
3247     -    2725 +    2360 +     30 +
3248     -    2726 +    2361 +     31 +  /* Core hue-2: Purple/Blue - Functions, variables */
3249     -    2727 +    2362 +     32 +  --syntax-function: #8338ec; /* Neon purple for functions */
3250     -    2728 +    2363 +     33 +  --syntax-variable: #3a86ff; /* Electric blue for variables */
3251     -    2729 +    2364 +     34 +
3252     -    2730 +    2365 +     35 +  /* Core hue-3: Pink - Keywords */
3253     -    2731 +    2366 +     36 +  --syntax-keyword: #ff006e; /* Hot pink for keywords (final, sealed, class) */
3254     -    2732 +    2367 +     37 +
3255     -    2733 +    2368 +     38 +  /* Core hue-4: Cyan/Teal - Strings, builtins */
3256     -    2734 +    2369 +     39 +  --syntax-string: #00f5d4; /* Electric cyan for strings */
3257     -    2735 +    2370 +     40 +  --syntax-builtin: #00d4aa; /* Bright teal for builtins (String, List) */
3258     -    2736 +    2371 +     41 +  --syntax-char: #00f5d4; /* Same as strings */
3259     -    2737 +    2372 +     42 +  --syntax-regex: #00f5d4; /* Same as strings */
3260     -    2738 +    2373 +     43 +  --syntax-inserted: #00d4aa; /* For diff */
3261     -    2739 +    2374 +     44 +
3262     -    2740 +    2375 +     45 +  /* Core hue-5: Orange/Red - Properties, tags */
3263     -    2741 +    2376 +     46 +  --syntax-property: #fb5607; /* Neon orange for properties */
3264     -    2742 +    2377 +     47 +  --syntax-tag: #ff006e; /* Hot pink for tags */
3265     -    2743 +    2378 +     48 +  --syntax-deleted: #ff006e; /* Pink for diff */
3266     -    2744 +    2379 +     49 +  --syntax-important: #fb5607; /* Orange for !important */
3267     -    2745 +    2380 +     50 +
3268     -    2746 +    2381 +     51 +  /* Core hue-6: Yellow/Purple - Class names, constants, numbers */
3269     -    2747 +    2382 +     52 +  --syntax-class-name: #ffbe0b; /* Electric yellow for class names (Rectangle, Shape) */
3270     -    2748 +    2383 +     53 +  --syntax-number: #ffbe0b; /* Yellow for numbers */
3271     -    2749 +    2384 +     54 +  --syntax-constant: #fb5607; /* Orange for constants */
3272     -    2750 +    2385 +     55 +  --syntax-boolean: #ffbe0b; /* Same as numbers */
3273     -    2751 +    2386 +     56 +  --syntax-atrule: #8338ec; /* Purple for CSS @ rules */
3274     -    2752 +    2387 +     57 +
3275     -    2753 +    2388 +     58 +  /* Neutral colors */
3276     -    2754 +    2389 +     59 +  --syntax-comment: #737373; /* Gray for comments */
3277     -    2755 +    2390 +     60 +  --syntax-punctuation: #a3a3a3; /* Light gray for punctuation */
3278     -    2756 +    2391 +     61 +  --syntax-operator: #ff1a8c; /* Pink for operators */
3279     -    2757 +    2392 +     62 +
3280     -    2758 +    2393 +     63 +  /* Markup specific */
3281     -    2759 +    2394 +     64 +  --syntax-attr-name: #ffbe0b; /* Yellow like class-name */
3282     -    2760 +    2395 +     65 +  --syntax-attr-value: #00f5d4; /* Cyan like strings */
3283     -    2761 +    2396 +     66 +  --syntax-namespace: #8338ec; /* Purple */
3284     -    2762 +    2397 +     67 +  --syntax-entity: #a3a3a3; /* Neutral */
3285     -    2763 +    2398 +     68 +  --syntax-selector: #fb5607; /* Orange like properties */
3286     -    2764 +    2399 + 40  69  
3287     -    2765 +    2400 + 41  70    --blockquote-border: #8338ec;
3288     -    2766 +    2401 + 42     -  --blockquote-bg: #1a1a1a;
3289     -    2767 +    2402 +     71 +  --blockquote-bg: rgba(131, 56, 236, 0.1); /* Purple-tinted blockquote */
3290     -    2768 +    2403 + 43  72    --bold-color: #ffbe0b;
3291     -    2769 +    2404 + 44  73    --italic-color: #ff006e;
3292     -    2770 +    2405 + 45     -  --table-header-bg: #262626;
3293     -    2771 +    2406 + 46     -  --table-border: #404040;
3294     -    2772 +    2407 +     74 +  --table-header-bg: rgba(58, 134, 255, 0.15); /* Blue-tinted table header */
3295     -    2773 +    2408 +     75 +  --table-border: rgba(76, 29, 149, 0.3); /* Purple-tinted border */
3296     -    2774 +    2409 +     76 +
3297     -    2775 +    2410 +     77 +  /* === MERMAID COMPREHENSIVE CONFIGURATION === */
3298     -    2776 +    2411 +     78 +
3299     -    2777 +    2412 +     79 +  /* Core Global */
3300     -    2778 +    2413 +     80 +  --mermaid-background: #0a0e1a;
3301     -    2779 +    2414 +     81 +  --mermaid-text-color: #e0e7ff;
3302     -    2780 +    2415 +     82 +  --mermaid-line-color: #3a86ff;
3303     -    2781 +    2416 +     83 +  --mermaid-main-bkg: #1e2539;
3304     -    2782 +    2417 +     84 +
3305     -    2783 +    2418 +     85 +  /* Primary Set */
3306     -    2784 +    2419 +     86 +  --mermaid-primary-color: #1e2539;
3307     -    2785 +    2420 +     87 +  --mermaid-primary-text-color: #e0e7ff;
3308     -    2786 +    2421 +     88 +  --mermaid-primary-border-color: #8338ec;
3309     -    2787 +    2422 +     89 +
3310     -    2788 +    2423 +     90 +  /* Secondary Set */
3311     -    2789 +    2424 +     91 +  --mermaid-secondary-color: #141827;
3312     -    2790 +    2425 +     92 +  --mermaid-secondary-text-color: #e0e7ff;
3313     -    2791 +    2426 +     93 +  --mermaid-secondary-border-color: #3a86ff;
3314     -    2792 +    2427 +     94 +
3315     -    2793 +    2428 +     95 +  /* Tertiary Set */
3316     -    2794 +    2429 +     96 +  --mermaid-tertiary-color: #0a0e1a;
3317     -    2795 +    2430 +     97 +  --mermaid-tertiary-text-color: #e0e7ff;
3318     -    2796 +    2431 +     98 +  --mermaid-tertiary-border-color: #ff006e;
3319     -    2797 +    2432 +     99 +
3320     -    2798 +    2433 +    100 +  /* Flowchart */
3321     -    2799 +    2434 +    101 +  --mermaid-node-border: #8338ec;
3322     -    2800 +    2435 +    102 +  --mermaid-cluster-bkg: #141827;
3323     -    2801 +    2436 +    103 +  --mermaid-cluster-border: #3a86ff;
3324     -    2802 +    2437 +    104 +  --mermaid-default-link-color: #3a86ff;
3325     -    2803 +    2438 +    105 +  --mermaid-title-color: #e0e7ff;
3326     -    2804 +    2439 +    106 +  --mermaid-edge-label-background: #0a0e1a;
3327     -    2805 +    2440 +    107 +  --mermaid-node-text-color: #e0e7ff;
3328     -    2806 +    2441 +    108 +
3329     -    2807 +    2442 +    109 +  /* Sequence Diagram */
3330     -    2808 +    2443 +    110 +  --mermaid-actor-bkg: #1e2539;
3331     -    2809 +    2444 +    111 +  --mermaid-actor-border: #8338ec;
3332     -    2810 +    2445 +    112 +  --mermaid-actor-text-color: #e0e7ff;
3333     -    2811 +    2446 +    113 +  --mermaid-actor-line-color: #8338ec;
3334     -    2812 +    2447 +    114 +  --mermaid-signal-color: #3a86ff;
3335     -    2813 +    2448 +    115 +  --mermaid-signal-text-color: #e0e7ff;
3336     -    2814 +    2449 +    116 +  --mermaid-label-box-bkg-color: #1e2539;
3337     -    2815 +    2450 +    117 +  --mermaid-label-box-border-color: #8338ec;
3338     -    2816 +    2451 +    118 +  --mermaid-label-text-color: #e0e7ff;
3339     -    2817 +    2452 +    119 +  --mermaid-loop-text-color: #e0e7ff;
3340     -    2818 +    2453 +    120 +  --mermaid-activation-border-color: #3a86ff;
3341     -    2819 +    2454 +    121 +  --mermaid-activation-bkg-color: #141827;
3342     -    2820 +    2455 +    122 +  --mermaid-sequence-number-color: #e0e7ff;
3343     -    2821 +    2456 +    123 +
3344     -    2822 +    2457 +    124 +  /* Pie Chart */
3345     -    2823 +    2458 +    125 +  --mermaid-pie1: #ff006e;
3346     -    2824 +    2459 +    126 +  --mermaid-pie2: #8338ec;
3347     -    2825 +    2460 +    127 +  --mermaid-pie3: #3a86ff;
3348     -    2826 +    2461 +    128 +  --mermaid-pie4: #00f5d4;
3349     -    2827 +    2462 +    129 +  --mermaid-pie5: #ffbe0b;
3350     -    2828 +    2463 +    130 +  --mermaid-pie6: #fb5607;
3351     -    2829 +    2464 +    131 +  --mermaid-pie7: #ff1a8c;
3352     -    2830 +    2465 +    132 +  --mermaid-pie8: #00d4aa;
3353     -    2831 +    2466 +    133 +  --mermaid-pie9: #a5b4fc;
3354     -    2832 +    2467 +    134 +  --mermaid-pie10: #ff006e;
3355     -    2833 +    2468 +    135 +  --mermaid-pie11: #8338ec;
3356     -    2834 +    2469 +    136 +  --mermaid-pie12: #3a86ff;
3357     -    2835 +    2470 +    137 +  --mermaid-pie-title-text-color: #e0e7ff;
3358     -    2836 +    2471 +    138 +  --mermaid-pie-section-text-color: #0a0e1a; /* Dark on vibrant slices */
3359     -    2837 +    2472 +    139 +  --mermaid-pie-legend-text-color: #e0e7ff;
3360     -    2838 +    2473 +    140 +  --mermaid-pie-stroke-color: #8338ec;
3361     -    2839 +    2474 +    141 +  --mermaid-pie-outer-stroke-color: #8338ec;
3362     -    2840 +    2475 +    142 +
3363     -    2841 +    2476 +    143 +  /* State Diagram */
3364     -    2842 +    2477 +    144 +  --mermaid-label-color: #e0e7ff;
3365     -    2843 +    2478 +    145 +  --mermaid-alt-background: #141827;
3366     -    2844 +    2479 +    146 +
3367     -    2845 +    2480 +    147 +  /* Class Diagram */
3368     -    2846 +    2481 +    148 +  --mermaid-class-text: #e0e7ff;
3369     -    2847 +    2482 +    149 +
3370     -    2848 +    2483 +    150 +  /* User Journey */
3371     -    2849 +    2484 +    151 +  --mermaid-fill-type0: #ff006e;
3372     -    2850 +    2485 +    152 +  --mermaid-fill-type1: #8338ec;
3373     -    2851 +    2486 +    153 +  --mermaid-fill-type2: #3a86ff;
3374     -    2852 +    2487 +    154 +  --mermaid-fill-type3: #00f5d4;
3375     -    2853 +    2488 +    155 +  --mermaid-fill-type4: #ffbe0b;
3376     -    2854 +    2489 +    156 +  --mermaid-fill-type5: #fb5607;
3377     -    2855 +    2490 +    157 +  --mermaid-fill-type6: #ff1a8c;
3378     -    2856 +    2491 +    158 +  --mermaid-fill-type7: #00d4aa;
3379     -    2857 +    2492 + 47 159  }
3380     -    2858 +    2493 + 48 160  
3381     -    2859 +    2494 +
3382     -    2860 +    2495 +```
3383     -    2861 +    2496 +
3384     -    2862 +    2497 +
3385     -    2863 +    2498 +### üìÑ `themes/neon-light.css`
3386     -    2864 +    2499 +
3387     -    2865 +    2500 +**Type:** Stylesheet üé®
3388     -    2866 +    2501 +
3389     -    2867 +    2502 +```diff
3390     -    2868 +    2503 +@@ -23,20 +23,49 @@
3391     -    2869 +    2504 + 23  23    --code-block-bg: #fef3ff; /* Light purple background */
3392     -    2870 +    2505 + 24  24    --code-border: #e9d5ff;
3393     -    2871 +    2506 + 25  25  
3394     -    2872 +    2507 + 26     -  /* Syntax Highlighting - Comprehensive Token Colors */
3395     -    2873 +    2508 + 27     -  --syntax-keyword: #c026d3;
3396     -    2874 +    2509 + 28     -  --syntax-string: #10b981;
3397     -    2875 +    2510 + 29     -  --syntax-number: #f59e0b;
3398     -    2876 +    2511 + 30     -  --syntax-function: #7c3aed;
3399     -    2877 +    2512 + 31     -  --syntax-comment: #9ca3af;
3400     -    2878 +    2513 + 32     -  --syntax-operator: #a21caf;
3401     -    2879 +    2514 + 33     -  --syntax-punctuation: #6b7280;
3402     -    2880 +    2515 +     26 +  /* Syntax Highlighting - Production-Grade Token Colors (One Dark Architecture) */
3403     -    2881 +    2516 + 34  27  
3404     -    2882 +    2517 + 35     -  /* Additional Token Types for Full Customization */
3405     -    2883 +    2518 + 36     -  --syntax-variable: #7c3aed; /* Variables - purple */
3406     -    2884 +    2519 + 37     -  --syntax-property: #a21caf; /* Properties - magenta */
3407     -    2885 +    2520 + 38     -  --syntax-namespace: #c026d3; /* Namespaces - pink */
3408     -    2886 +    2521 + 39     -  --syntax-builtin: #7c3aed; /* Builtins - purple */
3409     -    2887 +    2522 +     28 +  /* Core hue-1: Cyan - URLs */
3410     -    2888 +    2523 +     29 +  --syntax-url: #06b6d4; /* Cyan for URLs */
3411     -    2889 +    2524 +     30 +
3412     -    2890 +    2525 +     31 +  /* Core hue-2: Purple/Violet - Functions, variables */
3413     -    2891 +    2526 +     32 +  --syntax-function: #7c3aed; /* Vibrant purple for functions */
3414     -    2892 +    2527 +     33 +  --syntax-variable: #6366f1; /* Indigo for variables */
3415     -    2893 +    2528 +     34 +
3416     -    2894 +    2529 +     35 +  /* Core hue-3: Magenta - Keywords */
3417     -    2895 +    2530 +     36 +  --syntax-keyword: #c026d3; /* Bright magenta for keywords (final, sealed, class) */
3418     -    2896 +    2531 +     37 +
3419     -    2897 +    2532 +     38 +  /* Core hue-4: Green - Strings, builtins */
3420     -    2898 +    2533 +     39 +  --syntax-string: #10b981; /* Emerald green for strings */
3421     -    2899 +    2534 +     40 +  --syntax-builtin: #059669; /* Dark emerald for builtins (String, List) */
3422     -    2900 +    2535 +     41 +  --syntax-char: #10b981; /* Same as strings */
3423     -    2901 +    2536 +     42 +  --syntax-regex: #10b981; /* Same as strings */
3424     -    2902 +    2537 +     43 +  --syntax-inserted: #10b981; /* For diff */
3425     -    2903 +    2538 +     44 +
3426     -    2904 +    2539 +     45 +  /* Core hue-5: Blue - Properties, tags */
3427     -    2905 +    2540 +     46 +  --syntax-property: #3b82f6; /* Blue for properties */
3428     -    2906 +    2541 +     47 +  --syntax-tag: #2563eb; /* Dark blue for tags */
3429     -    2907 +    2542 +     48 +  --syntax-deleted: #ef4444; /* Red for diff */
3430     -    2908 +    2543 +     49 +  --syntax-important: #3b82f6; /* Blue for !important */
3431     -    2909 +    2544 +     50 +
3432     -    2910 +    2545 +     51 +  /* Core hue-6: Amber/Pink - Class names, constants, numbers */
3433     -    2911 +    2546 +     52 +  --syntax-class-name: #d946ef; /* Fuchsia for class names (Rectangle, Shape) */
3434     -    2912 +    2547 +     53 +  --syntax-number: #f59e0b; /* Amber for numbers */
3435     -    2913 +    2548 +     54 +  --syntax-constant: #c026d3; /* Magenta for constants */
3436     -    2914 +    2549 +     55 +  --syntax-boolean: #f59e0b; /* Same as numbers */
3437     -    2915 +    2550 +     56 +  --syntax-atrule: #d946ef; /* Fuchsia for CSS @ rules */
3438     -    2916 +    2551 +     57 +
3439     -    2917 +    2552 +     58 +  /* Neutral colors */
3440     -    2918 +    2553 +     59 +  --syntax-comment: #9ca3af; /* Gray for comments */
3441     -    2919 +    2554 +     60 +  --syntax-punctuation: #6b7280; /* Dark gray for punctuation */
3442     -    2920 +    2555 +     61 +  --syntax-operator: #a21caf; /* Magenta-pink for operators */
3443     -    2921 +    2556 +     62 +
3444     -    2922 +    2557 +     63 +  /* Markup specific */
3445     -    2923 +    2558 +     64 +  --syntax-attr-name: #d946ef; /* Fuchsia like class-name */
3446     -    2924 +    2559 +     65 +  --syntax-attr-value: #10b981; /* Green like strings */
3447     -    2925 +    2560 +     66 +  --syntax-namespace: #7c3aed; /* Purple like keywords */
3448     -    2926 +    2561 +     67 +  --syntax-entity: #6b7280; /* Neutral */
3449     -    2927 +    2562 +     68 +  --syntax-selector: #3b82f6; /* Blue like properties */
3450     -    2928 +    2563 + 40  69  
3451     -    2929 +    2564 + 41  70    --blockquote-border: #c026d3;
3452     -    2930 +    2565 + 42  71    --blockquote-bg: #fef3ff;
3453     -    2931 +    2566 +@@ -44,4 +73,87 @@
3454     -    2932 +    2567 + 44  73    --italic-color: #c026d3;
3455     -    2933 +    2568 + 45  74    --table-header-bg: #fce7f3;
3456     -    2934 +    2569 + 46  75    --table-border: #e9d5ff;
3457     -    2935 +    2570 +     76 +
3458     -    2936 +    2571 +     77 +  /* === MERMAID COMPREHENSIVE CONFIGURATION === */
3459     -    2937 +    2572 +     78 +
3460     -    2938 +    2573 +     79 +  /* Core Global */
3461     -    2939 +    2574 +     80 +  --mermaid-background: #ffffff;
3462     -    2940 +    2575 +     81 +  --mermaid-text-color: #3b0764;
3463     -    2941 +    2576 +     82 +  --mermaid-line-color: #7c3aed;
3464     -    2942 +    2577 +     83 +  --mermaid-main-bkg: #fce7f3;
3465     -    2943 +    2578 +     84 +
3466     -    2944 +    2579 +     85 +  /* Primary Set */
3467     -    2945 +    2580 +     86 +  --mermaid-primary-color: #fce7f3;
3468     -    2946 +    2581 +     87 +  --mermaid-primary-text-color: #3b0764;
3469     -    2947 +    2582 +     88 +  --mermaid-primary-border-color: #c026d3;
3470     -    2948 +    2583 +     89 +
3471     -    2949 +    2584 +     90 +  /* Secondary Set */
3472     -    2950 +    2585 +     91 +  --mermaid-secondary-color: #fef3ff;
3473     -    2951 +    2586 +     92 +  --mermaid-secondary-text-color: #3b0764;
3474     -    2952 +    2587 +     93 +  --mermaid-secondary-border-color: #7c3aed;
3475     -    2953 +    2588 +     94 +
3476     -    2954 +    2589 +     95 +  /* Tertiary Set */
3477     -    2955 +    2590 +     96 +  --mermaid-tertiary-color: #ffffff;
3478     -    2956 +    2591 +     97 +  --mermaid-tertiary-text-color: #3b0764;
3479     -    2957 +    2592 +     98 +  --mermaid-tertiary-border-color: #d946ef;
3480     -    2958 +    2593 +     99 +
3481     -    2959 +    2594 +    100 +  /* Flowchart */
3482     -    2960 +    2595 +    101 +  --mermaid-node-border: #c026d3;
3483     -    2961 +    2596 +    102 +  --mermaid-cluster-bkg: #fef3ff;
3484     -    2962 +    2597 +    103 +  --mermaid-cluster-border: #7c3aed;
3485     -    2963 +    2598 +    104 +  --mermaid-default-link-color: #7c3aed;
3486     -    2964 +    2599 +    105 +  --mermaid-title-color: #3b0764;
3487     -    2965 +    2600 +    106 +  --mermaid-edge-label-background: #ffffff;
3488     -    2966 +    2601 +    107 +  --mermaid-node-text-color: #3b0764;
3489     -    2967 +    2602 +    108 +
3490     -    2968 +    2603 +    109 +  /* Sequence Diagram */
3491     -    2969 +    2604 +    110 +  --mermaid-actor-bkg: #fce7f3;
3492     -    2970 +    2605 +    111 +  --mermaid-actor-border: #c026d3;
3493     -    2971 +    2606 +    112 +  --mermaid-actor-text-color: #3b0764;
3494     -    2972 +    2607 +    113 +  --mermaid-actor-line-color: #c026d3;
3495     -    2973 +    2608 +    114 +  --mermaid-signal-color: #7c3aed;
3496     -    2974 +    2609 +    115 +  --mermaid-signal-text-color: #3b0764;
3497     -    2975 +    2610 +    116 +  --mermaid-label-box-bkg-color: #fce7f3;
3498     -    2976 +    2611 +    117 +  --mermaid-label-box-border-color: #c026d3;
3499     -    2977 +    2612 +    118 +  --mermaid-label-text-color: #3b0764;
3500     -    2978 +    2613 +    119 +  --mermaid-loop-text-color: #3b0764;
3501     -    2979 +    2614 +    120 +  --mermaid-activation-border-color: #7c3aed;
3502     -    2980 +    2615 +    121 +  --mermaid-activation-bkg-color: #fef3ff;
3503     -    2981 +    2616 +    122 +  --mermaid-sequence-number-color: #3b0764;
3504     -    2982 +    2617 +    123 +
3505     -    2983 +    2618 +    124 +  /* Pie Chart */
3506     -    2984 +    2619 +    125 +  --mermaid-pie1: #c026d3;
3507     -    2985 +    2620 +    126 +  --mermaid-pie2: #7c3aed;
3508     -    2986 +    2621 +    127 +  --mermaid-pie3: #3b82f6;
3509     -    2987 +    2622 +    128 +  --mermaid-pie4: #06b6d4;
3510     -    2988 +    2623 +    129 +  --mermaid-pie5: #f59e0b;
3511     -    2989 +    2624 +    130 +  --mermaid-pie6: #ef4444;
3512     -    2990 +    2625 +    131 +  --mermaid-pie7: #d946ef;
3513     -    2991 +    2626 +    132 +  --mermaid-pie8: #6366f1;
3514     -    2992 +    2627 +    133 +  --mermaid-pie9: #10b981;
3515     -    2993 +    2628 +    134 +  --mermaid-pie10: #c026d3;
3516     -    2994 +    2629 +    135 +  --mermaid-pie11: #7c3aed;
3517     -    2995 +    2630 +    136 +  --mermaid-pie12: #3b82f6;
3518     -    2996 +    2631 +    137 +  --mermaid-pie-title-text-color: #3b0764;
3519     -    2997 +    2632 +    138 +  --mermaid-pie-section-text-color: #ffffff; /* White on vibrant slices */
3520     -    2998 +    2633 +    139 +  --mermaid-pie-legend-text-color: #3b0764;
3521     -    2999 +    2634 +    140 +  --mermaid-pie-stroke-color: #c026d3;
3522     -    3000 +    2635 +    141 +  --mermaid-pie-outer-stroke-color: #c026d3;
3523     -    3001 +    2636 +    142 +
3524     -    3002 +    2637 +    143 +  /* State Diagram */
3525     -    3003 +    2638 +    144 +  --mermaid-label-color: #3b0764;
3526     -    3004 +    2639 +    145 +  --mermaid-alt-background: #fef3ff;
3527     -    3005 +    2640 +    146 +
3528     -    3006 +    2641 +    147 +  /* Class Diagram */
3529     -    3007 +    2642 +    148 +  --mermaid-class-text: #3b0764;
3530     -    3008 +    2643 +    149 +
3531     -    3009 +    2644 +    150 +  /* User Journey */
3532     -    3010 +    2645 +    151 +  --mermaid-fill-type0: #c026d3;
3533     -    3011 +    2646 +    152 +  --mermaid-fill-type1: #7c3aed;
3534     -    3012 +    2647 +    153 +  --mermaid-fill-type2: #3b82f6;
3535     -    3013 +    2648 +    154 +  --mermaid-fill-type3: #06b6d4;
3536     -    3014 +    2649 +    155 +  --mermaid-fill-type4: #f59e0b;
3537     -    3015 +    2650 +    156 +  --mermaid-fill-type5: #ef4444;
3538     -    3016 +    2651 +    157 +  --mermaid-fill-type6: #d946ef;
3539     -    3017 +    2652 +    158 +  --mermaid-fill-type7: #6366f1;
3540     -    3018 +    2653 + 47 159  }
3541     -    3019 +    2654 + 48 160  
3542     -    3020 +    2655 +
3543     -    3021 +    2656 +```
3544     -    3022 +    2657 +
3545     -    3023 +    2658 +
3546     -    3024 +    2659 +### üìÑ `themes/obsidian-dark.css`
3547     -    3025 +    2660 +
3548     -    3026 +    2661 +**Type:** Stylesheet üé®
3549     -    3027 +    2662 +
3550     -    3028 +    2663 +```diff
3551     -    3029 +    2664 +@@ -52,20 +52,49 @@
3552     -    3030 +    2665 + 52  52    --code-block-bg: #232635;
3553     -    3031 +    2666 + 53  53    --code-border: rgba(78, 205, 196, 0.2);
3554     -    3032 +    2667 + 54  54  
3555     -    3033 +    2668 + 55     -  /* Syntax Highlighting */
3556     -    3034 +    2669 + 56     -  --syntax-keyword: #c792ea;
3557     -    3035 +    2670 + 57     -  --syntax-string: #6bcf7f;
3558     -    3036 +    2671 + 58     -  --syntax-number: #ffcb6b;
3559     -    3037 +    2672 + 59     -  --syntax-function: #82aaff;
3560     -    3038 +    2673 + 60     -  --syntax-comment: #7f85a3;
3561     -    3039 +    2674 + 61     -  --syntax-operator: #89ddff;
3562     -    3040 +    2675 + 62     -  --syntax-punctuation: #b8bcc8;
3563     -    3041 +    2676 +     55 +  /* Syntax Highlighting - Production-Grade Token Colors (One Dark Architecture) */
3564     -    3042 +    2677 + 63  56  
3565     -    3043 +    2678 + 64     -  /* Additional Token Types */
3566     -    3044 +    2679 + 65     -  --syntax-variable: #82aaff; /* Variables - blue (distinct from text #f5f7ff) */
3567     -    3045 +    2680 + 66     -  --syntax-property: #4ecdc4; /* Properties - cyan */
3568     -    3046 +    2681 + 67     -  --syntax-namespace: #ffb86c; /* Namespaces - orange */
3569     -    3047 +    2682 + 68     -  --syntax-builtin: #c77dff; /* Builtins - purple */
3570     -    3048 +    2683 +     57 +  /* Core hue-1: Cyan - URLs */
3571     -    3049 +    2684 +     58 +  --syntax-url: #4ecdc4; /* Bright cyan for URLs */
3572     -    3050 +    2685 +     59 +
3573     -    3051 +    2686 +     60 +  /* Core hue-2: Blue - Functions, variables */
3574     -    3052 +    2687 +     61 +  --syntax-function: #82aaff; /* Bright blue for functions */
3575     -    3053 +    2688 +     62 +  --syntax-variable: #5da9ff; /* Sky blue for variables */
3576     -    3054 +    2689 +     63 +
3577     -    3055 +    2690 +     64 +  /* Core hue-3: Purple - Keywords */
3578     -    3056 +    2691 +     65 +  --syntax-keyword: #c792ea; /* Lavender purple for keywords (final, sealed, class) */
3579     -    3057 +    2692 +     66 +
3580     -    3058 +    2693 +     67 +  /* Core hue-4: Green - Strings, builtins */
3581     -    3059 +    2694 +     68 +  --syntax-string: #95e1d3; /* Mint green for strings */
3582     -    3060 +    2695 +     69 +  --syntax-builtin: #6bcf7f; /* Vibrant green for builtins (String, List) */
3583     -    3061 +    2696 +     70 +  --syntax-char: #95e1d3; /* Same as strings */
3584     -    3062 +    2697 +     71 +  --syntax-regex: #95e1d3; /* Same as strings */
3585     -    3063 +    2698 +     72 +  --syntax-inserted: #6bcf7f; /* For diff */
3586     -    3064 +    2699 +     73 +
3587     -    3065 +    2700 +     74 +  /* Core hue-5: Pink - Properties, tags */
3588     -    3066 +    2701 +     75 +  --syntax-property: #ff6b9d; /* Hot pink for properties */
3589     -    3067 +    2702 +     76 +  --syntax-tag: #ff7eb3; /* Coral pink for tags */
3590     -    3068 +    2703 +     77 +  --syntax-deleted: #f38ba8; /* Pink-red for diff */
3591     -    3069 +    2704 +     78 +  --syntax-important: #ff6b9d; /* Hot pink for !important */
3592     -    3070 +    2705 +     79 +
3593     -    3071 +    2706 +     80 +  /* Core hue-6: Yellow/Orange - Class names, constants, numbers */
3594     -    3072 +    2707 +     81 +  --syntax-class-name: #ffb86c; /* Peach orange for class names (Rectangle, Shape) */
3595     -    3073 +    2708 +     82 +  --syntax-number: #ffd93d; /* Bright yellow for numbers */
3596     -    3074 +    2709 +     83 +  --syntax-constant: #ffb86c; /* Peach for constants */
3597     -    3075 +    2710 +     84 +  --syntax-boolean: #ffd93d; /* Same as numbers */
3598     -    3076 +    2711 +     85 +  --syntax-atrule: #c77dff; /* Purple for CSS @ rules */
3599     -    3077 +    2712 +     86 +
3600     -    3078 +    2713 +     87 +  /* Neutral colors */
3601     -    3079 +    2714 +     88 +  --syntax-comment: #7f85a3; /* Muted blue-gray for comments */
3602     -    3080 +    2715 +     89 +  --syntax-punctuation: #b8bcc8; /* Light gray for punctuation */
3603     -    3081 +    2716 +     90 +  --syntax-operator: #89ddff; /* Cyan for operators */
3604     -    3082 +    2717 +     91 +
3605     -    3083 +    2718 +     92 +  /* Markup specific */
3606     -    3084 +    2719 +     93 +  --syntax-attr-name: #ffb86c; /* Peach like class-name */
3607     -    3085 +    2720 +     94 +  --syntax-attr-value: #95e1d3; /* Mint like strings */
3608     -    3086 +    2721 +     95 +  --syntax-namespace: #c792ea; /* Purple like keywords */
3609     -    3087 +    2722 +     96 +  --syntax-entity: #b8bcc8; /* Neutral */
3610     -    3088 +    2723 +     97 +  --syntax-selector: #ff6b9d; /* Pink like properties */
3611     -    3089 +    2724 + 69  98  
3612     -    3090 +    2725 + 70  99    /* Blockquote */
3613     -    3091 +    2726 + 71 100    --blockquote-border: #ff6b9d;
3614     -    3092 +    2727 +@@ -77,4 +106,87 @@
3615     -    3093 +    2728 + 77 106  
3616     -    3094 +    2729 + 78 107    /* Border */
3617     -    3095 +    2730 + 79 108    --border-color: rgba(255, 255, 255, 0.1);
3618     -    3096 +    2731 +    109 +
3619     -    3097 +    2732 +    110 +  /* === MERMAID COMPREHENSIVE CONFIGURATION === */
3620     -    3098 +    2733 +    111 +
3621     -    3099 +    2734 +    112 +  /* Core Global */
3622     -    3100 +    2735 +    113 +  --mermaid-background: #1e1e2e;
3623     -    3101 +    2736 +    114 +  --mermaid-text-color: #f5f7ff;
3624     -    3102 +    2737 +    115 +  --mermaid-line-color: #82aaff;
3625     -    3103 +    2738 +    116 +  --mermaid-main-bkg: #383a4f;
3626     -    3104 +    2739 +    117 +
3627     -    3105 +    2740 +    118 +  /* Primary Set */
3628     -    3106 +    2741 +    119 +  --mermaid-primary-color: #383a4f;
3629     -    3107 +    2742 +    120 +  --mermaid-primary-text-color: #f5f7ff;
3630     -    3108 +    2743 +    121 +  --mermaid-primary-border-color: #ff6b9d;
3631     -    3109 +    2744 +    122 +
3632     -    3110 +    2745 +    123 +  /* Secondary Set */
3633     -    3111 +    2746 +    124 +  --mermaid-secondary-color: #2b2d3e;
3634     -    3112 +    2747 +    125 +  --mermaid-secondary-text-color: #f5f7ff;
3635     -    3113 +    2748 +    126 +  --mermaid-secondary-border-color: #82aaff;
3636     -    3114 +    2749 +    127 +
3637     -    3115 +    2750 +    128 +  /* Tertiary Set */
3638     -    3116 +    2751 +    129 +  --mermaid-tertiary-color: #1e1e2e;
3639     -    3117 +    2752 +    130 +  --mermaid-tertiary-text-color: #f5f7ff;
3640     -    3118 +    2753 +    131 +  --mermaid-tertiary-border-color: #4ecdc4;
3641     -    3119 +    2754 +    132 +
3642     -    3120 +    2755 +    133 +  /* Flowchart */
3643     -    3121 +    2756 +    134 +  --mermaid-node-border: #ff6b9d;
3644     -    3122 +    2757 +    135 +  --mermaid-cluster-bkg: #2b2d3e;
3645     -    3123 +    2758 +    136 +  --mermaid-cluster-border: #82aaff;
3646     -    3124 +    2759 +    137 +  --mermaid-default-link-color: #82aaff;
3647     -    3125 +    2760 +    138 +  --mermaid-title-color: #f5f7ff;
3648     -    3126 +    2761 +    139 +  --mermaid-edge-label-background: #1e1e2e;
3649     -    3127 +    2762 +    140 +  --mermaid-node-text-color: #f5f7ff;
3650     -    3128 +    2763 +    141 +
3651     -    3129 +    2764 +    142 +  /* Sequence Diagram */
3652     -    3130 +    2765 +    143 +  --mermaid-actor-bkg: #383a4f;
3653     -    3131 +    2766 +    144 +  --mermaid-actor-border: #ff6b9d;
3654     -    3132 +    2767 +    145 +  --mermaid-actor-text-color: #f5f7ff;
3655     -    3133 +    2768 +    146 +  --mermaid-actor-line-color: #ff6b9d;
3656     -    3134 +    2769 +    147 +  --mermaid-signal-color: #82aaff;
3657     -    3135 +    2770 +    148 +  --mermaid-signal-text-color: #f5f7ff;
3658     -    3136 +    2771 +    149 +  --mermaid-label-box-bkg-color: #383a4f;
3659     -    3137 +    2772 +    150 +  --mermaid-label-box-border-color: #ff6b9d;
3660     -    3138 +    2773 +    151 +  --mermaid-label-text-color: #f5f7ff;
3661     -    3139 +    2774 +    152 +  --mermaid-loop-text-color: #f5f7ff;
3662     -    3140 +    2775 +    153 +  --mermaid-activation-border-color: #82aaff;
3663     -    3141 +    2776 +    154 +  --mermaid-activation-bkg-color: #2b2d3e;
3664     -    3142 +    2777 +    155 +  --mermaid-sequence-number-color: #f5f7ff;
3665     -    3143 +    2778 +    156 +
3666     -    3144 +    2779 +    157 +  /* Pie Chart */
3667     -    3145 +    2780 +    158 +  --mermaid-pie1: #ff6b9d;
3668     -    3146 +    2781 +    159 +  --mermaid-pie2: #ffd93d;
3669     -    3147 +    2782 +    160 +  --mermaid-pie3: #4ecdc4;
3670     -    3148 +    2783 +    161 +  --mermaid-pie4: #c77dff;
3671     -    3149 +    2784 +    162 +  --mermaid-pie5: #ffb86c;
3672     -    3150 +    2785 +    163 +  --mermaid-pie6: #95e1d3;
3673     -    3151 +    2786 +    164 +  --mermaid-pie7: #82aaff;
3674     -    3152 +    2787 +    165 +  --mermaid-pie8: #ff7eb3;
3675     -    3153 +    2788 +    166 +  --mermaid-pie9: #c8f6c2;
3676     -    3154 +    2789 +    167 +  --mermaid-pie10: #89dceb;
3677     -    3155 +    2790 +    168 +  --mermaid-pie11: #ff6b9d;
3678     -    3156 +    2791 +    169 +  --mermaid-pie12: #ffd93d;
3679     -    3157 +    2792 +    170 +  --mermaid-pie-title-text-color: #f5f7ff;
3680     -    3158 +    2793 +    171 +  --mermaid-pie-section-text-color: #1e1e2e; /* Dark on vibrant slices */
3681     -    3159 +    2794 +    172 +  --mermaid-pie-legend-text-color: #f5f7ff;
3682     -    3160 +    2795 +    173 +  --mermaid-pie-stroke-color: #ff6b9d;
3683     -    3161 +    2796 +    174 +  --mermaid-pie-outer-stroke-color: #ff6b9d;
3684     -    3162 +    2797 +    175 +
3685     -    3163 +    2798 +    176 +  /* State Diagram */
3686     -    3164 +    2799 +    177 +  --mermaid-label-color: #f5f7ff;
3687     -    3165 +    2800 +    178 +  --mermaid-alt-background: #2b2d3e;
3688     -    3166 +    2801 +    179 +
3689     -    3167 +    2802 +    180 +  /* Class Diagram */
3690     -    3168 +    2803 +    181 +  --mermaid-class-text: #f5f7ff;
3691     -    3169 +    2804 +    182 +
3692     -    3170 +    2805 +    183 +  /* User Journey */
3693     -    3171 +    2806 +    184 +  --mermaid-fill-type0: #ff6b9d;
3694     -    3172 +    2807 +    185 +  --mermaid-fill-type1: #ffd93d;
3695     -    3173 +    2808 +    186 +  --mermaid-fill-type2: #4ecdc4;
3696     -    3174 +    2809 +    187 +  --mermaid-fill-type3: #c77dff;
3697     -    3175 +    2810 +    188 +  --mermaid-fill-type4: #ffb86c;
3698     -    3176 +    2811 +    189 +  --mermaid-fill-type5: #95e1d3;
3699     -    3177 +    2812 +    190 +  --mermaid-fill-type6: #82aaff;
3700     -    3178 +    2813 +    191 +  --mermaid-fill-type7: #ff7eb3;
3701     -    3179 +    2814 + 80 192  }
3702     -    3180 +    2815 + 81 193  
3703     -    3181 +    2816 +
3704     -    3182 +    2817 +```
3705     -    3183 +    2818 +
3706     -    3184 +    2819 +
3707     -    3185 +    2820 +### üìÑ `themes/obsidian-light.css`
3708     -    3186 +    2821 +
3709     -    3187 +    2822 +**Type:** Stylesheet üé®
3710     -    3188 +    2823 +
3711     -    3189 +    2824 +```diff
3712     -    3190 +    2825 +@@ -52,20 +52,49 @@
3713     -    3191 +    2826 + 52  52    --code-block-bg: #f8f9fc;
3714     -    3192 +    2827 + 53  53    --code-border: rgba(0, 188, 212, 0.2);
3715     -    3193 +    2828 + 54  54  
3716     -    3194 +    2829 + 55     -  /* Syntax Highlighting - Comprehensive Token Colors */
3717     -    3195 +    2830 + 56     -  --syntax-keyword: #9c27b0;
3718     -    3196 +    2831 + 57     -  --syntax-string: #4caf50;
3719     -    3197 +    2832 + 58     -  --syntax-number: #f57c00;
3720     -    3198 +    2833 + 59     -  --syntax-function: #2196f3;
3721     -    3199 +    2834 + 60     -  --syntax-comment: #9e9e9e;
3722     -    3200 +    2835 + 61     -  --syntax-operator: #00bcd4;
3723     -    3201 +    2836 + 62     -  --syntax-punctuation: #616161;
3724     -    3202 +    2837 +     55 +  /* Syntax Highlighting - Production-Grade Token Colors (One Dark Architecture) */
3725     -    3203 +    2838 + 63  56  
3726     -    3204 +    2839 + 64     -  /* Additional Token Types for Full Customization */
3727     -    3205 +    2840 + 65     -  --syntax-variable: #2196f3; /* Variables, parameters - bright blue */
3728     -    3206 +    2841 + 66     -  --syntax-property: #00bcd4; /* Properties - cyan */
3729     -    3207 +    2842 + 67     -  --syntax-namespace: #f57c00; /* Namespaces - orange */
3730     -    3208 +    2843 + 68     -  --syntax-builtin: #9c27b0; /* Built-in functions - purple */
3731     -    3209 +    2844 +     57 +  /* Core hue-1: Cyan - URLs */
3732     -    3210 +    2845 +     58 +  --syntax-url: #00bcd4; /* Cyan for URLs */
3733     -    3211 +    2846 +     59 +
3734     -    3212 +    2847 +     60 +  /* Core hue-2: Blue - Functions, variables */
3735     -    3213 +    2848 +     61 +  --syntax-function: #2196f3; /* Bright blue for functions */
3736     -    3214 +    2849 +     62 +  --syntax-variable: #1976d2; /* Deep blue for variables */
3737     -    3215 +    2850 +     63 +
3738     -    3216 +    2851 +     64 +  /* Core hue-3: Purple - Keywords */
3739     -    3217 +    2852 +     65 +  --syntax-keyword: #9c27b0; /* Vibrant purple for keywords (final, sealed, class) */
3740     -    3218 +    2853 +     66 +
3741     -    3219 +    2854 +     67 +  /* Core hue-4: Green - Strings, builtins */
3742     -    3220 +    2855 +     68 +  --syntax-string: #4caf50; /* Green for strings */
3743     -    3221 +    2856 +     69 +  --syntax-builtin: #388e3c; /* Dark green for builtins (String, List) */
3744     -    3222 +    2857 +     70 +  --syntax-char: #4caf50; /* Same as strings */
3745     -    3223 +    2858 +     71 +  --syntax-regex: #4caf50; /* Same as strings */
3746     -    3224 +    2859 +     72 +  --syntax-inserted: #388e3c; /* For diff */
3747     -    3225 +    2860 +     73 +
3748     -    3226 +    2861 +     74 +  /* Core hue-5: Pink/Orange - Properties, tags */
3749     -    3227 +    2862 +     75 +  --syntax-property: #e91e63; /* Pink for properties */
3750     -    3228 +    2863 +     76 +  --syntax-tag: #ff4081; /* Coral for tags */
3751     -    3229 +    2864 +     77 +  --syntax-deleted: #d32f2f; /* Red for diff */
3752     -    3230 +    2865 +     78 +  --syntax-important: #e91e63; /* Pink for !important */
3753     -    3231 +    2866 +     79 +
3754     -    3232 +    2867 +     80 +  /* Core hue-6: Orange/Yellow - Class names, constants, numbers */
3755     -    3233 +    2868 +     81 +  --syntax-class-name: #ff9800; /* Orange for class names (Rectangle, Shape) */
3756     -    3234 +    2869 +     82 +  --syntax-number: #f57c00; /* Dark orange for numbers */
3757     -    3235 +    2870 +     83 +  --syntax-constant: #ff9800; /* Orange for constants */
3758     -    3236 +    2871 +     84 +  --syntax-boolean: #f57c00; /* Same as numbers */
3759     -    3237 +    2872 +     85 +  --syntax-atrule: #9c27b0; /* Purple for CSS @ rules */
3760     -    3238 +    2873 +     86 +
3761     -    3239 +    2874 +     87 +  /* Neutral colors */
3762     -    3240 +    2875 +     88 +  --syntax-comment: #9e9e9e; /* Gray for comments */
3763     -    3241 +    2876 +     89 +  --syntax-punctuation: #616161; /* Dark gray for punctuation */
3764     -    3242 +    2877 +     90 +  --syntax-operator: #00bcd4; /* Cyan for operators */
3765     -    3243 +    2878 +     91 +
3766     -    3244 +    2879 +     92 +  /* Markup specific */
3767     -    3245 +    2880 +     93 +  --syntax-attr-name: #ff9800; /* Orange like class-name */
3768     -    3246 +    2881 +     94 +  --syntax-attr-value: #4caf50; /* Green like strings */
3769     -    3247 +    2882 +     95 +  --syntax-namespace: #9c27b0; /* Purple like keywords */
3770     -    3248 +    2883 +     96 +  --syntax-entity: #616161; /* Neutral */
3771     -    3249 +    2884 +     97 +  --syntax-selector: #e91e63; /* Pink like properties */
3772     -    3250 +    2885 + 69  98  
3773     -    3251 +    2886 + 70  99    /* Blockquote */
3774     -    3252 +    2887 + 71 100    --blockquote-border: #e91e63;
3775     -    3253 +    2888 +@@ -77,4 +106,87 @@
3776     -    3254 +    2889 + 77 106  
3777     -    3255 +    2890 + 78 107    /* Border */
3778     -    3256 +    2891 + 79 108    --border-color: rgba(0, 0, 0, 0.12);
3779     -    3257 +    2892 +    109 +
3780     -    3258 +    2893 +    110 +  /* === MERMAID COMPREHENSIVE CONFIGURATION === */
3781     -    3259 +    2894 +    111 +
3782     -    3260 +    2895 +    112 +  /* Core Global */
3783     -    3261 +    2896 +    113 +  --mermaid-background: #ffffff;
3784     -    3262 +    2897 +    114 +  --mermaid-text-color: #1a1a1a;
3785     -    3263 +    2898 +    115 +  --mermaid-line-color: #9c27b0;
3786     -    3264 +    2899 +    116 +  --mermaid-main-bkg: #e8ecf1;
3787     -    3265 +    2900 +    117 +
3788     -    3266 +    2901 +    118 +  /* Primary Set */
3789     -    3267 +    2902 +    119 +  --mermaid-primary-color: #e8ecf1;
3790     -    3268 +    2903 +    120 +  --mermaid-primary-text-color: #1a1a1a;
3791     -    3269 +    2904 +    121 +  --mermaid-primary-border-color: #e91e63;
3792     -    3270 +    2905 +    122 +
3793     -    3271 +    2906 +    123 +  /* Secondary Set */
3794     -    3272 +    2907 +    124 +  --mermaid-secondary-color: #f5f7fa;
3795     -    3273 +    2908 +    125 +  --mermaid-secondary-text-color: #1a1a1a;
3796     -    3274 +    2909 +    126 +  --mermaid-secondary-border-color: #9c27b0;
3797     -    3275 +    2910 +    127 +
3798     -    3276 +    2911 +    128 +  /* Tertiary Set */
3799     -    3277 +    2912 +    129 +  --mermaid-tertiary-color: #ffffff;
3800     -    3278 +    2913 +    130 +  --mermaid-tertiary-text-color: #1a1a1a;
3801     -    3279 +    2914 +    131 +  --mermaid-tertiary-border-color: #00bcd4;
3802     -    3280 +    2915 +    132 +
3803     -    3281 +    2916 +    133 +  /* Flowchart */
3804     -    3282 +    2917 +    134 +  --mermaid-node-border: #e91e63;
3805     -    3283 +    2918 +    135 +  --mermaid-cluster-bkg: #f5f7fa;
3806     -    3284 +    2919 +    136 +  --mermaid-cluster-border: #9c27b0;
3807     -    3285 +    2920 +    137 +  --mermaid-default-link-color: #9c27b0;
3808     -    3286 +    2921 +    138 +  --mermaid-title-color: #1a1a1a;
3809     -    3287 +    2922 +    139 +  --mermaid-edge-label-background: #ffffff;
3810     -    3288 +    2923 +    140 +  --mermaid-node-text-color: #1a1a1a;
3811     -    3289 +    2924 +    141 +
3812     -    3290 +    2925 +    142 +  /* Sequence Diagram */
3813     -    3291 +    2926 +    143 +  --mermaid-actor-bkg: #e8ecf1;
3814     -    3292 +    2927 +    144 +  --mermaid-actor-border: #e91e63;
3815     -    3293 +    2928 +    145 +  --mermaid-actor-text-color: #1a1a1a;
3816     -    3294 +    2929 +    146 +  --mermaid-actor-line-color: #e91e63;
3817     -    3295 +    2930 +    147 +  --mermaid-signal-color: #9c27b0;
3818     -    3296 +    2931 +    148 +  --mermaid-signal-text-color: #1a1a1a;
3819     -    3297 +    2932 +    149 +  --mermaid-label-box-bkg-color: #e8ecf1;
3820     -    3298 +    2933 +    150 +  --mermaid-label-box-border-color: #e91e63;
3821     -    3299 +    2934 +    151 +  --mermaid-label-text-color: #1a1a1a;
3822     -    3300 +    2935 +    152 +  --mermaid-loop-text-color: #1a1a1a;
3823     -    3301 +    2936 +    153 +  --mermaid-activation-border-color: #9c27b0;
3824     -    3302 +    2937 +    154 +  --mermaid-activation-bkg-color: #f5f7fa;
3825     -    3303 +    2938 +    155 +  --mermaid-sequence-number-color: #1a1a1a;
3826     -    3304 +    2939 +    156 +
3827     -    3305 +    2940 +    157 +  /* Pie Chart */
3828     -    3306 +    2941 +    158 +  --mermaid-pie1: #e91e63;
3829     -    3307 +    2942 +    159 +  --mermaid-pie2: #9c27b0;
3830     -    3308 +    2943 +    160 +  --mermaid-pie3: #2196f3;
3831     -    3309 +    2944 +    161 +  --mermaid-pie4: #00bcd4;
3832     -    3310 +    2945 +    162 +  --mermaid-pie5: #4caf50;
3833     -    3311 +    2946 +    163 +  --mermaid-pie6: #ff9800;
3834     -    3312 +    2947 +    164 +  --mermaid-pie7: #f57c00;
3835     -    3313 +    2948 +    165 +  --mermaid-pie8: #ff4081;
3836     -    3314 +    2949 +    166 +  --mermaid-pie9: #1976d2;
3837     -    3315 +    2950 +    167 +  --mermaid-pie10: #388e3c;
3838     -    3316 +    2951 +    168 +  --mermaid-pie11: #e91e63;
3839     -    3317 +    2952 +    169 +  --mermaid-pie12: #9c27b0;
3840     -    3318 +    2953 +    170 +  --mermaid-pie-title-text-color: #1a1a1a;
3841     -    3319 +    2954 +    171 +  --mermaid-pie-section-text-color: #ffffff; /* White on vibrant slices */
3842     -    3320 +    2955 +    172 +  --mermaid-pie-legend-text-color: #1a1a1a;
3843     -    3321 +    2956 +    173 +  --mermaid-pie-stroke-color: #e91e63;
3844     -    3322 +    2957 +    174 +  --mermaid-pie-outer-stroke-color: #e91e63;
3845     -    3323 +    2958 +    175 +
3846     -    3324 +    2959 +    176 +  /* State Diagram */
3847     -    3325 +    2960 +    177 +  --mermaid-label-color: #1a1a1a;
3848     -    3326 +    2961 +    178 +  --mermaid-alt-background: #f5f7fa;
3849     -    3327 +    2962 +    179 +
3850     -    3328 +    2963 +    180 +  /* Class Diagram */
3851     -    3329 +    2964 +    181 +  --mermaid-class-text: #1a1a1a;
3852     -    3330 +    2965 +    182 +
3853     -    3331 +    2966 +    183 +  /* User Journey */
3854     -    3332 +    2967 +    184 +  --mermaid-fill-type0: #e91e63;
3855     -    3333 +    2968 +    185 +  --mermaid-fill-type1: #9c27b0;
3856     -    3334 +    2969 +    186 +  --mermaid-fill-type2: #2196f3;
3857     -    3335 +    2970 +    187 +  --mermaid-fill-type3: #00bcd4;
3858     -    3336 +    2971 +    188 +  --mermaid-fill-type4: #4caf50;
3859     -    3337 +    2972 +    189 +  --mermaid-fill-type5: #ff9800;
3860     -    3338 +    2973 +    190 +  --mermaid-fill-type6: #f57c00;
3861     -    3339 +    2974 +    191 +  --mermaid-fill-type7: #ff4081;
3862     -    3340 +    2975 + 80 192  }
3863     -    3341 +    2976 + 81 193  
3864     -    3342 +    2977 +
3865     -    3343 +    2978 +```
3866     -    3344 +    2979 +
3867     -    3345 +    2980 +
3868     -    3346 +    2981 +### üìÑ `themes/ocean-dark.css`
3869     -    3347 +    2982 +
3870     -    3348 +    2983 +**Type:** Stylesheet üé®
3871     -    3349 +    2984 +
3872     -    3350 +    2985 +```diff
3873     -    3351 +    2986 +@@ -23,20 +23,49 @@
3874     -    3352 +    2987 + 23  23    --code-block-bg: #0a192f;
3875     -    3353 +    2988 + 24  24    --code-border: #233554;
3876     -    3354 +    2989 + 25  25  
3877     -    3355 +    2990 + 26     -  /* Syntax Highlighting - Comprehensive Token Colors */
3878     -    3356 +    2991 + 27     -  --syntax-keyword: #64ffda;
3879     -    3357 +    2992 + 28     -  --syntax-string: #5eead4;
3880     -    3358 +    2993 + 29     -  --syntax-number: #38bdf8;
3881     -    3359 +    2994 + 30     -  --syntax-function: #22d3ee;
3882     -    3360 +    2995 + 31     -  --syntax-comment: #8892b0;
3883     -    3361 +    2996 + 32     -  --syntax-operator: #06b6d4;
3884     -    3362 +    2997 + 33     -  --syntax-punctuation: #8892b0;
3885     -    3363 +    2998 +     26 +  /* Syntax Highlighting - Production-Grade Token Colors (One Dark Architecture) */
3886     -    3364 +    2999 + 34  27  
3887     -    3365 +    3000 + 35     -  /* Additional Token Types */
3888     -    3366 +    3001 + 36     -  --syntax-variable: #38bdf8; /* Variables - cyan (distinct from text #ccd6f6) */
3889     -    3367 +    3002 + 37     -  --syntax-property: #22d3ee; /* Properties - teal */
3890     -    3368 +    3003 + 38     -  --syntax-namespace: #64ffda; /* Namespaces - mint */
3891     -    3369 +    3004 + 39     -  --syntax-builtin: #5eead4; /* Builtins - teal */
3892     -    3370 +    3005 +     28 +  /* Core hue-1: Bright Cyan - URLs */
3893     -    3371 +    3006 +     29 +  --syntax-url: #67e8f9; /* Electric cyan for URLs */
3894     -    3372 +    3007 +     30 +
3895     -    3373 +    3008 +     31 +  /* Core hue-2: Blue - Functions, variables */
3896     -    3374 +    3009 +     32 +  --syntax-function: #38bdf8; /* Sky blue for functions */
3897     -    3375 +    3010 +     33 +  --syntax-variable: #0ea5e9; /* Deep sky for variables */
3898     -    3376 +    3011 +     34 +
3899     -    3377 +    3012 +     35 +  /* Core hue-3: Violet/Purple - Keywords */
3900     -    3378 +    3013 +     36 +  --syntax-keyword: #c084fc; /* Bright violet for keywords (final, sealed, class) */
3901     -    3379 +    3014 +     37 +
3902     -    3380 +    3015 +     38 +  /* Core hue-4: Green/Teal - Strings, builtins */
3903     -    3381 +    3016 +     39 +  --syntax-string: #5eead4; /* Teal for strings */
3904     -    3382 +    3017 +     40 +  --syntax-builtin: #2dd4bf; /* Vibrant teal for builtins (String, List) */
3905     -    3383 +    3018 +     41 +  --syntax-char: #5eead4; /* Same as strings */
3906     -    3384 +    3019 +     42 +  --syntax-regex: #5eead4; /* Same as strings */
3907     -    3385 +    3020 +     43 +  --syntax-inserted: #2dd4bf; /* For diff */
3908     -    3386 +    3021 +     44 +
3909     -    3387 +    3022 +     45 +  /* Core hue-5: Pink/Rose - Properties, tags */
3910     -    3388 +    3023 +     46 +  --syntax-property: #f472b6; /* Pink for properties */
3911     -    3389 +    3024 +     47 +  --syntax-tag: #fb7185; /* Rose for tags */
3912     -    3390 +    3025 +     48 +  --syntax-deleted: #f87171; /* Coral for diff */
3913     -    3391 +    3026 +     49 +  --syntax-important: #f472b6; /* Pink for !important */
3914     -    3392 +    3027 +     50 +
3915     -    3393 +    3028 +     51 +  /* Core hue-6: Mint/Cyan - Class names, constants, numbers */
3916     -    3394 +    3029 +     52 +  --syntax-class-name: #64ffda; /* Mint green for class names (Rectangle, Shape) */
3917     -    3395 +    3030 +     53 +  --syntax-number: #22d3ee; /* Bright cyan for numbers */
3918     -    3396 +    3031 +     54 +  --syntax-constant: #06b6d4; /* Cyan for constants */
3919     -    3397 +    3032 +     55 +  --syntax-boolean: #22d3ee; /* Same as numbers */
3920     -    3398 +    3033 +     56 +  --syntax-atrule: #64ffda; /* Mint for CSS @ rules */
3921     -    3399 +    3034 +     57 +
3922     -    3400 +    3035 +     58 +  /* Neutral colors */
3923     -    3401 +    3036 +     59 +  --syntax-comment: #8892b0; /* Muted blue-gray for comments */
3924     -    3402 +    3037 +     60 +  --syntax-punctuation: #a0aec0; /* Light gray for punctuation */
3925     -    3403 +    3038 +     61 +  --syntax-operator: #0891b2; /* Teal for operators */
3926     -    3404 +    3039 +     62 +
3927     -    3405 +    3040 +     63 +  /* Markup specific */
3928     -    3406 +    3041 +     64 +  --syntax-attr-name: #64ffda; /* Mint like class-name */
3929     -    3407 +    3042 +     65 +  --syntax-attr-value: #5eead4; /* Teal like strings */
3930     -    3408 +    3043 +     66 +  --syntax-namespace: #c084fc; /* Violet like keywords */
3931     -    3409 +    3044 +     67 +  --syntax-entity: #a0aec0; /* Neutral */
3932     -    3410 +    3045 +     68 +  --syntax-selector: #f472b6; /* Pink like properties */
3933     -    3411 +    3046 + 40  69  
3934     -    3412 +    3047 + 41  70    --blockquote-border: #64ffda;
3935     -    3413 +    3048 + 42  71    --blockquote-bg: #112240;
3936     -    3414 +    3049 +@@ -44,4 +73,87 @@
3937     -    3415 +    3050 + 44  73    --italic-color: #5eead4;
3938     -    3416 +    3051 + 45  74    --table-header-bg: #1d3461;
3939     -    3417 +    3052 + 46  75    --table-border: #233554;
3940     -    3418 +    3053 +     76 +
3941     -    3419 +    3054 +     77 +  /* === MERMAID COMPREHENSIVE CONFIGURATION === */
3942     -    3420 +    3055 +     78 +
3943     -    3421 +    3056 +     79 +  /* Core Global */
3944     -    3422 +    3057 +     80 +  --mermaid-background: #0a192f;
3945     -    3423 +    3058 +     81 +  --mermaid-text-color: #ccd6f6;
3946     -    3424 +    3059 +     82 +  --mermaid-line-color: #5eead4;
3947     -    3425 +    3060 +     83 +  --mermaid-main-bkg: #1d3461;
3948     -    3426 +    3061 +     84 +
3949     -    3427 +    3062 +     85 +  /* Primary Set */
3950     -    3428 +    3063 +     86 +  --mermaid-primary-color: #1d3461;
3951     -    3429 +    3064 +     87 +  --mermaid-primary-text-color: #ccd6f6;
3952     -    3430 +    3065 +     88 +  --mermaid-primary-border-color: #64ffda;
3953     -    3431 +    3066 +     89 +
3954     -    3432 +    3067 +     90 +  /* Secondary Set */
3955     -    3433 +    3068 +     91 +  --mermaid-secondary-color: #112240;
3956     -    3434 +    3069 +     92 +  --mermaid-secondary-text-color: #ccd6f6;
3957     -    3435 +    3070 +     93 +  --mermaid-secondary-border-color: #5eead4;
3958     -    3436 +    3071 +     94 +
3959     -    3437 +    3072 +     95 +  /* Tertiary Set */
3960     -    3438 +    3073 +     96 +  --mermaid-tertiary-color: #0a192f;
3961     -    3439 +    3074 +     97 +  --mermaid-tertiary-text-color: #ccd6f6;
3962     -    3440 +    3075 +     98 +  --mermaid-tertiary-border-color: #38bdf8;
3963     -    3441 +    3076 +     99 +
3964     -    3442 +    3077 +    100 +  /* Flowchart */
3965     -    3443 +    3078 +    101 +  --mermaid-node-border: #64ffda;
3966     -    3444 +    3079 +    102 +  --mermaid-cluster-bkg: #112240;
3967     -    3445 +    3080 +    103 +  --mermaid-cluster-border: #5eead4;
3968     -    3446 +    3081 +    104 +  --mermaid-default-link-color: #5eead4;
3969     -    3447 +    3082 +    105 +  --mermaid-title-color: #ccd6f6;
3970     -    3448 +    3083 +    106 +  --mermaid-edge-label-background: #0a192f;
3971     -    3449 +    3084 +    107 +  --mermaid-node-text-color: #ccd6f6;
3972     -    3450 +    3085 +    108 +
3973     -    3451 +    3086 +    109 +  /* Sequence Diagram */
3974     -    3452 +    3087 +    110 +  --mermaid-actor-bkg: #1d3461;
3975     -    3453 +    3088 +    111 +  --mermaid-actor-border: #64ffda;
3976     -    3454 +    3089 +    112 +  --mermaid-actor-text-color: #ccd6f6;
3977     -    3455 +    3090 +    113 +  --mermaid-actor-line-color: #64ffda;
3978     -    3456 +    3091 +    114 +  --mermaid-signal-color: #5eead4;
3979     -    3457 +    3092 +    115 +  --mermaid-signal-text-color: #ccd6f6;
3980     -    3458 +    3093 +    116 +  --mermaid-label-box-bkg-color: #1d3461;
3981     -    3459 +    3094 +    117 +  --mermaid-label-box-border-color: #64ffda;
3982     -    3460 +    3095 +    118 +  --mermaid-label-text-color: #ccd6f6;
3983     -    3461 +    3096 +    119 +  --mermaid-loop-text-color: #ccd6f6;
3984     -    3462 +    3097 +    120 +  --mermaid-activation-border-color: #5eead4;
3985     -    3463 +    3098 +    121 +  --mermaid-activation-bkg-color: #112240;
3986     -    3464 +    3099 +    122 +  --mermaid-sequence-number-color: #ccd6f6;
3987     -    3465 +    3100 +    123 +
3988     -    3466 +    3101 +    124 +  /* Pie Chart */
3989     -    3467 +    3102 +    125 +  --mermaid-pie1: #64ffda;
3990     -    3468 +    3103 +    126 +  --mermaid-pie2: #5eead4;
3991     -    3469 +    3104 +    127 +  --mermaid-pie3: #38bdf8;
3992     -    3470 +    3105 +    128 +  --mermaid-pie4: #22d3ee;
3993     -    3471 +    3106 +    129 +  --mermaid-pie5: #06b6d4;
3994     -    3472 +    3107 +    130 +  --mermaid-pie6: #0891b2;
3995     -    3473 +    3108 +    131 +  --mermaid-pie7: #c084fc;
3996     -    3474 +    3109 +    132 +  --mermaid-pie8: #f472b6;
3997     -    3475 +    3110 +    133 +  --mermaid-pie9: #0ea5e9;
3998     -    3476 +    3111 +    134 +  --mermaid-pie10: #64ffda;
3999     -    3477 +    3112 +    135 +  --mermaid-pie11: #5eead4;
4000     -    3478 +    3113 +    136 +  --mermaid-pie12: #38bdf8;
4001     -    3479 +    3114 +    137 +  --mermaid-pie-title-text-color: #ccd6f6;
4002     -    3480 +    3115 +    138 +  --mermaid-pie-section-text-color: #0a192f; /* Dark on vibrant slices */
4003     -    3481 +    3116 +    139 +  --mermaid-pie-legend-text-color: #ccd6f6;
4004     -    3482 +    3117 +    140 +  --mermaid-pie-stroke-color: #64ffda;
4005     -    3483 +    3118 +    141 +  --mermaid-pie-outer-stroke-color: #64ffda;
4006     -    3484 +    3119 +    142 +
4007     -    3485 +    3120 +    143 +  /* State Diagram */
4008     -    3486 +    3121 +    144 +  --mermaid-label-color: #ccd6f6;
4009     -    3487 +    3122 +    145 +  --mermaid-alt-background: #112240;
4010     -    3488 +    3123 +    146 +
4011     -    3489 +    3124 +    147 +  /* Class Diagram */
4012     -    3490 +    3125 +    148 +  --mermaid-class-text: #ccd6f6;
4013     -    3491 +    3126 +    149 +
4014     -    3492 +    3127 +    150 +  /* User Journey */
4015     -    3493 +    3128 +    151 +  --mermaid-fill-type0: #64ffda;
4016     -    3494 +    3129 +    152 +  --mermaid-fill-type1: #5eead4;
4017     -    3495 +    3130 +    153 +  --mermaid-fill-type2: #38bdf8;
4018     -    3496 +    3131 +    154 +  --mermaid-fill-type3: #22d3ee;
4019     -    3497 +    3132 +    155 +  --mermaid-fill-type4: #06b6d4;
4020     -    3498 +    3133 +    156 +  --mermaid-fill-type5: #0891b2;
4021     -    3499 +    3134 +    157 +  --mermaid-fill-type6: #c084fc;
4022     -    3500 +    3135 +    158 +  --mermaid-fill-type7: #f472b6;
4023     -    3501 +    3136 + 47 159  }
4024     -    3502 +    3137 + 48 160  
4025     -    3503 +    3138 +
4026     -    3504 +    3139 +```
4027     -    3505 +    3140 +
4028     -    3506 +    3141 +
4029     -    3507 +    3142 +### üìÑ `themes/ocean-light.css`
4030     -    3508 +    3143 +
4031     -    3509 +    3144 +**Type:** Stylesheet üé®
4032     -    3510 +    3145 +
4033     -    3511 +    3146 +```diff
4034     -    3512 +    3147 +@@ -23,20 +23,49 @@
4035     -    3513 +    3148 + 23  23    --code-block-bg: #e0f2fe; /* Light cyan background */
4036     -    3514 +    3149 + 24  24    --code-border: #7dd3fc;
4037     -    3515 +    3150 + 25  25  
4038     -    3516 +    3151 + 26     -  /* Syntax Highlighting - Comprehensive Token Colors */
4039     -    3517 +    3152 + 27     -  --syntax-keyword: #0284c7;
4040     -    3518 +    3153 + 28     -  --syntax-string: #0891b2;
4041     -    3519 +    3154 + 29     -  --syntax-number: #06b6d4;
4042     -    3520 +    3155 + 30     -  --syntax-function: #22d3ee;
4043     -    3521 +    3156 + 31     -  --syntax-comment: #64748b;
4044     -    3522 +    3157 + 32     -  --syntax-operator: #0369a1;
4045     -    3523 +    3158 + 33     -  --syntax-punctuation: #475569;
4046     -    3524 +    3159 +     26 +  /* Syntax Highlighting - Production-Grade Token Colors (One Dark Architecture) */
4047     -    3525 +    3160 + 34  27  
4048     -    3526 +    3161 + 35     -  /* Additional Token Types for Full Customization */
4049     -    3527 +    3162 + 36     -  --syntax-variable: #0369a1; /* Variables - ocean blue */
4050     -    3528 +    3163 + 37     -  --syntax-property: #0891b2; /* Properties - teal */
4051     -    3529 +    3164 + 38     -  --syntax-namespace: #0284c7; /* Namespaces - cyan */
4052     -    3530 +    3165 + 39     -  --syntax-builtin: #22d3ee; /* Builtins - bright cyan */
4053     -    3531 +    3166 +     28 +  /* Core hue-1: Cyan - URLs */
4054     -    3532 +    3167 +     29 +  --syntax-url: #06b6d4; /* Bright cyan for URLs */
4055     -    3533 +    3168 +     30 +
4056     -    3534 +    3169 +     31 +  /* Core hue-2: Blue - Functions, variables */
4057     -    3535 +    3170 +     32 +  --syntax-function: #0284c7; /* Ocean blue for functions */
4058     -    3536 +    3171 +     33 +  --syntax-variable: #0369a1; /* Deep blue for variables */
4059     -    3537 +    3172 +     34 +
4060     -    3538 +    3173 +     35 +  /* Core hue-3: Purple/Violet - Keywords */
4061     -    3539 +    3174 +     36 +  --syntax-keyword: #7c3aed; /* Vivid purple for keywords (final, sealed, class) */
4062     -    3540 +    3175 +     37 +
4063     -    3541 +    3176 +     38 +  /* Core hue-4: Green/Teal - Strings, builtins */
4064     -    3542 +    3177 +     39 +  --syntax-string: #0891b2; /* Teal for strings */
4065     -    3543 +    3178 +     40 +  --syntax-builtin: #14b8a6; /* Bright teal for builtins (String, List) */
4066     -    3544 +    3179 +     41 +  --syntax-char: #0891b2; /* Same as strings */
4067     -    3545 +    3180 +     42 +  --syntax-regex: #0891b2; /* Same as strings */
4068     -    3546 +    3181 +     43 +  --syntax-inserted: #14b8a6; /* For diff */
4069     -    3547 +    3182 +     44 +
4070     -    3548 +    3183 +     45 +  /* Core hue-5: Orange/Amber - Properties, tags */
4071     -    3549 +    3184 +     46 +  --syntax-property: #f59e0b; /* Amber for properties */
4072     -    3550 +    3185 +     47 +  --syntax-tag: #ea580c; /* Orange for tags */
4073     -    3551 +    3186 +     48 +  --syntax-deleted: #ef4444; /* Red for diff */
4074     -    3552 +    3187 +     49 +  --syntax-important: #f59e0b; /* Amber for !important */
4075     -    3553 +    3188 +     50 +
4076     -    3554 +    3189 +     51 +  /* Core hue-6: Cyan - Class names, constants, numbers */
4077     -    3555 +    3190 +     52 +  --syntax-class-name: #22d3ee; /* Bright cyan for class names (Rectangle, Shape) */
4078     -    3556 +    3191 +     53 +  --syntax-number: #06b6d4; /* Cyan for numbers */
4079     -    3557 +    3192 +     54 +  --syntax-constant: #0891b2; /* Teal for constants */
4080     -    3558 +    3193 +     55 +  --syntax-boolean: #06b6d4; /* Same as numbers */
4081     -    3559 +    3194 +     56 +  --syntax-atrule: #22d3ee; /* Bright cyan for CSS @ rules */
4082     -    3560 +    3195 +     57 +
4083     -    3561 +    3196 +     58 +  /* Neutral colors */
4084     -    3562 +    3197 +     59 +  --syntax-comment: #64748b; /* Slate gray for comments */
4085     -    3563 +    3198 +     60 +  --syntax-punctuation: #475569; /* Dark slate for punctuation */
4086     -    3564 +    3199 +     61 +  --syntax-operator: #0369a1; /* Deep ocean for operators */
4087     -    3565 +    3200 +     62 +
4088     -    3566 +    3201 +     63 +  /* Markup specific */
4089     -    3567 +    3202 +     64 +  --syntax-attr-name: #22d3ee; /* Cyan like class-name */
4090     -    3568 +    3203 +     65 +  --syntax-attr-value: #0891b2; /* Teal like strings */
4091     -    3569 +    3204 +     66 +  --syntax-namespace: #7c3aed; /* Purple like keywords */
4092     -    3570 +    3205 +     67 +  --syntax-entity: #475569; /* Neutral */
4093     -    3571 +    3206 +     68 +  --syntax-selector: #f59e0b; /* Amber like properties */
4094     -    3572 +    3207 + 40  69  
4095     -    3573 +    3208 + 41  70    --blockquote-border: #0891b2;
4096     -    3574 +    3209 + 42  71    --blockquote-bg: #e0f2fe;
4097     -    3575 +    3210 +@@ -44,4 +73,87 @@
4098     -    3576 +    3211 + 44  73    --italic-color: #0891b2;
4099     -    3577 +    3212 + 45  74    --table-header-bg: #bae6fd;
4100     -    3578 +    3213 + 46  75    --table-border: #7dd3fc;
4101     -    3579 +    3214 +     76 +
4102     -    3580 +    3215 +     77 +  /* === MERMAID COMPREHENSIVE CONFIGURATION === */
4103     -    3581 +    3216 +     78 +
4104     -    3582 +    3217 +     79 +  /* Core Global */
4105     -    3583 +    3218 +     80 +  --mermaid-background: #f0f9ff;
4106     -    3584 +    3219 +     81 +  --mermaid-text-color: #0c4a6e;
4107     -    3585 +    3220 +     82 +  --mermaid-line-color: #0891b2;
4108     -    3586 +    3221 +     83 +  --mermaid-main-bkg: #bae6fd;
4109     -    3587 +    3222 +     84 +
4110     -    3588 +    3223 +     85 +  /* Primary Set */
4111     -    3589 +    3224 +     86 +  --mermaid-primary-color: #bae6fd;
4112     -    3590 +    3225 +     87 +  --mermaid-primary-text-color: #0c4a6e;
4113     -    3591 +    3226 +     88 +  --mermaid-primary-border-color: #0284c7;
4114     -    3592 +    3227 +     89 +
4115     -    3593 +    3228 +     90 +  /* Secondary Set */
4116     -    3594 +    3229 +     91 +  --mermaid-secondary-color: #e0f2fe;
4117     -    3595 +    3230 +     92 +  --mermaid-secondary-text-color: #0c4a6e;
4118     -    3596 +    3231 +     93 +  --mermaid-secondary-border-color: #0891b2;
4119     -    3597 +    3232 +     94 +
4120     -    3598 +    3233 +     95 +  /* Tertiary Set */
4121     -    3599 +    3234 +     96 +  --mermaid-tertiary-color: #f0f9ff;
4122     -    3600 +    3235 +     97 +  --mermaid-tertiary-text-color: #0c4a6e;
4123     -    3601 +    3236 +     98 +  --mermaid-tertiary-border-color: #06b6d4;
4124     -    3602 +    3237 +     99 +
4125     -    3603 +    3238 +    100 +  /* Flowchart */
4126     -    3604 +    3239 +    101 +  --mermaid-node-border: #0284c7;
4127     -    3605 +    3240 +    102 +  --mermaid-cluster-bkg: #e0f2fe;
4128     -    3606 +    3241 +    103 +  --mermaid-cluster-border: #0891b2;
4129     -    3607 +    3242 +    104 +  --mermaid-default-link-color: #0891b2;
4130     -    3608 +    3243 +    105 +  --mermaid-title-color: #0c4a6e;
4131     -    3609 +    3244 +    106 +  --mermaid-edge-label-background: #f0f9ff;
4132     -    3610 +    3245 +    107 +  --mermaid-node-text-color: #0c4a6e;
4133     -    3611 +    3246 +    108 +
4134     -    3612 +    3247 +    109 +  /* Sequence Diagram */
4135     -    3613 +    3248 +    110 +  --mermaid-actor-bkg: #bae6fd;
4136     -    3614 +    3249 +    111 +  --mermaid-actor-border: #0284c7;
4137     -    3615 +    3250 +    112 +  --mermaid-actor-text-color: #0c4a6e;
4138     -    3616 +    3251 +    113 +  --mermaid-actor-line-color: #0284c7;
4139     -    3617 +    3252 +    114 +  --mermaid-signal-color: #0891b2;
4140     -    3618 +    3253 +    115 +  --mermaid-signal-text-color: #0c4a6e;
4141     -    3619 +    3254 +    116 +  --mermaid-label-box-bkg-color: #bae6fd;
4142     -    3620 +    3255 +    117 +  --mermaid-label-box-border-color: #0284c7;
4143     -    3621 +    3256 +    118 +  --mermaid-label-text-color: #0c4a6e;
4144     -    3622 +    3257 +    119 +  --mermaid-loop-text-color: #0c4a6e;
4145     -    3623 +    3258 +    120 +  --mermaid-activation-border-color: #0891b2;
4146     -    3624 +    3259 +    121 +  --mermaid-activation-bkg-color: #e0f2fe;
4147     -    3625 +    3260 +    122 +  --mermaid-sequence-number-color: #0c4a6e;
4148     -    3626 +    3261 +    123 +
4149     -    3627 +    3262 +    124 +  /* Pie Chart */
4150     -    3628 +    3263 +    125 +  --mermaid-pie1: #0284c7;
4151     -    3629 +    3264 +    126 +  --mermaid-pie2: #0891b2;
4152     -    3630 +    3265 +    127 +  --mermaid-pie3: #06b6d4;
4153     -    3631 +    3266 +    128 +  --mermaid-pie4: #22d3ee;
4154     -    3632 +    3267 +    129 +  --mermaid-pie5: #7c3aed;
4155     -    3633 +    3268 +    130 +  --mermaid-pie6: #f59e0b;
4156     -    3634 +    3269 +    131 +  --mermaid-pie7: #14b8a6;
4157     -    3635 +    3270 +    132 +  --mermaid-pie8: #0369a1;
4158     -    3636 +    3271 +    133 +  --mermaid-pie9: #0284c7;
4159     -    3637 +    3272 +    134 +  --mermaid-pie10: #0891b2;
4160     -    3638 +    3273 +    135 +  --mermaid-pie11: #06b6d4;
4161     -    3639 +    3274 +    136 +  --mermaid-pie12: #22d3ee;
4162     -    3640 +    3275 +    137 +  --mermaid-pie-title-text-color: #0c4a6e;
4163     -    3641 +    3276 +    138 +  --mermaid-pie-section-text-color: #f0f9ff; /* Light on vibrant slices */
4164     -    3642 +    3277 +    139 +  --mermaid-pie-legend-text-color: #0c4a6e;
4165     -    3643 +    3278 +    140 +  --mermaid-pie-stroke-color: #0284c7;
4166     -    3644 +    3279 +    141 +  --mermaid-pie-outer-stroke-color: #0284c7;
4167     -    3645 +    3280 +    142 +
4168     -    3646 +    3281 +    143 +  /* State Diagram */
4169     -    3647 +    3282 +    144 +  --mermaid-label-color: #0c4a6e;
4170     -    3648 +    3283 +    145 +  --mermaid-alt-background: #e0f2fe;
4171     -    3649 +    3284 +    146 +
4172     -    3650 +    3285 +    147 +  /* Class Diagram */
4173     -    3651 +    3286 +    148 +  --mermaid-class-text: #0c4a6e;
4174     -    3652 +    3287 +    149 +
4175     -    3653 +    3288 +    150 +  /* User Journey */
4176     -    3654 +    3289 +    151 +  --mermaid-fill-type0: #0284c7;
4177     -    3655 +    3290 +    152 +  --mermaid-fill-type1: #0891b2;
4178     -    3656 +    3291 +    153 +  --mermaid-fill-type2: #06b6d4;
4179     -    3657 +    3292 +    154 +  --mermaid-fill-type3: #22d3ee;
4180     -    3658 +    3293 +    155 +  --mermaid-fill-type4: #7c3aed;
4181     -    3659 +    3294 +    156 +  --mermaid-fill-type5: #f59e0b;
4182     -    3660 +    3295 +    157 +  --mermaid-fill-type6: #14b8a6;
4183     -    3661 +    3296 +    158 +  --mermaid-fill-type7: #0369a1;
4184     -    3662 +    3297 + 47 159  }
4185     -    3663 +    3298 + 48 160  
4186     -    3664 +363 3299  
4187     -    3665 +364 3300  ```
4188     -    3666 +365 3301  
4189     -    3667 +@@ -369,13 +3305,319 @@ memory-bank/activeContext.md |  52 +++++++++-
4190     -    3668 +369 3305  **Type:** Stylesheet üé®
4191     -    3669 +370 3306  
4192     -    3670 +371 3307  ```diff
4193     -    3671 +372     -@@ -1,4 +1,4 @@
4194     -    3672 +373     -  1     -r/* Sunset Dark Theme */
4195     -    3673 +374     -      1 +/* Sunset Dark Theme */
4196     -    3674 +375     -  2   2  :root {
4197     -    3675 +376     -  3   3    --bg-primary: #1c0a00;
4198     -    3676 +377     -  4   4    --bg-secondary: #2d1b0e;
4199     -    3677 +378     -  5   5  
4200     -    3678 +    3308 +@@ -23,20 +23,49 @@
4201     -    3679 +    3309 + 23  23    --code-block-bg: #1c0a00;
4202     -    3680 +    3310 + 24  24    --code-border: #7c2d12;
4203     -    3681 +    3311 + 25  25  
4204     -    3682 +    3312 + 26     -  /* Syntax Highlighting - Comprehensive Token Colors */
4205     -    3683 +    3313 + 27     -  --syntax-keyword: #fb923c;
4206     -    3684 +    3314 + 28     -  --syntax-string: #a3e635;
4207     -    3685 +    3315 + 29     -  --syntax-number: #fbbf24;
4208     -    3686 +    3316 + 30     -  --syntax-function: #f87171;
4209     -    3687 +    3317 + 31     -  --syntax-comment: #78716c;
4210     -    3688 +    3318 + 32     -  --syntax-operator: #fdba74;
4211     -    3689 +    3319 + 33     -  --syntax-punctuation: #d4d4d4;
4212     -    3690 +    3320 +     26 +  /* Syntax Highlighting - Production-Grade Token Colors (One Dark Architecture) */
4213     -    3691 +    3321 + 34  27  
4214     -    3692 +    3322 + 35     -  /* Additional Token Types */
4215     -    3693 +    3323 + 36     -  --syntax-variable: #fcd34d; /* Variables - bright yellow (distinct from text #fed7aa) */
4216     -    3694 +    3324 + 37     -  --syntax-property: #f87171; /* Properties - coral */
4217     -    3695 +    3325 + 38     -  --syntax-namespace: #fb923c; /* Namespaces - sunset orange */
4218     -    3696 +    3326 + 39     -  --syntax-builtin: #f87171; /* Builtins - coral */
4219     -    3697 +    3327 +     28 +  /* Core hue-1: Cyan (187¬∞) - URLs */
4220     -    3698 +    3328 +     29 +  --syntax-url: #5eead4; /* Bright teal for URLs */
4221     -    3699 +    3329 +     30 +
4222     -    3700 +    3330 +     31 +  /* Core hue-2: Blue (207¬∞) - Functions, variables */
4223     -    3701 +    3331 +     32 +  --syntax-function: #60a5fa; /* Bright blue for functions */
4224     -    3702 +    3332 +     33 +  --syntax-variable: #38bdf8; /* Sky blue for variables */
4225     -    3703 +    3333 +     34 +
4226     -    3704 +    3334 +     35 +  /* Core hue-3: Purple (286¬∞) - Keywords */
4227     -    3705 +    3335 +     36 +  --syntax-keyword: #c084fc; /* Bright purple for keywords (final, sealed, class keyword) */
4228     -    3706 +    3336 +     37 +
4229     -    3707 +    3337 +     38 +  /* Core hue-4: Green (95¬∞) - Strings, builtins */
4230     -    3708 +    3338 +     39 +  --syntax-string: #a3e635; /* Lime green for strings */
4231     -    3709 +    3339 +     40 +  --syntax-builtin: #84cc16; /* Vibrant green for builtins (String, List) */
4232     -    3710 +    3340 +     41 +  --syntax-char: #a3e635; /* Same as strings */
4233     -    3711 +    3341 +     42 +  --syntax-regex: #a3e635; /* Same as strings */
4234     -    3712 +    3342 +     43 +  --syntax-inserted: #a3e635; /* For diff */
4235     -    3713 +    3343 +     44 +
4236     -    3714 +    3344 +     45 +  /* Core hue-5: Red (355¬∞) - Properties, tags */
4237     -    3715 +    3345 +     46 +  --syntax-property: #fb7185; /* Coral rose for properties */
4238     -    3716 +    3346 +     47 +  --syntax-tag: #f87171; /* Coral for tags */
4239     -    3717 +    3347 +     48 +  --syntax-deleted: #f87171; /* For diff */
4240     -    3718 +    3348 +     49 +  --syntax-important: #fb7185; /* For !important */
4241     -    3719 +    3349 +     50 +
4242     -    3720 +    3350 +     51 +  /* Core hue-6: Orange (29¬∞) - Class names, constants, numbers */
4243     -    3721 +    3351 +     52 +  --syntax-class-name: #fb923c; /* Bright sunset orange for class names (Rectangle, Shape) */
4244     -    3722 +    3352 +     53 +  --syntax-number: #fbbf24; /* Golden yellow for numbers */
4245     -    3723 +    3353 +     54 +  --syntax-constant: #f97316; /* Burnt orange for constants */
4246     -    3724 +    3354 +     55 +  --syntax-boolean: #fbbf24; /* Same as numbers */
4247     -    3725 +    3355 +     56 +  --syntax-atrule: #fb923c; /* CSS @ rules */
4248     -    3726 +    3356 +     57 +
4249     -    3727 +    3357 +     58 +  /* Neutral colors */
4250     -    3728 +    3358 +     59 +  --syntax-comment: #a8a29e; /* Muted for comments */
4251     -    3729 +    3359 +     60 +  --syntax-punctuation: #d4d4d8; /* Light gray for punctuation */
4252     -    3730 +    3360 +     61 +  --syntax-operator: #fdba74; /* Light sunset for operators */
4253     -    3731 +    3361 +     62 +
4254     -    3732 +    3362 +     63 +  /* Markup specific */
4255     -    3733 +    3363 +     64 +  --syntax-attr-name: #fb923c; /* Orange like class-name */
4256     -    3734 +    3364 +     65 +  --syntax-attr-value: #a3e635; /* Green like strings */
4257     -    3735 +    3365 +     66 +  --syntax-namespace: #c084fc; /* Purple like keywords */
4258     -    3736 +    3366 +     67 +  --syntax-entity: #d4d4d8; /* Neutral */
4259     -    3737 +    3367 +     68 +  --syntax-selector: #fb7185; /* Red like properties */
4260     -    3738 +    3368 + 40  69  
4261     -    3739 +    3369 + 41  70    --blockquote-border: #f97316;
4262     -    3740 +    3370 + 42  71    --blockquote-bg: #2d1b0e;
4263     -    3741 +    3371 +@@ -44,4 +73,87 @@
4264     -    3742 +    3372 + 44  73    --italic-color: #fb923c;
4265     -    3743 +    3373 + 45  74    --table-header-bg: #3d2417;
4266     -    3744 +    3374 + 46  75    --table-border: #7c2d12;
4267     -    3745 +    3375 +     76 +
4268     -    3746 +    3376 +     77 +  /* === MERMAID COMPREHENSIVE CONFIGURATION === */
4269     -    3747 +    3377 +     78 +
4270     -    3748 +    3378 +     79 +  /* Core Global */
4271     -    3749 +    3379 +     80 +  --mermaid-background: #1c0a00;
4272     -    3750 +    3380 +     81 +  --mermaid-text-color: #fed7aa;
4273     -    3751 +    3381 +     82 +  --mermaid-line-color: #f97316;
4274     -    3752 +    3382 +     83 +  --mermaid-main-bkg: #3d2417;
4275     -    3753 +    3383 +     84 +
4276     -    3754 +    3384 +     85 +  /* Primary Set */
4277     -    3755 +    3385 +     86 +  --mermaid-primary-color: #3d2417;
4278     -    3756 +    3386 +     87 +  --mermaid-primary-text-color: #fed7aa;
4279     -    3757 +    3387 +     88 +  --mermaid-primary-border-color: #fb923c;
4280     -    3758 +    3388 +     89 +
4281     -    3759 +    3389 +     90 +  /* Secondary Set */
4282     -    3760 +    3390 +     91 +  --mermaid-secondary-color: #2d1b0e;
4283     -    3761 +    3391 +     92 +  --mermaid-secondary-text-color: #fed7aa;
4284     -    3762 +    3392 +     93 +  --mermaid-secondary-border-color: #f97316;
4285     -    3763 +    3393 +     94 +
4286     -    3764 +    3394 +     95 +  /* Tertiary Set */
4287     -    3765 +    3395 +     96 +  --mermaid-tertiary-color: #1c0a00;
4288     -    3766 +    3396 +     97 +  --mermaid-tertiary-text-color: #fed7aa;
4289     -    3767 +    3397 +     98 +  --mermaid-tertiary-border-color: #ea580c;
4290     -    3768 +    3398 +     99 +
4291     -    3769 +    3399 +    100 +  /* Flowchart */
4292     -    3770 +    3400 +    101 +  --mermaid-node-border: #fb923c;
4293     -    3771 +    3401 +    102 +  --mermaid-cluster-bkg: #2d1b0e;
4294     -    3772 +    3402 +    103 +  --mermaid-cluster-border: #f97316;
4295     -    3773 +    3403 +    104 +  --mermaid-default-link-color: #f97316;
4296     -    3774 +    3404 +    105 +  --mermaid-title-color: #fed7aa;
4297     -    3775 +    3405 +    106 +  --mermaid-edge-label-background: #1c0a00;
4298     -    3776 +    3406 +    107 +  --mermaid-node-text-color: #fed7aa;
4299     -    3777 +    3407 +    108 +
4300     -    3778 +    3408 +    109 +  /* Sequence Diagram */
4301     -    3779 +    3409 +    110 +  --mermaid-actor-bkg: #3d2417;
4302     -    3780 +    3410 +    111 +  --mermaid-actor-border: #fb923c;
4303     -    3781 +    3411 +    112 +  --mermaid-actor-text-color: #fed7aa;
4304     -    3782 +    3412 +    113 +  --mermaid-actor-line-color: #fb923c;
4305     -    3783 +    3413 +    114 +  --mermaid-signal-color: #f97316;
4306     -    3784 +    3414 +    115 +  --mermaid-signal-text-color: #fed7aa;
4307     -    3785 +    3415 +    116 +  --mermaid-label-box-bkg-color: #3d2417;
4308     -    3786 +    3416 +    117 +  --mermaid-label-box-border-color: #fb923c;
4309     -    3787 +    3417 +    118 +  --mermaid-label-text-color: #fed7aa;
4310     -    3788 +    3418 +    119 +  --mermaid-loop-text-color: #fed7aa;
4311     -    3789 +    3419 +    120 +  --mermaid-activation-border-color: #f97316;
4312     -    3790 +    3420 +    121 +  --mermaid-activation-bkg-color: #2d1b0e;
4313     -    3791 +    3421 +    122 +  --mermaid-sequence-number-color: #fed7aa;
4314     -    3792 +    3422 +    123 +
4315     -    3793 +    3423 +    124 +  /* Pie Chart */
4316     -    3794 +    3424 +    125 +  --mermaid-pie1: #fb923c;
4317     -    3795 +    3425 +    126 +  --mermaid-pie2: #f97316;
4318     -    3796 +    3426 +    127 +  --mermaid-pie3: #ea580c;
4319     -    3797 +    3427 +    128 +  --mermaid-pie4: #f87171;
4320     -    3798 +    3428 +    129 +  --mermaid-pie5: #fb7185;
4321     -    3799 +    3429 +    130 +  --mermaid-pie6: #f472b6;
4322     -    3800 +    3430 +    131 +  --mermaid-pie7: #fdba74;
4323     -    3801 +    3431 +    132 +  --mermaid-pie8: #5eead4;
4324     -    3802 +    3432 +    133 +  --mermaid-pie9: #60a5fa;
4325     -    3803 +    3433 +    134 +  --mermaid-pie10: #c084fc;
4326     -    3804 +    3434 +    135 +  --mermaid-pie11: #a3e635;
4327     -    3805 +    3435 +    136 +  --mermaid-pie12: #fbbf24;
4328     -    3806 +    3436 +    137 +  --mermaid-pie-title-text-color: #fed7aa;
4329     -    3807 +    3437 +    138 +  --mermaid-pie-section-text-color: #1c0a00; /* Dark on vibrant slices */
4330     -    3808 +    3438 +    139 +  --mermaid-pie-legend-text-color: #fed7aa;
4331     -    3809 +    3439 +    140 +  --mermaid-pie-stroke-color: #fb923c;
4332     -    3810 +    3440 +    141 +  --mermaid-pie-outer-stroke-color: #fb923c;
4333     -    3811 +    3441 +    142 +
4334     -    3812 +    3442 +    143 +  /* State Diagram */
4335     -    3813 +    3443 +    144 +  --mermaid-label-color: #fed7aa;
4336     -    3814 +    3444 +    145 +  --mermaid-alt-background: #2d1b0e;
4337     -    3815 +    3445 +    146 +
4338     -    3816 +    3446 +    147 +  /* Class Diagram */
4339     -    3817 +    3447 +    148 +  --mermaid-class-text: #fed7aa;
4340     -    3818 +    3448 +    149 +
4341     -    3819 +    3449 +    150 +  /* User Journey */
4342     -    3820 +    3450 +    151 +  --mermaid-fill-type0: #fb923c;
4343     -    3821 +    3451 +    152 +  --mermaid-fill-type1: #f97316;
4344     -    3822 +    3452 +    153 +  --mermaid-fill-type2: #ea580c;
4345     -    3823 +    3453 +    154 +  --mermaid-fill-type3: #f87171;
4346     -    3824 +    3454 +    155 +  --mermaid-fill-type4: #fb7185;
4347     -    3825 +    3455 +    156 +  --mermaid-fill-type5: #f472b6;
4348     -    3826 +    3456 +    157 +  --mermaid-fill-type6: #fdba74;
4349     -    3827 +    3457 +    158 +  --mermaid-fill-type7: #5eead4;
4350     -    3828 +    3458 + 47 159  }
4351     -    3829 +    3459 + 48 160  
4352     -    3830 +    3460 +
4353     -    3831 +    3461 +```
4354     -    3832 +    3462 +
4355     -    3833 +    3463 +
4356     -    3834 +    3464 +### üìÑ `themes/sunset-light.css`
4357     -    3835 +    3465 +
4358     -    3836 +    3466 +**Type:** Stylesheet üé®
4359     -    3837 +    3467 +
4360     -    3838 +    3468 +```diff
4361     -    3839 +    3469 +@@ -23,20 +23,49 @@
4362     -    3840 +    3470 + 23  23    --code-block-bg: #ffedd5; /* Light orange background */
4363     -    3841 +    3471 + 24  24    --code-border: #fdba74;
4364     -    3842 +    3472 + 25  25  
4365     -    3843 +    3473 + 26     -  /* Syntax Highlighting - Comprehensive Token Colors */
4366     -    3844 +    3474 + 27     -  --syntax-keyword: #ea580c;
4367     -    3845 +    3475 + 28     -  --syntax-string: #16a34a;
4368     -    3846 +    3476 + 29     -  --syntax-number: #f59e0b;
4369     -    3847 +    3477 + 30     -  --syntax-function: #dc2626;
4370     -    3848 +    3478 + 31     -  --syntax-comment: #78716c;
4371     -    3849 +    3479 + 32     -  --syntax-operator: #c2410c;
4372     -    3850 +    3480 + 33     -  --syntax-punctuation: #57534e;
4373     -    3851 +    3481 +     26 +  /* Syntax Highlighting - Production-Grade Token Colors (Based on One Dark Architecture) */
4374     -    3852 +    3482 + 34  27  
4375     -    3853 +    3483 + 35     -  /* Additional Token Types for Full Customization */
4376     -    3854 +    3484 + 36     -  --syntax-variable: #ea580c; /* Variables - sunset orange */
4377     -    3855 +    3485 + 37     -  --syntax-property: #dc2626; /* Properties - red */
4378     -    3856 +    3486 + 38     -  --syntax-namespace: #f97316; /* Namespaces - bright orange */
4379     -    3857 +    3487 + 39     -  --syntax-builtin: #dc2626; /* Builtins - red */
4380     -    3858 +    3488 +     28 +  /* Core hue-1: Cyan (187¬∞) - URLs, special strings */
4381     -    3859 +    3489 +     29 +  --syntax-url: #14b8a6; /* Teal/cyan for URLs */
4382     -    3860 +    3490 +     30 +
4383     -    3861 +    3491 +     31 +  /* Core hue-2: Blue (207¬∞) - Functions, variables, operators */
4384     -    3862 +    3492 +     32 +  --syntax-function: #3b82f6; /* Bright blue for functions */
4385     -    3863 +    3493 +     33 +  --syntax-variable: #0ea5e9; /* Sky blue for variables */
4386     -    3864 +    3494 +     34 +
4387     -    3865 +    3495 +     35 +  /* Core hue-3: Purple (286¬∞) - Keywords */
4388     -    3866 +    3496 +     36 +  --syntax-keyword: #a855f7; /* Vibrant purple for keywords (if, final, sealed) */
4389     -    3867 +    3497 +     37 +
4390     -    3868 +    3498 +     38 +  /* Core hue-4: Green (95¬∞) - Strings, builtins, inserted */
4391     -    3869 +    3499 +     39 +  --syntax-string: #10b981; /* Emerald green for strings */
4392     -    3870 +    3500 +     40 +  --syntax-builtin: #059669; /* Darker green for builtins (String, List, Array) */
4393     -    3871 +    3501 +     41 +  --syntax-char: #10b981; /* Same as strings */
4394     -    3872 +    3502 +     42 +  --syntax-regex: #10b981; /* Same as strings */
4395     -    3873 +    3503 +     43 +  --syntax-inserted: #10b981; /* For diff highlights */
4396     -    3874 +    3504 +     44 +
4397     -    3875 +    3505 +     45 +  /* Core hue-5: Red (355¬∞) - Properties, tags, deleted, important */
4398     -    3876 +    3506 +     46 +  --syntax-property: #ef4444; /* Red for properties */
4399     -    3877 +    3507 +     47 +  --syntax-tag: #ef4444; /* Red for HTML tags */
4400     -    3878 +    3508 +     48 +  --syntax-deleted: #ef4444; /* For diff highlights */
4401     -    3879 +    3509 +     49 +  --syntax-important: #ef4444; /* For !important */
4402     -    3880 +    3510 +     50 +
4403     -    3881 +    3511 +     51 +  /* Core hue-6: Orange (29¬∞) - Class names, constants, numbers, atrules */
4404     -    3882 +    3512 +     52 +  --syntax-class-name: #f97316; /* Orange for class/type names (Rectangle, Shape) */
4405     -    3883 +    3513 +     53 +  --syntax-number: #fb923c; /* Bright orange for numbers */
4406     -    3884 +    3514 +     54 +  --syntax-constant: #ea580c; /* Burnt orange for constants */
4407     -    3885 +    3515 +     55 +  --syntax-boolean: #fb923c; /* Same as numbers */
4408     -    3886 +    3516 +     56 +  --syntax-atrule: #fb923c; /* CSS @ rules */
4409     -    3887 +    3517 +     57 +
4410     -    3888 +    3518 +     58 +  /* Neutral colors */
4411     -    3889 +    3519 +     59 +  --syntax-comment: #a8a29e; /* Muted stone for comments */
4412     -    3890 +    3520 +     60 +  --syntax-punctuation: #64748b; /* Slate for punctuation */
4413     -    3891 +    3521 +     61 +  --syntax-operator: #fb7185; /* Coral rose for operators */
4414     -    3892 +    3522 +     62 +
4415     -    3893 +    3523 +     63 +  /* Markup specific */
4416     -    3894 +    3524 +     64 +  --syntax-attr-name: #f97316; /* Orange like class-name */
4417     -    3895 +    3525 +     65 +  --syntax-attr-value: #10b981; /* Green like strings */
4418     -    3896 +    3526 +     66 +  --syntax-namespace: #a855f7; /* Purple like keywords */
4419     -    3897 +    3527 +     67 +  --syntax-entity: #64748b; /* Neutral */
4420     -    3898 +    3528 +     68 +  --syntax-selector: #ef4444; /* Red like properties */
4421     -    3899 +    3529 + 40  69  
4422     -    3900 +    3530 + 41  70    --blockquote-border: #f97316;
4423     -    3901 +    3531 + 42  71    --blockquote-bg: #ffedd5;
4424     -    3902 +    3532 +@@ -44,4 +73,87 @@
4425     -    3903 +    3533 + 44  73    --italic-color: #e11d48;
4426     -    3904 +    3534 + 45  74    --table-header-bg: #fed7aa;
4427     -    3905 +    3535 + 46  75    --table-border: #fdba74;
4428     -    3906 +    3536 +     76 +
4429     -    3907 +    3537 +     77 +  /* === MERMAID COMPREHENSIVE CONFIGURATION === */
4430     -    3908 +    3538 +     78 +
4431     -    3909 +    3539 +     79 +  /* Core Global */
4432     -    3910 +    3540 +     80 +  --mermaid-background: #fff7ed;
4433     -    3911 +    3541 +     81 +  --mermaid-text-color: #431407;
4434     -    3912 +    3542 +     82 +  --mermaid-line-color: #f97316;
4435     -    3913 +    3543 +     83 +  --mermaid-main-bkg: #fed7aa;
4436     -    3914 +    3544 +     84 +
4437     -    3915 +    3545 +     85 +  /* Primary Set */
4438     -    3916 +    3546 +     86 +  --mermaid-primary-color: #fed7aa;
4439     -    3917 +    3547 +     87 +  --mermaid-primary-text-color: #431407;
4440     -    3918 +    3548 +     88 +  --mermaid-primary-border-color: #ea580c;
4441     -    3919 +    3549 +     89 +
4442     -    3920 +    3550 +     90 +  /* Secondary Set */
4443     -    3921 +    3551 +     91 +  --mermaid-secondary-color: #ffedd5;
4444     -    3922 +    3552 +     92 +  --mermaid-secondary-text-color: #431407;
4445     -    3923 +    3553 +     93 +  --mermaid-secondary-border-color: #f97316;
4446     -    3924 +    3554 +     94 +
4447     -    3925 +    3555 +     95 +  /* Tertiary Set */
4448     -    3926 +    3556 +     96 +  --mermaid-tertiary-color: #fff7ed;
4449     -    3927 +    3557 +     97 +  --mermaid-tertiary-text-color: #431407;
4450     -    3928 +    3558 +     98 +  --mermaid-tertiary-border-color: #fb923c;
4451     -    3929 +    3559 +     99 +
4452     -    3930 +    3560 +    100 +  /* Flowchart */
4453     -    3931 +    3561 +    101 +  --mermaid-node-border: #ea580c;
4454     -    3932 +    3562 +    102 +  --mermaid-cluster-bkg: #ffedd5;
4455     -    3933 +    3563 +    103 +  --mermaid-cluster-border: #f97316;
4456     -    3934 +    3564 +    104 +  --mermaid-default-link-color: #f97316;
4457     -    3935 +    3565 +    105 +  --mermaid-title-color: #431407;
4458     -    3936 +    3566 +    106 +  --mermaid-edge-label-background: #fff7ed;
4459     -    3937 +    3567 +    107 +  --mermaid-node-text-color: #431407;
4460     -    3938 +    3568 +    108 +
4461     -    3939 +    3569 +    109 +  /* Sequence Diagram */
4462     -    3940 +    3570 +    110 +  --mermaid-actor-bkg: #fed7aa;
4463     -    3941 +    3571 +    111 +  --mermaid-actor-border: #ea580c;
4464     -    3942 +    3572 +    112 +  --mermaid-actor-text-color: #431407;
4465     -    3943 +    3573 +    113 +  --mermaid-actor-line-color: #ea580c;
4466     -    3944 +    3574 +    114 +  --mermaid-signal-color: #f97316;
4467     -    3945 +    3575 +    115 +  --mermaid-signal-text-color: #431407;
4468     -    3946 +    3576 +    116 +  --mermaid-label-box-bkg-color: #fed7aa;
4469     -    3947 +    3577 +    117 +  --mermaid-label-box-border-color: #ea580c;
4470     -    3948 +    3578 +    118 +  --mermaid-label-text-color: #431407;
4471     -    3949 +    3579 +    119 +  --mermaid-loop-text-color: #431407;
4472     -    3950 +    3580 +    120 +  --mermaid-activation-border-color: #f97316;
4473     -    3951 +    3581 +    121 +  --mermaid-activation-bkg-color: #ffedd5;
4474     -    3952 +    3582 +    122 +  --mermaid-sequence-number-color: #431407;
4475     -    3953 +    3583 +    123 +
4476     -    3954 +    3584 +    124 +  /* Pie Chart */
4477     -    3955 +    3585 +    125 +  --mermaid-pie1: #ea580c;
4478     -    3956 +    3586 +    126 +  --mermaid-pie2: #f97316;
4479     -    3957 +    3587 +    127 +  --mermaid-pie3: #fb923c;
4480     -    3958 +    3588 +    128 +  --mermaid-pie4: #dc2626;
4481     -    3959 +    3589 +    129 +  --mermaid-pie5: #e11d48;
4482     -    3960 +    3590 +    130 +  --mermaid-pie6: #db2777;
4483     -    3961 +    3591 +    131 +  --mermaid-pie7: #c2410c;
4484     -    3962 +    3592 +    132 +  --mermaid-pie8: #14b8a6;
4485     -    3963 +    3593 +    133 +  --mermaid-pie9: #3b82f6;
4486     -    3964 +    3594 +    134 +  --mermaid-pie10: #a855f7;
4487     -    3965 +    3595 +    135 +  --mermaid-pie11: #ef4444;
4488     -    3966 +    3596 +    136 +  --mermaid-pie12: #10b981;
4489     -    3967 +    3597 +    137 +  --mermaid-pie-title-text-color: #431407;
4490     -    3968 +    3598 +    138 +  --mermaid-pie-section-text-color: #fff7ed; /* Light on vibrant slices */
4491     -    3969 +    3599 +    139 +  --mermaid-pie-legend-text-color: #431407;
4492     -    3970 +    3600 +    140 +  --mermaid-pie-stroke-color: #ea580c;
4493     -    3971 +    3601 +    141 +  --mermaid-pie-outer-stroke-color: #ea580c;
4494     -    3972 +    3602 +    142 +
4495     -    3973 +    3603 +    143 +  /* State Diagram */
4496     -    3974 +    3604 +    144 +  --mermaid-label-color: #431407;
4497     -    3975 +    3605 +    145 +  --mermaid-alt-background: #ffedd5;
4498     -    3976 +    3606 +    146 +
4499     -    3977 +    3607 +    147 +  /* Class Diagram */
4500     -    3978 +    3608 +    148 +  --mermaid-class-text: #431407;
4501     -    3979 +    3609 +    149 +
4502     -    3980 +    3610 +    150 +  /* User Journey */
4503     -    3981 +    3611 +    151 +  --mermaid-fill-type0: #ea580c;
4504     -    3982 +    3612 +    152 +  --mermaid-fill-type1: #f97316;
4505     -    3983 +    3613 +    153 +  --mermaid-fill-type2: #fb923c;
4506     -    3984 +    3614 +    154 +  --mermaid-fill-type3: #dc2626;
4507     -    3985 +    3615 +    155 +  --mermaid-fill-type4: #e11d48;
4508     -    3986 +    3616 +    156 +  --mermaid-fill-type5: #db2777;
4509     -    3987 +    3617 +    157 +  --mermaid-fill-type6: #c2410c;
4510     -    3988 +    3618 +    158 +  --mermaid-fill-type7: #14b8a6;
4511     -    3989 +    3619 + 47 159  }
4512     -    3990 +    3620 + 48 160  
4513     -    3991 +379 3621  
4514     -    3992 +380 3622  ```
4515     -    3993 +381 3623  
4516     -    3994 +@@ -421,4 +3663,4 @@ Please provide specific feedback on:
4517     -    3995 +421 3663  
4518     -    3996 +422 3664  ---
4519     -    3997 +423 3665  *Generated by AI Visual Code Review v2.0 - Unified Export Script*
4520     -    3998 +424     -*Files processed: 3/3 | Errors: 0 | Generated: 2025-12-07T02:57:20.361Z*
4521     -    3999 +    3666 +*Files processed: 18/18 | Errors: 0 | Generated: 2025-12-07T04:29:24.609Z*
4522     -    4000 +425 3667  
4523     -496 4001  
4524     -497 4002  ```
4525     -498 4003  
4526     -499 4004  
4527     -500     -### ‚ú® `docs/02-architecture/mermaid-theme-architecture.md` **[ADDED]**
4528     -    4005 +### ‚ú® `codebase_audit/audit_summary.md` **[ADDED]**
4529     -501 4006  
4530     -502 4007  **Status:** ‚úÖ **NEW FILE** - This file has been newly created
4531     -503 4008  
4532     -504 4009  **Type:** Documentation üìñ
4533     -505 4010  
4534     -506 4011  ```diff
4535     -507     -@@ -0,0 +1,208 @@
4536     -508     -      1 +# Mermaid Theme Architecture - Comprehensive Reference
4537     -    4012 +@@ -0,0 +1,49 @@
4538     -    4013 +      1 +# üìä Codebase Audit Summary
4539     -509 4014        2 +
4540     -510     -      3 +**Last Updated:** 12/7/2025
4541     -511     -      4 +**Source:** Official Mermaid.js theming documentation
4542     -512     -      5 +
4543     -513     -      6 +## Complete Mermaid Theme Variables
4544     -514     -      7 +
4545     -515     -      8 +### Core Global Variables
4546     -516     -      9 +
4547     -517     -     10 +| Variable     | Type       | Description                  | Default                        |
4548     -518     -     11 +| ------------ | ---------- | ---------------------------- | ------------------------------ |
4549     -519     -     12 +| `background` | Background | Page background              | `#f4f4f4`                      |
4550     -520     -     13 +| `fontFamily` | Text       | Font family                  | `trebuchet ms, verdana, arial` |
4551     -521     -     14 +| `fontSize`   | Text       | Font size                    | `16px`                         |
4552     -522     -     15 +| `darkMode`   | Boolean    | Affects color calculations   | `false`                        |
4553     -523     -     16 +| `textColor`  | Text       | General text over background | calculated                     |
4554     -524     -     17 +| `lineColor`  | Line       | Lines and connections        | calculated                     |
4555     -525     -     18 +| `mainBkg`    | Background | Main background for objects  | calculated                     |
4556     -    4015 +      3 +**Date:** 2025-12-09
4557     -    4016 +      4 +**Auditor:** CodeBaseGPT
4558     -    4017 +      5 +**Repository:** `markdown-viewer-app`
4559     -    4018 +      6 +
4560     -    4019 +      7 +---
4561     -    4020 +      8 +
4562     -    4021 +      9 +## üèÅ Executive Summary
4563     -    4022 +     10 +
4564     -    4023 +     11 +The `markdown-viewer-app` is a **Client-Side SPA** built with **Vanilla JavaScript**. It has a solid modular foundation (`Services` directory) but suffers from "Controller Bloat" in `script.js`.
4565     -    4024 +     12 +
4566     -    4025 +     13 +**Health Score:** üü° **C+ (Needs Attention)**
4567     -    4026 +     14 +
4568     -    4027 +     15 +- **Architecture:** ‚≠ê‚≠ê‚≠ê (3/5) - Good service separation, but monolithic controller.
4569     -    4028 +     16 +- **Security:** ‚≠ê (1/5) - **CRITICAL** Stored XSS vulnerability detected.
4570     -    4029 +     17 +- **Code Quality:** ‚≠ê‚≠ê‚≠ê (3/5) - Human-readable, but prone to race conditions.
4571     -    4030 +     18 +- **Documentation:** ‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê (5/5) - Excellent, comprehensive documentation.
4572     -526 4031       19 +
4573     -527     -     20 +### Primary/Secondary/Tertiary Color Sets
4574     -    4032 +     20 +---
4575     -528 4033       21 +
4576     -529     -     22 +Each set has 3 variables (background, text, border):
4577     -    4034 +     22 +## üìÇ Audit Artifacts
4578     -530 4035       23 +
4579     -531     -     24 +| Variable               | Type       | Description                |
4580     -532     -     25 +| ---------------------- | ---------- | -------------------------- |
4581     -533     -     26 +| `primaryColor`         | Background | Primary node background    |
4582     -534     -     27 +| `primaryTextColor`     | Text       | Text in primary nodes      |
4583     -535     -     28 +| `primaryBorderColor`   | Border     | Border for primary nodes   |
4584     -536     -     29 +| `secondaryColor`       | Background | Secondary node background  |
4585     -537     -     30 +| `secondaryTextColor`   | Text       | Text in secondary nodes    |
4586     -538     -     31 +| `secondaryBorderColor` | Border     | Border for secondary nodes |
4587     -539     -     32 +| `tertiaryColor`        | Background | Tertiary node background   |
4588     -540     -     33 +| `tertiaryTextColor`    | Text       | Text in tertiary nodes     |
4589     -541     -     34 +| `tertiaryBorderColor`  | Border     | Border for tertiary nodes  |
4590     -    4036 +     24 +1.  **[Repo Manifest](./repo_manifest.json)** - Full inventory of files.
4591     -    4037 +     25 +2.  **[Consolidated Findings](./phase4_consolidated_findings.md)** - High-level issue list.
4592     -    4038 +     26 +3.  **[Implementation Plan](./phase4_implementation_plan.md)** - Step-by-step roadmap.
4593     -    4039 +     27 +4.  **[Detailed Roadmap](./phase5_recommendations.md)** - Strategic recommendations.
4594     -    4040 +     28 +
4595     -    4041 +     29 +### üî¨ Deep Dive Reviews
4596     -    4042 +     30 +*   **[script.js Review](./deep_dive_reviews/script_js_review.md)** (Critical Issues)
4597     -    4043 +     31 +*   **[ThemeManager.js Review](./deep_dive_reviews/theme_manager_review.md)** (Performance Notes)
4598     -    4044 +     32 +*   **[MermaidService.js Review](./deep_dive_reviews/mermaid_service_review.md)** (Coupling Notes)
4599     -    4045 +     33 +
4600     -    4046 +     34 +---
4601     -542 4047       35 +
4602     -543     -     36 +### Flowchart-Specific Variables
4603     -    4048 +     36 +## üõë Top 3 Priorities
4604     -544 4049       37 +
4605     -545     -     38 +| Variable              | Type       | Description           |
4606     -546     -     39 +| --------------------- | ---------- | --------------------- |
4607     -547     -     40 +| `nodeBorder`          | Border     | Node border color     |
4608     -548     -     41 +| `clusterBkg`          | Background | Subgraph background   |
4609     -549     -     42 +| `clusterBorder`       | Border     | Subgraph border       |
4610     -550     -     43 +| `defaultLinkColor`    | Line       | Link/edge color       |
4611     -551     -     44 +| `titleColor`          | Text       | Title text color      |
4612     -552     -     45 +| `edgeLabelBackground` | Background | Edge label background |
4613     -553     -     46 +| `nodeTextColor`       | Text       | Text inside nodes     |
4614     -554     -     47 +
4615     -555     -     48 +### Sequence Diagram Variables
4616     -556     -     49 +
4617     -557     -     50 +| Variable                | Type       | Description           |
4618     -558     -     51 +| ----------------------- | ---------- | --------------------- |
4619     -559     -     52 +| `actorBkg`              | Background | Actor box background  |
4620     -560     -     53 +| `actorBorder`           | Border     | Actor box border      |
4621     -561     -     54 +| `actorTextColor`        | Text       | Actor text            |
4622     -562     -     55 +| `actorLineColor`        | Line       | Actor lifeline        |
4623     -563     -     56 +| `signalColor`           | Line       | Signal arrows         |
4624     -564     -     57 +| `signalTextColor`       | Text       | Signal labels         |
4625     -565     -     58 +| `labelBoxBkgColor`      | Background | Label box background  |
4626     -566     -     59 +| `labelBoxBorderColor`   | Border     | Label box border      |
4627     -567     -     60 +| `labelTextColor`        | Text       | Label text            |
4628     -568     -     61 +| `loopTextColor`         | Text       | Loop text             |
4629     -569     -     62 +| `activationBorderColor` | Border     | Activation border     |
4630     -570     -     63 +| `activationBkgColor`    | Background | Activation background |
4631     -571     -     64 +| `sequenceNumberColor`   | Text       | Sequence numbers      |
4632     -572     -     65 +
4633     -573     -     66 +### Pie Chart Variables
4634     -574     -     67 +
4635     -575     -     68 +| Variable              | Type       | Description                           |
4636     -576     -     69 +| --------------------- | ---------- | ------------------------------------- |
4637     -577     -     70 +| `pie1` - `pie12`      | Background | Fill colors for sections              |
4638     -578     -     71 +| `pieTitleTextSize`    | Text       | Title font size (default: `25px`)     |
4639     -579     -     72 +| `pieTitleTextColor`   | Text       | Title text color                      |
4640     -580     -     73 +| `pieSectionTextSize`  | Text       | Section label size (default: `17px`)  |
4641     -581     -     74 +| `pieSectionTextColor` | Text       | **Section label color (ON SLICES!)**  |
4642     -582     -     75 +| `pieLegendTextSize`   | Text       | Legend font size (default: `17px`)    |
4643     -583     -     76 +| `pieLegendTextColor`  | Text       | Legend text color                     |
4644     -584     -     77 +| `pieStrokeColor`      | Border     | Slice borders (default: `black`)      |
4645     -585     -     78 +| `pieStrokeWidth`      | Border     | Slice border width (default: `2px`)   |
4646     -586     -     79 +| `pieOuterStrokeWidth` | Border     | Outer circle width (default: `2px`)   |
4647     -587     -     80 +| `pieOuterStrokeColor` | Border     | Outer circle color (default: `black`) |
4648     -588     -     81 +| `pieOpacity`          | Visual     | Slice opacity (default: `0.7`)        |
4649     -589     -     82 +
4650     -590     -     83 +### State Diagram Variables
4651     -591     -     84 +
4652     -592     -     85 +| Variable        | Type       | Description                |
4653     -593     -     86 +| --------------- | ---------- | -------------------------- |
4654     -594     -     87 +| `labelColor`    | Text       | State label color          |
4655     -595     -     88 +| `altBackground` | Background | Composite state background |
4656     -596     -     89 +
4657     -597     -     90 +### Class Diagram Variables
4658     -598     -     91 +
4659     -599     -     92 +| Variable    | Type | Description      |
4660     -600     -     93 +| ----------- | ---- | ---------------- |
4661     -601     -     94 +| `classText` | Text | Class text color |
4662     -602     -     95 +
4663     -603     -     96 +### User Journey Variables
4664     -604     -     97 +
4665     -605     -     98 +| Variable                  | Type       | Description   |
4666     -606     -     99 +| ------------------------- | ---------- | ------------- |
4667     -607     -    100 +| `fillType0` - `fillType7` | Background | Section fills |
4668     -608     -    101 +
4669     -609     -    102 +## Critical Insights
4670     -610     -    103 +
4671     -611     -    104 +### 1. Pie Section Text Contrast Issue
4672     -612     -    105 +
4673     -613     -    106 +**Problem:** `pieSectionTextColor` is text **ON** the colored pie slices!
4674     -614     -    107 +
4675     -615     -    108 +- If slices are dark and text is dark ‚Üí **UNREADABLE**
4676     -616     -    109 +- If slices are light and text is light ‚Üí **UNREADABLE**
4677     -617     -    110 +
4678     -618     -    111 +**Solution:** `pieSectionTextColor` must contrast with `pie1-pie12` colors!
4679     -619     -    112 +
4680     -620     -    113 +### 2. Background vs Text Variables
4681     -621     -    114 +
4682     -622     -    115 +- **Background variables** (end with `Bkg`, `Color`, or are named `pie1-12`)
4683     -623     -    116 +- **Text variables** (contain `Text` or `textColor`)
4684     -624     -    117 +- **Border variables** (contain `Border` or `Stroke`)
4685     -625     -    118 +- **Line variables** (contain `Line` or `lineColor`)
4686     -626     -    119 +
4687     -627     -    120 +### 3. Calculated vs Explicit
4688     -628     -    121 +
4689     -629     -    122 +- Mermaid **calculates** many colors if not provided
4690     -630     -    123 +- But calculation may not match our theme aesthetics
4691     -631     -    124 +- **We should set ALL critical variables explicitly**
4692     -632     -    125 +
4693     -633     -    126 +## Implementation Strategy
4694     -634     -    127 +
4695     -635     -    128 +### For Each Theme, Define
4696     -636     -    129 +
4697     -637     -    130 +1. **Core Backgrounds** (3 levels for hierarchy)
4698     -638     -    131 +   - `primaryColor`, `secondaryColor`, `tertiaryColor`
4699     -639     -    132 +
4700     -640     -    133 +2. **All Text Colors** (must contrast with their backgrounds!)
4701     -641     -    134 +   - `primaryTextColor`, `secondaryTextColor`, `tertiaryTextColor`
4702     -642     -    135 +   - `nodeTextColor`, `actorTextColor`, `signalTextColor`
4703     -643     -    136 +   - `pieTitleTextColor`, `pieSectionTextColor`, `pieLegendTextColor`
4704     -644     -    137 +
4705     -645     -    138 +3. **All Border Colors** (visible against backgrounds)
4706     -646     -    139 +   - `primaryBorderColor`, `secondaryBorderColor`, `tertiaryBorderColor`
4707     -647     -    140 +   - `nodeBorder`, `actorBorder`, `clusterBorder`
4708     -648     -    141 +   - `pieStrokeColor`, `pieOuterStrokeColor`
4709     -649     -    142 +
4710     -650     -    143 +4. **Line/Connection Colors**
4711     -651     -    144 +   - `lineColor`, `defaultLinkColor`
4712     -652     -    145 +   - `signalColor`, `actorLineColor`
4713     -653     -    146 +
4714     -654     -    147 +5. **Pie Slice Backgrounds** (12 distinct colors)
4715     -655     -    148 +   - `pie1` through `pie12` - must be DISTINCT from text color!
4716     -656     -    149 +
4717     -657     -    150 +## Architecture Pattern
4718     -658     -    151 +
4719     -659     -    152 +```javascript
4720     -660     -    153 +mermaid.initialize({
4721     -661     -    154 +  theme: 'base',
4722     -662     -    155 +  themeVariables: {
4723     -663     -    156 +    // Core (affects ALL diagrams)
4724     -664     -    157 +    background: bgPrimary,
4725     -665     -    158 +    fontFamily: '...',
4726     -666     -    159 +    fontSize: '16px',
4727     -667     -    160 +
4728     -668     -    161 +    // Primary set (most nodes)
4729     -669     -    162 +    primaryColor: [BACKGROUND],
4730     -670     -    163 +    primaryTextColor: [TEXT - must contrast!],
4731     -671     -    164 +    primaryBorderColor: [BORDER - visible],
4732     -672     -    165 +
4733     -673     -    166 +    // Secondary set (clusters, special nodes)
4734     -674     -    167 +    secondaryColor: [BACKGROUND],
4735     -675     -    168 +    secondaryTextColor: [TEXT - must contrast!],
4736     -676     -    169 +    secondaryBorderColor: [BORDER - visible],
4737     -677     -    170 +
4738     -678     -    171 +    // Tertiary set (nested elements)
4739     -679     -    172 +    tertiaryColor: [BACKGROUND],
4740     -680     -    173 +    tertiaryTextColor: [TEXT - must contrast!],
4741     -681     -    174 +    tertiaryBorderColor: [BORDER - visible],
4742     -682     -    175 +
4743     -683     -    176 +    // Flowchart specific
4744     -684     -    177 +    nodeBorder: [VISIBLE],
4745     -685     -    178 +    nodeTextColor: [CONTRASTING],
4746     -686     -    179 +    edgeLabelBackground: [BACKGROUND],
4747     -687     -    180 +
4748     -688     -    181 +    // Sequence diagram specific
4749     -689     -    182 +    actorBkg: [BACKGROUND],
4750     -690     -    183 +    actorTextColor: [CONTRASTING],
4751     -691     -    184 +
4752     -692     -    185 +    // Pie chart specific
4753     -693     -    186 +    pie1-12: [12 DISTINCT COLORS],
4754     -694     -    187 +    pieSectionTextColor: [CONTRASTS WITH pie1-12!],
4755     -695     -    188 +
4756     -696     -    189 +    // Lines
4757     -697     -    190 +    lineColor: [VISIBLE],
4758     -698     -    191 +    signalColor: [VISIBLE],
4759     -699     -    192 +  }
4760     -700     -    193 +});
4761     -701     -    194 +```
4762     -702     -    195 +
4763     -703     -    196 +## Testing Checklist
4764     -704     -    197 +
4765     -705     -    198 +- [ ] Flowchart - nodes, clusters, edges readable
4766     -706     -    199 +- [ ] Sequence diagram - actors, signals, loops readable
4767     -707     -    200 +- [ ] Pie chart - slices, percentages, legend readable
4768     -708     -    201 +- [ ] State diagram - states, transitions readable
4769     -709     -    202 +- [ ] Class diagram - classes, methods readable
4770     -710     -    203 +- [ ] User journey - tasks, emotions readable
4771     -711     -    204 +
4772     -712     -    205 +## References
4773     -713     -    206 +
4774     -714     -    207 +- [Mermaid Theming Documentation](https://mermaid.js.org/config/theming.html)
4775     -715     -    208 +- [Base Theme Source](https://github.com/mermaid-js/mermaid/blob/develop/packages/mermaid/src/themes/theme-base.js)
4776     -716     -    209  
4777     -    4050 +     38 +1.  **üî• FIX:** Install `dompurify` and sanitize Markdown rendering immediately.
4778     -    4051 +     39 +2.  **üèóÔ∏è REFACTOR:** Break `script.js` into `UIManager`, `EventManager`, and `AppController`.
4779     -    4052 +     40 +3.  **üêõ BUG:** Replace `setTimeout` callbacks with `Promise` chains for robust rendering.
4780     -    4053 +     41 +
4781     -    4054 +     42 +---
4782     -    4055 +     43 +
4783     -    4056 +     44 +## üìù Next Steps
4784     -    4057 +     45 +
4785     -    4058 +     46 +Ready to begin **Phase 1 of Remediation**:
4786     -    4059 +     47 +> Executing `npm install dompurify` and patching `script.js` to fix the XSS vulnerability.
4787     -    4060 +     48 +
4788     -    4061 +     49 +**Proceed?**
4789     -    4062 +     50  
4790     -717 4063  
4791     -718 4064  ```
4792     -719 4065  
4793     -720 4066  
4794     -721     -### ‚ú® `docs/02-architecture/prism-token-architecture.md` **[ADDED]**
4795     -    4067 +### ‚ú® `codebase_audit/deep_dive_reviews/mermaid_service_review.md` **[ADDED]**
4796     -722 4068  
4797     -723 4069  **Status:** ‚úÖ **NEW FILE** - This file has been newly created
4798     -724 4070  
4799     -725 4071  **Type:** Documentation üìñ
4800     -726 4072  
4801     -727 4073  ```diff
4802     -728     -@@ -0,0 +1,226 @@
4803     -729     -      1 +# Prism Token Architecture - Comprehensive Reference
4804     -    4074 +@@ -0,0 +1,47 @@
4805     -    4075 +      1 +# üïµÔ∏è‚Äç‚ôÇÔ∏è Deep Dive Code Review: `MermaidService.js`
4806     -730 4076        2 +
4807     -731     -      3 +**Last Updated:** 12/7/2025
4808     -732     -      4 +**Source:** Official Prism.js documentation + One Dark theme analysis
4809     -733     -      5 +
4810     -734     -      6 +## Standard Token Classes
4811     -735     -      7 +
4812     -736     -      8 +### Core Language Constructs
4813     -737     -      9 +
4814     -738     -     10 +| Token Class   | Purpose                    | Example                                  | Recommended Color Hue             |
4815     -739     -     11 +| ------------- | -------------------------- | ---------------------------------------- | --------------------------------- |
4816     -740     -     12 +| `keyword`     | Reserved words             | `if`, `else`, `class`, `final`, `sealed` | Purple/Magenta (286¬∞)             |
4817     -741     -     13 +| `builtin`     | Built-in functions/types   | `String`, `Array`, `Console`             | Green (95¬∞)                       |
4818     -742     -     14 +| `class-name`  | Class/Interface/Type names | `Rectangle`, `Shape`, `Person`           | Orange (29¬∞)                      |
4819     -743     -     15 +| `function`    | Function/method names      | `main`, `println`, `forEach`             | Blue (207¬∞)                       |
4820     -744     -     16 +| `boolean`     | True/false values          | `true`, `false`                          | Orange (29¬∞)                      |
4821     -745     -     17 +| `number`      | Numeric literals           | `42`, `3.14`, `0xDEADBEEF`               | Orange (29¬∞)                      |
4822     -746     -     18 +| `string`      | String literals            | `"Hello"`, `'World'`                     | Green (95¬∞)                       |
4823     -747     -     19 +| `char`        | Character literals         | `'A'`, `'\n'`                            | Green (95¬∞)                       |
4824     -748     -     20 +| `symbol`      | Symbols (Smalltalk, Ruby)  | `:mySymbol`                              | Green (95¬∞)                       |
4825     -749     -     21 +| `regex`       | Regular expressions        | `/[a-z]+/i`                              | Green (95¬∞)                       |
4826     -750     -     22 +| `operator`    | Operators                  | `+`, `-`, `*`, `/`, `=`, `==`            | Purple (286¬∞)                     |
4827     -751     -     23 +| `variable`    | Variable names (special)   | Less/Bash variables                      | Blue (207¬∞)                       |
4828     -752     -     24 +| `constant`    | Constants                  | `PI`, `MAX_SIZE`, `stdout`               | Orange (29¬∞)                      |
4829     -753     -     25 +| `property`    | Object properties          | CSS properties, JSON keys                | Red (355¬∞)                        |
4830     -754     -     26 +| `punctuation` | Delimiters                 | `{`, `}`, `;`, `,`                       | Gray/White                        |
4831     -755     -     27 +| `comment`     | Code comments              | `// comment`, `/* block */`              | Muted gray (220¬∞, low saturation) |
4832     -    4077 +      3 +**Reviewer:** CodeBaseGPT (Senior SDE Persona)
4833     -    4078 +      4 +**Date:** 2025-12-09
4834     -    4079 +      5 +**File:** `src/js/services/MermaidService.js` (302 Lines)
4835     -    4080 +      6 +
4836     -    4081 +      7 +---
4837     -    4082 +      8 +
4838     -    4083 +      9 +## ‚ö†Ô∏è Issues & Observations
4839     -    4084 +     10 +
4840     -    4085 +     11 +### 1. ‚öôÔ∏è Massive Configuration Object (Line 96)
4841     -    4086 +     12 +```javascript
4842     -    4087 +     13 +themeVariables: { ... 100+ lines ... }
4843     -    4088 +     14 +```
4844     -    4089 +     15 +**Critique:** You are explicitly mapping every single Mermaid variable (60+) to your own CSS variables.
4845     -    4090 +     16 +- **Pros:** Total control over the look.
4846     -    4091 +     17 +- **Cons:** **High Coupling**. If Mermaid v12 changes its variable names (e.g., `primaryColor` -> `mainColor`), your integration breaks or looks wrong.
4847     -    4092 +     18 +- **Suggestion:** Consider whether mapped sets (Primary, Secondary, Tertiary) are sufficient, or if this granular control is truly business-critical.
4848     -    4093 +     19 +
4849     -    4094 +     20 +### 2. üî¢ Hardcoded Font configurations (Lines 99, 100)
4850     -    4095 +     21 +```javascript
4851     -    4096 +     22 +fontFamily: '-apple-system, ...',
4852     -    4097 +     23 +fontSize: '16px',
4853     -    4098 +     24 +```
4854     -    4099 +     25 +**Critique:** You are hardcoding fonts in JS.
4855     -    4100 +     26 +- **Issue:** If the user changes the font in `style.css`, the diagrams won't match the rest of the app.
4856     -    4101 +     27 +- **Fix:** Use `getCssVariable('--font-family')` and `getCssVariable('--font-size-base')`.
4857     -756 4102       28 +
4858     -757     -     29 +### Markup-Specific Tokens
4859     -    4103 +     29 +### 3. üìâ Missing Debounce/Cancellation
4860     -    4104 +     30 +**Critique:** `MermaidService.render` is async.
4861     -    4105 +     31 +- **Scenario:** User types fast. `render('id', 'graph TD...')` is called 5 times in 200ms.
4862     -    4106 +     32 +- **Result:** You might have 5 parallel rendering processes competing.
4863     -    4107 +     33 +- **Fix:** Implement a `Cancellation` mechanism or rely on the Controller to debounce calls (which `script.js` currently fails to do properly).
4864     -    4108 +     34 +
4865     -    4109 +     35 +### 4. üé≠ Theme Detection Logic (Line 45)
4866     -    4110 +     36 +```javascript
4867     -    4111 +     37 +function isLightTheme(bgColor) { ... }
4868     -    4112 +     38 +```
4869     -    4113 +     39 +**Critique:** Clever use of luminance calculation!
4870     -    4114 +     40 +- **Positive:** This is a nice "Senior Dev" touch. It ensures that even if I pick a weird Custom Theme color (e.g., bright yellow background), Mermaid will likely pick the correct "Dark/Light" base mode.
4871     -    4115 +     41 +- **Refactor:** Move `getRelativeLuminance` to `src/js/utils/colorHelpers.js`. It is a pure utility function and might be useful elsewhere (e.g., checking text contrast accessibility).
4872     -    4116 +     42 +
4873     -    4117 +     43 +---
4874     -    4118 +     44 +
4875     -    4119 +     45 +## üèÅ Verdict
4876     -    4120 +     46 +**Grade: B+**
4877     -    4121 +     47 +The logic is solid, but the coupling to Mermaid's specific variable names is a risk. It's "Enterprise Grade" in the sense that it handles everything, but "Enterprise Grade" also means "Heavy maintenance".
4878     -    4122 +     48  
4879     -    4123 +
4880     -    4124 +```
4881     -    4125 +
4882     -    4126 +
4883     -    4127 +### ‚ú® `codebase_audit/deep_dive_reviews/script_js_review.md` **[ADDED]**
4884     -    4128 +
4885     -    4129 +**Status:** ‚úÖ **NEW FILE** - This file has been newly created
4886     -    4130 +
4887     -    4131 +**Type:** Documentation üìñ
4888     -    4132 +
4889     -    4133 +```diff
4890     -    4134 +@@ -0,0 +1,121 @@
4891     -    4135 +      1 +# üïµÔ∏è‚Äç‚ôÇÔ∏è Deep Dive Code Review: `script.js`
4892     -    4136 +      2 +
4893     -    4137 +      3 +**Reviewer:** CodeBaseGPT (Senior SDE Persona)
4894     -    4138 +      4 +**Date:** 2025-12-09
4895     -    4139 +      5 +**File:** `script.js` (1372 Lines)
4896     -    4140 +      6 +
4897     -    4141 +      7 +---
4898     -    4142 +      8 +
4899     -    4143 +      9 +## üõë Critical Issues (Must Fix)
4900     -    4144 +     10 +
4901     -    4145 +     11 +### 1. üíÄ Stored XSS Vulnerability (Line 512)
4902     -    4146 +     12 +```javascript
4903     -    4147 +     13 +preview.innerHTML = html;
4904     -    4148 +     14 +```
4905     -    4149 +     15 +**Critique:** You are taking the output of `marked.parse()` and dumping it directly into the DOM. `marked` does **not** sanitize HTML execution by default.
4906     -    4150 +     16 +- **Scenario:** A user opens a markdown file containing `<img src=x onerror=alert(1)>`.
4907     -    4151 +     17 +- ** Impact:** Arbitrary code execution.
4908     -    4152 +     18 +- **Fix:** You **MUST** use `DOMPurify.sanitize(html)` before assignment.
4909     -    4153 +     19 +
4910     -    4154 +     20 +### 2. üê¢ recursive Polling for Dependencies (Lines 46-75)
4911     -    4155 +     21 +```javascript
4912     -    4156 +     22 +if (typeof marked === 'undefined' ...) {
4913     -    4157 +     23 +    setTimeout(initializeApp, 100);
4914     -    4158 +     24 +    return;
4915     -    4159 +     25 +}
4916     -    4160 +     26 +```
4917     -    4161 +     27 +**Critique:** This "check and retry" pattern is an anti-pattern.
4918     -    4162 +     28 +- **Why:** It burns CPU in a tight loop. It complicates the startup race conditions.
4919     -    4163 +     29 +- **Fix:** Use standard `<script defer>` or ES Module `import` statements to guarantee execution order. If you strictly need globals, use `window.onload`.
4920     -758 4164       30 +
4921     -759     -     31 +| Token Class  | Purpose             | Example                     |
4922     -760     -     32 +| ------------ | ------------------- | --------------------------- |
4923     -761     -     33 +| `tag`        | HTML/XML tags       | `<div>`, `<p>`              |
4924     -762     -     34 +| `attr-name`  | Attribute names     | `id`, `class`, `href`       |
4925     -763     -     35 +| `attr-value` | Attribute values    | `"header"`, `"https://..."` |
4926     -764     -     36 +| `namespace`  | XML namespaces      | `html:p`, `foo:bar`         |
4927     -765     -     37 +| `prolog`     | XML prolog          | `<?xml version="1.0"?>`     |
4928     -766     -     38 +| `doctype`    | DOCTYPE declaration | `<!DOCTYPE html>`           |
4929     -767     -     39 +| `cdata`      | CDATA sections      | `<![CDATA[...]]>`           |
4930     -768     -     40 +| `entity`     | HTML entities       | `&amp;`, `&#x2665;`         |
4931     -769     -     41 +
4932     -770     -     42 +### Document Markup Tokens
4933     -771     -     43 +
4934     -772     -     44 +| Token Class | Purpose         | Example      |
4935     -773     -     45 +| ----------- | --------------- | ------------ |
4936     -774     -     46 +| `bold`      | Bold text       | `**bold**`   |
4937     -775     -     47 +| `italic`    | Italic text     | `*italic*`   |
4938     -776     -     48 +| `important` | Important (CSS) | `!important` |
4939     -777     -     49 +
4940     -778     -     50 +### Stylesheet Tokens
4941     -779     -     51 +
4942     -780     -     52 +| Token Class | Purpose       | Example                  |
4943     -781     -     53 +| ----------- | ------------- | ------------------------ |
4944     -782     -     54 +| `atrule`    | CSS @ rules   | `@media`, `@import`      |
4945     -783     -     55 +| `selector`  | CSS selectors | `.class`, `#id`, `div p` |
4946     -784     -     56 +| `url`       | URLs          | `url(image.png)`         |
4947     -785     -     57 +
4948     -786     -     58 +### Diff Tokens
4949     -787     -     59 +
4950     -788     -     60 +| Token Class | Purpose       |
4951     -789     -     61 +| ----------- | ------------- |
4952     -790     -     62 +| `inserted`  | Added lines   |
4953     -791     -     63 +| `deleted`   | Removed lines |
4954     -792     -     64 +
4955     -793     -     65 +## Professional Theme Analysis (One Dark)
4956     -794     -     66 +
4957     -795     -     67 +### Color Grouping Strategy
4958     -796     -     68 +
4959     -797     -     69 +One Dark uses **7 core hues** systematically:
4960     -798     -     70 +
4961     -799     -     71 +1. **mono-1** (220¬∞, 14%, 71%) - Default text
4962     -800     -     72 +2. **mono-2** (220¬∞, 9%, 55%) - Secondary text
4963     -801     -     73 +3. **mono-3** (220¬∞, 10%, 40%) - Comments
4964     -802     -     74 +4. **hue-1** (187¬∞, 47%, 55%) - Cyan - URLs
4965     -803     -     75 +5. **hue-2** (207¬∞, 82%, 66%) - Blue - Variables, operators, functions
4966     -804     -     76 +6. **hue-3** (286¬∞, 60%, 67%) - Purple - Keywords
4967     -805     -     77 +7. **hue-4** (95¬∞, 38%, 62%) - Green - Strings
4968     -806     -     78 +8. **hue-5** (355¬∞, 65%, 65%) - Red - Properties, tags, symbols
4969     -807     -     79 +9. **hue-6** (29¬∞, 54%, 61%) - Orange - Class names, constants, numbers
4970     -808     -     80 +
4971     -809     -     81 +### Token Grouping
4972     -810     -     82 +
4973     -811     -     83 +```css
4974     -812     -     84 +/* Group 1: Comments */
4975     -813     -     85 +.token.comment, .token.prolog, .token.cdata
4976     -814     -     86 +
4977     -815     -     87 +/* Group 2: Neutral (inherit default color) */
4978     -816     -     88 +.token.doctype, .token.punctuation, .token.entity
4979     -817     -     89 +
4980     -818     -     90 +/* Group 3: Orange - Class names, constants, numbers */
4981     -819     -     91 +.token.attr-name, .token.class-name, .token.boolean,
4982     -820     -     92 +.token.constant, .token.number, .token.atrule
4983     -821     -     93 +
4984     -822     -     94 +/* Group 4: Purple - Keywords */
4985     -823     -     95 +.token.keyword
4986     -824     -     96 +
4987     -825     -     97 +/* Group 5: Red - Properties, tags */
4988     -826     -     98 +.token.property, .token.tag, .token.symbol,
4989     -827     -     99 +.token.deleted, .token.important
4990     -828     -    100 +
4991     -829     -    101 +/* Group 6: Green - Strings, builtins */
4992     -830     -    102 +.token.selector, .token.string, .token.char,
4993     -831     -    103 +.token.builtin, .token.inserted, .token.regex,
4994     -832     -    104 +.token.attr-value
4995     -833     -    105 +
4996     -834     -    106 +/* Group 7: Blue - Variables, operators, functions */
4997     -835     -    107 +.token.variable, .token.operator, .token.function
4998     -836     -    108 +
4999     -837     -    109 +/* Group 8: Cyan - URLs */
5000     -838     -    110 +.token.url
5001     -839     -    111 +```
5002     -840     -    112 +
5003     -841     -    113 +### Language-Specific Overrides
5004     -842     -    114 +
5005     -843     -    115 +Professional themes use **cascading specificity** for language-specific rules:
5006     -844     -    116 +
5007     -845     -    117 +```css
5008     -846     -    118 +/* JavaScript overrides */
5009     -847     -    119 +.language-javascript .token.operator { color: purple; }
5010     -848     -    120 +.language-javascript .token.template-string > .token.interpolation { ... }
5011     -849     -    121 +
5012     -850     -    122 +/* CSS overrides */
5013     -851     -    123 +.language-css .token.selector { color: red; }
5014     -852     -    124 +.language-css .token.property { color: gray; }
5015     -853     -    125 +
5016     -854     -    126 +/* JSON overrides */
5017     -855     -    127 +.language-json .token.null.keyword { color: orange; }
5018     -856     -    128 +
5019     -857     -    129 +/* Markdown overrides */
5020     -858     -    130 +.language-markdown .token.url { ... }
5021     -859     -    131 +```
5022     -860     -    132 +
5023     -861     -    133 +## Implementation Architecture
5024     -862     -    134 +
5025     -863     -    135 +### CSS Specificity Levels
5026     -864     -    136 +
5027     -865     -    137 +1. **Base tokens** - All languages
5028     -866     -    138 +2. **Language-specific overrides** - `.language-xxx .token.yyy`
5029     -867     -    139 +3. **Nested tokens** - `.token.xxx > .token.yyy`
5030     -868     -    140 +4. **Plugin overrides** - `.rainbow-braces`, `.diff-highlight`, etc.
5031     -869     -    141 +
5032     -870     -    142 +### Variable Mapping Strategy
5033     -871     -    143 +
5034     -872     -    144 +```css
5035     -873     -    145 +/* Map standard Prism tokens to theme CSS variables */
5036     -874     -    146 +.token.keyword {
5037     -875     -    147 +  color: var(--syntax-keyword);
5038     -876     -    148 +}
5039     -877     -    149 +.token.string {
5040     -878     -    150 +  color: var(--syntax-string);
5041     -879     -    151 +}
5042     -880     -    152 +.token.class-name {
5043     -881     -    153 +  color: var(--syntax-class-name); /* Distinct variable! */
5044     -882     -    154 +}
5045     -883     -    155 +```
5046     -884     -    156 +
5047     -885     -    157 +### Token Aliases
5048     -886     -    158 +
5049     -887     -    159 +Prism uses aliases to group similar tokens:
5050     -888     -    160 +
5051     -889     -    161 +- `attr-value` can contain nested `punctuation` tokens
5052     -890     -    162 +- `template-string` can contain `interpolation` with nested tokens
5053     -891     -    163 +- Language definitions use `alias` property to inherit styles
5054     -892     -    164 +
5055     -893     -    165 +## Best Practices
5056     -894     -    166 +
5057     -895     -    167 +1. **Use Distinct Variables** - Don't reuse variables across semantically different tokens
5058     -896     -    168 +2. **Follow Standards** - Match Prism's standard token names
5059     -897     -    169 +3. **Language Overrides** - Use when default grouping doesn't fit
5060     -898     -    170 +4. **Test Comprehensively** - Verify with multiple languages (Java, Python, JS, CSS, etc.)
5061     -899     -    171 +5. **Font Weight** - Use bold/normal strategically for visual hierarchy
5062     -900     -    172 +6. **Color Contrast** - Ensure WCAG AA compliance (4.5:1 for text)
5063     -901     -    173 +
5064     -902     -    174 +## Token Coverage Checklist
5065     -903     -    175 +
5066     -904     -    176 +### Must Cover (Core)
5067     -905     -    177 +
5068     -906     -    178 +- [ ] keyword
5069     -907     -    179 +- [ ] builtin
5070     -908     -    180 +- [ ] class-name (distinct from keyword!)
5071     -909     -    181 +- [ ] function
5072     -910     -    182 +- [ ] string
5073     -911     -    183 +- [ ] number
5074     -912     -    184 +- [ ] boolean
5075     -913     -    185 +- [ ] comment
5076     -914     -    186 +- [ ] operator
5077     -915     -    187 +- [ ] punctuation
5078     -916     -    188 +- [ ] variable
5079     -917     -    189 +- [ ] property
5080     -918     -    190 +- [ ] constant
5081     -919     -    191 +- [ ] regex
5082     -920     -    192 +
5083     -921     -    193 +### Markup Languages
5084     -922     -    194 +
5085     -923     -    195 +- [ ] tag
5086     -924     -    196 +- [ ] attr-name
5087     -925     -    197 +- [ ] attr-value
5088     -926     -    198 +- [ ] namespace
5089     -927     -    199 +- [ ] doctype
5090     -928     -    200 +- [ ] entity
5091     -929     -    201 +
5092     -930     -    202 +### Advanced
5093     -931     -    203 +
5094     -932     -    204 +- [ ] atrule (CSS)
5095     -933     -    205 +- [ ] selector (CSS)
5096     -934     -    206 +- [ ] url
5097     -935     -    207 +- [ ] inserted/deleted (Diff)
5098     -936     -    208 +- [ ] bold/italic (Markdown)
5099     -937     -    209 +- [ ] important (CSS)
5100     -938     -    210 +
5101     -939     -    211 +## Implementation Checklist
5102     -940     -    212 +
5103     -941     -    213 +- [ ] Define comprehensive CSS variable palette (8-10 distinct hues)
5104     -942     -    214 +- [ ] Map ALL standard tokens to variables
5105     -943     -    215 +- [ ] Add language-specific overrides where needed
5106     -944     -    216 +- [ ] Test with Java (most complex token usage)
5107     -945     -    217 +- [ ] Test with Python, JavaScript, CSS
5108     -946     -    218 +- [ ] Verify font-weight hierarchy
5109     -947     -    219 +- [ ] Check color contrast ratios
5110     -948     -    220 +- [ ] Document color semantics
5111     -949     -    221 +
5112     -950     -    222 +## References
5113     -951     -    223 +
5114     -952     -    224 +- [Prism Standard Tokens](https://prismjs.com/tokens.html)
5115     -953     -    225 +- [Prism Theme: One Dark](https://github.com/PrismJS/prism-themes/blob/master/themes/prism-one-dark.css)
5116     -954     -    226 +- [Atom One Dark Colors](https://github.com/atom/atom/tree/master/packages/one-dark-syntax)
5117     -955     -    227  
5118     -956     -
5119     -957     -```
5120     -958     -
5121     -959     -
5122     -960     -### üìÑ `script.js`
5123     -961     -
5124     -962     -**Type:** JavaScript Source File üü®
5125     -963     -
5126     -964     -```diff
5127     -965     -@@ -20,9 +20,20 @@ const folderBrowserService = new FolderBrowserService(storageManager);
5128     -966     - 20  20  const currentFolderFiles = [];
5129     -967     - 21  21  const currentFileHandle = null;
5130     -968     - 22  22  
5131     -969     - 23     -// Configure theme change listener to update Mermaid
5132     -970     -     23 +// Global render function reference (will be set in setupEditor)
5133     -971     -     24 +let globalRenderMarkdown = null;
5134     -972     -     25 +
5135     -973     -     26 +// Configure theme change listener to update Mermaid and force re-render
5136     -974     - 24  27  themeManager.setThemeChangeListener(() => {
5137     -975     - 25  28    mermaidService.reinitialize();
5138     -976     -     29 +
5139     -977     -     30 +  // Force re-render of markdown to apply new Mermaid colors
5140     -978     -     31 +  setTimeout(() => {
5141     -979     -     32 +    if (globalRenderMarkdown) {
5142     -980     -     33 +      console.log('üîÑ Re-rendering diagrams with new theme colors');
5143     -981     -     34 +      globalRenderMarkdown();
5144     -982     -     35 +    }
5145     -983     -     36 +  }, 200);
5146     -984     - 26  37  });
5147     -985     - 27  38  
5148     -986     - 28  39  // Wait for all scripts to load
5149     -987     -@@ -77,8 +88,8 @@ function initializeApp() {
5150     -988     - 77  88    // Configure marked.js extensions
5151     -989     - 78  89    configureMarkedExtensions();
5152     -990     - 79  90  
5153     -991     - 80     -  // Initialize Mermaid with theme-aware configuration
5154     -992     - 81     -  initMermaidTheme();
5155     -993     -     91 +  // DON'T initialize Mermaid here - let saved theme load first
5156     -994     -     92 +  // Mermaid will initialize after theme loads in setupEditor()
5157     -995     - 82  93  
5158     -996     - 83  94    setupEditor();
5159     -997     - 84  95  }
5160     -998     -@@ -461,7 +472,7 @@ graph TD
5161     -999     -461 472  
5162     -1000     -462 473    console.log('‚úÖ Subscript and superscript enabled (LaTeX environments display as-is)');
5163     -1001     -463 474  
5164     -1002     -464     -  // Render markdown
5165     -1003     -    475 +  // Render markdown (expose globally for theme changes)
5166     -1004     -465 476    function renderMarkdown() {
5167     -1005     -466 477      try {
5168     -1006     -467 478        const markdownText = editor.value;
5169     -1007     -@@ -520,8 +531,16 @@ graph TD
5170     -1008     -520 531    async function changeTheme(themeName) {
5171     -1009     -521 532      await themeManager.loadTheme(themeName);
5172     -1010     -522 533  
5173     -1011     -523     -    // Re-render to apply new Mermaid theme (observer already handles reinit)
5174     -1012     -    534 +    // Wait for theme to load, then reinitialize Mermaid and force re-render
5175     -1013     -524 535      setTimeout(() => {
5176     -1014     -    536 +      // Clear existing Mermaid diagrams to force fresh render with new colors
5177     -1015     -    537 +      const mermaidElements = preview.querySelectorAll('.mermaid');
5178     -1016     -    538 +      mermaidElements.forEach(el => {
5179     -1017     -    539 +        // Reset to original code to force re-render
5180     -1018     -    540 +        el.innerHTML = el.dataset.originalCode || '';
5181     -1019     -    541 +      });
5182     -1020     -    542 +
5183     -1021     -    543 +      // Re-render markdown with new theme
5184     -1022     -525 544        renderMarkdown();
5185     -1023     -526 545      }, 100);
5186     -1024     -527 546    }
5187     -1025     -@@ -969,24 +988,36 @@ graph TD
5188     -1026     -969 988    // Initialize visibility
5189     -1027     -970 989    updateSyncScrollVisibility();
5190     -1028     -971 990  
5191     -1029     -972     -  // Load saved theme using ThemeManager
5192     -1030     -    991 +  // Load saved theme FIRST, then initialize Mermaid with correct colors
5193     -1031     -973 992    const savedTheme = storageManager.get('selectedTheme');
5194     -1032     -974 993    if (savedTheme) {
5195     -1033     -975     -    // Load theme first, then sync dropdown only on success
5196     -1034     -    994 +    // Load theme first, then sync dropdown and reinit Mermaid
5197     -1035     -976 995      themeManager
5198     -1036     -977 996        .loadTheme(savedTheme)
5199     -1037     -978 997        .then(() => {
5200     -1038     -979 998          // Theme loaded successfully - sync dropdown
5201     -1039     -980 999          themeSelector.value = savedTheme;
5202     -1040     -981 1000          console.log(`‚úÖ Theme restored: ${savedTheme}`);
5203     -1041     -    1001 +
5204     -1042     -    1002 +        // NOW initialize Mermaid with correct theme colors
5205     -1043     -    1003 +        mermaidService.initialize();
5206     -1044     -    1004 +
5207     -1045     -    1005 +        // Re-render to apply theme
5208     -1046     -    1006 +        renderMarkdown();
5209     -1047     -982 1007        })
5210     -1048     -983 1008        .catch(err => {
5211     -1049     -984 1009          console.error('Failed to load saved theme:', err);
5212     -1050     -985 1010          // Fallback to default-light on error
5213     -1051     -986 1011          themeManager.loadTheme('default-light').then(() => {
5214     -1052     -987 1012            themeSelector.value = 'default-light';
5215     -1053     -    1013 +          mermaidService.initialize();
5216     -1054     -    1014 +          renderMarkdown();
5217     -1055     -988 1015          });
5218     -1056     -989 1016        });
5219     -1057     -    1017 +  } else {
5220     -1058     -    1018 +    // No saved theme - initialize with default-light
5221     -1059     -    1019 +    mermaidService.initialize();
5222     -1060     -    1020 +    renderMarkdown();
5223     -1061     -990 1021    }
5224     -1062     -991 1022  
5225     -1063     -992 1023    // Zoom functionality
5226     -1064     -@@ -1332,6 +1363,9 @@ graph TD
5227     -1065     -1332 1363      console.log(`‚úÖ Loaded file: ${fileItem.name} (${result.size} bytes)`);
5228     -1066     -1333 1364    }
5229     -1067     -1334 1365  
5230     -1068     -1335     -  // Initial render
5231     -1069     -1336     -  renderMarkdown();
5232     -1070     -    1366 +  // Expose renderMarkdown globally for theme changes
5233     -1071     -    1367 +  globalRenderMarkdown = renderMarkdown;
5234     -1072     -    1368 +
5235     -1073     -    1369 +  // DON'T render immediately - wait for theme to load
5236     -1074     -    1370 +  // renderMarkdown will be called after theme loads above
5237     -1075     -1337 1371  }
5238     -1076     -1338 1372  
5239     -1077     -
5240     -1078     -```
5241     -1079     -
5242     -1080     -
5243     -1081     -### üìÑ `src/js/services/MermaidService.js`
5244     -1082     -
5245     -1083     -**Type:** JavaScript Source File üü®
5246     -1084     -
5247     -1085     -```diff
5248     -1086     -@@ -2,12 +2,51 @@
5249     -1087     -  2   2   * MermaidService - Mermaid Diagram Rendering Service
5250     -1088     -  3   3   *
5251     -1089     -  4   4   * Handles all Mermaid diagram rendering with theme-aware configuration.
5252     -1090     -      5 + * Automatically detects light/dark themes and adjusts for optimal readability.
5253     -1091     -  5   6   * Isolated service for better testability and maintainability.
5254     -1092     -  6   7   */
5255     -1093     -  7   8  
5256     -1094     -  8   9  import { MERMAID_CONFIG } from '../config/constants.js';
5257     -1095     -  9  10  import { getCssVariable } from '../utils/colorHelpers.js';
5258     -1096     - 10  11  
5259     -1097     -     12 +/**
5260     -1098     -     13 + * Calculate relative luminance of a color
5261     -1099     -     14 + * Used to detect if theme is light or dark
5262     -1100     -     15 + *
5263     -1101     -     16 + * @param {string} color - Hex color (#rrggbb)
5264     -1102     -     17 + * @returns {number} Luminance value (0-1)
5265     -1103     -     18 + * @private
5266     -1104     -     19 + */
5267     -1105     -     20 +function getRelativeLuminance(color) {
5268     -1106     -     21 +  // Remove # if present
5269     -1107     -     22 +  const hex = color.replace('#', '');
5270     -1108     -     23 +
5271     -1109     -     24 +  // Convert to RGB
5272     -1110     -     25 +  const r = parseInt(hex.substr(0, 2), 16) / 255;
5273     -1111     -     26 +  const g = parseInt(hex.substr(2, 2), 16) / 255;
5274     -1112     -     27 +  const b = parseInt(hex.substr(4, 2), 16) / 255;
5275     -1113     -     28 +
5276     -1114     -     29 +  // Apply sRGB gamma correction
5277     -1115     -     30 +  const rsRGB = r <= 0.03928 ? r / 12.92 : ((r + 0.055) / 1.055) ** 2.4;
5278     -1116     -     31 +  const gsRGB = g <= 0.03928 ? g / 12.92 : ((g + 0.055) / 1.055) ** 2.4;
5279     -1117     -     32 +  const bsRGB = b <= 0.03928 ? b / 12.92 : ((b + 0.055) / 1.055) ** 2.4;
5280     -1118     -     33 +
5281     -1119     -     34 +  // Calculate relative luminance
5282     -1120     -     35 +  return 0.2126 * rsRGB + 0.7152 * gsRGB + 0.0722 * bsRGB;
5283     -1121     -     36 +}
5284     -1122     -     37 +
5285     -1123     -     38 +/**
5286     -1124     -     39 + * Detect if current theme is light or dark
5287     -1125     -     40 + *
5288     -1126     -     41 + * @param {string} bgColor - Background color
5289     -1127     -     42 + * @returns {boolean} True if light theme
5290     -1128     -     43 + * @private
5291     -1129     -     44 + */
5292     -1130     -     45 +function isLightTheme(bgColor) {
5293     -1131     -     46 +  const luminance = getRelativeLuminance(bgColor);
5294     -1132     -     47 +  return luminance > 0.5; // Threshold for light/dark
5295     -1133     -     48 +}
5296     -1134     -     49 +
5297     -1135     - 11  50  /**
5298     -1136     - 12  51   * @class MermaidService
5299     -1137     - 13  52   * @description Service for rendering Mermaid diagrams with theme integration
5300     -1138     -@@ -23,46 +62,187 @@ export class MermaidService {
5301     -1139     - 23  62    }
5302     -1140     - 24  63  
5303     -1141     - 25  64    /**
5304     -1142     - 26     -   * Initialize Mermaid with current theme colors
5305     -1143     - 27     -   * Extracts theme colors from CSS variables and configures Mermaid
5306     -1144     -     65 +   * Initialize Mermaid with COMPREHENSIVE theme configuration
5307     -1145     -     66 +   * Reads ALL 60+ variables from theme CSS with smart fallbacks
5308     -1146     -     67 +   * Based on official Mermaid.js theming documentation
5309     -1147     - 28  68     *
5310     -1148     - 29  69     * @returns {void}
5311     -1149     - 30  70     */
5312     -1150     - 31  71    initialize() {
5313     -1151     - 32     -    // Extract theme colors from CSS variables
5314     -1152     - 33     -    const h1Color = getCssVariable('--h1-color');
5315     -1153     - 34     -    const h2Color = getCssVariable('--h2-color');
5316     -1154     - 35     -    const h3Color = getCssVariable('--h3-color');
5317     -1155     - 36     -    const bgSecondary = getCssVariable('--bg-secondary');
5318     -1156     - 37     -    const textPrimary = getCssVariable('--text-primary');
5319     -1157     -     72 +    // Helper to get variable with fallback
5320     -1158     -     73 +    const get = (varName, fallback) => {
5321     -1159     -     74 +      const value = getCssVariable(varName);
5322     -1160     -     75 +      return value && value.trim() !== '' ? value : fallback;
5323     -1161     -     76 +    };
5324     -    4165 +     31 +### 3. üí• Race Condition "Magic Numbers" (Lines 490, 535)
5325     -    4166 +     32 +```javascript
5326     -    4167 +     33 +// Line 490
5327     -    4168 +     34 +setTimeout(() => { ... mermaid.render(...) }, 100);
5328     -    4169 +     35 +
5329     -    4170 +     36 +// Line 535
5330     -    4171 +     37 +setTimeout(() => { ... renderMarkdown() }, 100);
5331     -    4172 +     38 +```
5332     -    4173 +     39 +**Critique:** You are using `setTimeout` with a magic number (`100ms`) to "wait" for the DOM or other processes.
5333     -    4174 +     40 +- **Why:** This is unreliable. On a slow machine, 100ms isn't enough, and the render fails. On a fast machine, it causes a perceptible UI stutter.
5334     -    4175 +     41 +- **Fix:** Use **Promises** and `requestAnimationFrame`. `mermaid.render` returns a promise; await it.
5335     -    4176 +     42 +
5336     -    4177 +     43 +### 4. üî• Un-Debounced Rendering (Line 666)
5337     -    4178 +     44 +```javascript
5338     -    4179 +     45 +editor.addEventListener('input', renderMarkdown);
5339     -    4180 +     46 +```
5340     -    4181 +     47 +**Critique:** `renderMarkdown` is heavy (Regex + Parsing + DOM clear + Prism + Mermaid).
5341     -    4182 +     48 +- **Why:** Triggers on *every keystroke*. Typing fast will freeze the UI.
5342     -    4183 +     49 +- **Fix:** Wrap the handler in a `debounce` function (e.g., wait 300ms after last keystroke).
5343     -    4184 +     50 +
5344     -    4185 +     51 +---
5345     -    4186 +     52 +
5346     -    4187 +     53 +## ‚ö†Ô∏è Major Logic Flaws & Architecture
5347     -    4188 +     54 +
5348     -    4189 +     55 +### 5. üèóÔ∏è The "God Function": `setupEditor` (Lines 295-1372)
5349     -    4190 +     56 +**Critique:** This function is **1077 lines long**.
5350     -    4191 +     57 +- **Issue:** It contains state (`folderFiles`), event listeners, UI logic (`updatePDFPreview`), and utility helpers (`renderFileTree`).
5351     -    4192 +     58 +- **Impact:** It is effectively impossible to unit test. Scope pollution is rampant.
5352     -    4193 +     59 +- **Fix:** Break this file apart immediately.
5353     -    4194 +     60 +    - `setupEditor()` should only orchestrate.
5354     -    4195 +     61 +    - `setupPDFHandling()` should be its own module.
5355     -    4196 +     62 +    - `setupFolderBrowser()` should be its own module.
5356     -    4197 +     63 +
5357     -    4198 +     64 +### 6. üçù Spaghetti Events (Global Scope Pollution)
5358     -    4199 +     65 +```javascript
5359     -    4200 +     66 +let globalRenderMarkdown = null; // Line 24
5360     -    4201 +     67 +...
5361     -    4202 +     68 +globalRenderMarkdown = renderMarkdown; // Line 1367
5362     -    4203 +     69 +```
5363     -    4204 +     70 +**Critique:** You are leaking a local function to the global scope to hack around scope limitations for the theme manager callback.
5364     -    4205 +     71 +- **Fix:** Pass `renderMarkdown` as a dependency or use a proper `EventManager` (Pub/Sub pattern).
5365     -    4206 +     72 +
5366     -    4207 +     73 +### 7. üìÅ Hardcoded DOM Generation (Lines 1241-1334)
5367     -    4208 +     74 +**Critique:** The `renderFileTree` function essentially constructs a Virtual DOM manually using `document.createElement`.
5368     -    4209 +     75 +- **Issue:** This logic is mixed with the controller.
5369     -    4210 +     76 +- **Fix:** Move this to a `FileTreeView.js` class. The controller should just say `treeView.render(files)`.
5370     -1162 4211       77 +
5371     -1163     -     78 +    // Extract core theme colors for fallbacks
5372     -1164     -     79 +    const bgPri = getCssVariable('--bg-primary');
5373     -1165     -     80 +    const bgSec = getCssVariable('--bg-secondary');
5374     -1166     -     81 +    const bgTer = getCssVariable('--bg-tertiary');
5375     -1167     -     82 +    const txtPri = getCssVariable('--text-primary');
5376     -1168     -     83 +    const txtSec = getCssVariable('--text-secondary');
5377     -1169     -     84 +    const h1 = getCssVariable('--h1-color');
5378     -1170     -     85 +    const h2 = getCssVariable('--h2-color');
5379     -1171     -     86 +    const h3 = getCssVariable('--h3-color');
5380     -1172     -     87 +
5381     -1173     -     88 +    const isLight = isLightTheme(bgPri);
5382     -1174     -     89 +    const nodeBkg = isLight ? bgTer : bgSec;
5383     -1175     -     90 +    const clusterBkg = isLight ? bgSec : bgTer;
5384     -1176     - 38  91  
5385     -1177     - 39     -    // Configure Mermaid with theme colors
5386     -1178     - 40  92      if (typeof mermaid !== 'undefined') {
5387     -1179     - 41  93        mermaid.initialize({
5388     -1180     - 42  94          startOnLoad: MERMAID_CONFIG.START_ON_LOAD,
5389     -1181     - 43  95          theme: MERMAID_CONFIG.THEME,
5390     -1182     - 44  96          themeVariables: {
5391     -1183     - 45     -          primaryColor: bgSecondary,
5392     -1184     - 46     -          primaryTextColor: textPrimary,
5393     -1185     - 47     -          primaryBorderColor: h1Color,
5394     -1186     - 48     -          lineColor: h2Color,
5395     -1187     - 49     -          secondaryColor: bgSecondary,
5396     -1188     - 50     -          tertiaryColor: bgSecondary,
5397     -1189     - 51     -          background: bgSecondary,
5398     -1190     - 52     -          mainBkg: bgSecondary,
5399     -1191     - 53     -          secondBkg: bgSecondary,
5400     -1192     - 54     -          tertiaryBkg: bgSecondary,
5401     -1193     - 55     -          nodeBorder: h1Color,
5402     -1194     - 56     -          clusterBkg: bgSecondary,
5403     -1195     - 57     -          clusterBorder: h3Color,
5404     -1196     - 58     -          titleColor: textPrimary,
5405     -1197     - 59     -          edgeLabelBackground: bgSecondary,
5406     -1198     - 60     -          nodeTextColor: textPrimary,
5407     -1199     -     97 +          // Core Global
5408     -1200     -     98 +          background: get('--mermaid-background', bgPri),
5409     -1201     - 61  99            fontFamily: '-apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif',
5410     -1202     -    100 +          fontSize: '16px',
5411     -1203     -    101 +          darkMode: !isLight,
5412     -1204     -    102 +          textColor: get('--mermaid-text-color', txtPri),
5413     -1205     -    103 +          lineColor: get('--mermaid-line-color', h2),
5414     -1206     -    104 +          mainBkg: get('--mermaid-main-bkg', nodeBkg),
5415     -1207     -    105 +
5416     -1208     -    106 +          // Primary Set
5417     -1209     -    107 +          primaryColor: get('--mermaid-primary-color', nodeBkg),
5418     -1210     -    108 +          primaryTextColor: get('--mermaid-primary-text-color', txtPri),
5419     -1211     -    109 +          primaryBorderColor: get('--mermaid-primary-border-color', h1),
5420     -1212     -    110 +
5421     -1213     -    111 +          // Secondary Set
5422     -1214     -    112 +          secondaryColor: get('--mermaid-secondary-color', clusterBkg),
5423     -1215     -    113 +          secondaryTextColor: get('--mermaid-secondary-text-color', txtPri),
5424     -1216     -    114 +          secondaryBorderColor: get('--mermaid-secondary-border-color', h2),
5425     -1217     -    115 +
5426     -1218     -    116 +          // Tertiary Set
5427     -1219     -    117 +          tertiaryColor: get('--mermaid-tertiary-color', bgPri),
5428     -1220     -    118 +          tertiaryTextColor: get('--mermaid-tertiary-text-color', txtPri),
5429     -1221     -    119 +          tertiaryBorderColor: get('--mermaid-tertiary-border-color', h3),
5430     -1222     -    120 +
5431     -1223     -    121 +          // Flowchart
5432     -1224     -    122 +          nodeBorder: get('--mermaid-node-border', h1),
5433     -1225     -    123 +          clusterBkg: get('--mermaid-cluster-bkg', clusterBkg),
5434     -1226     -    124 +          clusterBorder: get('--mermaid-cluster-border', h2),
5435     -1227     -    125 +          defaultLinkColor: get('--mermaid-default-link-color', h2),
5436     -1228     -    126 +          titleColor: get('--mermaid-title-color', txtPri),
5437     -1229     -    127 +          edgeLabelBackground: get('--mermaid-edge-label-background', bgPri),
5438     -1230     -    128 +          nodeTextColor: get('--mermaid-node-text-color', txtPri),
5439     -1231     -    129 +
5440     -1232     -    130 +          // Sequence Diagram
5441     -1233     -    131 +          actorBkg: get('--mermaid-actor-bkg', nodeBkg),
5442     -1234     -    132 +          actorBorder: get('--mermaid-actor-border', h1),
5443     -1235     -    133 +          actorTextColor: get('--mermaid-actor-text-color', txtPri),
5444     -1236     -    134 +          actorLineColor: get('--mermaid-actor-line-color', h1),
5445     -1237     -    135 +          signalColor: get('--mermaid-signal-color', h2),
5446     -1238     -    136 +          signalTextColor: get('--mermaid-signal-text-color', txtPri),
5447     -1239     -    137 +          labelBoxBkgColor: get('--mermaid-label-box-bkg-color', nodeBkg),
5448     -1240     -    138 +          labelBoxBorderColor: get('--mermaid-label-box-border-color', h1),
5449     -1241     -    139 +          labelTextColor: get('--mermaid-label-text-color', txtPri),
5450     -1242     -    140 +          loopTextColor: get('--mermaid-loop-text-color', txtPri),
5451     -1243     -    141 +          activationBorderColor: get('--mermaid-activation-border-color', h2),
5452     -1244     -    142 +          activationBkgColor: get('--mermaid-activation-bkg-color', clusterBkg),
5453     -1245     -    143 +          sequenceNumberColor: get('--mermaid-sequence-number-color', txtPri),
5454     -1246     -    144 +
5455     -1247     -    145 +          // Pie Chart
5456     -1248     -    146 +          pie1: get('--mermaid-pie1', h1),
5457     -1249     -    147 +          pie2: get('--mermaid-pie2', h2),
5458     -1250     -    148 +          pie3: get('--mermaid-pie3', h3),
5459     -1251     -    149 +          pie4: get('--mermaid-pie4', txtSec),
5460     -1252     -    150 +          pie5: get('--mermaid-pie5', h1),
5461     -1253     -    151 +          pie6: get('--mermaid-pie6', h2),
5462     -1254     -    152 +          pie7: get('--mermaid-pie7', h3),
5463     -1255     -    153 +          pie8: get('--mermaid-pie8', txtSec),
5464     -1256     -    154 +          pie9: get('--mermaid-pie9', h1),
5465     -1257     -    155 +          pie10: get('--mermaid-pie10', h2),
5466     -1258     -    156 +          pie11: get('--mermaid-pie11', h3),
5467     -1259     -    157 +          pie12: get('--mermaid-pie12', txtSec),
5468     -1260     -    158 +          pieTitleTextSize: '25px',
5469     -1261     -    159 +          pieTitleTextColor: get('--mermaid-pie-title-text-color', txtPri),
5470     -1262     -    160 +          pieSectionTextSize: '17px',
5471     -1263     -    161 +          pieSectionTextColor: get('--mermaid-pie-section-text-color', bgPri),
5472     -1264     -    162 +          pieLegendTextSize: '17px',
5473     -1265     -    163 +          pieLegendTextColor: get('--mermaid-pie-legend-text-color', txtPri),
5474     -1266     -    164 +          pieStrokeColor: get('--mermaid-pie-stroke-color', h1),
5475     -1267     -    165 +          pieStrokeWidth: '2px',
5476     -1268     -    166 +          pieOuterStrokeWidth: '2px',
5477     -1269     -    167 +          pieOuterStrokeColor: get('--mermaid-pie-outer-stroke-color', h1),
5478     -1270     -    168 +          pieOpacity: '0.9',
5479     -1271     -    169 +
5480     -1272     -    170 +          // State Diagram
5481     -1273     -    171 +          labelColor: get('--mermaid-label-color', txtPri),
5482     -1274     -    172 +          altBackground: get('--mermaid-alt-background', clusterBkg),
5483     -1275     -    173 +
5484     -1276     -    174 +          // Class Diagram
5485     -1277     -    175 +          classText: get('--mermaid-class-text', txtPri),
5486     -1278     -    176 +
5487     -1279     -    177 +          // User Journey
5488     -1280     -    178 +          fillType0: get('--mermaid-fill-type0', h1),
5489     -1281     -    179 +          fillType1: get('--mermaid-fill-type1', h2),
5490     -1282     -    180 +          fillType2: get('--mermaid-fill-type2', h3),
5491     -1283     -    181 +          fillType3: get('--mermaid-fill-type3', txtSec),
5492     -1284     -    182 +          fillType4: get('--mermaid-fill-type4', h1),
5493     -1285     -    183 +          fillType5: get('--mermaid-fill-type5', h2),
5494     -1286     -    184 +          fillType6: get('--mermaid-fill-type6', h3),
5495     -1287     -    185 +          fillType7: get('--mermaid-fill-type7', txtSec),
5496     -1288     -    186 +
5497     -1289     -    187 +          // Gantt Chart
5498     -1290     -    188 +          sectionBkgColor: get('--mermaid-section-bkg-color', bgSec),
5499     -1291     -    189 +          altSectionBkgColor: get('--mermaid-alt-section-bkg-color', bgTer),
5500     -1292     -    190 +          sectionBkgColor2: get('--mermaid-section-bkg-color2', bgSec),
5501     -1293     -    191 +          taskTextColor: get('--mermaid-task-text-color', txtPri),
5502     -1294     -    192 +          taskTextLightColor: get('--mermaid-task-text-light-color', txtPri),
5503     -1295     -    193 +          taskTextOutsideColor: get('--mermaid-task-text-outside-color', txtPri),
5504     -1296     -    194 +          taskTextClickableColor: get('--mermaid-task-text-clickable-color', h1),
5505     -1297     -    195 +          activeTaskBkgColor: get('--mermaid-active-task-bkg-color', h1),
5506     -1298     -    196 +          activeTaskBorderColor: get('--mermaid-active-task-border-color', h1),
5507     -1299     -    197 +          doneTaskBkgColor: get('--mermaid-done-task-bkg-color', h3),
5508     -1300     -    198 +          doneTaskBorderColor: get('--mermaid-done-task-border-color', h3),
5509     -1301     -    199 +          critBorderColor: get('--mermaid-crit-border-color', h2),
5510     -1302     -    200 +          critBkgColor: get('--mermaid-crit-bkg-color', h2),
5511     -1303     -    201 +          todayLineColor: get('--mermaid-today-line-color', h2),
5512     -1304     -    202 +          gridColor: get('--mermaid-grid-color', bgTer),
5513     -1305     -    203 +          sectionTextColor: get('--mermaid-section-text-color', txtPri),
5514     -1306     -    204 +          taskBorderColor: get('--mermaid-task-border-color', h1),
5515     -1307     -    205 +
5516     -1308     -    206 +          // ER Diagram
5517     -1309     -    207 +          attributeBackgroundColorOdd: get('--mermaid-attribute-background-color-odd', bgSec),
5518     -1310     -    208 +          attributeBackgroundColorEven: get('--mermaid-attribute-background-color-even', bgPri),
5519     -1311     -    209 +          relationshipLabelBackground: get('--mermaid-relationship-label-background', bgPri),
5520     -1312     -    210 +          relationshipLabelColor: get('--mermaid-relationship-label-color', txtPri),
5521     -1313     -    211 +          entityBackground: get('--mermaid-entity-background', nodeBkg),
5522     -1314     -    212 +          entityBorderColor: get('--mermaid-entity-border-color', h1),
5523     -1315     -    213 +
5524     -1316     -    214 +          // Git Graph
5525     -1317     -    215 +          git0: get('--mermaid-git0', h1),
5526     -1318     -    216 +          git1: get('--mermaid-git1', h2),
5527     -1319     -    217 +          git2: get('--mermaid-git2', h3),
5528     -1320     -    218 +          git3: get('--mermaid-git3', txtSec),
5529     -1321     -    219 +          git4: get('--mermaid-git4', h1),
5530     -1322     -    220 +          git5: get('--mermaid-git5', h2),
5531     -1323     -    221 +          git6: get('--mermaid-git6', h3),
5532     -1324     -    222 +          git7: get('--mermaid-git7', txtSec),
5533     -1325     -    223 +          gitInv0: get('--mermaid-git-inv0', bgPri),
5534     -1326     -    224 +          gitBranchLabel0: get('--mermaid-git-branch-label0', txtPri),
5535     -1327     -    225 +          gitBranchLabel1: get('--mermaid-git-branch-label1', txtPri),
5536     -1328     -    226 +          gitBranchLabel2: get('--mermaid-git-branch-label2', txtPri),
5537     -1329     -    227 +          gitBranchLabel3: get('--mermaid-git-branch-label3', txtPri),
5538     -1330     -    228 +          gitBranchLabel4: get('--mermaid-git-branch-label4', txtPri),
5539     -1331     -    229 +          commitLabelColor: get('--mermaid-commit-label-color', txtPri),
5540     -1332     -    230 +          commitLabelBackground: get('--mermaid-commit-label-background', bgPri),
5541     -1333     -    231 +          tagLabelColor: get('--mermaid-tag-label-color', txtPri),
5542     -1334     -    232 +          tagLabelBackground: get('--mermaid-tag-label-background', nodeBkg),
5543     -1335     -    233 +          tagLabelBorder: get('--mermaid-tag-label-border', h1),
5544     -1336     - 62 234          },
5545     -1337     - 63 235        });
5546     -1338     - 64 236  
5547     -1339     - 65 237        this.initialized = true;
5548     -1340     -    238 +
5549     -1341     -    239 +      // Debug: Log sample of loaded variables
5550     -1342     -    240 +      console.log(`‚úÖ Mermaid initialized`);
5551     -1343     -    241 +      console.log(`  - Background: ${get('--mermaid-background', bgPri)}`);
5552     -1344     -    242 +      console.log(`  - Text: ${get('--mermaid-text-color', txtPri)}`);
5553     -1345     -    243 +      console.log(`  - Line: ${get('--mermaid-line-color', h2)}`);
5554     -1346     -    244 +      console.log(`  - Primary: ${get('--mermaid-primary-color', nodeBkg)}`);
5555     -1347     -    245 +      console.log(`  - Pie1: ${get('--mermaid-pie1', h1)}`);
5556     -1348     - 66 246      } else {
5557     -1349     - 67 247        console.warn('Mermaid library not loaded');
5558     -1350     - 68 248      }
5559     -1351     - 69 249  
5560     -1352     -
5561     -1353     -```
5562     -1354     -
5563     -1355     -
5564     -1356     -### üìÑ `style.css`
5565     -1357     -
5566     -1358     -**Type:** Stylesheet üé®
5567     -1359     -
5568     -1360     -```diff
5569     -1361     -@@ -297,68 +297,119 @@ body {
5570     -1362     -297 297    padding: 0;
5571     -1363     -298 298  }
5572     -1364     -299 299  
5573     -1365     -300     -/* Syntax Highlighting with Custom Variables - Comprehensive Token Coverage */
5574     -1366     -301     -#markdown-preview .token.keyword {
5575     -1367     -302     -  color: var(--syntax-keyword, #c792ea) !important;
5576     -1368     -    300 +/* ==================== PRISM SYNTAX HIGHLIGHTING - PRODUCTION GRADE ==================== */
5577     -1369     -    301 +/* Based on One Dark theme architecture - comprehensive token coverage */
5578     -1370     -    302 +
5579     -1371     -    303 +/* Group 1: Comments and documentation */
5580     -1372     -    304 +#markdown-preview .token.comment,
5581     -1373     -    305 +#markdown-preview .token.prolog,
5582     -1374     -    306 +#markdown-preview .token.cdata {
5583     -1375     -    307 +  color: var(--syntax-comment, #7f85a3);
5584     -1376     -    308 +  font-style: italic;
5585     -1377     -303 309  }
5586     -1378     -304 310  
5587     -1379     -305     -#markdown-preview .token.string {
5588     -1380     -306     -  color: var(--syntax-string, #a5e844) !important;
5589     -1381     -307     -}
5590     -1382     -308     -
5591     -1383     -309     -#markdown-preview .token.number,
5592     -1384     -310     -#markdown-preview .token.boolean {
5593     -1385     -311     -  color: var(--syntax-number, #ffcb6b) !important;
5594     -1386     -312     -}
5595     -1387     -313     -
5596     -1388     -314     -#markdown-preview .token.function,
5597     -1389     -315     -#markdown-preview .token.function-variable,
5598     -1390     -316     -#markdown-preview .token.method,
5599     -1391     -317     -#markdown-preview .token.method-variable {
5600     -1392     -318     -  color: var(--syntax-function, #82aaff) !important;
5601     -1393     -319     -  font-weight: 600;
5602     -1394     -320     -}
5603     -1395     -321     -
5604     -1396     -322     -#markdown-preview .token.comment {
5605     -1397     -323     -  color: var(--syntax-comment, #7f85a3) !important;
5606     -1398     -324     -}
5607     -1399     -325     -
5608     -1400     -326     -#markdown-preview .token.operator {
5609     -1401     -327     -  color: var(--syntax-operator, #89ddff) !important;
5610     -1402     -328     -}
5611     -1403     -329     -
5612     -1404     -330     -#markdown-preview .token.punctuation {
5613     -1405     -331     -  color: var(--syntax-punctuation, #89ddff) !important;
5614     -1406     -    311 +/* Group 2: Neutral tokens (inherit or subtle) */
5615     -1407     -    312 +#markdown-preview .token.doctype,
5616     -1408     -    313 +#markdown-preview .token.punctuation,
5617     -1409     -    314 +#markdown-preview .token.entity {
5618     -1410     -    315 +  color: var(--syntax-punctuation, #64748b);
5619     -1411     -332 316  }
5620     -1412     -333 317  
5621     -1413     -    318 +/* Group 3: Orange hue - Class names, constants, numbers, booleans, atrules */
5622     -1414     -    319 +#markdown-preview .token.attr-name,
5623     -1415     -334 320  #markdown-preview .token.class-name,
5624     -1416     -335     -#markdown-preview .token.type-class-name {
5625     -1417     -336     -  color: var(--syntax-keyword, #ffcb6b) !important;
5626     -1418     -    321 +#markdown-preview .token.boolean,
5627     -1419     -    322 +#markdown-preview .token.constant,
5628     -1420     -    323 +#markdown-preview .token.number,
5629     -1421     -    324 +#markdown-preview .token.atrule {
5630     -1422     -    325 +  color: var(--syntax-class-name, #f97316);
5631     -1423     -337 326    font-weight: 600;
5632     -1424     -338 327  }
5633     -1425     -339 328  
5634     -1426     -340     -/* Variables and Parameters - NEW */
5635     -1427     -341     -#markdown-preview .token.parameter,
5636     -1428     -342     -#markdown-preview .token.variable,
5637     -1429     -343     -#markdown-preview .token.plain {
5638     -1430     -344     -  color: var(--syntax-variable, var(--text-primary)) !important;
5639     -1431     -345     -  font-weight: 500;
5640     -1432     -    329 +/* Group 4: Purple hue - Keywords (distinct from class names!) */
5641     -1433     -    330 +#markdown-preview .token.keyword {
5642     -1434     -    331 +  color: var(--syntax-keyword, #a855f7);
5643     -1435     -    332 +  font-weight: 700;
5644     -1436     -346 333  }
5645     -1437     -347 334  
5646     -1438     -348     -/* Properties and Namespaces - NEW */
5647     -1439     -    335 +/* Group 5: Red hue - Properties, tags, symbols, deleted, important */
5648     -1440     -349 336  #markdown-preview .token.property,
5649     -1441     -350     -#markdown-preview .token.property-access {
5650     -1442     -351     -  color: var(--syntax-property, var(--syntax-function)) !important;
5651     -1443     -    337 +#markdown-preview .token.tag,
5652     -1444     -    338 +#markdown-preview .token.symbol,
5653     -1445     -    339 +#markdown-preview .token.deleted,
5654     -1446     -    340 +#markdown-preview .token.important {
5655     -1447     -    341 +  color: var(--syntax-property, #ef4444);
5656     -1448     -    342 +  font-weight: 600;
5657     -1449     -352 343  }
5658     -1450     -353 344  
5659     -1451     -    345 +/* Group 6: Green hue - Strings, chars, builtins, inserted, regex, selectors */
5660     -1452     -    346 +#markdown-preview .token.selector,
5661     -1453     -    347 +#markdown-preview .token.string,
5662     -1454     -    348 +#markdown-preview .token.char,
5663     -1455     -    349 +#markdown-preview .token.builtin,
5664     -1456     -    350 +#markdown-preview .token.inserted,
5665     -1457     -    351 +#markdown-preview .token.regex,
5666     -1458     -    352 +#markdown-preview .token.attr-value {
5667     -1459     -    353 +  color: var(--syntax-string, #10b981);
5668     -1460     -    354 +}
5669     -1461     -    355 +
5670     -1462     -    356 +/* Nested attr-value punctuation (quotes) */
5671     -1463     -    357 +#markdown-preview .token.attr-value > .token.punctuation {
5672     -1464     -    358 +  color: var(--syntax-string, #10b981);
5673     -1465     -    359 +}
5674     -1466     -    360 +
5675     -1467     -    361 +/* Group 7: Blue hue - Variables, operators, functions */
5676     -1468     -    362 +#markdown-preview .token.variable,
5677     -1469     -    363 +#markdown-preview .token.operator,
5678     -1470     -    364 +#markdown-preview .token.function {
5679     -1471     -    365 +  color: var(--syntax-function, #3b82f6);
5680     -1472     -    366 +  font-weight: 600;
5681     -1473     -    367 +}
5682     -1474     -    368 +
5683     -1475     -    369 +/* Group 8: Cyan hue - URLs */
5684     -1476     -    370 +#markdown-preview .token.url {
5685     -1477     -    371 +  color: var(--syntax-url, #14b8a6);
5686     -1478     -    372 +}
5687     -1479     -    373 +
5688     -1480     -    374 +/* ==================== LANGUAGE-SPECIFIC OVERRIDES ==================== */
5689     -1481     -    375 +
5690     -1482     -    376 +/* JavaScript overrides */
5691     -1483     -    377 +#markdown-preview .language-javascript .token.operator {
5692     -1484     -    378 +  color: var(--syntax-keyword, #a855f7);
5693     -1485     -    379 +}
5694     -1486     -    380 +
5695     -1487     -    381 +/* CSS overrides */
5696     -1488     -    382 +#markdown-preview .language-css .token.selector {
5697     -1489     -    383 +  color: var(--syntax-property, #ef4444);
5698     -1490     -    384 +}
5699     -1491     -    385 +
5700     -1492     -    386 +#markdown-preview .language-css .token.property {
5701     -1493     -    387 +  color: var(--text-primary);
5702     -1494     -    388 +}
5703     -1495     -    389 +
5704     -1496     -    390 +/* JSON overrides */
5705     -1497     -    391 +#markdown-preview .language-json .token.operator {
5706     -1498     -    392 +  color: var(--syntax-punctuation, #64748b);
5707     -1499     -    393 +}
5708     -1500     -    394 +
5709     -1501     -    395 +#markdown-preview .language-json .token.null.keyword {
5710     -1502     -    396 +  color: var(--syntax-number, #fb923c);
5711     -1503     -    397 +}
5712     -1504     -    398 +
5713     -1505     -    399 +/* ==================== VISUAL ENHANCEMENTS ==================== */
5714     -1506     -    400 +
5715     -1507     -    401 +/* Bold/italic styling */
5716     -1508     -    402 +#markdown-preview .token.bold {
5717     -1509     -    403 +  font-weight: bold;
5718     -1510     -    404 +}
5719     -1511     -    405 +
5720     -1512     -    406 +#markdown-preview .token.italic {
5721     -1513     -    407 +  font-style: italic;
5722     -1514     -    408 +}
5723     -1515     -    409 +
5724     -1516     -    410 +/* Namespace opacity */
5725     -1517     -354 411  #markdown-preview .token.namespace {
5726     -1518     -355     -  color: var(--syntax-namespace, var(--syntax-keyword)) !important;
5727     -1519     -356     -  font-weight: 500;
5728     -1520     -357     -}
5729     -1521     -358     -
5730     -1522     -359     -#markdown-preview .token.builtin {
5731     -1523     -360     -  color: var(--syntax-builtin, var(--syntax-function)) !important;
5732     -1524     -361     -  font-weight: 500;
5733     -1525     -    412 +  opacity: 0.8;
5734     -1526     -362 413  }
5735     -1527     -363 414  
5736     -1528     -364 415  #markdown-preview blockquote {
5737     -1529     -365 416  
5738     -1530     -
5739     -1531     -```
5740     -1532     -
5741     -1533     -
5742     -1534     -### üìÑ `themes/default-dark.css`
5743     -1535     -
5744     -1536     -**Type:** Stylesheet üé®
5745     -1537     -
5746     -1538     -```diff
5747     -1539     -@@ -26,24 +26,184 @@
5748     -1540     - 26  26    --code-block-bg: #0d1117;
5749     -1541     - 27  27    --code-border: #30363d;
5750     -1542     - 28  28  
5751     -1543     - 29     -  /* Syntax Highlighting */
5752     -1544     - 30     -  --syntax-keyword: #ff7b72;
5753     -1545     - 31     -  --syntax-string: #a5e844;
5754     -1546     - 32     -  --syntax-number: #79c0ff;
5755     -1547     - 33     -  --syntax-function: #d2a8ff;
5756     -1548     - 34     -  --syntax-comment: #8b949e;
5757     -1549     - 35     -  --syntax-operator: #ff7b72;
5758     -1550     - 36     -  --syntax-punctuation: #7d8590;
5759     -1551     -     29 +  /* Syntax Highlighting - Production-Grade Token Colors (One Dark Architecture) */
5760     -1552     - 37  30  
5761     -1553     - 38     -  /* Additional Token Types */
5762     -1554     - 39     -  --syntax-variable: #79c0ff; /* Variables - blue (distinct from text #e6edf3) */
5763     -1555     - 40     -  --syntax-property: #d2a8ff; /* Properties - purple */
5764     -1556     - 41     -  --syntax-namespace: #ff7b72; /* Namespaces - red */
5765     -1557     - 42     -  --syntax-builtin: #d2a8ff; /* Builtins - purple */
5766     -1558     -     31 +  /* Core hue-1: Cyan - URLs */
5767     -1559     -     32 +  --syntax-url: #56d4dd; /* Cyan for URLs */
5768     -1560     -     33 +
5769     -1561     -     34 +  /* Core hue-2: Blue - Functions, variables */
5770     -1562     -     35 +  --syntax-function: #d2a8ff; /* Purple for functions */
5771     -1563     -     36 +  --syntax-variable: #79c0ff; /* Bright blue for variables */
5772     -1564     -     37 +
5773     -1565     -     38 +  /* Core hue-3: Red - Keywords */
5774     -1566     -     39 +  --syntax-keyword: #ff7b72; /* Coral red for keywords (final, sealed, class) */
5775     -1567     -     40 +
5776     -1568     -     41 +  /* Core hue-4: Green - Strings, builtins */
5777     -1569     -     42 +  --syntax-string: #a5d6ff; /* Light blue-green for strings */
5778     -1570     -     43 +  --syntax-builtin: #7ee787; /* Vibrant green for builtins (String, List) */
5779     -1571     -     44 +  --syntax-char: #a5d6ff; /* Same as strings */
5780     -1572     -     45 +  --syntax-regex: #a5d6ff; /* Same as strings */
5781     -1573     -     46 +  --syntax-inserted: #7ee787; /* For diff */
5782     -1574     -     47 +
5783     -1575     -     48 +  /* Core hue-5: Orange - Properties, tags */
5784     -1576     -     49 +  --syntax-property: #ffa657; /* Orange for properties */
5785     -1577     -     50 +  --syntax-tag: #ff7b72; /* Coral for tags */
5786     -1578     -     51 +  --syntax-deleted: #ff7b72; /* For diff */
5787     -1579     -     52 +  --syntax-important: #ffa657; /* For !important */
5788     -1580     -     53 +
5789     -1581     -     54 +  /* Core hue-6: Yellow - Class names, constants, numbers */
5790     -1582     -     55 +  --syntax-class-name: #ffa657; /* Orange for class names (Rectangle, Shape) */
5791     -1583     -     56 +  --syntax-number: #79c0ff; /* Blue for numbers */
5792     -1584     -     57 +  --syntax-constant: #79c0ff; /* Blue for constants */
5793     -1585     -     58 +  --syntax-boolean: #79c0ff; /* Same as numbers */
5794     -1586     -     59 +  --syntax-atrule: #d2a8ff; /* Purple for CSS @ rules */
5795     -1587     -     60 +
5796     -1588     -     61 +  /* Neutral colors */
5797     -1589     -     62 +  --syntax-comment: #8b949e; /* Gray for comments */
5798     -1590     -     63 +  --syntax-punctuation: #7d8590; /* Muted gray for punctuation */
5799     -1591     -     64 +  --syntax-operator: #ff7b72; /* Coral for operators */
5800     -1592     -     65 +
5801     -1593     -     66 +  /* Markup specific */
5802     -1594     -     67 +  --syntax-attr-name: #ffa657; /* Orange like class-name */
5803     -1595     -     68 +  --syntax-attr-value: #a5d6ff; /* Light blue like strings */
5804     -1596     -     69 +  --syntax-namespace: #d2a8ff; /* Purple */
5805     -1597     -     70 +  --syntax-entity: #7d8590; /* Neutral */
5806     -1598     -     71 +  --syntax-selector: #ffa657; /* Orange like properties */
5807     -1599     - 43  72  
5808     -1600     - 44  73    --blockquote-border: #bc8cff;
5809     -1601     - 45  74    --blockquote-bg: #161b22;
5810     -1602     - 46  75  
5811     -1603     - 47  76    --table-header-bg: #21262d;
5812     -1604     - 48  77    --table-border: #30363d;
5813     -1605     -     78 +
5814     -1606     -     79 +  /* === MERMAID COMPREHENSIVE CONFIGURATION === */
5815     -1607     -     80 +
5816     -1608     -     81 +  /* Core Global */
5817     -1609     -     82 +  --mermaid-background: #0d1117;
5818     -1610     -     83 +  --mermaid-text-color: #e6edf3;
5819     -1611     -     84 +  --mermaid-line-color: #58a6ff;
5820     -1612     -     85 +  --mermaid-main-bkg: #1c2128;
5821     -1613     -     86 +
5822     -1614     -     87 +  /* Primary Set - Main nodes/boxes */
5823     -1615     -     88 +  --mermaid-primary-color: #1c2128;
5824     -1616     -     89 +  --mermaid-primary-text-color: #e6edf3;
5825     -1617     -     90 +  --mermaid-primary-border-color: #58a6ff;
5826     -1618     -     91 +
5827     -1619     -     92 +  /* Secondary Set - Clusters/subgraphs */
5828     -1620     -     93 +  --mermaid-secondary-color: #161b22;
5829     -1621     -     94 +  --mermaid-secondary-text-color: #e6edf3;
5830     -1622     -     95 +  --mermaid-secondary-border-color: #bc8cff;
5831     -1623     -     96 +
5832     -1624     -     97 +  /* Tertiary Set - Edge labels */
5833     -1625     -     98 +  --mermaid-tertiary-color: #0d1117;
5834     -1626     -     99 +  --mermaid-tertiary-text-color: #e6edf3;
5835     -1627     -    100 +  --mermaid-tertiary-border-color: #ff7b72;
5836     -1628     -    101 +
5837     -1629     -    102 +  /* Flowchart */
5838     -1630     -    103 +  --mermaid-node-border: #58a6ff;
5839     -1631     -    104 +  --mermaid-cluster-bkg: #161b22;
5840     -1632     -    105 +  --mermaid-cluster-border: #bc8cff;
5841     -1633     -    106 +  --mermaid-default-link-color: #58a6ff;
5842     -1634     -    107 +  --mermaid-title-color: #e6edf3;
5843     -1635     -    108 +  --mermaid-edge-label-background: #0d1117;
5844     -1636     -    109 +  --mermaid-node-text-color: #e6edf3;
5845     -1637     -    110 +
5846     -1638     -    111 +  /* Sequence Diagram */
5847     -1639     -    112 +  --mermaid-actor-bkg: #1c2128;
5848     -1640     -    113 +  --mermaid-actor-border: #58a6ff;
5849     -1641     -    114 +  --mermaid-actor-text-color: #e6edf3;
5850     -1642     -    115 +  --mermaid-actor-line-color: #58a6ff;
5851     -1643     -    116 +  --mermaid-signal-color: #bc8cff;
5852     -1644     -    117 +  --mermaid-signal-text-color: #e6edf3;
5853     -1645     -    118 +  --mermaid-label-box-bkg-color: #1c2128;
5854     -1646     -    119 +  --mermaid-label-box-border-color: #58a6ff;
5855     -1647     -    120 +  --mermaid-label-text-color: #e6edf3;
5856     -1648     -    121 +  --mermaid-loop-text-color: #e6edf3;
5857     -1649     -    122 +  --mermaid-activation-border-color: #bc8cff;
5858     -1650     -    123 +  --mermaid-activation-bkg-color: #161b22;
5859     -1651     -    124 +  --mermaid-sequence-number-color: #e6edf3;
5860     -1652     -    125 +
5861     -1653     -    126 +  /* Pie Chart - 12 distinct slice colors + text */
5862     -1654     -    127 +  --mermaid-pie1: #58a6ff;
5863     -1655     -    128 +  --mermaid-pie2: #bc8cff;
5864     -1656     -    129 +  --mermaid-pie3: #ff7b72;
5865     -1657     -    130 +  --mermaid-pie4: #3fb950;
5866     -1658     -    131 +  --mermaid-pie5: #ffa657;
5867     -1659     -    132 +  --mermaid-pie6: #d2a8ff;
5868     -1660     -    133 +  --mermaid-pie7: #56d4dd;
5869     -1661     -    134 +  --mermaid-pie8: #7ee787;
5870     -1662     -    135 +  --mermaid-pie9: #a5d6ff;
5871     -1663     -    136 +  --mermaid-pie10: #79c0ff;
5872     -1664     -    137 +  --mermaid-pie11: #d2a8ff;
5873     -1665     -    138 +  --mermaid-pie12: #ffa657;
5874     -1666     -    139 +  --mermaid-pie-title-text-color: #e6edf3;
5875     -1667     -    140 +  --mermaid-pie-section-text-color: #0d1117; /* Dark on vibrant slices */
5876     -1668     -    141 +  --mermaid-pie-legend-text-color: #e6edf3;
5877     -1669     -    142 +  --mermaid-pie-stroke-color: #58a6ff;
5878     -1670     -    143 +  --mermaid-pie-outer-stroke-color: #58a6ff;
5879     -1671     -    144 +
5880     -1672     -    145 +  /* State Diagram */
5881     -1673     -    146 +  --mermaid-label-color: #e6edf3;
5882     -1674     -    147 +  --mermaid-alt-background: #161b22;
5883     -1675     -    148 +
5884     -1676     -    149 +  /* Class Diagram */
5885     -1677     -    150 +  --mermaid-class-text: #e6edf3;
5886     -1678     -    151 +
5887     -1679     -    152 +  /* User Journey - 8 distinct colors */
5888     -1680     -    153 +  --mermaid-fill-type0: #58a6ff;
5889     -1681     -    154 +  --mermaid-fill-type1: #bc8cff;
5890     -1682     -    155 +  --mermaid-fill-type2: #ff7b72;
5891     -1683     -    156 +  --mermaid-fill-type3: #3fb950;
5892     -1684     -    157 +  --mermaid-fill-type4: #ffa657;
5893     -1685     -    158 +  --mermaid-fill-type5: #d2a8ff;
5894     -1686     -    159 +  --mermaid-fill-type6: #56d4dd;
5895     -1687     -    160 +  --mermaid-fill-type7: #7ee787;
5896     -1688     -    161 +
5897     -1689     -    162 +  /* Gantt Chart */
5898     -1690     -    163 +  --mermaid-section-bkg-color: #1c2128;
5899     -1691     -    164 +  --mermaid-alt-section-bkg-color: #161b22;
5900     -1692     -    165 +  --mermaid-section-bkg-color2: #1c2128;
5901     -1693     -    166 +  --mermaid-task-text-color: #e6edf3;
5902     -1694     -    167 +  --mermaid-task-text-light-color: #e6edf3;
5903     -1695     -    168 +  --mermaid-task-text-outside-color: #e6edf3;
5904     -1696     -    169 +  --mermaid-task-text-clickable-color: #58a6ff;
5905     -1697     -    170 +  --mermaid-active-task-bkg-color: #58a6ff;
5906     -1698     -    171 +  --mermaid-active-task-border-color: #58a6ff;
5907     -1699     -    172 +  --mermaid-done-task-bkg-color: #3fb950;
5908     -1700     -    173 +  --mermaid-done-task-border-color: #3fb950;
5909     -1701     -    174 +  --mermaid-crit-border-color: #ff7b72;
5910     -1702     -    175 +  --mermaid-crit-bkg-color: #ff7b72;
5911     -1703     -    176 +  --mermaid-today-line-color: #ff7b72;
5912     -1704     -    177 +  --mermaid-grid-color: #30363d;
5913     -1705     -    178 +  --mermaid-section-text-color: #e6edf3;
5914     -1706     -    179 +  --mermaid-task-border-color: #58a6ff;
5915     -1707     -    180 +
5916     -1708     -    181 +  /* ER Diagram */
5917     -1709     -    182 +  --mermaid-attribute-background-color-odd: #161b22;
5918     -1710     -    183 +  --mermaid-attribute-background-color-even: #0d1117;
5919     -1711     -    184 +  --mermaid-relationship-label-background: #0d1117;
5920     -1712     -    185 +  --mermaid-relationship-label-color: #e6edf3;
5921     -1713     -    186 +  --mermaid-entity-background: #1c2128;
5922     -1714     -    187 +  --mermaid-entity-border-color: #58a6ff;
5923     -1715     -    188 +
5924     -1716     -    189 +  /* Git Graph */
5925     -1717     -    190 +  --mermaid-git0: #58a6ff;
5926     -1718     -    191 +  --mermaid-git1: #bc8cff;
5927     -1719     -    192 +  --mermaid-git2: #ff7b72;
5928     -1720     -    193 +  --mermaid-git3: #3fb950;
5929     -1721     -    194 +  --mermaid-git4: #ffa657;
5930     -1722     -    195 +  --mermaid-git5: #d2a8ff;
5931     -1723     -    196 +  --mermaid-git6: #56d4dd;
5932     -1724     -    197 +  --mermaid-git7: #7ee787;
5933     -1725     -    198 +  --mermaid-git-inv0: #0d1117;
5934     -1726     -    199 +  --mermaid-git-branch-label0: #e6edf3;
5935     -1727     -    200 +  --mermaid-git-branch-label1: #e6edf3;
5936     -1728     -    201 +  --mermaid-git-branch-label2: #e6edf3;
5937     -1729     -    202 +  --mermaid-git-branch-label3: #e6edf3;
5938     -1730     -    203 +  --mermaid-git-branch-label4: #e6edf3;
5939     -1731     -    204 +  --mermaid-commit-label-color: #e6edf3;
5940     -1732     -    205 +  --mermaid-commit-label-background: #0d1117;
5941     -1733     -    206 +  --mermaid-tag-label-color: #e6edf3;
5942     -1734     -    207 +  --mermaid-tag-label-background: #1c2128;
5943     -1735     -    208 +  --mermaid-tag-label-border: #58a6ff;
5944     -1736     - 49 209  }
5945     -1737     - 50 210  
5946     -1738     -
5947     -1739     -```
5948     -1740     -
5949     -1741     -
5950     -1742     -### üìÑ `themes/default-light.css`
5951     -1743     -
5952     -1744     -**Type:** Stylesheet üé®
5953     -1745     -
5954     -1746     -```diff
5955     -1747     -@@ -26,24 +26,184 @@
5956     -1748     - 26  26    --code-block-bg: #f6f8fa;
5957     -1749     - 27  27    --code-border: #d0d7de;
5958     -1750     - 28  28  
5959     -1751     - 29     -  /* Syntax Highlighting - Comprehensive Token Colors */
5960     -1752     - 30     -  --syntax-keyword: #cf222e;
5961     -1753     - 31     -  --syntax-string: #1a7f37;
5962     -1754     - 32     -  --syntax-number: #0550ae;
5963     -1755     - 33     -  --syntax-function: #8250df;
5964     -1756     - 34     -  --syntax-comment: #636c76;
5965     -1757     - 35     -  --syntax-operator: #cf222e;
5966     -1758     - 36     -  --syntax-punctuation: #636c76;
5967     -1759     -     29 +  /* Syntax Highlighting - Production-Grade Token Colors (One Dark Architecture) */
5968     -1760     - 37  30  
5969     -1761     - 38     -  /* Additional Token Types for Full Customization */
5970     -1762     - 39     -  --syntax-variable: #0550ae; /* Variables, parameters */
5971     -1763     - 40     -  --syntax-property: #1a7f37; /* Properties, attributes */
5972     -1764     - 41     -  --syntax-namespace: #cf222e; /* Namespaces */
5973     -1765     - 42     -  --syntax-builtin: #8250df; /* Built-in functions */
5974     -1766     -     31 +  /* Core hue-1: Cyan - URLs */
5975     -1767     -     32 +  --syntax-url: #0969da; /* GitHub blue for URLs */
5976     -1768     -     33 +
5977     -1769     -     34 +  /* Core hue-2: Blue - Functions, variables */
5978     -1770     -     35 +  --syntax-function: #8250df; /* Purple-blue for functions */
5979     -1771     -     36 +  --syntax-variable: #0550ae; /* Deep blue for variables */
5980     -1772     -     37 +
5981     -1773     -     38 +  /* Core hue-3: Red - Keywords */
5982     -1774     -     39 +  --syntax-keyword: #cf222e; /* GitHub red for keywords (final, sealed, class) */
5983     -1775     -     40 +
5984     -1776     -     41 +  /* Core hue-4: Green - Strings, builtins */
5985     -1777     -     42 +  --syntax-string: #1a7f37; /* GitHub green for strings */
5986     -1778     -     43 +  --syntax-builtin: #116329; /* Darker green for builtins (String, List) */
5987     -1779     -     44 +  --syntax-char: #1a7f37; /* Same as strings */
5988     -1780     -     45 +  --syntax-regex: #1a7f37; /* Same as strings */
5989     -1781     -     46 +  --syntax-inserted: #1a7f37; /* For diff */
5990     -1782     -     47 +
5991     -1783     -     48 +  /* Core hue-5: Orange/Brown - Properties, tags */
5992     -1784     -     49 +  --syntax-property: #bc4c00; /* Orange-brown for properties */
5993     -1785     -     50 +  --syntax-tag: #cf222e; /* Red for tags */
5994     -1786     -     51 +  --syntax-deleted: #cf222e; /* For diff */
5995     -1787     -     52 +  --syntax-important: #bc4c00; /* For !important */
5996     -1788     -     53 +
5997     -1789     -     54 +  /* Core hue-6: Blue - Class names, constants, numbers */
5998     -1790     -     55 +  --syntax-class-name: #0969da; /* Bright blue for class names (Rectangle, Shape) */
5999     -1791     -     56 +  --syntax-number: #0550ae; /* Deep blue for numbers */
6000     -1792     -     57 +  --syntax-constant: #0969da; /* Bright blue for constants */
6001     -1793     -     58 +  --syntax-boolean: #0550ae; /* Same as numbers */
6002     -1794     -     59 +  --syntax-atrule: #8250df; /* Purple for CSS @ rules */
6003     -1795     -     60 +
6004     -1796     -     61 +  /* Neutral colors */
6005     -1797     -     62 +  --syntax-comment: #636c76; /* GitHub gray for comments */
6006     -1798     -     63 +  --syntax-punctuation: #636c76; /* Gray for punctuation */
6007     -1799     -     64 +  --syntax-operator: #cf222e; /* Red for operators */
6008     -1800     -     65 +
6009     -1801     -     66 +  /* Markup specific */
6010     -1802     -     67 +  --syntax-attr-name: #0969da; /* Blue like class-name */
6011     -1803     -     68 +  --syntax-attr-value: #1a7f37; /* Green like strings */
6012     -1804     -     69 +  --syntax-namespace: #8250df; /* Purple */
6013     -1805     -     70 +  --syntax-entity: #636c76; /* Neutral */
6014     -1806     -     71 +  --syntax-selector: #bc4c00; /* Orange like properties */
6015     -1807     - 43  72  
6016     -1808     - 44  73    --blockquote-border: #0969da;
6017     -1809     - 45  74    --blockquote-bg: #ddf4ff;
6018     -1810     - 46  75  
6019     -1811     - 47  76    --table-header-bg: #f6f8fa;
6020     -1812     - 48  77    --table-border: #d0d7de;
6021     -1813     -     78 +
6022     -1814     -     79 +  /* === MERMAID COMPREHENSIVE CONFIGURATION === */
6023     -1815     -     80 +
6024     -1816     -     81 +  /* Core Global */
6025     -1817     -     82 +  --mermaid-background: #ffffff;
6026     -1818     -     83 +  --mermaid-text-color: #1f2328;
6027     -1819     -     84 +  --mermaid-line-color: #0969da;
6028     -1820     -     85 +  --mermaid-main-bkg: #eaeef2;
6029     -1821     -     86 +
6030     -1822     -     87 +  /* Primary Set */
6031     -1823     -     88 +  --mermaid-primary-color: #eaeef2;
6032     -1824     -     89 +  --mermaid-primary-text-color: #1f2328;
6033     -1825     -     90 +  --mermaid-primary-border-color: #0969da;
6034     -1826     -     91 +
6035     -1827     -     92 +  /* Secondary Set */
6036     -1828     -     93 +  --mermaid-secondary-color: #f6f8fa;
6037     -1829     -     94 +  --mermaid-secondary-text-color: #1f2328;
6038     -1830     -     95 +  --mermaid-secondary-border-color: #8250df;
6039     -1831     -     96 +
6040     -1832     -     97 +  /* Tertiary Set */
6041     -1833     -     98 +  --mermaid-tertiary-color: #ffffff;
6042     -1834     -     99 +  --mermaid-tertiary-text-color: #1f2328;
6043     -1835     -    100 +  --mermaid-tertiary-border-color: #cf222e;
6044     -1836     -    101 +
6045     -1837     -    102 +  /* Flowchart */
6046     -1838     -    103 +  --mermaid-node-border: #0969da;
6047     -1839     -    104 +  --mermaid-cluster-bkg: #f6f8fa;
6048     -1840     -    105 +  --mermaid-cluster-border: #8250df;
6049     -1841     -    106 +  --mermaid-default-link-color: #0969da;
6050     -1842     -    107 +  --mermaid-title-color: #1f2328;
6051     -1843     -    108 +  --mermaid-edge-label-background: #ffffff;
6052     -1844     -    109 +  --mermaid-node-text-color: #1f2328;
6053     -1845     -    110 +
6054     -1846     -    111 +  /* Sequence Diagram */
6055     -1847     -    112 +  --mermaid-actor-bkg: #eaeef2;
6056     -1848     -    113 +  --mermaid-actor-border: #0969da;
6057     -1849     -    114 +  --mermaid-actor-text-color: #1f2328;
6058     -1850     -    115 +  --mermaid-actor-line-color: #0969da;
6059     -1851     -    116 +  --mermaid-signal-color: #8250df;
6060     -1852     -    117 +  --mermaid-signal-text-color: #1f2328;
6061     -1853     -    118 +  --mermaid-label-box-bkg-color: #eaeef2;
6062     -1854     -    119 +  --mermaid-label-box-border-color: #0969da;
6063     -1855     -    120 +  --mermaid-label-text-color: #1f2328;
6064     -1856     -    121 +  --mermaid-loop-text-color: #1f2328;
6065     -1857     -    122 +  --mermaid-activation-border-color: #8250df;
6066     -1858     -    123 +  --mermaid-activation-bkg-color: #f6f8fa;
6067     -1859     -    124 +  --mermaid-sequence-number-color: #1f2328;
6068     -1860     -    125 +
6069     -1861     -    126 +  /* Pie Chart */
6070     -1862     -    127 +  --mermaid-pie1: #0969da;
6071     -1863     -    128 +  --mermaid-pie2: #8250df;
6072     -1864     -    129 +  --mermaid-pie3: #cf222e;
6073     -1865     -    130 +  --mermaid-pie4: #1a7f37;
6074     -1866     -    131 +  --mermaid-pie5: #bc4c00;
6075     -1867     -    132 +  --mermaid-pie6: #0550ae;
6076     -1868     -    133 +  --mermaid-pie7: #116329;
6077     -1869     -    134 +  --mermaid-pie8: #0969da;
6078     -1870     -    135 +  --mermaid-pie9: #8250df;
6079     -1871     -    136 +  --mermaid-pie10: #cf222e;
6080     -1872     -    137 +  --mermaid-pie11: #1a7f37;
6081     -1873     -    138 +  --mermaid-pie12: #bc4c00;
6082     -1874     -    139 +  --mermaid-pie-title-text-color: #1f2328;
6083     -1875     -    140 +  --mermaid-pie-section-text-color: #ffffff; /* White on vibrant slices */
6084     -1876     -    141 +  --mermaid-pie-legend-text-color: #1f2328;
6085     -1877     -    142 +  --mermaid-pie-stroke-color: #0969da;
6086     -1878     -    143 +  --mermaid-pie-outer-stroke-color: #0969da;
6087     -1879     -    144 +
6088     -1880     -    145 +  /* State Diagram */
6089     -1881     -    146 +  --mermaid-label-color: #1f2328;
6090     -1882     -    147 +  --mermaid-alt-background: #f6f8fa;
6091     -1883     -    148 +
6092     -1884     -    149 +  /* Class Diagram */
6093     -1885     -    150 +  --mermaid-class-text: #1f2328;
6094     -1886     -    151 +
6095     -1887     -    152 +  /* User Journey */
6096     -1888     -    153 +  --mermaid-fill-type0: #0969da;
6097     -1889     -    154 +  --mermaid-fill-type1: #8250df;
6098     -1890     -    155 +  --mermaid-fill-type2: #cf222e;
6099     -1891     -    156 +  --mermaid-fill-type3: #1a7f37;
6100     -1892     -    157 +  --mermaid-fill-type4: #bc4c00;
6101     -1893     -    158 +  --mermaid-fill-type5: #0550ae;
6102     -1894     -    159 +  --mermaid-fill-type6: #116329;
6103     -1895     -    160 +  --mermaid-fill-type7: #0969da;
6104     -1896     -    161 +
6105     -1897     -    162 +  /* Gantt Chart */
6106     -1898     -    163 +  --mermaid-section-bkg-color: #eaeef2;
6107     -1899     -    164 +  --mermaid-alt-section-bkg-color: #f6f8fa;
6108     -1900     -    165 +  --mermaid-section-bkg-color2: #eaeef2;
6109     -1901     -    166 +  --mermaid-task-text-color: #1f2328;
6110     -1902     -    167 +  --mermaid-task-text-light-color: #1f2328;
6111     -1903     -    168 +  --mermaid-task-text-outside-color: #1f2328;
6112     -1904     -    169 +  --mermaid-task-text-clickable-color: #0969da;
6113     -1905     -    170 +  --mermaid-active-task-bkg-color: #0969da;
6114     -1906     -    171 +  --mermaid-active-task-border-color: #0969da;
6115     -1907     -    172 +  --mermaid-done-task-bkg-color: #1a7f37;
6116     -1908     -    173 +  --mermaid-done-task-border-color: #1a7f37;
6117     -1909     -    174 +  --mermaid-crit-border-color: #cf222e;
6118     -1910     -    175 +  --mermaid-crit-bkg-color: #cf222e;
6119     -1911     -    176 +  --mermaid-today-line-color: #cf222e;
6120     -1912     -    177 +  --mermaid-grid-color: #d0d7de;
6121     -1913     -    178 +  --mermaid-section-text-color: #1f2328;
6122     -1914     -    179 +  --mermaid-task-border-color: #0969da;
6123     -1915     -    180 +
6124     -1916     -    181 +  /* ER Diagram */
6125     -1917     -    182 +  --mermaid-attribute-background-color-odd: #f6f8fa;
6126     -1918     -    183 +  --mermaid-attribute-background-color-even: #ffffff;
6127     -1919     -    184 +  --mermaid-relationship-label-background: #ffffff;
6128     -1920     -    185 +  --mermaid-relationship-label-color: #1f2328;
6129     -1921     -    186 +  --mermaid-entity-background: #eaeef2;
6130     -1922     -    187 +  --mermaid-entity-border-color: #0969da;
6131     -1923     -    188 +
6132     -1924     -    189 +  /* Git Graph */
6133     -1925     -    190 +  --mermaid-git0: #0969da;
6134     -1926     -    191 +  --mermaid-git1: #8250df;
6135     -1927     -    192 +  --mermaid-git2: #cf222e;
6136     -1928     -    193 +  --mermaid-git3: #1a7f37;
6137     -1929     -    194 +  --mermaid-git4: #bc4c00;
6138     -1930     -    195 +  --mermaid-git5: #0550ae;
6139     -1931     -    196 +  --mermaid-git6: #116329;
6140     -1932     -    197 +  --mermaid-git7: #0969da;
6141     -1933     -    198 +  --mermaid-git-inv0: #ffffff;
6142     -1934     -    199 +  --mermaid-git-branch-label0: #1f2328;
6143     -1935     -    200 +  --mermaid-git-branch-label1: #1f2328;
6144     -1936     -    201 +  --mermaid-git-branch-label2: #1f2328;
6145     -1937     -    202 +  --mermaid-git-branch-label3: #1f2328;
6146     -1938     -    203 +  --mermaid-git-branch-label4: #1f2328;
6147     -1939     -    204 +  --mermaid-commit-label-color: #1f2328;
6148     -1940     -    205 +  --mermaid-commit-label-background: #ffffff;
6149     -1941     -    206 +  --mermaid-tag-label-color: #1f2328;
6150     -1942     -    207 +  --mermaid-tag-label-background: #eaeef2;
6151     -1943     -    208 +  --mermaid-tag-label-border: #0969da;
6152     -1944     - 49 209  }
6153     -1945     - 50 210  
6154     -1946     -
6155     -1947     -```
6156     -1948     -
6157     -1949     -
6158     -1950     -### üìÑ `themes/forest-dark.css`
6159     -1951     -
6160     -1952     -**Type:** Stylesheet üé®
6161     -1953     -
6162     -1954     -```diff
6163     -1955     -@@ -1,11 +1,11 @@
6164     -1956     -  1     -/* Forest Dark Theme */
6165     -1957     -      1 +/* Forest Dark Theme - Deep Jungle Aesthetic */
6166     -1958     -  2   2  :root {
6167     -1959     -  3     -  --bg-primary: #0f1c0a;
6168     -1960     -  4     -  --bg-secondary: #1a2817;
6169     -1961     -  5     -  --bg-tertiary: #2d4a2b;
6170     -1962     -  6     -  --text-primary: #d9f99d;
6171     -1963     -  7     -  --text-secondary: #a3e635;
6172     -1964     -  8     -  --border-color: #3f6212;
6173     -1965     -      3 +  --bg-primary: #0a1408; /* Deep forest green with blue undertones */
6174     -1966     -      4 +  --bg-secondary: #132118; /* Darker moss green */
6175     -1967     -      5 +  --bg-tertiary: #1e3a29; /* Rich forest green */
6176     -1968     -      6 +  --text-primary: #d9f99d; /* Bright lime (firefly glow) */
6177     -1969     -      7 +  --text-secondary: #a3e635; /* Vibrant lime */
6178     -1970     -      8 +  --border-color: #2d5a3d; /* Forest green border */
6179     -1971     -  9   9  
6180     -1972     - 10  10    --h1-color: #84cc16;
6181     -1973     - 11  11    --h2-color: #a3e635;
6182     -1974     -@@ -17,31 +17,144 @@
6183     -1975     - 17  17    --link-color: #84cc16;
6184     -1976     - 18  18    --link-hover: #a3e635;
6185     -1977     - 19  19  
6186     -1978     - 20     -  /* Code Colors */
6187     -1979     - 21     -  --code-bg: #1a2817;
6188     -1980     -     20 +  /* Code Colors - Organic forest glow */
6189     -1981     -     21 +  --code-bg: rgba(132, 204, 22, 0.12); /* Lime-tinted background */
6190     -1982     - 22  22    --code-text: #a3e635;
6191     -1983     - 23     -  --code-block-bg: #0f1c0a;
6192     -1984     - 24     -  --code-border: #3f6212;
6193     -1985     -     23 +  --code-block-bg: #0d1a11; /* Deep forest with blue-green tint */
6194     -1986     -     24 +  --code-border: rgba(163, 230, 53, 0.3); /* Lime glow border */
6195     -1987     - 25  25  
6196     -1988     - 26     -  /* Syntax Highlighting - Comprehensive Token Colors */
6197     -1989     - 27     -  --syntax-keyword: #84cc16;
6198     -1990     - 28     -  --syntax-string: #a3e635;
6199     -1991     - 29     -  --syntax-number: #bef264;
6200     -1992     - 30     -  --syntax-function: #4ade80;
6201     -1993     - 31     -  --syntax-comment: #737373;
6202     -1994     - 32     -  --syntax-operator: #22c55e;
6203     -1995     - 33     -  --syntax-punctuation: #a3a3a3;
6204     -1996     -     26 +  /* Syntax Highlighting - Production-Grade Token Colors (One Dark Architecture) */
6205     -1997     - 34  27  
6206     -1998     - 35     -  /* Additional Token Types */
6207     -1999     - 36     -  --syntax-variable: #bef264; /* Variables - bright lime (distinct from text #d9f99d) */
6208     -2000     - 37     -  --syntax-property: #4ade80; /* Properties - green */
6209     -2001     - 38     -  --syntax-namespace: #84cc16; /* Namespaces - lime */
6210     -2002     - 39     -  --syntax-builtin: #22c55e; /* Builtins - green */
6211     -2003     -     28 +  /* Core hue-1: Teal - URLs */
6212     -2004     -     29 +  --syntax-url: #5eead4; /* Bright teal for URLs */
6213     -2005     -     30 +
6214     -2006     -     31 +  /* Core hue-2: Green - Functions, variables */
6215     -2007     -     32 +  --syntax-function: #4ade80; /* Bright green for functions */
6216     -2008     -     33 +  --syntax-variable: #22c55e; /* Medium green for variables */
6217     -2009     -     34 +
6218     -2010     -     35 +  /* Core hue-3: Yellow - Keywords */
6219     -2011     -     36 +  --syntax-keyword: #fbbf24; /* Golden yellow for keywords (final, sealed, class) */
6220     -2012     -     37 +
6221     -2013     -     38 +  /* Core hue-4: Lime - Strings, builtins */
6222     -2014     -     39 +  --syntax-string: #a3e635; /* Bright lime for strings */
6223     -2015     -     40 +  --syntax-builtin: #84cc16; /* Lime for builtins (String, List) */
6224     -2016     -     41 +  --syntax-char: #a3e635; /* Same as strings */
6225     -2017     -     42 +  --syntax-regex: #a3e635; /* Same as strings */
6226     -2018     -     43 +  --syntax-inserted: #84cc16; /* For diff */
6227     -2019     -     44 +
6228     -2020     -     45 +  /* Core hue-5: Orange/Amber - Properties, tags */
6229     -2021     -     46 +  --syntax-property: #fb923c; /* Orange for properties */
6230     -2022     -     47 +  --syntax-tag: #f97316; /* Burnt orange for tags */
6231     -2023     -     48 +  --syntax-deleted: #f87171; /* Coral for diff */
6232     -2024     -     49 +  --syntax-important: #fb923c; /* Orange for !important */
6233     -2025     -     50 +
6234     -2026     -     51 +  /* Core hue-6: Yellow-green - Class names, constants, numbers */
6235     -2027     -     52 +  --syntax-class-name: #bef264; /* Bright yellow-green for class names (Rectangle, Shape) */
6236     -2028     -     53 +  --syntax-number: #fde047; /* Bright yellow for numbers */
6237     -2029     -     54 +  --syntax-constant: #84cc16; /* Lime for constants */
6238     -2030     -     55 +  --syntax-boolean: #fde047; /* Same as numbers */
6239     -2031     -     56 +  --syntax-atrule: #a3e635; /* Lime for CSS @ rules */
6240     -2032     -     57 +
6241     -2033     -     58 +  /* Neutral colors */
6242     -2034     -     59 +  --syntax-comment: #737373; /* Gray for comments */
6243     -2035     -     60 +  --syntax-punctuation: #a3a3a3; /* Light gray for punctuation */
6244     -2036     -     61 +  --syntax-operator: #22c55e; /* Green for operators */
6245     -2037     -     62 +
6246     -2038     -     63 +  /* Markup specific */
6247     -2039     -     64 +  --syntax-attr-name: #bef264; /* Yellow-green like class-name */
6248     -2040     -     65 +  --syntax-attr-value: #a3e635; /* Lime like strings */
6249     -2041     -     66 +  --syntax-namespace: #fbbf24; /* Yellow like keywords */
6250     -2042     -     67 +  --syntax-entity: #a3a3a3; /* Neutral */
6251     -2043     -     68 +  --syntax-selector: #fb923c; /* Orange like properties */
6252     -2044     - 40  69  
6253     -2045     - 41  70    --blockquote-border: #84cc16;
6254     -2046     - 42     -  --blockquote-bg: #1a2817;
6255     -2047     -     71 +  --blockquote-bg: rgba(132, 204, 22, 0.08); /* Lime-tinted blockquote */
6256     -2048     - 43  72    --bold-color: #fbbf24;
6257     -2049     - 44  73    --italic-color: #84cc16;
6258     -2050     - 45     -  --table-header-bg: #2d4a2b;
6259     -2051     - 46     -  --table-border: #3f6212;
6260     -2052     -     74 +  --table-header-bg: rgba(74, 222, 128, 0.12); /* Green-tinted table header */
6261     -2053     -     75 +  --table-border: rgba(45, 90, 61, 0.4); /* Forest-tinted border */
6262     -2054     -     76 +
6263     -2055     -     77 +  /* === MERMAID COMPREHENSIVE CONFIGURATION === */
6264     -2056     -     78 +  /* Complete control over ALL diagram elements */
6265     -    4212 +     78 +---
6266     -2057 4213       79 +
6267     -2058     -     80 +  /* Core Global */
6268     -2059     -     81 +  --mermaid-background: #0a1408;
6269     -2060     -     82 +  --mermaid-text-color: #d9f99d;
6270     -2061     -     83 +  --mermaid-line-color: #a3e635;
6271     -2062     -     84 +  --mermaid-main-bkg: #2d5a3d;
6272     -    4214 +     80 +## üîç Nitpicks & Code Style (Senior SDE Standards)
6273     -    4215 +     81 +
6274     -    4216 +     82 +### 8. üìù Hardcoded Content (Lines 297-381)
6275     -    4217 +     83 +**Critique:** The default "Welcome" markdown is 84 lines of hardcoded string inside a logic file.
6276     -    4218 +     84 +- **Fix:** Move to `src/js/config/defaultContent.js` or load from a file.
6277     -2063 4219       85 +
6278     -2064     -     86 +  /* Primary Set - Main nodes/boxes */
6279     -2065     -     87 +  --mermaid-primary-color: #2d5a3d;
6280     -2066     -     88 +  --mermaid-primary-text-color: #d9f99d;
6281     -2067     -     89 +  --mermaid-primary-border-color: #84cc16;
6282     -2068     -     90 +
6283     -2069     -     91 +  /* Secondary Set - Clusters/subgraphs */
6284     -2070     -     92 +  --mermaid-secondary-color: #1e3a29;
6285     -2071     -     93 +  --mermaid-secondary-text-color: #d9f99d;
6286     -2072     -     94 +  --mermaid-secondary-border-color: #a3e635;
6287     -2073     -     95 +
6288     -2074     -     96 +  /* Tertiary Set - Edge labels */
6289     -2075     -     97 +  --mermaid-tertiary-color: #0a1408;
6290     -2076     -     98 +  --mermaid-tertiary-text-color: #d9f99d;
6291     -2077     -     99 +  --mermaid-tertiary-border-color: #bef264;
6292     -2078     -    100 +
6293     -2079     -    101 +  /* Flowchart */
6294     -2080     -    102 +  --mermaid-node-border: #84cc16;
6295     -2081     -    103 +  --mermaid-cluster-bkg: #1e3a29;
6296     -2082     -    104 +  --mermaid-cluster-border: #a3e635;
6297     -2083     -    105 +  --mermaid-default-link-color: #a3e635;
6298     -2084     -    106 +  --mermaid-title-color: #d9f99d;
6299     -2085     -    107 +  --mermaid-edge-label-background: #0a1408;
6300     -2086     -    108 +  --mermaid-node-text-color: #d9f99d;
6301     -    4220 +     86 +### 9. üé® CSS Variable Extraction (Line 553)
6302     -    4221 +     87 +```javascript
6303     -    4222 +     88 +const currentValue = getComputedStyle(document.documentElement).getPropertyValue(varName).trim();
6304     -    4223 +     89 +```
6305     -    4224 +     90 +**Critique:** You are calling `getComputedStyle` inside a loop (`forEach` on Line 550).
6306     -    4225 +     91 +- **Impact:** This forces a **Style Recalculation** (Reflow) on every iteration. Expensive.
6307     -    4226 +     92 +- **Fix:** Cache `getComputedStyle` once outside the loop.
6308     -    4227 +     93 +
6309     -    4228 +     94 +### 10. ‚ùå Regex ReDoS Potential (Lines 111, 485)
6310     -    4229 +     95 +```javascript
6311     -    4230 +     96 +// Line 485
6312     -    4231 +     97 +html = html.replace(/<pre><code class="language-mermaid">([\s\S]*?)<\/code><\/pre>/g, ...
6313     -    4232 +     98 +```
6314     -    4233 +     99 +**Critique:** `[\s\S]*?` is generally safe-ish, but processing the entire HTML output with regex to find code blocks is fragile HTML parsing.
6315     -    4234 +    100 +- **Fix:** Marked.js has a `renderer` option. Override the `code` renderer instead of string-replacing the output HTML. This is much cleaner and safer.
6316     -    4235 +    101 +
6317     -    4236 +    102 +### 11. üß© Mixed 'var' and 'let' (Lines 884-885)
6318     -    4237 +    103 +```javascript
6319     -    4238 +    104 +var syncScrollEnabled = ...
6320     -    4239 +    105 +var syncScrolling = ...
6321     -    4240 +    106 +```
6322     -    4241 +    107 +**Critique:** Why `var`? You used `const/let` everywhere else.
6323     -    4242 +    108 +- **Fix:** Be consistent. Use `let`.
6324     -2087 4243      109 +
6325     -2088     -    110 +  /* Sequence Diagram */
6326     -2089     -    111 +  --mermaid-actor-bkg: #2d5a3d;
6327     -2090     -    112 +  --mermaid-actor-border: #84cc16;
6328     -2091     -    113 +  --mermaid-actor-text-color: #d9f99d;
6329     -2092     -    114 +  --mermaid-actor-line-color: #84cc16;
6330     -2093     -    115 +  --mermaid-signal-color: #a3e635;
6331     -2094     -    116 +  --mermaid-signal-text-color: #d9f99d;
6332     -2095     -    117 +  --mermaid-label-box-bkg-color: #2d5a3d;
6333     -2096     -    118 +  --mermaid-label-box-border-color: #84cc16;
6334     -2097     -    119 +  --mermaid-label-text-color: #d9f99d;
6335     -2098     -    120 +  --mermaid-loop-text-color: #d9f99d;
6336     -2099     -    121 +  --mermaid-activation-border-color: #a3e635;
6337     -2100     -    122 +  --mermaid-activation-bkg-color: #1e3a29;
6338     -2101     -    123 +  --mermaid-sequence-number-color: #d9f99d;
6339     -2102     -    124 +
6340     -2103     -    125 +  /* Pie Chart - 12 distinct slice colors + text colors */
6341     -2104     -    126 +  --mermaid-pie1: #4ade80;
6342     -2105     -    127 +  --mermaid-pie2: #fbbf24;
6343     -2106     -    128 +  --mermaid-pie3: #fb923c;
6344     -2107     -    129 +  --mermaid-pie4: #5eead4;
6345     -2108     -    130 +  --mermaid-pie5: #a3e635;
6346     -2109     -    131 +  --mermaid-pie6: #22c55e;
6347     -2110     -    132 +  --mermaid-pie7: #84cc16;
6348     -2111     -    133 +  --mermaid-pie8: #fde047;
6349     -2112     -    134 +  --mermaid-pie9: #4ade80;
6350     -2113     -    135 +  --mermaid-pie10: #fbbf24;
6351     -2114     -    136 +  --mermaid-pie11: #fb923c;
6352     -2115     -    137 +  --mermaid-pie12: #5eead4;
6353     -2116     -    138 +  --mermaid-pie-title-text-color: #d9f99d;
6354     -2117     -    139 +  --mermaid-pie-section-text-color: #0a1408; /* Dark on vibrant slices */
6355     -2118     -    140 +  --mermaid-pie-legend-text-color: #d9f99d;
6356     -2119     -    141 +  --mermaid-pie-stroke-color: #84cc16;
6357     -2120     -    142 +  --mermaid-pie-outer-stroke-color: #84cc16;
6358     -2121     -    143 +
6359     -2122     -    144 +  /* State Diagram */
6360     -2123     -    145 +  --mermaid-label-color: #d9f99d;
6361     -2124     -    146 +  --mermaid-alt-background: #1e3a29;
6362     -2125     -    147 +
6363     -2126     -    148 +  /* Class Diagram */
6364     -2127     -    149 +  --mermaid-class-text: #d9f99d;
6365     -2128     -    150 +
6366     -2129     -    151 +  /* User Journey - 8 distinct colors */
6367     -2130     -    152 +  --mermaid-fill-type0: #4ade80;
6368     -2131     -    153 +  --mermaid-fill-type1: #fbbf24;
6369     -2132     -    154 +  --mermaid-fill-type2: #fb923c;
6370     -2133     -    155 +  --mermaid-fill-type3: #5eead4;
6371     -2134     -    156 +  --mermaid-fill-type4: #a3e635;
6372     -2135     -    157 +  --mermaid-fill-type5: #22c55e;
6373     -2136     -    158 +  --mermaid-fill-type6: #84cc16;
6374     -2137     -    159 +  --mermaid-fill-type7: #fde047;
6375     -2138     - 47 160  }
6376     -2139     - 48 161  
6377     -2140     -
6378     -2141     -```
6379     -2142     -
6380     -2143     -
6381     -2144     -### üìÑ `themes/forest-light.css`
6382     -2145     -
6383     -2146     -**Type:** Stylesheet üé®
6384     -2147     -
6385     -2148     -```diff
6386     -2149     -@@ -23,20 +23,49 @@
6387     -2150     - 23  23    --code-block-bg: #ecfccb; /* Light green background */
6388     -2151     - 24  24    --code-border: #bef264;
6389     -2152     - 25  25  
6390     -2153     - 26     -  /* Syntax Highlighting - Comprehensive Token Colors */
6391     -2154     - 27     -  --syntax-keyword: #15803d;
6392     -2155     - 28     -  --syntax-string: #16a34a;
6393     -2156     - 29     -  --syntax-number: #84cc16;
6394     -2157     - 30     -  --syntax-function: #22c55e;
6395     -2158     - 31     -  --syntax-comment: #737373;
6396     -2159     - 32     -  --syntax-operator: #3f6212;
6397     -2160     - 33     -  --syntax-punctuation: #525252;
6398     -2161     -     26 +  /* Syntax Highlighting - Production-Grade Token Colors (One Dark Architecture) */
6399     -2162     - 34  27  
6400     -2163     - 35     -  /* Additional Token Types for Full Customization */
6401     -2164     - 36     -  --syntax-variable: #15803d; /* Variables - forest green */
6402     -2165     - 37     -  --syntax-property: #16a34a; /* Properties - bright green */
6403     -2166     - 38     -  --syntax-namespace: #84cc16; /* Namespaces - lime */
6404     -2167     - 39     -  --syntax-builtin: #22c55e; /* Builtins - bright green */
6405     -2168     -     28 +  /* Core hue-1: Teal - URLs */
6406     -2169     -     29 +  --syntax-url: #14b8a6; /* Teal for URLs */
6407     -2170     -     30 +
6408     -2171     -     31 +  /* Core hue-2: Green - Functions, variables */
6409     -2172     -     32 +  --syntax-function: #22c55e; /* Bright green for functions */
6410     -2173     -     33 +  --syntax-variable: #16a34a; /* Forest green for variables */
6411     -2174     -     34 +
6412     -2175     -     35 +  /* Core hue-3: Emerald - Keywords */
6413     -2176     -     36 +  --syntax-keyword: #059669; /* Deep emerald for keywords (final, sealed, class) */
6414     -2177     -     37 +
6415     -2178     -     38 +  /* Core hue-4: Lime - Strings, builtins */
6416     -2179     -     39 +  --syntax-string: #84cc16; /* Lime green for strings */
6417     -2180     -     40 +  --syntax-builtin: #65a30d; /* Vibrant lime for builtins (String, List) */
6418     -2181     -     41 +  --syntax-char: #84cc16; /* Same as strings */
6419     -2182     -     42 +  --syntax-regex: #84cc16; /* Same as strings */
6420     -2183     -     43 +  --syntax-inserted: #65a30d; /* For diff */
6421     -2184     -     44 +
6422     -2185     -     45 +  /* Core hue-5: Amber/Brown - Properties, tags */
6423     -2186     -     46 +  --syntax-property: #b45309; /* Amber-brown for properties */
6424     -2187     -     47 +  --syntax-tag: #854d0e; /* Brown for tags */
6425     -2188     -     48 +  --syntax-deleted: #dc2626; /* Red for diff */
6426     -2189     -     49 +  --syntax-important: #b45309; /* Amber for !important */
6427     -2190     -     50 +
6428     -2191     -     51 +  /* Core hue-6: Yellow/Green - Class names, constants, numbers */
6429     -2192     -     52 +  --syntax-class-name: #facc15; /* Bright yellow for class names (Rectangle, Shape) */
6430     -2193     -     53 +  --syntax-number: #eab308; /* Yellow for numbers */
6431     -2194     -     54 +  --syntax-constant: #15803d; /* Forest green for constants */
6432     -2195     -     55 +  --syntax-boolean: #eab308; /* Same as numbers */
6433     -2196     -     56 +  --syntax-atrule: #84cc16; /* Lime for CSS @ rules */
6434     -2197     -     57 +
6435     -2198     -     58 +  /* Neutral colors */
6436     -2199     -     59 +  --syntax-comment: #737373; /* Gray for comments */
6437     -2200     -     60 +  --syntax-punctuation: #525252; /* Dark gray for punctuation */
6438     -2201     -     61 +  --syntax-operator: #3f6212; /* Olive for operators */
6439     -2202     -     62 +
6440     -2203     -     63 +  /* Markup specific */
6441     -2204     -     64 +  --syntax-attr-name: #facc15; /* Yellow like class-name */
6442     -2205     -     65 +  --syntax-attr-value: #84cc16; /* Lime like strings */
6443     -2206     -     66 +  --syntax-namespace: #059669; /* Emerald like keywords */
6444     -2207     -     67 +  --syntax-entity: #525252; /* Neutral */
6445     -2208     -     68 +  --syntax-selector: #b45309; /* Amber like properties */
6446     -2209     - 40  69  
6447     -2210     - 41  70    --blockquote-border: #16a34a;
6448     -2211     - 42  71    --blockquote-bg: #ecfccb;
6449     -2212     -@@ -44,4 +73,87 @@
6450     -2213     - 44  73    --italic-color: #15803d;
6451     -2214     - 45  74    --table-header-bg: #d9f99d;
6452     -2215     - 46  75    --table-border: #bef264;
6453     -2216     -     76 +
6454     -2217     -     77 +  /* === MERMAID COMPREHENSIVE CONFIGURATION === */
6455     -2218     -     78 +
6456     -2219     -     79 +  /* Core Global */
6457     -2220     -     80 +  --mermaid-background: #f7fee7;
6458     -2221     -     81 +  --mermaid-text-color: #1a2e05;
6459     -2222     -     82 +  --mermaid-line-color: #16a34a;
6460     -2223     -     83 +  --mermaid-main-bkg: #d9f99d;
6461     -2224     -     84 +
6462     -2225     -     85 +  /* Primary Set */
6463     -2226     -     86 +  --mermaid-primary-color: #d9f99d;
6464     -2227     -     87 +  --mermaid-primary-text-color: #1a2e05;
6465     -2228     -     88 +  --mermaid-primary-border-color: #15803d;
6466     -2229     -     89 +
6467     -2230     -     90 +  /* Secondary Set */
6468     -2231     -     91 +  --mermaid-secondary-color: #ecfccb;
6469     -2232     -     92 +  --mermaid-secondary-text-color: #1a2e05;
6470     -2233     -     93 +  --mermaid-secondary-border-color: #16a34a;
6471     -2234     -     94 +
6472     -2235     -     95 +  /* Tertiary Set */
6473     -2236     -     96 +  --mermaid-tertiary-color: #f7fee7;
6474     -2237     -     97 +  --mermaid-tertiary-text-color: #1a2e05;
6475     -2238     -     98 +  --mermaid-tertiary-border-color: #22c55e;
6476     -2239     -     99 +
6477     -2240     -    100 +  /* Flowchart */
6478     -2241     -    101 +  --mermaid-node-border: #15803d;
6479     -2242     -    102 +  --mermaid-cluster-bkg: #ecfccb;
6480     -2243     -    103 +  --mermaid-cluster-border: #16a34a;
6481     -2244     -    104 +  --mermaid-default-link-color: #16a34a;
6482     -2245     -    105 +  --mermaid-title-color: #1a2e05;
6483     -2246     -    106 +  --mermaid-edge-label-background: #f7fee7;
6484     -2247     -    107 +  --mermaid-node-text-color: #1a2e05;
6485     -2248     -    108 +
6486     -2249     -    109 +  /* Sequence Diagram */
6487     -2250     -    110 +  --mermaid-actor-bkg: #d9f99d;
6488     -2251     -    111 +  --mermaid-actor-border: #15803d;
6489     -2252     -    112 +  --mermaid-actor-text-color: #1a2e05;
6490     -2253     -    113 +  --mermaid-actor-line-color: #15803d;
6491     -2254     -    114 +  --mermaid-signal-color: #16a34a;
6492     -2255     -    115 +  --mermaid-signal-text-color: #1a2e05;
6493     -2256     -    116 +  --mermaid-label-box-bkg-color: #d9f99d;
6494     -2257     -    117 +  --mermaid-label-box-border-color: #15803d;
6495     -2258     -    118 +  --mermaid-label-text-color: #1a2e05;
6496     -2259     -    119 +  --mermaid-loop-text-color: #1a2e05;
6497     -2260     -    120 +  --mermaid-activation-border-color: #16a34a;
6498     -2261     -    121 +  --mermaid-activation-bkg-color: #ecfccb;
6499     -2262     -    122 +  --mermaid-sequence-number-color: #1a2e05;
6500     -2263     -    123 +
6501     -2264     -    124 +  /* Pie Chart */
6502     -2265     -    125 +  --mermaid-pie1: #15803d;
6503     -2266     -    126 +  --mermaid-pie2: #16a34a;
6504     -2267     -    127 +  --mermaid-pie3: #22c55e;
6505     -2268     -    128 +  --mermaid-pie4: #4ade80;
6506     -2269     -    129 +  --mermaid-pie5: #84cc16;
6507     -2270     -    130 +  --mermaid-pie6: #a3e635;
6508     -2271     -    131 +  --mermaid-pie7: #14b8a6;
6509     -2272     -    132 +  --mermaid-pie8: #facc15;
6510     -2273     -    133 +  --mermaid-pie9: #b45309;
6511     -2274     -    134 +  --mermaid-pie10: #15803d;
6512     -2275     -    135 +  --mermaid-pie11: #16a34a;
6513     -2276     -    136 +  --mermaid-pie12: #22c55e;
6514     -2277     -    137 +  --mermaid-pie-title-text-color: #1a2e05;
6515     -2278     -    138 +  --mermaid-pie-section-text-color: #f7fee7; /* Light on vibrant slices */
6516     -2279     -    139 +  --mermaid-pie-legend-text-color: #1a2e05;
6517     -2280     -    140 +  --mermaid-pie-stroke-color: #15803d;
6518     -2281     -    141 +  --mermaid-pie-outer-stroke-color: #15803d;
6519     -2282     -    142 +
6520     -2283     -    143 +  /* State Diagram */
6521     -2284     -    144 +  --mermaid-label-color: #1a2e05;
6522     -2285     -    145 +  --mermaid-alt-background: #ecfccb;
6523     -2286     -    146 +
6524     -2287     -    147 +  /* Class Diagram */
6525     -2288     -    148 +  --mermaid-class-text: #1a2e05;
6526     -2289     -    149 +
6527     -2290     -    150 +  /* User Journey */
6528     -2291     -    151 +  --mermaid-fill-type0: #15803d;
6529     -2292     -    152 +  --mermaid-fill-type1: #16a34a;
6530     -2293     -    153 +  --mermaid-fill-type2: #22c55e;
6531     -2294     -    154 +  --mermaid-fill-type3: #4ade80;
6532     -2295     -    155 +  --mermaid-fill-type4: #84cc16;
6533     -2296     -    156 +  --mermaid-fill-type5: #a3e635;
6534     -2297     -    157 +  --mermaid-fill-type6: #14b8a6;
6535     -2298     -    158 +  --mermaid-fill-type7: #facc15;
6536     -2299     - 47 159  }
6537     -2300     - 48 160  
6538     -2301     -
6539     -2302     -```
6540     -2303     -
6541     -2304     -
6542     -2305     -### üìÑ `themes/neon-dark.css`
6543     -2306     -
6544     -2307     -**Type:** Stylesheet üé®
6545     -2308     -
6546     -2309     -```diff
6547     -2310     -@@ -1,11 +1,11 @@
6548     -2311     -  1     -/* Neon Dark Theme */
6549     -2312     -      1 +/* Neon Dark Theme - Cyberpunk Aesthetic */
6550     -2313     -  2   2  :root {
6551     -2314     -  3     -  --bg-primary: #0d0d0d;
6552     -2315     -  4     -  --bg-secondary: #1a1a1a;
6553     -2316     -  5     -  --bg-tertiary: #262626;
6554     -2317     -  6     -  --text-primary: #ffffff;
6555     -2318     -  7     -  --text-secondary: #a3a3a3;
6556     -2319     -  8     -  --border-color: #404040;
6557     -2320     -      3 +  --bg-primary: #0a0e1a; /* Dark blue-purple, not pure black */
6558     -2321     -      4 +  --bg-secondary: #141827; /* Dark navy with purple tint */
6559     -2322     -      5 +  --bg-tertiary: #1e2539; /* Lighter navy */
6560     -2323     -      6 +  --text-primary: #e0e7ff; /* Slightly blue-tinted white */
6561     -2324     -      7 +  --text-secondary: #a5b4fc; /* Light indigo */
6562     -2325     -      8 +  --border-color: #4c1d95; /* Purple border for neon feel */
6563     -2326     -  9   9  
6564     -2327     - 10  10    --h1-color: #ff006e;
6565     -2328     - 11  11    --h2-color: #8338ec;
6566     -2329     -@@ -17,31 +17,143 @@
6567     -2330     - 17  17    --link-color: #ff006e;
6568     -2331     - 18  18    --link-hover: #ff1a8c;
6569     -2332     - 19  19  
6570     -2333     - 20     -  /* Code Colors */
6571     -2334     - 21     -  --code-bg: #1a1a1a;
6572     -2335     -     20 +  /* Code Colors - Neonic with purple glow */
6573     -2336     -     21 +  --code-bg: rgba(131, 56, 236, 0.15); /* Purple-tinted background */
6574     -2337     - 22  22    --code-text: #00f5d4;
6575     -2338     - 23     -  --code-block-bg: #0d0d0d;
6576     -2339     - 24     -  --code-border: #404040;
6577     -2340     -     23 +  --code-block-bg: #0f1419; /* Dark blue-black with hint of purple */
6578     -2341     -     24 +  --code-border: rgba(255, 0, 110, 0.3); /* Pink glow border */
6579     -2342     - 25  25  
6580     -2343     - 26     -  /* Syntax Highlighting - Comprehensive Token Colors */
6581     -2344     - 27     -  --syntax-keyword: #ff006e;
6582     -2345     - 28     -  --syntax-string: #00f5d4;
6583     -2346     - 29     -  --syntax-number: #ffbe0b;
6584     -2347     - 30     -  --syntax-function: #8338ec;
6585     -2348     - 31     -  --syntax-comment: #737373;
6586     -2349     - 32     -  --syntax-operator: #ff1a8c;
6587     -2350     - 33     -  --syntax-punctuation: #a3a3a3;
6588     -2351     -     26 +  /* Syntax Highlighting - Production-Grade Token Colors (One Dark Architecture) */
6589     -2352     - 34  27  
6590     -2353     - 35     -  /* Additional Token Types */
6591     -2354     - 36     -  --syntax-variable: #3a86ff; /* Variables - bright blue (distinct from text #ffffff) */
6592     -2355     - 37     -  --syntax-property: #8338ec; /* Properties - purple */
6593     -2356     - 38     -  --syntax-namespace: #ff006e; /* Namespaces - neon pink */
6594     -2357     - 39     -  --syntax-builtin: #00f5d4; /* Builtins - cyan */
6595     -2358     -     28 +  /* Core hue-1: Cyan - URLs */
6596     -2359     -     29 +  --syntax-url: #00f5d4; /* Electric cyan for URLs */
6597     -2360     -     30 +
6598     -2361     -     31 +  /* Core hue-2: Purple/Blue - Functions, variables */
6599     -2362     -     32 +  --syntax-function: #8338ec; /* Neon purple for functions */
6600     -2363     -     33 +  --syntax-variable: #3a86ff; /* Electric blue for variables */
6601     -2364     -     34 +
6602     -2365     -     35 +  /* Core hue-3: Pink - Keywords */
6603     -2366     -     36 +  --syntax-keyword: #ff006e; /* Hot pink for keywords (final, sealed, class) */
6604     -2367     -     37 +
6605     -2368     -     38 +  /* Core hue-4: Cyan/Teal - Strings, builtins */
6606     -2369     -     39 +  --syntax-string: #00f5d4; /* Electric cyan for strings */
6607     -2370     -     40 +  --syntax-builtin: #00d4aa; /* Bright teal for builtins (String, List) */
6608     -2371     -     41 +  --syntax-char: #00f5d4; /* Same as strings */
6609     -2372     -     42 +  --syntax-regex: #00f5d4; /* Same as strings */
6610     -2373     -     43 +  --syntax-inserted: #00d4aa; /* For diff */
6611     -2374     -     44 +
6612     -2375     -     45 +  /* Core hue-5: Orange/Red - Properties, tags */
6613     -2376     -     46 +  --syntax-property: #fb5607; /* Neon orange for properties */
6614     -2377     -     47 +  --syntax-tag: #ff006e; /* Hot pink for tags */
6615     -2378     -     48 +  --syntax-deleted: #ff006e; /* Pink for diff */
6616     -2379     -     49 +  --syntax-important: #fb5607; /* Orange for !important */
6617     -2380     -     50 +
6618     -2381     -     51 +  /* Core hue-6: Yellow/Purple - Class names, constants, numbers */
6619     -2382     -     52 +  --syntax-class-name: #ffbe0b; /* Electric yellow for class names (Rectangle, Shape) */
6620     -2383     -     53 +  --syntax-number: #ffbe0b; /* Yellow for numbers */
6621     -2384     -     54 +  --syntax-constant: #fb5607; /* Orange for constants */
6622     -2385     -     55 +  --syntax-boolean: #ffbe0b; /* Same as numbers */
6623     -2386     -     56 +  --syntax-atrule: #8338ec; /* Purple for CSS @ rules */
6624     -2387     -     57 +
6625     -2388     -     58 +  /* Neutral colors */
6626     -2389     -     59 +  --syntax-comment: #737373; /* Gray for comments */
6627     -2390     -     60 +  --syntax-punctuation: #a3a3a3; /* Light gray for punctuation */
6628     -2391     -     61 +  --syntax-operator: #ff1a8c; /* Pink for operators */
6629     -2392     -     62 +
6630     -2393     -     63 +  /* Markup specific */
6631     -2394     -     64 +  --syntax-attr-name: #ffbe0b; /* Yellow like class-name */
6632     -2395     -     65 +  --syntax-attr-value: #00f5d4; /* Cyan like strings */
6633     -2396     -     66 +  --syntax-namespace: #8338ec; /* Purple */
6634     -2397     -     67 +  --syntax-entity: #a3a3a3; /* Neutral */
6635     -2398     -     68 +  --syntax-selector: #fb5607; /* Orange like properties */
6636     -2399     - 40  69  
6637     -2400     - 41  70    --blockquote-border: #8338ec;
6638     -2401     - 42     -  --blockquote-bg: #1a1a1a;
6639     -2402     -     71 +  --blockquote-bg: rgba(131, 56, 236, 0.1); /* Purple-tinted blockquote */
6640     -2403     - 43  72    --bold-color: #ffbe0b;
6641     -2404     - 44  73    --italic-color: #ff006e;
6642     -2405     - 45     -  --table-header-bg: #262626;
6643     -2406     - 46     -  --table-border: #404040;
6644     -2407     -     74 +  --table-header-bg: rgba(58, 134, 255, 0.15); /* Blue-tinted table header */
6645     -2408     -     75 +  --table-border: rgba(76, 29, 149, 0.3); /* Purple-tinted border */
6646     -2409     -     76 +
6647     -2410     -     77 +  /* === MERMAID COMPREHENSIVE CONFIGURATION === */
6648     -2411     -     78 +
6649     -2412     -     79 +  /* Core Global */
6650     -2413     -     80 +  --mermaid-background: #0a0e1a;
6651     -2414     -     81 +  --mermaid-text-color: #e0e7ff;
6652     -2415     -     82 +  --mermaid-line-color: #3a86ff;
6653     -2416     -     83 +  --mermaid-main-bkg: #1e2539;
6654     -2417     -     84 +
6655     -2418     -     85 +  /* Primary Set */
6656     -2419     -     86 +  --mermaid-primary-color: #1e2539;
6657     -2420     -     87 +  --mermaid-primary-text-color: #e0e7ff;
6658     -2421     -     88 +  --mermaid-primary-border-color: #8338ec;
6659     -2422     -     89 +
6660     -2423     -     90 +  /* Secondary Set */
6661     -2424     -     91 +  --mermaid-secondary-color: #141827;
6662     -2425     -     92 +  --mermaid-secondary-text-color: #e0e7ff;
6663     -2426     -     93 +  --mermaid-secondary-border-color: #3a86ff;
6664     -2427     -     94 +
6665     -2428     -     95 +  /* Tertiary Set */
6666     -2429     -     96 +  --mermaid-tertiary-color: #0a0e1a;
6667     -2430     -     97 +  --mermaid-tertiary-text-color: #e0e7ff;
6668     -2431     -     98 +  --mermaid-tertiary-border-color: #ff006e;
6669     -2432     -     99 +
6670     -2433     -    100 +  /* Flowchart */
6671     -2434     -    101 +  --mermaid-node-border: #8338ec;
6672     -2435     -    102 +  --mermaid-cluster-bkg: #141827;
6673     -2436     -    103 +  --mermaid-cluster-border: #3a86ff;
6674     -2437     -    104 +  --mermaid-default-link-color: #3a86ff;
6675     -2438     -    105 +  --mermaid-title-color: #e0e7ff;
6676     -2439     -    106 +  --mermaid-edge-label-background: #0a0e1a;
6677     -2440     -    107 +  --mermaid-node-text-color: #e0e7ff;
6678     -2441     -    108 +
6679     -2442     -    109 +  /* Sequence Diagram */
6680     -2443     -    110 +  --mermaid-actor-bkg: #1e2539;
6681     -2444     -    111 +  --mermaid-actor-border: #8338ec;
6682     -2445     -    112 +  --mermaid-actor-text-color: #e0e7ff;
6683     -2446     -    113 +  --mermaid-actor-line-color: #8338ec;
6684     -2447     -    114 +  --mermaid-signal-color: #3a86ff;
6685     -2448     -    115 +  --mermaid-signal-text-color: #e0e7ff;
6686     -2449     -    116 +  --mermaid-label-box-bkg-color: #1e2539;
6687     -2450     -    117 +  --mermaid-label-box-border-color: #8338ec;
6688     -2451     -    118 +  --mermaid-label-text-color: #e0e7ff;
6689     -2452     -    119 +  --mermaid-loop-text-color: #e0e7ff;
6690     -2453     -    120 +  --mermaid-activation-border-color: #3a86ff;
6691     -2454     -    121 +  --mermaid-activation-bkg-color: #141827;
6692     -2455     -    122 +  --mermaid-sequence-number-color: #e0e7ff;
6693     -2456     -    123 +
6694     -2457     -    124 +  /* Pie Chart */
6695     -2458     -    125 +  --mermaid-pie1: #ff006e;
6696     -2459     -    126 +  --mermaid-pie2: #8338ec;
6697     -2460     -    127 +  --mermaid-pie3: #3a86ff;
6698     -2461     -    128 +  --mermaid-pie4: #00f5d4;
6699     -2462     -    129 +  --mermaid-pie5: #ffbe0b;
6700     -2463     -    130 +  --mermaid-pie6: #fb5607;
6701     -2464     -    131 +  --mermaid-pie7: #ff1a8c;
6702     -2465     -    132 +  --mermaid-pie8: #00d4aa;
6703     -2466     -    133 +  --mermaid-pie9: #a5b4fc;
6704     -2467     -    134 +  --mermaid-pie10: #ff006e;
6705     -2468     -    135 +  --mermaid-pie11: #8338ec;
6706     -2469     -    136 +  --mermaid-pie12: #3a86ff;
6707     -2470     -    137 +  --mermaid-pie-title-text-color: #e0e7ff;
6708     -2471     -    138 +  --mermaid-pie-section-text-color: #0a0e1a; /* Dark on vibrant slices */
6709     -2472     -    139 +  --mermaid-pie-legend-text-color: #e0e7ff;
6710     -2473     -    140 +  --mermaid-pie-stroke-color: #8338ec;
6711     -2474     -    141 +  --mermaid-pie-outer-stroke-color: #8338ec;
6712     -2475     -    142 +
6713     -2476     -    143 +  /* State Diagram */
6714     -2477     -    144 +  --mermaid-label-color: #e0e7ff;
6715     -2478     -    145 +  --mermaid-alt-background: #141827;
6716     -2479     -    146 +
6717     -2480     -    147 +  /* Class Diagram */
6718     -2481     -    148 +  --mermaid-class-text: #e0e7ff;
6719     -2482     -    149 +
6720     -2483     -    150 +  /* User Journey */
6721     -2484     -    151 +  --mermaid-fill-type0: #ff006e;
6722     -2485     -    152 +  --mermaid-fill-type1: #8338ec;
6723     -2486     -    153 +  --mermaid-fill-type2: #3a86ff;
6724     -2487     -    154 +  --mermaid-fill-type3: #00f5d4;
6725     -2488     -    155 +  --mermaid-fill-type4: #ffbe0b;
6726     -2489     -    156 +  --mermaid-fill-type5: #fb5607;
6727     -2490     -    157 +  --mermaid-fill-type6: #ff1a8c;
6728     -2491     -    158 +  --mermaid-fill-type7: #00d4aa;
6729     -2492     - 47 159  }
6730     -2493     - 48 160  
6731     -2494     -
6732     -2495     -```
6733     -2496     -
6734     -2497     -
6735     -2498     -### üìÑ `themes/neon-light.css`
6736     -2499     -
6737     -2500     -**Type:** Stylesheet üé®
6738     -2501     -
6739     -2502     -```diff
6740     -2503     -@@ -23,20 +23,49 @@
6741     -2504     - 23  23    --code-block-bg: #fef3ff; /* Light purple background */
6742     -2505     - 24  24    --code-border: #e9d5ff;
6743     -2506     - 25  25  
6744     -2507     - 26     -  /* Syntax Highlighting - Comprehensive Token Colors */
6745     -2508     - 27     -  --syntax-keyword: #c026d3;
6746     -2509     - 28     -  --syntax-string: #10b981;
6747     -2510     - 29     -  --syntax-number: #f59e0b;
6748     -2511     - 30     -  --syntax-function: #7c3aed;
6749     -2512     - 31     -  --syntax-comment: #9ca3af;
6750     -2513     - 32     -  --syntax-operator: #a21caf;
6751     -2514     - 33     -  --syntax-punctuation: #6b7280;
6752     -2515     -     26 +  /* Syntax Highlighting - Production-Grade Token Colors (One Dark Architecture) */
6753     -2516     - 34  27  
6754     -2517     - 35     -  /* Additional Token Types for Full Customization */
6755     -2518     - 36     -  --syntax-variable: #7c3aed; /* Variables - purple */
6756     -2519     - 37     -  --syntax-property: #a21caf; /* Properties - magenta */
6757     -2520     - 38     -  --syntax-namespace: #c026d3; /* Namespaces - pink */
6758     -2521     - 39     -  --syntax-builtin: #7c3aed; /* Builtins - purple */
6759     -2522     -     28 +  /* Core hue-1: Cyan - URLs */
6760     -2523     -     29 +  --syntax-url: #06b6d4; /* Cyan for URLs */
6761     -2524     -     30 +
6762     -2525     -     31 +  /* Core hue-2: Purple/Violet - Functions, variables */
6763     -2526     -     32 +  --syntax-function: #7c3aed; /* Vibrant purple for functions */
6764     -2527     -     33 +  --syntax-variable: #6366f1; /* Indigo for variables */
6765     -2528     -     34 +
6766     -2529     -     35 +  /* Core hue-3: Magenta - Keywords */
6767     -2530     -     36 +  --syntax-keyword: #c026d3; /* Bright magenta for keywords (final, sealed, class) */
6768     -2531     -     37 +
6769     -2532     -     38 +  /* Core hue-4: Green - Strings, builtins */
6770     -2533     -     39 +  --syntax-string: #10b981; /* Emerald green for strings */
6771     -2534     -     40 +  --syntax-builtin: #059669; /* Dark emerald for builtins (String, List) */
6772     -2535     -     41 +  --syntax-char: #10b981; /* Same as strings */
6773     -2536     -     42 +  --syntax-regex: #10b981; /* Same as strings */
6774     -2537     -     43 +  --syntax-inserted: #10b981; /* For diff */
6775     -2538     -     44 +
6776     -2539     -     45 +  /* Core hue-5: Blue - Properties, tags */
6777     -2540     -     46 +  --syntax-property: #3b82f6; /* Blue for properties */
6778     -2541     -     47 +  --syntax-tag: #2563eb; /* Dark blue for tags */
6779     -2542     -     48 +  --syntax-deleted: #ef4444; /* Red for diff */
6780     -2543     -     49 +  --syntax-important: #3b82f6; /* Blue for !important */
6781     -2544     -     50 +
6782     -2545     -     51 +  /* Core hue-6: Amber/Pink - Class names, constants, numbers */
6783     -2546     -     52 +  --syntax-class-name: #d946ef; /* Fuchsia for class names (Rectangle, Shape) */
6784     -2547     -     53 +  --syntax-number: #f59e0b; /* Amber for numbers */
6785     -2548     -     54 +  --syntax-constant: #c026d3; /* Magenta for constants */
6786     -2549     -     55 +  --syntax-boolean: #f59e0b; /* Same as numbers */
6787     -2550     -     56 +  --syntax-atrule: #d946ef; /* Fuchsia for CSS @ rules */
6788     -2551     -     57 +
6789     -2552     -     58 +  /* Neutral colors */
6790     -2553     -     59 +  --syntax-comment: #9ca3af; /* Gray for comments */
6791     -2554     -     60 +  --syntax-punctuation: #6b7280; /* Dark gray for punctuation */
6792     -2555     -     61 +  --syntax-operator: #a21caf; /* Magenta-pink for operators */
6793     -2556     -     62 +
6794     -2557     -     63 +  /* Markup specific */
6795     -2558     -     64 +  --syntax-attr-name: #d946ef; /* Fuchsia like class-name */
6796     -2559     -     65 +  --syntax-attr-value: #10b981; /* Green like strings */
6797     -2560     -     66 +  --syntax-namespace: #7c3aed; /* Purple like keywords */
6798     -2561     -     67 +  --syntax-entity: #6b7280; /* Neutral */
6799     -2562     -     68 +  --syntax-selector: #3b82f6; /* Blue like properties */
6800     -2563     - 40  69  
6801     -2564     - 41  70    --blockquote-border: #c026d3;
6802     -2565     - 42  71    --blockquote-bg: #fef3ff;
6803     -2566     -@@ -44,4 +73,87 @@
6804     -2567     - 44  73    --italic-color: #c026d3;
6805     -2568     - 45  74    --table-header-bg: #fce7f3;
6806     -2569     - 46  75    --table-border: #e9d5ff;
6807     -2570     -     76 +
6808     -2571     -     77 +  /* === MERMAID COMPREHENSIVE CONFIGURATION === */
6809     -2572     -     78 +
6810     -2573     -     79 +  /* Core Global */
6811     -2574     -     80 +  --mermaid-background: #ffffff;
6812     -2575     -     81 +  --mermaid-text-color: #3b0764;
6813     -2576     -     82 +  --mermaid-line-color: #7c3aed;
6814     -2577     -     83 +  --mermaid-main-bkg: #fce7f3;
6815     -2578     -     84 +
6816     -2579     -     85 +  /* Primary Set */
6817     -2580     -     86 +  --mermaid-primary-color: #fce7f3;
6818     -2581     -     87 +  --mermaid-primary-text-color: #3b0764;
6819     -2582     -     88 +  --mermaid-primary-border-color: #c026d3;
6820     -2583     -     89 +
6821     -2584     -     90 +  /* Secondary Set */
6822     -2585     -     91 +  --mermaid-secondary-color: #fef3ff;
6823     -2586     -     92 +  --mermaid-secondary-text-color: #3b0764;
6824     -2587     -     93 +  --mermaid-secondary-border-color: #7c3aed;
6825     -2588     -     94 +
6826     -2589     -     95 +  /* Tertiary Set */
6827     -2590     -     96 +  --mermaid-tertiary-color: #ffffff;
6828     -2591     -     97 +  --mermaid-tertiary-text-color: #3b0764;
6829     -2592     -     98 +  --mermaid-tertiary-border-color: #d946ef;
6830     -2593     -     99 +
6831     -2594     -    100 +  /* Flowchart */
6832     -2595     -    101 +  --mermaid-node-border: #c026d3;
6833     -2596     -    102 +  --mermaid-cluster-bkg: #fef3ff;
6834     -2597     -    103 +  --mermaid-cluster-border: #7c3aed;
6835     -2598     -    104 +  --mermaid-default-link-color: #7c3aed;
6836     -2599     -    105 +  --mermaid-title-color: #3b0764;
6837     -2600     -    106 +  --mermaid-edge-label-background: #ffffff;
6838     -2601     -    107 +  --mermaid-node-text-color: #3b0764;
6839     -2602     -    108 +
6840     -2603     -    109 +  /* Sequence Diagram */
6841     -2604     -    110 +  --mermaid-actor-bkg: #fce7f3;
6842     -2605     -    111 +  --mermaid-actor-border: #c026d3;
6843     -2606     -    112 +  --mermaid-actor-text-color: #3b0764;
6844     -2607     -    113 +  --mermaid-actor-line-color: #c026d3;
6845     -2608     -    114 +  --mermaid-signal-color: #7c3aed;
6846     -2609     -    115 +  --mermaid-signal-text-color: #3b0764;
6847     -2610     -    116 +  --mermaid-label-box-bkg-color: #fce7f3;
6848     -2611     -    117 +  --mermaid-label-box-border-color: #c026d3;
6849     -2612     -    118 +  --mermaid-label-text-color: #3b0764;
6850     -2613     -    119 +  --mermaid-loop-text-color: #3b0764;
6851     -2614     -    120 +  --mermaid-activation-border-color: #7c3aed;
6852     -2615     -    121 +  --mermaid-activation-bkg-color: #fef3ff;
6853     -2616     -    122 +  --mermaid-sequence-number-color: #3b0764;
6854     -2617     -    123 +
6855     -2618     -    124 +  /* Pie Chart */
6856     -2619     -    125 +  --mermaid-pie1: #c026d3;
6857     -2620     -    126 +  --mermaid-pie2: #7c3aed;
6858     -2621     -    127 +  --mermaid-pie3: #3b82f6;
6859     -2622     -    128 +  --mermaid-pie4: #06b6d4;
6860     -2623     -    129 +  --mermaid-pie5: #f59e0b;
6861     -2624     -    130 +  --mermaid-pie6: #ef4444;
6862     -2625     -    131 +  --mermaid-pie7: #d946ef;
6863     -2626     -    132 +  --mermaid-pie8: #6366f1;
6864     -2627     -    133 +  --mermaid-pie9: #10b981;
6865     -2628     -    134 +  --mermaid-pie10: #c026d3;
6866     -2629     -    135 +  --mermaid-pie11: #7c3aed;
6867     -2630     -    136 +  --mermaid-pie12: #3b82f6;
6868     -2631     -    137 +  --mermaid-pie-title-text-color: #3b0764;
6869     -2632     -    138 +  --mermaid-pie-section-text-color: #ffffff; /* White on vibrant slices */
6870     -2633     -    139 +  --mermaid-pie-legend-text-color: #3b0764;
6871     -2634     -    140 +  --mermaid-pie-stroke-color: #c026d3;
6872     -2635     -    141 +  --mermaid-pie-outer-stroke-color: #c026d3;
6873     -2636     -    142 +
6874     -2637     -    143 +  /* State Diagram */
6875     -2638     -    144 +  --mermaid-label-color: #3b0764;
6876     -2639     -    145 +  --mermaid-alt-background: #fef3ff;
6877     -2640     -    146 +
6878     -2641     -    147 +  /* Class Diagram */
6879     -2642     -    148 +  --mermaid-class-text: #3b0764;
6880     -2643     -    149 +
6881     -2644     -    150 +  /* User Journey */
6882     -2645     -    151 +  --mermaid-fill-type0: #c026d3;
6883     -2646     -    152 +  --mermaid-fill-type1: #7c3aed;
6884     -2647     -    153 +  --mermaid-fill-type2: #3b82f6;
6885     -2648     -    154 +  --mermaid-fill-type3: #06b6d4;
6886     -2649     -    155 +  --mermaid-fill-type4: #f59e0b;
6887     -2650     -    156 +  --mermaid-fill-type5: #ef4444;
6888     -2651     -    157 +  --mermaid-fill-type6: #d946ef;
6889     -2652     -    158 +  --mermaid-fill-type7: #6366f1;
6890     -2653     - 47 159  }
6891     -2654     - 48 160  
6892     -2655     -
6893     -2656     -```
6894     -2657     -
6895     -2658     -
6896     -2659     -### üìÑ `themes/obsidian-dark.css`
6897     -2660     -
6898     -2661     -**Type:** Stylesheet üé®
6899     -2662     -
6900     -2663     -```diff
6901     -2664     -@@ -52,20 +52,49 @@
6902     -2665     - 52  52    --code-block-bg: #232635;
6903     -2666     - 53  53    --code-border: rgba(78, 205, 196, 0.2);
6904     -2667     - 54  54  
6905     -2668     - 55     -  /* Syntax Highlighting */
6906     -2669     - 56     -  --syntax-keyword: #c792ea;
6907     -2670     - 57     -  --syntax-string: #6bcf7f;
6908     -2671     - 58     -  --syntax-number: #ffcb6b;
6909     -2672     - 59     -  --syntax-function: #82aaff;
6910     -2673     - 60     -  --syntax-comment: #7f85a3;
6911     -2674     - 61     -  --syntax-operator: #89ddff;
6912     -2675     - 62     -  --syntax-punctuation: #b8bcc8;
6913     -2676     -     55 +  /* Syntax Highlighting - Production-Grade Token Colors (One Dark Architecture) */
6914     -2677     - 63  56  
6915     -2678     - 64     -  /* Additional Token Types */
6916     -2679     - 65     -  --syntax-variable: #82aaff; /* Variables - blue (distinct from text #f5f7ff) */
6917     -2680     - 66     -  --syntax-property: #4ecdc4; /* Properties - cyan */
6918     -2681     - 67     -  --syntax-namespace: #ffb86c; /* Namespaces - orange */
6919     -2682     - 68     -  --syntax-builtin: #c77dff; /* Builtins - purple */
6920     -2683     -     57 +  /* Core hue-1: Cyan - URLs */
6921     -2684     -     58 +  --syntax-url: #4ecdc4; /* Bright cyan for URLs */
6922     -2685     -     59 +
6923     -2686     -     60 +  /* Core hue-2: Blue - Functions, variables */
6924     -2687     -     61 +  --syntax-function: #82aaff; /* Bright blue for functions */
6925     -2688     -     62 +  --syntax-variable: #5da9ff; /* Sky blue for variables */
6926     -2689     -     63 +
6927     -2690     -     64 +  /* Core hue-3: Purple - Keywords */
6928     -2691     -     65 +  --syntax-keyword: #c792ea; /* Lavender purple for keywords (final, sealed, class) */
6929     -2692     -     66 +
6930     -2693     -     67 +  /* Core hue-4: Green - Strings, builtins */
6931     -2694     -     68 +  --syntax-string: #95e1d3; /* Mint green for strings */
6932     -2695     -     69 +  --syntax-builtin: #6bcf7f; /* Vibrant green for builtins (String, List) */
6933     -2696     -     70 +  --syntax-char: #95e1d3; /* Same as strings */
6934     -2697     -     71 +  --syntax-regex: #95e1d3; /* Same as strings */
6935     -2698     -     72 +  --syntax-inserted: #6bcf7f; /* For diff */
6936     -2699     -     73 +
6937     -2700     -     74 +  /* Core hue-5: Pink - Properties, tags */
6938     -2701     -     75 +  --syntax-property: #ff6b9d; /* Hot pink for properties */
6939     -2702     -     76 +  --syntax-tag: #ff7eb3; /* Coral pink for tags */
6940     -2703     -     77 +  --syntax-deleted: #f38ba8; /* Pink-red for diff */
6941     -2704     -     78 +  --syntax-important: #ff6b9d; /* Hot pink for !important */
6942     -2705     -     79 +
6943     -2706     -     80 +  /* Core hue-6: Yellow/Orange - Class names, constants, numbers */
6944     -2707     -     81 +  --syntax-class-name: #ffb86c; /* Peach orange for class names (Rectangle, Shape) */
6945     -2708     -     82 +  --syntax-number: #ffd93d; /* Bright yellow for numbers */
6946     -2709     -     83 +  --syntax-constant: #ffb86c; /* Peach for constants */
6947     -2710     -     84 +  --syntax-boolean: #ffd93d; /* Same as numbers */
6948     -2711     -     85 +  --syntax-atrule: #c77dff; /* Purple for CSS @ rules */
6949     -2712     -     86 +
6950     -2713     -     87 +  /* Neutral colors */
6951     -2714     -     88 +  --syntax-comment: #7f85a3; /* Muted blue-gray for comments */
6952     -2715     -     89 +  --syntax-punctuation: #b8bcc8; /* Light gray for punctuation */
6953     -2716     -     90 +  --syntax-operator: #89ddff; /* Cyan for operators */
6954     -2717     -     91 +
6955     -2718     -     92 +  /* Markup specific */
6956     -2719     -     93 +  --syntax-attr-name: #ffb86c; /* Peach like class-name */
6957     -2720     -     94 +  --syntax-attr-value: #95e1d3; /* Mint like strings */
6958     -2721     -     95 +  --syntax-namespace: #c792ea; /* Purple like keywords */
6959     -2722     -     96 +  --syntax-entity: #b8bcc8; /* Neutral */
6960     -2723     -     97 +  --syntax-selector: #ff6b9d; /* Pink like properties */
6961     -2724     - 69  98  
6962     -2725     - 70  99    /* Blockquote */
6963     -2726     - 71 100    --blockquote-border: #ff6b9d;
6964     -2727     -@@ -77,4 +106,87 @@
6965     -2728     - 77 106  
6966     -2729     - 78 107    /* Border */
6967     -2730     - 79 108    --border-color: rgba(255, 255, 255, 0.1);
6968     -2731     -    109 +
6969     -2732     -    110 +  /* === MERMAID COMPREHENSIVE CONFIGURATION === */
6970     -2733     -    111 +
6971     -2734     -    112 +  /* Core Global */
6972     -2735     -    113 +  --mermaid-background: #1e1e2e;
6973     -2736     -    114 +  --mermaid-text-color: #f5f7ff;
6974     -2737     -    115 +  --mermaid-line-color: #82aaff;
6975     -2738     -    116 +  --mermaid-main-bkg: #383a4f;
6976     -    4244 +    110 +### 12. üêõ Error Handling in `loadTheme` (Line 1008)
6977     -    4245 +    111 +```javascript
6978     -    4246 +    112 +.catch(err => {
6979     -    4247 +    113 +  console.error('Failed to load saved theme:', err);
6980     -    4248 +    114 +  // Fallback to default-light
6981     -    4249 +    115 +```
6982     -    4250 +    116 +**Critique:** Good fallback logic, but `alert()` or `toast` missing. User won't know why their theme didn't load.
6983     -2739 4251      117 +
6984     -2740     -    118 +  /* Primary Set */
6985     -2741     -    119 +  --mermaid-primary-color: #383a4f;
6986     -2742     -    120 +  --mermaid-primary-text-color: #f5f7ff;
6987     -2743     -    121 +  --mermaid-primary-border-color: #ff6b9d;
6988     -2744     -    122 +
6989     -2745     -    123 +  /* Secondary Set */
6990     -2746     -    124 +  --mermaid-secondary-color: #2b2d3e;
6991     -2747     -    125 +  --mermaid-secondary-text-color: #f5f7ff;
6992     -2748     -    126 +  --mermaid-secondary-border-color: #82aaff;
6993     -2749     -    127 +
6994     -2750     -    128 +  /* Tertiary Set */
6995     -2751     -    129 +  --mermaid-tertiary-color: #1e1e2e;
6996     -2752     -    130 +  --mermaid-tertiary-text-color: #f5f7ff;
6997     -2753     -    131 +  --mermaid-tertiary-border-color: #4ecdc4;
6998     -2754     -    132 +
6999     -2755     -    133 +  /* Flowchart */
7000     -2756     -    134 +  --mermaid-node-border: #ff6b9d;
7001     -2757     -    135 +  --mermaid-cluster-bkg: #2b2d3e;
7002     -2758     -    136 +  --mermaid-cluster-border: #82aaff;
7003     -2759     -    137 +  --mermaid-default-link-color: #82aaff;
7004     -2760     -    138 +  --mermaid-title-color: #f5f7ff;
7005     -2761     -    139 +  --mermaid-edge-label-background: #1e1e2e;
7006     -2762     -    140 +  --mermaid-node-text-color: #f5f7ff;
7007     -2763     -    141 +
7008     -2764     -    142 +  /* Sequence Diagram */
7009     -2765     -    143 +  --mermaid-actor-bkg: #383a4f;
7010     -2766     -    144 +  --mermaid-actor-border: #ff6b9d;
7011     -2767     -    145 +  --mermaid-actor-text-color: #f5f7ff;
7012     -2768     -    146 +  --mermaid-actor-line-color: #ff6b9d;
7013     -2769     -    147 +  --mermaid-signal-color: #82aaff;
7014     -2770     -    148 +  --mermaid-signal-text-color: #f5f7ff;
7015     -2771     -    149 +  --mermaid-label-box-bkg-color: #383a4f;
7016     -2772     -    150 +  --mermaid-label-box-border-color: #ff6b9d;
7017     -2773     -    151 +  --mermaid-label-text-color: #f5f7ff;
7018     -2774     -    152 +  --mermaid-loop-text-color: #f5f7ff;
7019     -2775     -    153 +  --mermaid-activation-border-color: #82aaff;
7020     -2776     -    154 +  --mermaid-activation-bkg-color: #2b2d3e;
7021     -2777     -    155 +  --mermaid-sequence-number-color: #f5f7ff;
7022     -2778     -    156 +
7023     -2779     -    157 +  /* Pie Chart */
7024     -2780     -    158 +  --mermaid-pie1: #ff6b9d;
7025     -2781     -    159 +  --mermaid-pie2: #ffd93d;
7026     -2782     -    160 +  --mermaid-pie3: #4ecdc4;
7027     -2783     -    161 +  --mermaid-pie4: #c77dff;
7028     -2784     -    162 +  --mermaid-pie5: #ffb86c;
7029     -2785     -    163 +  --mermaid-pie6: #95e1d3;
7030     -2786     -    164 +  --mermaid-pie7: #82aaff;
7031     -2787     -    165 +  --mermaid-pie8: #ff7eb3;
7032     -2788     -    166 +  --mermaid-pie9: #c8f6c2;
7033     -2789     -    167 +  --mermaid-pie10: #89dceb;
7034     -2790     -    168 +  --mermaid-pie11: #ff6b9d;
7035     -2791     -    169 +  --mermaid-pie12: #ffd93d;
7036     -2792     -    170 +  --mermaid-pie-title-text-color: #f5f7ff;
7037     -2793     -    171 +  --mermaid-pie-section-text-color: #1e1e2e; /* Dark on vibrant slices */
7038     -2794     -    172 +  --mermaid-pie-legend-text-color: #f5f7ff;
7039     -2795     -    173 +  --mermaid-pie-stroke-color: #ff6b9d;
7040     -2796     -    174 +  --mermaid-pie-outer-stroke-color: #ff6b9d;
7041     -2797     -    175 +
7042     -2798     -    176 +  /* State Diagram */
7043     -2799     -    177 +  --mermaid-label-color: #f5f7ff;
7044     -2800     -    178 +  --mermaid-alt-background: #2b2d3e;
7045     -2801     -    179 +
7046     -2802     -    180 +  /* Class Diagram */
7047     -2803     -    181 +  --mermaid-class-text: #f5f7ff;
7048     -2804     -    182 +
7049     -2805     -    183 +  /* User Journey */
7050     -2806     -    184 +  --mermaid-fill-type0: #ff6b9d;
7051     -2807     -    185 +  --mermaid-fill-type1: #ffd93d;
7052     -2808     -    186 +  --mermaid-fill-type2: #4ecdc4;
7053     -2809     -    187 +  --mermaid-fill-type3: #c77dff;
7054     -2810     -    188 +  --mermaid-fill-type4: #ffb86c;
7055     -2811     -    189 +  --mermaid-fill-type5: #95e1d3;
7056     -2812     -    190 +  --mermaid-fill-type6: #82aaff;
7057     -2813     -    191 +  --mermaid-fill-type7: #ff7eb3;
7058     -2814     - 80 192  }
7059     -2815     - 81 193  
7060     -    4252 +    118 +---
7061     -    4253 +    119 +
7062     -    4254 +    120 +## ‚úÖ Summary
7063     -    4255 +    121 +The code works "happy path" but is brittle. The usage of `setTimeout` for flow control and the lack of debouncing are the biggest "Senior SDE" red flags. The Security hole (XSS) is a blocker for any production release.
7064     -    4256 +    122  
7065     -2816 4257  
7066     -2817 4258  ```
7067     -2818 4259  
7068     -2819 4260  
7069     -2820     -### üìÑ `themes/obsidian-light.css`
7070     -    4261 +### ‚ú® `codebase_audit/deep_dive_reviews/theme_manager_review.md` **[ADDED]**
7071     -2821 4262  
7072     -2822     -**Type:** Stylesheet üé®
7073     -    4263 +**Status:** ‚úÖ **NEW FILE** - This file has been newly created
7074     -    4264 +
7075     -    4265 +**Type:** Documentation üìñ
7076     -2823 4266  
7077     -2824 4267  ```diff
7078     -2825     -@@ -52,20 +52,49 @@
7079     -2826     - 52  52    --code-block-bg: #f8f9fc;
7080     -2827     - 53  53    --code-border: rgba(0, 188, 212, 0.2);
7081     -2828     - 54  54  
7082     -2829     - 55     -  /* Syntax Highlighting - Comprehensive Token Colors */
7083     -2830     - 56     -  --syntax-keyword: #9c27b0;
7084     -2831     - 57     -  --syntax-string: #4caf50;
7085     -2832     - 58     -  --syntax-number: #f57c00;
7086     -2833     - 59     -  --syntax-function: #2196f3;
7087     -2834     - 60     -  --syntax-comment: #9e9e9e;
7088     -2835     - 61     -  --syntax-operator: #00bcd4;
7089     -2836     - 62     -  --syntax-punctuation: #616161;
7090     -2837     -     55 +  /* Syntax Highlighting - Production-Grade Token Colors (One Dark Architecture) */
7091     -2838     - 63  56  
7092     -2839     - 64     -  /* Additional Token Types for Full Customization */
7093     -2840     - 65     -  --syntax-variable: #2196f3; /* Variables, parameters - bright blue */
7094     -2841     - 66     -  --syntax-property: #00bcd4; /* Properties - cyan */
7095     -2842     - 67     -  --syntax-namespace: #f57c00; /* Namespaces - orange */
7096     -2843     - 68     -  --syntax-builtin: #9c27b0; /* Built-in functions - purple */
7097     -2844     -     57 +  /* Core hue-1: Cyan - URLs */
7098     -2845     -     58 +  --syntax-url: #00bcd4; /* Cyan for URLs */
7099     -2846     -     59 +
7100     -2847     -     60 +  /* Core hue-2: Blue - Functions, variables */
7101     -2848     -     61 +  --syntax-function: #2196f3; /* Bright blue for functions */
7102     -2849     -     62 +  --syntax-variable: #1976d2; /* Deep blue for variables */
7103     -    4268 +@@ -0,0 +1,53 @@
7104     -    4269 +      1 +# üïµÔ∏è‚Äç‚ôÇÔ∏è Deep Dive Code Review: `ThemeManager.js`
7105     -    4270 +      2 +
7106     -    4271 +      3 +**Reviewer:** CodeBaseGPT (Senior SDE Persona)
7107     -    4272 +      4 +**Date:** 2025-12-09
7108     -    4273 +      5 +**File:** `src/js/core/ThemeManager.js` (263 Lines)
7109     -    4274 +      6 +
7110     -    4275 +      7 +---
7111     -    4276 +      8 +
7112     -    4277 +      9 +## üü¢ strengths
7113     -    4278 +     10 +*   **SOLID Principles:** Class has a clear Single Responsibility.
7114     -    4279 +     11 +*   **Error Handling:** `try...catch` blocks are present in `loadBuiltInTheme` and `loadCustomTheme`.
7115     -    4280 +     12 +*   **JSDoc:** Excellent documentation and usage examples.
7116     -    4281 +     13 +
7117     -    4282 +     14 +## ‚ö†Ô∏è Issues & Observations
7118     -    4283 +     15 +
7119     -    4284 +     16 +### 1. üêå Performance: `clearInlineStyles` (Line 205)
7120     -    4285 +     17 +```javascript
7121     -    4286 +     18 +for (let i = styles.length - 1; i >= 0; i--) {
7122     -    4287 +     19 +  const prop = styles[i];
7123     -    4288 +     20 +  if (prop.startsWith('--')) {
7124     -    4289 +     21 +    removeCssVariable(prop);
7125     -    4290 +     22 +  }
7126     -    4291 +     23 +}
7127     -    4292 +     24 +```
7128     -    4293 +     25 +**Critique:** This loop calls `removeProperty` repeatedly on the root element.
7129     -    4294 +     26 +- **Impact:** Each removal can trigger a Style Recalculation (Reflow) in the browser engine.
7130     -    4295 +     27 +- **Optimization:** If you only use inline styles for custom themes, you could simply clear the `style` attribute: `document.documentElement.removeAttribute('style');` (unless there are other non-theme inline styles needed).
7131     -    4296 +     28 +
7132     -    4297 +     29 +### 2. üß© Hardcoded Variable List (Line 171)
7133     -    4298 +     30 +```javascript
7134     -    4299 +     31 +const cssVarNames = [ '--bg-primary', ... ];
7135     -    4300 +     32 +```
7136     -    4301 +     33 +**Critique:** You manually list 18 variables here to "capture" the current theme colors.
7137     -    4302 +     34 +- **Risk:** This list is a **Maintenance Liability**. If a developer adds a new color (e.g., `--warning-color`) to `style.css` but forgets to add it here, the "Save Custom Theme" feature will silently drop that color.
7138     -    4303 +     35 +- **Fix:** Import this list from `src/js/config/constants.js` (SSOT). Do not define it inside the method.
7139     -    4304 +     36 +
7140     -    4305 +     37 +### 3. üß™ Production Path Resolution (Line 80)
7141     -    4306 +     38 +```javascript
7142     -    4307 +     39 +const baseUrl = import.meta.env.BASE_URL || '/';
7143     -    4308 +     40 +stylesheet.href = `${baseUrl}themes/${themeName}.css`;
7144     -    4309 +     41 +```
7145     -    4310 +     42 +**Critique:** Good job anticipating Vite's `BASE_URL`.
7146     -    4311 +     43 +- **Observation:** Ensure `themes/` folder is actually copied to `dist/` during build. Since they are static assets referenced via code (not import), Vite might not hash/include them unless configured in `vite.config.js` static assets.
7147     -    4312 +     44 +
7148     -    4313 +     45 +### 4. üîí Private Methods (Semantics)
7149     -    4314 +     46 +**Critique:** You use JSDoc `@private` but the methods `loadBuiltInTheme` are technically public.
7150     -    4315 +     47 +- **Suggestion:** Use `#privateFields` (ES2022) if you want true privacy, e.g., `#loadBuiltInTheme`.
7151     -    4316 +     48 +
7152     -    4317 +     49 +---
7153     -    4318 +     50 +
7154     -    4319 +     51 +## üèÅ Verdict
7155     -    4320 +     52 +**Grade: A-**
7156     -    4321 +     53 +This is high-quality code. The issues are mostly maintenance optimizations. The logic is sound.
7157     -    4322 +     54  
7158     -    4323 +
7159     -    4324 +```
7160     -    4325 +
7161     -    4326 +
7162     -    4327 +### ‚ú® `codebase_audit/docs_summary.json` **[ADDED]**
7163     -    4328 +
7164     -    4329 +**Status:** ‚úÖ **NEW FILE** - This file has been newly created
7165     -    4330 +
7166     -    4331 +**Type:** Configuration/Data File üìã
7167     -    4332 +
7168     -    4333 +```diff
7169     -    4334 +@@ -0,0 +1,12 @@
7170     -    4335 +      1 +{
7171     -    4336 +      2 +  "hld": "The application follows a client-side monolithic architecture with pure vanilla JavaScript, CSS variables for theming, and no backend. It uses a \"Service Layer\" pattern to isolate business logic (Mermaid, Prism) from UI, and an \"Observer Pattern\" for theme changes. Data is persisted solely via browser `localStorage`. Security relies on client-side sanitization (Marked.js) and no external data transmission.",
7172     -    4337 +      3 +  "lld": "The codebase is organized into modular layers: `UI` (HTML), `Application` (script.js controller), `Core` (StorageManager, ThemeManager), `Services` (MermaidService, PrismService), and `Utils` (HTML/Color helpers). The `ThemeManager` handles 12 built-in themes + custom themes using CSS variables. `MermaidService` and `PrismService` wrap external libraries with lazy initialization and error handling. `script.js` acts as the entry point, treating other modules as injected dependencies.",
7173     -    4338 +      4 +  "other": {
7174     -    4339 +      5 +    "folder-browser-plan": "Plan to add a file system sidebar using the File System Access API for local folder navigation.",
7175     -    4340 +      6 +    "math-rendering-plan": "Proposal to integrate KaTeX for LaTeX math rendering ($ and $$ syntax) via marked extension.",
7176     -    4341 +      7 +    "pdf-export-plan": "Design to add PDF export using html2pdf.js, preserving styles and Mermaid diagrams.",
7177     -    4342 +      8 +    "implementation-plan": "6-week refactoring roadmap moving from monolithic script.js to modular ES modules structure (currently in progress/partially complete).",
7178     -    4343 +      9 +    "deployment-guide": "Documentation for deploying to Vercel, Netlify, or GitHub Pages as a static site.",
7179     -    4344 +     10 +    "ai-review": "Recent automated code review log highlighting fixes for theme dropdown sync and architecture documentation additions."
7180     -    4345 +     11 +  }
7181     -    4346 +     12 +}
7182     -    4347 +     13  
7183     -    4348 +
7184     -    4349 +```
7185     -    4350 +
7186     -    4351 +
7187     -    4352 +### ‚ú® `codebase_audit/future_enhancements_roadmap.md` **[ADDED]**
7188     -    4353 +
7189     -    4354 +**Status:** ‚úÖ **NEW FILE** - This file has been newly created
7190     -    4355 +
7191     -    4356 +**Type:** Documentation üìñ
7192     -    4357 +
7193     -    4358 +```diff
7194     -    4359 +@@ -0,0 +1,87 @@
7195     -    4360 +      1 +# üöÄ Future Enhancements: Enterprise-Grade Roadmap
7196     -    4361 +      2 +
7197     -    4362 +      3 +This document outlines the strategic roadmap to transform the `markdown-viewer-app` into a truly **Enterprise-Grade** web application.
7198     -    4363 +      4 +
7199     -    4364 +      5 +---
7200     -    4365 +      6 +
7201     -    4366 +      7 +## üèóÔ∏è Phase 1: Robust Application Architecture (Modernization)
7202     -    4367 +      8 +
7203     -    4368 +      9 +To support enterprise scale, we must move beyond the "Vanilla JS" constraints suitable for prototypes and adopt a robust, type-safe ecosystem.
7204     -    4369 +     10 +
7205     -    4370 +     11 +### 1.1 Migrate to TypeScript
7206     -    4371 +     12 +*   **Why:** Enterprise apps require type safety to prevent runtime errors (undefined is not ...).
7207     -    4372 +     13 +*   **Plan:** Rename `.js` to `.ts`. Define interfaces for `Theme`, `FileNode`, and `AppConfig`. Strict null checks.
7208     -    4373 +     14 +
7209     -    4374 +     15 +### 1.2 Component-Based Architecture (Web Components or Framework)
7210     -    4375 +     16 +*   **Why:** The `script.js` monolith is unmaintainable.
7211     -    4376 +     17 +*   **Plan:**
7212     -    4377 +     18 +    *   **Option A (Vanilla):** Adopt Web Components (`<markdown-editor>`, `<file-tree>`).
7213     -    4378 +     19 +    *   **Option B (Standard):** Migrate to **React** or **Vue**. This allows us to use massive ecosystems of tested components (e.g., `Monaco Editor` for better markdown editing).
7214     -    4379 +     20 +
7215     -    4380 +     21 +### 1.3 State Management
7216     -    4381 +     22 +*   **Why:** Passing `globalRenderMarkdown` around is fragile.
7217     -    4382 +     23 +*   **Plan:** Implement a centralized store (e.g., `Redux`, `Zustand`, or a simple `StateService` observable) to manage:
7218     -    4383 +     24 +    *   `currentFile`
7219     -    4384 +     25 +    *   `theme`
7220     -    4385 +     26 +    *   `settings`
7221     -    4386 +     27 +    *   `folderStructure`
7222     -    4387 +     28 +
7223     -    4388 +     29 +---
7224     -    4389 +     30 +
7225     -    4390 +     31 +## üõ°Ô∏è Phase 2: Enterprise Security & Compliance
7226     -    4391 +     32 +
7227     -    4392 +     33 +### 2.1 Content Security Policy (CSP)
7228     -    4393 +     34 +*   **Goal:** Prevent XSS and Data Exfiltration.
7229     -    4394 +     35 +*   **Action:** implement strict CSP headers (or `<meta>` tags):
7230     -    4395 +     36 +    ```html
7231     -    4396 +     37 +    <meta http-equiv="Content-Security-Policy" content="default-src 'self'; script-src 'self' 'unsafe-eval' (for mermaid); style-src 'self' 'unsafe-inline';">
7232     -    4397 +     38 +    ```
7233     -    4398 +     39 +
7234     -    4399 +     40 +### 2.2 Input Sanitization Layer
7235     -    4400 +     41 +*   **Goal:** trust No Input.
7236     -    4401 +     42 +*   **Action:** Integrate `DOMPurify` deeply into the rendering pipeline. Create a `SanitizationService` that all HTML output must pass through.
7237     -    4402 +     43 +
7238     -    4403 +     44 +---
7239     -    4404 +     45 +
7240     -    4405 +     46 +## ‚ö° Phase 3: Performance & Scalability
7241     -    4406 +     47 +
7242     -    4407 +     48 +### 3.1 Web Workers for Parsing
7243     -    4408 +     49 +*   **Issue:** Parsing large markdown files (1000+ lines) freezes the UI.
7244     -    4409 +     50 +*   **Solution:** Move `marked.parse` and syntax highlighting logic to a **Web Worker**. The main thread should only handle User Input and DOM updates.
7245     -    4410 +     51 +
7246     -    4411 +     52 +### 3.2 Virtualized Rendering
7247     -    4412 +     53 +*   **Issue:** The File Browser and Large Preview will lag with thousands of items.
7248     -    4413 +     54 +*   **Solution:** Implement "Virtual Scrolling" (Windowing). Only render the DOM nodes currently visible on screen.
7249     -    4414 +     55 +
7250     -    4415 +     56 +### 3.3 Offline-First (PWA)
7251     -    4416 +     57 +*   **Goal:** Native-like reliability.
7252     -    4417 +     58 +*   **Action:**
7253     -    4418 +     59 +    *   Add a Service Worker to cache App Shell and Assets (Fonts, CSS).
7254     -    4419 +     60 +    *   Use `IndexedDB` instead of `localStorage` for saving files (allows saving images/blobs).
7255     -    4420 +     61 +
7256     -    4421 +     62 +---
7257     -2850 4422       63 +
7258     -2851     -     64 +  /* Core hue-3: Purple - Keywords */
7259     -2852     -     65 +  --syntax-keyword: #9c27b0; /* Vibrant purple for keywords (final, sealed, class) */
7260     -2853     -     66 +
7261     -2854     -     67 +  /* Core hue-4: Green - Strings, builtins */
7262     -2855     -     68 +  --syntax-string: #4caf50; /* Green for strings */
7263     -2856     -     69 +  --syntax-builtin: #388e3c; /* Dark green for builtins (String, List) */
7264     -2857     -     70 +  --syntax-char: #4caf50; /* Same as strings */
7265     -2858     -     71 +  --syntax-regex: #4caf50; /* Same as strings */
7266     -2859     -     72 +  --syntax-inserted: #388e3c; /* For diff */
7267     -    4423 +     64 +## üß© Phase 4: Advanced Features (The "Wow" Factor)
7268     -    4424 +     65 +
7269     -    4425 +     66 +### 4.1 Collaborative Editing (Real-Time)
7270     -    4426 +     67 +*   **Tech:** `Yjs` or `Automerge` (CRDTs).
7271     -    4427 +     68 +*   **Feature:** Allow two users to edit the same doc via WebRTC (local peer-to-peer) without a central server.
7272     -    4428 +     69 +
7273     -    4429 +     70 +### 4.2 Semantic Search (AI)
7274     -    4430 +     71 +*   **Start:** Implement client-side full-text search (FlexSearch).
7275     -    4431 +     72 +*   **Upgrade:** Use a local LLM or Embedding model (via WebGPU) to allow "Chat with my Docs".
7276     -2860 4432       73 +
7277     -2861     -     74 +  /* Core hue-5: Pink/Orange - Properties, tags */
7278     -2862     -     75 +  --syntax-property: #e91e63; /* Pink for properties */
7279     -2863     -     76 +  --syntax-tag: #ff4081; /* Coral for tags */
7280     -2864     -     77 +  --syntax-deleted: #d32f2f; /* Red for diff */
7281     -2865     -     78 +  --syntax-important: #e91e63; /* Pink for !important */
7282     -    4433 +     74 +### 4.3 Plugin System
7283     -    4434 +     75 +*   **Architecture:** Allow users to write JavaScript "plugins" to extend functionality (e.g., a "Date Picker" markdown extension).
7284     -    4435 +     76 +*   **Security:** Run plugins in a Sandboxed Iframe.
7285     -    4436 +     77 +
7286     -    4437 +     78 +---
7287     -2866 4438       79 +
7288     -2867     -     80 +  /* Core hue-6: Orange/Yellow - Class names, constants, numbers */
7289     -2868     -     81 +  --syntax-class-name: #ff9800; /* Orange for class names (Rectangle, Shape) */
7290     -2869     -     82 +  --syntax-number: #f57c00; /* Dark orange for numbers */
7291     -2870     -     83 +  --syntax-constant: #ff9800; /* Orange for constants */
7292     -2871     -     84 +  --syntax-boolean: #f57c00; /* Same as numbers */
7293     -2872     -     85 +  --syntax-atrule: #9c27b0; /* Purple for CSS @ rules */
7294     -2873     -     86 +
7295     -2874     -     87 +  /* Neutral colors */
7296     -2875     -     88 +  --syntax-comment: #9e9e9e; /* Gray for comments */
7297     -2876     -     89 +  --syntax-punctuation: #616161; /* Dark gray for punctuation */
7298     -2877     -     90 +  --syntax-operator: #00bcd4; /* Cyan for operators */
7299     -2878     -     91 +
7300     -2879     -     92 +  /* Markup specific */
7301     -2880     -     93 +  --syntax-attr-name: #ff9800; /* Orange like class-name */
7302     -2881     -     94 +  --syntax-attr-value: #4caf50; /* Green like strings */
7303     -2882     -     95 +  --syntax-namespace: #9c27b0; /* Purple like keywords */
7304     -2883     -     96 +  --syntax-entity: #616161; /* Neutral */
7305     -2884     -     97 +  --syntax-selector: #e91e63; /* Pink like properties */
7306     -2885     - 69  98  
7307     -2886     - 70  99    /* Blockquote */
7308     -2887     - 71 100    --blockquote-border: #e91e63;
7309     -2888     -@@ -77,4 +106,87 @@
7310     -2889     - 77 106  
7311     -2890     - 78 107    /* Border */
7312     -2891     - 79 108    --border-color: rgba(0, 0, 0, 0.12);
7313     -2892     -    109 +
7314     -2893     -    110 +  /* === MERMAID COMPREHENSIVE CONFIGURATION === */
7315     -2894     -    111 +
7316     -2895     -    112 +  /* Core Global */
7317     -2896     -    113 +  --mermaid-background: #ffffff;
7318     -2897     -    114 +  --mermaid-text-color: #1a1a1a;
7319     -2898     -    115 +  --mermaid-line-color: #9c27b0;
7320     -2899     -    116 +  --mermaid-main-bkg: #e8ecf1;
7321     -2900     -    117 +
7322     -2901     -    118 +  /* Primary Set */
7323     -2902     -    119 +  --mermaid-primary-color: #e8ecf1;
7324     -2903     -    120 +  --mermaid-primary-text-color: #1a1a1a;
7325     -2904     -    121 +  --mermaid-primary-border-color: #e91e63;
7326     -2905     -    122 +
7327     -2906     -    123 +  /* Secondary Set */
7328     -2907     -    124 +  --mermaid-secondary-color: #f5f7fa;
7329     -2908     -    125 +  --mermaid-secondary-text-color: #1a1a1a;
7330     -2909     -    126 +  --mermaid-secondary-border-color: #9c27b0;
7331     -2910     -    127 +
7332     -2911     -    128 +  /* Tertiary Set */
7333     -2912     -    129 +  --mermaid-tertiary-color: #ffffff;
7334     -2913     -    130 +  --mermaid-tertiary-text-color: #1a1a1a;
7335     -2914     -    131 +  --mermaid-tertiary-border-color: #00bcd4;
7336     -2915     -    132 +
7337     -2916     -    133 +  /* Flowchart */
7338     -2917     -    134 +  --mermaid-node-border: #e91e63;
7339     -2918     -    135 +  --mermaid-cluster-bkg: #f5f7fa;
7340     -2919     -    136 +  --mermaid-cluster-border: #9c27b0;
7341     -2920     -    137 +  --mermaid-default-link-color: #9c27b0;
7342     -2921     -    138 +  --mermaid-title-color: #1a1a1a;
7343     -2922     -    139 +  --mermaid-edge-label-background: #ffffff;
7344     -2923     -    140 +  --mermaid-node-text-color: #1a1a1a;
7345     -2924     -    141 +
7346     -2925     -    142 +  /* Sequence Diagram */
7347     -2926     -    143 +  --mermaid-actor-bkg: #e8ecf1;
7348     -2927     -    144 +  --mermaid-actor-border: #e91e63;
7349     -2928     -    145 +  --mermaid-actor-text-color: #1a1a1a;
7350     -2929     -    146 +  --mermaid-actor-line-color: #e91e63;
7351     -2930     -    147 +  --mermaid-signal-color: #9c27b0;
7352     -2931     -    148 +  --mermaid-signal-text-color: #1a1a1a;
7353     -2932     -    149 +  --mermaid-label-box-bkg-color: #e8ecf1;
7354     -2933     -    150 +  --mermaid-label-box-border-color: #e91e63;
7355     -2934     -    151 +  --mermaid-label-text-color: #1a1a1a;
7356     -2935     -    152 +  --mermaid-loop-text-color: #1a1a1a;
7357     -2936     -    153 +  --mermaid-activation-border-color: #9c27b0;
7358     -2937     -    154 +  --mermaid-activation-bkg-color: #f5f7fa;
7359     -2938     -    155 +  --mermaid-sequence-number-color: #1a1a1a;
7360     -2939     -    156 +
7361     -2940     -    157 +  /* Pie Chart */
7362     -2941     -    158 +  --mermaid-pie1: #e91e63;
7363     -2942     -    159 +  --mermaid-pie2: #9c27b0;
7364     -2943     -    160 +  --mermaid-pie3: #2196f3;
7365     -2944     -    161 +  --mermaid-pie4: #00bcd4;
7366     -2945     -    162 +  --mermaid-pie5: #4caf50;
7367     -2946     -    163 +  --mermaid-pie6: #ff9800;
7368     -2947     -    164 +  --mermaid-pie7: #f57c00;
7369     -2948     -    165 +  --mermaid-pie8: #ff4081;
7370     -2949     -    166 +  --mermaid-pie9: #1976d2;
7371     -2950     -    167 +  --mermaid-pie10: #388e3c;
7372     -2951     -    168 +  --mermaid-pie11: #e91e63;
7373     -2952     -    169 +  --mermaid-pie12: #9c27b0;
7374     -2953     -    170 +  --mermaid-pie-title-text-color: #1a1a1a;
7375     -2954     -    171 +  --mermaid-pie-section-text-color: #ffffff; /* White on vibrant slices */
7376     -2955     -    172 +  --mermaid-pie-legend-text-color: #1a1a1a;
7377     -2956     -    173 +  --mermaid-pie-stroke-color: #e91e63;
7378     -2957     -    174 +  --mermaid-pie-outer-stroke-color: #e91e63;
7379     -2958     -    175 +
7380     -2959     -    176 +  /* State Diagram */
7381     -2960     -    177 +  --mermaid-label-color: #1a1a1a;
7382     -2961     -    178 +  --mermaid-alt-background: #f5f7fa;
7383     -2962     -    179 +
7384     -2963     -    180 +  /* Class Diagram */
7385     -2964     -    181 +  --mermaid-class-text: #1a1a1a;
7386     -2965     -    182 +
7387     -2966     -    183 +  /* User Journey */
7388     -2967     -    184 +  --mermaid-fill-type0: #e91e63;
7389     -2968     -    185 +  --mermaid-fill-type1: #9c27b0;
7390     -2969     -    186 +  --mermaid-fill-type2: #2196f3;
7391     -2970     -    187 +  --mermaid-fill-type3: #00bcd4;
7392     -2971     -    188 +  --mermaid-fill-type4: #4caf50;
7393     -2972     -    189 +  --mermaid-fill-type5: #ff9800;
7394     -2973     -    190 +  --mermaid-fill-type6: #f57c00;
7395     -2974     -    191 +  --mermaid-fill-type7: #ff4081;
7396     -2975     - 80 192  }
7397     -2976     - 81 193  
7398     -    4439 +     80 +## üìà Roadmap Estimate
7399     -    4440 +     81 +
7400     -    4441 +     82 +| Feature | Complexity | Impact | Timeline |
7401     -    4442 +     83 +|---------|------------|--------|----------|
7402     -    4443 +     84 +| **TS Migration** | Medium | High | Q1 |
7403     -    4444 +     85 +| **PWA / Offline** | Low | High | Q1 |
7404     -    4445 +     86 +| **Web Workers** | High | Medium | Q2 |
7405     -    4446 +     87 +| **Collaboration**| Very High| High | Q3 |
7406     -    4447 +     88  
7407     -2977 4448  
7408     -2978 4449  ```
7409     -2979 4450  
7410     -2980 4451  
7411     -2981     -### üìÑ `themes/ocean-dark.css`
7412     -    4452 +### ‚ú® `codebase_audit/phase3_codebase_review.json` **[ADDED]**
7413     -2982 4453  
7414     -2983     -**Type:** Stylesheet üé®
7415     -    4454 +**Status:** ‚úÖ **NEW FILE** - This file has been newly created
7416     -    4455 +
7417     -    4456 +**Type:** Configuration/Data File üìã
7418     -2984 4457  
7419     -2985 4458  ```diff
7420     -2986     -@@ -23,20 +23,49 @@
7421     -2987     - 23  23    --code-block-bg: #0a192f;
7422     -2988     - 24  24    --code-border: #233554;
7423     -2989     - 25  25  
7424     -2990     - 26     -  /* Syntax Highlighting - Comprehensive Token Colors */
7425     -2991     - 27     -  --syntax-keyword: #64ffda;
7426     -2992     - 28     -  --syntax-string: #5eead4;
7427     -2993     - 29     -  --syntax-number: #38bdf8;
7428     -2994     - 30     -  --syntax-function: #22d3ee;
7429     -2995     - 31     -  --syntax-comment: #8892b0;
7430     -2996     - 32     -  --syntax-operator: #06b6d4;
7431     -2997     - 33     -  --syntax-punctuation: #8892b0;
7432     -2998     -     26 +  /* Syntax Highlighting - Production-Grade Token Colors (One Dark Architecture) */
7433     -2999     - 34  27  
7434     -3000     - 35     -  /* Additional Token Types */
7435     -3001     - 36     -  --syntax-variable: #38bdf8; /* Variables - cyan (distinct from text #ccd6f6) */
7436     -3002     - 37     -  --syntax-property: #22d3ee; /* Properties - teal */
7437     -3003     - 38     -  --syntax-namespace: #64ffda; /* Namespaces - mint */
7438     -3004     - 39     -  --syntax-builtin: #5eead4; /* Builtins - teal */
7439     -3005     -     28 +  /* Core hue-1: Bright Cyan - URLs */
7440     -3006     -     29 +  --syntax-url: #67e8f9; /* Electric cyan for URLs */
7441     -3007     -     30 +
7442     -3008     -     31 +  /* Core hue-2: Blue - Functions, variables */
7443     -3009     -     32 +  --syntax-function: #38bdf8; /* Sky blue for functions */
7444     -3010     -     33 +  --syntax-variable: #0ea5e9; /* Deep sky for variables */
7445     -3011     -     34 +
7446     -3012     -     35 +  /* Core hue-3: Violet/Purple - Keywords */
7447     -3013     -     36 +  --syntax-keyword: #c084fc; /* Bright violet for keywords (final, sealed, class) */
7448     -3014     -     37 +
7449     -3015     -     38 +  /* Core hue-4: Green/Teal - Strings, builtins */
7450     -3016     -     39 +  --syntax-string: #5eead4; /* Teal for strings */
7451     -3017     -     40 +  --syntax-builtin: #2dd4bf; /* Vibrant teal for builtins (String, List) */
7452     -3018     -     41 +  --syntax-char: #5eead4; /* Same as strings */
7453     -3019     -     42 +  --syntax-regex: #5eead4; /* Same as strings */
7454     -3020     -     43 +  --syntax-inserted: #2dd4bf; /* For diff */
7455     -3021     -     44 +
7456     -3022     -     45 +  /* Core hue-5: Pink/Rose - Properties, tags */
7457     -3023     -     46 +  --syntax-property: #f472b6; /* Pink for properties */
7458     -3024     -     47 +  --syntax-tag: #fb7185; /* Rose for tags */
7459     -3025     -     48 +  --syntax-deleted: #f87171; /* Coral for diff */
7460     -3026     -     49 +  --syntax-important: #f472b6; /* Pink for !important */
7461     -3027     -     50 +
7462     -3028     -     51 +  /* Core hue-6: Mint/Cyan - Class names, constants, numbers */
7463     -3029     -     52 +  --syntax-class-name: #64ffda; /* Mint green for class names (Rectangle, Shape) */
7464     -3030     -     53 +  --syntax-number: #22d3ee; /* Bright cyan for numbers */
7465     -3031     -     54 +  --syntax-constant: #06b6d4; /* Cyan for constants */
7466     -3032     -     55 +  --syntax-boolean: #22d3ee; /* Same as numbers */
7467     -3033     -     56 +  --syntax-atrule: #64ffda; /* Mint for CSS @ rules */
7468     -3034     -     57 +
7469     -3035     -     58 +  /* Neutral colors */
7470     -3036     -     59 +  --syntax-comment: #8892b0; /* Muted blue-gray for comments */
7471     -3037     -     60 +  --syntax-punctuation: #a0aec0; /* Light gray for punctuation */
7472     -3038     -     61 +  --syntax-operator: #0891b2; /* Teal for operators */
7473     -3039     -     62 +
7474     -3040     -     63 +  /* Markup specific */
7475     -3041     -     64 +  --syntax-attr-name: #64ffda; /* Mint like class-name */
7476     -3042     -     65 +  --syntax-attr-value: #5eead4; /* Teal like strings */
7477     -3043     -     66 +  --syntax-namespace: #c084fc; /* Violet like keywords */
7478     -3044     -     67 +  --syntax-entity: #a0aec0; /* Neutral */
7479     -3045     -     68 +  --syntax-selector: #f472b6; /* Pink like properties */
7480     -3046     - 40  69  
7481     -3047     - 41  70    --blockquote-border: #64ffda;
7482     -3048     - 42  71    --blockquote-bg: #112240;
7483     -3049     -@@ -44,4 +73,87 @@
7484     -3050     - 44  73    --italic-color: #5eead4;
7485     -3051     - 45  74    --table-header-bg: #1d3461;
7486     -3052     - 46  75    --table-border: #233554;
7487     -3053     -     76 +
7488     -3054     -     77 +  /* === MERMAID COMPREHENSIVE CONFIGURATION === */
7489     -3055     -     78 +
7490     -3056     -     79 +  /* Core Global */
7491     -3057     -     80 +  --mermaid-background: #0a192f;
7492     -3058     -     81 +  --mermaid-text-color: #ccd6f6;
7493     -3059     -     82 +  --mermaid-line-color: #5eead4;
7494     -3060     -     83 +  --mermaid-main-bkg: #1d3461;
7495     -3061     -     84 +
7496     -3062     -     85 +  /* Primary Set */
7497     -3063     -     86 +  --mermaid-primary-color: #1d3461;
7498     -3064     -     87 +  --mermaid-primary-text-color: #ccd6f6;
7499     -3065     -     88 +  --mermaid-primary-border-color: #64ffda;
7500     -3066     -     89 +
7501     -3067     -     90 +  /* Secondary Set */
7502     -3068     -     91 +  --mermaid-secondary-color: #112240;
7503     -3069     -     92 +  --mermaid-secondary-text-color: #ccd6f6;
7504     -3070     -     93 +  --mermaid-secondary-border-color: #5eead4;
7505     -3071     -     94 +
7506     -3072     -     95 +  /* Tertiary Set */
7507     -3073     -     96 +  --mermaid-tertiary-color: #0a192f;
7508     -3074     -     97 +  --mermaid-tertiary-text-color: #ccd6f6;
7509     -3075     -     98 +  --mermaid-tertiary-border-color: #38bdf8;
7510     -3076     -     99 +
7511     -3077     -    100 +  /* Flowchart */
7512     -3078     -    101 +  --mermaid-node-border: #64ffda;
7513     -3079     -    102 +  --mermaid-cluster-bkg: #112240;
7514     -3080     -    103 +  --mermaid-cluster-border: #5eead4;
7515     -3081     -    104 +  --mermaid-default-link-color: #5eead4;
7516     -3082     -    105 +  --mermaid-title-color: #ccd6f6;
7517     -3083     -    106 +  --mermaid-edge-label-background: #0a192f;
7518     -3084     -    107 +  --mermaid-node-text-color: #ccd6f6;
7519     -3085     -    108 +
7520     -3086     -    109 +  /* Sequence Diagram */
7521     -3087     -    110 +  --mermaid-actor-bkg: #1d3461;
7522     -3088     -    111 +  --mermaid-actor-border: #64ffda;
7523     -3089     -    112 +  --mermaid-actor-text-color: #ccd6f6;
7524     -3090     -    113 +  --mermaid-actor-line-color: #64ffda;
7525     -3091     -    114 +  --mermaid-signal-color: #5eead4;
7526     -3092     -    115 +  --mermaid-signal-text-color: #ccd6f6;
7527     -3093     -    116 +  --mermaid-label-box-bkg-color: #1d3461;
7528     -3094     -    117 +  --mermaid-label-box-border-color: #64ffda;
7529     -3095     -    118 +  --mermaid-label-text-color: #ccd6f6;
7530     -3096     -    119 +  --mermaid-loop-text-color: #ccd6f6;
7531     -3097     -    120 +  --mermaid-activation-border-color: #5eead4;
7532     -3098     -    121 +  --mermaid-activation-bkg-color: #112240;
7533     -3099     -    122 +  --mermaid-sequence-number-color: #ccd6f6;
7534     -3100     -    123 +
7535     -3101     -    124 +  /* Pie Chart */
7536     -3102     -    125 +  --mermaid-pie1: #64ffda;
7537     -3103     -    126 +  --mermaid-pie2: #5eead4;
7538     -3104     -    127 +  --mermaid-pie3: #38bdf8;
7539     -3105     -    128 +  --mermaid-pie4: #22d3ee;
7540     -3106     -    129 +  --mermaid-pie5: #06b6d4;
7541     -3107     -    130 +  --mermaid-pie6: #0891b2;
7542     -3108     -    131 +  --mermaid-pie7: #c084fc;
7543     -3109     -    132 +  --mermaid-pie8: #f472b6;
7544     -3110     -    133 +  --mermaid-pie9: #0ea5e9;
7545     -3111     -    134 +  --mermaid-pie10: #64ffda;
7546     -3112     -    135 +  --mermaid-pie11: #5eead4;
7547     -3113     -    136 +  --mermaid-pie12: #38bdf8;
7548     -3114     -    137 +  --mermaid-pie-title-text-color: #ccd6f6;
7549     -3115     -    138 +  --mermaid-pie-section-text-color: #0a192f; /* Dark on vibrant slices */
7550     -3116     -    139 +  --mermaid-pie-legend-text-color: #ccd6f6;
7551     -3117     -    140 +  --mermaid-pie-stroke-color: #64ffda;
7552     -3118     -    141 +  --mermaid-pie-outer-stroke-color: #64ffda;
7553     -3119     -    142 +
7554     -3120     -    143 +  /* State Diagram */
7555     -3121     -    144 +  --mermaid-label-color: #ccd6f6;
7556     -3122     -    145 +  --mermaid-alt-background: #112240;
7557     -3123     -    146 +
7558     -3124     -    147 +  /* Class Diagram */
7559     -3125     -    148 +  --mermaid-class-text: #ccd6f6;
7560     -3126     -    149 +
7561     -3127     -    150 +  /* User Journey */
7562     -3128     -    151 +  --mermaid-fill-type0: #64ffda;
7563     -3129     -    152 +  --mermaid-fill-type1: #5eead4;
7564     -3130     -    153 +  --mermaid-fill-type2: #38bdf8;
7565     -3131     -    154 +  --mermaid-fill-type3: #22d3ee;
7566     -3132     -    155 +  --mermaid-fill-type4: #06b6d4;
7567     -3133     -    156 +  --mermaid-fill-type5: #0891b2;
7568     -3134     -    157 +  --mermaid-fill-type6: #c084fc;
7569     -3135     -    158 +  --mermaid-fill-type7: #f472b6;
7570     -3136     - 47 159  }
7571     -3137     - 48 160  
7572     -    4459 +@@ -0,0 +1,68 @@
7573     -    4460 +      1 +{
7574     -    4461 +      2 +  "phase": "3 - Codebase Review",
7575     -    4462 +      3 +  "status": "COMPLETED",
7576     -    4463 +      4 +  "findings": {
7577     -    4464 +      5 +    "security": [
7578     -    4465 +      6 +      {
7579     -    4466 +      7 +        "severity": "CRITICAL",
7580     -    4467 +      8 +        "type": "Stored XSS",
7581     -    4468 +      9 +        "location": "script.js:512",
7582     -    4469 +     10 +        "description": "Marked.js output is assigned to innerHTML without sanitization. DOMPurify is missing from dependencies.",
7583     -    4470 +     11 +        "remediation": "Install dompurify and sanitize 'html' variable before assignment."
7584     -    4471 +     12 +      },
7585     -    4472 +     13 +      {
7586     -    4473 +     14 +        "severity": "LOW",
7587     -    4474 +     15 +        "type": "Data Privacy",
7588     -    4475 +     16 +        "location": "script.js:522",
7589     -    4476 +     17 +        "description": "User content stored in localStorage unencrypted. Acceptable for MVP but should be noted.",
7590     -    4477 +     18 +        "remediation": "Add warning or option to disable local storage persistence."
7591     -    4478 +     19 +      }
7592     -    4479 +     20 +    ],
7593     -    4480 +     21 +    "architecture": [
7594     -    4481 +     22 +      {
7595     -    4482 +     23 +        "severity": "HIGH",
7596     -    4483 +     24 +        "type": "Monolithic Controller",
7597     -    4484 +     25 +        "location": "script.js",
7598     -    4485 +     26 +        "description": "script.js is over 1300 lines and handles UI, logic, and service orchestration. Needs splitting.",
7599     -    4486 +     27 +        "remediation": "Extract UI logic into UIManager.js and EventManager.js."
7600     -    4487 +     28 +      },
7601     -    4488 +     29 +      {
7602     -    4489 +     30 +        "severity": "MEDIUM",
7603     -    4490 +     31 +        "type": "Race Condition",
7604     -    4491 +     32 +        "location": "script.js:490,535",
7605     -    4492 +     33 +        "description": "Reliance on setTimeout magic numbers (100ms) for synchronization between Theme loading and Mermaid rendering.",
7606     -    4493 +     34 +        "remediation": "Implement proper Promise-based initialization chain."
7607     -    4494 +     35 +      },
7608     -    4495 +     36 +      {
7609     -    4496 +     37 +        "severity": "LOW",
7610     -    4497 +     38 +        "type": "Mixed Dependency Management",
7611     -    4498 +     39 +        "location": "index.html / package.json",
7612     -    4499 +     40 +        "description": "Project uses NPM for dev tools but CDNs for runtime libraries (marked, plotly, etc.). Hard to version control runtime deps.",
7613     -    4500 +     41 +        "remediation": "Migrate runtime dependencies to NPM and bundle with Vite."
7614     -    4501 +     42 +      }
7615     -    4502 +     43 +    ],
7616     -    4503 +     44 +    "code_quality": [
7617     -    4504 +     45 +      {
7618     -    4505 +     46 +        "severity": "MEDIUM",
7619     -    4506 +     47 +        "type": "Redundant Logic",
7620     -    4507 +     48 +        "location": "script.js:1241",
7621     -    4508 +     49 +        "description": "DOM generation for File Browser is hardcoded in script.js instead of being in FolderBrowserService or a View component.",
7622     -    4509 +     50 +        "remediation": "Move renderFileTree logic to a dedicated UI component."
7623     -    4510 +     51 +      },
7624     -    4511 +     52 +      {
7625     -    4512 +     53 +        "severity": "LOW",
7626     -    4513 +     54 +        "type": "Hardcoded Config",
7627     -    4514 +     55 +        "location": "script.js",
7628     -    4515 +     56 +        "description": "Some configuration values (sidebar width limits) are hardcoded in script.js, duplicating constants potential.",
7629     -    4516 +     57 +        "remediation": "Move all magic numbers to src/js/config/constants.js."
7630     -    4517 +     58 +      }
7631     -    4518 +     59 +    ]
7632     -    4519 +     60 +  },
7633     -    4520 +     61 +  "metrics": {
7634     -    4521 +     62 +    "files_reviewed": 18,
7635     -    4522 +     63 +    "lines_of_code": "~3000",
7636     -    4523 +     64 +    "critical_issues": 1,
7637     -    4524 +     65 +    "high_issues": 1,
7638     -    4525 +     66 +    "medium_issues": 2
7639     -    4526 +     67 +  }
7640     -    4527 +     68 +}
7641     -    4528 +     69  
7642     -3138 4529  
7643     -3139 4530  ```
7644     -3140 4531  
7645     -3141 4532  
7646     -3142     -### üìÑ `themes/ocean-light.css`
7647     -    4533 +### ‚ú® `codebase_audit/phase4_consolidated_findings.md` **[ADDED]**
7648     -3143 4534  
7649     -3144     -**Type:** Stylesheet üé®
7650     -    4535 +**Status:** ‚úÖ **NEW FILE** - This file has been newly created
7651     -    4536 +
7652     -    4537 +**Type:** Documentation üìñ
7653     -3145 4538  
7654     -3146 4539  ```diff
7655     -3147     -@@ -23,20 +23,49 @@
7656     -3148     - 23  23    --code-block-bg: #e0f2fe; /* Light cyan background */
7657     -3149     - 24  24    --code-border: #7dd3fc;
7658     -3150     - 25  25  
7659     -3151     - 26     -  /* Syntax Highlighting - Comprehensive Token Colors */
7660     -3152     - 27     -  --syntax-keyword: #0284c7;
7661     -3153     - 28     -  --syntax-string: #0891b2;
7662     -3154     - 29     -  --syntax-number: #06b6d4;
7663     -3155     - 30     -  --syntax-function: #22d3ee;
7664     -3156     - 31     -  --syntax-comment: #64748b;
7665     -3157     - 32     -  --syntax-operator: #0369a1;
7666     -3158     - 33     -  --syntax-punctuation: #475569;
7667     -3159     -     26 +  /* Syntax Highlighting - Production-Grade Token Colors (One Dark Architecture) */
7668     -3160     - 34  27  
7669     -3161     - 35     -  /* Additional Token Types for Full Customization */
7670     -3162     - 36     -  --syntax-variable: #0369a1; /* Variables - ocean blue */
7671     -3163     - 37     -  --syntax-property: #0891b2; /* Properties - teal */
7672     -3164     - 38     -  --syntax-namespace: #0284c7; /* Namespaces - cyan */
7673     -3165     - 39     -  --syntax-builtin: #22d3ee; /* Builtins - bright cyan */
7674     -3166     -     28 +  /* Core hue-1: Cyan - URLs */
7675     -3167     -     29 +  --syntax-url: #06b6d4; /* Bright cyan for URLs */
7676     -3168     -     30 +
7677     -3169     -     31 +  /* Core hue-2: Blue - Functions, variables */
7678     -3170     -     32 +  --syntax-function: #0284c7; /* Ocean blue for functions */
7679     -3171     -     33 +  --syntax-variable: #0369a1; /* Deep blue for variables */
7680     -3172     -     34 +
7681     -3173     -     35 +  /* Core hue-3: Purple/Violet - Keywords */
7682     -3174     -     36 +  --syntax-keyword: #7c3aed; /* Vivid purple for keywords (final, sealed, class) */
7683     -3175     -     37 +
7684     -3176     -     38 +  /* Core hue-4: Green/Teal - Strings, builtins */
7685     -3177     -     39 +  --syntax-string: #0891b2; /* Teal for strings */
7686     -3178     -     40 +  --syntax-builtin: #14b8a6; /* Bright teal for builtins (String, List) */
7687     -3179     -     41 +  --syntax-char: #0891b2; /* Same as strings */
7688     -3180     -     42 +  --syntax-regex: #0891b2; /* Same as strings */
7689     -3181     -     43 +  --syntax-inserted: #14b8a6; /* For diff */
7690     -3182     -     44 +
7691     -3183     -     45 +  /* Core hue-5: Orange/Amber - Properties, tags */
7692     -3184     -     46 +  --syntax-property: #f59e0b; /* Amber for properties */
7693     -3185     -     47 +  --syntax-tag: #ea580c; /* Orange for tags */
7694     -3186     -     48 +  --syntax-deleted: #ef4444; /* Red for diff */
7695     -3187     -     49 +  --syntax-important: #f59e0b; /* Amber for !important */
7696     -3188     -     50 +
7697     -3189     -     51 +  /* Core hue-6: Cyan - Class names, constants, numbers */
7698     -3190     -     52 +  --syntax-class-name: #22d3ee; /* Bright cyan for class names (Rectangle, Shape) */
7699     -3191     -     53 +  --syntax-number: #06b6d4; /* Cyan for numbers */
7700     -3192     -     54 +  --syntax-constant: #0891b2; /* Teal for constants */
7701     -3193     -     55 +  --syntax-boolean: #06b6d4; /* Same as numbers */
7702     -3194     -     56 +  --syntax-atrule: #22d3ee; /* Bright cyan for CSS @ rules */
7703     -3195     -     57 +
7704     -3196     -     58 +  /* Neutral colors */
7705     -3197     -     59 +  --syntax-comment: #64748b; /* Slate gray for comments */
7706     -3198     -     60 +  --syntax-punctuation: #475569; /* Dark slate for punctuation */
7707     -3199     -     61 +  --syntax-operator: #0369a1; /* Deep ocean for operators */
7708     -3200     -     62 +
7709     -3201     -     63 +  /* Markup specific */
7710     -3202     -     64 +  --syntax-attr-name: #22d3ee; /* Cyan like class-name */
7711     -3203     -     65 +  --syntax-attr-value: #0891b2; /* Teal like strings */
7712     -3204     -     66 +  --syntax-namespace: #7c3aed; /* Purple like keywords */
7713     -3205     -     67 +  --syntax-entity: #475569; /* Neutral */
7714     -3206     -     68 +  --syntax-selector: #f59e0b; /* Amber like properties */
7715     -3207     - 40  69  
7716     -3208     - 41  70    --blockquote-border: #0891b2;
7717     -3209     - 42  71    --blockquote-bg: #e0f2fe;
7718     -3210     -@@ -44,4 +73,87 @@
7719     -3211     - 44  73    --italic-color: #0891b2;
7720     -3212     - 45  74    --table-header-bg: #bae6fd;
7721     -3213     - 46  75    --table-border: #7dd3fc;
7722     -3214     -     76 +
7723     -3215     -     77 +  /* === MERMAID COMPREHENSIVE CONFIGURATION === */
7724     -3216     -     78 +
7725     -3217     -     79 +  /* Core Global */
7726     -3218     -     80 +  --mermaid-background: #f0f9ff;
7727     -3219     -     81 +  --mermaid-text-color: #0c4a6e;
7728     -3220     -     82 +  --mermaid-line-color: #0891b2;
7729     -3221     -     83 +  --mermaid-main-bkg: #bae6fd;
7730     -3222     -     84 +
7731     -3223     -     85 +  /* Primary Set */
7732     -3224     -     86 +  --mermaid-primary-color: #bae6fd;
7733     -3225     -     87 +  --mermaid-primary-text-color: #0c4a6e;
7734     -3226     -     88 +  --mermaid-primary-border-color: #0284c7;
7735     -3227     -     89 +
7736     -3228     -     90 +  /* Secondary Set */
7737     -3229     -     91 +  --mermaid-secondary-color: #e0f2fe;
7738     -3230     -     92 +  --mermaid-secondary-text-color: #0c4a6e;
7739     -3231     -     93 +  --mermaid-secondary-border-color: #0891b2;
7740     -3232     -     94 +
7741     -3233     -     95 +  /* Tertiary Set */
7742     -3234     -     96 +  --mermaid-tertiary-color: #f0f9ff;
7743     -3235     -     97 +  --mermaid-tertiary-text-color: #0c4a6e;
7744     -3236     -     98 +  --mermaid-tertiary-border-color: #06b6d4;
7745     -3237     -     99 +
7746     -3238     -    100 +  /* Flowchart */
7747     -3239     -    101 +  --mermaid-node-border: #0284c7;
7748     -3240     -    102 +  --mermaid-cluster-bkg: #e0f2fe;
7749     -3241     -    103 +  --mermaid-cluster-border: #0891b2;
7750     -3242     -    104 +  --mermaid-default-link-color: #0891b2;
7751     -3243     -    105 +  --mermaid-title-color: #0c4a6e;
7752     -3244     -    106 +  --mermaid-edge-label-background: #f0f9ff;
7753     -3245     -    107 +  --mermaid-node-text-color: #0c4a6e;
7754     -3246     -    108 +
7755     -3247     -    109 +  /* Sequence Diagram */
7756     -3248     -    110 +  --mermaid-actor-bkg: #bae6fd;
7757     -3249     -    111 +  --mermaid-actor-border: #0284c7;
7758     -3250     -    112 +  --mermaid-actor-text-color: #0c4a6e;
7759     -3251     -    113 +  --mermaid-actor-line-color: #0284c7;
7760     -3252     -    114 +  --mermaid-signal-color: #0891b2;
7761     -3253     -    115 +  --mermaid-signal-text-color: #0c4a6e;
7762     -3254     -    116 +  --mermaid-label-box-bkg-color: #bae6fd;
7763     -3255     -    117 +  --mermaid-label-box-border-color: #0284c7;
7764     -3256     -    118 +  --mermaid-label-text-color: #0c4a6e;
7765     -3257     -    119 +  --mermaid-loop-text-color: #0c4a6e;
7766     -3258     -    120 +  --mermaid-activation-border-color: #0891b2;
7767     -3259     -    121 +  --mermaid-activation-bkg-color: #e0f2fe;
7768     -3260     -    122 +  --mermaid-sequence-number-color: #0c4a6e;
7769     -3261     -    123 +
7770     -3262     -    124 +  /* Pie Chart */
7771     -3263     -    125 +  --mermaid-pie1: #0284c7;
7772     -3264     -    126 +  --mermaid-pie2: #0891b2;
7773     -3265     -    127 +  --mermaid-pie3: #06b6d4;
7774     -3266     -    128 +  --mermaid-pie4: #22d3ee;
7775     -3267     -    129 +  --mermaid-pie5: #7c3aed;
7776     -3268     -    130 +  --mermaid-pie6: #f59e0b;
7777     -3269     -    131 +  --mermaid-pie7: #14b8a6;
7778     -3270     -    132 +  --mermaid-pie8: #0369a1;
7779     -3271     -    133 +  --mermaid-pie9: #0284c7;
7780     -3272     -    134 +  --mermaid-pie10: #0891b2;
7781     -3273     -    135 +  --mermaid-pie11: #06b6d4;
7782     -3274     -    136 +  --mermaid-pie12: #22d3ee;
7783     -3275     -    137 +  --mermaid-pie-title-text-color: #0c4a6e;
7784     -3276     -    138 +  --mermaid-pie-section-text-color: #f0f9ff; /* Light on vibrant slices */
7785     -3277     -    139 +  --mermaid-pie-legend-text-color: #0c4a6e;
7786     -3278     -    140 +  --mermaid-pie-stroke-color: #0284c7;
7787     -3279     -    141 +  --mermaid-pie-outer-stroke-color: #0284c7;
7788     -3280     -    142 +
7789     -3281     -    143 +  /* State Diagram */
7790     -3282     -    144 +  --mermaid-label-color: #0c4a6e;
7791     -3283     -    145 +  --mermaid-alt-background: #e0f2fe;
7792     -3284     -    146 +
7793     -3285     -    147 +  /* Class Diagram */
7794     -3286     -    148 +  --mermaid-class-text: #0c4a6e;
7795     -3287     -    149 +
7796     -3288     -    150 +  /* User Journey */
7797     -3289     -    151 +  --mermaid-fill-type0: #0284c7;
7798     -3290     -    152 +  --mermaid-fill-type1: #0891b2;
7799     -3291     -    153 +  --mermaid-fill-type2: #06b6d4;
7800     -3292     -    154 +  --mermaid-fill-type3: #22d3ee;
7801     -3293     -    155 +  --mermaid-fill-type4: #7c3aed;
7802     -3294     -    156 +  --mermaid-fill-type5: #f59e0b;
7803     -3295     -    157 +  --mermaid-fill-type6: #14b8a6;
7804     -3296     -    158 +  --mermaid-fill-type7: #0369a1;
7805     -3297     - 47 159  }
7806     -3298     - 48 160  
7807     -    4540 +@@ -0,0 +1,31 @@
7808     -    4541 +      1 +# üß© Phase 4: Consolidated Findings
7809     -    4542 +      2 +
7810     -    4543 +      3 +This document consolidates all findings from the Codebase Review (Phase 3) and Documentation Review (Phase 2), grouped by category.
7811     -    4544 +      4 +
7812     -    4545 +      5 +## 1. Security Findings
7813     -    4546 +      6 +| ID | Severity | Issue | Location |
7814     -    4547 +      7 +|----|----------|-------|----------|
7815     -    4548 +      8 +| SEC-01 | **CRITICAL** | **Stored XSS Vulnerability**<br>Markdown renders directly to `innerHTML` without sanitization. | `script.js:512` |
7816     -    4549 +      9 +| SEC-02 | LOW | **Unencrypted Local Storage**<br>User content persists in plain text in browser storage. | `StorageManager.js` |
7817     -    4550 +     10 +| SEC-03 | LOW | **External CDN Dependency**<br>Runtime libraries loaded from third-party CDNs (jsdelivr/cdnjs). | `index.html` |
7818     -    4551 +     11 +
7819     -    4552 +     12 +## 2. Architecture & Design
7820     -    4553 +     13 +| ID | Severity | Issue | Location |
7821     -    4554 +     14 +|----|----------|-------|----------|
7822     -    4555 +     15 +| ARC-01 | **HIGH** | **Monolithic Controller**<br>`script.js` (1300+ lines) violates Single Responsibility Principle. | `script.js` |
7823     -    4556 +     16 +| ARC-02 | MEDIUM | **Tight Coupling**<br>`script.js` directly manipulates DOM, manages state, and calls services. | `script.js` |
7824     -    4557 +     17 +| ARC-03 | MEDIUM | **Race Conditions**<br>Reliance on `setTimeout` for synchronization between themes/Mermaid. | `script.js:490` |
7825     -    4558 +     18 +| ARC-04 | LOW | **Hardcoded Configuration**<br>Magic numbers (sidebar width, zoom limits) found in logic. | `script.js` |
7826     -    4559 +     19 +
7827     -    4560 +     20 +## 3. Code Quality & Maintenance
7828     -    4561 +     21 +| ID | Severity | Issue | Location |
7829     -    4562 +     22 +|----|----------|-------|----------|
7830     -    4563 +     23 +| COD-01 | MEDIUM | **No Type Safety**<br>Pure JavaScript used; logic errors (e.g. string vs number) possible. | All Files |
7831     -    4564 +     24 +| COD-02 | LOW | **Incomplete Tests**<br>Tests exist but coverage for UI interactions is manual. | `tests/` |
7832     -    4565 +     25 +| COD-03 | LOW | **Redundant Logic**<br>DOM generation for File Browse tree is inline, not reusable. | `script.js:1241` |
7833     -    4566 +     26 +
7834     -    4567 +     27 +## 4. Documentation Gaps
7835     -    4568 +     28 +| ID | Severity | Issue | Location |
7836     -    4569 +     29 +|----|----------|-------|----------|
7837     -    4570 +     30 +| DOC-01 | LOW | **Stack Mismatch**<br>README mentions Java/Python support (likely meant highlighting), implying backend. | `README.md` |
7838     -    4571 +     31 +| DOC-02 | LOW | **Install Instructions**<br>No "Install" section for local dev beyond "Open index.html". | `README.md` |
7839     -    4572 +     32  
7840     -3299 4573  
7841     -3300 4574  ```
7842     -3301 4575  
7843     -3302 4576  
7844     -3303     -### üìÑ `themes/sunset-dark.css`
7845     -    4577 +### ‚ú® `codebase_audit/phase4_implementation_plan.md` **[ADDED]**
7846     -3304 4578  
7847     -3305     -**Type:** Stylesheet üé®
7848     -    4579 +**Status:** ‚úÖ **NEW FILE** - This file has been newly created
7849     -    4580 +
7850     -    4581 +**Type:** Documentation üìñ
7851     -3306 4582  
7852     -3307 4583  ```diff
7853     -3308     -@@ -23,20 +23,49 @@
7854     -3309     - 23  23    --code-block-bg: #1c0a00;
7855     -3310     - 24  24    --code-border: #7c2d12;
7856     -3311     - 25  25  
7857     -3312     - 26     -  /* Syntax Highlighting - Comprehensive Token Colors */
7858     -3313     - 27     -  --syntax-keyword: #fb923c;
7859     -3314     - 28     -  --syntax-string: #a3e635;
7860     -3315     - 29     -  --syntax-number: #fbbf24;
7861     -3316     - 30     -  --syntax-function: #f87171;
7862     -3317     - 31     -  --syntax-comment: #78716c;
7863     -3318     - 32     -  --syntax-operator: #fdba74;
7864     -3319     - 33     -  --syntax-punctuation: #d4d4d4;
7865     -3320     -     26 +  /* Syntax Highlighting - Production-Grade Token Colors (One Dark Architecture) */
7866     -3321     - 34  27  
7867     -3322     - 35     -  /* Additional Token Types */
7868     -3323     - 36     -  --syntax-variable: #fcd34d; /* Variables - bright yellow (distinct from text #fed7aa) */
7869     -3324     - 37     -  --syntax-property: #f87171; /* Properties - coral */
7870     -3325     - 38     -  --syntax-namespace: #fb923c; /* Namespaces - sunset orange */
7871     -3326     - 39     -  --syntax-builtin: #f87171; /* Builtins - coral */
7872     -3327     -     28 +  /* Core hue-1: Cyan (187¬∞) - URLs */
7873     -3328     -     29 +  --syntax-url: #5eead4; /* Bright teal for URLs */
7874     -3329     -     30 +
7875     -3330     -     31 +  /* Core hue-2: Blue (207¬∞) - Functions, variables */
7876     -3331     -     32 +  --syntax-function: #60a5fa; /* Bright blue for functions */
7877     -3332     -     33 +  --syntax-variable: #38bdf8; /* Sky blue for variables */
7878     -    4584 +@@ -0,0 +1,71 @@
7879     -    4585 +      1 +# üõ°Ô∏è Audit Phase 4: Consolidation & Implementation Plan
7880     -    4586 +      2 +
7881     -    4587 +      3 +## üö® Critical Priority (Immediate Action Required)
7882     -    4588 +      4 +
7883     -    4589 +      5 +### 1. Fix Stored XSS Vulnerability
7884     -    4590 +      6 +- **Severity:** Critical
7885     -    4591 +      7 +- **Location:** `script.js` (Line 512)
7886     -    4592 +      8 +- **Issue:** Markdown is parsed and injected directly into `innerHTML` without sanitization. Malicious markdown files can execute arbitrary JavaScript.
7887     -    4593 +      9 +- **Action Plan:**
7888     -    4594 +     10 +  1. Install `dompurify`: `npm install dompurify`
7889     -    4595 +     11 +  2. Import it in `script.js` (or load via CDN if sticking to hybrid approach).
7890     -    4596 +     12 +  3. Wrap parsing: `preview.innerHTML = DOMPurify.sanitize(marked.parse(markdownText));`
7891     -    4597 +     13 +
7892     -    4598 +     14 +### 2. Remove Race Conditions in Threading
7893     -    4599 +     15 +- **Severity:** High
7894     -    4600 +     16 +- **Location:** `script.js` (Lines 490, 535)
7895     -    4601 +     17 +- **Issue:** `setTimeout` (100ms) used to guess when libraries are ready. This leads to flaky rendering and "pop-in" effects.
7896     -    4602 +     18 +- **Action Plan:**
7897     -    4603 +     19 +  1. Refactor `MermaidService.render()` to return a Promise that resolves *only* when rendering is complete.
7898     -    4604 +     20 +  2. Await this promise in `renderMarkdown()` instead of using `setTimeout`.
7899     -    4605 +     21 +
7900     -    4606 +     22 +---
7901     -    4607 +     23 +
7902     -    4608 +     24 +## üèóÔ∏è High Priority (Architectural Refactoring)
7903     -    4609 +     25 +
7904     -    4610 +     26 +### 3. Decompose Monolithic `script.js`
7905     -    4611 +     27 +- **Severity:** High
7906     -    4612 +     28 +- **Location:** `script.js` (1372 lines)
7907     -    4613 +     29 +- **Issue:** File violates Single Responsibility Principle. Handles initialization, event binding, UI rendering, logic, and service orchestration.
7908     -    4614 +     30 +- **Action Plan:**
7909     -    4615 +     31 +  1. **Extract `UIManager`**: Move all `document.getElementById` and UI toggling logic here.
7910     -    4616 +     32 +  2. **Extract `FileTreeView`**: Move the 200+ lines of DOM generation for the folder browser out of `script.js`.
7911     -    4617 +     33 +  3. **Extract `EventManager`**: Centralize event listener bindings.
7912     -3333 4618       34 +
7913     -3334     -     35 +  /* Core hue-3: Purple (286¬∞) - Keywords */
7914     -3335     -     36 +  --syntax-keyword: #c084fc; /* Bright purple for keywords (final, sealed, class keyword) */
7915     -3336     -     37 +
7916     -3337     -     38 +  /* Core hue-4: Green (95¬∞) - Strings, builtins */
7917     -3338     -     39 +  --syntax-string: #a3e635; /* Lime green for strings */
7918     -3339     -     40 +  --syntax-builtin: #84cc16; /* Vibrant green for builtins (String, List) */
7919     -3340     -     41 +  --syntax-char: #a3e635; /* Same as strings */
7920     -3341     -     42 +  --syntax-regex: #a3e635; /* Same as strings */
7921     -3342     -     43 +  --syntax-inserted: #a3e635; /* For diff */
7922     -3343     -     44 +
7923     -3344     -     45 +  /* Core hue-5: Red (355¬∞) - Properties, tags */
7924     -3345     -     46 +  --syntax-property: #fb7185; /* Coral rose for properties */
7925     -3346     -     47 +  --syntax-tag: #f87171; /* Coral for tags */
7926     -3347     -     48 +  --syntax-deleted: #f87171; /* For diff */
7927     -3348     -     49 +  --syntax-important: #fb7185; /* For !important */
7928     -3349     -     50 +
7929     -3350     -     51 +  /* Core hue-6: Orange (29¬∞) - Class names, constants, numbers */
7930     -3351     -     52 +  --syntax-class-name: #fb923c; /* Bright sunset orange for class names (Rectangle, Shape) */
7931     -3352     -     53 +  --syntax-number: #fbbf24; /* Golden yellow for numbers */
7932     -3353     -     54 +  --syntax-constant: #f97316; /* Burnt orange for constants */
7933     -3354     -     55 +  --syntax-boolean: #fbbf24; /* Same as numbers */
7934     -3355     -     56 +  --syntax-atrule: #fb923c; /* CSS @ rules */
7935     -3356     -     57 +
7936     -3357     -     58 +  /* Neutral colors */
7937     -3358     -     59 +  --syntax-comment: #a8a29e; /* Muted for comments */
7938     -3359     -     60 +  --syntax-punctuation: #d4d4d8; /* Light gray for punctuation */
7939     -3360     -     61 +  --syntax-operator: #fdba74; /* Light sunset for operators */
7940     -3361     -     62 +
7941     -3362     -     63 +  /* Markup specific */
7942     -3363     -     64 +  --syntax-attr-name: #fb923c; /* Orange like class-name */
7943     -3364     -     65 +  --syntax-attr-value: #a3e635; /* Green like strings */
7944     -3365     -     66 +  --syntax-namespace: #c084fc; /* Purple like keywords */
7945     -3366     -     67 +  --syntax-entity: #d4d4d8; /* Neutral */
7946     -3367     -     68 +  --syntax-selector: #fb7185; /* Red like properties */
7947     -3368     - 40  69  
7948     -3369     - 41  70    --blockquote-border: #f97316;
7949     -3370     - 42  71    --blockquote-bg: #2d1b0e;
7950     -3371     -@@ -44,4 +73,87 @@
7951     -3372     - 44  73    --italic-color: #fb923c;
7952     -3373     - 45  74    --table-header-bg: #3d2417;
7953     -3374     - 46  75    --table-border: #7c2d12;
7954     -3375     -     76 +
7955     -3376     -     77 +  /* === MERMAID COMPREHENSIVE CONFIGURATION === */
7956     -3377     -     78 +
7957     -3378     -     79 +  /* Core Global */
7958     -3379     -     80 +  --mermaid-background: #1c0a00;
7959     -3380     -     81 +  --mermaid-text-color: #fed7aa;
7960     -3381     -     82 +  --mermaid-line-color: #f97316;
7961     -3382     -     83 +  --mermaid-main-bkg: #3d2417;
7962     -3383     -     84 +
7963     -3384     -     85 +  /* Primary Set */
7964     -3385     -     86 +  --mermaid-primary-color: #3d2417;
7965     -3386     -     87 +  --mermaid-primary-text-color: #fed7aa;
7966     -3387     -     88 +  --mermaid-primary-border-color: #fb923c;
7967     -3388     -     89 +
7968     -3389     -     90 +  /* Secondary Set */
7969     -3390     -     91 +  --mermaid-secondary-color: #2d1b0e;
7970     -3391     -     92 +  --mermaid-secondary-text-color: #fed7aa;
7971     -3392     -     93 +  --mermaid-secondary-border-color: #f97316;
7972     -3393     -     94 +
7973     -3394     -     95 +  /* Tertiary Set */
7974     -3395     -     96 +  --mermaid-tertiary-color: #1c0a00;
7975     -3396     -     97 +  --mermaid-tertiary-text-color: #fed7aa;
7976     -3397     -     98 +  --mermaid-tertiary-border-color: #ea580c;
7977     -3398     -     99 +
7978     -3399     -    100 +  /* Flowchart */
7979     -3400     -    101 +  --mermaid-node-border: #fb923c;
7980     -3401     -    102 +  --mermaid-cluster-bkg: #2d1b0e;
7981     -3402     -    103 +  --mermaid-cluster-border: #f97316;
7982     -3403     -    104 +  --mermaid-default-link-color: #f97316;
7983     -3404     -    105 +  --mermaid-title-color: #fed7aa;
7984     -3405     -    106 +  --mermaid-edge-label-background: #1c0a00;
7985     -3406     -    107 +  --mermaid-node-text-color: #fed7aa;
7986     -3407     -    108 +
7987     -3408     -    109 +  /* Sequence Diagram */
7988     -3409     -    110 +  --mermaid-actor-bkg: #3d2417;
7989     -3410     -    111 +  --mermaid-actor-border: #fb923c;
7990     -3411     -    112 +  --mermaid-actor-text-color: #fed7aa;
7991     -3412     -    113 +  --mermaid-actor-line-color: #fb923c;
7992     -3413     -    114 +  --mermaid-signal-color: #f97316;
7993     -3414     -    115 +  --mermaid-signal-text-color: #fed7aa;
7994     -3415     -    116 +  --mermaid-label-box-bkg-color: #3d2417;
7995     -3416     -    117 +  --mermaid-label-box-border-color: #fb923c;
7996     -3417     -    118 +  --mermaid-label-text-color: #fed7aa;
7997     -3418     -    119 +  --mermaid-loop-text-color: #fed7aa;
7998     -3419     -    120 +  --mermaid-activation-border-color: #f97316;
7999     -3420     -    121 +  --mermaid-activation-bkg-color: #2d1b0e;
8000     -3421     -    122 +  --mermaid-sequence-number-color: #fed7aa;
8001     -3422     -    123 +
8002     -3423     -    124 +  /* Pie Chart */
8003     -3424     -    125 +  --mermaid-pie1: #fb923c;
8004     -3425     -    126 +  --mermaid-pie2: #f97316;
8005     -3426     -    127 +  --mermaid-pie3: #ea580c;
8006     -3427     -    128 +  --mermaid-pie4: #f87171;
8007     -3428     -    129 +  --mermaid-pie5: #fb7185;
8008     -3429     -    130 +  --mermaid-pie6: #f472b6;
8009     -3430     -    131 +  --mermaid-pie7: #fdba74;
8010     -3431     -    132 +  --mermaid-pie8: #5eead4;
8011     -3432     -    133 +  --mermaid-pie9: #60a5fa;
8012     -3433     -    134 +  --mermaid-pie10: #c084fc;
8013     -3434     -    135 +  --mermaid-pie11: #a3e635;
8014     -3435     -    136 +  --mermaid-pie12: #fbbf24;
8015     -3436     -    137 +  --mermaid-pie-title-text-color: #fed7aa;
8016     -3437     -    138 +  --mermaid-pie-section-text-color: #1c0a00; /* Dark on vibrant slices */
8017     -3438     -    139 +  --mermaid-pie-legend-text-color: #fed7aa;
8018     -3439     -    140 +  --mermaid-pie-stroke-color: #fb923c;
8019     -3440     -    141 +  --mermaid-pie-outer-stroke-color: #fb923c;
8020     -3441     -    142 +
8021     -3442     -    143 +  /* State Diagram */
8022     -3443     -    144 +  --mermaid-label-color: #fed7aa;
8023     -3444     -    145 +  --mermaid-alt-background: #2d1b0e;
8024     -3445     -    146 +
8025     -3446     -    147 +  /* Class Diagram */
8026     -3447     -    148 +  --mermaid-class-text: #fed7aa;
8027     -3448     -    149 +
8028     -3449     -    150 +  /* User Journey */
8029     -3450     -    151 +  --mermaid-fill-type0: #fb923c;
8030     -3451     -    152 +  --mermaid-fill-type1: #f97316;
8031     -3452     -    153 +  --mermaid-fill-type2: #ea580c;
8032     -3453     -    154 +  --mermaid-fill-type3: #f87171;
8033     -3454     -    155 +  --mermaid-fill-type4: #fb7185;
8034     -3455     -    156 +  --mermaid-fill-type5: #f472b6;
8035     -3456     -    157 +  --mermaid-fill-type6: #fdba74;
8036     -3457     -    158 +  --mermaid-fill-type7: #5eead4;
8037     -3458     - 47 159  }
8038     -3459     - 48 160  
8039     -    4619 +     35 +### 4. Standardize Dependency Management
8040     -    4620 +     36 +- **Severity:** Medium
8041     -    4621 +     37 +- **Location:** `index.html`
8042     -    4622 +     38 +- **Issue:** Runtime dependencies (Marked, Prism, Mermaid, KaTeX) are loaded via CDNs, while dev tools are in `package.json`. This creates a fragility where internet access is required for the "local" app to run.
8043     -    4623 +     39 +- **Action Plan:**
8044     -    4624 +     40 +  1. Install runtime deps: `npm install marked prismjs mermaid katex html2pdf.js`
8045     -    4625 +     41 +  2. Update `vite.config.js` to bundle these assets.
8046     -    4626 +     42 +  3. Remove CDN links from `index.html`.
8047     -    4627 +     43 +
8048     -    4628 +     44 +---
8049     -    4629 +     45 +
8050     -    4630 +     46 +## üßπ Medium Priority (Cleanup)
8051     -    4631 +     47 +
8052     -    4632 +     48 +### 5. Update Documentation
8053     -    4633 +     49 +- **Severity:** Low
8054     -    4634 +     50 +- **Location:** `README.md`
8055     -    4635 +     51 +- **Issue:** Documentation mentions Java/Python support, implying backend code, but the repo is purely static frontend.
8056     -    4636 +     52 +- **Action Plan:**
8057     -    4637 +     53 +  1. Clarify "Client-Side Only" architecture in README.
8058     -    4638 +     54 +  2. Update "Tech Stack" section to reflect actual discovered files.
8059     -    4639 +     55 +
8060     -    4640 +     56 +### 6. Centralize Configuration
8061     -    4641 +     57 +- **Severity:** Low
8062     -    4642 +     58 +- **Issue:** Some magic numbers (sidebar widths, zoom limits) are still hardcoded in `script.js`.
8063     -    4643 +     59 +- **Action Plan:**
8064     -    4644 +     60 +  1. Move all remaining constants to `src/js/config/constants.js`.
8065     -    4645 +     61 +
8066     -    4646 +     62 +---
8067     -    4647 +     63 +
8068     -    4648 +     64 +## üìÖ Roadmap
8069     -    4649 +     65 +
8070     -    4650 +     66 +| Phase | Task | Est. Effort |
8071     -    4651 +     67 +|-------|------|-------------|
8072     -    4652 +     68 +| **Week 1** | Security Fixes (XSS) + `setTimeout` Removal | 1 Day |
8073     -    4653 +     69 +| **Week 2** | Split `script.js` -> `UIManager`, `AppController` | 3 Days |
8074     -    4654 +     70 +| **Week 3** | Dependency Migration (CDN -> NPM) | 2 Days |
8075     -    4655 +     71 +| **Week 4** | Documentation & Final Polish | 1 Day |
8076     -    4656 +     72  
8077     -3460 4657  
8078     -3461 4658  ```
8079     -3462 4659  
8080     -3463 4660  
8081     -3464     -### üìÑ `themes/sunset-light.css`
8082     -    4661 +### ‚ú® `codebase_audit/phase5_recommendations.md` **[ADDED]**
8083     -3465 4662  
8084     -3466     -**Type:** Stylesheet üé®
8085     -    4663 +**Status:** ‚úÖ **NEW FILE** - This file has been newly created
8086     -    4664 +
8087     -    4665 +**Type:** Documentation üìñ
8088     -3467 4666  
8089     -3468 4667  ```diff
8090     -3469     -@@ -23,20 +23,49 @@
8091     -3470     - 23  23    --code-block-bg: #ffedd5; /* Light orange background */
8092     -3471     - 24  24    --code-border: #fdba74;
8093     -3472     - 25  25  
8094     -3473     - 26     -  /* Syntax Highlighting - Comprehensive Token Colors */
8095     -3474     - 27     -  --syntax-keyword: #ea580c;
8096     -3475     - 28     -  --syntax-string: #16a34a;
8097     -3476     - 29     -  --syntax-number: #f59e0b;
8098     -3477     - 30     -  --syntax-function: #dc2626;
8099     -3478     - 31     -  --syntax-comment: #78716c;
8100     -3479     - 32     -  --syntax-operator: #c2410c;
8101     -3480     - 33     -  --syntax-punctuation: #57534e;
8102     -3481     -     26 +  /* Syntax Highlighting - Production-Grade Token Colors (Based on One Dark Architecture) */
8103     -3482     - 34  27  
8104     -3483     - 35     -  /* Additional Token Types for Full Customization */
8105     -3484     - 36     -  --syntax-variable: #ea580c; /* Variables - sunset orange */
8106     -3485     - 37     -  --syntax-property: #dc2626; /* Properties - red */
8107     -3486     - 38     -  --syntax-namespace: #f97316; /* Namespaces - bright orange */
8108     -3487     - 39     -  --syntax-builtin: #dc2626; /* Builtins - red */
8109     -3488     -     28 +  /* Core hue-1: Cyan (187¬∞) - URLs, special strings */
8110     -3489     -     29 +  --syntax-url: #14b8a6; /* Teal/cyan for URLs */
8111     -3490     -     30 +
8112     -3491     -     31 +  /* Core hue-2: Blue (207¬∞) - Functions, variables, operators */
8113     -3492     -     32 +  --syntax-function: #3b82f6; /* Bright blue for functions */
8114     -3493     -     33 +  --syntax-variable: #0ea5e9; /* Sky blue for variables */
8115     -3494     -     34 +
8116     -3495     -     35 +  /* Core hue-3: Purple (286¬∞) - Keywords */
8117     -3496     -     36 +  --syntax-keyword: #a855f7; /* Vibrant purple for keywords (if, final, sealed) */
8118     -    4668 +@@ -0,0 +1,41 @@
8119     -    4669 +      1 +# üí° Phase 5: Recommendations & Roadmap
8120     -    4670 +      2 +
8121     -    4671 +      3 +Based on the consolidated findings, here are the strategic recommendations for the `markdown-viewer-app`.
8122     -    4672 +      4 +
8123     -    4673 +      5 +## üß† Strategic Recommendations
8124     -    4674 +      6 +
8125     -    4675 +      7 +### 1. Security Hardening (Immediate)
8126     -    4676 +      8 +*   **Mitigate XSS:** The application **must** integrate a sanitization library (e.g., `DOMPurify`) before rendering any Markdown content. This is non-negotiable for a viewer app.
8127     -    4677 +      9 +*   **Content Security Policy (CSP):** Implement a strict CSP in `index.html` to prevent unauthorized script execution, especially since we rely on CDNs.
8128     -    4678 +     10 +
8129     -    4679 +     11 +### 2. Architectural Refactoring (Short Term)
8130     -    4680 +     12 +*   **Adopt MVC/MVVM:** Move away from the "Giant Script" pattern.
8131     -    4681 +     13 +    *   **Model:** `StorageManager.js` (Already exists, good).
8132     -    4682 +     14 +    *   **View:** Create `UIManager.js` to handle all DOM updates.
8133     -    4683 +     15 +    *   **Controller:** Slim down `script.js` to only handle event orchestration.
8134     -    4684 +     16 +*   **Event-Driven Architecture:** Expand the `ThemeManager`'s observer pattern to a global `EventManager` to decouple components.
8135     -    4685 +     17 +
8136     -    4686 +     18 +### 3. Modernization (Medium Term)
8137     -    4687 +     19 +*   **Migrate to TypeScript:** The project checks for TS in `package.json` but uses JS. Migrating to TypeScript will eliminate type-related bugs and self-document the code.
8138     -    4688 +     20 +*   **Bundle Management:** Move from CDN links in `index.html` to a built bundle (Vite). This ensures the app works offline (a key value prop) and stabilizes dependency versions.
8139     -    4689 +     21 +
8140     -    4690 +     22 +### 4. Quality Assurance (Long Term)
8141     -    4691 +     23 +*   **Automated E2E Testing:** Implement Playwright or Cypress tests to verify the "Sync Scroll" and "Theme Switching" features automatically, reducing manual testing burden.
8142     -    4692 +     24 +
8143     -    4693 +     25 +## üó∫Ô∏è Proposed Roadmap
8144     -    4694 +     26 +
8145     -    4695 +     27 +### Phase A: Stability & Security (Week 1)
8146     -    4696 +     28 +- [ ] Install `dompurify`
8147     -    4697 +     29 +- [ ] Implement input sanitization
8148     -    4698 +     30 +- [ ] Replace `setTimeout` with `Promise` chains
8149     -    4699 +     31 +- [ ] Fix race conditions in Theme/Mermaid loading
8150     -    4700 +     32 +
8151     -    4701 +     33 +### Phase B: decoupling (Week 2)
8152     -    4702 +     34 +- [ ] Extract `FolderBrowser` logic to `src/js/components/FileTree.js`
8153     -    4703 +     35 +- [ ] Extract global event listeners to `src/js/core/EventManager.js`
8154     -    4704 +     36 +- [ ] Refactor `script.js` to use these new modules
8155     -3497 4705       37 +
8156     -3498     -     38 +  /* Core hue-4: Green (95¬∞) - Strings, builtins, inserted */
8157     -3499     -     39 +  --syntax-string: #10b981; /* Emerald green for strings */
8158     -3500     -     40 +  --syntax-builtin: #059669; /* Darker green for builtins (String, List, Array) */
8159     -3501     -     41 +  --syntax-char: #10b981; /* Same as strings */
8160     -3502     -     42 +  --syntax-regex: #10b981; /* Same as strings */
8161     -3503     -     43 +  --syntax-inserted: #10b981; /* For diff highlights */
8162     -3504     -     44 +
8163     -3505     -     45 +  /* Core hue-5: Red (355¬∞) - Properties, tags, deleted, important */
8164     -3506     -     46 +  --syntax-property: #ef4444; /* Red for properties */
8165     -3507     -     47 +  --syntax-tag: #ef4444; /* Red for HTML tags */
8166     -3508     -     48 +  --syntax-deleted: #ef4444; /* For diff highlights */
8167     -3509     -     49 +  --syntax-important: #ef4444; /* For !important */
8168     -3510     -     50 +
8169     -3511     -     51 +  /* Core hue-6: Orange (29¬∞) - Class names, constants, numbers, atrules */
8170     -3512     -     52 +  --syntax-class-name: #f97316; /* Orange for class/type names (Rectangle, Shape) */
8171     -3513     -     53 +  --syntax-number: #fb923c; /* Bright orange for numbers */
8172     -3514     -     54 +  --syntax-constant: #ea580c; /* Burnt orange for constants */
8173     -3515     -     55 +  --syntax-boolean: #fb923c; /* Same as numbers */
8174     -3516     -     56 +  --syntax-atrule: #fb923c; /* CSS @ rules */
8175     -3517     -     57 +
8176     -3518     -     58 +  /* Neutral colors */
8177     -3519     -     59 +  --syntax-comment: #a8a29e; /* Muted stone for comments */
8178     -3520     -     60 +  --syntax-punctuation: #64748b; /* Slate for punctuation */
8179     -3521     -     61 +  --syntax-operator: #fb7185; /* Coral rose for operators */
8180     -3522     -     62 +
8181     -3523     -     63 +  /* Markup specific */
8182     -3524     -     64 +  --syntax-attr-name: #f97316; /* Orange like class-name */
8183     -3525     -     65 +  --syntax-attr-value: #10b981; /* Green like strings */
8184     -3526     -     66 +  --syntax-namespace: #a855f7; /* Purple like keywords */
8185     -3527     -     67 +  --syntax-entity: #64748b; /* Neutral */
8186     -3528     -     68 +  --syntax-selector: #ef4444; /* Red like properties */
8187     -3529     - 40  69  
8188     -3530     - 41  70    --blockquote-border: #f97316;
8189     -3531     - 42  71    --blockquote-bg: #ffedd5;
8190     -3532     -@@ -44,4 +73,87 @@
8191     -3533     - 44  73    --italic-color: #e11d48;
8192     -3534     - 45  74    --table-header-bg: #fed7aa;
8193     -3535     - 46  75    --table-border: #fdba74;
8194     -3536     -     76 +
8195     -3537     -     77 +  /* === MERMAID COMPREHENSIVE CONFIGURATION === */
8196     -3538     -     78 +
8197     -3539     -     79 +  /* Core Global */
8198     -3540     -     80 +  --mermaid-background: #fff7ed;
8199     -3541     -     81 +  --mermaid-text-color: #431407;
8200     -3542     -     82 +  --mermaid-line-color: #f97316;
8201     -3543     -     83 +  --mermaid-main-bkg: #fed7aa;
8202     -3544     -     84 +
8203     -3545     -     85 +  /* Primary Set */
8204     -3546     -     86 +  --mermaid-primary-color: #fed7aa;
8205     -3547     -     87 +  --mermaid-primary-text-color: #431407;
8206     -3548     -     88 +  --mermaid-primary-border-color: #ea580c;
8207     -3549     -     89 +
8208     -3550     -     90 +  /* Secondary Set */
8209     -3551     -     91 +  --mermaid-secondary-color: #ffedd5;
8210     -3552     -     92 +  --mermaid-secondary-text-color: #431407;
8211     -3553     -     93 +  --mermaid-secondary-border-color: #f97316;
8212     -3554     -     94 +
8213     -3555     -     95 +  /* Tertiary Set */
8214     -3556     -     96 +  --mermaid-tertiary-color: #fff7ed;
8215     -3557     -     97 +  --mermaid-tertiary-text-color: #431407;
8216     -3558     -     98 +  --mermaid-tertiary-border-color: #fb923c;
8217     -3559     -     99 +
8218     -3560     -    100 +  /* Flowchart */
8219     -3561     -    101 +  --mermaid-node-border: #ea580c;
8220     -3562     -    102 +  --mermaid-cluster-bkg: #ffedd5;
8221     -3563     -    103 +  --mermaid-cluster-border: #f97316;
8222     -3564     -    104 +  --mermaid-default-link-color: #f97316;
8223     -3565     -    105 +  --mermaid-title-color: #431407;
8224     -3566     -    106 +  --mermaid-edge-label-background: #fff7ed;
8225     -3567     -    107 +  --mermaid-node-text-color: #431407;
8226     -3568     -    108 +
8227     -3569     -    109 +  /* Sequence Diagram */
8228     -3570     -    110 +  --mermaid-actor-bkg: #fed7aa;
8229     -3571     -    111 +  --mermaid-actor-border: #ea580c;
8230     -3572     -    112 +  --mermaid-actor-text-color: #431407;
8231     -3573     -    113 +  --mermaid-actor-line-color: #ea580c;
8232     -3574     -    114 +  --mermaid-signal-color: #f97316;
8233     -3575     -    115 +  --mermaid-signal-text-color: #431407;
8234     -3576     -    116 +  --mermaid-label-box-bkg-color: #fed7aa;
8235     -3577     -    117 +  --mermaid-label-box-border-color: #ea580c;
8236     -3578     -    118 +  --mermaid-label-text-color: #431407;
8237     -3579     -    119 +  --mermaid-loop-text-color: #431407;
8238     -3580     -    120 +  --mermaid-activation-border-color: #f97316;
8239     -3581     -    121 +  --mermaid-activation-bkg-color: #ffedd5;
8240     -3582     -    122 +  --mermaid-sequence-number-color: #431407;
8241     -3583     -    123 +
8242     -3584     -    124 +  /* Pie Chart */
8243     -3585     -    125 +  --mermaid-pie1: #ea580c;
8244     -3586     -    126 +  --mermaid-pie2: #f97316;
8245     -3587     -    127 +  --mermaid-pie3: #fb923c;
8246     -3588     -    128 +  --mermaid-pie4: #dc2626;
8247     -3589     -    129 +  --mermaid-pie5: #e11d48;
8248     -3590     -    130 +  --mermaid-pie6: #db2777;
8249     -3591     -    131 +  --mermaid-pie7: #c2410c;
8250     -3592     -    132 +  --mermaid-pie8: #14b8a6;
8251     -3593     -    133 +  --mermaid-pie9: #3b82f6;
8252     -3594     -    134 +  --mermaid-pie10: #a855f7;
8253     -3595     -    135 +  --mermaid-pie11: #ef4444;
8254     -3596     -    136 +  --mermaid-pie12: #10b981;
8255     -3597     -    137 +  --mermaid-pie-title-text-color: #431407;
8256     -3598     -    138 +  --mermaid-pie-section-text-color: #fff7ed; /* Light on vibrant slices */
8257     -3599     -    139 +  --mermaid-pie-legend-text-color: #431407;
8258     -3600     -    140 +  --mermaid-pie-stroke-color: #ea580c;
8259     -3601     -    141 +  --mermaid-pie-outer-stroke-color: #ea580c;
8260     -3602     -    142 +
8261     -3603     -    143 +  /* State Diagram */
8262     -3604     -    144 +  --mermaid-label-color: #431407;
8263     -3605     -    145 +  --mermaid-alt-background: #ffedd5;
8264     -3606     -    146 +
8265     -3607     -    147 +  /* Class Diagram */
8266     -3608     -    148 +  --mermaid-class-text: #431407;
8267     -3609     -    149 +
8268     -3610     -    150 +  /* User Journey */
8269     -3611     -    151 +  --mermaid-fill-type0: #ea580c;
8270     -3612     -    152 +  --mermaid-fill-type1: #f97316;
8271     -3613     -    153 +  --mermaid-fill-type2: #fb923c;
8272     -3614     -    154 +  --mermaid-fill-type3: #dc2626;
8273     -3615     -    155 +  --mermaid-fill-type4: #e11d48;
8274     -3616     -    156 +  --mermaid-fill-type5: #db2777;
8275     -3617     -    157 +  --mermaid-fill-type6: #c2410c;
8276     -3618     -    158 +  --mermaid-fill-type7: #14b8a6;
8277     -3619     - 47 159  }
8278     -3620     - 48 160  
8279     -    4706 +     38 +### Phase C: Infrastructure (Week 3)
8280     -    4707 +     39 +- [ ] Migrate runtime deps (Marked, Mermaid) to `npm`
8281     -    4708 +     40 +- [ ] Configure Vite for production bundling
8282     -    4709 +     41 +- [ ] Set up basic E2E tests for critical paths (Render, Export)
8283     -    4710 +     42  
8284     -    4711 +
8285     -    4712 +```
8286     -    4713 +
8287     -    4714 +
8288     -    4715 +### ‚ú® `codebase_audit/phase6_final_deliverables.md` **[ADDED]**
8289     -    4716 +
8290     -    4717 +**Status:** ‚úÖ **NEW FILE** - This file has been newly created
8291     -    4718 +
8292     -    4719 +**Type:** Documentation üìñ
8293     -    4720 +
8294     -    4721 +```diff
8295     -    4722 +@@ -0,0 +1,44 @@
8296     -    4723 +      1 +# üì¶ Phase 6: Final Deliverables
8297     -    4724 +      2 +
8298     -    4725 +      3 +## 1. Audit Summary
8299     -    4726 +      4 +The `markdown-viewer-app` is a capable, feature-rich static web application. It delivers on its core promise of "no set-up" markdown viewing. However, it carries significant **Technical Debt** in its control structure (`script.js`) and a **Critical Security Vulnerability** that makes it unsafe for handling untrusted files.
8300     -    4727 +      5 +
8301     -    4728 +      6 +## 2. Test Strategy Outline
8302     -    4729 +      7 +To ensure quality during the proposed refactoring, we recommend the following test strategy:
8303     -    4730 +      8 +
8304     -    4731 +      9 +*   **Unit Tests (Vitest):**
8305     -    4732 +     10 +    *   Cover `StorageManager` (Data persistence).
8306     -    4733 +     11 +    *   Cover `ThemeManager` (Logic correctness).
8307     -    4734 +     12 +    *   Cover `Sanitization` (Verify malicious inputs are stripped).
8308     -    4735 +     13 +*   **Integration Tests:**
8309     -    4736 +     14 +    *   Verify `MermaidService` correctly loads config from `ThemeManager`.
8310     -    4737 +     15 +*   **Manual Acceptance Tests:**
8311     -    4738 +     16 +    *   "The Scroll Sync Test": Verify proportional scrolling in split view.
8312     -    4739 +     17 +    *   "The Theme Switch Test": Verify no "flash of white" or broken diagrams on switch.
8313     -    4740 +     18 +
8314     -    4741 +     19 +## 3. Stakeholder Slide-Deck Outline
8315     -    4742 +     20 +
8316     -    4743 +     21 +**Slide 1: Title**
8317     -    4744 +     22 +*   **audit Report: Markdown Viewer Pro**
8318     -    4745 +     23 +*   *Status: Critical Issues Found*
8319     -    4746 +     24 +
8320     -    4747 +     25 +**Slide 2: The Good**
8321     -    4748 +     26 +*   Zero-config, runs everywhere.
8322     -    4749 +     27 +*   Modular Service layer (Mermaid, Prism, PDF) is well-designed.
8323     -    4750 +     28 +*   Excellent Documentation.
8324     -    4751 +     29 +
8325     -    4752 +     30 +**Slide 3: The Bad (Critical Findings)**
8326     -    4753 +     31 +*   **Security:** XSS Vulnerability (Malicious MD files can hack users).
8327     -    4754 +     32 +*   **Stability:** Race conditions cause occasional rendering glitches.
8328     -    4755 +     33 +
8329     -    4756 +     34 +**Slide 4: The Ugly (Tech Debt)**
8330     -    4757 +     35 +*   `script.js` is a "God Object" (1300+ lines).
8331     -    4758 +     36 +*   Hard to maintain or extend without accidental breakage.
8332     -    4759 +     37 +
8333     -    4760 +     38 +**Slide 5: The Plan**
8334     -    4761 +     39 +*   **Immediate:** Fix Security.
8335     -    4762 +     40 +*   **Next:** Refactor Controller.
8336     -    4763 +     41 +*   **Future:** TypeScript & Bundling.
8337     -    4764 +     42 +
8338     -    4765 +     43 +**Slide 6: Approval Request**
8339     -    4766 +     44 +*   Requesting approval to proceed with Phase A (Security Fixes).
8340     -    4767 +     45  
8341     -    4768 +
8342     -    4769 +```
8343     -    4770 +
8344     -    4771 +
8345     -    4772 +### ‚ú® `codebase_audit/repo_manifest.json` **[ADDED]**
8346     -    4773 +
8347     -    4774 +**Status:** ‚úÖ **NEW FILE** - This file has been newly created
8348     -    4775 +
8349     -    4776 +**Type:** Configuration/Data File üìã
8350     -    4777 +
8351     -    4778 +```diff
8352     -    4779 +@@ -0,0 +1,74 @@
8353     -    4780 +      1 +{
8354     -    4781 +      2 +  "documentation": [
8355     -    4782 +      3 +    "AI_REVIEW.md",
8356     -    4783 +      4 +    "MARKDOWN_TEST.md",
8357     -    4784 +      5 +    "QUICK-REFERENCE.md",
8358     -    4785 +      6 +    "README.md",
8359     -    4786 +      7 +    "docs/01-requirements/folder-browser-feature-plan.md",
8360     -    4787 +      8 +    "docs/01-requirements/math-rendering-feature-plan.md",
8361     -    4788 +      9 +    "docs/01-requirements/pdf-export-plan.md",
8362     -    4789 +     10 +    "docs/01-requirements/pdf-viewer-feature-plan.md",
8363     -    4790 +     11 +    "docs/02-architecture/architecture-review.md",
8364     -    4791 +     12 +    "docs/02-architecture/architecture.md",
8365     -    4792 +     13 +    "docs/02-architecture/mermaid-theme-architecture.md",
8366     -    4793 +     14 +    "docs/02-architecture/phase6-improvements.md",
8367     -    4794 +     15 +    "docs/02-architecture/prism-token-architecture.md",
8368     -    4795 +     16 +    "docs/02-architecture/syntax-highlighting-architecture.md",
8369     -    4796 +     17 +    "docs/05-implementation/implementation-plan.md",
8370     -    4797 +     18 +    "docs/05-implementation/refactoring-guide.md",
8371     -    4798 +     19 +    "docs/05-implementation/refactoring-strategy.md",
8372     -    4799 +     20 +    "docs/05-implementation/week6-final-integration.md",
8373     -    4800 +     21 +    "docs/08-deployment/deployment.md",
8374     -    4801 +     22 +    "docs/08-deployment/github-pages-deployment.md",
8375     -    4802 +     23 +    "memory-bank/activeContext.md",
8376     -    4803 +     24 +    "memory-bank/productContext.md",
8377     -    4804 +     25 +    "memory-bank/progress.md",
8378     -    4805 +     26 +    "memory-bank/projectbrief.md",
8379     -    4806 +     27 +    "memory-bank/systemPatterns.md",
8380     -    4807 +     28 +    "memory-bank/techContext.md"
8381     -    4808 +     29 +  ],
8382     -    4809 +     30 +  "source_code": {
8383     -    4810 +     31 +    "javascript": [
8384     -    4811 +     32 +      "script.js",
8385     -    4812 +     33 +      "src/js/services/MermaidService.js",
8386     -    4813 +     34 +      "src/js/services/FolderBrowserService.js",
8387     -    4814 +     35 +      "src/js/services/PDFService.js",
8388     -    4815 +     36 +      "src/js/services/PrismService.js",
8389     -    4816 +     37 +      "src/js/utils/htmlHelpers.js",
8390     -    4817 +     38 +      "src/js/utils/colorHelpers.js",
8391     -    4818 +     39 +      "src/js/utils/validators.js",
8392     -    4819 +     40 +      "src/js/config/featureFlags.js",
8393     -    4820 +     41 +      "src/js/config/constants.js",
8394     -    4821 +     42 +      "src/js/core/ThemeManager.js",
8395     -    4822 +     43 +      "src/js/core/StorageManager.js"
8396     -    4823 +     44 +    ],
8397     -    4824 +     45 +    "css": [
8398     -    4825 +     46 +      "style.css",
8399     -    4826 +     47 +      "themes/obsidian-light.css",
8400     -    4827 +     48 +      "themes/ocean-light.css",
8401     -    4828 +     49 +      "themes/sunset-light.css",
8402     -    4829 +     50 +      "themes/default-light.css",
8403     -    4830 +     51 +      "themes/obsidian-dark.css",
8404     -    4831 +     52 +      "themes/sunset-dark.css",
8405     -    4832 +     53 +      "themes/neon-light.css",
8406     -    4833 +     54 +      "themes/forest-light.css",
8407     -    4834 +     55 +      "themes/forest-dark.css",
8408     -    4835 +     56 +      "themes/ocean-dark.css",
8409     -    4836 +     57 +      "themes/neon-dark.css",
8410     -    4837 +     58 +      "themes/default-dark.css"
8411     -    4838 +     59 +    ],
8412     -    4839 +     60 +    "html": [
8413     -    4840 +     61 +      "index.html"
8414     -    4841 +     62 +    ]
8415     -    4842 +     63 +  },
8416     -    4843 +     64 +  "config": [
8417     -    4844 +     65 +    ".clinerules",
8418     -    4845 +     66 +    ".eslintrc.js",
8419     -    4846 +     67 +    ".gitignore",
8420     -    4847 +     68 +    ".prettierrc",
8421     -    4848 +     69 +    "package.json",
8422     -    4849 +     70 +    "vite.config.js",
8423     -    4850 +     71 +    "vitest.config.js",
8424     -    4851 +     72 +    "tests/setup.js"
8425     -    4852 +     73 +  ]
8426     -    4853 +     74 +}
8427     -    4854 +     75  
8428     -3621 4855  
8429     -3622 4856  ```
8430     -3623 4857  
8431     -@@ -3663,4 +4897,4 @@ Please provide specific feedback on:
8432     -3663 4897  
8433     -3664 4898  ---
8434     -3665 4899  *Generated by AI Visual Code Review v2.0 - Unified Export Script*
8435     -3666     -*Files processed: 18/18 | Errors: 0 | Generated: 2025-12-07T04:29:24.609Z*
8436     -    4900 +*Files processed: 13/13 | Errors: 0 | Generated: 2025-12-09T01:32:01.029Z*
8437     -3667 4901  
8438     -
8439     -```
8440     -
8441     -
8442     -### üìÑ `package-lock.json`
8443     -
8444     -**Type:** Configuration/Data File üìã
8445     -
8446     -```diff
8447     -@@ -9,6 +9,7 @@
8448     -  9   9        "version": "0.1.0",
8449     - 10  10        "license": "MIT",
8450     - 11  11        "dependencies": {
8451     -     12 +        "dompurify": "3.3.1",
8452     - 12  13          "marked-footnote": "1.4.0"
8453     - 13  14        },
8454     - 14  15        "devDependencies": {
8455     -@@ -1280,6 +1281,13 @@
8456     -1280 1281        "dev": true,
8457     -1281 1282        "license": "MIT"
8458     -1282 1283      },
8459     -    1284 +    "node_modules/@types/trusted-types": {
8460     -    1285 +      "version": "2.0.7",
8461     -    1286 +      "resolved": "https://registry.npmjs.org/@types/trusted-types/-/trusted-types-2.0.7.tgz",
8462     -    1287 +      "integrity": "sha512-ScaPdn1dQczgbl0QFTeTOmVHFULt394XJgOQNoyVhZ6r2vLnMLJfBPd53SB52T/3G36VI1/g2MZaX0cwDuXsfw==",
8463     -    1288 +      "license": "MIT",
8464     -    1289 +      "optional": true
8465     -    1290 +    },
8466     -1283 1291      "node_modules/@vitest/coverage-v8": {
8467     -1284 1292        "version": "4.0.8",
8468     -1285 1293        "resolved": "https://registry.npmjs.org/@vitest/coverage-v8/-/coverage-v8-4.0.8.tgz",
8469     -@@ -1932,6 +1940,15 @@
8470     -1932 1940          "npm": "1.2.8000 || >= 1.4.16"
8471     -1933 1941        }
8472     -1934 1942      },
8473     -    1943 +    "node_modules/dompurify": {
8474     -    1944 +      "version": "3.3.1",
8475     -    1945 +      "resolved": "https://registry.npmjs.org/dompurify/-/dompurify-3.3.1.tgz",
8476     -    1946 +      "integrity": "sha512-qkdCKzLNtrgPFP1Vo+98FRzJnBRGe4ffyCea9IwHB1fyxPOeNTHpLKYGd4Uk9xvNoH0ZoOjwZxNptyMwqrId1Q==",
8477     -    1947 +      "license": "(MPL-2.0 OR Apache-2.0)",
8478     -    1948 +      "optionalDependencies": {
8479     -    1949 +        "@types/trusted-types": "^2.0.7"
8480     -    1950 +      }
8481     -    1951 +    },
8482     -1935 1952      "node_modules/dunder-proto": {
8483     -1936 1953        "version": "1.0.1",
8484     -1937 1954        "resolved": "https://registry.npmjs.org/dunder-proto/-/dunder-proto-1.0.1.tgz",
8485     -1938 1955  
8486     -
8487     -```
8488     -
8489     -
8490     -### üìÑ `package.json`
8491     -
8492     -**Type:** Configuration/Data File üìã
8493     -
8494     -```diff
8495     -@@ -41,6 +41,7 @@
8496     - 41  41      "vitest": "4.0.8"
8497     - 42  42    },
8498     - 43  43    "dependencies": {
8499     -     44 +    "dompurify": "3.3.1",
8500     - 44  45      "marked-footnote": "1.4.0"
8501     - 45  46    }
8502     - 46  47  }
8503     - 47  48  
8504     -
8505     -```
     16 +### üì¶ Large Files Skipped
     17 +The following files were skipped due to size (use --no-size-limit to include):
     18 +- `AI_REVIEW.md`
8506  19  
8507  20  
8508  21  ### üìÑ `script.js`
@@ -8510,1585 +23,1614 @@
8510  23  **Type:** JavaScript Source File üü®
8511  24  
8512  25  ```diff
8513     -@@ -7,6 +7,7 @@ import { FolderBrowserService } from './src/js/services/FolderBrowserService.js'
8514     -  7   7  import { MermaidService } from './src/js/services/MermaidService.js';
8515     -  8   8  import { PDFService } from './src/js/services/PDFService.js';
8516     -  9   9  import { PrismService } from './src/js/services/PrismService.js';
8517     -     10 +import DOMPurify from 'dompurify';
8518     - 10  11  
8519     - 11  12  // Initialize services and managers
8520     - 12  13  const storageManager = new StorageManager();
8521     -@@ -94,6 +95,23 @@ function initializeApp() {
8522     - 94  95    setupEditor();
8523     - 95  96  }
8524     - 96  97  
8525     -     98 +/**
8526     -     99 + * Debounce utility function
8527     -    100 + * @param {Function} func - Function to debounce
8528     -    101 + * @param {number} wait - Wait time in milliseconds
8529     -    102 + * @returns {Function} Debounced function
8530     -    103 + */
8531     -    104 +function debounce(func, wait) {
8532     -    105 +  let timeout;
8533     -    106 +  return function truncated(...args) {
8534     -    107 +    const context = this;
8535     -    108 +    clearTimeout(timeout);
8536     -    109 +    timeout = setTimeout(() => {
8537     -    110 +      func.apply(context, args);
8538     -    111 +    }, wait);
8539     -    112 +  };
8540     -    113 +}
8541     -    114 +
8542     - 97 115  // Configure marked.js extensions (math + footnotes + admonitions)
8543     - 98 116  function configureMarkedExtensions() {
8544     - 99 117    // Enable footnote support
8545     -@@ -507,98 +525,107 @@ graph TD
8546     -507 525            }, 100);
8547     -508 526            return `<div class="mermaid" id="${id}">${code}</div>`;
8548     -509 527          }
8549     -    528 +        }
8550     -510 529        );
8551     -511 530  
8552     -512     -      preview.innerHTML = html;
8553     -513     -
8554     -514     -      // Apply Prism syntax highlighting using PrismService
8555     -515     -      prismService.highlightAll(preview);
8556     -516     -
8557     -517     -      // NOTE: KaTeX auto-render is DISABLED
8558     -518     -      // We handle all math via marked.js extensions ($...$ and $$...$$)
8559     -519     -      // KaTeX auto-render was causing issues with unsupported LaTeX environments
8560     -520     -
8561     -521     -      // Save content using StorageManager
8562     -522     -      storageManager.set('markdownContent', markdownText);
8563     -523     -    } catch (error) {
8564     -524     -      console.error('Render error:', error);
8565     -525     -      preview.innerHTML =
8566     -526     -        '<p style="color: red;">Error rendering markdown: ' + error.message + '</p>';
8567     -527     -    }
8568     -528     -  }
8569     -529     -
8570     -530     -  // Change theme using ThemeManager
8571     -531     -  async function changeTheme(themeName) {
8572     -532     -    await themeManager.loadTheme(themeName);
8573     -533     -
8574     -534     -    // Wait for theme to load, then reinitialize Mermaid and force re-render
8575     -535     -    setTimeout(() => {
8576     -536     -      // Clear existing Mermaid diagrams to force fresh render with new colors
8577     -537     -      const mermaidElements = preview.querySelectorAll('.mermaid');
8578     -538     -      mermaidElements.forEach(el => {
8579     -539     -        // Reset to original code to force re-render
8580     -540     -        el.innerHTML = el.dataset.originalCode || '';
8581     -541     -      });
8582     -542     -
8583     -543     -      // Re-render markdown with new theme
8584     -544     -      renderMarkdown();
8585     -545     -    }, 100);
8586     -546     -  }
     26 +@@ -1,13 +1,13 @@
     27 +  1   1  // Markdown Viewer Pro - Main Script
     28 +  2   2  
     29 +  3   3  // Import constants, utilities, services, and core modules
     30 +      4 +import DOMPurify from 'dompurify';
     31 +  4   5  import { StorageManager } from './src/js/core/StorageManager.js';
     32 +  5   6  import { ThemeManager } from './src/js/core/ThemeManager.js';
     33 +  6   7  import { FolderBrowserService } from './src/js/services/FolderBrowserService.js';
     34 +  7   8  import { MermaidService } from './src/js/services/MermaidService.js';
     35 +  8   9  import { PDFService } from './src/js/services/PDFService.js';
     36 +  9  10  import { PrismService } from './src/js/services/PrismService.js';
     37 + 10     -import DOMPurify from 'dompurify';
     38 + 11  11  
     39 + 12  12  // Initialize services and managers
     40 + 13  13  const storageManager = new StorageManager();
     41 +@@ -29,12 +29,11 @@ themeManager.setThemeChangeListener(() => {
     42 + 29  29    mermaidService.reinitialize();
     43 + 30  30  
     44 + 31  31    // Force re-render of markdown to apply new Mermaid colors
     45 + 32     -  setTimeout(() => {
     46 + 33     -    if (globalRenderMarkdown) {
     47 + 34     -      console.log('üîÑ Re-rendering diagrams with new theme colors');
     48 + 35     -      globalRenderMarkdown();
     49 + 36     -    }
     50 + 37     -  }, 200);
     51 +     32 +  // No timeout needed - waiting for next microtask is sufficient
     52 +     33 +  if (globalRenderMarkdown) {
     53 +     34 +    console.log('üîÑ Re-rendering diagrams with new theme colors');
     54 +     35 +    globalRenderMarkdown();
     55 +     36 +  }
     56 + 38  37  });
     57 + 39  38  
     58 + 40  39  // Wait for all scripts to load
     59 +@@ -498,134 +497,120 @@ graph TD
     60 +498 497        // Parse markdown with all extensions
     61 +499 498        let html = marked.parse(markdownText);
     62 +500 499  
     63 +501     -      // Replace mermaid code blocks
     64 +    500 +      // Replace mermaid code blocks with placeholders
     65 +502 501        html = html.replace(
     66 +503 502          /<pre><code class="language-mermaid">([\s\S]*?)<\/code><\/pre>/g,
     67 +504 503          (match, code) => {
     68 +505     -          // Decode HTML entities before passing to Mermaid
     69 +506 504            const decodedCode = decodeHtmlEntities(code);
     70 +507 505            const id = 'mermaid-' + Math.random().toString(36).substr(2, 9);
     71 +508     -          setTimeout(() => {
     72 +509     -            try {
     73 +510     -              const element = document.getElementById(id);
     74 +511     -              if (element && typeof mermaid !== 'undefined') {
     75 +512     -                mermaid
     76 +513     -                  .render('mermaid-svg-' + id, decodedCode)
     77 +514     -                  .then(result => {
     78 +515     -                    element.innerHTML = result.svg;
     79 +516     -                  })
     80 +517     -                  .catch(err => {
     81 +518     -                    element.innerHTML =
     82 +519     -                      '<p style="color: red;">Mermaid diagram error: ' + err.message + '</p>';
     83 +520     -                  });
     84 +521     -              }
     85 +522     -            } catch (e) {
     86 +523     -              console.error('Mermaid render error:', e);
     87 +524     -            }
     88 +525     -          }, 100);
     89 +526     -          return `<div class="mermaid" id="${id}">${code}</div>`;
     90 +527     -        }
     91 +    506 +          // Return placeholder div
     92 +    507 +          return `<div class="mermaid" id="${id}" data-code="${encodeURIComponent(decodedCode)}">${code}</div>`;
     93 +528 508          }
     94 +529 509        );
     95 +530 510  
     96 +531     -    // Sanitize HTML using DOMPurify
     97 +532     -    // Allow SVG for Mermaid diagrams and math classes
     98 +533     -    const cleanHtml = DOMPurify.sanitize(html, {
     99 +534     -      ADD_TAGS: ['iframe'], // Allow iframes for PDF preview if needed
    100 +535     -      ADD_ATTR: ['allow', 'allowfullscreen', 'frameborder', 'scrolling', 'target'],
    101 +536     -      USE_PROFILES: { html: true, svg: true, mathml: true },
    102 +537     -    });
    103 +538     -
    104 +539     -    preview.innerHTML = cleanHtml;
    105 +540     -
    106 +541     -    // Apply Prism syntax highlighting using PrismService
    107 +542     -    prismService.highlightAll(preview);
    108 +543     -
    109 +544     -    // NOTE: KaTeX auto-render is DISABLED
    110 +545     -    // We handle all math via marked.js extensions ($...$ and $$...$$)
    111 +546     -    // KaTeX auto-render was causing issues with unsupported LaTeX environments
8587 112  547     -
8588     -548     -  // Initialize color inputs
8589     -549     -  function initColorInputs() {
8590     -550     -    document.querySelectorAll('.color-control input[type="color"]').forEach(input => {
8591     -551     -      const varName = input.dataset.var;
8592     -552     -      const textInput = document.getElementById(input.id + '-text');
8593     -553     -      const currentValue = getComputedStyle(document.documentElement)
8594     -554     -        .getPropertyValue(varName)
8595     -555     -        .trim();
    113 +548     -    // Save content using StorageManager
    114 +549     -    storageManager.set('markdownContent', markdownText);
    115 +550     -  } catch (error) {
    116 +551     -    console.error('Render error:', error);
    117 +552     -    preview.innerHTML =
    118 +553     -      '<p style="color: red;">Error rendering markdown: ' + error.message + '</p>';
    119 +554     -  }
    120 +555     -}
8596 121  556     -
8597     -557     -      input.value = currentValue;
8598     -558     -      textInput.value = currentValue;
8599     -559     -
8600     -560     -      input.addEventListener('input', e => {
8601     -561     -        const color = e.target.value;
8602     -562     -        document.documentElement.style.setProperty(varName, color);
8603     -563     -        textInput.value = color;
8604     -564     -      });
8605     -    531 +    // Sanitize HTML using DOMPurify
8606     -    532 +    // Allow SVG for Mermaid diagrams and math classes
8607     -    533 +    const cleanHtml = DOMPurify.sanitize(html, {
8608     -    534 +      ADD_TAGS: ['iframe'], // Allow iframes for PDF preview if needed
8609     -    535 +      ADD_ATTR: ['allow', 'allowfullscreen', 'frameborder', 'scrolling', 'target'],
8610     -    536 +      USE_PROFILES: { html: true, svg: true, mathml: true },
8611     -565 537      });
8612     -    538 +
8613     -    539 +    preview.innerHTML = cleanHtml;
8614     -    540 +
8615     -    541 +    // Apply Prism syntax highlighting using PrismService
8616     -    542 +    prismService.highlightAll(preview);
8617     -    543 +
8618     -    544 +    // NOTE: KaTeX auto-render is DISABLED
8619     -    545 +    // We handle all math via marked.js extensions ($...$ and $$...$$)
8620     -    546 +    // KaTeX auto-render was causing issues with unsupported LaTeX environments
8621     -    547 +
8622     -    548 +    // Save content using StorageManager
8623     -    549 +    storageManager.set('markdownContent', markdownText);
8624     -    550 +  } catch (error) {
8625     -    551 +    console.error('Render error:', error);
8626     -    552 +    preview.innerHTML =
8627     -    553 +      '<p style="color: red;">Error rendering markdown: ' + error.message + '</p>';
8628     -    554 +  }
8629     -    555 +}
8630     -    556 +
8631     -    557 +// Change theme using ThemeManager
8632     -    558 +async function changeTheme(themeName) {
8633     -    559 +  await themeManager.loadTheme(themeName);
8634     -    560 +
8635     -    561 +  // Wait for theme to load, then reinitialize Mermaid and force re-render
8636     -    562 +  setTimeout(() => {
8637     -    563 +    // Clear existing Mermaid diagrams to force fresh render with new colors
8638     -    564 +    const mermaidElements = preview.querySelectorAll('.mermaid');
8639     -    565 +    mermaidElements.forEach(el => {
8640     -    566 +      // Reset to original code to force re-render
8641     -    567 +      el.innerHTML = el.dataset.originalCode || '';
8642     -    568 +    });
8643     -    569 +
8644     -    570 +    // Re-render markdown with new theme
8645     -    571 +    renderMarkdown();
8646     -    572 +  }, 100);
8647     -    573 +}
8648     -    574 +
8649     -    575 +// Initialize color inputs
8650     -    576 +function initColorInputs() {
8651     -    577 +  document.querySelectorAll('.color-control input[type="color"]').forEach(input => {
8652     -    578 +    const varName = input.dataset.var;
8653     -    579 +    const textInput = document.getElementById(input.id + '-text');
8654     -    580 +    const currentValue = getComputedStyle(document.documentElement)
8655     -    581 +      .getPropertyValue(varName)
8656     -    582 +      .trim();
8657     -    583 +
8658     -    584 +    input.value = currentValue;
8659     -    585 +    textInput.value = currentValue;
8660     -    586 +
8661     -    587 +    input.addEventListener('input', e => {
8662     -    588 +      const color = e.target.value;
8663     -    589 +      document.documentElement.style.setProperty(varName, color);
8664     -    590 +      textInput.value = color;
8665     -    591 +    });
8666     -    592 +  });
8667     -    593 +}
8668     -    594 +
8669     -    595 +// Export to HTML
8670     -    596 +function exportHTML() {
8671     -    597 +  const currentTheme = themeSelector.value;
8672     -    598 +  let themeCSS = '';
8673     -    599 +
8674     -    600 +  if (currentTheme === 'custom') {
8675     -    601 +    const customTheme = storageManager.getJSON('customTheme');
8676     -    602 +    if (customTheme) {
8677     -    603 +      const theme = customTheme;
8678     -    604 +      themeCSS = ':root {\n';
8679     -    605 +      Object.entries(theme).forEach(([property, value]) => {
8680     -    606 +        themeCSS += `    ${property}: ${value};\n`;
8681     -    607 +      });
8682     -    608 +      themeCSS += '}';
8683     -    609 +    }
8684     -    610 +  } else {
8685     -    611 +    // Fetch theme CSS
8686     -    612 +    fetch(`themes/${currentTheme}.css`)
8687     -    613 +      .then(response => response.text())
8688     -    614 +      .then(css => {
8689     -    615 +        themeCSS = css;
8690     -    616 +        generateHTML();
8691     -    617 +      })
8692     -    618 +      .catch(err => {
8693     -    619 +        console.error('Error loading theme:', err);
8694     -    620 +        generateHTML();
8695     -    621 +      });
8696     -    622 +    return;
8697     -566 623    }
8698     -567 624  
8699     -568     -  // Export to HTML
8700     -569     -  function exportHTML() {
8701     -570     -    const currentTheme = themeSelector.value;
8702     -571     -    let themeCSS = '';
8703     -    625 +  generateHTML();
8704     -572 626  
8705     -573     -    if (currentTheme === 'custom') {
8706     -574     -      const customTheme = storageManager.getJSON('customTheme');
8707     -575     -      if (customTheme) {
8708     -576     -        const theme = customTheme;
8709     -577     -        themeCSS = ':root {\n';
8710     -578     -        Object.entries(theme).forEach(([property, value]) => {
8711     -579     -          themeCSS += `    ${property}: ${value};\n`;
8712     -580     -        });
8713     -581     -        themeCSS += '}';
8714     -582     -      }
8715     -583     -    } else {
8716     -584     -      // Fetch theme CSS
8717     -585     -      fetch(`themes/${currentTheme}.css`)
8718     -586     -        .then(response => response.text())
8719     -587     -        .then(css => {
8720     -588     -          themeCSS = css;
8721     -589     -          generateHTML();
8722     -590     -        })
8723     -591     -        .catch(err => {
8724     -592     -          console.error('Error loading theme:', err);
8725     -593     -          generateHTML();
8726     -594     -        });
8727     -595     -      return;
8728     -596     -    }
8729     -597     -
8730     -598     -    generateHTML();
    122 +557     -// Change theme using ThemeManager
    123 +558     -async function changeTheme(themeName) {
    124 +559     -  await themeManager.loadTheme(themeName);
    125 +560     -
    126 +561     -  // Wait for theme to load, then reinitialize Mermaid and force re-render
    127 +562     -  setTimeout(() => {
    128 +563     -    // Clear existing Mermaid diagrams to force fresh render with new colors
    129 +564     -    const mermaidElements = preview.querySelectorAll('.mermaid');
    130 +565     -    mermaidElements.forEach(el => {
    131 +566     -      // Reset to original code to force re-render
    132 +567     -      el.innerHTML = el.dataset.originalCode || '';
    133 +568     -    });
    134 +569     -
    135 +570     -    // Re-render markdown with new theme
    136 +571     -    renderMarkdown();
    137 +572     -  }, 100);
    138 +573     -}
    139 +574     -
    140 +575     -// Initialize color inputs
    141 +576     -function initColorInputs() {
    142 +577     -  document.querySelectorAll('.color-control input[type="color"]').forEach(input => {
    143 +578     -    const varName = input.dataset.var;
    144 +579     -    const textInput = document.getElementById(input.id + '-text');
    145 +580     -    const currentValue = getComputedStyle(document.documentElement)
    146 +581     -      .getPropertyValue(varName)
    147 +582     -      .trim();
    148 +583     -
    149 +584     -    input.value = currentValue;
    150 +585     -    textInput.value = currentValue;
    151 +586     -
    152 +587     -    input.addEventListener('input', e => {
    153 +588     -      const color = e.target.value;
    154 +589     -      document.documentElement.style.setProperty(varName, color);
    155 +590     -      textInput.value = color;
    156 +591     -    });
    157 +592     -  });
    158 +593     -}
    159 +594     -
    160 +595     -// Export to HTML
    161 +596     -function exportHTML() {
    162 +597     -  const currentTheme = themeSelector.value;
    163 +598     -  let themeCSS = '';
8731 164  599     -
8732     -600     -    function generateHTML() {
8733     -601     -      const html = `<!DOCTYPE html>
8734     -    627 +  function generateHTML() {
8735     -    628 +    const html = `<!DOCTYPE html>
8736     -602 629  <html>
8737     -603 630  <head>
8738     -604 631      <meta charset="UTF-8">
8739     -@@ -648,723 +675,724 @@ graph TD
8740     -648 675      </style>
8741     -649 676  </head>
8742     -650 677  <body>
8743     -651     -    ${preview.innerHTML}
8744     -    678 +    ${DOMPurify.sanitize(preview.innerHTML)}
8745     -652 679  </body>
8746     -653 680  </html>`;
8747     -654 681  
8748     -655     -      const blob = new Blob([html], { type: 'text/html' });
8749     -656     -      const url = URL.createObjectURL(blob);
8750     -657     -      const a = document.createElement('a');
8751     -658     -      a.href = url;
8752     -659     -      a.download = 'markdown-export.html';
8753     -660     -      a.click();
8754     -661     -      URL.revokeObjectURL(url);
8755     -662     -    }
8756     -    682 +    const blob = new Blob([html], { type: 'text/html' });
8757     -    683 +    const url = URL.createObjectURL(blob);
8758     -    684 +    const a = document.createElement('a');
8759     -    685 +    a.href = url;
8760     -    686 +    a.download = 'markdown-export.html';
8761     -    687 +    a.click();
8762     -    688 +    URL.revokeObjectURL(url);
8763     -663 689    }
8764     -    690 +}
8765     -664 691  
8766     -665     -  // Event Listeners
8767     -666     -  editor.addEventListener('input', renderMarkdown);
8768     -    692 +// Event Listeners
8769     -    693 +const debouncedRender = debounce(renderMarkdown, 300);
8770     -    694 +editor.addEventListener('input', debouncedRender);
8771     -667 695  
8772     -668     -  themeSelector.addEventListener('change', async e => {
8773     -669     -    await changeTheme(e.target.value);
8774     -670     -  });
8775     -    696 +themeSelector.addEventListener('change', async e => {
8776     -    697 +  await changeTheme(e.target.value);
8777     -    698 +});
8778     -671 699  
8779     -672     -  customizeBtn.addEventListener('click', () => {
8780     -673     -    modal.classList.add('active');
8781     -674     -    initColorInputs();
8782     -675     -  });
8783     -    700 +customizeBtn.addEventListener('click', () => {
8784     -    701 +  modal.classList.add('active');
8785     -    702 +  initColorInputs();
8786     -    703 +});
8787     -676 704  
8788     -677     -  closeModal.addEventListener('click', () => {
8789     -    705 +closeModal.addEventListener('click', () => {
8790     -    706 +  modal.classList.remove('active');
8791     -    707 +});
8792     -    708 +
8793     -    709 +modal.addEventListener('click', e => {
8794     -    710 +  if (e.target === modal) {
8795     -678 711      modal.classList.remove('active');
8796     -    712 +  }
8797     -    713 +});
8798     -    714 +
8799     -    715 +resetBtn.addEventListener('click', async () => {
8800     -    716 +  const currentTheme = themeSelector.value === 'custom' ? 'default-light' : themeSelector.value;
8801     -    717 +  await changeTheme(currentTheme);
8802     -    718 +  initColorInputs();
8803     -    719 +});
8804     -    720 +
8805     -    721 +saveThemeBtn.addEventListener('click', async () => {
8806     -    722 +  const customTheme = {};
8807     -    723 +  document.querySelectorAll('.color-control input[type="color"]').forEach(input => {
8808     -    724 +    const varName = input.dataset.var;
8809     -    725 +    customTheme[varName] = input.value;
8810     -679 726    });
8811     -680 727  
8812     -681     -  modal.addEventListener('click', e => {
8813     -682     -    if (e.target === modal) {
8814     -683     -      modal.classList.remove('active');
8815     -    728 +  // Save and load custom theme using ThemeManager
8816     -    729 +  themeManager.saveCustomTheme(customTheme);
8817     -    730 +  await themeManager.loadTheme('custom');
8818     -    731 +  themeSelector.value = 'custom';
8819     -    732 +
8820     -    733 +  alert('Custom theme saved and applied!');
8821     -    734 +  modal.classList.remove('active');
8822     -    735 +});
8823     -    736 +
8824     -    737 +// PDF Modal and Controls
8825     -    738 +const pdfModal = document.getElementById('pdf-modal');
8826     -    739 +const closePdfModal = document.getElementById('close-pdf-modal');
8827     -    740 +const pdfPreviewFrame = document.getElementById('pdf-preview-frame');
8828     -    741 +const pdfPageSize = document.getElementById('pdf-page-size');
8829     -    742 +const pdfOrientation = document.getElementById('pdf-orientation');
8830     -    743 +const pdfMarginTop = document.getElementById('pdf-margin-top');
8831     -    744 +const pdfMarginRight = document.getElementById('pdf-margin-right');
8832     -    745 +const pdfMarginBottom = document.getElementById('pdf-margin-bottom');
8833     -    746 +const pdfMarginLeft = document.getElementById('pdf-margin-left');
8834     -    747 +const pdfFontDecrease = document.getElementById('pdf-font-decrease');
8835     -    748 +const pdfFontIncrease = document.getElementById('pdf-font-increase');
8836     -    749 +const pdfFontSizeDisplay = document.getElementById('pdf-font-size-display');
8837     -    750 +const pdfPreviewBtn = document.getElementById('pdf-preview-btn');
8838     -    751 +const pdfDownloadBtn = document.getElementById('pdf-download-btn');
8839     -    752 +
8840     -    753 +let currentFontSize = 12;
8841     -    754 +
8842     -    755 +// Open PDF modal
8843     -    756 +function openPDFModal() {
8844     -    757 +  if (!pdfService.isReady()) {
8845     -    758 +    alert('PDF library is still loading. Please try again in a moment.');
8846     -    759 +    return;
8847     -    760 +  }
8848     -    761 +  pdfModal.classList.add('active');
8849     -    762 +  updatePDFPreview();
8850     -    763 +}
8851     -    764 +
8852     -    765 +// Close PDF modal
8853     -    766 +closePdfModal.addEventListener('click', () => {
8854     -    767 +  pdfModal.classList.remove('active');
8855     -    768 +  // Clean up iframe
8856     -    769 +  pdfPreviewFrame.src = '';
8857     -    770 +});
8858     -    771 +
8859     -    772 +pdfModal.addEventListener('click', e => {
8860     -    773 +  if (e.target === pdfModal) {
8861     -    774 +    pdfModal.classList.remove('active');
8862     -    775 +    pdfPreviewFrame.src = '';
8863     -    776 +  }
8864     -    777 +});
8865     -    778 +
8866     -    779 +// Get current PDF configuration from UI
8867     -    780 +function getPDFConfig() {
8868     -    781 +  return {
8869     -    782 +    pageSize: pdfPageSize.value,
8870     -    783 +    orientation: pdfOrientation.value,
8871     -    784 +    margins: [
8872     -    785 +      parseFloat(pdfMarginTop.value),
8873     -    786 +      parseFloat(pdfMarginRight.value),
8874     -    787 +      parseFloat(pdfMarginBottom.value),
8875     -    788 +      parseFloat(pdfMarginLeft.value),
8876     -    789 +    ],
8877     -    790 +    fontSize: currentFontSize,
8878     -    791 +  };
8879     -    792 +}
8880     -    793 +
8881     -    794 +// Update PDF preview
8882     -    795 +async function updatePDFPreview() {
8883     -    796 +  try {
8884     -    797 +    pdfPreviewBtn.textContent = '‚è≥ Generating Preview...';
8885     -    798 +    pdfPreviewBtn.disabled = true;
8886     -    799 +
8887     -    800 +    const config = getPDFConfig();
8888     -    801 +    const previewUrl = await pdfService.previewPDF(preview, config);
8889     -    802 +    pdfPreviewFrame.src = previewUrl;
8890     -    803 +
8891     -    804 +    pdfPreviewBtn.textContent = 'üëÅÔ∏è Update Preview';
8892     -    805 +    pdfPreviewBtn.disabled = false;
8893     -    806 +  } catch (error) {
8894     -    807 +    console.error('PDF preview error:', error);
8895     -    808 +    alert('Error generating preview: ' + error.message);
8896     -    809 +    pdfPreviewBtn.textContent = 'üëÅÔ∏è Update Preview';
8897     -    810 +    pdfPreviewBtn.disabled = false;
8898     -    811 +  }
8899     -    812 +}
8900     -    813 +
8901     -    814 +// Download PDF
8902     -    815 +async function downloadPDF() {
8903     -    816 +  try {
8904     -    817 +    pdfDownloadBtn.textContent = '‚è≥ Downloading...';
8905     -    818 +    pdfDownloadBtn.disabled = true;
8906     -    819 +
8907     -    820 +    const success = pdfService.downloadPDF();
8908     -    821 +    if (success) {
8909     -    822 +      setTimeout(() => {
8910     -    823 +        pdfModal.classList.remove('active');
8911     -    824 +        pdfPreviewFrame.src = '';
8912     -    825 +      }, 500);
8913     -684 826      }
8914     -685     -  });
8915     -686 827  
8916     -687     -  resetBtn.addEventListener('click', async () => {
8917     -688     -    const currentTheme = themeSelector.value === 'custom' ? 'default-light' : themeSelector.value;
8918     -689     -    await changeTheme(currentTheme);
8919     -690     -    initColorInputs();
8920     -691     -  });
8921     -    828 +    pdfDownloadBtn.textContent = 'üíæ Download PDF';
8922     -    829 +    pdfDownloadBtn.disabled = false;
8923     -    830 +  } catch (error) {
8924     -    831 +    console.error('PDF download error:', error);
8925     -    832 +    alert('Error downloading PDF: ' + error.message);
8926     -    833 +    pdfDownloadBtn.textContent = 'üíæ Download PDF';
8927     -    834 +    pdfDownloadBtn.disabled = false;
8928     -    835 +  }
8929     -    836 +}
8930     -692 837  
8931     -693     -  saveThemeBtn.addEventListener('click', async () => {
8932     -694     -    const customTheme = {};
8933     -695     -    document.querySelectorAll('.color-control input[type="color"]').forEach(input => {
8934     -696     -      const varName = input.dataset.var;
8935     -697     -      customTheme[varName] = input.value;
8936     -698     -    });
    165 +600     -  if (currentTheme === 'custom') {
    166 +601     -    const customTheme = storageManager.getJSON('customTheme');
    167 +602     -    if (customTheme) {
    168 +603     -      const theme = customTheme;
    169 +604     -      themeCSS = ':root {\n';
    170 +605     -      Object.entries(theme).forEach(([property, value]) => {
    171 +606     -        themeCSS += `    ${property}: ${value};\n`;
    172 +    511 +      // Sanitize HTML using DOMPurify
    173 +    512 +      const cleanHtml = DOMPurify.sanitize(html, {
    174 +    513 +        ADD_TAGS: ['iframe'],
    175 +    514 +        ADD_ATTR: ['allow', 'allowfullscreen', 'frameborder', 'scrolling', 'target', 'data-code'], // Add data-code
    176 +    515 +        USE_PROFILES: { html: true, svg: true, mathml: true },
    177 +607 516        });
    178 +608     -      themeCSS += '}';
    179 +    517 +
    180 +    518 +      preview.innerHTML = cleanHtml;
    181 +    519 +
    182 +    520 +      // Render Mermaid diagrams synchronously after DOM update
    183 +    521 +      const mermaidElements = preview.querySelectorAll('.mermaid');
    184 +    522 +      mermaidElements.forEach(element => {
    185 +    523 +        const id = element.id;
    186 +    524 +        const code = decodeURIComponent(element.dataset.code);
    187 +    525 +
    188 +    526 +        if (typeof mermaid !== 'undefined') {
    189 +    527 +          mermaid
    190 +    528 +            .render('mermaid-svg-' + id, code)
    191 +    529 +            .then(result => {
    192 +    530 +              element.innerHTML = result.svg;
    193 +    531 +            })
    194 +    532 +            .catch(err => {
    195 +    533 +              element.innerHTML = `<p style="color: red;">Mermaid diagram error: ${err.message}</p>`;
    196 +    534 +            });
    197 +    535 +        }
    198 +    536 +      });
    199 +    537 +
    200 +    538 +      // Apply Prism syntax highlighting using PrismService
    201 +    539 +      prismService.highlightAll(preview);
    202 +    540 +
    203 +    541 +      // NOTE: KaTeX auto-render is DISABLED
    204 +    542 +      // We handle all math via marked.js extensions ($...$ and $$...$$)
    205 +    543 +      // KaTeX auto-render was causing issues with unsupported LaTeX environments
    206 +    544 +
    207 +    545 +      // Save content using StorageManager
    208 +    546 +      storageManager.set('markdownContent', markdownText);
    209 +    547 +    } catch (error) {
    210 +    548 +      console.error('Render error:', error);
    211 +    549 +      preview.innerHTML =
    212 +    550 +        '<p style="color: red;">Error rendering markdown: ' + error.message + '</p>';
    213 +609 551      }
    214 +610     -  } else {
    215 +611     -    // Fetch theme CSS
    216 +612     -    fetch(`themes/${currentTheme}.css`)
    217 +613     -      .then(response => response.text())
    218 +614     -      .then(css => {
    219 +615     -        themeCSS = css;
    220 +616     -        generateHTML();
    221 +617     -      })
    222 +618     -      .catch(err => {
    223 +619     -        console.error('Error loading theme:', err);
    224 +620     -        generateHTML();
    225 +621     -      });
    226 +622     -    return;
    227 +623 552    }
    228 +624 553  
    229 +625     -  generateHTML();
    230 +    554 +  // Change theme using ThemeManager
    231 +    555 +  async function changeTheme(themeName) {
    232 +    556 +    await themeManager.loadTheme(themeName);
    233 +    557 +    // ThemeManager listener (above) will handle the re-render automatically
    234 +    558 +  }
    235 +626 559  
    236 +627     -  function generateHTML() {
    237 +628     -    const html = `<!DOCTYPE html>
    238 +    560 +  // Initialize color inputs
    239 +    561 +  function initColorInputs() {
    240 +    562 +    document.querySelectorAll('.color-control input[type="color"]').forEach(input => {
    241 +    563 +      const varName = input.dataset.var;
    242 +    564 +      const textInput = document.getElementById(input.id + '-text');
    243 +    565 +      const currentValue = getComputedStyle(document.documentElement)
    244 +    566 +        .getPropertyValue(varName)
    245 +    567 +        .trim();
    246 +    568 +
    247 +    569 +      input.value = currentValue;
    248 +    570 +      textInput.value = currentValue;
    249 +    571 +
    250 +    572 +      input.addEventListener('input', e => {
    251 +    573 +        const color = e.target.value;
    252 +    574 +        document.documentElement.style.setProperty(varName, color);
    253 +    575 +        textInput.value = color;
    254 +    576 +      });
    255 +    577 +    });
    256 +    578 +  }
    257 +    579 +
    258 +    580 +  // Export to HTML
    259 +    581 +  function exportHTML() {
    260 +    582 +    const currentTheme = themeSelector.value;
    261 +    583 +    let themeCSS = '';
    262 +    584 +
    263 +    585 +    if (currentTheme === 'custom') {
    264 +    586 +      const customTheme = storageManager.getJSON('customTheme');
    265 +    587 +      if (customTheme) {
    266 +    588 +        const theme = customTheme;
    267 +    589 +        themeCSS = ':root {\n';
    268 +    590 +        Object.entries(theme).forEach(([property, value]) => {
    269 +    591 +          themeCSS += `    ${property}: ${value};\n`;
    270 +    592 +        });
    271 +    593 +        themeCSS += '}';
    272 +    594 +      }
    273 +    595 +    } else {
    274 +    596 +      // Fetch theme CSS
    275 +    597 +      fetch(`themes/${currentTheme}.css`)
    276 +    598 +        .then(response => response.text())
    277 +    599 +        .then(css => {
    278 +    600 +          themeCSS = css;
    279 +    601 +          generateHTML();
    280 +    602 +        })
    281 +    603 +        .catch(err => {
    282 +    604 +          console.error('Error loading theme:', err);
    283 +    605 +          generateHTML();
    284 +    606 +        });
    285 +    607 +      return;
    286 +    608 +    }
    287 +    609 +
    288 +    610 +    generateHTML();
    289 +    611 +
    290 +    612 +    function generateHTML() {
    291 +    613 +      const html = `<!DOCTYPE html>
    292 +629 614  <html>
    293 +630 615  <head>
    294 +631 616      <meta charset="UTF-8">
    295 +@@ -679,720 +664,720 @@ function exportHTML() {
    296 +679 664  </body>
    297 +680 665  </html>`;
    298 +681 666  
    299 +682     -    const blob = new Blob([html], { type: 'text/html' });
    300 +683     -    const url = URL.createObjectURL(blob);
    301 +684     -    const a = document.createElement('a');
    302 +685     -    a.href = url;
    303 +686     -    a.download = 'markdown-export.html';
    304 +687     -    a.click();
    305 +688     -    URL.revokeObjectURL(url);
    306 +    667 +      const blob = new Blob([html], { type: 'text/html' });
    307 +    668 +      const url = URL.createObjectURL(blob);
    308 +    669 +      const a = document.createElement('a');
    309 +    670 +      a.href = url;
    310 +    671 +      a.download = 'markdown-export.html';
    311 +    672 +      a.click();
    312 +    673 +      URL.revokeObjectURL(url);
    313 +    674 +    }
    314 +689 675    }
    315 +690     -}
    316 +691 676  
    317 +692     -// Event Listeners
    318 +693     -const debouncedRender = debounce(renderMarkdown, 300);
    319 +694     -editor.addEventListener('input', debouncedRender);
    320 +    677 +  // Event Listeners
    321 +    678 +  const debouncedRender = debounce(renderMarkdown, 300);
    322 +    679 +  editor.addEventListener('input', debouncedRender);
    323 +695 680  
    324 +696     -themeSelector.addEventListener('change', async e => {
    325 +697     -  await changeTheme(e.target.value);
    326 +698     -});
8937 327  699     -
8938     -700     -    // Save and load custom theme using ThemeManager
8939     -701     -    themeManager.saveCustomTheme(customTheme);
8940     -702     -    await themeManager.loadTheme('custom');
8941     -703     -    themeSelector.value = 'custom';
    328 +700     -customizeBtn.addEventListener('click', () => {
    329 +701     -  modal.classList.add('active');
    330 +702     -  initColorInputs();
    331 +703     -});
8942 332  704     -
8943     -705     -    alert('Custom theme saved and applied!');
8944     -706     -    modal.classList.remove('active');
8945     -707     -  });
    333 +705     -closeModal.addEventListener('click', () => {
    334 +706     -  modal.classList.remove('active');
    335 +707     -});
8946 336  708     -
8947     -709     -  // PDF Modal and Controls
8948     -710     -  const pdfModal = document.getElementById('pdf-modal');
8949     -711     -  const closePdfModal = document.getElementById('close-pdf-modal');
8950     -712     -  const pdfPreviewFrame = document.getElementById('pdf-preview-frame');
8951     -713     -  const pdfPageSize = document.getElementById('pdf-page-size');
8952     -714     -  const pdfOrientation = document.getElementById('pdf-orientation');
8953     -715     -  const pdfMarginTop = document.getElementById('pdf-margin-top');
8954     -716     -  const pdfMarginRight = document.getElementById('pdf-margin-right');
8955     -717     -  const pdfMarginBottom = document.getElementById('pdf-margin-bottom');
8956     -718     -  const pdfMarginLeft = document.getElementById('pdf-margin-left');
8957     -719     -  const pdfFontDecrease = document.getElementById('pdf-font-decrease');
8958     -720     -  const pdfFontIncrease = document.getElementById('pdf-font-increase');
8959     -721     -  const pdfFontSizeDisplay = document.getElementById('pdf-font-size-display');
8960     -722     -  const pdfPreviewBtn = document.getElementById('pdf-preview-btn');
8961     -723     -  const pdfDownloadBtn = document.getElementById('pdf-download-btn');
8962     -724     -
8963     -725     -  let currentFontSize = 12;
8964     -726     -
8965     -727     -  // Open PDF modal
8966     -728     -  function openPDFModal() {
8967     -729     -    if (!pdfService.isReady()) {
8968     -730     -      alert('PDF library is still loading. Please try again in a moment.');
8969     -731     -      return;
8970     -732     -    }
8971     -733     -    pdfModal.classList.add('active');
8972     -    838 +// Font size controls with auto-update
8973     -    839 +pdfFontDecrease.addEventListener('click', () => {
8974     -    840 +  if (currentFontSize > 8) {
8975     -    841 +    currentFontSize -= 1;
8976     -    842 +    pdfFontSizeDisplay.textContent = `${currentFontSize}pt`;
8977     -734 843      updatePDFPreview();
8978     -735 844    }
8979     -    845 +});
8980     -736 846  
8981     -737     -  // Close PDF modal
8982     -738     -  closePdfModal.addEventListener('click', () => {
8983     -739     -    pdfModal.classList.remove('active');
8984     -740     -    // Clean up iframe
8985     -741     -    pdfPreviewFrame.src = '';
8986     -742     -  });
8987     -    847 +pdfFontIncrease.addEventListener('click', () => {
8988     -    848 +  if (currentFontSize < 24) {
8989     -    849 +    currentFontSize += 1;
8990     -    850 +    pdfFontSizeDisplay.textContent = `${currentFontSize}pt`;
8991     -    851 +    updatePDFPreview();
8992     -    852 +  }
8993     -    853 +});
8994     -743 854  
8995     -744     -  pdfModal.addEventListener('click', e => {
8996     -745     -    if (e.target === pdfModal) {
8997     -746     -      pdfModal.classList.remove('active');
8998     -747     -      pdfPreviewFrame.src = '';
8999     -748     -    }
9000     -749     -  });
9001     -    855 +// Auto-update preview when settings change
9002     -    856 +pdfPageSize.addEventListener('change', updatePDFPreview);
9003     -    857 +pdfOrientation.addEventListener('change', updatePDFPreview);
9004     -    858 +pdfMarginTop.addEventListener('input', updatePDFPreview);
9005     -    859 +pdfMarginRight.addEventListener('input', updatePDFPreview);
9006     -    860 +pdfMarginBottom.addEventListener('input', updatePDFPreview);
9007     -    861 +pdfMarginLeft.addEventListener('input', updatePDFPreview);
9008     -750 862  
9009     -751     -  // Get current PDF configuration from UI
9010     -752     -  function getPDFConfig() {
9011     -753     -    return {
9012     -754     -      pageSize: pdfPageSize.value,
9013     -755     -      orientation: pdfOrientation.value,
9014     -756     -      margins: [
9015     -757     -        parseFloat(pdfMarginTop.value),
9016     -758     -        parseFloat(pdfMarginRight.value),
9017     -759     -        parseFloat(pdfMarginBottom.value),
9018     -760     -        parseFloat(pdfMarginLeft.value),
9019     -761     -      ],
9020     -762     -      fontSize: currentFontSize,
9021     -763     -    };
9022     -    863 +// PDF Event Listeners
9023     -    864 +pdfPreviewBtn.addEventListener('click', updatePDFPreview);
9024     -    865 +pdfDownloadBtn.addEventListener('click', downloadPDF);
9025     -    866 +
9026     -    867 +// Event listeners for export buttons
9027     -    868 +exportHtmlBtn.addEventListener('click', exportHTML);
9028     -    869 +exportPdfBtn.addEventListener('click', () => {
9029     -    870 +  console.log('Export PDF button clicked');
9030     -    871 +  openPDFModal();
9031     -    872 +});
9032     -    873 +
9033     -    874 +// Debug: Verify elements are found
9034     -    875 +console.log('Export PDF Button:', exportPdfBtn);
9035     -    876 +console.log('PDF Modal:', pdfModal);
9036     -    877 +console.log('PDF Service Ready:', pdfService.isReady());
9037     -    878 +
9038     -    879 +// View mode switching
9039     -    880 +function setViewMode(mode) {
9040     -    881 +  // Remove active class from all buttons
9041     -    882 +  editorOnlyBtn.classList.remove('active');
9042     -    883 +  splitViewBtn.classList.remove('active');
9043     -    884 +  previewOnlyBtn.classList.remove('active');
9044     -    885 +
9045     -    886 +  // Apply view mode
9046     -    887 +  switch (mode) {
9047     -    888 +    case 'editor-only':
9048     -    889 +      editorOnlyBtn.classList.add('active');
9049     -    890 +      editorContainer.style.display = 'flex';
9050     -    891 +      previewContainer.style.display = 'none';
9051     -    892 +      break;
9052     -    893 +    case 'split-view':
9053     -    894 +      splitViewBtn.classList.add('active');
9054     -    895 +      editorContainer.style.display = 'flex';
9055     -    896 +      previewContainer.style.display = 'flex';
9056     -    897 +      break;
9057     -    898 +    case 'preview-only':
9058     -    899 +      previewOnlyBtn.classList.add('active');
9059     -    900 +      editorContainer.style.display = 'none';
9060     -    901 +      previewContainer.style.display = 'flex';
9061     -    902 +      break;
9062     -764 903    }
9063     -765 904  
9064     -766     -  // Update PDF preview
9065     -767     -  async function updatePDFPreview() {
9066     -768     -    try {
9067     -769     -      pdfPreviewBtn.textContent = '‚è≥ Generating Preview...';
9068     -770     -      pdfPreviewBtn.disabled = true;
9069     -    905 +  // Save view mode preference
9070     -    906 +  storageManager.set('viewMode', mode);
9071     -    907 +}
9072     -771 908  
9073     -772     -      const config = getPDFConfig();
9074     -773     -      const previewUrl = await pdfService.previewPDF(preview, config);
9075     -774     -      pdfPreviewFrame.src = previewUrl;
9076     -    909 +// ==================== SYNC SCROLL FUNCTIONALITY ====================
9077     -775 910  
9078     -776     -      pdfPreviewBtn.textContent = 'üëÅÔ∏è Update Preview';
9079     -777     -      pdfPreviewBtn.disabled = false;
9080     -778     -    } catch (error) {
9081     -779     -      console.error('PDF preview error:', error);
9082     -780     -      alert('Error generating preview: ' + error.message);
9083     -781     -      pdfPreviewBtn.textContent = 'üëÅÔ∏è Update Preview';
9084     -782     -      pdfPreviewBtn.disabled = false;
9085     -783     -    }
9086     -    911 +// Sync scroll state (using var to avoid formatter issues)
9087     -    912 +var syncScrollEnabled = storageManager.get('syncScrollEnabled') === 'true';
9088     -    913 +var syncScrolling = false;
9089     -    914 +
9090     -    915 +// Load saved state and update button
9091     -    916 +if (syncScrollEnabled) {
9092     -    917 +  syncScrollBtn.classList.add('active');
9093     -    918 +}
9094     -    919 +
9095     -    920 +// Show sync scroll button only in split view
9096     -    921 +function updateSyncScrollVisibility() {
9097     -    922 +  const currentView = storageManager.get('viewMode') || 'split-view';
9098     -    923 +  if (currentView === 'split-view') {
9099     -    924 +    syncScrollBtn.style.display = 'inline-block';
9100     -    925 +  } else {
9101     -    926 +    syncScrollBtn.style.display = 'none';
9102     -784 927    }
9103     -    928 +}
9104     -785 929  
9105     -786     -  // Download PDF
9106     -787     -  async function downloadPDF() {
9107     -788     -    try {
9108     -789     -      pdfDownloadBtn.textContent = '‚è≥ Downloading...';
9109     -790     -      pdfDownloadBtn.disabled = true;
9110     -    930 +// Sync scroll toggle
9111     -    931 +syncScrollBtn.addEventListener('click', () => {
9112     -    932 +  syncScrollEnabled = !syncScrollEnabled;
9113     -    933 +  storageManager.set('syncScrollEnabled', syncScrollEnabled.toString());
9114     -791 934  
9115     -792     -      const success = pdfService.downloadPDF();
9116     -793     -      if (success) {
9117     -794     -        setTimeout(() => {
9118     -795     -          pdfModal.classList.remove('active');
9119     -796     -          pdfPreviewFrame.src = '';
9120     -797     -        }, 500);
9121     -798     -      }
9122     -799     -
9123     -800     -      pdfDownloadBtn.textContent = 'üíæ Download PDF';
9124     -801     -      pdfDownloadBtn.disabled = false;
9125     -802     -    } catch (error) {
9126     -803     -      console.error('PDF download error:', error);
9127     -804     -      alert('Error downloading PDF: ' + error.message);
9128     -805     -      pdfDownloadBtn.textContent = 'üíæ Download PDF';
9129     -806     -      pdfDownloadBtn.disabled = false;
9130     -807     -    }
9131     -808     -  }
9132     -809     -
9133     -810     -  // Font size controls with auto-update
9134     -811     -  pdfFontDecrease.addEventListener('click', () => {
9135     -812     -    if (currentFontSize > 8) {
9136     -813     -      currentFontSize -= 1;
9137     -814     -      pdfFontSizeDisplay.textContent = `${currentFontSize}pt`;
9138     -815     -      updatePDFPreview();
9139     -816     -    }
9140     -817     -  });
9141     -818     -
9142     -819     -  pdfFontIncrease.addEventListener('click', () => {
9143     -820     -    if (currentFontSize < 24) {
9144     -821     -      currentFontSize += 1;
9145     -822     -      pdfFontSizeDisplay.textContent = `${currentFontSize}pt`;
9146     -823     -      updatePDFPreview();
9147     -824     -    }
9148     -825     -  });
9149     -826     -
9150     -827     -  // Auto-update preview when settings change
9151     -828     -  pdfPageSize.addEventListener('change', updatePDFPreview);
9152     -829     -  pdfOrientation.addEventListener('change', updatePDFPreview);
9153     -830     -  pdfMarginTop.addEventListener('input', updatePDFPreview);
9154     -831     -  pdfMarginRight.addEventListener('input', updatePDFPreview);
9155     -832     -  pdfMarginBottom.addEventListener('input', updatePDFPreview);
9156     -833     -  pdfMarginLeft.addEventListener('input', updatePDFPreview);
9157     -834     -
9158     -835     -  // PDF Event Listeners
9159     -836     -  pdfPreviewBtn.addEventListener('click', updatePDFPreview);
9160     -837     -  pdfDownloadBtn.addEventListener('click', downloadPDF);
9161     -838     -
9162     -839     -  // Event listeners for export buttons
9163     -840     -  exportHtmlBtn.addEventListener('click', exportHTML);
9164     -841     -  exportPdfBtn.addEventListener('click', () => {
9165     -842     -    console.log('Export PDF button clicked');
9166     -843     -    openPDFModal();
9167     -844     -  });
9168     -845     -
9169     -846     -  // Debug: Verify elements are found
9170     -847     -  console.log('Export PDF Button:', exportPdfBtn);
9171     -848     -  console.log('PDF Modal:', pdfModal);
9172     -849     -  console.log('PDF Service Ready:', pdfService.isReady());
9173     -850     -
9174     -851     -  // View mode switching
9175     -852     -  function setViewMode(mode) {
9176     -853     -    // Remove active class from all buttons
9177     -854     -    editorOnlyBtn.classList.remove('active');
9178     -855     -    splitViewBtn.classList.remove('active');
9179     -856     -    previewOnlyBtn.classList.remove('active');
9180     -857     -
9181     -858     -    // Apply view mode
9182     -859     -    switch (mode) {
9183     -860     -      case 'editor-only':
9184     -861     -        editorOnlyBtn.classList.add('active');
9185     -862     -        editorContainer.style.display = 'flex';
9186     -863     -        previewContainer.style.display = 'none';
9187     -864     -        break;
9188     -865     -      case 'split-view':
9189     -866     -        splitViewBtn.classList.add('active');
9190     -867     -        editorContainer.style.display = 'flex';
9191     -868     -        previewContainer.style.display = 'flex';
9192     -869     -        break;
9193     -870     -      case 'preview-only':
9194     -871     -        previewOnlyBtn.classList.add('active');
9195     -872     -        editorContainer.style.display = 'none';
9196     -873     -        previewContainer.style.display = 'flex';
9197     -874     -        break;
9198     -875     -    }
9199     -876     -
9200     -877     -    // Save view mode preference
9201     -878     -    storageManager.set('viewMode', mode);
9202     -879     -  }
9203     -880     -
9204     -881     -  // ==================== SYNC SCROLL FUNCTIONALITY ====================
9205     -882     -
9206     -883     -  // Sync scroll state (using var to avoid formatter issues)
9207     -884     -  var syncScrollEnabled = storageManager.get('syncScrollEnabled') === 'true';
9208     -885     -  var syncScrolling = false;
9209     -886     -
9210     -887     -  // Load saved state and update button
9211     -888 935    if (syncScrollEnabled) {
9212     -889 936      syncScrollBtn.classList.add('active');
9213     -890     -  }
9214     -891     -
9215     -892     -  // Show sync scroll button only in split view
9216     -893     -  function updateSyncScrollVisibility() {
9217     -894     -    const currentView = storageManager.get('viewMode') || 'split-view';
9218     -895     -    if (currentView === 'split-view') {
9219     -896     -      syncScrollBtn.style.display = 'inline-block';
9220     -897     -    } else {
9221     -898     -      syncScrollBtn.style.display = 'none';
9222     -899     -    }
9223     -900     -  }
9224     -901     -
9225     -902     -  // Sync scroll toggle
9226     -903     -  syncScrollBtn.addEventListener('click', () => {
9227     -904     -    syncScrollEnabled = !syncScrollEnabled;
9228     -905     -    storageManager.set('syncScrollEnabled', syncScrollEnabled.toString());
9229     -906     -
9230     -907     -    if (syncScrollEnabled) {
9231     -908     -      syncScrollBtn.classList.add('active');
9232     -909     -      console.log('‚úÖ Sync scroll enabled');
9233     -910     -    } else {
9234     -911     -      syncScrollBtn.classList.remove('active');
9235     -912     -      console.log('‚ùå Sync scroll disabled');
9236     -913     -    }
9237     -914     -  });
9238     -915     -
9239     -916     -  // Editor scroll handler with smooth sync
9240     -917     -  editor.addEventListener('scroll', () => {
9241     -918     -    if (!syncScrollEnabled || syncScrolling) return;
    337 +709     -modal.addEventListener('click', e => {
    338 +710     -  if (e.target === modal) {
    339 +711     -    modal.classList.remove('active');
    340 +712     -  }
    341 +713     -});
    342 +714     -
    343 +715     -resetBtn.addEventListener('click', async () => {
    344 +716     -  const currentTheme = themeSelector.value === 'custom' ? 'default-light' : themeSelector.value;
    345 +717     -  await changeTheme(currentTheme);
    346 +718     -  initColorInputs();
    347 +719     -});
    348 +720     -
    349 +721     -saveThemeBtn.addEventListener('click', async () => {
    350 +722     -  const customTheme = {};
    351 +723     -  document.querySelectorAll('.color-control input[type="color"]').forEach(input => {
    352 +724     -    const varName = input.dataset.var;
    353 +725     -    customTheme[varName] = input.value;
    354 +    681 +  themeSelector.addEventListener('change', async e => {
    355 +    682 +    await changeTheme(e.target.value);
    356 +726 683    });
    357 +727 684  
    358 +728     -  // Save and load custom theme using ThemeManager
    359 +729     -  themeManager.saveCustomTheme(customTheme);
    360 +730     -  await themeManager.loadTheme('custom');
    361 +731     -  themeSelector.value = 'custom';
    362 +    685 +  customizeBtn.addEventListener('click', () => {
    363 +    686 +    modal.classList.add('active');
    364 +    687 +    initColorInputs();
    365 +    688 +  });
    366 +732 689  
    367 +733     -  alert('Custom theme saved and applied!');
    368 +734     -  modal.classList.remove('active');
    369 +735     -});
    370 +    690 +  closeModal.addEventListener('click', () => {
    371 +    691 +    modal.classList.remove('active');
    372 +    692 +  });
    373 +736 693  
    374 +737     -// PDF Modal and Controls
    375 +738     -const pdfModal = document.getElementById('pdf-modal');
    376 +739     -const closePdfModal = document.getElementById('close-pdf-modal');
    377 +740     -const pdfPreviewFrame = document.getElementById('pdf-preview-frame');
    378 +741     -const pdfPageSize = document.getElementById('pdf-page-size');
    379 +742     -const pdfOrientation = document.getElementById('pdf-orientation');
    380 +743     -const pdfMarginTop = document.getElementById('pdf-margin-top');
    381 +744     -const pdfMarginRight = document.getElementById('pdf-margin-right');
    382 +745     -const pdfMarginBottom = document.getElementById('pdf-margin-bottom');
    383 +746     -const pdfMarginLeft = document.getElementById('pdf-margin-left');
    384 +747     -const pdfFontDecrease = document.getElementById('pdf-font-decrease');
    385 +748     -const pdfFontIncrease = document.getElementById('pdf-font-increase');
    386 +749     -const pdfFontSizeDisplay = document.getElementById('pdf-font-size-display');
    387 +750     -const pdfPreviewBtn = document.getElementById('pdf-preview-btn');
    388 +751     -const pdfDownloadBtn = document.getElementById('pdf-download-btn');
    389 +    694 +  modal.addEventListener('click', e => {
    390 +    695 +    if (e.target === modal) {
    391 +    696 +      modal.classList.remove('active');
    392 +    697 +    }
    393 +    698 +  });
    394 +752 699  
    395 +753     -let currentFontSize = 12;
    396 +    700 +  resetBtn.addEventListener('click', async () => {
    397 +    701 +    const currentTheme = themeSelector.value === 'custom' ? 'default-light' : themeSelector.value;
    398 +    702 +    await changeTheme(currentTheme);
    399 +    703 +    initColorInputs();
    400 +    704 +  });
    401 +754 705  
    402 +755     -// Open PDF modal
    403 +756     -function openPDFModal() {
    404 +757     -  if (!pdfService.isReady()) {
    405 +758     -    alert('PDF library is still loading. Please try again in a moment.');
    406 +759     -    return;
    407 +    706 +  saveThemeBtn.addEventListener('click', async () => {
    408 +    707 +    const customTheme = {};
    409 +    708 +    document.querySelectorAll('.color-control input[type="color"]').forEach(input => {
    410 +    709 +      const varName = input.dataset.var;
    411 +    710 +      customTheme[varName] = input.value;
    412 +    711 +    });
    413 +    712 +
    414 +    713 +    // Save and load custom theme using ThemeManager
    415 +    714 +    themeManager.saveCustomTheme(customTheme);
    416 +    715 +    await themeManager.loadTheme('custom');
    417 +    716 +    themeSelector.value = 'custom';
    418 +    717 +
    419 +    718 +    alert('Custom theme saved and applied!');
    420 +    719 +    modal.classList.remove('active');
    421 +    720 +  });
    422 +    721 +
    423 +    722 +  // PDF Modal and Controls
    424 +    723 +  const pdfModal = document.getElementById('pdf-modal');
    425 +    724 +  const closePdfModal = document.getElementById('close-pdf-modal');
    426 +    725 +  const pdfPreviewFrame = document.getElementById('pdf-preview-frame');
    427 +    726 +  const pdfPageSize = document.getElementById('pdf-page-size');
    428 +    727 +  const pdfOrientation = document.getElementById('pdf-orientation');
    429 +    728 +  const pdfMarginTop = document.getElementById('pdf-margin-top');
    430 +    729 +  const pdfMarginRight = document.getElementById('pdf-margin-right');
    431 +    730 +  const pdfMarginBottom = document.getElementById('pdf-margin-bottom');
    432 +    731 +  const pdfMarginLeft = document.getElementById('pdf-margin-left');
    433 +    732 +  const pdfFontDecrease = document.getElementById('pdf-font-decrease');
    434 +    733 +  const pdfFontIncrease = document.getElementById('pdf-font-increase');
    435 +    734 +  const pdfFontSizeDisplay = document.getElementById('pdf-font-size-display');
    436 +    735 +  const pdfPreviewBtn = document.getElementById('pdf-preview-btn');
    437 +    736 +  const pdfDownloadBtn = document.getElementById('pdf-download-btn');
    438 +    737 +
    439 +    738 +  let currentFontSize = 12;
    440 +    739 +
    441 +    740 +  // Open PDF modal
    442 +    741 +  function openPDFModal() {
    443 +    742 +    if (!pdfService.isReady()) {
    444 +    743 +      alert('PDF library is still loading. Please try again in a moment.');
    445 +    744 +      return;
    446 +    745 +    }
    447 +    746 +    pdfModal.classList.add('active');
    448 +    747 +    updatePDFPreview();
    449 +760 748    }
    450 +761     -  pdfModal.classList.add('active');
    451 +762     -  updatePDFPreview();
    452 +763     -}
    453 +764 749  
    454 +765     -// Close PDF modal
    455 +766     -closePdfModal.addEventListener('click', () => {
    456 +767     -  pdfModal.classList.remove('active');
    457 +768     -  // Clean up iframe
    458 +769     -  pdfPreviewFrame.src = '';
    459 +770     -});
    460 +771     -
    461 +772     -pdfModal.addEventListener('click', e => {
    462 +773     -  if (e.target === pdfModal) {
    463 +    750 +  // Close PDF modal
    464 +    751 +  closePdfModal.addEventListener('click', () => {
    465 +774 752      pdfModal.classList.remove('active');
    466 +    753 +    // Clean up iframe
    467 +775 754      pdfPreviewFrame.src = '';
    468 +    755 +  });
    469 +    756 +
    470 +    757 +  pdfModal.addEventListener('click', e => {
    471 +    758 +    if (e.target === pdfModal) {
    472 +    759 +      pdfModal.classList.remove('active');
    473 +    760 +      pdfPreviewFrame.src = '';
    474 +    761 +    }
    475 +    762 +  });
    476 +    763 +
    477 +    764 +  // Get current PDF configuration from UI
    478 +    765 +  function getPDFConfig() {
    479 +    766 +    return {
    480 +    767 +      pageSize: pdfPageSize.value,
    481 +    768 +      orientation: pdfOrientation.value,
    482 +    769 +      margins: [
    483 +    770 +        parseFloat(pdfMarginTop.value),
    484 +    771 +        parseFloat(pdfMarginRight.value),
    485 +    772 +        parseFloat(pdfMarginBottom.value),
    486 +    773 +        parseFloat(pdfMarginLeft.value),
    487 +    774 +      ],
    488 +    775 +      fontSize: currentFontSize,
    489 +    776 +    };
    490 +776 777    }
    491 +777     -});
    492 +778 778  
    493 +779     -// Get current PDF configuration from UI
    494 +780     -function getPDFConfig() {
    495 +781     -  return {
    496 +782     -    pageSize: pdfPageSize.value,
    497 +783     -    orientation: pdfOrientation.value,
    498 +784     -    margins: [
    499 +785     -      parseFloat(pdfMarginTop.value),
    500 +786     -      parseFloat(pdfMarginRight.value),
    501 +787     -      parseFloat(pdfMarginBottom.value),
    502 +788     -      parseFloat(pdfMarginLeft.value),
    503 +789     -    ],
    504 +790     -    fontSize: currentFontSize,
    505 +791     -  };
    506 +792     -}
    507 +    779 +  // Update PDF preview
    508 +    780 +  async function updatePDFPreview() {
    509 +    781 +    try {
    510 +    782 +      pdfPreviewBtn.textContent = '‚è≥ Generating Preview...';
    511 +    783 +      pdfPreviewBtn.disabled = true;
    512 +793 784  
    513 +794     -// Update PDF preview
    514 +795     -async function updatePDFPreview() {
    515 +796     -  try {
    516 +797     -    pdfPreviewBtn.textContent = '‚è≥ Generating Preview...';
    517 +798     -    pdfPreviewBtn.disabled = true;
    518 +    785 +      const config = getPDFConfig();
    519 +    786 +      const previewUrl = await pdfService.previewPDF(preview, config);
    520 +    787 +      pdfPreviewFrame.src = previewUrl;
    521 +799 788  
    522 +800     -    const config = getPDFConfig();
    523 +801     -    const previewUrl = await pdfService.previewPDF(preview, config);
    524 +802     -    pdfPreviewFrame.src = previewUrl;
    525 +803     -
    526 +804     -    pdfPreviewBtn.textContent = 'üëÅÔ∏è Update Preview';
    527 +805     -    pdfPreviewBtn.disabled = false;
    528 +806     -  } catch (error) {
    529 +807     -    console.error('PDF preview error:', error);
    530 +808     -    alert('Error generating preview: ' + error.message);
    531 +809     -    pdfPreviewBtn.textContent = 'üëÅÔ∏è Update Preview';
    532 +810     -    pdfPreviewBtn.disabled = false;
    533 +    789 +      pdfPreviewBtn.textContent = 'üëÅÔ∏è Update Preview';
    534 +    790 +      pdfPreviewBtn.disabled = false;
    535 +    791 +    } catch (error) {
    536 +    792 +      console.error('PDF preview error:', error);
    537 +    793 +      alert('Error generating preview: ' + error.message);
    538 +    794 +      pdfPreviewBtn.textContent = 'üëÅÔ∏è Update Preview';
    539 +    795 +      pdfPreviewBtn.disabled = false;
    540 +    796 +    }
    541 +811 797    }
    542 +812     -}
    543 +813 798  
    544 +814     -// Download PDF
    545 +815     -async function downloadPDF() {
    546 +816     -  try {
    547 +817     -    pdfDownloadBtn.textContent = '‚è≥ Downloading...';
    548 +818     -    pdfDownloadBtn.disabled = true;
    549 +    799 +  // Download PDF
    550 +    800 +  async function downloadPDF() {
    551 +    801 +    try {
    552 +    802 +      pdfDownloadBtn.textContent = '‚è≥ Downloading...';
    553 +    803 +      pdfDownloadBtn.disabled = true;
    554 +819 804  
    555 +820     -    const success = pdfService.downloadPDF();
    556 +821     -    if (success) {
    557 +822     -      setTimeout(() => {
    558 +823     -        pdfModal.classList.remove('active');
    559 +824     -        pdfPreviewFrame.src = '';
    560 +825     -      }, 500);
    561 +    805 +      const success = pdfService.downloadPDF();
    562 +    806 +      if (success) {
    563 +    807 +        setTimeout(() => {
    564 +    808 +          pdfModal.classList.remove('active');
    565 +    809 +          pdfPreviewFrame.src = '';
    566 +    810 +        }, 500);
    567 +    811 +      }
    568 +    812 +
    569 +    813 +      pdfDownloadBtn.textContent = 'üíæ Download PDF';
    570 +    814 +      pdfDownloadBtn.disabled = false;
    571 +    815 +    } catch (error) {
    572 +    816 +      console.error('PDF download error:', error);
    573 +    817 +      alert('Error downloading PDF: ' + error.message);
    574 +    818 +      pdfDownloadBtn.textContent = 'üíæ Download PDF';
    575 +    819 +      pdfDownloadBtn.disabled = false;
    576 +    820 +    }
    577 +    821 +  }
    578 +    822 +
    579 +    823 +  // Font size controls with auto-update
    580 +    824 +  pdfFontDecrease.addEventListener('click', () => {
    581 +    825 +    if (currentFontSize > 8) {
    582 +    826 +      currentFontSize -= 1;
    583 +    827 +      pdfFontSizeDisplay.textContent = `${currentFontSize}pt`;
    584 +    828 +      updatePDFPreview();
    585 +    829 +    }
    586 +    830 +  });
    587 +    831 +
    588 +    832 +  pdfFontIncrease.addEventListener('click', () => {
    589 +    833 +    if (currentFontSize < 24) {
    590 +    834 +      currentFontSize += 1;
    591 +    835 +      pdfFontSizeDisplay.textContent = `${currentFontSize}pt`;
    592 +    836 +      updatePDFPreview();
    593 +    837 +    }
    594 +    838 +  });
    595 +    839 +
    596 +    840 +  // Auto-update preview when settings change
    597 +    841 +  pdfPageSize.addEventListener('change', updatePDFPreview);
    598 +    842 +  pdfOrientation.addEventListener('change', updatePDFPreview);
    599 +    843 +  pdfMarginTop.addEventListener('input', updatePDFPreview);
    600 +    844 +  pdfMarginRight.addEventListener('input', updatePDFPreview);
    601 +    845 +  pdfMarginBottom.addEventListener('input', updatePDFPreview);
    602 +    846 +  pdfMarginLeft.addEventListener('input', updatePDFPreview);
    603 +    847 +
    604 +    848 +  // PDF Event Listeners
    605 +    849 +  pdfPreviewBtn.addEventListener('click', updatePDFPreview);
    606 +    850 +  pdfDownloadBtn.addEventListener('click', downloadPDF);
    607 +    851 +
    608 +    852 +  // Event listeners for export buttons
    609 +    853 +  exportHtmlBtn.addEventListener('click', exportHTML);
    610 +    854 +  exportPdfBtn.addEventListener('click', () => {
    611 +    855 +    console.log('Export PDF button clicked');
    612 +    856 +    openPDFModal();
    613 +    857 +  });
    614 +    858 +
    615 +    859 +  // Debug: Verify elements are found
    616 +    860 +  console.log('Export PDF Button:', exportPdfBtn);
    617 +    861 +  console.log('PDF Modal:', pdfModal);
    618 +    862 +  console.log('PDF Service Ready:', pdfService.isReady());
    619 +    863 +
    620 +    864 +  // View mode switching
    621 +    865 +  function setViewMode(mode) {
    622 +    866 +    // Remove active class from all buttons
    623 +    867 +    editorOnlyBtn.classList.remove('active');
    624 +    868 +    splitViewBtn.classList.remove('active');
    625 +    869 +    previewOnlyBtn.classList.remove('active');
    626 +    870 +
    627 +    871 +    // Apply view mode
    628 +    872 +    switch (mode) {
    629 +    873 +      case 'editor-only':
    630 +    874 +        editorOnlyBtn.classList.add('active');
    631 +    875 +        editorContainer.style.display = 'flex';
    632 +    876 +        previewContainer.style.display = 'none';
    633 +    877 +        break;
    634 +    878 +      case 'split-view':
    635 +    879 +        splitViewBtn.classList.add('active');
    636 +    880 +        editorContainer.style.display = 'flex';
    637 +    881 +        previewContainer.style.display = 'flex';
    638 +    882 +        break;
    639 +    883 +      case 'preview-only':
    640 +    884 +        previewOnlyBtn.classList.add('active');
    641 +    885 +        editorContainer.style.display = 'none';
    642 +    886 +        previewContainer.style.display = 'flex';
    643 +    887 +        break;
    644 +826 888      }
    645 +827 889  
    646 +828     -    pdfDownloadBtn.textContent = 'üíæ Download PDF';
    647 +829     -    pdfDownloadBtn.disabled = false;
    648 +830     -  } catch (error) {
    649 +831     -    console.error('PDF download error:', error);
    650 +832     -    alert('Error downloading PDF: ' + error.message);
    651 +833     -    pdfDownloadBtn.textContent = 'üíæ Download PDF';
    652 +834     -    pdfDownloadBtn.disabled = false;
    653 +835     -  }
    654 +836     -}
    655 +837     -
    656 +838     -// Font size controls with auto-update
    657 +839     -pdfFontDecrease.addEventListener('click', () => {
    658 +840     -  if (currentFontSize > 8) {
    659 +841     -    currentFontSize -= 1;
    660 +842     -    pdfFontSizeDisplay.textContent = `${currentFontSize}pt`;
    661 +843     -    updatePDFPreview();
    662 +844     -  }
    663 +845     -});
    664 +846     -
    665 +847     -pdfFontIncrease.addEventListener('click', () => {
    666 +848     -  if (currentFontSize < 24) {
    667 +849     -    currentFontSize += 1;
    668 +850     -    pdfFontSizeDisplay.textContent = `${currentFontSize}pt`;
    669 +851     -    updatePDFPreview();
    670 +852     -  }
    671 +853     -});
    672 +854     -
    673 +855     -// Auto-update preview when settings change
    674 +856     -pdfPageSize.addEventListener('change', updatePDFPreview);
    675 +857     -pdfOrientation.addEventListener('change', updatePDFPreview);
    676 +858     -pdfMarginTop.addEventListener('input', updatePDFPreview);
    677 +859     -pdfMarginRight.addEventListener('input', updatePDFPreview);
    678 +860     -pdfMarginBottom.addEventListener('input', updatePDFPreview);
    679 +861     -pdfMarginLeft.addEventListener('input', updatePDFPreview);
    680 +862     -
    681 +863     -// PDF Event Listeners
    682 +864     -pdfPreviewBtn.addEventListener('click', updatePDFPreview);
    683 +865     -pdfDownloadBtn.addEventListener('click', downloadPDF);
    684 +866     -
    685 +867     -// Event listeners for export buttons
    686 +868     -exportHtmlBtn.addEventListener('click', exportHTML);
    687 +869     -exportPdfBtn.addEventListener('click', () => {
    688 +870     -  console.log('Export PDF button clicked');
    689 +871     -  openPDFModal();
    690 +872     -});
    691 +873     -
    692 +874     -// Debug: Verify elements are found
    693 +875     -console.log('Export PDF Button:', exportPdfBtn);
    694 +876     -console.log('PDF Modal:', pdfModal);
    695 +877     -console.log('PDF Service Ready:', pdfService.isReady());
    696 +878     -
    697 +879     -// View mode switching
    698 +880     -function setViewMode(mode) {
    699 +881     -  // Remove active class from all buttons
    700 +882     -  editorOnlyBtn.classList.remove('active');
    701 +883     -  splitViewBtn.classList.remove('active');
    702 +884     -  previewOnlyBtn.classList.remove('active');
    703 +885     -
    704 +886     -  // Apply view mode
    705 +887     -  switch (mode) {
    706 +888     -    case 'editor-only':
    707 +889     -      editorOnlyBtn.classList.add('active');
    708 +890     -      editorContainer.style.display = 'flex';
    709 +891     -      previewContainer.style.display = 'none';
    710 +892     -      break;
    711 +893     -    case 'split-view':
    712 +894     -      splitViewBtn.classList.add('active');
    713 +895     -      editorContainer.style.display = 'flex';
    714 +896     -      previewContainer.style.display = 'flex';
    715 +897     -      break;
    716 +898     -    case 'preview-only':
    717 +899     -      previewOnlyBtn.classList.add('active');
    718 +900     -      editorContainer.style.display = 'none';
    719 +901     -      previewContainer.style.display = 'flex';
    720 +902     -      break;
    721 +    890 +    // Save view mode preference
    722 +    891 +    storageManager.set('viewMode', mode);
    723 +903 892    }
    724 +904 893  
    725 +905     -  // Save view mode preference
    726 +906     -  storageManager.set('viewMode', mode);
    727 +907     -}
    728 +    894 +  // ==================== SYNC SCROLL FUNCTIONALITY ====================
    729 +908 895  
    730 +909     -// ==================== SYNC SCROLL FUNCTIONALITY ====================
    731 +910     -
    732 +911     -// Sync scroll state (using var to avoid formatter issues)
    733 +912     -var syncScrollEnabled = storageManager.get('syncScrollEnabled') === 'true';
    734 +913     -var syncScrolling = false;
    735 +914     -
    736 +915     -// Load saved state and update button
    737 +916     -if (syncScrollEnabled) {
    738 +917     -  syncScrollBtn.classList.add('active');
    739 +918     -}
9242 740  919     -
9243     -920     -    syncScrolling = true;
9244     -921     -
9245     -922     -    requestAnimationFrame(() => {
9246     -923     -      const editorHeight = editor.scrollHeight - editor.clientHeight;
9247     -924     -      const previewHeight = previewContainer.scrollHeight - previewContainer.clientHeight;
9248     -925     -
9249     -926     -      // Handle edge cases for perfect alignment
9250     -927     -      if (editor.scrollTop <= 0) {
9251     -928     -        // At top
9252     -929     -        previewContainer.scrollTop = 0;
9253     -930     -      } else if (editor.scrollTop >= editorHeight) {
9254     -931     -        // At bottom
9255     -932     -        previewContainer.scrollTop = previewHeight;
9256     -933     -      } else {
9257     -934     -        // Middle - proportional scroll
9258     -935     -        const scrollPercent = editor.scrollTop / editorHeight;
9259     -936     -        previewContainer.scrollTop = scrollPercent * previewHeight;
9260     -937     -      }
9261     -938     -
9262     -939     -      setTimeout(() => {
9263     -940     -        syncScrolling = false;
9264     -941     -      }, 10); // Reduced from 50ms for more responsive feel
9265     -942     -    });
9266     -943     -  });
9267     -944     -
9268     -945     -  // Preview container scroll handler with smooth sync
9269     -946     -  previewContainer.addEventListener('scroll', () => {
9270     -947     -    if (!syncScrollEnabled || syncScrolling) return;
9271     -948     -
9272     -949     -    syncScrolling = true;
9273     -950     -
9274     -951     -    requestAnimationFrame(() => {
9275     -952     -      const editorHeight = editor.scrollHeight - editor.clientHeight;
9276     -953     -      const previewHeight = previewContainer.scrollHeight - previewContainer.clientHeight;
9277     -954     -
9278     -955     -      // Handle edge cases for perfect alignment
9279     -956     -      if (previewContainer.scrollTop <= 0) {
9280     -957     -        // At top
9281     -958     -        editor.scrollTop = 0;
9282     -959     -      } else if (previewContainer.scrollTop >= previewHeight) {
9283     -960     -        // At bottom
9284     -961     -        editor.scrollTop = editorHeight;
9285     -962     -      } else {
9286     -963     -        // Middle - proportional scroll
9287     -964     -        const scrollPercent = previewContainer.scrollTop / previewHeight;
9288     -965     -        editor.scrollTop = scrollPercent * editorHeight;
9289     -966     -      }
9290     -967     -
9291     -968     -      setTimeout(() => {
9292     -969     -        syncScrolling = false;
9293     -970     -      }, 10); // Reduced from 50ms for more responsive feel
9294     -971     -    });
9295     -972     -  });
9296     -973     -
9297     -974     -  // View mode button event listeners with sync button update
9298     -975     -  editorOnlyBtn.addEventListener('click', () => {
9299     -976     -    setViewMode('editor-only');
9300     -977     -    updateSyncScrollVisibility();
9301     -978     -  });
9302     -979     -  splitViewBtn.addEventListener('click', () => {
9303     -980     -    setViewMode('split-view');
9304     -981     -    updateSyncScrollVisibility();
9305     -982     -  });
9306     -983     -  previewOnlyBtn.addEventListener('click', () => {
9307     -984     -    setViewMode('preview-only');
9308     -985     -    updateSyncScrollVisibility();
9309     -986     -  });
9310     -987     -
9311     -988     -  // Initialize visibility
9312     -989     -  updateSyncScrollVisibility();
9313     -990     -
9314     -991     -  // Load saved theme FIRST, then initialize Mermaid with correct colors
9315     -992     -  const savedTheme = storageManager.get('selectedTheme');
9316     -993     -  if (savedTheme) {
9317     -994     -    // Load theme first, then sync dropdown and reinit Mermaid
9318     -995     -    themeManager
9319     -996     -      .loadTheme(savedTheme)
9320     -997     -      .then(() => {
9321     -998     -        // Theme loaded successfully - sync dropdown
9322     -999     -        themeSelector.value = savedTheme;
9323     -1000     -        console.log(`‚úÖ Theme restored: ${savedTheme}`);
9324     -1001     -
9325     -1002     -        // NOW initialize Mermaid with correct theme colors
9326     -1003     -        mermaidService.initialize();
9327     -1004     -
9328     -1005     -        // Re-render to apply theme
9329     -1006     -        renderMarkdown();
9330     -1007     -      })
9331     -1008     -      .catch(err => {
9332     -1009     -        console.error('Failed to load saved theme:', err);
9333     -1010     -        // Fallback to default-light on error
9334     -1011     -        themeManager.loadTheme('default-light').then(() => {
9335     -1012     -          themeSelector.value = 'default-light';
9336     -1013     -          mermaidService.initialize();
9337     -1014     -          renderMarkdown();
9338     -1015     -        });
9339     -1016     -      });
9340     -    937 +    console.log('‚úÖ Sync scroll enabled');
9341     -1017 938    } else {
9342     -1018     -    // No saved theme - initialize with default-light
9343     -1019     -    mermaidService.initialize();
9344     -1020     -    renderMarkdown();
9345     -    939 +    syncScrollBtn.classList.remove('active');
9346     -    940 +    console.log('‚ùå Sync scroll disabled');
9347     -1021 941    }
9348     -    942 +});
9349     -1022 943  
9350     -1023     -  // Zoom functionality
9351     -1024     -  function setZoom(zoomLevel) {
9352     -1025     -    // Constrain zoom level between 50% and 200%
9353     -1026     -    currentZoom = Math.max(50, Math.min(200, zoomLevel));
9354     -    944 +// Editor scroll handler with smooth sync
9355     -    945 +editor.addEventListener('scroll', () => {
9356     -    946 +  if (!syncScrollEnabled || syncScrolling) return;
9357     -1027 947  
9358     -1028     -    // Apply zoom using CSS transform with proper container sizing
9359     -1029     -    preview.style.transform = `scale(${currentZoom / 100})`;
9360     -1030     -    preview.style.transformOrigin = 'top left';
9361     -1031     -    preview.style.width = `${10000 / currentZoom}%`;
9362     -1032     -    preview.style.height = `${10000 / currentZoom}%`;
9363     -    948 +  syncScrolling = true;
9364     -1033 949  
9365     -1034     -    // Ensure scrollbar remains visible and functional
9366     -1035     -    const previewContainer = preview.parentElement;
9367     -1036     -    if (previewContainer) {
9368     -1037     -      previewContainer.style.overflow = 'auto';
9369     -    950 +  requestAnimationFrame(() => {
9370     -    951 +    const editorHeight = editor.scrollHeight - editor.clientHeight;
9371     -    952 +    const previewHeight = previewContainer.scrollHeight - previewContainer.clientHeight;
9372     -    953 +
9373     -    954 +    // Handle edge cases for perfect alignment
9374     -    955 +    if (editor.scrollTop <= 0) {
9375     -    956 +      // At top
9376     -    957 +      previewContainer.scrollTop = 0;
9377     -    958 +    } else if (editor.scrollTop >= editorHeight) {
9378     -    959 +      // At bottom
9379     -    960 +      previewContainer.scrollTop = previewHeight;
9380     -    961 +    } else {
9381     -    962 +      // Middle - proportional scroll
9382     -    963 +      const scrollPercent = editor.scrollTop / editorHeight;
9383     -    964 +      previewContainer.scrollTop = scrollPercent * previewHeight;
9384     -1038 965      }
9385     -1039 966  
9386     -1040     -    // Update display
9387     -1041     -    zoomLevelDisplay.textContent = `${currentZoom}%`;
9388     -1042     -
9389     -1043     -    // Save to localStorage
9390     -1044     -    storageManager.set('previewZoom', currentZoom.toString());
9391     -1045     -  }
9392     -1046     -
9393     -1047     -  function zoomIn() {
9394     -1048     -    setZoom(currentZoom + 10);
9395     -1049     -  }
9396     -1050     -
9397     -1051     -  function zoomOut() {
9398     -1052     -    setZoom(currentZoom - 10);
9399     -1053     -  }
9400     -1054     -
9401     -1055     -  function resetZoom() {
9402     -1056     -    setZoom(100);
9403     -1057     -  }
9404     -1058     -
9405     -1059     -  // Zoom event listeners
9406     -1060     -  zoomInBtn.addEventListener('click', zoomIn);
9407     -1061     -  zoomOutBtn.addEventListener('click', zoomOut);
9408     -1062     -  zoomResetBtn.addEventListener('click', resetZoom);
9409     -1063     -
9410     -1064     -  // Keyboard shortcuts for zoom (Ctrl/Cmd + Plus/Minus/0)
9411     -1065     -  preview.addEventListener('wheel', e => {
9412     -1066     -    if (e.ctrlKey || e.metaKey) {
9413     -1067     -      e.preventDefault();
9414     -1068     -      if (e.deltaY < 0) {
9415     -1069     -        zoomIn();
9416     -1070     -      } else {
9417     -1071     -        zoomOut();
9418     -1072     -      }
9419     -1073     -    }
9420     -    967 +    setTimeout(() => {
9421     -    968 +      syncScrolling = false;
9422     -    969 +    }, 10); // Reduced from 50ms for more responsive feel
9423     -1074 970    });
9424     -    971 +});
9425     -1075 972  
9426     -1076     -  document.addEventListener('keydown', e => {
9427     -1077     -    if ((e.ctrlKey || e.metaKey) && e.target.tagName !== 'TEXTAREA') {
9428     -1078     -      if (e.key === '=' || e.key === '+') {
9429     -1079     -        e.preventDefault();
9430     -1080     -        zoomIn();
9431     -1081     -      } else if (e.key === '-') {
9432     -1082     -        e.preventDefault();
9433     -1083     -        zoomOut();
9434     -1084     -      } else if (e.key === '0') {
9435     -1085     -        e.preventDefault();
9436     -1086     -        resetZoom();
9437     -1087     -      }
9438     -    973 +// Preview container scroll handler with smooth sync
9439     -    974 +previewContainer.addEventListener('scroll', () => {
9440     -    975 +  if (!syncScrollEnabled || syncScrolling) return;
9441     -    976 +
9442     -    977 +  syncScrolling = true;
9443     -    978 +
9444     -    979 +  requestAnimationFrame(() => {
9445     -    980 +    const editorHeight = editor.scrollHeight - editor.clientHeight;
9446     -    981 +    const previewHeight = previewContainer.scrollHeight - previewContainer.clientHeight;
9447     -    982 +
9448     -    983 +    // Handle edge cases for perfect alignment
9449     -    984 +    if (previewContainer.scrollTop <= 0) {
9450     -    985 +      // At top
9451     -    986 +      editor.scrollTop = 0;
9452     -    987 +    } else if (previewContainer.scrollTop >= previewHeight) {
9453     -    988 +      // At bottom
9454     -    989 +      editor.scrollTop = editorHeight;
9455     -    990 +    } else {
9456     -    991 +      // Middle - proportional scroll
9457     -    992 +      const scrollPercent = previewContainer.scrollTop / previewHeight;
9458     -    993 +      editor.scrollTop = scrollPercent * editorHeight;
9459     -1088 994      }
9460     -    995 +
9461     -    996 +    setTimeout(() => {
9462     -    997 +      syncScrolling = false;
9463     -    998 +    }, 10); // Reduced from 50ms for more responsive feel
9464     -1089 999    });
9465     -    1000 +});
9466     -1090 1001  
9467     -1091     -  // Load saved zoom level
9468     -1092     -  const savedZoom = storageManager.get('previewZoom');
9469     -1093     -  if (savedZoom) {
9470     -1094     -    currentZoom = parseInt(savedZoom, 10);
9471     -1095     -    setZoom(currentZoom);
9472     -    1002 +// View mode button event listeners with sync button update
9473     -    1003 +editorOnlyBtn.addEventListener('click', () => {
9474     -    1004 +  setViewMode('editor-only');
9475     -    1005 +  updateSyncScrollVisibility();
9476     -    1006 +});
9477     -    1007 +splitViewBtn.addEventListener('click', () => {
9478     -    1008 +  setViewMode('split-view');
9479     -    1009 +  updateSyncScrollVisibility();
9480     -    1010 +});
9481     -    1011 +previewOnlyBtn.addEventListener('click', () => {
9482     -    1012 +  setViewMode('preview-only');
9483     -    1013 +  updateSyncScrollVisibility();
9484     -    1014 +});
9485     -    1015 +
9486     -    1016 +// Initialize visibility
9487     -    1017 +updateSyncScrollVisibility();
9488     -    1018 +
9489     -    1019 +// Load saved theme FIRST, then initialize Mermaid with correct colors
9490     -    1020 +const savedTheme = storageManager.get('selectedTheme');
9491     -    1021 +if (savedTheme) {
9492     -    1022 +  // Load theme first, then sync dropdown and reinit Mermaid
9493     -    1023 +  themeManager
9494     -    1024 +    .loadTheme(savedTheme)
9495     -    1025 +    .then(() => {
9496     -    1026 +      // Theme loaded successfully - sync dropdown
9497     -    1027 +      themeSelector.value = savedTheme;
9498     -    1028 +      console.log(`‚úÖ Theme restored: ${savedTheme}`);
9499     -    1029 +
9500     -    1030 +      // NOW initialize Mermaid with correct theme colors
9501     -    1031 +      mermaidService.initialize();
9502     -    1032 +
9503     -    1033 +      // Re-render to apply theme
9504     -    1034 +      renderMarkdown();
9505     -    1035 +    })
9506     -    1036 +    .catch(err => {
9507     -    1037 +      console.error('Failed to load saved theme:', err);
9508     -    1038 +      // Fallback to default-light on error
9509     -    1039 +      themeManager.loadTheme('default-light').then(() => {
9510     -    1040 +        themeSelector.value = 'default-light';
9511     -    1041 +        mermaidService.initialize();
9512     -    1042 +        renderMarkdown();
9513     -    1043 +      });
9514     -    1044 +    });
9515     -    1045 +} else {
9516     -    1046 +  // No saved theme - initialize with default-light
9517     -    1047 +  mermaidService.initialize();
9518     -    1048 +  renderMarkdown();
9519     -    1049 +}
9520     -    1050 +
9521     -    1051 +// Zoom functionality
9522     -    1052 +function setZoom(zoomLevel) {
9523     -    1053 +  // Constrain zoom level between 50% and 200%
9524     -    1054 +  currentZoom = Math.max(50, Math.min(200, zoomLevel));
9525     -    1055 +
9526     -    1056 +  // Apply zoom using CSS transform with proper container sizing
9527     -    1057 +  preview.style.transform = `scale(${currentZoom / 100})`;
9528     -    1058 +  preview.style.transformOrigin = 'top left';
9529     -    1059 +  preview.style.width = `${10000 / currentZoom}%`;
9530     -    1060 +  preview.style.height = `${10000 / currentZoom}%`;
9531     -    1061 +
9532     -    1062 +  // Ensure scrollbar remains visible and functional
9533     -    1063 +  const previewContainer = preview.parentElement;
9534     -    1064 +  if (previewContainer) {
9535     -    1065 +    previewContainer.style.overflow = 'auto';
9536     -1096 1066    }
9537     -1097 1067  
9538     -1098     -  // Load saved view mode
9539     -1099     -  const savedViewMode = storageManager.get('viewMode') || 'split-view';
9540     -1100     -  setViewMode(savedViewMode);
9541     -    1068 +  // Update display
9542     -    1069 +  zoomLevelDisplay.textContent = `${currentZoom}%`;
9543     -1101 1070  
9544     -1102     -  // ==================== FOLDER BROWSER FUNCTIONALITY ====================
9545     -    1071 +  // Save to localStorage
9546     -    1072 +  storageManager.set('previewZoom', currentZoom.toString());
9547     -    1073 +}
9548     -1103 1074  
9549     -1104     -  // Folder browser DOM elements
9550     -1105     -  const fileBrowser = document.getElementById('file-browser');
9551     -1106     -  const openFolderBtn = document.getElementById('open-folder-btn');
9552     -1107     -  const toggleSidebarBtn = document.getElementById('toggle-sidebar-btn');
9553     -1108     -  const closeBrowserBtn = document.getElementById('close-browser-btn');
9554     -1109     -  const floatingShowBtn = document.getElementById('floating-show-btn');
9555     -1110     -  const resizeHandle = document.getElementById('resize-handle');
9556     -1111     -  const fileTree = document.getElementById('file-tree');
9557     -1112     -  const currentFolderNameEl = document.getElementById('current-folder-name');
9558     -1113     -  const fileCountEl = document.getElementById('file-count');
9559     -    1075 +function zoomIn() {
9560     -    1076 +  setZoom(currentZoom + 10);
9561     -    1077 +}
9562     -1114 1078  
9563     -1115     -  // Folder browser state (using let to allow reassignment)
9564     -1116     -  let folderFiles = [];
9565     -1117     -  let activeFileHandle = null;
9566     -1118     -  let isResizing = false;
9567     -1119     -  let sidebarWidth = 280; // Default width
9568     -1120     -  const minWidth = 100; // Allow squeezing to very narrow
9569     -1121     -  const maxWidth = 600;
9570     -1122     -  const collapseThreshold = 80; // Auto-collapse at very left edge only
9571     -    1079 +function zoomOut() {
9572     -    1080 +  setZoom(currentZoom - 10);
9573     -    1081 +}
9574     -1123 1082  
9575     -1124     -  // Load saved sidebar width
9576     -1125     -  const savedWidth = storageManager.get('sidebarWidth');
9577     -1126     -  if (savedWidth) {
9578     -1127     -    sidebarWidth = parseInt(savedWidth, 10);
9579     -1128     -  }
9580     -    1083 +function resetZoom() {
9581     -    1084 +  setZoom(100);
9582     -    1085 +}
9583     -1129 1086  
9584     -1130     -  // Resize functionality
9585     -1131     -  resizeHandle.addEventListener('mousedown', e => {
9586     -1132     -    isResizing = true;
9587     -1133     -    fileBrowser.classList.add('resizing');
9588     -1134     -    resizeHandle.classList.add('dragging');
9589     -1135     -    document.body.style.cursor = 'col-resize';
9590     -1136     -    document.body.style.userSelect = 'none';
9591     -    1087 +// Zoom event listeners
9592     -    1088 +zoomInBtn.addEventListener('click', zoomIn);
9593     -    1089 +zoomOutBtn.addEventListener('click', zoomOut);
9594     -    1090 +zoomResetBtn.addEventListener('click', resetZoom);
9595     -    1091 +
9596     -    1092 +// Keyboard shortcuts for zoom (Ctrl/Cmd + Plus/Minus/0)
9597     -    1093 +preview.addEventListener('wheel', e => {
9598     -    1094 +  if (e.ctrlKey || e.metaKey) {
9599     -1137 1095      e.preventDefault();
9600     -1138     -  });
9601     -1139     -
9602     -1140     -  document.addEventListener('mousemove', e => {
9603     -1141     -    if (!isResizing) return;
9604     -1142     -
9605     -1143     -    const newWidth = e.clientX;
9606     -1144     -
9607     -1145     -    // Check if dragged to leftmost (auto-collapse)
9608     -1146     -    if (newWidth < collapseThreshold) {
9609     -1147     -      // Auto-collapse with smooth animation
9610     -1148     -      fileBrowser.classList.remove('resizing');
9611     -1149     -      fileBrowser.style.display = 'none';
9612     -1150     -      floatingShowBtn.style.display = 'block';
9613     -1151     -      isResizing = false;
9614     -1152     -      resizeHandle.classList.remove('dragging');
9615     -1153     -      document.body.style.cursor = '';
9616     -1154     -      document.body.style.userSelect = '';
9617     -1155     -      return;
9618     -    1096 +    if (e.deltaY < 0) {
9619     -    1097 +      zoomIn();
9620     -    1098 +    } else {
9621     -    1099 +      zoomOut();
9622     -1156 1100      }
9623     -    1101 +  }
9624     -    1102 +});
9625     -1157 1103  
9626     -1158     -    // Constrain width
9627     -1159     -    if (newWidth >= minWidth && newWidth <= maxWidth) {
9628     -1160     -      sidebarWidth = newWidth;
9629     -1161     -      fileBrowser.style.width = `${sidebarWidth}px`;
9630     -    1104 +document.addEventListener('keydown', e => {
9631     -    1105 +  if ((e.ctrlKey || e.metaKey) && e.target.tagName !== 'TEXTAREA') {
9632     -    1106 +    if (e.key === '=' || e.key === '+') {
9633     -    1107 +      e.preventDefault();
9634     -    1108 +      zoomIn();
9635     -    1109 +    } else if (e.key === '-') {
9636     -    1110 +      e.preventDefault();
9637     -    1111 +      zoomOut();
9638     -    1112 +    } else if (e.key === '0') {
9639     -    1113 +      e.preventDefault();
9640     -    1114 +      resetZoom();
9641     -1162 1115      }
9642     -1163     -  });
9643     -    1116 +  }
9644     -    1117 +});
9645     -1164 1118  
9646     -1165     -  document.addEventListener('mouseup', () => {
9647     -1166     -    if (isResizing) {
9648     -1167     -      isResizing = false;
9649     -1168     -      fileBrowser.classList.remove('resizing');
9650     -1169     -      resizeHandle.classList.remove('dragging');
9651     -1170     -      document.body.style.cursor = '';
9652     -1171     -      document.body.style.userSelect = '';
9653     -    1119 +// Load saved zoom level
9654     -    1120 +const savedZoom = storageManager.get('previewZoom');
9655     -    1121 +if (savedZoom) {
9656     -    1122 +  currentZoom = parseInt(savedZoom, 10);
9657     -    1123 +  setZoom(currentZoom);
9658     -    1124 +}
9659     -1172 1125  
9660     -1173     -      // Save width
9661     -1174     -      storageManager.set('sidebarWidth', sidebarWidth.toString());
9662     -1175     -    }
9663     -1176     -  });
9664     -    1126 +// Load saved view mode
9665     -    1127 +const savedViewMode = storageManager.get('viewMode') || 'split-view';
9666     -    1128 +setViewMode(savedViewMode);
9667     -1177 1129  
9668     -1178     -  // Open folder handler
9669     -1179     -  openFolderBtn.addEventListener('click', async () => {
9670     -1180     -    if (!folderBrowserService.isSupported()) {
9671     -1181     -      alert(
9672     -1182     -        'Folder browsing requires File System Access API.\n\n' +
9673     -1183     -          'Please use Chrome 86+ or Edge 86+.\n\n' +
9674     -1184     -          'Firefox and Safari are not currently supported.'
9675     -1185     -      );
9676     -1186     -      return;
9677     -1187     -    }
9678     -    1130 +// ==================== FOLDER BROWSER FUNCTIONALITY ====================
9679     -1188 1131  
9680     -1189     -    const result = await folderBrowserService.openFolder();
9681     -    1132 +// Folder browser DOM elements
9682     -    1133 +const fileBrowser = document.getElementById('file-browser');
9683     -    1134 +const openFolderBtn = document.getElementById('open-folder-btn');
9684     -    1135 +const toggleSidebarBtn = document.getElementById('toggle-sidebar-btn');
9685     -    1136 +const closeBrowserBtn = document.getElementById('close-browser-btn');
9686     -    1137 +const floatingShowBtn = document.getElementById('floating-show-btn');
9687     -    1138 +const resizeHandle = document.getElementById('resize-handle');
9688     -    1139 +const fileTree = document.getElementById('file-tree');
9689     -    1140 +const currentFolderNameEl = document.getElementById('current-folder-name');
9690     -    1141 +const fileCountEl = document.getElementById('file-count');
9691     -1190 1142  
9692     -1191     -    if (result.cancelled) {
9693     -1192     -      return; // User cancelled
9694     -1193     -    }
9695     -    1143 +// Folder browser state (using let to allow reassignment)
9696     -    1144 +let folderFiles = [];
9697     -    1145 +let activeFileHandle = null;
9698     -    1146 +let isResizing = false;
9699     -    1147 +let sidebarWidth = 280; // Default width
9700     -    1148 +const minWidth = 100; // Allow squeezing to very narrow
9701     -    1149 +const maxWidth = 600;
9702     -    1150 +const collapseThreshold = 80; // Auto-collapse at very left edge only
9703     -1194 1151  
9704     -1195     -    if (!result.success) {
9705     -1196     -      alert('Error opening folder: ' + result.error);
9706     -1197     -      return;
9707     -1198     -    }
9708     -    1152 +// Load saved sidebar width
9709     -    1153 +const savedWidth = storageManager.get('sidebarWidth');
9710     -    1154 +if (savedWidth) {
9711     -    1155 +  sidebarWidth = parseInt(savedWidth, 10);
9712     -    1156 +}
9713     -1199 1157  
9714     -1200     -    // Store files
9715     -1201     -    folderFiles = result.files;
9716     -    1158 +// Resize functionality
9717     -    1159 +resizeHandle.addEventListener('mousedown', e => {
9718     -    1160 +  isResizing = true;
9719     -    1161 +  fileBrowser.classList.add('resizing');
9720     -    1162 +  resizeHandle.classList.add('dragging');
9721     -    1163 +  document.body.style.cursor = 'col-resize';
9722     -    1164 +  document.body.style.userSelect = 'none';
9723     -    1165 +  e.preventDefault();
9724     -    1166 +});
9725     -1202 1167  
9726     -1203     -    // Show browser sidebar, hide floating button
9727     -1204     -    fileBrowser.style.display = 'flex';
9728     -1205     -    floatingShowBtn.style.display = 'none';
9729     -    1168 +document.addEventListener('mousemove', e => {
9730     -    1169 +  if (!isResizing) return;
9731     -1206 1170  
9732     -1207     -    // Update UI
9733     -1208     -    currentFolderNameEl.textContent = result.folderName;
9734     -1209     -    fileCountEl.textContent = `${result.totalFiles} file${result.totalFiles !== 1 ? 's' : ''}`;
9735     -    1171 +  const newWidth = e.clientX;
9736     -1210 1172  
9737     -1211     -    // Render tree
9738     -1212     -    renderFileTree(result.files);
9739     -1213     -
9740     -1214     -    console.log(`‚úÖ Loaded ${result.totalFiles} markdown files from ${result.folderName}`);
9741     -1215     -  });
    741 +920     -// Show sync scroll button only in split view
    742 +921     -function updateSyncScrollVisibility() {
    743 +922     -  const currentView = storageManager.get('viewMode') || 'split-view';
    744 +923     -  if (currentView === 'split-view') {
    745 +924     -    syncScrollBtn.style.display = 'inline-block';
    746 +925     -  } else {
    747 +926     -    syncScrollBtn.style.display = 'none';
    748 +927     -  }
    749 +928     -}
    750 +929     -
    751 +930     -// Sync scroll toggle
    752 +931     -syncScrollBtn.addEventListener('click', () => {
    753 +932     -  syncScrollEnabled = !syncScrollEnabled;
    754 +933     -  storageManager.set('syncScrollEnabled', syncScrollEnabled.toString());
    755 +    896 +  // Sync scroll state (using var to avoid formatter issues)
    756 +    897 +  var syncScrollEnabled = storageManager.get('syncScrollEnabled') === 'true';
    757 +    898 +  var syncScrolling = false;
    758 +934 899  
    759 +    900 +  // Load saved state and update button
    760 +935 901    if (syncScrollEnabled) {
    761 +936 902      syncScrollBtn.classList.add('active');
    762 +937     -    console.log('‚úÖ Sync scroll enabled');
    763 +938     -  } else {
    764 +939     -    syncScrollBtn.classList.remove('active');
    765 +940     -    console.log('‚ùå Sync scroll disabled');
    766 +941 903    }
    767 +942     -});
    768 +943 904  
    769 +944     -// Editor scroll handler with smooth sync
    770 +945     -editor.addEventListener('scroll', () => {
    771 +946     -  if (!syncScrollEnabled || syncScrolling) return;
    772 +947     -
    773 +948     -  syncScrolling = true;
    774 +949     -
    775 +950     -  requestAnimationFrame(() => {
    776 +951     -    const editorHeight = editor.scrollHeight - editor.clientHeight;
    777 +952     -    const previewHeight = previewContainer.scrollHeight - previewContainer.clientHeight;
    778 +953     -
    779 +954     -    // Handle edge cases for perfect alignment
    780 +955     -    if (editor.scrollTop <= 0) {
    781 +956     -      // At top
    782 +957     -      previewContainer.scrollTop = 0;
    783 +958     -    } else if (editor.scrollTop >= editorHeight) {
    784 +959     -      // At bottom
    785 +960     -      previewContainer.scrollTop = previewHeight;
    786 +    905 +  // Show sync scroll button only in split view
    787 +    906 +  function updateSyncScrollVisibility() {
    788 +    907 +    const currentView = storageManager.get('viewMode') || 'split-view';
    789 +    908 +    if (currentView === 'split-view') {
    790 +    909 +      syncScrollBtn.style.display = 'inline-block';
    791 +961 910      } else {
    792 +962     -      // Middle - proportional scroll
    793 +963     -      const scrollPercent = editor.scrollTop / editorHeight;
    794 +964     -      previewContainer.scrollTop = scrollPercent * previewHeight;
    795 +    911 +      syncScrollBtn.style.display = 'none';
    796 +965 912      }
    797 +    913 +  }
    798 +966 914  
    799 +967     -    setTimeout(() => {
    800 +968     -      syncScrolling = false;
    801 +969     -    }, 10); // Reduced from 50ms for more responsive feel
    802 +970     -  });
    803 +971     -});
    804 +    915 +  // Sync scroll toggle
    805 +    916 +  syncScrollBtn.addEventListener('click', () => {
    806 +    917 +    syncScrollEnabled = !syncScrollEnabled;
    807 +    918 +    storageManager.set('syncScrollEnabled', syncScrollEnabled.toString());
    808 +972 919  
    809 +973     -// Preview container scroll handler with smooth sync
    810 +974     -previewContainer.addEventListener('scroll', () => {
    811 +975     -  if (!syncScrollEnabled || syncScrolling) return;
    812 +976     -
    813 +977     -  syncScrolling = true;
    814 +978     -
    815 +979     -  requestAnimationFrame(() => {
    816 +980     -    const editorHeight = editor.scrollHeight - editor.clientHeight;
    817 +981     -    const previewHeight = previewContainer.scrollHeight - previewContainer.clientHeight;
    818 +982     -
    819 +983     -    // Handle edge cases for perfect alignment
    820 +984     -    if (previewContainer.scrollTop <= 0) {
    821 +985     -      // At top
    822 +986     -      editor.scrollTop = 0;
    823 +987     -    } else if (previewContainer.scrollTop >= previewHeight) {
    824 +988     -      // At bottom
    825 +989     -      editor.scrollTop = editorHeight;
    826 +    920 +    if (syncScrollEnabled) {
    827 +    921 +      syncScrollBtn.classList.add('active');
    828 +    922 +      console.log('‚úÖ Sync scroll enabled');
    829 +990 923      } else {
    830 +991     -      // Middle - proportional scroll
    831 +992     -      const scrollPercent = previewContainer.scrollTop / previewHeight;
    832 +993     -      editor.scrollTop = scrollPercent * editorHeight;
    833 +    924 +      syncScrollBtn.classList.remove('active');
    834 +    925 +      console.log('‚ùå Sync scroll disabled');
    835 +994 926      }
    836 +995     -
    837 +996     -    setTimeout(() => {
    838 +997     -      syncScrolling = false;
    839 +998     -    }, 10); // Reduced from 50ms for more responsive feel
    840 +999 927    });
    841 +1000     -});
    842 +1001 928  
    843 +1002     -// View mode button event listeners with sync button update
    844 +1003     -editorOnlyBtn.addEventListener('click', () => {
    845 +1004     -  setViewMode('editor-only');
    846 +1005     -  updateSyncScrollVisibility();
    847 +1006     -});
    848 +1007     -splitViewBtn.addEventListener('click', () => {
    849 +1008     -  setViewMode('split-view');
    850 +1009     -  updateSyncScrollVisibility();
    851 +1010     -});
    852 +1011     -previewOnlyBtn.addEventListener('click', () => {
    853 +1012     -  setViewMode('preview-only');
    854 +1013     -  updateSyncScrollVisibility();
    855 +1014     -});
    856 +    929 +  // Editor scroll handler with smooth sync
    857 +    930 +  editor.addEventListener('scroll', () => {
    858 +    931 +    if (!syncScrollEnabled || syncScrolling) return;
    859 +1015 932  
    860 +1016     -// Initialize visibility
    861 +1017     -updateSyncScrollVisibility();
    862 +    933 +    syncScrolling = true;
    863 +1018 934  
    864 +1019     -// Load saved theme FIRST, then initialize Mermaid with correct colors
    865 +1020     -const savedTheme = storageManager.get('selectedTheme');
    866 +1021     -if (savedTheme) {
    867 +1022     -  // Load theme first, then sync dropdown and reinit Mermaid
    868 +1023     -  themeManager
    869 +1024     -    .loadTheme(savedTheme)
    870 +1025     -    .then(() => {
    871 +1026     -      // Theme loaded successfully - sync dropdown
    872 +1027     -      themeSelector.value = savedTheme;
    873 +1028     -      console.log(`‚úÖ Theme restored: ${savedTheme}`);
    874 +    935 +    requestAnimationFrame(() => {
    875 +    936 +      const editorHeight = editor.scrollHeight - editor.clientHeight;
    876 +    937 +      const previewHeight = previewContainer.scrollHeight - previewContainer.clientHeight;
    877 +1029 938  
    878 +1030     -      // NOW initialize Mermaid with correct theme colors
    879 +1031     -      mermaidService.initialize();
    880 +    939 +      // Handle edge cases for perfect alignment
    881 +    940 +      if (editor.scrollTop <= 0) {
    882 +    941 +        // At top
    883 +    942 +        previewContainer.scrollTop = 0;
    884 +    943 +      } else if (editor.scrollTop >= editorHeight) {
    885 +    944 +        // At bottom
    886 +    945 +        previewContainer.scrollTop = previewHeight;
    887 +    946 +      } else {
    888 +    947 +        // Middle - proportional scroll
    889 +    948 +        const scrollPercent = editor.scrollTop / editorHeight;
    890 +    949 +        previewContainer.scrollTop = scrollPercent * previewHeight;
    891 +    950 +      }
    892 +1032 951  
    893 +1033     -      // Re-render to apply theme
    894 +1034     -      renderMarkdown();
    895 +1035     -    })
    896 +1036     -    .catch(err => {
    897 +1037     -      console.error('Failed to load saved theme:', err);
    898 +1038     -      // Fallback to default-light on error
    899 +1039     -      themeManager.loadTheme('default-light').then(() => {
    900 +1040     -        themeSelector.value = 'default-light';
    901 +1041     -        mermaidService.initialize();
    902 +1042     -        renderMarkdown();
    903 +1043     -      });
    904 +    952 +      setTimeout(() => {
    905 +    953 +        syncScrolling = false;
    906 +    954 +      }, 10); // Reduced from 50ms for more responsive feel
    907 +1044 955      });
    908 +1045     -} else {
    909 +1046     -  // No saved theme - initialize with default-light
    910 +1047     -  mermaidService.initialize();
    911 +1048     -  renderMarkdown();
    912 +1049     -}
    913 +    956 +  });
    914 +1050 957  
    915 +1051     -// Zoom functionality
    916 +1052     -function setZoom(zoomLevel) {
    917 +1053     -  // Constrain zoom level between 50% and 200%
    918 +1054     -  currentZoom = Math.max(50, Math.min(200, zoomLevel));
    919 +    958 +  // Preview container scroll handler with smooth sync
    920 +    959 +  previewContainer.addEventListener('scroll', () => {
    921 +    960 +    if (!syncScrollEnabled || syncScrolling) return;
    922 +1055 961  
    923 +1056     -  // Apply zoom using CSS transform with proper container sizing
    924 +1057     -  preview.style.transform = `scale(${currentZoom / 100})`;
    925 +1058     -  preview.style.transformOrigin = 'top left';
    926 +1059     -  preview.style.width = `${10000 / currentZoom}%`;
    927 +1060     -  preview.style.height = `${10000 / currentZoom}%`;
    928 +    962 +    syncScrolling = true;
    929 +1061 963  
    930 +1062     -  // Ensure scrollbar remains visible and functional
    931 +1063     -  const previewContainer = preview.parentElement;
    932 +1064     -  if (previewContainer) {
    933 +1065     -    previewContainer.style.overflow = 'auto';
    934 +    964 +    requestAnimationFrame(() => {
    935 +    965 +      const editorHeight = editor.scrollHeight - editor.clientHeight;
    936 +    966 +      const previewHeight = previewContainer.scrollHeight - previewContainer.clientHeight;
    937 +    967 +
    938 +    968 +      // Handle edge cases for perfect alignment
    939 +    969 +      if (previewContainer.scrollTop <= 0) {
    940 +    970 +        // At top
    941 +    971 +        editor.scrollTop = 0;
    942 +    972 +      } else if (previewContainer.scrollTop >= previewHeight) {
    943 +    973 +        // At bottom
    944 +    974 +        editor.scrollTop = editorHeight;
    945 +    975 +      } else {
    946 +    976 +        // Middle - proportional scroll
    947 +    977 +        const scrollPercent = previewContainer.scrollTop / previewHeight;
    948 +    978 +        editor.scrollTop = scrollPercent * editorHeight;
    949 +    979 +      }
    950 +    980 +
    951 +    981 +      setTimeout(() => {
    952 +    982 +        syncScrolling = false;
    953 +    983 +      }, 10); // Reduced from 50ms for more responsive feel
    954 +    984 +    });
    955 +    985 +  });
    956 +    986 +
    957 +    987 +  // View mode button event listeners with sync button update
    958 +    988 +  editorOnlyBtn.addEventListener('click', () => {
    959 +    989 +    setViewMode('editor-only');
    960 +    990 +    updateSyncScrollVisibility();
    961 +    991 +  });
    962 +    992 +  splitViewBtn.addEventListener('click', () => {
    963 +    993 +    setViewMode('split-view');
    964 +    994 +    updateSyncScrollVisibility();
    965 +    995 +  });
    966 +    996 +  previewOnlyBtn.addEventListener('click', () => {
    967 +    997 +    setViewMode('preview-only');
    968 +    998 +    updateSyncScrollVisibility();
    969 +    999 +  });
    970 +    1000 +
    971 +    1001 +  // Initialize visibility
    972 +    1002 +  updateSyncScrollVisibility();
    973 +    1003 +
    974 +    1004 +  // Load saved theme FIRST, then initialize Mermaid with correct colors
    975 +    1005 +  const savedTheme = storageManager.get('selectedTheme');
    976 +    1006 +  if (savedTheme) {
    977 +    1007 +    // Load theme first, then sync dropdown and reinit Mermaid
    978 +    1008 +    themeManager
    979 +    1009 +      .loadTheme(savedTheme)
    980 +    1010 +      .then(() => {
    981 +    1011 +        // Theme loaded successfully - sync dropdown
    982 +    1012 +        themeSelector.value = savedTheme;
    983 +    1013 +        console.log(`‚úÖ Theme restored: ${savedTheme}`);
    984 +    1014 +
    985 +    1015 +        // NOW initialize Mermaid with correct theme colors
    986 +    1016 +        mermaidService.initialize();
    987 +    1017 +
    988 +    1018 +        // Re-render to apply theme
    989 +    1019 +        renderMarkdown();
    990 +    1020 +      })
    991 +    1021 +      .catch(err => {
    992 +    1022 +        console.error('Failed to load saved theme:', err);
    993 +    1023 +        // Fallback to default-light on error
    994 +    1024 +        themeManager.loadTheme('default-light').then(() => {
    995 +    1025 +          themeSelector.value = 'default-light';
    996 +    1026 +          mermaidService.initialize();
    997 +    1027 +          renderMarkdown();
    998 +    1028 +        });
    999 +    1029 +      });
    1000 +    1030 +  } else {
    1001 +    1031 +    // No saved theme - initialize with default-light
    1002 +    1032 +    mermaidService.initialize();
    1003 +    1033 +    renderMarkdown();
    1004 +1066 1034    }
    1005 +1067 1035  
    1006 +1068     -  // Update display
    1007 +1069     -  zoomLevelDisplay.textContent = `${currentZoom}%`;
    1008 +    1036 +  // Zoom functionality
    1009 +    1037 +  function setZoom(zoomLevel) {
    1010 +    1038 +    // Constrain zoom level between 50% and 200%
    1011 +    1039 +    currentZoom = Math.max(50, Math.min(200, zoomLevel));
    1012 +1070 1040  
    1013 +1071     -  // Save to localStorage
    1014 +1072     -  storageManager.set('previewZoom', currentZoom.toString());
    1015 +1073     -}
    1016 +    1041 +    // Apply zoom using CSS transform with proper container sizing
    1017 +    1042 +    preview.style.transform = `scale(${currentZoom / 100})`;
    1018 +    1043 +    preview.style.transformOrigin = 'top left';
    1019 +    1044 +    preview.style.width = `${10000 / currentZoom}%`;
    1020 +    1045 +    preview.style.height = `${10000 / currentZoom}%`;
    1021 +1074 1046  
    1022 +1075     -function zoomIn() {
    1023 +1076     -  setZoom(currentZoom + 10);
    1024 +1077     -}
    1025 +    1047 +    // Ensure scrollbar remains visible and functional
    1026 +    1048 +    const previewContainer = preview.parentElement;
    1027 +    1049 +    if (previewContainer) {
    1028 +    1050 +      previewContainer.style.overflow = 'auto';
    1029 +    1051 +    }
    1030 +1078 1052  
    1031 +1079     -function zoomOut() {
    1032 +1080     -  setZoom(currentZoom - 10);
    1033 +1081     -}
    1034 +    1053 +    // Update display
    1035 +    1054 +    zoomLevelDisplay.textContent = `${currentZoom}%`;
    1036 +1082 1055  
    1037 +1083     -function resetZoom() {
    1038 +1084     -  setZoom(100);
    1039 +1085     -}
    1040 +    1056 +    // Save to localStorage
    1041 +    1057 +    storageManager.set('previewZoom', currentZoom.toString());
    1042 +    1058 +  }
    1043 +1086 1059  
    1044 +1087     -// Zoom event listeners
    1045 +1088     -zoomInBtn.addEventListener('click', zoomIn);
    1046 +1089     -zoomOutBtn.addEventListener('click', zoomOut);
    1047 +1090     -zoomResetBtn.addEventListener('click', resetZoom);
    1048 +    1060 +  function zoomIn() {
    1049 +    1061 +    setZoom(currentZoom + 10);
    1050 +    1062 +  }
    1051 +1091 1063  
    1052 +1092     -// Keyboard shortcuts for zoom (Ctrl/Cmd + Plus/Minus/0)
    1053 +1093     -preview.addEventListener('wheel', e => {
    1054 +1094     -  if (e.ctrlKey || e.metaKey) {
    1055 +    1064 +  function zoomOut() {
    1056 +    1065 +    setZoom(currentZoom - 10);
    1057 +    1066 +  }
    1058 +    1067 +
    1059 +    1068 +  function resetZoom() {
    1060 +    1069 +    setZoom(100);
    1061 +    1070 +  }
    1062 +    1071 +
    1063 +    1072 +  // Zoom event listeners
    1064 +    1073 +  zoomInBtn.addEventListener('click', zoomIn);
    1065 +    1074 +  zoomOutBtn.addEventListener('click', zoomOut);
    1066 +    1075 +  zoomResetBtn.addEventListener('click', resetZoom);
    1067 +    1076 +
    1068 +    1077 +  // Keyboard shortcuts for zoom (Ctrl/Cmd + Plus/Minus/0)
    1069 +    1078 +  preview.addEventListener('wheel', e => {
    1070 +    1079 +    if (e.ctrlKey || e.metaKey) {
    1071 +    1080 +      e.preventDefault();
    1072 +    1081 +      if (e.deltaY < 0) {
    1073 +    1082 +        zoomIn();
    1074 +    1083 +      } else {
    1075 +    1084 +        zoomOut();
    1076 +    1085 +      }
    1077 +    1086 +    }
    1078 +    1087 +  });
    1079 +    1088 +
    1080 +    1089 +  document.addEventListener('keydown', e => {
    1081 +    1090 +    if ((e.ctrlKey || e.metaKey) && e.target.tagName !== 'TEXTAREA') {
    1082 +    1091 +      if (e.key === '=' || e.key === '+') {
    1083 +    1092 +        e.preventDefault();
    1084 +    1093 +        zoomIn();
    1085 +    1094 +      } else if (e.key === '-') {
    1086 +    1095 +        e.preventDefault();
    1087 +    1096 +        zoomOut();
    1088 +    1097 +      } else if (e.key === '0') {
    1089 +    1098 +        e.preventDefault();
    1090 +    1099 +        resetZoom();
    1091 +    1100 +      }
    1092 +    1101 +    }
    1093 +    1102 +  });
    1094 +    1103 +
    1095 +    1104 +  // Load saved zoom level
    1096 +    1105 +  const savedZoom = storageManager.get('previewZoom');
    1097 +    1106 +  if (savedZoom) {
    1098 +    1107 +    currentZoom = parseInt(savedZoom, 10);
    1099 +    1108 +    setZoom(currentZoom);
    1100 +    1109 +  }
    1101 +    1110 +
    1102 +    1111 +  // Load saved view mode
    1103 +    1112 +  const savedViewMode = storageManager.get('viewMode') || 'split-view';
    1104 +    1113 +  setViewMode(savedViewMode);
    1105 +    1114 +
    1106 +    1115 +  // ==================== FOLDER BROWSER FUNCTIONALITY ====================
    1107 +    1116 +
    1108 +    1117 +  // Folder browser DOM elements
    1109 +    1118 +  const fileBrowser = document.getElementById('file-browser');
    1110 +    1119 +  const openFolderBtn = document.getElementById('open-folder-btn');
    1111 +    1120 +  const toggleSidebarBtn = document.getElementById('toggle-sidebar-btn');
    1112 +    1121 +  const closeBrowserBtn = document.getElementById('close-browser-btn');
    1113 +    1122 +  const floatingShowBtn = document.getElementById('floating-show-btn');
    1114 +    1123 +  const resizeHandle = document.getElementById('resize-handle');
    1115 +    1124 +  const fileTree = document.getElementById('file-tree');
    1116 +    1125 +  const currentFolderNameEl = document.getElementById('current-folder-name');
    1117 +    1126 +  const fileCountEl = document.getElementById('file-count');
    1118 +    1127 +
    1119 +    1128 +  // Folder browser state (using let to allow reassignment)
    1120 +    1129 +  let folderFiles = [];
    1121 +    1130 +  let activeFileHandle = null;
    1122 +    1131 +  let isResizing = false;
    1123 +    1132 +  let sidebarWidth = 280; // Default width
    1124 +    1133 +  const minWidth = 100; // Allow squeezing to very narrow
    1125 +    1134 +  const maxWidth = 600;
    1126 +    1135 +  const collapseThreshold = 80; // Auto-collapse at very left edge only
    1127 +    1136 +
    1128 +    1137 +  // Load saved sidebar width
    1129 +    1138 +  const savedWidth = storageManager.get('sidebarWidth');
    1130 +    1139 +  if (savedWidth) {
    1131 +    1140 +    sidebarWidth = parseInt(savedWidth, 10);
    1132 +    1141 +  }
    1133 +    1142 +
    1134 +    1143 +  // Resize functionality
    1135 +    1144 +  resizeHandle.addEventListener('mousedown', e => {
    1136 +    1145 +    isResizing = true;
    1137 +    1146 +    fileBrowser.classList.add('resizing');
    1138 +    1147 +    resizeHandle.classList.add('dragging');
    1139 +    1148 +    document.body.style.cursor = 'col-resize';
    1140 +    1149 +    document.body.style.userSelect = 'none';
    1141 +1095 1150      e.preventDefault();
    1142 +1096     -    if (e.deltaY < 0) {
    1143 +1097     -      zoomIn();
    1144 +1098     -    } else {
    1145 +1099     -      zoomOut();
    1146 +    1151 +  });
    1147 +    1152 +
    1148 +    1153 +  document.addEventListener('mousemove', e => {
    1149 +    1154 +    if (!isResizing) return;
    1150 +    1155 +
    1151 +    1156 +    const newWidth = e.clientX;
    1152 +    1157 +
    1153 +    1158 +    // Check if dragged to leftmost (auto-collapse)
    1154 +    1159 +    if (newWidth < collapseThreshold) {
    1155 +    1160 +      // Auto-collapse with smooth animation
    1156 +    1161 +      fileBrowser.classList.remove('resizing');
    1157 +    1162 +      fileBrowser.style.display = 'none';
    1158 +    1163 +      floatingShowBtn.style.display = 'block';
    1159 +    1164 +      isResizing = false;
    1160 +    1165 +      resizeHandle.classList.remove('dragging');
    1161 +    1166 +      document.body.style.cursor = '';
    1162 +    1167 +      document.body.style.userSelect = '';
    1163 +    1168 +      return;
    1164 +1100 1169      }
    1165 +1101     -  }
    1166 +1102     -});
    1167 +1103 1170  
    1168 +1104     -document.addEventListener('keydown', e => {
    1169 +1105     -  if ((e.ctrlKey || e.metaKey) && e.target.tagName !== 'TEXTAREA') {
    1170 +1106     -    if (e.key === '=' || e.key === '+') {
    1171 +1107     -      e.preventDefault();
    1172 +1108     -      zoomIn();
    1173 +1109     -    } else if (e.key === '-') {
    1174 +1110     -      e.preventDefault();
    1175 +1111     -      zoomOut();
    1176 +1112     -    } else if (e.key === '0') {
    1177 +1113     -      e.preventDefault();
    1178 +1114     -      resetZoom();
    1179 +    1171 +    // Constrain width
    1180 +    1172 +    if (newWidth >= minWidth && newWidth <= maxWidth) {
    1181 +    1173 +      sidebarWidth = newWidth;
    1182 +    1174 +      fileBrowser.style.width = `${sidebarWidth}px`;
    1183 +1115 1175      }
    1184 +1116     -  }
    1185 +1117     -});
    1186 +    1176 +  });
    1187 +1118 1177  
    1188 +1119     -// Load saved zoom level
    1189 +1120     -const savedZoom = storageManager.get('previewZoom');
    1190 +1121     -if (savedZoom) {
    1191 +1122     -  currentZoom = parseInt(savedZoom, 10);
    1192 +1123     -  setZoom(currentZoom);
    1193 +1124     -}
    1194 +    1178 +  document.addEventListener('mouseup', () => {
    1195 +    1179 +    if (isResizing) {
    1196 +    1180 +      isResizing = false;
    1197 +    1181 +      fileBrowser.classList.remove('resizing');
    1198 +    1182 +      resizeHandle.classList.remove('dragging');
    1199 +    1183 +      document.body.style.cursor = '';
    1200 +    1184 +      document.body.style.userSelect = '';
    1201 +1125 1185  
    1202 +1126     -// Load saved view mode
    1203 +1127     -const savedViewMode = storageManager.get('viewMode') || 'split-view';
    1204 +1128     -setViewMode(savedViewMode);
    1205 +    1186 +      // Save width
    1206 +    1187 +      storageManager.set('sidebarWidth', sidebarWidth.toString());
    1207 +    1188 +    }
    1208 +    1189 +  });
    1209 +1129 1190  
    1210 +1130     -// ==================== FOLDER BROWSER FUNCTIONALITY ====================
    1211 +    1191 +  // Open folder handler
    1212 +    1192 +  openFolderBtn.addEventListener('click', async () => {
    1213 +    1193 +    if (!folderBrowserService.isSupported()) {
    1214 +    1194 +      alert(
    1215 +    1195 +        'Folder browsing requires File System Access API.\n\n' +
    1216 +    1196 +        'Please use Chrome 86+ or Edge 86+.\n\n' +
    1217 +    1197 +        'Firefox and Safari are not currently supported.'
    1218 +    1198 +      );
    1219 +    1199 +      return;
    1220 +    1200 +    }
    1221 +1131 1201  
    1222 +1132     -// Folder browser DOM elements
    1223 +1133     -const fileBrowser = document.getElementById('file-browser');
    1224 +1134     -const openFolderBtn = document.getElementById('open-folder-btn');
    1225 +1135     -const toggleSidebarBtn = document.getElementById('toggle-sidebar-btn');
    1226 +1136     -const closeBrowserBtn = document.getElementById('close-browser-btn');
    1227 +1137     -const floatingShowBtn = document.getElementById('floating-show-btn');
    1228 +1138     -const resizeHandle = document.getElementById('resize-handle');
    1229 +1139     -const fileTree = document.getElementById('file-tree');
    1230 +1140     -const currentFolderNameEl = document.getElementById('current-folder-name');
    1231 +1141     -const fileCountEl = document.getElementById('file-count');
    1232 +    1202 +    const result = await folderBrowserService.openFolder();
    1233 +1142 1203  
    1234 +1143     -// Folder browser state (using let to allow reassignment)
    1235 +1144     -let folderFiles = [];
    1236 +1145     -let activeFileHandle = null;
    1237 +1146     -let isResizing = false;
    1238 +1147     -let sidebarWidth = 280; // Default width
    1239 +1148     -const minWidth = 100; // Allow squeezing to very narrow
    1240 +1149     -const maxWidth = 600;
    1241 +1150     -const collapseThreshold = 80; // Auto-collapse at very left edge only
    1242 +    1204 +    if (result.cancelled) {
    1243 +    1205 +      return; // User cancelled
    1244 +    1206 +    }
    1245 +1151 1207  
    1246 +1152     -// Load saved sidebar width
    1247 +1153     -const savedWidth = storageManager.get('sidebarWidth');
    1248 +1154     -if (savedWidth) {
    1249 +1155     -  sidebarWidth = parseInt(savedWidth, 10);
    1250 +1156     -}
    1251 +    1208 +    if (!result.success) {
    1252 +    1209 +      alert('Error opening folder: ' + result.error);
    1253 +    1210 +      return;
    1254 +    1211 +    }
    1255 +1157 1212  
    1256 +1158     -// Resize functionality
    1257 +1159     -resizeHandle.addEventListener('mousedown', e => {
    1258 +1160     -  isResizing = true;
    1259 +1161     -  fileBrowser.classList.add('resizing');
    1260 +1162     -  resizeHandle.classList.add('dragging');
    1261 +1163     -  document.body.style.cursor = 'col-resize';
    1262 +1164     -  document.body.style.userSelect = 'none';
    1263 +1165     -  e.preventDefault();
    1264 +1166     -});
    1265 +    1213 +    // Store files
    1266 +    1214 +    folderFiles = result.files;
    1267 +1167 1215  
    1268 +1168     -document.addEventListener('mousemove', e => {
    1269 +1169     -  if (!isResizing) return;
    1270 +    1216 +    // Show browser sidebar, hide floating button
    1271 +    1217 +    fileBrowser.style.display = 'flex';
    1272 +    1218 +    floatingShowBtn.style.display = 'none';
    1273 +1170 1219  
    1274 +1171     -  const newWidth = e.clientX;
    1275 +    1220 +    // Update UI
    1276 +    1221 +    currentFolderNameEl.textContent = result.folderName;
    1277 +    1222 +    fileCountEl.textContent = `${result.totalFiles} file${result.totalFiles !== 1 ? 's' : ''}`;
    1278 +1172 1223  
    1279 +1173     -  // Check if dragged to leftmost (auto-collapse)
    1280 +1174     -  if (newWidth < collapseThreshold) {
    1281 +1175     -    // Auto-collapse with smooth animation
    1282 +1176     -    fileBrowser.classList.remove('resizing');
    1283 +    1224 +    // Render tree
    1284 +    1225 +    renderFileTree(result.files);
    1285 +    1226 +
    1286 +    1227 +    console.log(`‚úÖ Loaded ${result.totalFiles} markdown files from ${result.folderName}`);
    1287 +    1228 +  });
    1288 +    1229 +
    1289 +    1230 +  // Toggle sidebar collapse/expand (keeps folder data)
    1290 +    1231 +  toggleSidebarBtn.addEventListener('click', () => {
    1291 +    1232 +    // Hide sidebar, show floating button
    1292 +1177 1233      fileBrowser.style.display = 'none';
    1293 +1178 1234      floatingShowBtn.style.display = 'block';
    1294 +1179     -    isResizing = false;
    1295 +1180     -    resizeHandle.classList.remove('dragging');
    1296 +1181     -    document.body.style.cursor = '';
    1297 +1182     -    document.body.style.userSelect = '';
    1298 +1183     -    return;
    1299 +1184     -  }
    1300 +    1235 +  });
    1301 +1185 1236  
    1302 +1186     -  // Constrain width
    1303 +1187     -  if (newWidth >= minWidth && newWidth <= maxWidth) {
    1304 +1188     -    sidebarWidth = newWidth;
    1305 +1189     -    fileBrowser.style.width = `${sidebarWidth}px`;
    1306 +1190     -  }
    1307 +1191     -});
    1308 +    1237 +  // Floating button - show sidebar
    1309 +    1238 +  floatingShowBtn.addEventListener('click', () => {
    1310 +    1239 +    // Show sidebar, hide floating button
    1311 +    1240 +    fileBrowser.style.display = 'flex';
    1312 +    1241 +    floatingShowBtn.style.display = 'none';
    1313 +    1242 +  });
    1314 +1192 1243  
    1315 +1193     -document.addEventListener('mouseup', () => {
    1316 +1194     -  if (isResizing) {
    1317 +1195     -    isResizing = false;
    1318 +1196     -    fileBrowser.classList.remove('resizing');
    1319 +1197     -    resizeHandle.classList.remove('dragging');
    1320 +1198     -    document.body.style.cursor = '';
    1321 +1199     -    document.body.style.userSelect = '';
    1322 +    1244 +  // Close browser handler (clears all folder data)
    1323 +    1245 +  closeBrowserBtn.addEventListener('click', () => {
    1324 +    1246 +    // Hide everything AND clear data
    1325 +    1247 +    fileBrowser.style.display = 'none';
    1326 +    1248 +    floatingShowBtn.style.display = 'none';
    1327 +    1249 +    folderFiles = [];
    1328 +    1250 +    activeFileHandle = null;
    1329 +    1251 +  });
    1330 +1200 1252  
    1331 +1201     -    // Save width
    1332 +1202     -    storageManager.set('sidebarWidth', sidebarWidth.toString());
    1333 +1203     -  }
    1334 +1204     -});
    1335 +    1253 +  // Render file tree
    1336 +    1254 +  function renderFileTree(items, container = fileTree, indent = 0) {
    1337 +    1255 +    // Clear container on first render
    1338 +    1256 +    if (indent === 0) {
    1339 +    1257 +      container.innerHTML = '';
    1340 +    1258 +    }
    1341 +1205 1259  
    1342 +1206     -// Open folder handler
    1343 +1207     -openFolderBtn.addEventListener('click', async () => {
    1344 +1208     -  if (!folderBrowserService.isSupported()) {
    1345 +1209     -    alert(
    1346 +1210     -      'Folder browsing requires File System Access API.\n\n' +
    1347 +1211     -      'Please use Chrome 86+ or Edge 86+.\n\n' +
    1348 +1212     -      'Firefox and Safari are not currently supported.'
    1349 +1213     -    );
    1350 +1214     -    return;
    1351 +1215     -  }
9742 1352  1216     -
9743     -1217     -  // Toggle sidebar collapse/expand (keeps folder data)
9744     -1218     -  toggleSidebarBtn.addEventListener('click', () => {
9745     -1219     -    // Hide sidebar, show floating button
9746     -    1173 +  // Check if dragged to leftmost (auto-collapse)
9747     -    1174 +  if (newWidth < collapseThreshold) {
9748     -    1175 +    // Auto-collapse with smooth animation
9749     -    1176 +    fileBrowser.classList.remove('resizing');
9750     -1220 1177      fileBrowser.style.display = 'none';
9751     -1221 1178      floatingShowBtn.style.display = 'block';
9752     -1222     -  });
9753     -    1179 +    isResizing = false;
9754     -    1180 +    resizeHandle.classList.remove('dragging');
9755     -    1181 +    document.body.style.cursor = '';
9756     -    1182 +    document.body.style.userSelect = '';
9757     -    1183 +    return;
9758     -    1184 +  }
9759     -1223 1185  
9760     -1224     -  // Floating button - show sidebar
9761     -1225     -  floatingShowBtn.addEventListener('click', () => {
9762     -1226     -    // Show sidebar, hide floating button
9763     -1227     -    fileBrowser.style.display = 'flex';
9764     -1228     -    floatingShowBtn.style.display = 'none';
9765     -1229     -  });
9766     -    1186 +  // Constrain width
9767     -    1187 +  if (newWidth >= minWidth && newWidth <= maxWidth) {
9768     -    1188 +    sidebarWidth = newWidth;
9769     -    1189 +    fileBrowser.style.width = `${sidebarWidth}px`;
9770     -    1190 +  }
9771     -    1191 +});
9772     -1230 1192  
9773     -1231     -  // Close browser handler (clears all folder data)
9774     -1232     -  closeBrowserBtn.addEventListener('click', () => {
9775     -1233     -    // Hide everything AND clear data
9776     -1234     -    fileBrowser.style.display = 'none';
9777     -1235     -    floatingShowBtn.style.display = 'none';
9778     -1236     -    folderFiles = [];
9779     -1237     -    activeFileHandle = null;
9780     -1238     -  });
9781     -    1193 +document.addEventListener('mouseup', () => {
9782     -    1194 +  if (isResizing) {
9783     -    1195 +    isResizing = false;
9784     -    1196 +    fileBrowser.classList.remove('resizing');
9785     -    1197 +    resizeHandle.classList.remove('dragging');
9786     -    1198 +    document.body.style.cursor = '';
9787     -    1199 +    document.body.style.userSelect = '';
9788     -1239 1200  
9789     -1240     -  // Render file tree
9790     -1241     -  function renderFileTree(items, container = fileTree, indent = 0) {
9791     -1242     -    // Clear container on first render
9792     -1243     -    if (indent === 0) {
9793     -1244     -      container.innerHTML = '';
9794     -1245     -    }
9795     -    1201 +    // Save width
9796     -    1202 +    storageManager.set('sidebarWidth', sidebarWidth.toString());
9797     -    1203 +  }
9798     -    1204 +});
9799     -1246 1205  
9800     -1247     -    if (items.length === 0 && indent === 0) {
9801     -1248     -      container.innerHTML = `
9802     -    1206 +// Open folder handler
9803     -    1207 +openFolderBtn.addEventListener('click', async () => {
9804     -    1208 +  if (!folderBrowserService.isSupported()) {
9805     -    1209 +    alert(
9806     -    1210 +      'Folder browsing requires File System Access API.\n\n' +
9807     -    1211 +      'Please use Chrome 86+ or Edge 86+.\n\n' +
9808     -    1212 +      'Firefox and Safari are not currently supported.'
9809     -    1213 +    );
9810     -    1214 +    return;
9811     -    1215 +  }
9812     -    1216 +
9813     -    1217 +  const result = await folderBrowserService.openFolder();
9814     -    1218 +
9815     -    1219 +  if (result.cancelled) {
9816     -    1220 +    return; // User cancelled
9817     -    1221 +  }
9818     -    1222 +
9819     -    1223 +  if (!result.success) {
9820     -    1224 +    alert('Error opening folder: ' + result.error);
9821     -    1225 +    return;
9822     -    1226 +  }
9823     -    1227 +
9824     -    1228 +  // Store files
9825     -    1229 +  folderFiles = result.files;
9826     -    1230 +
9827     -    1231 +  // Show browser sidebar, hide floating button
9828     -    1232 +  fileBrowser.style.display = 'flex';
9829     -    1233 +  floatingShowBtn.style.display = 'none';
9830     -    1234 +
9831     -    1235 +  // Update UI
9832     -    1236 +  currentFolderNameEl.textContent = result.folderName;
9833     -    1237 +  fileCountEl.textContent = `${result.totalFiles} file${result.totalFiles !== 1 ? 's' : ''}`;
9834     -    1238 +
9835     -    1239 +  // Render tree
9836     -    1240 +  renderFileTree(result.files);
9837     -    1241 +
9838     -    1242 +  console.log(`‚úÖ Loaded ${result.totalFiles} markdown files from ${result.folderName}`);
9839     -    1243 +});
9840     -    1244 +
9841     -    1245 +// Toggle sidebar collapse/expand (keeps folder data)
9842     -    1246 +toggleSidebarBtn.addEventListener('click', () => {
9843     -    1247 +  // Hide sidebar, show floating button
9844     -    1248 +  fileBrowser.style.display = 'none';
9845     -    1249 +  floatingShowBtn.style.display = 'block';
9846     -    1250 +});
9847     -    1251 +
9848     -    1252 +// Floating button - show sidebar
9849     -    1253 +floatingShowBtn.addEventListener('click', () => {
9850     -    1254 +  // Show sidebar, hide floating button
9851     -    1255 +  fileBrowser.style.display = 'flex';
9852     -    1256 +  floatingShowBtn.style.display = 'none';
9853     -    1257 +});
9854     -    1258 +
9855     -    1259 +// Close browser handler (clears all folder data)
9856     -    1260 +closeBrowserBtn.addEventListener('click', () => {
9857     -    1261 +  // Hide everything AND clear data
9858     -    1262 +  fileBrowser.style.display = 'none';
9859     -    1263 +  floatingShowBtn.style.display = 'none';
9860     -    1264 +  folderFiles = [];
9861     -    1265 +  activeFileHandle = null;
9862     -    1266 +});
9863     -    1267 +
9864     -    1268 +// Render file tree
9865     -    1269 +function renderFileTree(items, container = fileTree, indent = 0) {
9866     -    1270 +  // Clear container on first render
9867     -    1271 +  if (indent === 0) {
9868     -    1272 +    container.innerHTML = '';
9869     -    1273 +  }
9870     -    1274 +
9871     -    1275 +  if (items.length === 0 && indent === 0) {
9872     -    1276 +    container.innerHTML = `
9873     -1249 1277          <div class="empty-state">
9874     -1250 1278            <p>üìÇ No markdown files found</p>
9875     -1251 1279            <p class="hint">This folder doesn't contain any .md files</p>
9876     -1252 1280          </div>
9877     -1253 1281        `;
9878     -1254     -      return;
9879     -1255     -    }
9880     -    1282 +    return;
9881     -    1283 +  }
9882     -1256 1284  
9883     -1257     -    items.forEach(item => {
9884     -1258     -      if (item.type === 'directory') {
9885     -1259     -        const folderDiv = createFolderElement(item, indent);
9886     -1260     -        container.appendChild(folderDiv);
9887     -    1285 +  items.forEach(item => {
9888     -    1286 +    if (item.type === 'directory') {
9889     -    1287 +      const folderDiv = createFolderElement(item, indent);
9890     -    1288 +      container.appendChild(folderDiv);
9891     -1261 1289  
9892     -1262     -        if (item.expanded && item.children) {
9893     -1263     -          const childContainer = document.createElement('div');
9894     -1264     -          childContainer.className = 'tree-children';
9895     -1265     -          renderFileTree(item.children, childContainer, indent + 1);
9896     -1266     -          container.appendChild(childContainer);
9897     -1267     -        }
9898     -1268     -      } else if (item.type === 'file') {
9899     -1269     -        const fileDiv = createFileElement(item, indent);
9900     -1270     -        container.appendChild(fileDiv);
9901     -    1290 +      if (item.expanded && item.children) {
9902     -    1291 +        const childContainer = document.createElement('div');
9903     -    1292 +        childContainer.className = 'tree-children';
9904     -    1293 +        renderFileTree(item.children, childContainer, indent + 1);
9905     -    1294 +        container.appendChild(childContainer);
9906     -1271 1295        }
9907     -1272     -    });
    1353 +1217     -  const result = await folderBrowserService.openFolder();
    1354 +1218     -
    1355 +1219     -  if (result.cancelled) {
    1356 +1220     -    return; // User cancelled
    1357 +1221     -  }
    1358 +1222     -
    1359 +1223     -  if (!result.success) {
    1360 +1224     -    alert('Error opening folder: ' + result.error);
    1361 +1225     -    return;
    1362 +1226     -  }
    1363 +1227     -
    1364 +1228     -  // Store files
    1365 +1229     -  folderFiles = result.files;
    1366 +1230     -
    1367 +1231     -  // Show browser sidebar, hide floating button
    1368 +1232     -  fileBrowser.style.display = 'flex';
    1369 +1233     -  floatingShowBtn.style.display = 'none';
    1370 +1234     -
    1371 +1235     -  // Update UI
    1372 +1236     -  currentFolderNameEl.textContent = result.folderName;
    1373 +1237     -  fileCountEl.textContent = `${result.totalFiles} file${result.totalFiles !== 1 ? 's' : ''}`;
    1374 +1238     -
    1375 +1239     -  // Render tree
    1376 +1240     -  renderFileTree(result.files);
    1377 +1241     -
    1378 +1242     -  console.log(`‚úÖ Loaded ${result.totalFiles} markdown files from ${result.folderName}`);
    1379 +1243     -});
    1380 +1244     -
    1381 +1245     -// Toggle sidebar collapse/expand (keeps folder data)
    1382 +1246     -toggleSidebarBtn.addEventListener('click', () => {
    1383 +1247     -  // Hide sidebar, show floating button
    1384 +1248     -  fileBrowser.style.display = 'none';
    1385 +1249     -  floatingShowBtn.style.display = 'block';
    1386 +1250     -});
    1387 +1251     -
    1388 +1252     -// Floating button - show sidebar
    1389 +1253     -floatingShowBtn.addEventListener('click', () => {
    1390 +1254     -  // Show sidebar, hide floating button
    1391 +1255     -  fileBrowser.style.display = 'flex';
    1392 +1256     -  floatingShowBtn.style.display = 'none';
    1393 +1257     -});
    1394 +1258     -
    1395 +1259     -// Close browser handler (clears all folder data)
    1396 +1260     -closeBrowserBtn.addEventListener('click', () => {
    1397 +1261     -  // Hide everything AND clear data
    1398 +1262     -  fileBrowser.style.display = 'none';
    1399 +1263     -  floatingShowBtn.style.display = 'none';
    1400 +1264     -  folderFiles = [];
    1401 +1265     -  activeFileHandle = null;
    1402 +1266     -});
    1403 +1267     -
    1404 +1268     -// Render file tree
    1405 +1269     -function renderFileTree(items, container = fileTree, indent = 0) {
    1406 +1270     -  // Clear container on first render
    1407 +1271     -  if (indent === 0) {
    1408 +1272     -    container.innerHTML = '';
9908 1409  1273     -  }
9909 1410  1274     -
9910     -1275     -  // Create folder element
9911     -1276     -  function createFolderElement(item, indent) {
9912     -1277     -    const div = document.createElement('div');
9913     -1278     -    div.className = 'tree-item folder';
9914     -1279     -    div.style.paddingLeft = indent * 20 + 12 + 'px';
9915     -1280     -
9916     -1281     -    const icon = item.expanded ? 'üìÇ' : 'üìÅ';
9917     -1282     -    const folderIcon = document.createElement('span');
9918     -1283     -    folderIcon.className = 'folder-icon';
9919     -1284     -    folderIcon.textContent = icon;
9920     -1285     -
9921     -1286     -    const folderName = document.createElement('span');
9922     -1287     -    folderName.className = 'folder-name';
9923     -1288     -    folderName.textContent = item.name;
    1411 +1275     -  if (items.length === 0 && indent === 0) {
    1412 +1276     -    container.innerHTML = `
    1413 +    1260 +    if (items.length === 0 && indent === 0) {
    1414 +    1261 +      container.innerHTML = `
    1415 +1277 1262          <div class="empty-state">
    1416 +1278 1263            <p>üìÇ No markdown files found</p>
    1417 +1279 1264            <p class="hint">This folder doesn't contain any .md files</p>
    1418 +1280 1265          </div>
    1419 +1281 1266        `;
    1420 +1282     -    return;
    1421 +1283     -  }
    1422 +1284     -
    1423 +1285     -  items.forEach(item => {
    1424 +1286     -    if (item.type === 'directory') {
    1425 +1287     -      const folderDiv = createFolderElement(item, indent);
    1426 +1288     -      container.appendChild(folderDiv);
9924 1427  1289     -
9925     -1290     -    const fileCount = document.createElement('span');
9926     -1291     -    fileCount.className = 'file-count';
9927     -1292     -    fileCount.textContent = item.fileCount;
9928     -1293     -
9929     -1294     -    div.appendChild(folderIcon);
9930     -1295     -    div.appendChild(folderName);
9931     -1296     -    div.appendChild(fileCount);
9932     -1297     -
9933     -1298     -    div.addEventListener('click', e => {
9934     -1299     -      e.stopPropagation();
9935     -1300     -      toggleFolder(item);
9936     -1301     -    });
9937     -1302     -
9938     -1303     -    return div;
9939     -1304     -  }
9940     -1305     -
9941     -1306     -  // Create file element
9942     -1307     -  function createFileElement(item, indent) {
9943     -1308     -    const div = document.createElement('div');
9944     -1309     -    div.className = 'tree-item file';
9945     -1310     -    div.style.paddingLeft = indent * 20 + 12 + 'px';
9946     -1311     -
9947     -1312     -    // Mark as active if this is the current file
9948     -1313     -    if (activeFileHandle === item.handle) {
9949     -1314     -      div.classList.add('active');
9950     -    1296 +    } else if (item.type === 'file') {
9951     -    1297 +      const fileDiv = createFileElement(item, indent);
9952     -    1298 +      container.appendChild(fileDiv);
9953     -1315 1299      }
9954     -    1300 +  });
9955     -    1301 +}
9956     -1316 1302  
9957     -1317     -    const fileIcon = document.createElement('span');
9958     -1318     -    fileIcon.className = 'file-icon';
9959     -1319     -    fileIcon.textContent = 'üìÑ';
9960     -    1303 +// Create folder element
9961     -    1304 +function createFolderElement(item, indent) {
9962     -    1305 +  const div = document.createElement('div');
9963     -    1306 +  div.className = 'tree-item folder';
9964     -    1307 +  div.style.paddingLeft = indent * 20 + 12 + 'px';
9965     -1320 1308  
9966     -1321     -    const fileName = document.createElement('span');
9967     -1322     -    fileName.className = 'file-name';
9968     -1323     -    fileName.textContent = item.name;
9969     -    1309 +  const icon = item.expanded ? 'üìÇ' : 'üìÅ';
9970     -    1310 +  const folderIcon = document.createElement('span');
9971     -    1311 +  folderIcon.className = 'folder-icon';
9972     -    1312 +  folderIcon.textContent = icon;
9973     -1324 1313  
9974     -1325     -    div.appendChild(fileIcon);
9975     -1326     -    div.appendChild(fileName);
9976     -    1314 +  const folderName = document.createElement('span');
9977     -    1315 +  folderName.className = 'folder-name';
9978     -    1316 +  folderName.textContent = item.name;
9979     -1327 1317  
9980     -1328     -    div.addEventListener('click', async e => {
9981     -1329     -      e.stopPropagation();
9982     -1330     -      await loadFileFromBrowser(item);
9983     -1331     -    });
9984     -    1318 +  const fileCount = document.createElement('span');
9985     -    1319 +  fileCount.className = 'file-count';
9986     -    1320 +  fileCount.textContent = item.fileCount;
9987     -1332 1321  
9988     -1333     -    return div;
9989     -    1322 +  div.appendChild(folderIcon);
9990     -    1323 +  div.appendChild(folderName);
9991     -    1324 +  div.appendChild(fileCount);
9992     -    1325 +
9993     -    1326 +  div.addEventListener('click', e => {
9994     -    1327 +    e.stopPropagation();
9995     -    1328 +    toggleFolder(item);
9996     -    1329 +  });
9997     -    1330 +
9998     -    1331 +  return div;
9999     -    1332 +}
10000     -    1333 +
10001     -    1334 +// Create file element
10002     -    1335 +function createFileElement(item, indent) {
10003     -    1336 +  const div = document.createElement('div');
10004     -    1337 +  div.className = 'tree-item file';
10005     -    1338 +  div.style.paddingLeft = indent * 20 + 12 + 'px';
10006     -    1339 +
10007     -    1340 +  // Mark as active if this is the current file
10008     -    1341 +  if (activeFileHandle === item.handle) {
10009     -    1342 +    div.classList.add('active');
10010     -1334 1343    }
10011     -1335 1344  
10012     -1336     -  // Toggle folder expand/collapse
10013     -1337     -  function toggleFolder(folder) {
10014     -1338     -    folder.expanded = !folder.expanded;
10015     -1339     -    renderFileTree(folderFiles);
10016     -    1345 +  const fileIcon = document.createElement('span');
10017     -    1346 +  fileIcon.className = 'file-icon';
10018     -    1347 +  fileIcon.textContent = 'üìÑ';
    1428 +1290     -      if (item.expanded && item.children) {
    1429 +1291     -        const childContainer = document.createElement('div');
    1430 +1292     -        childContainer.className = 'tree-children';
    1431 +1293     -        renderFileTree(item.children, childContainer, indent + 1);
    1432 +1294     -        container.appendChild(childContainer);
    1433 +1295     -      }
    1434 +1296     -    } else if (item.type === 'file') {
    1435 +1297     -      const fileDiv = createFileElement(item, indent);
    1436 +1298     -      container.appendChild(fileDiv);
    1437 +    1267 +      return;
    1438 +1299 1268      }
    1439 +1300     -  });
    1440 +1301     -}
    1441 +1302 1269  
    1442 +1303     -// Create folder element
    1443 +1304     -function createFolderElement(item, indent) {
    1444 +1305     -  const div = document.createElement('div');
    1445 +1306     -  div.className = 'tree-item folder';
    1446 +1307     -  div.style.paddingLeft = indent * 20 + 12 + 'px';
    1447 +    1270 +    items.forEach(item => {
    1448 +    1271 +      if (item.type === 'directory') {
    1449 +    1272 +        const folderDiv = createFolderElement(item, indent);
    1450 +    1273 +        container.appendChild(folderDiv);
    1451 +1308 1274  
    1452 +1309     -  const icon = item.expanded ? 'üìÇ' : 'üìÅ';
    1453 +1310     -  const folderIcon = document.createElement('span');
    1454 +1311     -  folderIcon.className = 'folder-icon';
    1455 +1312     -  folderIcon.textContent = icon;
    1456 +1313     -
    1457 +1314     -  const folderName = document.createElement('span');
    1458 +1315     -  folderName.className = 'folder-name';
    1459 +1316     -  folderName.textContent = item.name;
    1460 +1317     -
    1461 +1318     -  const fileCount = document.createElement('span');
    1462 +1319     -  fileCount.className = 'file-count';
    1463 +1320     -  fileCount.textContent = item.fileCount;
    1464 +1321     -
    1465 +1322     -  div.appendChild(folderIcon);
    1466 +1323     -  div.appendChild(folderName);
    1467 +1324     -  div.appendChild(fileCount);
    1468 +1325     -
    1469 +1326     -  div.addEventListener('click', e => {
    1470 +1327     -    e.stopPropagation();
    1471 +1328     -    toggleFolder(item);
    1472 +1329     -  });
    1473 +1330     -
    1474 +1331     -  return div;
    1475 +1332     -}
    1476 +1333     -
    1477 +1334     -// Create file element
    1478 +1335     -function createFileElement(item, indent) {
    1479 +1336     -  const div = document.createElement('div');
    1480 +1337     -  div.className = 'tree-item file';
    1481 +1338     -  div.style.paddingLeft = indent * 20 + 12 + 'px';
    1482 +1339     -
    1483 +1340     -  // Mark as active if this is the current file
    1484 +1341     -  if (activeFileHandle === item.handle) {
    1485 +1342     -    div.classList.add('active');
    1486 +    1275 +        if (item.expanded && item.children) {
    1487 +    1276 +          const childContainer = document.createElement('div');
    1488 +    1277 +          childContainer.className = 'tree-children';
    1489 +    1278 +          renderFileTree(item.children, childContainer, indent + 1);
    1490 +    1279 +          container.appendChild(childContainer);
    1491 +    1280 +        }
    1492 +    1281 +      } else if (item.type === 'file') {
    1493 +    1282 +        const fileDiv = createFileElement(item, indent);
    1494 +    1283 +        container.appendChild(fileDiv);
    1495 +    1284 +      }
    1496 +    1285 +    });
    1497 +1343 1286    }
    1498 +1344 1287  
    1499 +1345     -  const fileIcon = document.createElement('span');
    1500 +1346     -  fileIcon.className = 'file-icon';
    1501 +1347     -  fileIcon.textContent = 'üìÑ';
    1502 +    1288 +  // Create folder element
    1503 +    1289 +  function createFolderElement(item, indent) {
    1504 +    1290 +    const div = document.createElement('div');
    1505 +    1291 +    div.className = 'tree-item folder';
    1506 +    1292 +    div.style.paddingLeft = indent * 20 + 12 + 'px';
    1507 +1348 1293  
    1508 +1349     -  const fileName = document.createElement('span');
    1509 +1350     -  fileName.className = 'file-name';
    1510 +1351     -  fileName.textContent = item.name;
    1511 +    1294 +    const icon = item.expanded ? 'üìÇ' : 'üìÅ';
    1512 +    1295 +    const folderIcon = document.createElement('span');
    1513 +    1296 +    folderIcon.className = 'folder-icon';
    1514 +    1297 +    folderIcon.textContent = icon;
    1515 +1352 1298  
    1516 +1353     -  div.appendChild(fileIcon);
    1517 +1354     -  div.appendChild(fileName);
    1518 +    1299 +    const folderName = document.createElement('span');
    1519 +    1300 +    folderName.className = 'folder-name';
    1520 +    1301 +    folderName.textContent = item.name;
    1521 +1355 1302  
    1522 +1356     -  div.addEventListener('click', async e => {
    1523 +1357     -    e.stopPropagation();
    1524 +1358     -    await loadFileFromBrowser(item);
    1525 +1359     -  });
    1526 +    1303 +    const fileCount = document.createElement('span');
    1527 +    1304 +    fileCount.className = 'file-count';
    1528 +    1305 +    fileCount.textContent = item.fileCount;
    1529 +1360 1306  
    1530 +1361     -  return div;
    1531 +1362     -}
    1532 +    1307 +    div.appendChild(folderIcon);
    1533 +    1308 +    div.appendChild(folderName);
    1534 +    1309 +    div.appendChild(fileCount);
    1535 +1363 1310  
    1536 +1364     -// Toggle folder expand/collapse
    1537 +1365     -function toggleFolder(folder) {
    1538 +1366     -  folder.expanded = !folder.expanded;
    1539 +1367     -  renderFileTree(folderFiles);
    1540 +1368     -}
    1541 +    1311 +    div.addEventListener('click', e => {
    1542 +    1312 +      e.stopPropagation();
    1543 +    1313 +      toggleFolder(item);
    1544 +    1314 +    });
    1545 +1369 1315  
    1546 +1370     -// Load file from browser
    1547 +1371     -async function loadFileFromBrowser(fileItem) {
    1548 +1372     -  const result = await folderBrowserService.readFile(fileItem.handle);
    1549 +1373     -
    1550 +1374     -  if (!result.success) {
    1551 +1375     -    alert('Error loading file: ' + result.error);
    1552 +1376     -    return;
    1553 +    1316 +    return div;
    1554 +1377 1317    }
    1555 +1378 1318  
    1556 +1379     -  // Load content into editor
    1557 +1380     -  editor.value = result.content;
    1558 +    1319 +  // Create file element
    1559 +    1320 +  function createFileElement(item, indent) {
    1560 +    1321 +    const div = document.createElement('div');
    1561 +    1322 +    div.className = 'tree-item file';
    1562 +    1323 +    div.style.paddingLeft = indent * 20 + 12 + 'px';
    1563 +1381 1324  
    1564 +1382     -  // Mark as active file
    1565 +1383     -  activeFileHandle = fileItem.handle;
    1566 +    1325 +    // Mark as active if this is the current file
    1567 +    1326 +    if (activeFileHandle === item.handle) {
    1568 +    1327 +      div.classList.add('active');
    1569 +    1328 +    }
    1570 +1384 1329  
    1571 +1385     -  // Re-render tree to update active state
    1572 +1386     -  renderFileTree(folderFiles);
    1573 +    1330 +    const fileIcon = document.createElement('span');
    1574 +    1331 +    fileIcon.className = 'file-icon';
    1575 +    1332 +    fileIcon.textContent = 'üìÑ';
    1576 +1387 1333  
    1577 +1388     -  // Render markdown
    1578 +1389     -  renderMarkdown();
    1579 +    1334 +    const fileName = document.createElement('span');
    1580 +    1335 +    fileName.className = 'file-name';
    1581 +    1336 +    fileName.textContent = item.name;
    1582 +1390 1337  
    1583 +1391     -  console.log(`‚úÖ Loaded file: ${fileItem.name} (${result.size} bytes)`);
    1584 +1392     -}
    1585 +    1338 +    div.appendChild(fileIcon);
    1586 +    1339 +    div.appendChild(fileName);
    1587 +1393 1340  
    1588 +1394     -// Expose renderMarkdown globally for theme changes
    1589 +1395     -globalRenderMarkdown = renderMarkdown;
    1590 +    1341 +    div.addEventListener('click', async e => {
    1591 +    1342 +      e.stopPropagation();
    1592 +    1343 +      await loadFileFromBrowser(item);
    1593 +    1344 +    });
    1594 +    1345 +
    1595 +    1346 +    return div;
    1596 +    1347 +  }
10019 1597      1348 +
10020     -    1349 +  const fileName = document.createElement('span');
10021     -    1350 +  fileName.className = 'file-name';
10022     -    1351 +  fileName.textContent = item.name;
10023     -    1352 +
10024     -    1353 +  div.appendChild(fileIcon);
10025     -    1354 +  div.appendChild(fileName);
10026     -    1355 +
10027     -    1356 +  div.addEventListener('click', async e => {
10028     -    1357 +    e.stopPropagation();
10029     -    1358 +    await loadFileFromBrowser(item);
10030     -    1359 +  });
10031     -    1360 +
10032     -    1361 +  return div;
10033     -    1362 +}
    1598 +    1349 +  // Toggle folder expand/collapse
    1599 +    1350 +  function toggleFolder(folder) {
    1600 +    1351 +    folder.expanded = !folder.expanded;
    1601 +    1352 +    renderFileTree(folderFiles);
    1602 +    1353 +  }
    1603 +    1354 +
    1604 +    1355 +  // Load file from browser
    1605 +    1356 +  async function loadFileFromBrowser(fileItem) {
    1606 +    1357 +    const result = await folderBrowserService.readFile(fileItem.handle);
    1607 +    1358 +
    1608 +    1359 +    if (!result.success) {
    1609 +    1360 +      alert('Error loading file: ' + result.error);
    1610 +    1361 +      return;
    1611 +    1362 +    }
10034 1612      1363 +
10035     -    1364 +// Toggle folder expand/collapse
10036     -    1365 +function toggleFolder(folder) {
10037     -    1366 +  folder.expanded = !folder.expanded;
10038     -    1367 +  renderFileTree(folderFiles);
10039     -    1368 +}
    1613 +    1364 +    // Load content into editor
    1614 +    1365 +    editor.value = result.content;
    1615 +    1366 +
    1616 +    1367 +    // Mark as active file
    1617 +    1368 +    activeFileHandle = fileItem.handle;
10040 1618      1369 +
10041     -    1370 +// Load file from browser
10042     -    1371 +async function loadFileFromBrowser(fileItem) {
10043     -    1372 +  const result = await folderBrowserService.readFile(fileItem.handle);
10044     -    1373 +
10045     -    1374 +  if (!result.success) {
10046     -    1375 +    alert('Error loading file: ' + result.error);
10047     -    1376 +    return;
10048     -1340 1377    }
10049     -1341 1378  
10050     -1342     -  // Load file from browser
10051     -1343     -  async function loadFileFromBrowser(fileItem) {
10052     -1344     -    const result = await folderBrowserService.readFile(fileItem.handle);
10053     -    1379 +  // Load content into editor
10054     -    1380 +  editor.value = result.content;
10055     -1345 1381  
10056     -1346     -    if (!result.success) {
10057     -1347     -      alert('Error loading file: ' + result.error);
10058     -1348     -      return;
10059     -1349     -    }
10060     -    1382 +  // Mark as active file
10061     -    1383 +  activeFileHandle = fileItem.handle;
10062     -1350 1384  
10063     -1351     -    // Load content into editor
10064     -1352     -    editor.value = result.content;
10065     -    1385 +  // Re-render tree to update active state
10066     -    1386 +  renderFileTree(folderFiles);
10067     -1353 1387  
10068     -1354     -    // Mark as active file
10069     -1355     -    activeFileHandle = fileItem.handle;
10070     -    1388 +  // Render markdown
10071     -    1389 +  renderMarkdown();
10072     -1356 1390  
10073     -1357     -    // Re-render tree to update active state
10074     -1358     -    renderFileTree(folderFiles);
10075     -    1391 +  console.log(`‚úÖ Loaded file: ${fileItem.name} (${result.size} bytes)`);
10076     -    1392 +}
10077     -1359 1393  
10078     -1360     -    // Render markdown
10079     -1361     -    renderMarkdown();
10080     -1362     -
10081     -1363     -    console.log(`‚úÖ Loaded file: ${fileItem.name} (${result.size} bytes)`);
10082     -1364     -  }
10083     -1365     -
10084     -1366     -  // Expose renderMarkdown globally for theme changes
10085     -1367     -  globalRenderMarkdown = renderMarkdown;
10086     -    1394 +// Expose renderMarkdown globally for theme changes
10087     -    1395 +globalRenderMarkdown = renderMarkdown;
10088     -1368 1396  
10089     -1369 1397    // DON'T render immediately - wait for theme to load
10090     -1370 1398    // renderMarkdown will be called after theme loads above
10091     -1371 1399  
    1619 +    1370 +    // Re-render tree to update active state
    1620 +    1371 +    renderFileTree(folderFiles);
    1621 +    1372 +
    1622 +    1373 +    // Render markdown
    1623 +    1374 +    renderMarkdown();
    1624 +    1375 +
    1625 +    1376 +    console.log(`‚úÖ Loaded file: ${fileItem.name} (${result.size} bytes)`);
    1626 +    1377 +  }
    1627 +    1378 +
    1628 +    1379 +  // Expose renderMarkdown globally for theme changes
    1629 +    1380 +  globalRenderMarkdown = renderMarkdown;
    1630 +1396 1381  
    1631 +1397 1382    // DON'T render immediately - wait for theme to load
    1632 +1398 1383    // renderMarkdown will be called after theme loads above
    1633 +1399 1384  
10092 1634  
10093 1635  ```
10094 1636  
@@ -10134,4 +1676,4 @@ Please provide specific feedback on:
10134 1676  
10135 1677  ---
10136 1678  *Generated by AI Visual Code Review v2.0 - Unified Export Script*
10137     -*Files processed: 5/5 | Errors: 0 | Generated: 2025-12-09T01:34:12.899Z*
    1679 +*Files processed: 1/1 | Errors: 0 | Generated: 2025-12-09T01:35:49.634Z*
10138 1680  

```


### ‚ú® `codebase_audit/migration_analysis.md` **[ADDED]**

**Status:** ‚úÖ **NEW FILE** - This file has been newly created

**Type:** Documentation üìñ

```diff
@@ -0,0 +1,21 @@
      1 +# ‚öñÔ∏è Impact Analysis: CDN to NPM Migration
      2 +
      3 +## üöÄ Pros (Why we should do it)
      4 +1.  **Offline Capability (Major)**: The app will work without internet. Currently, if you are on a plane or have spotty Wi-Fi, the app is broken.
      5 +2.  **Reliability**: CDNs can go down (rare, but fatal). NPM packages are saved in your `node_modules` and bundled into your final `dist` folder.
      6 +3.  **Speed**: Instead of the browser opening 6 parallel connections to `cdn.jsdelivr.net` (costing DNS + SSL time for each), Vite bundles everything into a single efficient file.
      7 +4.  **Security**: You can run `npm audit` to check for specific vulnerability in your dependencies. CDN links are opaque.
      8 +5.  **Better Coding Experience**: Importing modules (`import { parse } from 'marked'`) gives you **Autocomplete** and **Type Checking** in VS Code.
      9 +
     10 +## ‚ö†Ô∏è Cons & Risks (What could go wrong)
     11 +1.  **Initial Breakage**: The current code relies on global variables (e.g., `window.marked`). We will need to refactor `script.js` to use `import` variables.
     12 +2.  **Prism Autoloader Complexity**: PrismJS's "Download languages on the fly" feature hates bundlers. It tries to fetch files from a URL. We will need to configure Vite to copy language files to the `dist` folder manually, or import common languages explicitly.
     13 +3.  **Local "Start" Requirement**: You won't be able to just "Double Click index.html" to run the app anymore. You **must** use a local server (`npm run dev` or `npm run preview`). *Note: This is already true for ES Modules usually.*
     14 +
     15 +## ‚ùì Will it become outdated?
     16 +**No.** In fact, the opposite.
     17 +*   **Current State:** Your HTML hardcodes `marked@11.0.0`. It is *already* outdated and will stay that way forever until you manually edit the HTML string.
     18 +*   **NPM State:** You run `npm update` and everything upgrades to the latest stable versions automatically. You have **more control**.
     19 +
     20 +## üõ°Ô∏è Verdict
     21 +**Proceed.** The "Prism Autoloader" risk is the only technical hurdle, but solvable. The benefits for an "Enterprise Grade" app (Security, Offline support) appear to outweigh the configuration effort.
     22  

```


### üìÑ `index.html`

**Type:** HTML Template üåê

```diff
@@ -5,41 +5,6 @@
  5   5      <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  6   6      <title>Markdown Viewer Pro</title>
  7   7  
  8     -    <!-- External Libraries -->
  9     -    <script src="https://cdn.jsdelivr.net/npm/marked@11.0.0/marked.min.js"></script>
 10     -    <script src="https://cdn.jsdelivr.net/npm/marked-footnote@1.2.2/dist/index.umd.min.js"></script>
 11     -    <!-- Prism.js with Autoloader Plugin - Enterprise-grade solution -->
 12     -    <!-- Supports 200+ languages with automatic dependency resolution -->
 13     -    <script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/prism.min.js"></script>
 14     -    <script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/plugins/autoloader/prism-autoloader.min.js"></script>
 15     -    <script src="https://cdn.jsdelivr.net/npm/mermaid@11.4.0/dist/mermaid.min.js" defer></script>
 16     -    <script
 17     -      src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.10.1/html2pdf.bundle.min.js"
 18     -      defer
 19     -    ></script>
 20     -    <link
 21     -      rel="stylesheet"
 22     -      href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism-tomorrow.min.css"
 23     -    />
 24     -    <!-- KaTeX for Math Formula Rendering -->
 25     -    <link
 26     -      rel="stylesheet"
 27     -      href="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/katex.min.css"
 28     -      integrity="sha384-n8MVd4RsNIU0tAv4ct0nTaAbDJwPJzDEaqSD1odI+WdtXRGWt2kTvGFasHpSy3SV"
 29     -      crossorigin="anonymous"
 30     -    />
 31     -    <script
 32     -      src="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/katex.min.js"
 33     -      integrity="sha384-XjKyOOlGwcjNTAIQHIpgOno0Hl1YQqzUOEleOLALmuqehneUG+vnGctmUb0ZY0l8"
 34     -      crossorigin="anonymous"
 35     -    ></script>
 36     -    <!-- KaTeX Auto-Render for LaTeX Environments -->
 37     -    <script
 38     -      src="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/contrib/auto-render.min.js"
 39     -      integrity="sha384-+VBxd3r6XgURycqtZ117nYw44OOcIax56Z4dCRWbxyPt0Koah1uHoK0o4+/RRE05"
 40     -      crossorigin="anonymous"
 41     -    ></script>
 42     -
 43   8      <!-- Main Styles -->
 44   9      <link rel="stylesheet" href="style.css" />
 45  10  
 46  11  

```


### üìÑ `package-lock.json`

**Type:** Configuration/Data File üìã

```diff
@@ -10,7 +10,12 @@
 10  10        "license": "MIT",
 11  11        "dependencies": {
 12  12          "dompurify": "3.3.1",
 13     -        "marked-footnote": "1.4.0"
     13 +        "html2pdf.js": "0.12.1",
     14 +        "katex": "0.16.27",
     15 +        "marked": "17.0.1",
     16 +        "marked-footnote": "1.4.0",
     17 +        "mermaid": "11.12.2",
     18 +        "prismjs": "1.30.0"
 14  19        },
 15  20        "devDependencies": {
 16  21          "@vitest/coverage-v8": "4.0.8",
@@ -31,6 +36,28 @@
 31  36        "dev": true,
 32  37        "license": "MIT"
 33  38      },
     39 +    "node_modules/@antfu/install-pkg": {
     40 +      "version": "1.1.0",
     41 +      "resolved": "https://registry.npmjs.org/@antfu/install-pkg/-/install-pkg-1.1.0.tgz",
     42 +      "integrity": "sha512-MGQsmw10ZyI+EJo45CdSER4zEb+p31LpDAFp2Z3gkSd1yqVZGi0Ebx++YTEMonJy4oChEMLsxZ64j8FH6sSqtQ==",
     43 +      "license": "MIT",
     44 +      "dependencies": {
     45 +        "package-manager-detector": "^1.3.0",
     46 +        "tinyexec": "^1.0.1"
     47 +      },
     48 +      "funding": {
     49 +        "url": "https://github.com/sponsors/antfu"
     50 +      }
     51 +    },
     52 +    "node_modules/@antfu/install-pkg/node_modules/tinyexec": {
     53 +      "version": "1.0.2",
     54 +      "resolved": "https://registry.npmjs.org/tinyexec/-/tinyexec-1.0.2.tgz",
     55 +      "integrity": "sha512-W/KYk+NFhkmsYpuHq5JykngiOCnxeVL8v8dFnqxSD8qEEdRfXk1SDM6JzNqcERbcGYj9tMrDQBYV9cjgnunFIg==",
     56 +      "license": "MIT",
     57 +      "engines": {
     58 +        "node": ">=18"
     59 +      }
     60 +    },
 34  61      "node_modules/@asamuzakjp/css-color": {
 35  62        "version": "4.0.5",
 36  63        "resolved": "https://registry.npmjs.org/@asamuzakjp/css-color/-/css-color-4.0.5.tgz",
@@ -102,6 +129,15 @@
102 129          "node": ">=6.0.0"
103 130        }
104 131      },
    132 +    "node_modules/@babel/runtime": {
    133 +      "version": "7.28.4",
    134 +      "resolved": "https://registry.npmjs.org/@babel/runtime/-/runtime-7.28.4.tgz",
    135 +      "integrity": "sha512-Q/N6JNWvIvPnLDvjlE1OUBLPQHH6l3CltCEsHIujp45zQUSSh8K+gHnaEX45yAT1nyngnINhvWtzN+Nb9D8RAQ==",
    136 +      "license": "MIT",
    137 +      "engines": {
    138 +        "node": ">=6.9.0"
    139 +      }
    140 +    },
105 141      "node_modules/@babel/types": {
106 142        "version": "7.28.5",
107 143        "resolved": "https://registry.npmjs.org/@babel/types/-/types-7.28.5.tgz",
@@ -126,6 +162,51 @@
126 162          "node": ">=18"
127 163        }
128 164      },
    165 +    "node_modules/@braintree/sanitize-url": {
    166 +      "version": "7.1.1",
    167 +      "resolved": "https://registry.npmjs.org/@braintree/sanitize-url/-/sanitize-url-7.1.1.tgz",
    168 +      "integrity": "sha512-i1L7noDNxtFyL5DmZafWy1wRVhGehQmzZaz1HiN5e7iylJMSZR7ekOV7NsIqa5qBldlLrsKv4HbgFUVlQrz8Mw==",
    169 +      "license": "MIT"
    170 +    },
    171 +    "node_modules/@chevrotain/cst-dts-gen": {
    172 +      "version": "11.0.3",
    173 +      "resolved": "https://registry.npmjs.org/@chevrotain/cst-dts-gen/-/cst-dts-gen-11.0.3.tgz",
    174 +      "integrity": "sha512-BvIKpRLeS/8UbfxXxgC33xOumsacaeCKAjAeLyOn7Pcp95HiRbrpl14S+9vaZLolnbssPIUuiUd8IvgkRyt6NQ==",
    175 +      "license": "Apache-2.0",
    176 +      "dependencies": {
    177 +        "@chevrotain/gast": "11.0.3",
    178 +        "@chevrotain/types": "11.0.3",
    179 +        "lodash-es": "4.17.21"
    180 +      }
    181 +    },
    182 +    "node_modules/@chevrotain/gast": {
    183 +      "version": "11.0.3",
    184 +      "resolved": "https://registry.npmjs.org/@chevrotain/gast/-/gast-11.0.3.tgz",
    185 +      "integrity": "sha512-+qNfcoNk70PyS/uxmj3li5NiECO+2YKZZQMbmjTqRI3Qchu8Hig/Q9vgkHpI3alNjr7M+a2St5pw5w5F6NL5/Q==",
    186 +      "license": "Apache-2.0",
    187 +      "dependencies": {
    188 +        "@chevrotain/types": "11.0.3",
    189 +        "lodash-es": "4.17.21"
    190 +      }
    191 +    },
    192 +    "node_modules/@chevrotain/regexp-to-ast": {
    193 +      "version": "11.0.3",
    194 +      "resolved": "https://registry.npmjs.org/@chevrotain/regexp-to-ast/-/regexp-to-ast-11.0.3.tgz",
    195 +      "integrity": "sha512-1fMHaBZxLFvWI067AVbGJav1eRY7N8DDvYCTwGBiE/ytKBgP8azTdgyrKyWZ9Mfh09eHWb5PgTSO8wi7U824RA==",
    196 +      "license": "Apache-2.0"
    197 +    },
    198 +    "node_modules/@chevrotain/types": {
    199 +      "version": "11.0.3",
    200 +      "resolved": "https://registry.npmjs.org/@chevrotain/types/-/types-11.0.3.tgz",
    201 +      "integrity": "sha512-gsiM3G8b58kZC2HaWR50gu6Y1440cHiJ+i3JUvcp/35JchYejb2+5MVeJK0iKThYpAa/P2PYFV4hoi44HD+aHQ==",
    202 +      "license": "Apache-2.0"
    203 +    },
    204 +    "node_modules/@chevrotain/utils": {
    205 +      "version": "11.0.3",
    206 +      "resolved": "https://registry.npmjs.org/@chevrotain/utils/-/utils-11.0.3.tgz",
    207 +      "integrity": "sha512-YslZMgtJUyuMbZ+aKvfF3x1f5liK4mWNxghFRv7jqRR9C3R3fAOGTTKvxXDa2Y1s9zSbcpuO0cAxDYsc9SrXoQ==",
    208 +      "license": "Apache-2.0"
    209 +    },
129 210      "node_modules/@csstools/color-helpers": {
130 211        "version": "5.1.0",
131 212        "resolved": "https://registry.npmjs.org/@csstools/color-helpers/-/color-helpers-5.1.0.tgz",
@@ -899,6 +980,23 @@
899 980          "url": "https://github.com/sponsors/nzakas"
900 981        }
901 982      },
    983 +    "node_modules/@iconify/types": {
    984 +      "version": "2.0.0",
    985 +      "resolved": "https://registry.npmjs.org/@iconify/types/-/types-2.0.0.tgz",
    986 +      "integrity": "sha512-+wluvCrRhXrhyOmRDJ3q8mux9JkKy5SJ/v8ol2tu4FVjyYvtEzkc/3pK15ET6RKg4b4w4BmTk1+gsCUhf21Ykg==",
    987 +      "license": "MIT"
    988 +    },
    989 +    "node_modules/@iconify/utils": {
    990 +      "version": "3.1.0",
    991 +      "resolved": "https://registry.npmjs.org/@iconify/utils/-/utils-3.1.0.tgz",
    992 +      "integrity": "sha512-Zlzem1ZXhI1iHeeERabLNzBHdOa4VhQbqAcOQaMKuTuyZCpwKbC2R4Dd0Zo3g9EAc+Y4fiarO8HIHRAth7+skw==",
    993 +      "license": "MIT",
    994 +      "dependencies": {
    995 +        "@antfu/install-pkg": "^1.1.0",
    996 +        "@iconify/types": "^2.0.0",
    997 +        "mlly": "^1.8.0"
    998 +      }
    999 +    },
902 1000      "node_modules/@jridgewell/resolve-uri": {
903 1001        "version": "3.1.2",
904 1002        "resolved": "https://registry.npmjs.org/@jridgewell/resolve-uri/-/resolve-uri-3.1.2.tgz",
@@ -927,6 +1025,15 @@
927 1025          "@jridgewell/sourcemap-codec": "^1.4.14"
928 1026        }
929 1027      },
    1028 +    "node_modules/@mermaid-js/parser": {
    1029 +      "version": "0.6.3",
    1030 +      "resolved": "https://registry.npmjs.org/@mermaid-js/parser/-/parser-0.6.3.tgz",
    1031 +      "integrity": "sha512-lnjOhe7zyHjc+If7yT4zoedx2vo4sHaTmtkl1+or8BRTnCtDmcTpAjpzDSfCZrshM5bCoz0GyidzadJAH1xobA==",
    1032 +      "license": "MIT",
    1033 +      "dependencies": {
    1034 +        "langium": "3.3.1"
    1035 +      }
    1036 +    },
930 1037      "node_modules/@polka/url": {
931 1038        "version": "1.0.0-next.29",
932 1039        "resolved": "https://registry.npmjs.org/@polka/url/-/url-1.0.0-next.29.tgz",
@@ -1260,6 +1367,259 @@
1260 1367          "assertion-error": "^2.0.1"
1261 1368        }
1262 1369      },
    1370 +    "node_modules/@types/d3": {
    1371 +      "version": "7.4.3",
    1372 +      "resolved": "https://registry.npmjs.org/@types/d3/-/d3-7.4.3.tgz",
    1373 +      "integrity": "sha512-lZXZ9ckh5R8uiFVt8ogUNf+pIrK4EsWrx2Np75WvF/eTpJ0FMHNhjXk8CKEx/+gpHbNQyJWehbFaTvqmHWB3ww==",
    1374 +      "license": "MIT",
    1375 +      "dependencies": {
    1376 +        "@types/d3-array": "*",
    1377 +        "@types/d3-axis": "*",
    1378 +        "@types/d3-brush": "*",
    1379 +        "@types/d3-chord": "*",
    1380 +        "@types/d3-color": "*",
    1381 +        "@types/d3-contour": "*",
    1382 +        "@types/d3-delaunay": "*",
    1383 +        "@types/d3-dispatch": "*",
    1384 +        "@types/d3-drag": "*",
    1385 +        "@types/d3-dsv": "*",
    1386 +        "@types/d3-ease": "*",
    1387 +        "@types/d3-fetch": "*",
    1388 +        "@types/d3-force": "*",
    1389 +        "@types/d3-format": "*",
    1390 +        "@types/d3-geo": "*",
    1391 +        "@types/d3-hierarchy": "*",
    1392 +        "@types/d3-interpolate": "*",
    1393 +        "@types/d3-path": "*",
    1394 +        "@types/d3-polygon": "*",
    1395 +        "@types/d3-quadtree": "*",
    1396 +        "@types/d3-random": "*",
    1397 +        "@types/d3-scale": "*",
    1398 +        "@types/d3-scale-chromatic": "*",
    1399 +        "@types/d3-selection": "*",
    1400 +        "@types/d3-shape": "*",
    1401 +        "@types/d3-time": "*",
    1402 +        "@types/d3-time-format": "*",
    1403 +        "@types/d3-timer": "*",
    1404 +        "@types/d3-transition": "*",
    1405 +        "@types/d3-zoom": "*"
    1406 +      }
    1407 +    },
    1408 +    "node_modules/@types/d3-array": {
    1409 +      "version": "3.2.2",
    1410 +      "resolved": "https://registry.npmjs.org/@types/d3-array/-/d3-array-3.2.2.tgz",
    1411 +      "integrity": "sha512-hOLWVbm7uRza0BYXpIIW5pxfrKe0W+D5lrFiAEYR+pb6w3N2SwSMaJbXdUfSEv+dT4MfHBLtn5js0LAWaO6otw==",
    1412 +      "license": "MIT"
    1413 +    },
    1414 +    "node_modules/@types/d3-axis": {
    1415 +      "version": "3.0.6",
    1416 +      "resolved": "https://registry.npmjs.org/@types/d3-axis/-/d3-axis-3.0.6.tgz",
    1417 +      "integrity": "sha512-pYeijfZuBd87T0hGn0FO1vQ/cgLk6E1ALJjfkC0oJ8cbwkZl3TpgS8bVBLZN+2jjGgg38epgxb2zmoGtSfvgMw==",
    1418 +      "license": "MIT",
    1419 +      "dependencies": {
    1420 +        "@types/d3-selection": "*"
    1421 +      }
    1422 +    },
    1423 +    "node_modules/@types/d3-brush": {
    1424 +      "version": "3.0.6",
    1425 +      "resolved": "https://registry.npmjs.org/@types/d3-brush/-/d3-brush-3.0.6.tgz",
    1426 +      "integrity": "sha512-nH60IZNNxEcrh6L1ZSMNA28rj27ut/2ZmI3r96Zd+1jrZD++zD3LsMIjWlvg4AYrHn/Pqz4CF3veCxGjtbqt7A==",
    1427 +      "license": "MIT",
    1428 +      "dependencies": {
    1429 +        "@types/d3-selection": "*"
    1430 +      }
    1431 +    },
    1432 +    "node_modules/@types/d3-chord": {
    1433 +      "version": "3.0.6",
    1434 +      "resolved": "https://registry.npmjs.org/@types/d3-chord/-/d3-chord-3.0.6.tgz",
    1435 +      "integrity": "sha512-LFYWWd8nwfwEmTZG9PfQxd17HbNPksHBiJHaKuY1XeqscXacsS2tyoo6OdRsjf+NQYeB6XrNL3a25E3gH69lcg==",
    1436 +      "license": "MIT"
    1437 +    },
    1438 +    "node_modules/@types/d3-color": {
    1439 +      "version": "3.1.3",
    1440 +      "resolved": "https://registry.npmjs.org/@types/d3-color/-/d3-color-3.1.3.tgz",
    1441 +      "integrity": "sha512-iO90scth9WAbmgv7ogoq57O9YpKmFBbmoEoCHDB2xMBY0+/KVrqAaCDyCE16dUspeOvIxFFRI+0sEtqDqy2b4A==",
    1442 +      "license": "MIT"
    1443 +    },
    1444 +    "node_modules/@types/d3-contour": {
    1445 +      "version": "3.0.6",
    1446 +      "resolved": "https://registry.npmjs.org/@types/d3-contour/-/d3-contour-3.0.6.tgz",
    1447 +      "integrity": "sha512-BjzLgXGnCWjUSYGfH1cpdo41/hgdWETu4YxpezoztawmqsvCeep+8QGfiY6YbDvfgHz/DkjeIkkZVJavB4a3rg==",
    1448 +      "license": "MIT",
    1449 +      "dependencies": {
    1450 +        "@types/d3-array": "*",
    1451 +        "@types/geojson": "*"
    1452 +      }
    1453 +    },
    1454 +    "node_modules/@types/d3-delaunay": {
    1455 +      "version": "6.0.4",
    1456 +      "resolved": "https://registry.npmjs.org/@types/d3-delaunay/-/d3-delaunay-6.0.4.tgz",
    1457 +      "integrity": "sha512-ZMaSKu4THYCU6sV64Lhg6qjf1orxBthaC161plr5KuPHo3CNm8DTHiLw/5Eq2b6TsNP0W0iJrUOFscY6Q450Hw==",
    1458 +      "license": "MIT"
    1459 +    },
    1460 +    "node_modules/@types/d3-dispatch": {
    1461 +      "version": "3.0.7",
    1462 +      "resolved": "https://registry.npmjs.org/@types/d3-dispatch/-/d3-dispatch-3.0.7.tgz",
    1463 +      "integrity": "sha512-5o9OIAdKkhN1QItV2oqaE5KMIiXAvDWBDPrD85e58Qlz1c1kI/J0NcqbEG88CoTwJrYe7ntUCVfeUl2UJKbWgA==",
    1464 +      "license": "MIT"
    1465 +    },
    1466 +    "node_modules/@types/d3-drag": {
    1467 +      "version": "3.0.7",
    1468 +      "resolved": "https://registry.npmjs.org/@types/d3-drag/-/d3-drag-3.0.7.tgz",
    1469 +      "integrity": "sha512-HE3jVKlzU9AaMazNufooRJ5ZpWmLIoc90A37WU2JMmeq28w1FQqCZswHZ3xR+SuxYftzHq6WU6KJHvqxKzTxxQ==",
    1470 +      "license": "MIT",
    1471 +      "dependencies": {
    1472 +        "@types/d3-selection": "*"
    1473 +      }
    1474 +    },
    1475 +    "node_modules/@types/d3-dsv": {
    1476 +      "version": "3.0.7",
    1477 +      "resolved": "https://registry.npmjs.org/@types/d3-dsv/-/d3-dsv-3.0.7.tgz",
    1478 +      "integrity": "sha512-n6QBF9/+XASqcKK6waudgL0pf/S5XHPPI8APyMLLUHd8NqouBGLsU8MgtO7NINGtPBtk9Kko/W4ea0oAspwh9g==",
    1479 +      "license": "MIT"
    1480 +    },
    1481 +    "node_modules/@types/d3-ease": {
    1482 +      "version": "3.0.2",
    1483 +      "resolved": "https://registry.npmjs.org/@types/d3-ease/-/d3-ease-3.0.2.tgz",
    1484 +      "integrity": "sha512-NcV1JjO5oDzoK26oMzbILE6HW7uVXOHLQvHshBUW4UMdZGfiY6v5BeQwh9a9tCzv+CeefZQHJt5SRgK154RtiA==",
    1485 +      "license": "MIT"
    1486 +    },
    1487 +    "node_modules/@types/d3-fetch": {
    1488 +      "version": "3.0.7",
    1489 +      "resolved": "https://registry.npmjs.org/@types/d3-fetch/-/d3-fetch-3.0.7.tgz",
    1490 +      "integrity": "sha512-fTAfNmxSb9SOWNB9IoG5c8Hg6R+AzUHDRlsXsDZsNp6sxAEOP0tkP3gKkNSO/qmHPoBFTxNrjDprVHDQDvo5aA==",
    1491 +      "license": "MIT",
    1492 +      "dependencies": {
    1493 +        "@types/d3-dsv": "*"
    1494 +      }
    1495 +    },
    1496 +    "node_modules/@types/d3-force": {
    1497 +      "version": "3.0.10",
    1498 +      "resolved": "https://registry.npmjs.org/@types/d3-force/-/d3-force-3.0.10.tgz",
    1499 +      "integrity": "sha512-ZYeSaCF3p73RdOKcjj+swRlZfnYpK1EbaDiYICEEp5Q6sUiqFaFQ9qgoshp5CzIyyb/yD09kD9o2zEltCexlgw==",
    1500 +      "license": "MIT"
    1501 +    },
    1502 +    "node_modules/@types/d3-format": {
    1503 +      "version": "3.0.4",
    1504 +      "resolved": "https://registry.npmjs.org/@types/d3-format/-/d3-format-3.0.4.tgz",
    1505 +      "integrity": "sha512-fALi2aI6shfg7vM5KiR1wNJnZ7r6UuggVqtDA+xiEdPZQwy/trcQaHnwShLuLdta2rTymCNpxYTiMZX/e09F4g==",
    1506 +      "license": "MIT"
    1507 +    },
    1508 +    "node_modules/@types/d3-geo": {
    1509 +      "version": "3.1.0",
    1510 +      "resolved": "https://registry.npmjs.org/@types/d3-geo/-/d3-geo-3.1.0.tgz",
    1511 +      "integrity": "sha512-856sckF0oP/diXtS4jNsiQw/UuK5fQG8l/a9VVLeSouf1/PPbBE1i1W852zVwKwYCBkFJJB7nCFTbk6UMEXBOQ==",
    1512 +      "license": "MIT",
    1513 +      "dependencies": {
    1514 +        "@types/geojson": "*"
    1515 +      }
    1516 +    },
    1517 +    "node_modules/@types/d3-hierarchy": {
    1518 +      "version": "3.1.7",
    1519 +      "resolved": "https://registry.npmjs.org/@types/d3-hierarchy/-/d3-hierarchy-3.1.7.tgz",
    1520 +      "integrity": "sha512-tJFtNoYBtRtkNysX1Xq4sxtjK8YgoWUNpIiUee0/jHGRwqvzYxkq0hGVbbOGSz+JgFxxRu4K8nb3YpG3CMARtg==",
    1521 +      "license": "MIT"
    1522 +    },
    1523 +    "node_modules/@types/d3-interpolate": {
    1524 +      "version": "3.0.4",
    1525 +      "resolved": "https://registry.npmjs.org/@types/d3-interpolate/-/d3-interpolate-3.0.4.tgz",
    1526 +      "integrity": "sha512-mgLPETlrpVV1YRJIglr4Ez47g7Yxjl1lj7YKsiMCb27VJH9W8NVM6Bb9d8kkpG/uAQS5AmbA48q2IAolKKo1MA==",
    1527 +      "license": "MIT",
    1528 +      "dependencies": {
    1529 +        "@types/d3-color": "*"
    1530 +      }
    1531 +    },
    1532 +    "node_modules/@types/d3-path": {
    1533 +      "version": "3.1.1",
    1534 +      "resolved": "https://registry.npmjs.org/@types/d3-path/-/d3-path-3.1.1.tgz",
    1535 +      "integrity": "sha512-VMZBYyQvbGmWyWVea0EHs/BwLgxc+MKi1zLDCONksozI4YJMcTt8ZEuIR4Sb1MMTE8MMW49v0IwI5+b7RmfWlg==",
    1536 +      "license": "MIT"
    1537 +    },
    1538 +    "node_modules/@types/d3-polygon": {
    1539 +      "version": "3.0.2",
    1540 +      "resolved": "https://registry.npmjs.org/@types/d3-polygon/-/d3-polygon-3.0.2.tgz",
    1541 +      "integrity": "sha512-ZuWOtMaHCkN9xoeEMr1ubW2nGWsp4nIql+OPQRstu4ypeZ+zk3YKqQT0CXVe/PYqrKpZAi+J9mTs05TKwjXSRA==",
    1542 +      "license": "MIT"
    1543 +    },
    1544 +    "node_modules/@types/d3-quadtree": {
    1545 +      "version": "3.0.6",
    1546 +      "resolved": "https://registry.npmjs.org/@types/d3-quadtree/-/d3-quadtree-3.0.6.tgz",
    1547 +      "integrity": "sha512-oUzyO1/Zm6rsxKRHA1vH0NEDG58HrT5icx/azi9MF1TWdtttWl0UIUsjEQBBh+SIkrpd21ZjEv7ptxWys1ncsg==",
    1548 +      "license": "MIT"
    1549 +    },
    1550 +    "node_modules/@types/d3-random": {
    1551 +      "version": "3.0.3",
    1552 +      "resolved": "https://registry.npmjs.org/@types/d3-random/-/d3-random-3.0.3.tgz",
    1553 +      "integrity": "sha512-Imagg1vJ3y76Y2ea0871wpabqp613+8/r0mCLEBfdtqC7xMSfj9idOnmBYyMoULfHePJyxMAw3nWhJxzc+LFwQ==",
    1554 +      "license": "MIT"
    1555 +    },
    1556 +    "node_modules/@types/d3-scale": {
    1557 +      "version": "4.0.9",
    1558 +      "resolved": "https://registry.npmjs.org/@types/d3-scale/-/d3-scale-4.0.9.tgz",
    1559 +      "integrity": "sha512-dLmtwB8zkAeO/juAMfnV+sItKjlsw2lKdZVVy6LRr0cBmegxSABiLEpGVmSJJ8O08i4+sGR6qQtb6WtuwJdvVw==",
    1560 +      "license": "MIT",
    1561 +      "dependencies": {
    1562 +        "@types/d3-time": "*"
    1563 +      }
    1564 +    },
    1565 +    "node_modules/@types/d3-scale-chromatic": {
    1566 +      "version": "3.1.0",
    1567 +      "resolved": "https://registry.npmjs.org/@types/d3-scale-chromatic/-/d3-scale-chromatic-3.1.0.tgz",
    1568 +      "integrity": "sha512-iWMJgwkK7yTRmWqRB5plb1kadXyQ5Sj8V/zYlFGMUBbIPKQScw+Dku9cAAMgJG+z5GYDoMjWGLVOvjghDEFnKQ==",
    1569 +      "license": "MIT"
    1570 +    },
    1571 +    "node_modules/@types/d3-selection": {
    1572 +      "version": "3.0.11",
    1573 +      "resolved": "https://registry.npmjs.org/@types/d3-selection/-/d3-selection-3.0.11.tgz",
    1574 +      "integrity": "sha512-bhAXu23DJWsrI45xafYpkQ4NtcKMwWnAC/vKrd2l+nxMFuvOT3XMYTIj2opv8vq8AO5Yh7Qac/nSeP/3zjTK0w==",
    1575 +      "license": "MIT"
    1576 +    },
    1577 +    "node_modules/@types/d3-shape": {
    1578 +      "version": "3.1.7",
    1579 +      "resolved": "https://registry.npmjs.org/@types/d3-shape/-/d3-shape-3.1.7.tgz",
    1580 +      "integrity": "sha512-VLvUQ33C+3J+8p+Daf+nYSOsjB4GXp19/S/aGo60m9h1v6XaxjiT82lKVWJCfzhtuZ3yD7i/TPeC/fuKLLOSmg==",
    1581 +      "license": "MIT",
    1582 +      "dependencies": {
    1583 +        "@types/d3-path": "*"
    1584 +      }
    1585 +    },
    1586 +    "node_modules/@types/d3-time": {
    1587 +      "version": "3.0.4",
    1588 +      "resolved": "https://registry.npmjs.org/@types/d3-time/-/d3-time-3.0.4.tgz",
    1589 +      "integrity": "sha512-yuzZug1nkAAaBlBBikKZTgzCeA+k1uy4ZFwWANOfKw5z5LRhV0gNA7gNkKm7HoK+HRN0wX3EkxGk0fpbWhmB7g==",
    1590 +      "license": "MIT"
    1591 +    },
    1592 +    "node_modules/@types/d3-time-format": {
    1593 +      "version": "4.0.3",
    1594 +      "resolved": "https://registry.npmjs.org/@types/d3-time-format/-/d3-time-format-4.0.3.tgz",
    1595 +      "integrity": "sha512-5xg9rC+wWL8kdDj153qZcsJ0FWiFt0J5RB6LYUNZjwSnesfblqrI/bJ1wBdJ8OQfncgbJG5+2F+qfqnqyzYxyg==",
    1596 +      "license": "MIT"
    1597 +    },
    1598 +    "node_modules/@types/d3-timer": {
    1599 +      "version": "3.0.2",
    1600 +      "resolved": "https://registry.npmjs.org/@types/d3-timer/-/d3-timer-3.0.2.tgz",
    1601 +      "integrity": "sha512-Ps3T8E8dZDam6fUyNiMkekK3XUsaUEik+idO9/YjPtfj2qruF8tFBXS7XhtE4iIXBLxhmLjP3SXpLhVf21I9Lw==",
    1602 +      "license": "MIT"
    1603 +    },
    1604 +    "node_modules/@types/d3-transition": {
    1605 +      "version": "3.0.9",
    1606 +      "resolved": "https://registry.npmjs.org/@types/d3-transition/-/d3-transition-3.0.9.tgz",
    1607 +      "integrity": "sha512-uZS5shfxzO3rGlu0cC3bjmMFKsXv+SmZZcgp0KD22ts4uGXp5EVYGzu/0YdwZeKmddhcAccYtREJKkPfXkZuCg==",
    1608 +      "license": "MIT",
    1609 +      "dependencies": {
    1610 +        "@types/d3-selection": "*"
    1611 +      }
    1612 +    },
    1613 +    "node_modules/@types/d3-zoom": {
    1614 +      "version": "3.0.8",
    1615 +      "resolved": "https://registry.npmjs.org/@types/d3-zoom/-/d3-zoom-3.0.8.tgz",
    1616 +      "integrity": "sha512-iqMC4/YlFCSlO8+2Ii1GGGliCAY4XdeG748w5vQUbevlbDu0zSjH/+jojorQVBK/se0j6DUFNPBGSqD3YWYnDw==",
    1617 +      "license": "MIT",
    1618 +      "dependencies": {
    1619 +        "@types/d3-interpolate": "*",
    1620 +        "@types/d3-selection": "*"
    1621 +      }
    1622 +    },
1263 1623      "node_modules/@types/deep-eql": {
1264 1624        "version": "4.0.2",
1265 1625        "resolved": "https://registry.npmjs.org/@types/deep-eql/-/deep-eql-4.0.2.tgz",
@@ -1274,6 +1634,12 @@
1274 1634        "dev": true,
1275 1635        "license": "MIT"
1276 1636      },
    1637 +    "node_modules/@types/geojson": {
    1638 +      "version": "7946.0.16",
    1639 +      "resolved": "https://registry.npmjs.org/@types/geojson/-/geojson-7946.0.16.tgz",
    1640 +      "integrity": "sha512-6C8nqWur3j98U6+lXDfTUWIfgvZU+EumvpHKcYjujKH7woYyLj2sUmff0tRhrqM7BohUw7Pz3ZB1jj2gW9Fvmg==",
    1641 +      "license": "MIT"
    1642 +    },
1277 1643      "node_modules/@types/json-schema": {
1278 1644        "version": "7.0.15",
1279 1645        "resolved": "https://registry.npmjs.org/@types/json-schema/-/json-schema-7.0.15.tgz",
@@ -1281,6 +1647,19 @@
1281 1647        "dev": true,
1282 1648        "license": "MIT"
1283 1649      },
    1650 +    "node_modules/@types/pako": {
    1651 +      "version": "2.0.4",
    1652 +      "resolved": "https://registry.npmjs.org/@types/pako/-/pako-2.0.4.tgz",
    1653 +      "integrity": "sha512-VWDCbrLeVXJM9fihYodcLiIv0ku+AlOa/TQ1SvYOaBuyrSKgEcro95LJyIsJ4vSo6BXIxOKxiJAat04CmST9Fw==",
    1654 +      "license": "MIT"
    1655 +    },
    1656 +    "node_modules/@types/raf": {
    1657 +      "version": "3.4.3",
    1658 +      "resolved": "https://registry.npmjs.org/@types/raf/-/raf-3.4.3.tgz",
    1659 +      "integrity": "sha512-c4YAvMedbPZ5tEyxzQdMoOhhJ4RD3rngZIdwC2/qDN3d7JpEhB6fiBRKVY1lg5B7Wk+uPBjn5f39j1/2MY1oOw==",
    1660 +      "license": "MIT",
    1661 +      "optional": true
    1662 +    },
1284 1663      "node_modules/@types/trusted-types": {
1285 1664        "version": "2.0.7",
1286 1665        "resolved": "https://registry.npmjs.org/@types/trusted-types/-/trusted-types-2.0.7.tgz",
@@ -1471,7 +1850,6 @@
1471 1850        "version": "8.15.0",
1472 1851        "resolved": "https://registry.npmjs.org/acorn/-/acorn-8.15.0.tgz",
1473 1852        "integrity": "sha512-NZyJarBfL7nWwIq+FDL6Zp/yHEhePMNnnJ0y3qfieCrmNvYct8uvtiV41UvlSe6apAfk0fY1FbWx+NwfmpvtTg==",
1474     -      "dev": true,
1475 1853        "license": "MIT",
1476 1854        "bin": {
1477 1855          "acorn": "bin/acorn"
@@ -1594,6 +1972,15 @@
1594 1972        "dev": true,
1595 1973        "license": "MIT"
1596 1974      },
    1975 +    "node_modules/base64-arraybuffer": {
    1976 +      "version": "1.0.2",
    1977 +      "resolved": "https://registry.npmjs.org/base64-arraybuffer/-/base64-arraybuffer-1.0.2.tgz",
    1978 +      "integrity": "sha512-I3yl4r9QB5ZRY3XuJVEPfc2XhZO6YweFPI+UovAzn+8/hb3oJ6lnysaFcjVpkCPfVWFUDvoZ8kmVDP7WyRtYtQ==",
    1979 +      "license": "MIT",
    1980 +      "engines": {
    1981 +        "node": ">= 0.6.0"
    1982 +      }
    1983 +    },
1597 1984      "node_modules/bidi-js": {
1598 1985        "version": "1.0.3",
1599 1986        "resolved": "https://registry.npmjs.org/bidi-js/-/bidi-js-1.0.3.tgz",
@@ -1721,6 +2108,26 @@
1721 2108          "node": ">=6"
1722 2109        }
1723 2110      },
    2111 +    "node_modules/canvg": {
    2112 +      "version": "3.0.11",
    2113 +      "resolved": "https://registry.npmjs.org/canvg/-/canvg-3.0.11.tgz",
    2114 +      "integrity": "sha512-5ON+q7jCTgMp9cjpu4Jo6XbvfYwSB2Ow3kzHKfIyJfaCAOHLbdKPQqGKgfED/R5B+3TFFfe8pegYA+b423SRyA==",
    2115 +      "license": "MIT",
    2116 +      "optional": true,
    2117 +      "dependencies": {
    2118 +        "@babel/runtime": "^7.12.5",
    2119 +        "@types/raf": "^3.4.0",
    2120 +        "core-js": "^3.8.3",
    2121 +        "raf": "^3.4.1",
    2122 +        "regenerator-runtime": "^0.13.7",
    2123 +        "rgbcolor": "^1.0.1",
    2124 +        "stackblur-canvas": "^2.0.0",
    2125 +        "svg-pathdata": "^6.0.3"
    2126 +      },
    2127 +      "engines": {
    2128 +        "node": ">=10.0.0"
    2129 +      }
    2130 +    },
1724 2131      "node_modules/chai": {
1725 2132        "version": "6.2.0",
1726 2133        "resolved": "https://registry.npmjs.org/chai/-/chai-6.2.0.tgz",
@@ -1748,6 +2155,32 @@
1748 2155          "url": "https://github.com/chalk/chalk?sponsor=1"
1749 2156        }
1750 2157      },
    2158 +    "node_modules/chevrotain": {
    2159 +      "version": "11.0.3",
    2160 +      "resolved": "https://registry.npmjs.org/chevrotain/-/chevrotain-11.0.3.tgz",
    2161 +      "integrity": "sha512-ci2iJH6LeIkvP9eJW6gpueU8cnZhv85ELY8w8WiFtNjMHA5ad6pQLaJo9mEly/9qUyCpvqX8/POVUTf18/HFdw==",
    2162 +      "license": "Apache-2.0",
    2163 +      "dependencies": {
    2164 +        "@chevrotain/cst-dts-gen": "11.0.3",
    2165 +        "@chevrotain/gast": "11.0.3",
    2166 +        "@chevrotain/regexp-to-ast": "11.0.3",
    2167 +        "@chevrotain/types": "11.0.3",
    2168 +        "@chevrotain/utils": "11.0.3",
    2169 +        "lodash-es": "4.17.21"
    2170 +      }
    2171 +    },
    2172 +    "node_modules/chevrotain-allstar": {
    2173 +      "version": "0.3.1",
    2174 +      "resolved": "https://registry.npmjs.org/chevrotain-allstar/-/chevrotain-allstar-0.3.1.tgz",
    2175 +      "integrity": "sha512-b7g+y9A0v4mxCW1qUhf3BSVPg+/NvGErk/dOkrDaHA0nQIQGAtrOjlX//9OQtRlSCy+x9rfB5N8yC71lH1nvMw==",
    2176 +      "license": "MIT",
    2177 +      "dependencies": {
    2178 +        "lodash-es": "^4.17.21"
    2179 +      },
    2180 +      "peerDependencies": {
    2181 +        "chevrotain": "^11.0.0"
    2182 +      }
    2183 +    },
1751 2184      "node_modules/color-convert": {
1752 2185        "version": "2.0.1",
1753 2186        "resolved": "https://registry.npmjs.org/color-convert/-/color-convert-2.0.1.tgz",
@@ -1768,6 +2201,15 @@
1768 2201        "dev": true,
1769 2202        "license": "MIT"
1770 2203      },
    2204 +    "node_modules/commander": {
    2205 +      "version": "8.3.0",
    2206 +      "resolved": "https://registry.npmjs.org/commander/-/commander-8.3.0.tgz",
    2207 +      "integrity": "sha512-OkTL9umf+He2DZkUq8f8J9of7yL6RJKI24dVITBmNfZBmri9zYZQrKkuXiKhyfPSu8tUhnVBB1iKXevvnlR4Ww==",
    2208 +      "license": "MIT",
    2209 +      "engines": {
    2210 +        "node": ">= 12"
    2211 +      }
    2212 +    },
1771 2213      "node_modules/concat-map": {
1772 2214        "version": "0.0.1",
1773 2215        "resolved": "https://registry.npmjs.org/concat-map/-/concat-map-0.0.1.tgz",
@@ -1775,6 +2217,12 @@
1775 2217        "dev": true,
1776 2218        "license": "MIT"
1777 2219      },
    2220 +    "node_modules/confbox": {
    2221 +      "version": "0.1.8",
    2222 +      "resolved": "https://registry.npmjs.org/confbox/-/confbox-0.1.8.tgz",
    2223 +      "integrity": "sha512-RMtmw0iFkeR4YV+fUOSucriAQNb9g8zFR52MWCtl+cCZOFRNL6zeB395vPzFhEjjn4fMxXudmELnl/KF/WrK6w==",
    2224 +      "license": "MIT"
    2225 +    },
1778 2226      "node_modules/content-disposition": {
1779 2227        "version": "0.5.4",
1780 2228        "resolved": "https://registry.npmjs.org/content-disposition/-/content-disposition-0.5.4.tgz",
@@ -1815,6 +2263,18 @@
1815 2263        "dev": true,
1816 2264        "license": "MIT"
1817 2265      },
    2266 +    "node_modules/core-js": {
    2267 +      "version": "3.47.0",
    2268 +      "resolved": "https://registry.npmjs.org/core-js/-/core-js-3.47.0.tgz",
    2269 +      "integrity": "sha512-c3Q2VVkGAUyupsjRnaNX6u8Dq2vAdzm9iuPj5FW0fRxzlxgq9Q39MDq10IvmQSpLgHQNyQzQmOo6bgGHmH3NNg==",
    2270 +      "hasInstallScript": true,
    2271 +      "license": "MIT",
    2272 +      "optional": true,
    2273 +      "funding": {
    2274 +        "type": "opencollective",
    2275 +        "url": "https://opencollective.com/core-js"
    2276 +      }
    2277 +    },
1818 2278      "node_modules/cors": {
1819 2279        "version": "2.8.5",
1820 2280        "resolved": "https://registry.npmjs.org/cors/-/cors-2.8.5.tgz",
@@ -1829,6 +2289,15 @@
1829 2289          "node": ">= 0.10"
1830 2290        }
1831 2291      },
    2292 +    "node_modules/cose-base": {
    2293 +      "version": "1.0.3",
    2294 +      "resolved": "https://registry.npmjs.org/cose-base/-/cose-base-1.0.3.tgz",
    2295 +      "integrity": "sha512-s9whTXInMSgAp/NVXVNuVxVKzGH2qck3aQlVHxDCdAEPgtMKwc4Wq6/QKhgdEdgbLSi9rBTAcPoRa6JpiG4ksg==",
    2296 +      "license": "MIT",
    2297 +      "dependencies": {
    2298 +        "layout-base": "^1.0.0"
    2299 +      }
    2300 +    },
1832 2301      "node_modules/cross-spawn": {
1833 2302        "version": "7.0.6",
1834 2303        "resolved": "https://registry.npmjs.org/cross-spawn/-/cross-spawn-7.0.6.tgz",
@@ -1844,6 +2313,15 @@
1844 2313          "node": ">= 8"
1845 2314        }
1846 2315      },
    2316 +    "node_modules/css-line-break": {
    2317 +      "version": "2.1.0",
    2318 +      "resolved": "https://registry.npmjs.org/css-line-break/-/css-line-break-2.1.0.tgz",
    2319 +      "integrity": "sha512-FHcKFCZcAha3LwfVBhCQbW2nCNbkZXn7KVUJcsT5/P8YmfsVja0FMPJr0B903j/E69HUphKiV9iQArX8SDYA4w==",
    2320 +      "license": "MIT",
    2321 +      "dependencies": {
    2322 +        "utrie": "^1.0.2"
    2323 +      }
    2324 +    },
1847 2325      "node_modules/css-tree": {
1848 2326        "version": "3.1.0",
1849 2327        "resolved": "https://registry.npmjs.org/css-tree/-/css-tree-3.1.0.tgz",
@@ -1873,6 +2351,514 @@
1873 2351          "node": ">=20"
1874 2352        }
1875 2353      },
    2354 +    "node_modules/cytoscape": {
    2355 +      "version": "3.33.1",
    2356 +      "resolved": "https://registry.npmjs.org/cytoscape/-/cytoscape-3.33.1.tgz",
    2357 +      "integrity": "sha512-iJc4TwyANnOGR1OmWhsS9ayRS3s+XQ185FmuHObThD+5AeJCakAAbWv8KimMTt08xCCLNgneQwFp+JRJOr9qGQ==",
    2358 +      "license": "MIT",
    2359 +      "engines": {
    2360 +        "node": ">=0.10"
    2361 +      }
    2362 +    },
    2363 +    "node_modules/cytoscape-cose-bilkent": {
    2364 +      "version": "4.1.0",
    2365 +      "resolved": "https://registry.npmjs.org/cytoscape-cose-bilkent/-/cytoscape-cose-bilkent-4.1.0.tgz",
    2366 +      "integrity": "sha512-wgQlVIUJF13Quxiv5e1gstZ08rnZj2XaLHGoFMYXz7SkNfCDOOteKBE6SYRfA9WxxI/iBc3ajfDoc6hb/MRAHQ==",
    2367 +      "license": "MIT",
    2368 +      "dependencies": {
    2369 +        "cose-base": "^1.0.0"
    2370 +      },
    2371 +      "peerDependencies": {
    2372 +        "cytoscape": "^3.2.0"
    2373 +      }
    2374 +    },
    2375 +    "node_modules/cytoscape-fcose": {
    2376 +      "version": "2.2.0",
    2377 +      "resolved": "https://registry.npmjs.org/cytoscape-fcose/-/cytoscape-fcose-2.2.0.tgz",
    2378 +      "integrity": "sha512-ki1/VuRIHFCzxWNrsshHYPs6L7TvLu3DL+TyIGEsRcvVERmxokbf5Gdk7mFxZnTdiGtnA4cfSmjZJMviqSuZrQ==",
    2379 +      "license": "MIT",
    2380 +      "dependencies": {
    2381 +        "cose-base": "^2.2.0"
    2382 +      },
    2383 +      "peerDependencies": {
    2384 +        "cytoscape": "^3.2.0"
    2385 +      }
    2386 +    },
    2387 +    "node_modules/cytoscape-fcose/node_modules/cose-base": {
    2388 +      "version": "2.2.0",
    2389 +      "resolved": "https://registry.npmjs.org/cose-base/-/cose-base-2.2.0.tgz",
    2390 +      "integrity": "sha512-AzlgcsCbUMymkADOJtQm3wO9S3ltPfYOFD5033keQn9NJzIbtnZj+UdBJe7DYml/8TdbtHJW3j58SOnKhWY/5g==",
    2391 +      "license": "MIT",
    2392 +      "dependencies": {
    2393 +        "layout-base": "^2.0.0"
    2394 +      }
    2395 +    },
    2396 +    "node_modules/cytoscape-fcose/node_modules/layout-base": {
    2397 +      "version": "2.0.1",
    2398 +      "resolved": "https://registry.npmjs.org/layout-base/-/layout-base-2.0.1.tgz",
    2399 +      "integrity": "sha512-dp3s92+uNI1hWIpPGH3jK2kxE2lMjdXdr+DH8ynZHpd6PUlH6x6cbuXnoMmiNumznqaNO31xu9e79F0uuZ0JFg==",
    2400 +      "license": "MIT"
    2401 +    },
    2402 +    "node_modules/d3": {
    2403 +      "version": "7.9.0",
    2404 +      "resolved": "https://registry.npmjs.org/d3/-/d3-7.9.0.tgz",
    2405 +      "integrity": "sha512-e1U46jVP+w7Iut8Jt8ri1YsPOvFpg46k+K8TpCb0P+zjCkjkPnV7WzfDJzMHy1LnA+wj5pLT1wjO901gLXeEhA==",
    2406 +      "license": "ISC",
    2407 +      "dependencies": {
    2408 +        "d3-array": "3",
    2409 +        "d3-axis": "3",
    2410 +        "d3-brush": "3",
    2411 +        "d3-chord": "3",
    2412 +        "d3-color": "3",
    2413 +        "d3-contour": "4",
    2414 +        "d3-delaunay": "6",
    2415 +        "d3-dispatch": "3",
    2416 +        "d3-drag": "3",
    2417 +        "d3-dsv": "3",
    2418 +        "d3-ease": "3",
    2419 +        "d3-fetch": "3",
    2420 +        "d3-force": "3",
    2421 +        "d3-format": "3",
    2422 +        "d3-geo": "3",
    2423 +        "d3-hierarchy": "3",
    2424 +        "d3-interpolate": "3",
    2425 +        "d3-path": "3",
    2426 +        "d3-polygon": "3",
    2427 +        "d3-quadtree": "3",
    2428 +        "d3-random": "3",
    2429 +        "d3-scale": "4",
    2430 +        "d3-scale-chromatic": "3",
    2431 +        "d3-selection": "3",
    2432 +        "d3-shape": "3",
    2433 +        "d3-time": "3",
    2434 +        "d3-time-format": "4",
    2435 +        "d3-timer": "3",
    2436 +        "d3-transition": "3",
    2437 +        "d3-zoom": "3"
    2438 +      },
    2439 +      "engines": {
    2440 +        "node": ">=12"
    2441 +      }
    2442 +    },
    2443 +    "node_modules/d3-array": {
    2444 +      "version": "3.2.4",
    2445 +      "resolved": "https://registry.npmjs.org/d3-array/-/d3-array-3.2.4.tgz",
    2446 +      "integrity": "sha512-tdQAmyA18i4J7wprpYq8ClcxZy3SC31QMeByyCFyRt7BVHdREQZ5lpzoe5mFEYZUWe+oq8HBvk9JjpibyEV4Jg==",
    2447 +      "license": "ISC",
    2448 +      "dependencies": {
    2449 +        "internmap": "1 - 2"
    2450 +      },
    2451 +      "engines": {
    2452 +        "node": ">=12"
    2453 +      }
    2454 +    },
    2455 +    "node_modules/d3-axis": {
    2456 +      "version": "3.0.0",
    2457 +      "resolved": "https://registry.npmjs.org/d3-axis/-/d3-axis-3.0.0.tgz",
    2458 +      "integrity": "sha512-IH5tgjV4jE/GhHkRV0HiVYPDtvfjHQlQfJHs0usq7M30XcSBvOotpmH1IgkcXsO/5gEQZD43B//fc7SRT5S+xw==",
    2459 +      "license": "ISC",
    2460 +      "engines": {
    2461 +        "node": ">=12"
    2462 +      }
    2463 +    },
    2464 +    "node_modules/d3-brush": {
    2465 +      "version": "3.0.0",
    2466 +      "resolved": "https://registry.npmjs.org/d3-brush/-/d3-brush-3.0.0.tgz",
    2467 +      "integrity": "sha512-ALnjWlVYkXsVIGlOsuWH1+3udkYFI48Ljihfnh8FZPF2QS9o+PzGLBslO0PjzVoHLZ2KCVgAM8NVkXPJB2aNnQ==",
    2468 +      "license": "ISC",
    2469 +      "dependencies": {
    2470 +        "d3-dispatch": "1 - 3",
    2471 +        "d3-drag": "2 - 3",
    2472 +        "d3-interpolate": "1 - 3",
    2473 +        "d3-selection": "3",
    2474 +        "d3-transition": "3"
    2475 +      },
    2476 +      "engines": {
    2477 +        "node": ">=12"
    2478 +      }
    2479 +    },
    2480 +    "node_modules/d3-chord": {
    2481 +      "version": "3.0.1",
    2482 +      "resolved": "https://registry.npmjs.org/d3-chord/-/d3-chord-3.0.1.tgz",
    2483 +      "integrity": "sha512-VE5S6TNa+j8msksl7HwjxMHDM2yNK3XCkusIlpX5kwauBfXuyLAtNg9jCp/iHH61tgI4sb6R/EIMWCqEIdjT/g==",
    2484 +      "license": "ISC",
    2485 +      "dependencies": {
    2486 +        "d3-path": "1 - 3"
    2487 +      },
    2488 +      "engines": {
    2489 +        "node": ">=12"
    2490 +      }
    2491 +    },
    2492 +    "node_modules/d3-color": {
    2493 +      "version": "3.1.0",
    2494 +      "resolved": "https://registry.npmjs.org/d3-color/-/d3-color-3.1.0.tgz",
    2495 +      "integrity": "sha512-zg/chbXyeBtMQ1LbD/WSoW2DpC3I0mpmPdW+ynRTj/x2DAWYrIY7qeZIHidozwV24m4iavr15lNwIwLxRmOxhA==",
    2496 +      "license": "ISC",
    2497 +      "engines": {
    2498 +        "node": ">=12"
    2499 +      }
    2500 +    },
    2501 +    "node_modules/d3-contour": {
    2502 +      "version": "4.0.2",
    2503 +      "resolved": "https://registry.npmjs.org/d3-contour/-/d3-contour-4.0.2.tgz",
    2504 +      "integrity": "sha512-4EzFTRIikzs47RGmdxbeUvLWtGedDUNkTcmzoeyg4sP/dvCexO47AaQL7VKy/gul85TOxw+IBgA8US2xwbToNA==",
    2505 +      "license": "ISC",
    2506 +      "dependencies": {
    2507 +        "d3-array": "^3.2.0"
    2508 +      },
    2509 +      "engines": {
    2510 +        "node": ">=12"
    2511 +      }
    2512 +    },
    2513 +    "node_modules/d3-delaunay": {
    2514 +      "version": "6.0.4",
    2515 +      "resolved": "https://registry.npmjs.org/d3-delaunay/-/d3-delaunay-6.0.4.tgz",
    2516 +      "integrity": "sha512-mdjtIZ1XLAM8bm/hx3WwjfHt6Sggek7qH043O8KEjDXN40xi3vx/6pYSVTwLjEgiXQTbvaouWKynLBiUZ6SK6A==",
    2517 +      "license": "ISC",
    2518 +      "dependencies": {
    2519 +        "delaunator": "5"
    2520 +      },
    2521 +      "engines": {
    2522 +        "node": ">=12"
    2523 +      }
    2524 +    },
    2525 +    "node_modules/d3-dispatch": {
    2526 +      "version": "3.0.1",
    2527 +      "resolved": "https://registry.npmjs.org/d3-dispatch/-/d3-dispatch-3.0.1.tgz",
    2528 +      "integrity": "sha512-rzUyPU/S7rwUflMyLc1ETDeBj0NRuHKKAcvukozwhshr6g6c5d8zh4c2gQjY2bZ0dXeGLWc1PF174P2tVvKhfg==",
    2529 +      "license": "ISC",
    2530 +      "engines": {
    2531 +        "node": ">=12"
    2532 +      }
    2533 +    },
    2534 +    "node_modules/d3-drag": {
    2535 +      "version": "3.0.0",
    2536 +      "resolved": "https://registry.npmjs.org/d3-drag/-/d3-drag-3.0.0.tgz",
    2537 +      "integrity": "sha512-pWbUJLdETVA8lQNJecMxoXfH6x+mO2UQo8rSmZ+QqxcbyA3hfeprFgIT//HW2nlHChWeIIMwS2Fq+gEARkhTkg==",
    2538 +      "license": "ISC",
    2539 +      "dependencies": {
    2540 +        "d3-dispatch": "1 - 3",
    2541 +        "d3-selection": "3"
    2542 +      },
    2543 +      "engines": {
    2544 +        "node": ">=12"
    2545 +      }
    2546 +    },
    2547 +    "node_modules/d3-dsv": {
    2548 +      "version": "3.0.1",
    2549 +      "resolved": "https://registry.npmjs.org/d3-dsv/-/d3-dsv-3.0.1.tgz",
    2550 +      "integrity": "sha512-UG6OvdI5afDIFP9w4G0mNq50dSOsXHJaRE8arAS5o9ApWnIElp8GZw1Dun8vP8OyHOZ/QJUKUJwxiiCCnUwm+Q==",
    2551 +      "license": "ISC",
    2552 +      "dependencies": {
    2553 +        "commander": "7",
    2554 +        "iconv-lite": "0.6",
    2555 +        "rw": "1"
    2556 +      },
    2557 +      "bin": {
    2558 +        "csv2json": "bin/dsv2json.js",
    2559 +        "csv2tsv": "bin/dsv2dsv.js",
    2560 +        "dsv2dsv": "bin/dsv2dsv.js",
    2561 +        "dsv2json": "bin/dsv2json.js",
    2562 +        "json2csv": "bin/json2dsv.js",
    2563 +        "json2dsv": "bin/json2dsv.js",
    2564 +        "json2tsv": "bin/json2dsv.js",
    2565 +        "tsv2csv": "bin/dsv2dsv.js",
    2566 +        "tsv2json": "bin/dsv2json.js"
    2567 +      },
    2568 +      "engines": {
    2569 +        "node": ">=12"
    2570 +      }
    2571 +    },
    2572 +    "node_modules/d3-dsv/node_modules/commander": {
    2573 +      "version": "7.2.0",
    2574 +      "resolved": "https://registry.npmjs.org/commander/-/commander-7.2.0.tgz",
    2575 +      "integrity": "sha512-QrWXB+ZQSVPmIWIhtEO9H+gwHaMGYiF5ChvoJ+K9ZGHG/sVsa6yiesAD1GC/x46sET00Xlwo1u49RVVVzvcSkw==",
    2576 +      "license": "MIT",
    2577 +      "engines": {
    2578 +        "node": ">= 10"
    2579 +      }
    2580 +    },
    2581 +    "node_modules/d3-ease": {
    2582 +      "version": "3.0.1",
    2583 +      "resolved": "https://registry.npmjs.org/d3-ease/-/d3-ease-3.0.1.tgz",
    2584 +      "integrity": "sha512-wR/XK3D3XcLIZwpbvQwQ5fK+8Ykds1ip7A2Txe0yxncXSdq1L9skcG7blcedkOX+ZcgxGAmLX1FrRGbADwzi0w==",
    2585 +      "license": "BSD-3-Clause",
    2586 +      "engines": {
    2587 +        "node": ">=12"
    2588 +      }
    2589 +    },
    2590 +    "node_modules/d3-fetch": {
    2591 +      "version": "3.0.1",
    2592 +      "resolved": "https://registry.npmjs.org/d3-fetch/-/d3-fetch-3.0.1.tgz",
    2593 +      "integrity": "sha512-kpkQIM20n3oLVBKGg6oHrUchHM3xODkTzjMoj7aWQFq5QEM+R6E4WkzT5+tojDY7yjez8KgCBRoj4aEr99Fdqw==",
    2594 +      "license": "ISC",
    2595 +      "dependencies": {
    2596 +        "d3-dsv": "1 - 3"
    2597 +      },
    2598 +      "engines": {
    2599 +        "node": ">=12"
    2600 +      }
    2601 +    },
    2602 +    "node_modules/d3-force": {
    2603 +      "version": "3.0.0",
    2604 +      "resolved": "https://registry.npmjs.org/d3-force/-/d3-force-3.0.0.tgz",
    2605 +      "integrity": "sha512-zxV/SsA+U4yte8051P4ECydjD/S+qeYtnaIyAs9tgHCqfguma/aAQDjo85A9Z6EKhBirHRJHXIgJUlffT4wdLg==",
    2606 +      "license": "ISC",
    2607 +      "dependencies": {
    2608 +        "d3-dispatch": "1 - 3",
    2609 +        "d3-quadtree": "1 - 3",
    2610 +        "d3-timer": "1 - 3"
    2611 +      },
    2612 +      "engines": {
    2613 +        "node": ">=12"
    2614 +      }
    2615 +    },
    2616 +    "node_modules/d3-format": {
    2617 +      "version": "3.1.0",
    2618 +      "resolved": "https://registry.npmjs.org/d3-format/-/d3-format-3.1.0.tgz",
    2619 +      "integrity": "sha512-YyUI6AEuY/Wpt8KWLgZHsIU86atmikuoOmCfommt0LYHiQSPjvX2AcFc38PX0CBpr2RCyZhjex+NS/LPOv6YqA==",
    2620 +      "license": "ISC",
    2621 +      "engines": {
    2622 +        "node": ">=12"
    2623 +      }
    2624 +    },
    2625 +    "node_modules/d3-geo": {
    2626 +      "version": "3.1.1",
    2627 +      "resolved": "https://registry.npmjs.org/d3-geo/-/d3-geo-3.1.1.tgz",
    2628 +      "integrity": "sha512-637ln3gXKXOwhalDzinUgY83KzNWZRKbYubaG+fGVuc/dxO64RRljtCTnf5ecMyE1RIdtqpkVcq0IbtU2S8j2Q==",
    2629 +      "license": "ISC",
    2630 +      "dependencies": {
    2631 +        "d3-array": "2.5.0 - 3"
    2632 +      },
    2633 +      "engines": {
    2634 +        "node": ">=12"
    2635 +      }
    2636 +    },
    2637 +    "node_modules/d3-hierarchy": {
    2638 +      "version": "3.1.2",
    2639 +      "resolved": "https://registry.npmjs.org/d3-hierarchy/-/d3-hierarchy-3.1.2.tgz",
    2640 +      "integrity": "sha512-FX/9frcub54beBdugHjDCdikxThEqjnR93Qt7PvQTOHxyiNCAlvMrHhclk3cD5VeAaq9fxmfRp+CnWw9rEMBuA==",
    2641 +      "license": "ISC",
    2642 +      "engines": {
    2643 +        "node": ">=12"
    2644 +      }
    2645 +    },
    2646 +    "node_modules/d3-interpolate": {
    2647 +      "version": "3.0.1",
    2648 +      "resolved": "https://registry.npmjs.org/d3-interpolate/-/d3-interpolate-3.0.1.tgz",
    2649 +      "integrity": "sha512-3bYs1rOD33uo8aqJfKP3JWPAibgw8Zm2+L9vBKEHJ2Rg+viTR7o5Mmv5mZcieN+FRYaAOWX5SJATX6k1PWz72g==",
    2650 +      "license": "ISC",
    2651 +      "dependencies": {
    2652 +        "d3-color": "1 - 3"
    2653 +      },
    2654 +      "engines": {
    2655 +        "node": ">=12"
    2656 +      }
    2657 +    },
    2658 +    "node_modules/d3-path": {
    2659 +      "version": "3.1.0",
    2660 +      "resolved": "https://registry.npmjs.org/d3-path/-/d3-path-3.1.0.tgz",
    2661 +      "integrity": "sha512-p3KP5HCf/bvjBSSKuXid6Zqijx7wIfNW+J/maPs+iwR35at5JCbLUT0LzF1cnjbCHWhqzQTIN2Jpe8pRebIEFQ==",
    2662 +      "license": "ISC",
    2663 +      "engines": {
    2664 +        "node": ">=12"
    2665 +      }
    2666 +    },
    2667 +    "node_modules/d3-polygon": {
    2668 +      "version": "3.0.1",
    2669 +      "resolved": "https://registry.npmjs.org/d3-polygon/-/d3-polygon-3.0.1.tgz",
    2670 +      "integrity": "sha512-3vbA7vXYwfe1SYhED++fPUQlWSYTTGmFmQiany/gdbiWgU/iEyQzyymwL9SkJjFFuCS4902BSzewVGsHHmHtXg==",
    2671 +      "license": "ISC",
    2672 +      "engines": {
    2673 +        "node": ">=12"
    2674 +      }
    2675 +    },
    2676 +    "node_modules/d3-quadtree": {
    2677 +      "version": "3.0.1",
    2678 +      "resolved": "https://registry.npmjs.org/d3-quadtree/-/d3-quadtree-3.0.1.tgz",
    2679 +      "integrity": "sha512-04xDrxQTDTCFwP5H6hRhsRcb9xxv2RzkcsygFzmkSIOJy3PeRJP7sNk3VRIbKXcog561P9oU0/rVH6vDROAgUw==",
    2680 +      "license": "ISC",
    2681 +      "engines": {
    2682 +        "node": ">=12"
    2683 +      }
    2684 +    },
    2685 +    "node_modules/d3-random": {
    2686 +      "version": "3.0.1",
    2687 +      "resolved": "https://registry.npmjs.org/d3-random/-/d3-random-3.0.1.tgz",
    2688 +      "integrity": "sha512-FXMe9GfxTxqd5D6jFsQ+DJ8BJS4E/fT5mqqdjovykEB2oFbTMDVdg1MGFxfQW+FBOGoB++k8swBrgwSHT1cUXQ==",
    2689 +      "license": "ISC",
    2690 +      "engines": {
    2691 +        "node": ">=12"
    2692 +      }
    2693 +    },
    2694 +    "node_modules/d3-sankey": {
    2695 +      "version": "0.12.3",
    2696 +      "resolved": "https://registry.npmjs.org/d3-sankey/-/d3-sankey-0.12.3.tgz",
    2697 +      "integrity": "sha512-nQhsBRmM19Ax5xEIPLMY9ZmJ/cDvd1BG3UVvt5h3WRxKg5zGRbvnteTyWAbzeSvlh3tW7ZEmq4VwR5mB3tutmQ==",
    2698 +      "license": "BSD-3-Clause",
    2699 +      "dependencies": {
    2700 +        "d3-array": "1 - 2",
    2701 +        "d3-shape": "^1.2.0"
    2702 +      }
    2703 +    },
    2704 +    "node_modules/d3-sankey/node_modules/d3-array": {
    2705 +      "version": "2.12.1",
    2706 +      "resolved": "https://registry.npmjs.org/d3-array/-/d3-array-2.12.1.tgz",
    2707 +      "integrity": "sha512-B0ErZK/66mHtEsR1TkPEEkwdy+WDesimkM5gpZr5Dsg54BiTA5RXtYW5qTLIAcekaS9xfZrzBLF/OAkB3Qn1YQ==",
    2708 +      "license": "BSD-3-Clause",
    2709 +      "dependencies": {
    2710 +        "internmap": "^1.0.0"
    2711 +      }
    2712 +    },
    2713 +    "node_modules/d3-sankey/node_modules/d3-path": {
    2714 +      "version": "1.0.9",
    2715 +      "resolved": "https://registry.npmjs.org/d3-path/-/d3-path-1.0.9.tgz",
    2716 +      "integrity": "sha512-VLaYcn81dtHVTjEHd8B+pbe9yHWpXKZUC87PzoFmsFrJqgFwDe/qxfp5MlfsfM1V5E/iVt0MmEbWQ7FVIXh/bg==",
    2717 +      "license": "BSD-3-Clause"
    2718 +    },
    2719 +    "node_modules/d3-sankey/node_modules/d3-shape": {
    2720 +      "version": "1.3.7",
    2721 +      "resolved": "https://registry.npmjs.org/d3-shape/-/d3-shape-1.3.7.tgz",
    2722 +      "integrity": "sha512-EUkvKjqPFUAZyOlhY5gzCxCeI0Aep04LwIRpsZ/mLFelJiUfnK56jo5JMDSE7yyP2kLSb6LtF+S5chMk7uqPqw==",
    2723 +      "license": "BSD-3-Clause",
    2724 +      "dependencies": {
    2725 +        "d3-path": "1"
    2726 +      }
    2727 +    },
    2728 +    "node_modules/d3-sankey/node_modules/internmap": {
    2729 +      "version": "1.0.1",
    2730 +      "resolved": "https://registry.npmjs.org/internmap/-/internmap-1.0.1.tgz",
    2731 +      "integrity": "sha512-lDB5YccMydFBtasVtxnZ3MRBHuaoE8GKsppq+EchKL2U4nK/DmEpPHNH8MZe5HkMtpSiTSOZwfN0tzYjO/lJEw==",
    2732 +      "license": "ISC"
    2733 +    },
    2734 +    "node_modules/d3-scale": {
    2735 +      "version": "4.0.2",
    2736 +      "resolved": "https://registry.npmjs.org/d3-scale/-/d3-scale-4.0.2.tgz",
    2737 +      "integrity": "sha512-GZW464g1SH7ag3Y7hXjf8RoUuAFIqklOAq3MRl4OaWabTFJY9PN/E1YklhXLh+OQ3fM9yS2nOkCoS+WLZ6kvxQ==",
    2738 +      "license": "ISC",
    2739 +      "dependencies": {
    2740 +        "d3-array": "2.10.0 - 3",
    2741 +        "d3-format": "1 - 3",
    2742 +        "d3-interpolate": "1.2.0 - 3",
    2743 +        "d3-time": "2.1.1 - 3",
    2744 +        "d3-time-format": "2 - 4"
    2745 +      },
    2746 +      "engines": {
    2747 +        "node": ">=12"
    2748 +      }
    2749 +    },
    2750 +    "node_modules/d3-scale-chromatic": {
    2751 +      "version": "3.1.0",
    2752 +      "resolved": "https://registry.npmjs.org/d3-scale-chromatic/-/d3-scale-chromatic-3.1.0.tgz",
    2753 +      "integrity": "sha512-A3s5PWiZ9YCXFye1o246KoscMWqf8BsD9eRiJ3He7C9OBaxKhAd5TFCdEx/7VbKtxxTsu//1mMJFrEt572cEyQ==",
    2754 +      "license": "ISC",
    2755 +      "dependencies": {
    2756 +        "d3-color": "1 - 3",
    2757 +        "d3-interpolate": "1 - 3"
    2758 +      },
    2759 +      "engines": {
    2760 +        "node": ">=12"
    2761 +      }
    2762 +    },
    2763 +    "node_modules/d3-selection": {
    2764 +      "version": "3.0.0",
    2765 +      "resolved": "https://registry.npmjs.org/d3-selection/-/d3-selection-3.0.0.tgz",
    2766 +      "integrity": "sha512-fmTRWbNMmsmWq6xJV8D19U/gw/bwrHfNXxrIN+HfZgnzqTHp9jOmKMhsTUjXOJnZOdZY9Q28y4yebKzqDKlxlQ==",
    2767 +      "license": "ISC",
    2768 +      "engines": {
    2769 +        "node": ">=12"
    2770 +      }
    2771 +    },
    2772 +    "node_modules/d3-shape": {
    2773 +      "version": "3.2.0",
    2774 +      "resolved": "https://registry.npmjs.org/d3-shape/-/d3-shape-3.2.0.tgz",
    2775 +      "integrity": "sha512-SaLBuwGm3MOViRq2ABk3eLoxwZELpH6zhl3FbAoJ7Vm1gofKx6El1Ib5z23NUEhF9AsGl7y+dzLe5Cw2AArGTA==",
    2776 +      "license": "ISC",
    2777 +      "dependencies": {
    2778 +        "d3-path": "^3.1.0"
    2779 +      },
    2780 +      "engines": {
    2781 +        "node": ">=12"
    2782 +      }
    2783 +    },
    2784 +    "node_modules/d3-time": {
    2785 +      "version": "3.1.0",
    2786 +      "resolved": "https://registry.npmjs.org/d3-time/-/d3-time-3.1.0.tgz",
    2787 +      "integrity": "sha512-VqKjzBLejbSMT4IgbmVgDjpkYrNWUYJnbCGo874u7MMKIWsILRX+OpX/gTk8MqjpT1A/c6HY2dCA77ZN0lkQ2Q==",
    2788 +      "license": "ISC",
    2789 +      "dependencies": {
    2790 +        "d3-array": "2 - 3"
    2791 +      },
    2792 +      "engines": {
    2793 +        "node": ">=12"
    2794 +      }
    2795 +    },
    2796 +    "node_modules/d3-time-format": {
    2797 +      "version": "4.1.0",
    2798 +      "resolved": "https://registry.npmjs.org/d3-time-format/-/d3-time-format-4.1.0.tgz",
    2799 +      "integrity": "sha512-dJxPBlzC7NugB2PDLwo9Q8JiTR3M3e4/XANkreKSUxF8vvXKqm1Yfq4Q5dl8budlunRVlUUaDUgFt7eA8D6NLg==",
    2800 +      "license": "ISC",
    2801 +      "dependencies": {
    2802 +        "d3-time": "1 - 3"
    2803 +      },
    2804 +      "engines": {
    2805 +        "node": ">=12"
    2806 +      }
    2807 +    },
    2808 +    "node_modules/d3-timer": {
    2809 +      "version": "3.0.1",
    2810 +      "resolved": "https://registry.npmjs.org/d3-timer/-/d3-timer-3.0.1.tgz",
    2811 +      "integrity": "sha512-ndfJ/JxxMd3nw31uyKoY2naivF+r29V+Lc0svZxe1JvvIRmi8hUsrMvdOwgS1o6uBHmiz91geQ0ylPP0aj1VUA==",
    2812 +      "license": "ISC",
    2813 +      "engines": {
    2814 +        "node": ">=12"
    2815 +      }
    2816 +    },
    2817 +    "node_modules/d3-transition": {
    2818 +      "version": "3.0.1",
    2819 +      "resolved": "https://registry.npmjs.org/d3-transition/-/d3-transition-3.0.1.tgz",
    2820 +      "integrity": "sha512-ApKvfjsSR6tg06xrL434C0WydLr7JewBB3V+/39RMHsaXTOG0zmt/OAXeng5M5LBm0ojmxJrpomQVZ1aPvBL4w==",
    2821 +      "license": "ISC",
    2822 +      "dependencies": {
    2823 +        "d3-color": "1 - 3",
    2824 +        "d3-dispatch": "1 - 3",
    2825 +        "d3-ease": "1 - 3",
    2826 +        "d3-interpolate": "1 - 3",
    2827 +        "d3-timer": "1 - 3"
    2828 +      },
    2829 +      "engines": {
    2830 +        "node": ">=12"
    2831 +      },
    2832 +      "peerDependencies": {
    2833 +        "d3-selection": "2 - 3"
    2834 +      }
    2835 +    },
    2836 +    "node_modules/d3-zoom": {
    2837 +      "version": "3.0.0",
    2838 +      "resolved": "https://registry.npmjs.org/d3-zoom/-/d3-zoom-3.0.0.tgz",
    2839 +      "integrity": "sha512-b8AmV3kfQaqWAuacbPuNbL6vahnOJflOhexLzMMNLga62+/nh0JzvJ0aO/5a5MVgUFGS7Hu1P9P03o3fJkDCyw==",
    2840 +      "license": "ISC",
    2841 +      "dependencies": {
    2842 +        "d3-dispatch": "1 - 3",
    2843 +        "d3-drag": "2 - 3",
    2844 +        "d3-interpolate": "1 - 3",
    2845 +        "d3-selection": "2 - 3",
    2846 +        "d3-transition": "2 - 3"
    2847 +      },
    2848 +      "engines": {
    2849 +        "node": ">=12"
    2850 +      }
    2851 +    },
    2852 +    "node_modules/dagre-d3-es": {
    2853 +      "version": "7.0.13",
    2854 +      "resolved": "https://registry.npmjs.org/dagre-d3-es/-/dagre-d3-es-7.0.13.tgz",
    2855 +      "integrity": "sha512-efEhnxpSuwpYOKRm/L5KbqoZmNNukHa/Flty4Wp62JRvgH2ojwVgPgdYyr4twpieZnyRDdIH7PY2mopX26+j2Q==",
    2856 +      "license": "MIT",
    2857 +      "dependencies": {
    2858 +        "d3": "^7.9.0",
    2859 +        "lodash-es": "^4.17.21"
    2860 +      }
    2861 +    },
1876 2862      "node_modules/data-urls": {
1877 2863        "version": "6.0.0",
1878 2864        "resolved": "https://registry.npmjs.org/data-urls/-/data-urls-6.0.0.tgz",
@@ -1887,6 +2873,12 @@
1887 2873          "node": ">=20"
1888 2874        }
1889 2875      },
    2876 +    "node_modules/dayjs": {
    2877 +      "version": "1.11.19",
    2878 +      "resolved": "https://registry.npmjs.org/dayjs/-/dayjs-1.11.19.tgz",
    2879 +      "integrity": "sha512-t5EcLVS6QPBNqM2z8fakk/NKel+Xzshgt8FFKAn+qwlD1pzZWxh0nVCrvFK7ZDb6XucZeF9z8C7CBWTRIVApAw==",
    2880 +      "license": "MIT"
    2881 +    },
1890 2882      "node_modules/debug": {
1891 2883        "version": "4.4.3",
1892 2884        "resolved": "https://registry.npmjs.org/debug/-/debug-4.4.3.tgz",
@@ -1919,6 +2911,15 @@
1919 2911        "dev": true,
1920 2912        "license": "MIT"
1921 2913      },
    2914 +    "node_modules/delaunator": {
    2915 +      "version": "5.0.1",
    2916 +      "resolved": "https://registry.npmjs.org/delaunator/-/delaunator-5.0.1.tgz",
    2917 +      "integrity": "sha512-8nvh+XBe96aCESrGOqMp/84b13H9cdKbG5P2ejQCh4d4sK9RL4371qou9drQjMhvnPmhWl5hnmqbEE0fXr9Xnw==",
    2918 +      "license": "ISC",
    2919 +      "dependencies": {
    2920 +        "robust-predicates": "^3.0.2"
    2921 +      }
    2922 +    },
1922 2923      "node_modules/depd": {
1923 2924        "version": "2.0.0",
1924 2925        "resolved": "https://registry.npmjs.org/depd/-/depd-2.0.0.tgz",
@@ -2365,6 +3366,17 @@
2365 3366        "dev": true,
2366 3367        "license": "MIT"
2367 3368      },
    3369 +    "node_modules/fast-png": {
    3370 +      "version": "6.4.0",
    3371 +      "resolved": "https://registry.npmjs.org/fast-png/-/fast-png-6.4.0.tgz",
    3372 +      "integrity": "sha512-kAqZq1TlgBjZcLr5mcN6NP5Rv4V2f22z00c3g8vRrwkcqjerx7BEhPbOnWCPqaHUl2XWQBJQvOT/FQhdMT7X/Q==",
    3373 +      "license": "MIT",
    3374 +      "dependencies": {
    3375 +        "@types/pako": "^2.0.3",
    3376 +        "iobuffer": "^5.3.2",
    3377 +        "pako": "^2.1.0"
    3378 +      }
    3379 +    },
2368 3380      "node_modules/fdir": {
2369 3381        "version": "6.5.0",
2370 3382        "resolved": "https://registry.npmjs.org/fdir/-/fdir-6.5.0.tgz",
@@ -2387,7 +3399,6 @@
2387 3399        "version": "0.8.2",
2388 3400        "resolved": "https://registry.npmjs.org/fflate/-/fflate-0.8.2.tgz",
2389 3401        "integrity": "sha512-cPJU47OaAoCbg0pBvzsgpTPhmhqI5eJjh/JIu8tPj5q+T7iLvW/JAYUqmE7KOB4R1ZyEhzBaIQpQpardBF5z8A==",
2390     -      "dev": true,
2391 3402        "license": "MIT"
2392 3403      },
2393 3404      "node_modules/file-entry-cache": {
@@ -2600,6 +3611,12 @@
2600 3611          "url": "https://github.com/sponsors/ljharb"
2601 3612        }
2602 3613      },
    3614 +    "node_modules/hachure-fill": {
    3615 +      "version": "0.5.2",
    3616 +      "resolved": "https://registry.npmjs.org/hachure-fill/-/hachure-fill-0.5.2.tgz",
    3617 +      "integrity": "sha512-3GKBOn+m2LX9iq+JC1064cSFprJY4jL1jCXTcpnfER5HYE2l/4EfWSGzkPa/ZDBmYI0ZOEj5VHV/eKnPGkHuOg==",
    3618 +      "license": "MIT"
    3619 +    },
2603 3620      "node_modules/has-flag": {
2604 3621        "version": "4.0.0",
2605 3622        "resolved": "https://registry.npmjs.org/has-flag/-/has-flag-4.0.0.tgz",
@@ -2656,6 +3673,29 @@
2656 3673        "dev": true,
2657 3674        "license": "MIT"
2658 3675      },
    3676 +    "node_modules/html2canvas": {
    3677 +      "version": "1.4.1",
    3678 +      "resolved": "https://registry.npmjs.org/html2canvas/-/html2canvas-1.4.1.tgz",
    3679 +      "integrity": "sha512-fPU6BHNpsyIhr8yyMpTLLxAbkaK8ArIBcmZIRiBLiDhjeqvXolaEmDGmELFuX9I4xDcaKKcJl+TKZLqruBbmWA==",
    3680 +      "license": "MIT",
    3681 +      "dependencies": {
    3682 +        "css-line-break": "^2.1.0",
    3683 +        "text-segmentation": "^1.0.3"
    3684 +      },
    3685 +      "engines": {
    3686 +        "node": ">=8.0.0"
    3687 +      }
    3688 +    },
    3689 +    "node_modules/html2pdf.js": {
    3690 +      "version": "0.12.1",
    3691 +      "resolved": "https://registry.npmjs.org/html2pdf.js/-/html2pdf.js-0.12.1.tgz",
    3692 +      "integrity": "sha512-3rBWQ96H5oOU9jtoz3MnE/epGi27ig9h8aonBk4JTpvUERM3lMRxhIRckhJZEi4wE0YfRINoYOIDY0hLY0CHgQ==",
    3693 +      "license": "MIT",
    3694 +      "dependencies": {
    3695 +        "html2canvas": "^1.0.0",
    3696 +        "jspdf": "^3.0.0"
    3697 +      }
    3698 +    },
2659 3699      "node_modules/http-errors": {
2660 3700        "version": "2.0.0",
2661 3701        "resolved": "https://registry.npmjs.org/http-errors/-/http-errors-2.0.0.tgz",
@@ -2705,7 +3745,6 @@
2705 3745        "version": "0.6.3",
2706 3746        "resolved": "https://registry.npmjs.org/iconv-lite/-/iconv-lite-0.6.3.tgz",
2707 3747        "integrity": "sha512-4fCk79wshMdzMp2rH06qWrJE4iolqLhCUH+OiuIgU++RB0+94NlDL81atO7GX55uUKueo0txHNtvEyI6D7WdMw==",
2708     -      "dev": true,
2709 3748        "license": "MIT",
2710 3749        "dependencies": {
2711 3750          "safer-buffer": ">= 2.1.2 < 3.0.0"
@@ -2758,6 +3797,21 @@
2758 3797        "dev": true,
2759 3798        "license": "ISC"
2760 3799      },
    3800 +    "node_modules/internmap": {
    3801 +      "version": "2.0.3",
    3802 +      "resolved": "https://registry.npmjs.org/internmap/-/internmap-2.0.3.tgz",
    3803 +      "integrity": "sha512-5Hh7Y1wQbvY5ooGgPbDaL5iYLAPzMTUrjMulskHLH6wnv/A+1q5rgEaiuqEjB+oxGXIVZs1FF+R/KPN3ZSQYYg==",
    3804 +      "license": "ISC",
    3805 +      "engines": {
    3806 +        "node": ">=12"
    3807 +      }
    3808 +    },
    3809 +    "node_modules/iobuffer": {
    3810 +      "version": "5.4.0",
    3811 +      "resolved": "https://registry.npmjs.org/iobuffer/-/iobuffer-5.4.0.tgz",
    3812 +      "integrity": "sha512-DRebOWuqDvxunfkNJAlc3IzWIPD5xVxwUNbHr7xKB8E6aLJxIPfNX3CoMJghcFjpv6RWQsrcJbghtEwSPoJqMA==",
    3813 +      "license": "MIT"
    3814 +    },
2761 3815      "node_modules/ipaddr.js": {
2762 3816        "version": "1.9.1",
2763 3817        "resolved": "https://registry.npmjs.org/ipaddr.js/-/ipaddr.js-1.9.1.tgz",
@@ -2940,6 +3994,39 @@
2940 3994        "dev": true,
2941 3995        "license": "MIT"
2942 3996      },
    3997 +    "node_modules/jspdf": {
    3998 +      "version": "3.0.4",
    3999 +      "resolved": "https://registry.npmjs.org/jspdf/-/jspdf-3.0.4.tgz",
    4000 +      "integrity": "sha512-dc6oQ8y37rRcHn316s4ngz/nOjayLF/FFxBF4V9zamQKRqXxyiH1zagkCdktdWhtoQId5K20xt1lB90XzkB+hQ==",
    4001 +      "license": "MIT",
    4002 +      "dependencies": {
    4003 +        "@babel/runtime": "^7.28.4",
    4004 +        "fast-png": "^6.2.0",
    4005 +        "fflate": "^0.8.1"
    4006 +      },
    4007 +      "optionalDependencies": {
    4008 +        "canvg": "^3.0.11",
    4009 +        "core-js": "^3.6.0",
    4010 +        "dompurify": "^3.2.4",
    4011 +        "html2canvas": "^1.0.0-rc.5"
    4012 +      }
    4013 +    },
    4014 +    "node_modules/katex": {
    4015 +      "version": "0.16.27",
    4016 +      "resolved": "https://registry.npmjs.org/katex/-/katex-0.16.27.tgz",
    4017 +      "integrity": "sha512-aeQoDkuRWSqQN6nSvVCEFvfXdqo1OQiCmmW1kc9xSdjutPv7BGO7pqY9sQRJpMOGrEdfDgF2TfRXe5eUAD2Waw==",
    4018 +      "funding": [
    4019 +        "https://opencollective.com/katex",
    4020 +        "https://github.com/sponsors/katex"
    4021 +      ],
    4022 +      "license": "MIT",
    4023 +      "dependencies": {
    4024 +        "commander": "^8.3.0"
    4025 +      },
    4026 +      "bin": {
    4027 +        "katex": "cli.js"
    4028 +      }
    4029 +    },
2943 4030      "node_modules/keyv": {
2944 4031        "version": "4.5.4",
2945 4032        "resolved": "https://registry.npmjs.org/keyv/-/keyv-4.5.4.tgz",
@@ -2950,6 +4037,33 @@
2950 4037          "json-buffer": "3.0.1"
2951 4038        }
2952 4039      },
    4040 +    "node_modules/khroma": {
    4041 +      "version": "2.1.0",
    4042 +      "resolved": "https://registry.npmjs.org/khroma/-/khroma-2.1.0.tgz",
    4043 +      "integrity": "sha512-Ls993zuzfayK269Svk9hzpeGUKob/sIgZzyHYdjQoAdQetRKpOLj+k/QQQ/6Qi0Yz65mlROrfd+Ev+1+7dz9Kw=="
    4044 +    },
    4045 +    "node_modules/langium": {
    4046 +      "version": "3.3.1",
    4047 +      "resolved": "https://registry.npmjs.org/langium/-/langium-3.3.1.tgz",
    4048 +      "integrity": "sha512-QJv/h939gDpvT+9SiLVlY7tZC3xB2qK57v0J04Sh9wpMb6MP1q8gB21L3WIo8T5P1MSMg3Ep14L7KkDCFG3y4w==",
    4049 +      "license": "MIT",
    4050 +      "dependencies": {
    4051 +        "chevrotain": "~11.0.3",
    4052 +        "chevrotain-allstar": "~0.3.0",
    4053 +        "vscode-languageserver": "~9.0.1",
    4054 +        "vscode-languageserver-textdocument": "~1.0.11",
    4055 +        "vscode-uri": "~3.0.8"
    4056 +      },
    4057 +      "engines": {
    4058 +        "node": ">=16.0.0"
    4059 +      }
    4060 +    },
    4061 +    "node_modules/layout-base": {
    4062 +      "version": "1.0.2",
    4063 +      "resolved": "https://registry.npmjs.org/layout-base/-/layout-base-1.0.2.tgz",
    4064 +      "integrity": "sha512-8h2oVEZNktL4BH2JCOI90iD1yXwL6iNW7KcCKT2QZgQJR2vbqDsldCTPRU9NifTCqHZci57XvQQ15YTu+sTYPg==",
    4065 +      "license": "MIT"
    4066 +    },
2953 4067      "node_modules/levn": {
2954 4068        "version": "0.4.1",
2955 4069        "resolved": "https://registry.npmjs.org/levn/-/levn-0.4.1.tgz",
@@ -2980,6 +4094,12 @@
2980 4094          "url": "https://github.com/sponsors/sindresorhus"
2981 4095        }
2982 4096      },
    4097 +    "node_modules/lodash-es": {
    4098 +      "version": "4.17.21",
    4099 +      "resolved": "https://registry.npmjs.org/lodash-es/-/lodash-es-4.17.21.tgz",
    4100 +      "integrity": "sha512-mKnC+QJ9pWVzv+C4/U3rRsHapFfHvQFoFB92e52xeyGMcX6/OlIl78je1u8vePzYZSkkogMPJ2yjxxsb89cxyw==",
    4101 +      "license": "MIT"
    4102 +    },
2983 4103      "node_modules/lodash.merge": {
2984 4104        "version": "4.6.2",
2985 4105        "resolved": "https://registry.npmjs.org/lodash.merge/-/lodash.merge-4.6.2.tgz",
@@ -3040,7 +4160,6 @@
3040 4160        "resolved": "https://registry.npmjs.org/marked/-/marked-17.0.1.tgz",
3041 4161        "integrity": "sha512-boeBdiS0ghpWcSwoNm/jJBwdpFaMnZWRzjA6SkUMYb40SVaN1x7mmfGKp0jvexGcx+7y2La5zRZsYFZI6Qpypg==",
3042 4162        "license": "MIT",
3043     -      "peer": true,
3044 4163        "bin": {
3045 4164          "marked": "bin/marked.js"
3046 4165        },
@@ -3094,6 +4213,46 @@
3094 4213          "url": "https://github.com/sponsors/sindresorhus"
3095 4214        }
3096 4215      },
    4216 +    "node_modules/mermaid": {
    4217 +      "version": "11.12.2",
    4218 +      "resolved": "https://registry.npmjs.org/mermaid/-/mermaid-11.12.2.tgz",
    4219 +      "integrity": "sha512-n34QPDPEKmaeCG4WDMGy0OT6PSyxKCfy2pJgShP+Qow2KLrvWjclwbc3yXfSIf4BanqWEhQEpngWwNp/XhZt6w==",
    4220 +      "license": "MIT",
    4221 +      "dependencies": {
    4222 +        "@braintree/sanitize-url": "^7.1.1",
    4223 +        "@iconify/utils": "^3.0.1",
    4224 +        "@mermaid-js/parser": "^0.6.3",
    4225 +        "@types/d3": "^7.4.3",
    4226 +        "cytoscape": "^3.29.3",
    4227 +        "cytoscape-cose-bilkent": "^4.1.0",
    4228 +        "cytoscape-fcose": "^2.2.0",
    4229 +        "d3": "^7.9.0",
    4230 +        "d3-sankey": "^0.12.3",
    4231 +        "dagre-d3-es": "7.0.13",
    4232 +        "dayjs": "^1.11.18",
    4233 +        "dompurify": "^3.2.5",
    4234 +        "katex": "^0.16.22",
    4235 +        "khroma": "^2.1.0",
    4236 +        "lodash-es": "^4.17.21",
    4237 +        "marked": "^16.2.1",
    4238 +        "roughjs": "^4.6.6",
    4239 +        "stylis": "^4.3.6",
    4240 +        "ts-dedent": "^2.2.0",
    4241 +        "uuid": "^11.1.0"
    4242 +      }
    4243 +    },
    4244 +    "node_modules/mermaid/node_modules/marked": {
    4245 +      "version": "16.4.2",
    4246 +      "resolved": "https://registry.npmjs.org/marked/-/marked-16.4.2.tgz",
    4247 +      "integrity": "sha512-TI3V8YYWvkVf3KJe1dRkpnjs68JUPyEa5vjKrp1XEEJUAOaQc+Qj+L1qWbPd0SJuAdQkFU0h73sXXqwDYxsiDA==",
    4248 +      "license": "MIT",
    4249 +      "bin": {
    4250 +        "marked": "bin/marked.js"
    4251 +      },
    4252 +      "engines": {
    4253 +        "node": ">= 20"
    4254 +      }
    4255 +    },
3097 4256      "node_modules/methods": {
3098 4257        "version": "1.1.2",
3099 4258        "resolved": "https://registry.npmjs.org/methods/-/methods-1.1.2.tgz",
@@ -3153,6 +4312,18 @@
3153 4312          "node": "*"
3154 4313        }
3155 4314      },
    4315 +    "node_modules/mlly": {
    4316 +      "version": "1.8.0",
    4317 +      "resolved": "https://registry.npmjs.org/mlly/-/mlly-1.8.0.tgz",
    4318 +      "integrity": "sha512-l8D9ODSRWLe2KHJSifWGwBqpTZXIXTeo8mlKjY+E2HAakaTeNpqAyBZ8GSqLzHgw4XmHmC8whvpjJNMbFZN7/g==",
    4319 +      "license": "MIT",
    4320 +      "dependencies": {
    4321 +        "acorn": "^8.15.0",
    4322 +        "pathe": "^2.0.3",
    4323 +        "pkg-types": "^1.3.1",
    4324 +        "ufo": "^1.6.1"
    4325 +      }
    4326 +    },
3156 4327      "node_modules/mrmime": {
3157 4328        "version": "2.0.1",
3158 4329        "resolved": "https://registry.npmjs.org/mrmime/-/mrmime-2.0.1.tgz",
@@ -3292,6 +4463,18 @@
3292 4463          "url": "https://github.com/sponsors/sindresorhus"
3293 4464        }
3294 4465      },
    4466 +    "node_modules/package-manager-detector": {
    4467 +      "version": "1.6.0",
    4468 +      "resolved": "https://registry.npmjs.org/package-manager-detector/-/package-manager-detector-1.6.0.tgz",
    4469 +      "integrity": "sha512-61A5ThoTiDG/C8s8UMZwSorAGwMJ0ERVGj2OjoW5pAalsNOg15+iQiPzrLJ4jhZ1HJzmC2PIHT2oEiH3R5fzNA==",
    4470 +      "license": "MIT"
    4471 +    },
    4472 +    "node_modules/pako": {
    4473 +      "version": "2.1.0",
    4474 +      "resolved": "https://registry.npmjs.org/pako/-/pako-2.1.0.tgz",
    4475 +      "integrity": "sha512-w+eufiZ1WuJYgPXbV/PO3NCMEc3xqylkKHzp8bxp1uW4qaSNQUkwmLLEc3kKsfz8lpV1F8Ht3U1Cm+9Srog2ug==",
    4476 +      "license": "(MIT AND Zlib)"
    4477 +    },
3295 4478      "node_modules/parent-module": {
3296 4479        "version": "1.0.1",
3297 4480        "resolved": "https://registry.npmjs.org/parent-module/-/parent-module-1.0.1.tgz",
@@ -3328,6 +4511,12 @@
3328 4511          "node": ">= 0.8"
3329 4512        }
3330 4513      },
    4514 +    "node_modules/path-data-parser": {
    4515 +      "version": "0.1.0",
    4516 +      "resolved": "https://registry.npmjs.org/path-data-parser/-/path-data-parser-0.1.0.tgz",
    4517 +      "integrity": "sha512-NOnmBpt5Y2RWbuv0LMzsayp3lVylAHLPUTut412ZA3l+C4uw4ZVkQbjShYCQ8TCpUMdPapr4YjUqLYD6v68j+w==",
    4518 +      "license": "MIT"
    4519 +    },
3331 4520      "node_modules/path-exists": {
3332 4521        "version": "4.0.0",
3333 4522        "resolved": "https://registry.npmjs.org/path-exists/-/path-exists-4.0.0.tgz",
@@ -3359,9 +4548,15 @@
3359 4548        "version": "2.0.3",
3360 4549        "resolved": "https://registry.npmjs.org/pathe/-/pathe-2.0.3.tgz",
3361 4550        "integrity": "sha512-WUjGcAqP1gQacoQe+OBJsFA7Ld4DyXuUIjZ5cc75cLHvJ7dtNsTugphxIADwspS+AraAUePCKrSVtPLFj/F88w==",
3362     -      "dev": true,
3363 4551        "license": "MIT"
3364 4552      },
    4553 +    "node_modules/performance-now": {
    4554 +      "version": "2.1.0",
    4555 +      "resolved": "https://registry.npmjs.org/performance-now/-/performance-now-2.1.0.tgz",
    4556 +      "integrity": "sha512-7EAHlyLHI56VEIdK57uwHdHKIaAGbnXPiw0yWbarQZOKaKpvUIgW0jWRVLiatnM+XXlSwsanIBH/hzGMJulMow==",
    4557 +      "license": "MIT",
    4558 +      "optional": true
    4559 +    },
3365 4560      "node_modules/picocolors": {
3366 4561        "version": "1.1.1",
3367 4562        "resolved": "https://registry.npmjs.org/picocolors/-/picocolors-1.1.1.tgz",
@@ -3382,6 +4577,33 @@
3382 4577          "url": "https://github.com/sponsors/jonschlinkert"
3383 4578        }
3384 4579      },
    4580 +    "node_modules/pkg-types": {
    4581 +      "version": "1.3.1",
    4582 +      "resolved": "https://registry.npmjs.org/pkg-types/-/pkg-types-1.3.1.tgz",
    4583 +      "integrity": "sha512-/Jm5M4RvtBFVkKWRu2BLUTNP8/M2a+UwuAX+ae4770q1qVGtfjG+WTCupoZixokjmHiry8uI+dlY8KXYV5HVVQ==",
    4584 +      "license": "MIT",
    4585 +      "dependencies": {
    4586 +        "confbox": "^0.1.8",
    4587 +        "mlly": "^1.7.4",
    4588 +        "pathe": "^2.0.1"
    4589 +      }
    4590 +    },
    4591 +    "node_modules/points-on-curve": {
    4592 +      "version": "0.2.0",
    4593 +      "resolved": "https://registry.npmjs.org/points-on-curve/-/points-on-curve-0.2.0.tgz",
    4594 +      "integrity": "sha512-0mYKnYYe9ZcqMCWhUjItv/oHjvgEsfKvnUTg8sAtnHr3GVy7rGkXCb6d5cSyqrWqL4k81b9CPg3urd+T7aop3A==",
    4595 +      "license": "MIT"
    4596 +    },
    4597 +    "node_modules/points-on-path": {
    4598 +      "version": "0.2.1",
    4599 +      "resolved": "https://registry.npmjs.org/points-on-path/-/points-on-path-0.2.1.tgz",
    4600 +      "integrity": "sha512-25ClnWWuw7JbWZcgqY/gJ4FQWadKxGWk+3kR/7kD0tCaDtPPMj7oHu2ToLaVhfpnHrZzYby2w6tUA0eOIuUg8g==",
    4601 +      "license": "MIT",
    4602 +      "dependencies": {
    4603 +        "path-data-parser": "0.1.0",
    4604 +        "points-on-curve": "0.2.0"
    4605 +      }
    4606 +    },
3385 4607      "node_modules/postcss": {
3386 4608        "version": "8.5.6",
3387 4609        "resolved": "https://registry.npmjs.org/postcss/-/postcss-8.5.6.tgz",
@@ -3437,6 +4659,15 @@
3437 4659          "url": "https://github.com/prettier/prettier?sponsor=1"
3438 4660        }
3439 4661      },
    4662 +    "node_modules/prismjs": {
    4663 +      "version": "1.30.0",
    4664 +      "resolved": "https://registry.npmjs.org/prismjs/-/prismjs-1.30.0.tgz",
    4665 +      "integrity": "sha512-DEvV2ZF2r2/63V+tK8hQvrR2ZGn10srHbXviTlcv7Kpzw8jWiNTqbVgjO3IY8RxrrOUF8VPMQQFysYYYv0YZxw==",
    4666 +      "license": "MIT",
    4667 +      "engines": {
    4668 +        "node": ">=6"
    4669 +      }
    4670 +    },
3440 4671      "node_modules/proxy-addr": {
3441 4672        "version": "2.0.7",
3442 4673        "resolved": "https://registry.npmjs.org/proxy-addr/-/proxy-addr-2.0.7.tgz",
@@ -3477,6 +4708,16 @@
3477 4708          "url": "https://github.com/sponsors/ljharb"
3478 4709        }
3479 4710      },
    4711 +    "node_modules/raf": {
    4712 +      "version": "3.4.1",
    4713 +      "resolved": "https://registry.npmjs.org/raf/-/raf-3.4.1.tgz",
    4714 +      "integrity": "sha512-Sq4CW4QhwOHE8ucn6J34MqtZCeWFP2aQSmrlroYgqAV1PjStIhJXxYuTgUIfkEk7zTLjmIjLmU5q+fbD1NnOJA==",
    4715 +      "license": "MIT",
    4716 +      "optional": true,
    4717 +      "dependencies": {
    4718 +        "performance-now": "^2.1.0"
    4719 +      }
    4720 +    },
3480 4721      "node_modules/range-parser": {
3481 4722        "version": "1.2.1",
3482 4723        "resolved": "https://registry.npmjs.org/range-parser/-/range-parser-1.2.1.tgz",
@@ -3516,6 +4757,13 @@
3516 4757          "node": ">=0.10.0"
3517 4758        }
3518 4759      },
    4760 +    "node_modules/regenerator-runtime": {
    4761 +      "version": "0.13.11",
    4762 +      "resolved": "https://registry.npmjs.org/regenerator-runtime/-/regenerator-runtime-0.13.11.tgz",
    4763 +      "integrity": "sha512-kY1AZVr2Ra+t+piVaJ4gxaFaReZVH40AKNo7UCX6W+dEwBo/2oZJzqfuN1qLq1oL45o56cPaTXELwrTh8Fpggg==",
    4764 +      "license": "MIT",
    4765 +      "optional": true
    4766 +    },
3519 4767      "node_modules/require-from-string": {
3520 4768        "version": "2.0.2",
3521 4769        "resolved": "https://registry.npmjs.org/require-from-string/-/require-from-string-2.0.2.tgz",
@@ -3536,6 +4784,22 @@
3536 4784          "node": ">=4"
3537 4785        }
3538 4786      },
    4787 +    "node_modules/rgbcolor": {
    4788 +      "version": "1.0.1",
    4789 +      "resolved": "https://registry.npmjs.org/rgbcolor/-/rgbcolor-1.0.1.tgz",
    4790 +      "integrity": "sha512-9aZLIrhRaD97sgVhtJOW6ckOEh6/GnvQtdVNfdZ6s67+3/XwLS9lBcQYzEEhYVeUowN7pRzMLsyGhK2i/xvWbw==",
    4791 +      "license": "MIT OR SEE LICENSE IN FEEL-FREE.md",
    4792 +      "optional": true,
    4793 +      "engines": {
    4794 +        "node": ">= 0.8.15"
    4795 +      }
    4796 +    },
    4797 +    "node_modules/robust-predicates": {
    4798 +      "version": "3.0.2",
    4799 +      "resolved": "https://registry.npmjs.org/robust-predicates/-/robust-predicates-3.0.2.tgz",
    4800 +      "integrity": "sha512-IXgzBWvWQwE6PrDI05OvmXUIruQTcoMDzRsOd5CDvHCVLcLHMTSYvOK5Cm46kWqlV3yAbuSpBZdJ5oP5OUoStg==",
    4801 +      "license": "Unlicense"
    4802 +    },
3539 4803      "node_modules/rollup": {
3540 4804        "version": "4.53.1",
3541 4805        "resolved": "https://registry.npmjs.org/rollup/-/rollup-4.53.1.tgz",
@@ -3578,6 +4842,24 @@
3578 4842          "fsevents": "~2.3.2"
3579 4843        }
3580 4844      },
    4845 +    "node_modules/roughjs": {
    4846 +      "version": "4.6.6",
    4847 +      "resolved": "https://registry.npmjs.org/roughjs/-/roughjs-4.6.6.tgz",
    4848 +      "integrity": "sha512-ZUz/69+SYpFN/g/lUlo2FXcIjRkSu3nDarreVdGGndHEBJ6cXPdKguS8JGxwj5HA5xIbVKSmLgr5b3AWxtRfvQ==",
    4849 +      "license": "MIT",
    4850 +      "dependencies": {
    4851 +        "hachure-fill": "^0.5.2",
    4852 +        "path-data-parser": "^0.1.0",
    4853 +        "points-on-curve": "^0.2.0",
    4854 +        "points-on-path": "^0.2.1"
    4855 +      }
    4856 +    },
    4857 +    "node_modules/rw": {
    4858 +      "version": "1.3.3",
    4859 +      "resolved": "https://registry.npmjs.org/rw/-/rw-1.3.3.tgz",
    4860 +      "integrity": "sha512-PdhdWy89SiZogBLaw42zdeqtRJ//zFd2PgQavcICDUgJT5oW10QCRKbJ6bg4r0/UY2M6BWd5tkxuGFRvCkgfHQ==",
    4861 +      "license": "BSD-3-Clause"
    4862 +    },
3581 4863      "node_modules/safe-buffer": {
3582 4864        "version": "5.2.1",
3583 4865        "resolved": "https://registry.npmjs.org/safe-buffer/-/safe-buffer-5.2.1.tgz",
@@ -3603,7 +4885,6 @@
3603 4885        "version": "2.1.2",
3604 4886        "resolved": "https://registry.npmjs.org/safer-buffer/-/safer-buffer-2.1.2.tgz",
3605 4887        "integrity": "sha512-YZo3K82SD7Riyi0E1EQPojLz7kpepnSQI9IyPbHHg1XXXevb5dJI7tpyN2ADxGcQbHG7vcyRHk0cbwqcQriUtg==",
3606     -      "dev": true,
3607 4888        "license": "MIT"
3608 4889      },
3609 4890      "node_modules/saxes": {
@@ -3845,6 +5126,16 @@
3845 5126        "dev": true,
3846 5127        "license": "MIT"
3847 5128      },
    5129 +    "node_modules/stackblur-canvas": {
    5130 +      "version": "2.7.0",
    5131 +      "resolved": "https://registry.npmjs.org/stackblur-canvas/-/stackblur-canvas-2.7.0.tgz",
    5132 +      "integrity": "sha512-yf7OENo23AGJhBriGx0QivY5JP6Y1HbrrDI6WLt6C5auYZXlQrheoY8hD4ibekFKz1HOfE48Ww8kMWMnJD/zcQ==",
    5133 +      "license": "MIT",
    5134 +      "optional": true,
    5135 +      "engines": {
    5136 +        "node": ">=0.1.14"
    5137 +      }
    5138 +    },
3848 5139      "node_modules/statuses": {
3849 5140        "version": "2.0.1",
3850 5141        "resolved": "https://registry.npmjs.org/statuses/-/statuses-2.0.1.tgz",
@@ -3875,6 +5166,12 @@
3875 5166          "url": "https://github.com/sponsors/sindresorhus"
3876 5167        }
3877 5168      },
    5169 +    "node_modules/stylis": {
    5170 +      "version": "4.3.6",
    5171 +      "resolved": "https://registry.npmjs.org/stylis/-/stylis-4.3.6.tgz",
    5172 +      "integrity": "sha512-yQ3rwFWRfwNUY7H5vpU0wfdkNSnvnJinhF9830Swlaxl03zsOjCfmX0ugac+3LtK0lYSgwL/KXc8oYL3mG4YFQ==",
    5173 +      "license": "MIT"
    5174 +    },
3878 5175      "node_modules/supports-color": {
3879 5176        "version": "7.2.0",
3880 5177        "resolved": "https://registry.npmjs.org/supports-color/-/supports-color-7.2.0.tgz",
@@ -3888,6 +5185,16 @@
3888 5185          "node": ">=8"
3889 5186        }
3890 5187      },
    5188 +    "node_modules/svg-pathdata": {
    5189 +      "version": "6.0.3",
    5190 +      "resolved": "https://registry.npmjs.org/svg-pathdata/-/svg-pathdata-6.0.3.tgz",
    5191 +      "integrity": "sha512-qsjeeq5YjBZ5eMdFuUa4ZosMLxgr5RZ+F+Y1OrDhuOCEInRMA3x74XdBtggJcj9kOeInz0WE+LgCPDkZFlBYJw==",
    5192 +      "license": "MIT",
    5193 +      "optional": true,
    5194 +      "engines": {
    5195 +        "node": ">=12.0.0"
    5196 +      }
    5197 +    },
3891 5198      "node_modules/symbol-tree": {
3892 5199        "version": "3.2.4",
3893 5200        "resolved": "https://registry.npmjs.org/symbol-tree/-/symbol-tree-3.2.4.tgz",
@@ -3895,6 +5202,15 @@
3895 5202        "dev": true,
3896 5203        "license": "MIT"
3897 5204      },
    5205 +    "node_modules/text-segmentation": {
    5206 +      "version": "1.0.3",
    5207 +      "resolved": "https://registry.npmjs.org/text-segmentation/-/text-segmentation-1.0.3.tgz",
    5208 +      "integrity": "sha512-iOiPUo/BGnZ6+54OsWxZidGCsdU8YbE4PSpdPinp7DeMtUJNJBoJ/ouUSTJjHkh1KntHaltHl/gDs2FC4i5+Nw==",
    5209 +      "license": "MIT",
    5210 +      "dependencies": {
    5211 +        "utrie": "^1.0.2"
    5212 +      }
    5213 +    },
3898 5214      "node_modules/tinybench": {
3899 5215        "version": "2.9.0",
3900 5216        "resolved": "https://registry.npmjs.org/tinybench/-/tinybench-2.9.0.tgz",
@@ -4002,6 +5318,15 @@
4002 5318          "node": ">=20"
4003 5319        }
4004 5320      },
    5321 +    "node_modules/ts-dedent": {
    5322 +      "version": "2.2.0",
    5323 +      "resolved": "https://registry.npmjs.org/ts-dedent/-/ts-dedent-2.2.0.tgz",
    5324 +      "integrity": "sha512-q5W7tVM71e2xjHZTlgfTDoPF/SmqKG5hddq9SzR49CH2hayqRKJtQ4mtRlSxKaJlR/+9rEM+mnBHf7I2/BQcpQ==",
    5325 +      "license": "MIT",
    5326 +      "engines": {
    5327 +        "node": ">=6.10"
    5328 +      }
    5329 +    },
4005 5330      "node_modules/type-check": {
4006 5331        "version": "0.4.0",
4007 5332        "resolved": "https://registry.npmjs.org/type-check/-/type-check-0.4.0.tgz",
@@ -4043,6 +5368,12 @@
4043 5368          "node": ">=14.17"
4044 5369        }
4045 5370      },
    5371 +    "node_modules/ufo": {
    5372 +      "version": "1.6.1",
    5373 +      "resolved": "https://registry.npmjs.org/ufo/-/ufo-1.6.1.tgz",
    5374 +      "integrity": "sha512-9a4/uxlTWJ4+a5i0ooc1rU7C7YOw3wT+UGqdeNNHWnOF9qcMBgLRS+4IYUqbczewFx4mLEig6gawh7X6mFlEkA==",
    5375 +      "license": "MIT"
    5376 +    },
4046 5377      "node_modules/unpipe": {
4047 5378        "version": "1.0.0",
4048 5379        "resolved": "https://registry.npmjs.org/unpipe/-/unpipe-1.0.0.tgz",
@@ -4073,6 +5404,28 @@
4073 5404          "node": ">= 0.4.0"
4074 5405        }
4075 5406      },
    5407 +    "node_modules/utrie": {
    5408 +      "version": "1.0.2",
    5409 +      "resolved": "https://registry.npmjs.org/utrie/-/utrie-1.0.2.tgz",
    5410 +      "integrity": "sha512-1MLa5ouZiOmQzUbjbu9VmjLzn1QLXBhwpUa7kdLUQK+KQ5KA9I1vk5U4YHe/X2Ch7PYnJfWuWT+VbuxbGwljhw==",
    5411 +      "license": "MIT",
    5412 +      "dependencies": {
    5413 +        "base64-arraybuffer": "^1.0.2"
    5414 +      }
    5415 +    },
    5416 +    "node_modules/uuid": {
    5417 +      "version": "11.1.0",
    5418 +      "resolved": "https://registry.npmjs.org/uuid/-/uuid-11.1.0.tgz",
    5419 +      "integrity": "sha512-0/A9rDy9P7cJ+8w1c9WD9V//9Wj15Ce2MPz8Ri6032usz+NfePxx5AcN3bN+r6ZL6jEo066/yNYB3tn4pQEx+A==",
    5420 +      "funding": [
    5421 +        "https://github.com/sponsors/broofa",
    5422 +        "https://github.com/sponsors/ctavan"
    5423 +      ],
    5424 +      "license": "MIT",
    5425 +      "bin": {
    5426 +        "uuid": "dist/esm/bin/uuid"
    5427 +      }
    5428 +    },
4076 5429      "node_modules/vary": {
4077 5430        "version": "1.1.2",
4078 5431        "resolved": "https://registry.npmjs.org/vary/-/vary-1.1.2.tgz",
@@ -4236,6 +5589,55 @@
4236 5589          }
4237 5590        }
4238 5591      },
    5592 +    "node_modules/vscode-jsonrpc": {
    5593 +      "version": "8.2.0",
    5594 +      "resolved": "https://registry.npmjs.org/vscode-jsonrpc/-/vscode-jsonrpc-8.2.0.tgz",
    5595 +      "integrity": "sha512-C+r0eKJUIfiDIfwJhria30+TYWPtuHJXHtI7J0YlOmKAo7ogxP20T0zxB7HZQIFhIyvoBPwWskjxrvAtfjyZfA==",
    5596 +      "license": "MIT",
    5597 +      "engines": {
    5598 +        "node": ">=14.0.0"
    5599 +      }
    5600 +    },
    5601 +    "node_modules/vscode-languageserver": {
    5602 +      "version": "9.0.1",
    5603 +      "resolved": "https://registry.npmjs.org/vscode-languageserver/-/vscode-languageserver-9.0.1.tgz",
    5604 +      "integrity": "sha512-woByF3PDpkHFUreUa7Hos7+pUWdeWMXRd26+ZX2A8cFx6v/JPTtd4/uN0/jB6XQHYaOlHbio03NTHCqrgG5n7g==",
    5605 +      "license": "MIT",
    5606 +      "dependencies": {
    5607 +        "vscode-languageserver-protocol": "3.17.5"
    5608 +      },
    5609 +      "bin": {
    5610 +        "installServerIntoExtension": "bin/installServerIntoExtension"
    5611 +      }
    5612 +    },
    5613 +    "node_modules/vscode-languageserver-protocol": {
    5614 +      "version": "3.17.5",
    5615 +      "resolved": "https://registry.npmjs.org/vscode-languageserver-protocol/-/vscode-languageserver-protocol-3.17.5.tgz",
    5616 +      "integrity": "sha512-mb1bvRJN8SVznADSGWM9u/b07H7Ecg0I3OgXDuLdn307rl/J3A9YD6/eYOssqhecL27hK1IPZAsaqh00i/Jljg==",
    5617 +      "license": "MIT",
    5618 +      "dependencies": {
    5619 +        "vscode-jsonrpc": "8.2.0",
    5620 +        "vscode-languageserver-types": "3.17.5"
    5621 +      }
    5622 +    },
    5623 +    "node_modules/vscode-languageserver-textdocument": {
    5624 +      "version": "1.0.12",
    5625 +      "resolved": "https://registry.npmjs.org/vscode-languageserver-textdocument/-/vscode-languageserver-textdocument-1.0.12.tgz",
    5626 +      "integrity": "sha512-cxWNPesCnQCcMPeenjKKsOCKQZ/L6Tv19DTRIGuLWe32lyzWhihGVJ/rcckZXJxfdKCFvRLS3fpBIsV/ZGX4zA==",
    5627 +      "license": "MIT"
    5628 +    },
    5629 +    "node_modules/vscode-languageserver-types": {
    5630 +      "version": "3.17.5",
    5631 +      "resolved": "https://registry.npmjs.org/vscode-languageserver-types/-/vscode-languageserver-types-3.17.5.tgz",
    5632 +      "integrity": "sha512-Ld1VelNuX9pdF39h2Hgaeb5hEZM2Z3jUrrMgWQAu82jMtZp7p3vJT3BzToKtZI7NgQssZje5o0zryOrhQvzQAg==",
    5633 +      "license": "MIT"
    5634 +    },
    5635 +    "node_modules/vscode-uri": {
    5636 +      "version": "3.0.8",
    5637 +      "resolved": "https://registry.npmjs.org/vscode-uri/-/vscode-uri-3.0.8.tgz",
    5638 +      "integrity": "sha512-AyFQ0EVmsOZOlAnxoFOGOq1SQDWAB7C6aqMGS23svWAllfOaxbuFvcT8D1i8z3Gyn8fraVeZNNmN6e9bxxXkKw==",
    5639 +      "license": "MIT"
    5640 +    },
4239 5641      "node_modules/w3c-xmlserializer": {
4240 5642        "version": "5.0.0",
4241 5643        "resolved": "https://registry.npmjs.org/w3c-xmlserializer/-/w3c-xmlserializer-5.0.0.tgz",
4242 5644  

```


### üìÑ `package.json`

**Type:** Configuration/Data File üìã

```diff
@@ -42,6 +42,11 @@
 42  42    },
 43  43    "dependencies": {
 44  44      "dompurify": "3.3.1",
 45     -    "marked-footnote": "1.4.0"
     45 +    "html2pdf.js": "0.12.1",
     46 +    "katex": "0.16.27",
     47 +    "marked": "17.0.1",
     48 +    "marked-footnote": "1.4.0",
     49 +    "mermaid": "11.12.2",
     50 +    "prismjs": "1.30.0"
 46  51    }
 47  52  }
 48  53  

```


### üìÑ `script.js`

**Type:** JavaScript Source File üü®

```diff
@@ -2,6 +2,26 @@
  2   2  
  3   3  // Import constants, utilities, services, and core modules
  4   4  import DOMPurify from 'dompurify';
      5 +import html2pdf from 'html2pdf.js';
      6 +import katex from 'katex';
      7 +import 'katex/dist/katex.min.css'; // Import KaTeX CSS
      8 +import { marked } from 'marked';
      9 +import markedFootnote from 'marked-footnote';
     10 +import mermaid from 'mermaid';
     11 +import Prism from 'prismjs';
     12 +import 'prismjs/components/prism-bash';
     13 +import 'prismjs/components/prism-c';
     14 +import 'prismjs/components/prism-cpp';
     15 +import 'prismjs/components/prism-css';
     16 +import 'prismjs/components/prism-java';
     17 +import 'prismjs/components/prism-javascript';
     18 +import 'prismjs/components/prism-json';
     19 +import 'prismjs/components/prism-markdown';
     20 +import 'prismjs/components/prism-python';
     21 +import 'prismjs/components/prism-sql';
     22 +import 'prismjs/components/prism-typescript';
     23 +import 'prismjs/themes/prism-tomorrow.css'; // Import Prism CSS
     24 +
  5  25  import { StorageManager } from './src/js/core/StorageManager.js';
  6  26  import { ThemeManager } from './src/js/core/ThemeManager.js';
  7  27  import { FolderBrowserService } from './src/js/services/FolderBrowserService.js';
@@ -9,6 +29,14 @@ import { MermaidService } from './src/js/services/MermaidService.js';
  9  29  import { PDFService } from './src/js/services/PDFService.js';
 10  30  import { PrismService } from './src/js/services/PrismService.js';
 11  31  
     32 +// Make libraries available globally for services if needed (backward compatibility)
     33 +window.marked = marked;
     34 +window.Prism = Prism;
     35 +window.mermaid = mermaid;
     36 +window.katex = katex;
     37 +window.html2pdf = html2pdf;
     38 +window.markedFootnote = markedFootnote;
     39 +
 12  40  // Initialize services and managers
 13  41  const storageManager = new StorageManager();
 14  42  const themeManager = new ThemeManager(storageManager);
@@ -36,61 +64,18 @@ themeManager.setThemeChangeListener(() => {
 36  64    }
 37  65  });
 38  66  
 39     -// Wait for all scripts to load
     67 +// Wait for DOM to be ready
 40  68  window.addEventListener('DOMContentLoaded', () => {
 41  69    initializeApp();
 42  70  });
 43  71  
 44  72  function initializeApp() {
 45     -  // Check if libraries are loaded
 46     -  if (
 47     -    typeof marked === 'undefined' ||
 48     -    typeof Prism === 'undefined' ||
 49     -    typeof mermaid === 'undefined'
 50     -  ) {
 51     -    console.error('Required libraries not loaded. Retrying...');
 52     -    setTimeout(initializeApp, 100);
 53     -    return;
 54     -  }
 55     -
 56     -  // Wait for html2pdf to load before setting up editor
 57     -  if (typeof html2pdf === 'undefined') {
 58     -    console.log('Waiting for html2pdf library...');
 59     -    setTimeout(initializeApp, 100);
 60     -    return;
 61     -  }
 62     -
 63     -  // Wait for KaTeX to load
 64     -  if (typeof katex === 'undefined') {
 65     -    console.log('Waiting for KaTeX library...');
 66     -    setTimeout(initializeApp, 100);
 67     -    return;
 68     -  }
 69     -
 70     -  // Wait for KaTeX auto-render to load
 71     -  if (typeof renderMathInElement === 'undefined') {
 72     -    console.log('Waiting for KaTeX auto-render...');
 73     -    setTimeout(initializeApp, 100);
 74     -    return;
 75     -  }
 76     -
 77     -  console.log('All libraries loaded successfully');
 78     -
 79     -  // Configure Prism autoloader with correct CDN path
 80     -  if (typeof Prism !== 'undefined' && Prism.plugins && Prism.plugins.autoloader) {
 81     -    Prism.plugins.autoloader.languages_path =
 82     -      'https://cdn.jsdelivr.net/npm/prismjs@1.29.0/components/';
 83     -    console.log('‚úÖ Prism autoloader configured - 200+ languages available');
 84     -  }
 85     -
 86     -  console.log('‚úÖ KaTeX loaded - Math formula rendering available');
     73 +  console.log('üöÄ Initializing Enterprise Markdown Viewer...');
 87  74  
 88  75    // Configure marked.js extensions
 89  76    configureMarkedExtensions();
 90  77  
 91     -  // DON'T initialize Mermaid here - let saved theme load first
 92     -  // Mermaid will initialize after theme loads in setupEditor()
 93     -
     78 +  // Setup the editor
 94  79    setupEditor();
 95  80  }
 96  81  
@@ -114,10 +99,8 @@ function debounce(func, wait) {
114  99  // Configure marked.js extensions (math + footnotes + admonitions)
115 100  function configureMarkedExtensions() {
116 101    // Enable footnote support
117     -  if (typeof markedFootnote !== 'undefined') {
118     -    marked.use(markedFootnote());
119     -    console.log('‚úÖ Footnotes enabled');
120     -  }
    102 +  marked.use(markedFootnote());
    103 +  console.log('‚úÖ Footnotes enabled');
121 104  
122 105    // Add GitHub-style admonitions
123 106    marked.use({
@@ -167,11 +150,7 @@ function configureMarkedExtensions() {
167 150    });
168 151    console.log('‚úÖ GitHub admonitions enabled');
169 152  
170     -  // Configure math formulas
171     -  if (typeof katex === 'undefined') {
172     -    console.warn('KaTeX not loaded, math rendering unavailable');
173     -    return;
174     -  }
    153 +  // Configure math formulas (KaTeX is now imported at top level)
175 154  
176 155    // Add inline math and text formatting extensions only
177 156    // LaTeX environments (align, gather, etc.) are not supported by KaTeX
178 157  

```

---

## ü§ñ AI Review Checklist

Please review these changes for:

### üîç Code Quality
- [ ] **Linting Compliance**: No unused imports/variables, proper formatting
- [ ] **Type Safety**: Proper typing throughout (TypeScript/Python type hints)
- [ ] **Best Practices**: Framework-specific conventions and patterns
- [ ] **Performance**: Efficient algorithms, proper memoization
- [ ] **Documentation**: Clear comments and function descriptions

### üêõ Potential Issues
- [ ] **Runtime Errors**: Type mismatches, null/undefined handling
- [ ] **Logic Bugs**: Incorrect calculations, edge cases
- [ ] **Memory Leaks**: Cleanup in lifecycle methods, event listeners
- [ ] **Error Handling**: Proper try-catch blocks, user feedback
- [ ] **Accessibility**: ARIA labels, keyboard navigation, screen readers

### üîí Security & Data
- [ ] **Input Validation**: Sanitization, XSS prevention, SQL injection
- [ ] **Authentication**: Proper access controls and permissions
- [ ] **Privacy**: No sensitive data exposure in logs/client
- [ ] **Dependencies**: Updated packages, vulnerability checks

### üì± UX/UI
- [ ] **Responsive Design**: Mobile/desktop/tablet compatibility
- [ ] **Loading States**: Proper feedback during async operations
- [ ] **Error Messages**: User-friendly error handling and recovery
- [ ] **Performance**: Fast loading, smooth animations

### üí° Suggestions & Improvements
Please provide specific feedback on:
1. Code organization and structure improvements
2. Performance optimization opportunities
3. Security considerations and hardening
4. Testing coverage and strategies
5. Documentation and maintainability

---
*Generated by AI Visual Code Review v2.0 - Unified Export Script*
*Files processed: 6/6 | Errors: 0 | Generated: 2025-12-09T01:41:21.353Z*
