# üîç Code Review - 12/9/2025, 7:02:00 AM

**Project:** AI Visual Code Review
**Generated by:** AI Visual Code Review v2.0

## üìä Change Summary

```
AI_REVIEW.md                                       | 3926 ++++++++++++++++++--
 codebase_audit/audit_summary.md                    |   49 +
 .../deep_dive_reviews/mermaid_service_review.md    |   47 +
 .../deep_dive_reviews/script_js_review.md          |  121 +
 .../deep_dive_reviews/theme_manager_review.md      |   53 +
 codebase_audit/docs_summary.json                   |   12 +
 codebase_audit/future_enhancements_roadmap.md      |   87 +
 codebase_audit/phase3_codebase_review.json         |   68 +
 codebase_audit/phase4_consolidated_findings.md     |   31 +
 codebase_audit/phase4_implementation_plan.md       |   71 +
 codebase_audit/phase5_recommendations.md           |   41 +
 codebase_audit/phase6_final_deliverables.md        |   44 +
 codebase_audit/repo_manifest.json                  |   74 +
 13 files changed, 4282 insertions(+), 342 deletions(-)
```

## üìù Files Changed (13/13 selected)


### üìÑ `AI_REVIEW.md`

**Type:** Documentation üìñ

```diff
@@ -1,4 +1,4 @@
  1     -# üîç Code Review - 12/7/2025, 8:27:20 AM
      1 +# üîç Code Review - 12/7/2025, 9:59:24 AM
  2   2  
  3   3  **Project:** AI Visual Code Review
  4   4  **Generated by:** AI Visual Code Review v2.0
@@ -6,80 +6,953 @@
  6   6  ## üìä Change Summary
  7   7  
  8   8  ```
  9     -memory-bank/activeContext.md |  52 +++++++++-
 10     - script.js                    | 231 +++++--------------------------------------
 11     - themes/sunset-dark.css       |   2 +-
 12     - 3 files changed, 75 insertions(+), 210 deletions(-)
      9 +AI_REVIEW.md                                       | 428 +++++++++++++++++----
     10 + docs/02-architecture/mermaid-theme-architecture.md | 208 ++++++++++
     11 + docs/02-architecture/prism-token-architecture.md   | 226 +++++++++++
     12 + script.js                                          |  52 ++-
     13 + src/js/services/MermaidService.js                  | 230 +++++++++--
     14 + style.css                                          | 147 ++++---
     15 + themes/default-dark.css                            | 186 ++++++++-
     16 + themes/default-light.css                           | 186 ++++++++-
     17 + themes/forest-dark.css                             | 167 ++++++--
     18 + themes/forest-light.css                            | 138 ++++++-
     19 + themes/neon-dark.css                               | 166 ++++++--
     20 + themes/neon-light.css                              | 138 ++++++-
     21 + themes/obsidian-dark.css                           | 138 ++++++-
     22 + themes/obsidian-light.css                          | 138 ++++++-
     23 + themes/ocean-dark.css                              | 138 ++++++-
     24 + themes/ocean-light.css                             | 138 ++++++-
     25 + themes/sunset-dark.css                             | 138 ++++++-
     26 + themes/sunset-light.css                            | 138 ++++++-
     27 + 18 files changed, 2762 insertions(+), 338 deletions(-)
 13  28  ```
 14  29  
 15     -## üìù Files Changed (3/3 selected)
     30 +## üìù Files Changed (18/18 selected)
 16  31  
 17  32  
 18     -### üìÑ `memory-bank/activeContext.md`
     33 +### üìÑ `AI_REVIEW.md`
 19  34  
 20  35  **Type:** Documentation üìñ
 21  36  
 22  37  ```diff
 23     -@@ -202,7 +202,57 @@ html = restoreLatexEnvironments(html);
 24     -202 202  
 25     -203 203  ## Open Questions
 26     -204 204  
 27     -205     -None - All LaTeX rendering issues resolved
 28     -    205 +None - All issues resolved
     38 +@@ -1,4 +1,4 @@
     39 +  1     -# üîç Code Review - 12/7/2025, 4:25:31 AM
     40 +      1 +# üîç Code Review - 12/7/2025, 8:27:20 AM
     41 +  2   2  
     42 +  3   3  **Project:** AI Visual Code Review
     43 +  4   4  **Generated by:** AI Visual Code Review v2.0
     44 +@@ -6,38 +6,80 @@
     45 +  6   6  ## üìä Change Summary
     46 +  7   7  
     47 +  8   8  ```
     48 +  9     -index.html | 11 +++++++++++
     49 + 10     - script.js  | 21 ++++++++++++++++++++-
     50 + 11     - 2 files changed, 31 insertions(+), 1 deletion(-)
     51 +      9 +memory-bank/activeContext.md |  52 +++++++++-
     52 +     10 + script.js                    | 231 +++++--------------------------------------
     53 +     11 + themes/sunset-dark.css       |   2 +-
     54 +     12 + 3 files changed, 75 insertions(+), 210 deletions(-)
     55 + 12  13  ```
     56 + 13  14  
     57 + 14     -## üìù Files Changed (2/2 selected)
     58 +     15 +## üìù Files Changed (3/3 selected)
     59 + 15  16  
     60 + 16  17  
     61 + 17     -### üìÑ `index.html`
     62 +     18 +### üìÑ `memory-bank/activeContext.md`
     63 + 18  19  
     64 + 19     -**Type:** HTML Template üåê
     65 +     20 +**Type:** Documentation üìñ
     66 + 20  21  
     67 + 21  22  ```diff
     68 + 22     -@@ -55,6 +55,17 @@
     69 + 23     - 55  55              üìÅ Open Folder
     70 + 24     - 56  56            </button>
     71 + 25     - 57  57  
     72 + 26     -     58 +          <!-- Collapse/Expand Sidebar -->
     73 + 27     -     59 +          <button
     74 + 28     -     60 +            class="btn"
     75 + 29     -     61 +            id="toggle-sidebar-btn"
     76 + 30     -     62 +            title="Toggle File Browser"
     77 + 31     -     63 +            aria-label="Toggle File Browser Sidebar"
     78 + 32     -     64 +            style="display: none"
     79 + 33     -     65 +          >
     80 + 34     -     66 +            ‚óÄ Hide Files
     81 + 35     -     67 +          </button>
     82 + 36     -     68 +
     83 + 37     - 58  69            <!-- View Mode Buttons -->
     84 + 38     - 59  70            <div class="view-mode-buttons">
     85 + 39     - 60  71              <button
     86 + 40     - 61  72  
     87 +     23 +@@ -202,7 +202,57 @@ html = restoreLatexEnvironments(html);
     88 +     24 +202 202  
     89 +     25 +203 203  ## Open Questions
     90 +     26 +204 204  
     91 +     27 +205     -None - All LaTeX rendering issues resolved
     92 +     28 +    205 +None - All issues resolved
     93 +     29 +    206 +
     94 +     30 +    207 +## Recent Fixes (Latest Session)
     95 +     31 +    208 +
     96 +     32 +    209 +### Theme Dropdown Sync Fix ‚úÖ
     97 +     33 +    210 +
     98 +     34 +    211 +**Problem:** Theme dropdown showing "Default Light" even when sunset-dark theme was loaded from LocalStorage.
     99 +     35 +    212 +
    100 +     36 +    213 +**Root Cause:** Race condition in theme loading - dropdown was being set BEFORE async theme load completed.
    101 +     37 +    214 +
    102 +     38 +    215 +**Solution:**
    103 +     39 +    216 +
    104 +     40 +    217 +```javascript
    105 +     41 +    218 +// OLD (buggy):
    106 +     42 +    219 +if (savedTheme) {
    107 +     43 +    220 +  themeSelector.value = savedTheme; // Sets immediately
    108 +     44 +    221 +  themeManager.loadTheme(savedTheme); // Async, not awaited
    109 +     45 +    222 +}
    110 +     46 +    223 +
    111 +     47 +    224 +// NEW (fixed):
    112 +     48 +    225 +if (savedTheme) {
    113 +     49 +    226 +  themeManager
    114 +     50 +    227 +    .loadTheme(savedTheme)
    115 +     51 +    228 +    .then(() => {
    116 +     52 +    229 +      themeSelector.value = savedTheme; // Only after successful load
    117 +     53 +    230 +      console.log(`‚úÖ Theme restored: ${savedTheme}`);
    118 +     54 +    231 +    })
    119 +     55 +    232 +    .catch(err => {
    120 +     56 +    233 +      // Fallback with proper sync
    121 +     57 +    234 +      themeManager.loadTheme('default-light').then(() => {
    122 +     58 +    235 +        themeSelector.value = 'default-light';
    123 +     59 +    236 +      });
    124 +     60 +    237 +    });
    125 +     61 +    238 +}
    126 +     62 +    239 +```
    127 +     63 +    240 +
    128 +     64 +    241 +**Key Changes:**
    129 +     65 +    242 +
    130 +     66 +    243 +1. Await theme load completion before syncing dropdown
    131 +     67 +    244 +2. Added success callback for dropdown update
    132 +     68 +    245 +3. Added error handling with fallback
    133 +     69 +    246 +4. Added console logging for debugging
    134 +     70 +    247 +
    135 +     71 +    248 +**Results:**
    136 +     72 +    249 +
    137 +     73 +    250 +- ‚úÖ Dropdown now syncs correctly with all themes
    138 +     74 +    251 +- ‚úÖ No more race conditions
    139 +     75 +    252 +- ‚úÖ Proper error handling
    140 +     76 +    253 +- ‚úÖ Works for all 12 themes (6 theme families √ó 2 variants)
    141 +     77 +    254 +
    142 +     78 +    255 +**Files Modified:** `script.js` (lines 1167-1183)
    143 +     79 +206 256  
    144 +     80 +207 257  ## Performance Observations
    145 +     81 +208 258  
    146 +     82 +209 259  
    147 + 41  83  
    148 + 42  84  ```
    149 + 43  85  
    150 +@@ -47,51 +89,293 @@ index.html | 11 +++++++++++
    151 + 47  89  **Type:** JavaScript Source File üü®
    152 + 48  90  
    153 + 49  91  ```diff
    154 + 50     -@@ -796,6 +796,7 @@ graph TD
    155 + 51     -796 796    // Folder browser DOM elements
    156 + 52     -797 797    const fileBrowser = document.getElementById('file-browser');
    157 + 53     -798 798    const openFolderBtn = document.getElementById('open-folder-btn');
    158 + 54     -    799 +  const toggleSidebarBtn = document.getElementById('toggle-sidebar-btn');
    159 + 55     -799 800    const closeBrowserBtn = document.getElementById('close-browser-btn');
    160 + 56     -800 801    const fileTree = document.getElementById('file-tree');
    161 + 57     -801 802    const currentFolderNameEl = document.getElementById('current-folder-name');
    162 + 58     -@@ -804,6 +805,7 @@ graph TD
    163 + 59     -804 805    // Folder browser state (using let to allow reassignment)
    164 + 60     -805 806    let folderFiles = [];
    165 + 61     -806 807    let activeFileHandle = null;
    166 + 62     -    808 +  const sidebarCollapsed = false;
    167 + 63     -807 809  
    168 + 64     -808 810    // Open folder handler
    169 + 65     -809 811    openFolderBtn.addEventListener('click', async () => {
    170 + 66     -@@ -843,9 +845,26 @@ graph TD
    171 + 67     -843 845      console.log(`‚úÖ Loaded ${result.totalFiles} markdown files from ${result.folderName}`);
    172 + 68     -844 846    });
    173 + 69     -845 847  
    174 + 70     -846     -  // Close browser handler
    175 + 71     -    848 +  // Toggle sidebar collapse/expand
    176 + 72     -    849 +  toggleSidebarBtn.addEventListener('click', () => {
    177 + 73     -    850 +    if (fileBrowser.style.display === 'none') {
    178 + 74     -    851 +      // Expand sidebar
    179 + 75     -    852 +      fileBrowser.style.display = 'flex';
    180 + 76     -    853 +      toggleSidebarBtn.textContent = '‚óÄ Hide Files';
    181 + 77     -    854 +      toggleSidebarBtn.title = 'Hide File Browser';
    182 + 78     -    855 +    } else {
    183 + 79     -    856 +      // Collapse sidebar (keep data)
    184 + 80     -    857 +      fileBrowser.style.display = 'none';
    185 + 81     -    858 +      toggleSidebarBtn.textContent = '‚ñ∂ Show Files';
    186 + 82     -    859 +      toggleSidebarBtn.title = 'Show File Browser';
    187 + 83     -    860 +    }
    188 + 84     -    861 +  });
    189 + 85     -    862 +
    190 + 86     -    863 +  // Close browser handler (clears data)
    191 + 87     -847 864    closeBrowserBtn.addEventListener('click', () => {
    192 + 88     -848 865      fileBrowser.style.display = 'none';
    193 + 89     -    866 +    toggleSidebarBtn.style.display = 'none';
    194 + 90     -    867 +    openFolderBtn.style.display = 'inline-block';
    195 + 91     -849 868      folderFiles = [];
    196 + 92     -850 869      activeFileHandle = null;
    197 + 93     -851 870    });
    198 + 94     -852 871  
    199 +     92 +@@ -145,101 +145,10 @@ function configureMarkedExtensions() {
    200 +     93 +145 145      return;
    201 +     94 +146 146    }
    202 +     95 +147 147  
    203 +     96 +148     -  // Add LaTeX environment extensions
    204 +     97 +    148 +  // Add inline math and text formatting extensions only
    205 +     98 +    149 +  // LaTeX environments (align, gather, etc.) are not supported by KaTeX
    206 +     99 +149 150    marked.use({
    207 +    100 +150 151      extensions: [
    208 +    101 +151     -      {
    209 +    102 +152     -        name: 'latexEnvironment',
    210 +    103 +153     -        level: 'block',
    211 +    104 +154     -        start(src) {
    212 +    105 +155     -          return src.match(/^\\begin\{/)?.index;
    213 +    106 +156     -        },
    214 +    107 +157     -        tokenizer(src) {
    215 +    108 +158     -          const match = src.match(/^\\begin\{([^}]+)\}([\s\S]*?)\\end\{\1\}/);
    216 +    109 +159     -          if (match) {
    217 +    110 +160     -            return {
    218 +    111 +161     -              type: 'latexEnvironment',
    219 +    112 +162     -              raw: match[0],
    220 +    113 +163     -              text: match[0],
    221 +    114 +164     -            };
    222 +    115 +165     -          }
    223 +    116 +166     -        },
    224 +    117 +167     -        renderer(token) {
    225 +    118 +168     -          try {
    226 +    119 +169     -            const rendered = katex.renderToString(token.text, {
    227 +    120 +170     -              displayMode: true,
    228 +    121 +171     -              throwOnError: false,
    229 +    122 +172     -              trust: true,
    230 +    123 +173     -              strict: false,
    231 +    124 +174     -            });
    232 +    125 +175     -            return `<div class="katex-display">${rendered}</div>`;
    233 +    126 +176     -          } catch (e) {
    234 +    127 +177     -            console.warn('KaTeX environment render error:', e);
    235 +    128 +178     -            return `<div style="color: red; padding: 10px;">LaTeX Error: ${e.message}</div>`;
    236 +    129 +179     -          }
    237 +    130 +180     -        },
    238 +    131 +181     -      },
    239 +    132 +182     -      {
    240 +    133 +183     -        name: 'latexDisplayBracket',
    241 +    134 +184     -        level: 'block',
    242 +    135 +185     -        start(src) {
    243 +    136 +186     -          return src.match(/^\\\[/)?.index;
    244 +    137 +187     -        },
    245 +    138 +188     -        tokenizer(src) {
    246 +    139 +189     -          const match = src.match(/^\\\[([\s\S]*?)\\\]/);
    247 +    140 +190     -          if (match) {
    248 +    141 +191     -            return {
    249 +    142 +192     -              type: 'latexDisplayBracket',
    250 +    143 +193     -              raw: match[0],
    251 +    144 +194     -              text: match[1].trim(),
    252 +    145 +195     -            };
    253 +    146 +196     -          }
    254 +    147 +197     -        },
    255 +    148 +198     -        renderer(token) {
    256 +    149 +199     -          try {
    257 +    150 +200     -            const rendered = katex.renderToString(token.text, {
    258 +    151 +201     -              displayMode: true,
    259 +    152 +202     -              throwOnError: false,
    260 +    153 +203     -              trust: true,
    261 +    154 +204     -              strict: false,
    262 +    155 +205     -            });
    263 +    156 +206     -            return `<div class="katex-display">${rendered}</div>`;
    264 +    157 +207     -          } catch (e) {
    265 +    158 +208     -            console.warn('KaTeX bracket render error:', e);
    266 +    159 +209     -            return `<div style="color: red; padding: 10px;">LaTeX Error: ${e.message}</div>`;
    267 +    160 +210     -          }
    268 +    161 +211     -        },
    269 +    162 +212     -      },
    270 +    163 +213     -      {
    271 +    164 +214     -        name: 'latexInlineParen',
    272 +    165 +215     -        level: 'inline',
    273 +    166 +216     -        start(src) {
    274 +    167 +217     -          return src.match(/\\\(/)?.index;
    275 +    168 +218     -        },
    276 +    169 +219     -        tokenizer(src) {
    277 +    170 +220     -          const match = src.match(/^\\\(([\s\S]*?)\\\)/);
    278 +    171 +221     -          if (match) {
    279 +    172 +222     -            return {
    280 +    173 +223     -              type: 'latexInlineParen',
    281 +    174 +224     -              raw: match[0],
    282 +    175 +225     -              text: match[1].trim(),
    283 +    176 +226     -            };
    284 +    177 +227     -          }
    285 +    178 +228     -        },
    286 +    179 +229     -        renderer(token) {
    287 +    180 +230     -          try {
    288 +    181 +231     -            return katex.renderToString(token.text, {
    289 +    182 +232     -              displayMode: false,
    290 +    183 +233     -              throwOnError: false,
    291 +    184 +234     -              trust: true,
    292 +    185 +235     -              strict: false,
    293 +    186 +236     -            });
    294 +    187 +237     -          } catch (e) {
    295 +    188 +238     -            console.warn('KaTeX paren render error:', e);
    296 +    189 +239     -            return `<span style="color: red;">LaTeX Error</span>`;
    297 +    190 +240     -          }
    298 +    191 +241     -        },
    299 +    192 +242     -      },
    300 +    193 +243 152        {
    301 +    194 +244 153          name: 'mathBlock',
    302 +    195 +245 154          level: 'block',
    303 +    196 +@@ -503,101 +412,10 @@ graph TD
    304 +    197 +503 412      return textarea.value;
    305 +    198 +504 413    }
    306 +    199 +505 414  
    307 +    200 +506     -  // Add LaTeX environment extensions that render directly with KaTeX
    308 +    201 +    415 +  // Keep only subscript and superscript extensions
    309 +    202 +    416 +  // Remove LaTeX environment extensions that don't work with KaTeX
    310 +    203 +507 417    marked.use({
    311 +    204 +508 418      extensions: [
    312 +    205 +509     -      {
    313 +    206 +510     -        name: 'latexEnvironment',
    314 +    207 +511     -        level: 'block',
    315 +    208 +512     -        start(src) {
    316 +    209 +513     -          return src.match(/^\\begin\{/)?.index;
    317 +    210 +514     -        },
    318 +    211 +515     -        tokenizer(src) {
    319 +    212 +516     -          const match = src.match(/^\\begin\{([^}]+)\}([\s\S]*?)\\end\{\1\}/);
    320 +    213 +517     -          if (match) {
    321 +    214 +518     -            return {
    322 +    215 +519     -              type: 'latexEnvironment',
    323 +    216 +520     -              raw: match[0],
    324 +    217 +521     -              text: match[0],
    325 +    218 +522     -            };
    326 +    219 +523     -          }
    327 +    220 +524     -        },
    328 +    221 +525     -        renderer(token) {
    329 +    222 +526     -          try {
    330 +    223 +527     -            const rendered = katex.renderToString(token.text, {
    331 +    224 +528     -              displayMode: true,
    332 +    225 +529     -              throwOnError: false,
    333 +    226 +530     -              trust: true,
    334 +    227 +531     -              strict: false,
    335 +    228 +532     -            });
    336 +    229 +533     -            return `<div class="katex-display">${rendered}</div>`;
    337 +    230 +534     -          } catch (e) {
    338 +    231 +535     -            console.warn('KaTeX environment render error:', e);
    339 +    232 +536     -            return `<div style="color: red; padding: 10px;">LaTeX Error: ${e.message}</div>`;
    340 +    233 +537     -          }
    341 +    234 +538     -        },
    342 +    235 +539     -      },
    343 +    236 +540     -      {
    344 +    237 +541     -        name: 'latexDisplayBracket',
    345 +    238 +542     -        level: 'block',
    346 +    239 +543     -        start(src) {
    347 +    240 +544     -          return src.match(/^\\\[/)?.index;
    348 +    241 +545     -        },
    349 +    242 +546     -        tokenizer(src) {
    350 +    243 +547     -          const match = src.match(/^\\\[([\s\S]*?)\\\]/);
    351 +    244 +548     -          if (match) {
    352 +    245 +549     -            return {
    353 +    246 +550     -              type: 'latexDisplayBracket',
    354 +    247 +551     -              raw: match[0],
    355 +    248 +552     -              text: match[1].trim(),
    356 +    249 +553     -            };
    357 +    250 +554     -          }
    358 +    251 +555     -        },
    359 +    252 +556     -        renderer(token) {
    360 +    253 +557     -          try {
    361 +    254 +558     -            const rendered = katex.renderToString(token.text, {
    362 +    255 +559     -              displayMode: true,
    363 +    256 +560     -              throwOnError: false,
    364 +    257 +561     -              trust: true,
    365 +    258 +562     -              strict: false,
    366 +    259 +563     -            });
    367 +    260 +564     -            return `<div class="katex-display">${rendered}</div>`;
    368 +    261 +565     -          } catch (e) {
    369 +    262 +566     -            console.warn('KaTeX bracket render error:', e);
    370 +    263 +567     -            return `<div style="color: red; padding: 10px;">LaTeX Error: ${e.message}</div>`;
    371 +    264 +568     -          }
    372 +    265 +569     -        },
    373 +    266 +570     -      },
    374 +    267 +571     -      {
    375 +    268 +572     -        name: 'latexInlineParen',
    376 +    269 +573     -        level: 'inline',
    377 +    270 +574     -        start(src) {
    378 +    271 +575     -          return src.match(/\\\(/)?.index;
    379 +    272 +576     -        },
    380 +    273 +577     -        tokenizer(src) {
    381 +    274 +578     -          const match = src.match(/^\\\(([\s\S]*?)\\\)/);
    382 +    275 +579     -          if (match) {
    383 +    276 +580     -            return {
    384 +    277 +581     -              type: 'latexInlineParen',
    385 +    278 +582     -              raw: match[0],
    386 +    279 +583     -              text: match[1].trim(),
    387 +    280 +584     -            };
    388 +    281 +585     -          }
    389 +    282 +586     -        },
    390 +    283 +587     -        renderer(token) {
    391 +    284 +588     -          try {
    392 +    285 +589     -            return katex.renderToString(token.text, {
    393 +    286 +590     -              displayMode: false,
    394 +    287 +591     -              throwOnError: false,
    395 +    288 +592     -              trust: true,
    396 +    289 +593     -              strict: false,
    397 +    290 +594     -            });
    398 +    291 +595     -          } catch (e) {
    399 +    292 +596     -            console.warn('KaTeX paren render error:', e);
    400 +    293 +597     -            return `<span style="color: red;">LaTeX Error</span>`;
    401 +    294 +598     -          }
    402 +    295 +599     -        },
    403 +    296 +600     -      },
    404 +    297 +601 419        {
    405 +    298 +602 420          name: 'subscript',
    406 +    299 +603 421          level: 'inline',
    407 +    300 +@@ -641,7 +459,7 @@ graph TD
    408 +    301 +641 459      ],
    409 +    302 +642 460    });
    410 +    303 +643 461  
    411 +    304 +644     -  console.log('‚úÖ LaTeX environments, subscript, and superscript enabled');
    412 +    305 +    462 +  console.log('‚úÖ Subscript and superscript enabled (LaTeX environments display as-is)');
    413 +    306 +645 463  
    414 +    307 +646 464    // Render markdown
    415 +    308 +647 465    function renderMarkdown() {
    416 +    309 +@@ -685,22 +503,9 @@ graph TD
    417 +    310 +685 503        // Apply Prism syntax highlighting using PrismService
    418 +    311 +686 504        prismService.highlightAll(preview);
    419 +    312 +687 505  
    420 +    313 +688     -      // Apply KaTeX auto-render only for any remaining $...$ syntax
    421 +    314 +689     -      if (typeof renderMathInElement !== 'undefined') {
    422 +    315 +690     -        try {
    423 +    316 +691     -          renderMathInElement(preview, {
    424 +    317 +692     -            delimiters: [
    425 +    318 +693     -              { left: '$$', right: '$$', display: true },
    426 +    319 +694     -              { left: '$', right: '$', display: false },
    427 +    320 +695     -            ],
    428 +    321 +696     -            throwOnError: false,
    429 +    322 +697     -            trust: true,
    430 +    323 +698     -            strict: false,
    431 +    324 +699     -          });
    432 +    325 +700     -        } catch (e) {
    433 +    326 +701     -          console.warn('KaTeX auto-render error:', e);
    434 +    327 +702     -        }
    435 +    328 +703     -      }
    436 +    329 +    506 +      // NOTE: KaTeX auto-render is DISABLED
    437 +    330 +    507 +      // We handle all math via marked.js extensions ($...$ and $$...$$)
    438 +    331 +    508 +      // KaTeX auto-render was causing issues with unsupported LaTeX environments
    439 +    332 +704 509  
    440 +    333 +705 510        // Save content using StorageManager
    441 +    334 +706 511        storageManager.set('markdownContent', markdownText);
    442 +    335 +@@ -1167,11 +972,21 @@ graph TD
    443 +    336 +1167 972    // Load saved theme using ThemeManager
    444 +    337 +1168 973    const savedTheme = storageManager.get('selectedTheme');
    445 +    338 +1169 974    if (savedTheme) {
    446 +    339 +1170     -    themeSelector.value = savedTheme;
    447 +    340 +1171     -    themeManager.loadTheme(savedTheme).catch(err => {
    448 +    341 +1172     -      console.error('Failed to load saved theme:', err);
    449 +    342 +1173     -      themeManager.loadTheme('default-light');
    450 +    343 +1174     -    });
    451 +    344 +    975 +    // Load theme first, then sync dropdown only on success
    452 +    345 +    976 +    themeManager
    453 +    346 +    977 +      .loadTheme(savedTheme)
    454 +    347 +    978 +      .then(() => {
    455 +    348 +    979 +        // Theme loaded successfully - sync dropdown
    456 +    349 +    980 +        themeSelector.value = savedTheme;
    457 +    350 +    981 +        console.log(`‚úÖ Theme restored: ${savedTheme}`);
    458 +    351 +    982 +      })
    459 +    352 +    983 +      .catch(err => {
    460 +    353 +    984 +        console.error('Failed to load saved theme:', err);
    461 +    354 +    985 +        // Fallback to default-light on error
    462 +    355 +    986 +        themeManager.loadTheme('default-light').then(() => {
    463 +    356 +    987 +          themeSelector.value = 'default-light';
    464 +    357 +    988 +        });
    465 +    358 +    989 +      });
    466 +    359 +1175 990    }
    467 +    360 +1176 991  
    468 +    361 +1177 992    // Zoom functionality
    469 +    362 +1178 993  
    470 +    363 +
    471 +    364 +```
    472 +    365 +
    473 +    366 +
    474 +    367 +### üìÑ `themes/sunset-dark.css`
    475 +    368 +
    476 +    369 +**Type:** Stylesheet üé®
    477 +    370 +
    478 +    371 +```diff
    479 +    372 +@@ -1,4 +1,4 @@
    480 +    373 +  1     -r/* Sunset Dark Theme */
    481 +    374 +      1 +/* Sunset Dark Theme */
    482 +    375 +  2   2  :root {
    483 +    376 +  3   3    --bg-primary: #1c0a00;
    484 +    377 +  4   4    --bg-secondary: #2d1b0e;
    485 +    378 +  5   5  
    486 + 95 379  
    487 + 96 380  ```
    488 + 97 381  
    489 +@@ -137,4 +421,4 @@ Please provide specific feedback on:
    490 +137 421  
    491 +138 422  ---
    492 +139 423  *Generated by AI Visual Code Review v2.0 - Unified Export Script*
    493 +140     -*Files processed: 2/2 | Errors: 0 | Generated: 2025-12-06T22:55:31.083Z*
    494 +    424 +*Files processed: 3/3 | Errors: 0 | Generated: 2025-12-07T02:57:20.361Z*
    495 +141 425  
    496 +
    497 +```
    498 +
    499 +
    500 +### ‚ú® `docs/02-architecture/mermaid-theme-architecture.md` **[ADDED]**
    501 +
    502 +**Status:** ‚úÖ **NEW FILE** - This file has been newly created
    503 +
    504 +**Type:** Documentation üìñ
    505 +
    506 +```diff
    507 +@@ -0,0 +1,208 @@
    508 +      1 +# Mermaid Theme Architecture - Comprehensive Reference
    509 +      2 +
    510 +      3 +**Last Updated:** 12/7/2025
    511 +      4 +**Source:** Official Mermaid.js theming documentation
    512 +      5 +
    513 +      6 +## Complete Mermaid Theme Variables
    514 +      7 +
    515 +      8 +### Core Global Variables
    516 +      9 +
    517 +     10 +| Variable     | Type       | Description                  | Default                        |
    518 +     11 +| ------------ | ---------- | ---------------------------- | ------------------------------ |
    519 +     12 +| `background` | Background | Page background              | `#f4f4f4`                      |
    520 +     13 +| `fontFamily` | Text       | Font family                  | `trebuchet ms, verdana, arial` |
    521 +     14 +| `fontSize`   | Text       | Font size                    | `16px`                         |
    522 +     15 +| `darkMode`   | Boolean    | Affects color calculations   | `false`                        |
    523 +     16 +| `textColor`  | Text       | General text over background | calculated                     |
    524 +     17 +| `lineColor`  | Line       | Lines and connections        | calculated                     |
    525 +     18 +| `mainBkg`    | Background | Main background for objects  | calculated                     |
    526 +     19 +
    527 +     20 +### Primary/Secondary/Tertiary Color Sets
    528 +     21 +
    529 +     22 +Each set has 3 variables (background, text, border):
    530 +     23 +
    531 +     24 +| Variable               | Type       | Description                |
    532 +     25 +| ---------------------- | ---------- | -------------------------- |
    533 +     26 +| `primaryColor`         | Background | Primary node background    |
    534 +     27 +| `primaryTextColor`     | Text       | Text in primary nodes      |
    535 +     28 +| `primaryBorderColor`   | Border     | Border for primary nodes   |
    536 +     29 +| `secondaryColor`       | Background | Secondary node background  |
    537 +     30 +| `secondaryTextColor`   | Text       | Text in secondary nodes    |
    538 +     31 +| `secondaryBorderColor` | Border     | Border for secondary nodes |
    539 +     32 +| `tertiaryColor`        | Background | Tertiary node background   |
    540 +     33 +| `tertiaryTextColor`    | Text       | Text in tertiary nodes     |
    541 +     34 +| `tertiaryBorderColor`  | Border     | Border for tertiary nodes  |
    542 +     35 +
    543 +     36 +### Flowchart-Specific Variables
    544 +     37 +
    545 +     38 +| Variable              | Type       | Description           |
    546 +     39 +| --------------------- | ---------- | --------------------- |
    547 +     40 +| `nodeBorder`          | Border     | Node border color     |
    548 +     41 +| `clusterBkg`          | Background | Subgraph background   |
    549 +     42 +| `clusterBorder`       | Border     | Subgraph border       |
    550 +     43 +| `defaultLinkColor`    | Line       | Link/edge color       |
    551 +     44 +| `titleColor`          | Text       | Title text color      |
    552 +     45 +| `edgeLabelBackground` | Background | Edge label background |
    553 +     46 +| `nodeTextColor`       | Text       | Text inside nodes     |
    554 +     47 +
    555 +     48 +### Sequence Diagram Variables
    556 +     49 +
    557 +     50 +| Variable                | Type       | Description           |
    558 +     51 +| ----------------------- | ---------- | --------------------- |
    559 +     52 +| `actorBkg`              | Background | Actor box background  |
    560 +     53 +| `actorBorder`           | Border     | Actor box border      |
    561 +     54 +| `actorTextColor`        | Text       | Actor text            |
    562 +     55 +| `actorLineColor`        | Line       | Actor lifeline        |
    563 +     56 +| `signalColor`           | Line       | Signal arrows         |
    564 +     57 +| `signalTextColor`       | Text       | Signal labels         |
    565 +     58 +| `labelBoxBkgColor`      | Background | Label box background  |
    566 +     59 +| `labelBoxBorderColor`   | Border     | Label box border      |
    567 +     60 +| `labelTextColor`        | Text       | Label text            |
    568 +     61 +| `loopTextColor`         | Text       | Loop text             |
    569 +     62 +| `activationBorderColor` | Border     | Activation border     |
    570 +     63 +| `activationBkgColor`    | Background | Activation background |
    571 +     64 +| `sequenceNumberColor`   | Text       | Sequence numbers      |
    572 +     65 +
    573 +     66 +### Pie Chart Variables
    574 +     67 +
    575 +     68 +| Variable              | Type       | Description                           |
    576 +     69 +| --------------------- | ---------- | ------------------------------------- |
    577 +     70 +| `pie1` - `pie12`      | Background | Fill colors for sections              |
    578 +     71 +| `pieTitleTextSize`    | Text       | Title font size (default: `25px`)     |
    579 +     72 +| `pieTitleTextColor`   | Text       | Title text color                      |
    580 +     73 +| `pieSectionTextSize`  | Text       | Section label size (default: `17px`)  |
    581 +     74 +| `pieSectionTextColor` | Text       | **Section label color (ON SLICES!)**  |
    582 +     75 +| `pieLegendTextSize`   | Text       | Legend font size (default: `17px`)    |
    583 +     76 +| `pieLegendTextColor`  | Text       | Legend text color                     |
    584 +     77 +| `pieStrokeColor`      | Border     | Slice borders (default: `black`)      |
    585 +     78 +| `pieStrokeWidth`      | Border     | Slice border width (default: `2px`)   |
    586 +     79 +| `pieOuterStrokeWidth` | Border     | Outer circle width (default: `2px`)   |
    587 +     80 +| `pieOuterStrokeColor` | Border     | Outer circle color (default: `black`) |
    588 +     81 +| `pieOpacity`          | Visual     | Slice opacity (default: `0.7`)        |
    589 +     82 +
    590 +     83 +### State Diagram Variables
    591 +     84 +
    592 +     85 +| Variable        | Type       | Description                |
    593 +     86 +| --------------- | ---------- | -------------------------- |
    594 +     87 +| `labelColor`    | Text       | State label color          |
    595 +     88 +| `altBackground` | Background | Composite state background |
    596 +     89 +
    597 +     90 +### Class Diagram Variables
    598 +     91 +
    599 +     92 +| Variable    | Type | Description      |
    600 +     93 +| ----------- | ---- | ---------------- |
    601 +     94 +| `classText` | Text | Class text color |
    602 +     95 +
    603 +     96 +### User Journey Variables
    604 +     97 +
    605 +     98 +| Variable                  | Type       | Description   |
    606 +     99 +| ------------------------- | ---------- | ------------- |
    607 +    100 +| `fillType0` - `fillType7` | Background | Section fills |
    608 +    101 +
    609 +    102 +## Critical Insights
    610 +    103 +
    611 +    104 +### 1. Pie Section Text Contrast Issue
    612 +    105 +
    613 +    106 +**Problem:** `pieSectionTextColor` is text **ON** the colored pie slices!
    614 +    107 +
    615 +    108 +- If slices are dark and text is dark ‚Üí **UNREADABLE**
    616 +    109 +- If slices are light and text is light ‚Üí **UNREADABLE**
    617 +    110 +
    618 +    111 +**Solution:** `pieSectionTextColor` must contrast with `pie1-pie12` colors!
    619 +    112 +
    620 +    113 +### 2. Background vs Text Variables
    621 +    114 +
    622 +    115 +- **Background variables** (end with `Bkg`, `Color`, or are named `pie1-12`)
    623 +    116 +- **Text variables** (contain `Text` or `textColor`)
    624 +    117 +- **Border variables** (contain `Border` or `Stroke`)
    625 +    118 +- **Line variables** (contain `Line` or `lineColor`)
    626 +    119 +
    627 +    120 +### 3. Calculated vs Explicit
    628 +    121 +
    629 +    122 +- Mermaid **calculates** many colors if not provided
    630 +    123 +- But calculation may not match our theme aesthetics
    631 +    124 +- **We should set ALL critical variables explicitly**
    632 +    125 +
    633 +    126 +## Implementation Strategy
    634 +    127 +
    635 +    128 +### For Each Theme, Define
    636 +    129 +
    637 +    130 +1. **Core Backgrounds** (3 levels for hierarchy)
    638 +    131 +   - `primaryColor`, `secondaryColor`, `tertiaryColor`
    639 +    132 +
    640 +    133 +2. **All Text Colors** (must contrast with their backgrounds!)
    641 +    134 +   - `primaryTextColor`, `secondaryTextColor`, `tertiaryTextColor`
    642 +    135 +   - `nodeTextColor`, `actorTextColor`, `signalTextColor`
    643 +    136 +   - `pieTitleTextColor`, `pieSectionTextColor`, `pieLegendTextColor`
    644 +    137 +
    645 +    138 +3. **All Border Colors** (visible against backgrounds)
    646 +    139 +   - `primaryBorderColor`, `secondaryBorderColor`, `tertiaryBorderColor`
    647 +    140 +   - `nodeBorder`, `actorBorder`, `clusterBorder`
    648 +    141 +   - `pieStrokeColor`, `pieOuterStrokeColor`
    649 +    142 +
    650 +    143 +4. **Line/Connection Colors**
    651 +    144 +   - `lineColor`, `defaultLinkColor`
    652 +    145 +   - `signalColor`, `actorLineColor`
    653 +    146 +
    654 +    147 +5. **Pie Slice Backgrounds** (12 distinct colors)
    655 +    148 +   - `pie1` through `pie12` - must be DISTINCT from text color!
    656 +    149 +
    657 +    150 +## Architecture Pattern
    658 +    151 +
    659 +    152 +```javascript
    660 +    153 +mermaid.initialize({
    661 +    154 +  theme: 'base',
    662 +    155 +  themeVariables: {
    663 +    156 +    // Core (affects ALL diagrams)
    664 +    157 +    background: bgPrimary,
    665 +    158 +    fontFamily: '...',
    666 +    159 +    fontSize: '16px',
    667 +    160 +
    668 +    161 +    // Primary set (most nodes)
    669 +    162 +    primaryColor: [BACKGROUND],
    670 +    163 +    primaryTextColor: [TEXT - must contrast!],
    671 +    164 +    primaryBorderColor: [BORDER - visible],
    672 +    165 +
    673 +    166 +    // Secondary set (clusters, special nodes)
    674 +    167 +    secondaryColor: [BACKGROUND],
    675 +    168 +    secondaryTextColor: [TEXT - must contrast!],
    676 +    169 +    secondaryBorderColor: [BORDER - visible],
    677 +    170 +
    678 +    171 +    // Tertiary set (nested elements)
    679 +    172 +    tertiaryColor: [BACKGROUND],
    680 +    173 +    tertiaryTextColor: [TEXT - must contrast!],
    681 +    174 +    tertiaryBorderColor: [BORDER - visible],
    682 +    175 +
    683 +    176 +    // Flowchart specific
    684 +    177 +    nodeBorder: [VISIBLE],
    685 +    178 +    nodeTextColor: [CONTRASTING],
    686 +    179 +    edgeLabelBackground: [BACKGROUND],
    687 +    180 +
    688 +    181 +    // Sequence diagram specific
    689 +    182 +    actorBkg: [BACKGROUND],
    690 +    183 +    actorTextColor: [CONTRASTING],
    691 +    184 +
    692 +    185 +    // Pie chart specific
    693 +    186 +    pie1-12: [12 DISTINCT COLORS],
    694 +    187 +    pieSectionTextColor: [CONTRASTS WITH pie1-12!],
    695 +    188 +
    696 +    189 +    // Lines
    697 +    190 +    lineColor: [VISIBLE],
    698 +    191 +    signalColor: [VISIBLE],
    699 +    192 +  }
    700 +    193 +});
    701 +    194 +```
    702 +    195 +
    703 +    196 +## Testing Checklist
    704 +    197 +
    705 +    198 +- [ ] Flowchart - nodes, clusters, edges readable
    706 +    199 +- [ ] Sequence diagram - actors, signals, loops readable
    707 +    200 +- [ ] Pie chart - slices, percentages, legend readable
    708 +    201 +- [ ] State diagram - states, transitions readable
    709 +    202 +- [ ] Class diagram - classes, methods readable
    710 +    203 +- [ ] User journey - tasks, emotions readable
    711 +    204 +
    712 +    205 +## References
 29 713      206 +
 30     -    207 +## Recent Fixes (Latest Session)
 31     -    208 +
 32     -    209 +### Theme Dropdown Sync Fix ‚úÖ
    714 +    207 +- [Mermaid Theming Documentation](https://mermaid.js.org/config/theming.html)
    715 +    208 +- [Base Theme Source](https://github.com/mermaid-js/mermaid/blob/develop/packages/mermaid/src/themes/theme-base.js)
    716 +    209  
    717 +
    718 +```
    719 +
    720 +
    721 +### ‚ú® `docs/02-architecture/prism-token-architecture.md` **[ADDED]**
    722 +
    723 +**Status:** ‚úÖ **NEW FILE** - This file has been newly created
    724 +
    725 +**Type:** Documentation üìñ
    726 +
    727 +```diff
    728 +@@ -0,0 +1,226 @@
    729 +      1 +# Prism Token Architecture - Comprehensive Reference
    730 +      2 +
    731 +      3 +**Last Updated:** 12/7/2025
    732 +      4 +**Source:** Official Prism.js documentation + One Dark theme analysis
    733 +      5 +
    734 +      6 +## Standard Token Classes
    735 +      7 +
    736 +      8 +### Core Language Constructs
    737 +      9 +
    738 +     10 +| Token Class   | Purpose                    | Example                                  | Recommended Color Hue             |
    739 +     11 +| ------------- | -------------------------- | ---------------------------------------- | --------------------------------- |
    740 +     12 +| `keyword`     | Reserved words             | `if`, `else`, `class`, `final`, `sealed` | Purple/Magenta (286¬∞)             |
    741 +     13 +| `builtin`     | Built-in functions/types   | `String`, `Array`, `Console`             | Green (95¬∞)                       |
    742 +     14 +| `class-name`  | Class/Interface/Type names | `Rectangle`, `Shape`, `Person`           | Orange (29¬∞)                      |
    743 +     15 +| `function`    | Function/method names      | `main`, `println`, `forEach`             | Blue (207¬∞)                       |
    744 +     16 +| `boolean`     | True/false values          | `true`, `false`                          | Orange (29¬∞)                      |
    745 +     17 +| `number`      | Numeric literals           | `42`, `3.14`, `0xDEADBEEF`               | Orange (29¬∞)                      |
    746 +     18 +| `string`      | String literals            | `"Hello"`, `'World'`                     | Green (95¬∞)                       |
    747 +     19 +| `char`        | Character literals         | `'A'`, `'\n'`                            | Green (95¬∞)                       |
    748 +     20 +| `symbol`      | Symbols (Smalltalk, Ruby)  | `:mySymbol`                              | Green (95¬∞)                       |
    749 +     21 +| `regex`       | Regular expressions        | `/[a-z]+/i`                              | Green (95¬∞)                       |
    750 +     22 +| `operator`    | Operators                  | `+`, `-`, `*`, `/`, `=`, `==`            | Purple (286¬∞)                     |
    751 +     23 +| `variable`    | Variable names (special)   | Less/Bash variables                      | Blue (207¬∞)                       |
    752 +     24 +| `constant`    | Constants                  | `PI`, `MAX_SIZE`, `stdout`               | Orange (29¬∞)                      |
    753 +     25 +| `property`    | Object properties          | CSS properties, JSON keys                | Red (355¬∞)                        |
    754 +     26 +| `punctuation` | Delimiters                 | `{`, `}`, `;`, `,`                       | Gray/White                        |
    755 +     27 +| `comment`     | Code comments              | `// comment`, `/* block */`              | Muted gray (220¬∞, low saturation) |
    756 +     28 +
    757 +     29 +### Markup-Specific Tokens
    758 +     30 +
    759 +     31 +| Token Class  | Purpose             | Example                     |
    760 +     32 +| ------------ | ------------------- | --------------------------- |
    761 +     33 +| `tag`        | HTML/XML tags       | `<div>`, `<p>`              |
    762 +     34 +| `attr-name`  | Attribute names     | `id`, `class`, `href`       |
    763 +     35 +| `attr-value` | Attribute values    | `"header"`, `"https://..."` |
    764 +     36 +| `namespace`  | XML namespaces      | `html:p`, `foo:bar`         |
    765 +     37 +| `prolog`     | XML prolog          | `<?xml version="1.0"?>`     |
    766 +     38 +| `doctype`    | DOCTYPE declaration | `<!DOCTYPE html>`           |
    767 +     39 +| `cdata`      | CDATA sections      | `<![CDATA[...]]>`           |
    768 +     40 +| `entity`     | HTML entities       | `&amp;`, `&#x2665;`         |
    769 +     41 +
    770 +     42 +### Document Markup Tokens
    771 +     43 +
    772 +     44 +| Token Class | Purpose         | Example      |
    773 +     45 +| ----------- | --------------- | ------------ |
    774 +     46 +| `bold`      | Bold text       | `**bold**`   |
    775 +     47 +| `italic`    | Italic text     | `*italic*`   |
    776 +     48 +| `important` | Important (CSS) | `!important` |
    777 +     49 +
    778 +     50 +### Stylesheet Tokens
    779 +     51 +
    780 +     52 +| Token Class | Purpose       | Example                  |
    781 +     53 +| ----------- | ------------- | ------------------------ |
    782 +     54 +| `atrule`    | CSS @ rules   | `@media`, `@import`      |
    783 +     55 +| `selector`  | CSS selectors | `.class`, `#id`, `div p` |
    784 +     56 +| `url`       | URLs          | `url(image.png)`         |
    785 +     57 +
    786 +     58 +### Diff Tokens
    787 +     59 +
    788 +     60 +| Token Class | Purpose       |
    789 +     61 +| ----------- | ------------- |
    790 +     62 +| `inserted`  | Added lines   |
    791 +     63 +| `deleted`   | Removed lines |
    792 +     64 +
    793 +     65 +## Professional Theme Analysis (One Dark)
    794 +     66 +
    795 +     67 +### Color Grouping Strategy
    796 +     68 +
    797 +     69 +One Dark uses **7 core hues** systematically:
    798 +     70 +
    799 +     71 +1. **mono-1** (220¬∞, 14%, 71%) - Default text
    800 +     72 +2. **mono-2** (220¬∞, 9%, 55%) - Secondary text
    801 +     73 +3. **mono-3** (220¬∞, 10%, 40%) - Comments
    802 +     74 +4. **hue-1** (187¬∞, 47%, 55%) - Cyan - URLs
    803 +     75 +5. **hue-2** (207¬∞, 82%, 66%) - Blue - Variables, operators, functions
    804 +     76 +6. **hue-3** (286¬∞, 60%, 67%) - Purple - Keywords
    805 +     77 +7. **hue-4** (95¬∞, 38%, 62%) - Green - Strings
    806 +     78 +8. **hue-5** (355¬∞, 65%, 65%) - Red - Properties, tags, symbols
    807 +     79 +9. **hue-6** (29¬∞, 54%, 61%) - Orange - Class names, constants, numbers
    808 +     80 +
    809 +     81 +### Token Grouping
    810 +     82 +
    811 +     83 +```css
    812 +     84 +/* Group 1: Comments */
    813 +     85 +.token.comment, .token.prolog, .token.cdata
    814 +     86 +
    815 +     87 +/* Group 2: Neutral (inherit default color) */
    816 +     88 +.token.doctype, .token.punctuation, .token.entity
    817 +     89 +
    818 +     90 +/* Group 3: Orange - Class names, constants, numbers */
    819 +     91 +.token.attr-name, .token.class-name, .token.boolean,
    820 +     92 +.token.constant, .token.number, .token.atrule
    821 +     93 +
    822 +     94 +/* Group 4: Purple - Keywords */
    823 +     95 +.token.keyword
    824 +     96 +
    825 +     97 +/* Group 5: Red - Properties, tags */
    826 +     98 +.token.property, .token.tag, .token.symbol,
    827 +     99 +.token.deleted, .token.important
    828 +    100 +
    829 +    101 +/* Group 6: Green - Strings, builtins */
    830 +    102 +.token.selector, .token.string, .token.char,
    831 +    103 +.token.builtin, .token.inserted, .token.regex,
    832 +    104 +.token.attr-value
    833 +    105 +
    834 +    106 +/* Group 7: Blue - Variables, operators, functions */
    835 +    107 +.token.variable, .token.operator, .token.function
    836 +    108 +
    837 +    109 +/* Group 8: Cyan - URLs */
    838 +    110 +.token.url
    839 +    111 +```
    840 +    112 +
    841 +    113 +### Language-Specific Overrides
    842 +    114 +
    843 +    115 +Professional themes use **cascading specificity** for language-specific rules:
    844 +    116 +
    845 +    117 +```css
    846 +    118 +/* JavaScript overrides */
    847 +    119 +.language-javascript .token.operator { color: purple; }
    848 +    120 +.language-javascript .token.template-string > .token.interpolation { ... }
    849 +    121 +
    850 +    122 +/* CSS overrides */
    851 +    123 +.language-css .token.selector { color: red; }
    852 +    124 +.language-css .token.property { color: gray; }
    853 +    125 +
    854 +    126 +/* JSON overrides */
    855 +    127 +.language-json .token.null.keyword { color: orange; }
    856 +    128 +
    857 +    129 +/* Markdown overrides */
    858 +    130 +.language-markdown .token.url { ... }
    859 +    131 +```
    860 +    132 +
    861 +    133 +## Implementation Architecture
    862 +    134 +
    863 +    135 +### CSS Specificity Levels
    864 +    136 +
    865 +    137 +1. **Base tokens** - All languages
    866 +    138 +2. **Language-specific overrides** - `.language-xxx .token.yyy`
    867 +    139 +3. **Nested tokens** - `.token.xxx > .token.yyy`
    868 +    140 +4. **Plugin overrides** - `.rainbow-braces`, `.diff-highlight`, etc.
    869 +    141 +
    870 +    142 +### Variable Mapping Strategy
    871 +    143 +
    872 +    144 +```css
    873 +    145 +/* Map standard Prism tokens to theme CSS variables */
    874 +    146 +.token.keyword {
    875 +    147 +  color: var(--syntax-keyword);
    876 +    148 +}
    877 +    149 +.token.string {
    878 +    150 +  color: var(--syntax-string);
    879 +    151 +}
    880 +    152 +.token.class-name {
    881 +    153 +  color: var(--syntax-class-name); /* Distinct variable! */
    882 +    154 +}
    883 +    155 +```
    884 +    156 +
    885 +    157 +### Token Aliases
    886 +    158 +
    887 +    159 +Prism uses aliases to group similar tokens:
    888 +    160 +
    889 +    161 +- `attr-value` can contain nested `punctuation` tokens
    890 +    162 +- `template-string` can contain `interpolation` with nested tokens
    891 +    163 +- Language definitions use `alias` property to inherit styles
    892 +    164 +
    893 +    165 +## Best Practices
    894 +    166 +
    895 +    167 +1. **Use Distinct Variables** - Don't reuse variables across semantically different tokens
    896 +    168 +2. **Follow Standards** - Match Prism's standard token names
    897 +    169 +3. **Language Overrides** - Use when default grouping doesn't fit
    898 +    170 +4. **Test Comprehensively** - Verify with multiple languages (Java, Python, JS, CSS, etc.)
    899 +    171 +5. **Font Weight** - Use bold/normal strategically for visual hierarchy
    900 +    172 +6. **Color Contrast** - Ensure WCAG AA compliance (4.5:1 for text)
    901 +    173 +
    902 +    174 +## Token Coverage Checklist
    903 +    175 +
    904 +    176 +### Must Cover (Core)
    905 +    177 +
    906 +    178 +- [ ] keyword
    907 +    179 +- [ ] builtin
    908 +    180 +- [ ] class-name (distinct from keyword!)
    909 +    181 +- [ ] function
    910 +    182 +- [ ] string
    911 +    183 +- [ ] number
    912 +    184 +- [ ] boolean
    913 +    185 +- [ ] comment
    914 +    186 +- [ ] operator
    915 +    187 +- [ ] punctuation
    916 +    188 +- [ ] variable
    917 +    189 +- [ ] property
    918 +    190 +- [ ] constant
    919 +    191 +- [ ] regex
    920 +    192 +
    921 +    193 +### Markup Languages
    922 +    194 +
    923 +    195 +- [ ] tag
    924 +    196 +- [ ] attr-name
    925 +    197 +- [ ] attr-value
    926 +    198 +- [ ] namespace
    927 +    199 +- [ ] doctype
    928 +    200 +- [ ] entity
    929 +    201 +
    930 +    202 +### Advanced
    931 +    203 +
    932 +    204 +- [ ] atrule (CSS)
    933 +    205 +- [ ] selector (CSS)
    934 +    206 +- [ ] url
    935 +    207 +- [ ] inserted/deleted (Diff)
    936 +    208 +- [ ] bold/italic (Markdown)
    937 +    209 +- [ ] important (CSS)
 33 938      210 +
 34     -    211 +**Problem:** Theme dropdown showing "Default Light" even when sunset-dark theme was loaded from LocalStorage.
    939 +    211 +## Implementation Checklist
 35 940      212 +
 36     -    213 +**Root Cause:** Race condition in theme loading - dropdown was being set BEFORE async theme load completed.
 37     -    214 +
 38     -    215 +**Solution:**
 39     -    216 +
 40     -    217 +```javascript
 41     -    218 +// OLD (buggy):
 42     -    219 +if (savedTheme) {
 43     -    220 +  themeSelector.value = savedTheme; // Sets immediately
 44     -    221 +  themeManager.loadTheme(savedTheme); // Async, not awaited
 45     -    222 +}
    941 +    213 +- [ ] Define comprehensive CSS variable palette (8-10 distinct hues)
    942 +    214 +- [ ] Map ALL standard tokens to variables
    943 +    215 +- [ ] Add language-specific overrides where needed
    944 +    216 +- [ ] Test with Java (most complex token usage)
    945 +    217 +- [ ] Test with Python, JavaScript, CSS
    946 +    218 +- [ ] Verify font-weight hierarchy
    947 +    219 +- [ ] Check color contrast ratios
    948 +    220 +- [ ] Document color semantics
    949 +    221 +
    950 +    222 +## References
 46 951      223 +
 47     -    224 +// NEW (fixed):
 48     -    225 +if (savedTheme) {
 49     -    226 +  themeManager
 50     -    227 +    .loadTheme(savedTheme)
 51     -    228 +    .then(() => {
 52     -    229 +      themeSelector.value = savedTheme; // Only after successful load
 53     -    230 +      console.log(`‚úÖ Theme restored: ${savedTheme}`);
 54     -    231 +    })
 55     -    232 +    .catch(err => {
 56     -    233 +      // Fallback with proper sync
 57     -    234 +      themeManager.loadTheme('default-light').then(() => {
 58     -    235 +        themeSelector.value = 'default-light';
 59     -    236 +      });
 60     -    237 +    });
 61     -    238 +}
 62     -    239 +```
 63     -    240 +
 64     -    241 +**Key Changes:**
 65     -    242 +
 66     -    243 +1. Await theme load completion before syncing dropdown
 67     -    244 +2. Added success callback for dropdown update
 68     -    245 +3. Added error handling with fallback
 69     -    246 +4. Added console logging for debugging
 70     -    247 +
 71     -    248 +**Results:**
 72     -    249 +
 73     -    250 +- ‚úÖ Dropdown now syncs correctly with all themes
 74     -    251 +- ‚úÖ No more race conditions
 75     -    252 +- ‚úÖ Proper error handling
 76     -    253 +- ‚úÖ Works for all 12 themes (6 theme families √ó 2 variants)
 77     -    254 +
 78     -    255 +**Files Modified:** `script.js` (lines 1167-1183)
 79     -206 256  
 80     -207 257  ## Performance Observations
 81     -208 258  
 82     -209 259  
    952 +    224 +- [Prism Standard Tokens](https://prismjs.com/tokens.html)
    953 +    225 +- [Prism Theme: One Dark](https://github.com/PrismJS/prism-themes/blob/master/themes/prism-one-dark.css)
    954 +    226 +- [Atom One Dark Colors](https://github.com/atom/atom/tree/master/packages/one-dark-syntax)
    955 +    227  
 83 956  
 84 957  ```
 85 958  
@@ -89,277 +962,2340 @@ memory-bank/activeContext.md |  52 +++++++++-
 89 962  **Type:** JavaScript Source File üü®
 90 963  
 91 964  ```diff
 92     -@@ -145,101 +145,10 @@ function configureMarkedExtensions() {
 93     -145 145      return;
 94     -146 146    }
 95     -147 147  
 96     -148     -  // Add LaTeX environment extensions
 97     -    148 +  // Add inline math and text formatting extensions only
 98     -    149 +  // LaTeX environments (align, gather, etc.) are not supported by KaTeX
 99     -149 150    marked.use({
100     -150 151      extensions: [
101     -151     -      {
102     -152     -        name: 'latexEnvironment',
103     -153     -        level: 'block',
104     -154     -        start(src) {
105     -155     -          return src.match(/^\\begin\{/)?.index;
106     -156     -        },
107     -157     -        tokenizer(src) {
108     -158     -          const match = src.match(/^\\begin\{([^}]+)\}([\s\S]*?)\\end\{\1\}/);
109     -159     -          if (match) {
110     -160     -            return {
111     -161     -              type: 'latexEnvironment',
112     -162     -              raw: match[0],
113     -163     -              text: match[0],
114     -164     -            };
115     -165     -          }
116     -166     -        },
117     -167     -        renderer(token) {
118     -168     -          try {
119     -169     -            const rendered = katex.renderToString(token.text, {
120     -170     -              displayMode: true,
121     -171     -              throwOnError: false,
122     -172     -              trust: true,
123     -173     -              strict: false,
124     -174     -            });
125     -175     -            return `<div class="katex-display">${rendered}</div>`;
126     -176     -          } catch (e) {
127     -177     -            console.warn('KaTeX environment render error:', e);
128     -178     -            return `<div style="color: red; padding: 10px;">LaTeX Error: ${e.message}</div>`;
129     -179     -          }
130     -180     -        },
131     -181     -      },
132     -182     -      {
133     -183     -        name: 'latexDisplayBracket',
134     -184     -        level: 'block',
135     -185     -        start(src) {
136     -186     -          return src.match(/^\\\[/)?.index;
137     -187     -        },
138     -188     -        tokenizer(src) {
139     -189     -          const match = src.match(/^\\\[([\s\S]*?)\\\]/);
140     -190     -          if (match) {
141     -191     -            return {
142     -192     -              type: 'latexDisplayBracket',
143     -193     -              raw: match[0],
144     -194     -              text: match[1].trim(),
145     -195     -            };
146     -196     -          }
147     -197     -        },
148     -198     -        renderer(token) {
149     -199     -          try {
150     -200     -            const rendered = katex.renderToString(token.text, {
151     -201     -              displayMode: true,
152     -202     -              throwOnError: false,
153     -203     -              trust: true,
154     -204     -              strict: false,
155     -205     -            });
156     -206     -            return `<div class="katex-display">${rendered}</div>`;
157     -207     -          } catch (e) {
158     -208     -            console.warn('KaTeX bracket render error:', e);
159     -209     -            return `<div style="color: red; padding: 10px;">LaTeX Error: ${e.message}</div>`;
160     -210     -          }
161     -211     -        },
162     -212     -      },
163     -213     -      {
164     -214     -        name: 'latexInlineParen',
165     -215     -        level: 'inline',
166     -216     -        start(src) {
167     -217     -          return src.match(/\\\(/)?.index;
168     -218     -        },
169     -219     -        tokenizer(src) {
170     -220     -          const match = src.match(/^\\\(([\s\S]*?)\\\)/);
171     -221     -          if (match) {
172     -222     -            return {
173     -223     -              type: 'latexInlineParen',
174     -224     -              raw: match[0],
175     -225     -              text: match[1].trim(),
176     -226     -            };
177     -227     -          }
178     -228     -        },
179     -229     -        renderer(token) {
180     -230     -          try {
181     -231     -            return katex.renderToString(token.text, {
182     -232     -              displayMode: false,
183     -233     -              throwOnError: false,
184     -234     -              trust: true,
185     -235     -              strict: false,
186     -236     -            });
187     -237     -          } catch (e) {
188     -238     -            console.warn('KaTeX paren render error:', e);
189     -239     -            return `<span style="color: red;">LaTeX Error</span>`;
190     -240     -          }
191     -241     -        },
192     -242     -      },
193     -243 152        {
194     -244 153          name: 'mathBlock',
195     -245 154          level: 'block',
196     -@@ -503,101 +412,10 @@ graph TD
197     -503 412      return textarea.value;
198     -504 413    }
199     -505 414  
200     -506     -  // Add LaTeX environment extensions that render directly with KaTeX
201     -    415 +  // Keep only subscript and superscript extensions
202     -    416 +  // Remove LaTeX environment extensions that don't work with KaTeX
203     -507 417    marked.use({
204     -508 418      extensions: [
205     -509     -      {
206     -510     -        name: 'latexEnvironment',
207     -511     -        level: 'block',
208     -512     -        start(src) {
209     -513     -          return src.match(/^\\begin\{/)?.index;
210     -514     -        },
211     -515     -        tokenizer(src) {
212     -516     -          const match = src.match(/^\\begin\{([^}]+)\}([\s\S]*?)\\end\{\1\}/);
213     -517     -          if (match) {
214     -518     -            return {
215     -519     -              type: 'latexEnvironment',
216     -520     -              raw: match[0],
217     -521     -              text: match[0],
218     -522     -            };
219     -523     -          }
220     -524     -        },
221     -525     -        renderer(token) {
222     -526     -          try {
223     -527     -            const rendered = katex.renderToString(token.text, {
224     -528     -              displayMode: true,
225     -529     -              throwOnError: false,
226     -530     -              trust: true,
227     -531     -              strict: false,
228     -532     -            });
229     -533     -            return `<div class="katex-display">${rendered}</div>`;
230     -534     -          } catch (e) {
231     -535     -            console.warn('KaTeX environment render error:', e);
232     -536     -            return `<div style="color: red; padding: 10px;">LaTeX Error: ${e.message}</div>`;
233     -537     -          }
234     -538     -        },
235     -539     -      },
236     -540     -      {
237     -541     -        name: 'latexDisplayBracket',
238     -542     -        level: 'block',
239     -543     -        start(src) {
240     -544     -          return src.match(/^\\\[/)?.index;
241     -545     -        },
242     -546     -        tokenizer(src) {
243     -547     -          const match = src.match(/^\\\[([\s\S]*?)\\\]/);
244     -548     -          if (match) {
245     -549     -            return {
246     -550     -              type: 'latexDisplayBracket',
247     -551     -              raw: match[0],
248     -552     -              text: match[1].trim(),
249     -553     -            };
250     -554     -          }
251     -555     -        },
252     -556     -        renderer(token) {
253     -557     -          try {
254     -558     -            const rendered = katex.renderToString(token.text, {
255     -559     -              displayMode: true,
256     -560     -              throwOnError: false,
257     -561     -              trust: true,
258     -562     -              strict: false,
259     -563     -            });
260     -564     -            return `<div class="katex-display">${rendered}</div>`;
261     -565     -          } catch (e) {
262     -566     -            console.warn('KaTeX bracket render error:', e);
263     -567     -            return `<div style="color: red; padding: 10px;">LaTeX Error: ${e.message}</div>`;
264     -568     -          }
265     -569     -        },
266     -570     -      },
267     -571     -      {
268     -572     -        name: 'latexInlineParen',
269     -573     -        level: 'inline',
270     -574     -        start(src) {
271     -575     -          return src.match(/\\\(/)?.index;
272     -576     -        },
273     -577     -        tokenizer(src) {
274     -578     -          const match = src.match(/^\\\(([\s\S]*?)\\\)/);
275     -579     -          if (match) {
276     -580     -            return {
277     -581     -              type: 'latexInlineParen',
278     -582     -              raw: match[0],
279     -583     -              text: match[1].trim(),
280     -584     -            };
281     -585     -          }
282     -586     -        },
283     -587     -        renderer(token) {
284     -588     -          try {
285     -589     -            return katex.renderToString(token.text, {
286     -590     -              displayMode: false,
287     -591     -              throwOnError: false,
288     -592     -              trust: true,
289     -593     -              strict: false,
290     -594     -            });
291     -595     -          } catch (e) {
292     -596     -            console.warn('KaTeX paren render error:', e);
293     -597     -            return `<span style="color: red;">LaTeX Error</span>`;
294     -598     -          }
295     -599     -        },
296     -600     -      },
297     -601 419        {
298     -602 420          name: 'subscript',
299     -603 421          level: 'inline',
300     -@@ -641,7 +459,7 @@ graph TD
301     -641 459      ],
302     -642 460    });
303     -643 461  
304     -644     -  console.log('‚úÖ LaTeX environments, subscript, and superscript enabled');
305     -    462 +  console.log('‚úÖ Subscript and superscript enabled (LaTeX environments display as-is)');
306     -645 463  
307     -646 464    // Render markdown
308     -647 465    function renderMarkdown() {
309     -@@ -685,22 +503,9 @@ graph TD
310     -685 503        // Apply Prism syntax highlighting using PrismService
311     -686 504        prismService.highlightAll(preview);
312     -687 505  
313     -688     -      // Apply KaTeX auto-render only for any remaining $...$ syntax
314     -689     -      if (typeof renderMathInElement !== 'undefined') {
315     -690     -        try {
316     -691     -          renderMathInElement(preview, {
317     -692     -            delimiters: [
318     -693     -              { left: '$$', right: '$$', display: true },
319     -694     -              { left: '$', right: '$', display: false },
320     -695     -            ],
321     -696     -            throwOnError: false,
322     -697     -            trust: true,
323     -698     -            strict: false,
324     -699     -          });
325     -700     -        } catch (e) {
326     -701     -          console.warn('KaTeX auto-render error:', e);
327     -702     -        }
328     -703     -      }
329     -    506 +      // NOTE: KaTeX auto-render is DISABLED
330     -    507 +      // We handle all math via marked.js extensions ($...$ and $$...$$)
331     -    508 +      // KaTeX auto-render was causing issues with unsupported LaTeX environments
332     -704 509  
333     -705 510        // Save content using StorageManager
334     -706 511        storageManager.set('markdownContent', markdownText);
335     -@@ -1167,11 +972,21 @@ graph TD
336     -1167 972    // Load saved theme using ThemeManager
337     -1168 973    const savedTheme = storageManager.get('selectedTheme');
338     -1169 974    if (savedTheme) {
339     -1170     -    themeSelector.value = savedTheme;
340     -1171     -    themeManager.loadTheme(savedTheme).catch(err => {
341     -1172     -      console.error('Failed to load saved theme:', err);
342     -1173     -      themeManager.loadTheme('default-light');
343     -1174     -    });
344     -    975 +    // Load theme first, then sync dropdown only on success
345     -    976 +    themeManager
346     -    977 +      .loadTheme(savedTheme)
347     -    978 +      .then(() => {
348     -    979 +        // Theme loaded successfully - sync dropdown
349     -    980 +        themeSelector.value = savedTheme;
350     -    981 +        console.log(`‚úÖ Theme restored: ${savedTheme}`);
351     -    982 +      })
352     -    983 +      .catch(err => {
353     -    984 +        console.error('Failed to load saved theme:', err);
354     -    985 +        // Fallback to default-light on error
355     -    986 +        themeManager.loadTheme('default-light').then(() => {
356     -    987 +          themeSelector.value = 'default-light';
357     -    988 +        });
358     -    989 +      });
359     -1175 990    }
360     -1176 991  
361     -1177 992    // Zoom functionality
362     -1178 993  
    965 +@@ -20,9 +20,20 @@ const folderBrowserService = new FolderBrowserService(storageManager);
    966 + 20  20  const currentFolderFiles = [];
    967 + 21  21  const currentFileHandle = null;
    968 + 22  22  
    969 + 23     -// Configure theme change listener to update Mermaid
    970 +     23 +// Global render function reference (will be set in setupEditor)
    971 +     24 +let globalRenderMarkdown = null;
    972 +     25 +
    973 +     26 +// Configure theme change listener to update Mermaid and force re-render
    974 + 24  27  themeManager.setThemeChangeListener(() => {
    975 + 25  28    mermaidService.reinitialize();
    976 +     29 +
    977 +     30 +  // Force re-render of markdown to apply new Mermaid colors
    978 +     31 +  setTimeout(() => {
    979 +     32 +    if (globalRenderMarkdown) {
    980 +     33 +      console.log('üîÑ Re-rendering diagrams with new theme colors');
    981 +     34 +      globalRenderMarkdown();
    982 +     35 +    }
    983 +     36 +  }, 200);
    984 + 26  37  });
    985 + 27  38  
    986 + 28  39  // Wait for all scripts to load
    987 +@@ -77,8 +88,8 @@ function initializeApp() {
    988 + 77  88    // Configure marked.js extensions
    989 + 78  89    configureMarkedExtensions();
    990 + 79  90  
    991 + 80     -  // Initialize Mermaid with theme-aware configuration
    992 + 81     -  initMermaidTheme();
    993 +     91 +  // DON'T initialize Mermaid here - let saved theme load first
    994 +     92 +  // Mermaid will initialize after theme loads in setupEditor()
    995 + 82  93  
    996 + 83  94    setupEditor();
    997 + 84  95  }
    998 +@@ -461,7 +472,7 @@ graph TD
    999 +461 472  
    1000 +462 473    console.log('‚úÖ Subscript and superscript enabled (LaTeX environments display as-is)');
    1001 +463 474  
    1002 +464     -  // Render markdown
    1003 +    475 +  // Render markdown (expose globally for theme changes)
    1004 +465 476    function renderMarkdown() {
    1005 +466 477      try {
    1006 +467 478        const markdownText = editor.value;
    1007 +@@ -520,8 +531,16 @@ graph TD
    1008 +520 531    async function changeTheme(themeName) {
    1009 +521 532      await themeManager.loadTheme(themeName);
    1010 +522 533  
    1011 +523     -    // Re-render to apply new Mermaid theme (observer already handles reinit)
    1012 +    534 +    // Wait for theme to load, then reinitialize Mermaid and force re-render
    1013 +524 535      setTimeout(() => {
    1014 +    536 +      // Clear existing Mermaid diagrams to force fresh render with new colors
    1015 +    537 +      const mermaidElements = preview.querySelectorAll('.mermaid');
    1016 +    538 +      mermaidElements.forEach(el => {
    1017 +    539 +        // Reset to original code to force re-render
    1018 +    540 +        el.innerHTML = el.dataset.originalCode || '';
    1019 +    541 +      });
    1020 +    542 +
    1021 +    543 +      // Re-render markdown with new theme
    1022 +525 544        renderMarkdown();
    1023 +526 545      }, 100);
    1024 +527 546    }
    1025 +@@ -969,24 +988,36 @@ graph TD
    1026 +969 988    // Initialize visibility
    1027 +970 989    updateSyncScrollVisibility();
    1028 +971 990  
    1029 +972     -  // Load saved theme using ThemeManager
    1030 +    991 +  // Load saved theme FIRST, then initialize Mermaid with correct colors
    1031 +973 992    const savedTheme = storageManager.get('selectedTheme');
    1032 +974 993    if (savedTheme) {
    1033 +975     -    // Load theme first, then sync dropdown only on success
    1034 +    994 +    // Load theme first, then sync dropdown and reinit Mermaid
    1035 +976 995      themeManager
    1036 +977 996        .loadTheme(savedTheme)
    1037 +978 997        .then(() => {
    1038 +979 998          // Theme loaded successfully - sync dropdown
    1039 +980 999          themeSelector.value = savedTheme;
    1040 +981 1000          console.log(`‚úÖ Theme restored: ${savedTheme}`);
    1041 +    1001 +
    1042 +    1002 +        // NOW initialize Mermaid with correct theme colors
    1043 +    1003 +        mermaidService.initialize();
    1044 +    1004 +
    1045 +    1005 +        // Re-render to apply theme
    1046 +    1006 +        renderMarkdown();
    1047 +982 1007        })
    1048 +983 1008        .catch(err => {
    1049 +984 1009          console.error('Failed to load saved theme:', err);
    1050 +985 1010          // Fallback to default-light on error
    1051 +986 1011          themeManager.loadTheme('default-light').then(() => {
    1052 +987 1012            themeSelector.value = 'default-light';
    1053 +    1013 +          mermaidService.initialize();
    1054 +    1014 +          renderMarkdown();
    1055 +988 1015          });
    1056 +989 1016        });
    1057 +    1017 +  } else {
    1058 +    1018 +    // No saved theme - initialize with default-light
    1059 +    1019 +    mermaidService.initialize();
    1060 +    1020 +    renderMarkdown();
    1061 +990 1021    }
    1062 +991 1022  
    1063 +992 1023    // Zoom functionality
    1064 +@@ -1332,6 +1363,9 @@ graph TD
    1065 +1332 1363      console.log(`‚úÖ Loaded file: ${fileItem.name} (${result.size} bytes)`);
    1066 +1333 1364    }
    1067 +1334 1365  
    1068 +1335     -  // Initial render
    1069 +1336     -  renderMarkdown();
    1070 +    1366 +  // Expose renderMarkdown globally for theme changes
    1071 +    1367 +  globalRenderMarkdown = renderMarkdown;
    1072 +    1368 +
    1073 +    1369 +  // DON'T render immediately - wait for theme to load
    1074 +    1370 +  // renderMarkdown will be called after theme loads above
    1075 +1337 1371  }
    1076 +1338 1372  
    1077 +
    1078 +```
    1079 +
    1080 +
    1081 +### üìÑ `src/js/services/MermaidService.js`
    1082 +
    1083 +**Type:** JavaScript Source File üü®
    1084 +
    1085 +```diff
    1086 +@@ -2,12 +2,51 @@
    1087 +  2   2   * MermaidService - Mermaid Diagram Rendering Service
    1088 +  3   3   *
    1089 +  4   4   * Handles all Mermaid diagram rendering with theme-aware configuration.
    1090 +      5 + * Automatically detects light/dark themes and adjusts for optimal readability.
    1091 +  5   6   * Isolated service for better testability and maintainability.
    1092 +  6   7   */
    1093 +  7   8  
    1094 +  8   9  import { MERMAID_CONFIG } from '../config/constants.js';
    1095 +  9  10  import { getCssVariable } from '../utils/colorHelpers.js';
    1096 + 10  11  
    1097 +     12 +/**
    1098 +     13 + * Calculate relative luminance of a color
    1099 +     14 + * Used to detect if theme is light or dark
    1100 +     15 + *
    1101 +     16 + * @param {string} color - Hex color (#rrggbb)
    1102 +     17 + * @returns {number} Luminance value (0-1)
    1103 +     18 + * @private
    1104 +     19 + */
    1105 +     20 +function getRelativeLuminance(color) {
    1106 +     21 +  // Remove # if present
    1107 +     22 +  const hex = color.replace('#', '');
    1108 +     23 +
    1109 +     24 +  // Convert to RGB
    1110 +     25 +  const r = parseInt(hex.substr(0, 2), 16) / 255;
    1111 +     26 +  const g = parseInt(hex.substr(2, 2), 16) / 255;
    1112 +     27 +  const b = parseInt(hex.substr(4, 2), 16) / 255;
    1113 +     28 +
    1114 +     29 +  // Apply sRGB gamma correction
    1115 +     30 +  const rsRGB = r <= 0.03928 ? r / 12.92 : ((r + 0.055) / 1.055) ** 2.4;
    1116 +     31 +  const gsRGB = g <= 0.03928 ? g / 12.92 : ((g + 0.055) / 1.055) ** 2.4;
    1117 +     32 +  const bsRGB = b <= 0.03928 ? b / 12.92 : ((b + 0.055) / 1.055) ** 2.4;
    1118 +     33 +
    1119 +     34 +  // Calculate relative luminance
    1120 +     35 +  return 0.2126 * rsRGB + 0.7152 * gsRGB + 0.0722 * bsRGB;
    1121 +     36 +}
    1122 +     37 +
    1123 +     38 +/**
    1124 +     39 + * Detect if current theme is light or dark
    1125 +     40 + *
    1126 +     41 + * @param {string} bgColor - Background color
    1127 +     42 + * @returns {boolean} True if light theme
    1128 +     43 + * @private
    1129 +     44 + */
    1130 +     45 +function isLightTheme(bgColor) {
    1131 +     46 +  const luminance = getRelativeLuminance(bgColor);
    1132 +     47 +  return luminance > 0.5; // Threshold for light/dark
    1133 +     48 +}
    1134 +     49 +
    1135 + 11  50  /**
    1136 + 12  51   * @class MermaidService
    1137 + 13  52   * @description Service for rendering Mermaid diagrams with theme integration
    1138 +@@ -23,46 +62,187 @@ export class MermaidService {
    1139 + 23  62    }
    1140 + 24  63  
    1141 + 25  64    /**
    1142 + 26     -   * Initialize Mermaid with current theme colors
    1143 + 27     -   * Extracts theme colors from CSS variables and configures Mermaid
    1144 +     65 +   * Initialize Mermaid with COMPREHENSIVE theme configuration
    1145 +     66 +   * Reads ALL 60+ variables from theme CSS with smart fallbacks
    1146 +     67 +   * Based on official Mermaid.js theming documentation
    1147 + 28  68     *
    1148 + 29  69     * @returns {void}
    1149 + 30  70     */
    1150 + 31  71    initialize() {
    1151 + 32     -    // Extract theme colors from CSS variables
    1152 + 33     -    const h1Color = getCssVariable('--h1-color');
    1153 + 34     -    const h2Color = getCssVariable('--h2-color');
    1154 + 35     -    const h3Color = getCssVariable('--h3-color');
    1155 + 36     -    const bgSecondary = getCssVariable('--bg-secondary');
    1156 + 37     -    const textPrimary = getCssVariable('--text-primary');
    1157 +     72 +    // Helper to get variable with fallback
    1158 +     73 +    const get = (varName, fallback) => {
    1159 +     74 +      const value = getCssVariable(varName);
    1160 +     75 +      return value && value.trim() !== '' ? value : fallback;
    1161 +     76 +    };
    1162 +     77 +
    1163 +     78 +    // Extract core theme colors for fallbacks
    1164 +     79 +    const bgPri = getCssVariable('--bg-primary');
    1165 +     80 +    const bgSec = getCssVariable('--bg-secondary');
    1166 +     81 +    const bgTer = getCssVariable('--bg-tertiary');
    1167 +     82 +    const txtPri = getCssVariable('--text-primary');
    1168 +     83 +    const txtSec = getCssVariable('--text-secondary');
    1169 +     84 +    const h1 = getCssVariable('--h1-color');
    1170 +     85 +    const h2 = getCssVariable('--h2-color');
    1171 +     86 +    const h3 = getCssVariable('--h3-color');
    1172 +     87 +
    1173 +     88 +    const isLight = isLightTheme(bgPri);
    1174 +     89 +    const nodeBkg = isLight ? bgTer : bgSec;
    1175 +     90 +    const clusterBkg = isLight ? bgSec : bgTer;
    1176 + 38  91  
    1177 + 39     -    // Configure Mermaid with theme colors
    1178 + 40  92      if (typeof mermaid !== 'undefined') {
    1179 + 41  93        mermaid.initialize({
    1180 + 42  94          startOnLoad: MERMAID_CONFIG.START_ON_LOAD,
    1181 + 43  95          theme: MERMAID_CONFIG.THEME,
    1182 + 44  96          themeVariables: {
    1183 + 45     -          primaryColor: bgSecondary,
    1184 + 46     -          primaryTextColor: textPrimary,
    1185 + 47     -          primaryBorderColor: h1Color,
    1186 + 48     -          lineColor: h2Color,
    1187 + 49     -          secondaryColor: bgSecondary,
    1188 + 50     -          tertiaryColor: bgSecondary,
    1189 + 51     -          background: bgSecondary,
    1190 + 52     -          mainBkg: bgSecondary,
    1191 + 53     -          secondBkg: bgSecondary,
    1192 + 54     -          tertiaryBkg: bgSecondary,
    1193 + 55     -          nodeBorder: h1Color,
    1194 + 56     -          clusterBkg: bgSecondary,
    1195 + 57     -          clusterBorder: h3Color,
    1196 + 58     -          titleColor: textPrimary,
    1197 + 59     -          edgeLabelBackground: bgSecondary,
    1198 + 60     -          nodeTextColor: textPrimary,
    1199 +     97 +          // Core Global
    1200 +     98 +          background: get('--mermaid-background', bgPri),
    1201 + 61  99            fontFamily: '-apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif',
    1202 +    100 +          fontSize: '16px',
    1203 +    101 +          darkMode: !isLight,
    1204 +    102 +          textColor: get('--mermaid-text-color', txtPri),
    1205 +    103 +          lineColor: get('--mermaid-line-color', h2),
    1206 +    104 +          mainBkg: get('--mermaid-main-bkg', nodeBkg),
    1207 +    105 +
    1208 +    106 +          // Primary Set
    1209 +    107 +          primaryColor: get('--mermaid-primary-color', nodeBkg),
    1210 +    108 +          primaryTextColor: get('--mermaid-primary-text-color', txtPri),
    1211 +    109 +          primaryBorderColor: get('--mermaid-primary-border-color', h1),
    1212 +    110 +
    1213 +    111 +          // Secondary Set
    1214 +    112 +          secondaryColor: get('--mermaid-secondary-color', clusterBkg),
    1215 +    113 +          secondaryTextColor: get('--mermaid-secondary-text-color', txtPri),
    1216 +    114 +          secondaryBorderColor: get('--mermaid-secondary-border-color', h2),
    1217 +    115 +
    1218 +    116 +          // Tertiary Set
    1219 +    117 +          tertiaryColor: get('--mermaid-tertiary-color', bgPri),
    1220 +    118 +          tertiaryTextColor: get('--mermaid-tertiary-text-color', txtPri),
    1221 +    119 +          tertiaryBorderColor: get('--mermaid-tertiary-border-color', h3),
    1222 +    120 +
    1223 +    121 +          // Flowchart
    1224 +    122 +          nodeBorder: get('--mermaid-node-border', h1),
    1225 +    123 +          clusterBkg: get('--mermaid-cluster-bkg', clusterBkg),
    1226 +    124 +          clusterBorder: get('--mermaid-cluster-border', h2),
    1227 +    125 +          defaultLinkColor: get('--mermaid-default-link-color', h2),
    1228 +    126 +          titleColor: get('--mermaid-title-color', txtPri),
    1229 +    127 +          edgeLabelBackground: get('--mermaid-edge-label-background', bgPri),
    1230 +    128 +          nodeTextColor: get('--mermaid-node-text-color', txtPri),
    1231 +    129 +
    1232 +    130 +          // Sequence Diagram
    1233 +    131 +          actorBkg: get('--mermaid-actor-bkg', nodeBkg),
    1234 +    132 +          actorBorder: get('--mermaid-actor-border', h1),
    1235 +    133 +          actorTextColor: get('--mermaid-actor-text-color', txtPri),
    1236 +    134 +          actorLineColor: get('--mermaid-actor-line-color', h1),
    1237 +    135 +          signalColor: get('--mermaid-signal-color', h2),
    1238 +    136 +          signalTextColor: get('--mermaid-signal-text-color', txtPri),
    1239 +    137 +          labelBoxBkgColor: get('--mermaid-label-box-bkg-color', nodeBkg),
    1240 +    138 +          labelBoxBorderColor: get('--mermaid-label-box-border-color', h1),
    1241 +    139 +          labelTextColor: get('--mermaid-label-text-color', txtPri),
    1242 +    140 +          loopTextColor: get('--mermaid-loop-text-color', txtPri),
    1243 +    141 +          activationBorderColor: get('--mermaid-activation-border-color', h2),
    1244 +    142 +          activationBkgColor: get('--mermaid-activation-bkg-color', clusterBkg),
    1245 +    143 +          sequenceNumberColor: get('--mermaid-sequence-number-color', txtPri),
    1246 +    144 +
    1247 +    145 +          // Pie Chart
    1248 +    146 +          pie1: get('--mermaid-pie1', h1),
    1249 +    147 +          pie2: get('--mermaid-pie2', h2),
    1250 +    148 +          pie3: get('--mermaid-pie3', h3),
    1251 +    149 +          pie4: get('--mermaid-pie4', txtSec),
    1252 +    150 +          pie5: get('--mermaid-pie5', h1),
    1253 +    151 +          pie6: get('--mermaid-pie6', h2),
    1254 +    152 +          pie7: get('--mermaid-pie7', h3),
    1255 +    153 +          pie8: get('--mermaid-pie8', txtSec),
    1256 +    154 +          pie9: get('--mermaid-pie9', h1),
    1257 +    155 +          pie10: get('--mermaid-pie10', h2),
    1258 +    156 +          pie11: get('--mermaid-pie11', h3),
    1259 +    157 +          pie12: get('--mermaid-pie12', txtSec),
    1260 +    158 +          pieTitleTextSize: '25px',
    1261 +    159 +          pieTitleTextColor: get('--mermaid-pie-title-text-color', txtPri),
    1262 +    160 +          pieSectionTextSize: '17px',
    1263 +    161 +          pieSectionTextColor: get('--mermaid-pie-section-text-color', bgPri),
    1264 +    162 +          pieLegendTextSize: '17px',
    1265 +    163 +          pieLegendTextColor: get('--mermaid-pie-legend-text-color', txtPri),
    1266 +    164 +          pieStrokeColor: get('--mermaid-pie-stroke-color', h1),
    1267 +    165 +          pieStrokeWidth: '2px',
    1268 +    166 +          pieOuterStrokeWidth: '2px',
    1269 +    167 +          pieOuterStrokeColor: get('--mermaid-pie-outer-stroke-color', h1),
    1270 +    168 +          pieOpacity: '0.9',
    1271 +    169 +
    1272 +    170 +          // State Diagram
    1273 +    171 +          labelColor: get('--mermaid-label-color', txtPri),
    1274 +    172 +          altBackground: get('--mermaid-alt-background', clusterBkg),
    1275 +    173 +
    1276 +    174 +          // Class Diagram
    1277 +    175 +          classText: get('--mermaid-class-text', txtPri),
    1278 +    176 +
    1279 +    177 +          // User Journey
    1280 +    178 +          fillType0: get('--mermaid-fill-type0', h1),
    1281 +    179 +          fillType1: get('--mermaid-fill-type1', h2),
    1282 +    180 +          fillType2: get('--mermaid-fill-type2', h3),
    1283 +    181 +          fillType3: get('--mermaid-fill-type3', txtSec),
    1284 +    182 +          fillType4: get('--mermaid-fill-type4', h1),
    1285 +    183 +          fillType5: get('--mermaid-fill-type5', h2),
    1286 +    184 +          fillType6: get('--mermaid-fill-type6', h3),
    1287 +    185 +          fillType7: get('--mermaid-fill-type7', txtSec),
    1288 +    186 +
    1289 +    187 +          // Gantt Chart
    1290 +    188 +          sectionBkgColor: get('--mermaid-section-bkg-color', bgSec),
    1291 +    189 +          altSectionBkgColor: get('--mermaid-alt-section-bkg-color', bgTer),
    1292 +    190 +          sectionBkgColor2: get('--mermaid-section-bkg-color2', bgSec),
    1293 +    191 +          taskTextColor: get('--mermaid-task-text-color', txtPri),
    1294 +    192 +          taskTextLightColor: get('--mermaid-task-text-light-color', txtPri),
    1295 +    193 +          taskTextOutsideColor: get('--mermaid-task-text-outside-color', txtPri),
    1296 +    194 +          taskTextClickableColor: get('--mermaid-task-text-clickable-color', h1),
    1297 +    195 +          activeTaskBkgColor: get('--mermaid-active-task-bkg-color', h1),
    1298 +    196 +          activeTaskBorderColor: get('--mermaid-active-task-border-color', h1),
    1299 +    197 +          doneTaskBkgColor: get('--mermaid-done-task-bkg-color', h3),
    1300 +    198 +          doneTaskBorderColor: get('--mermaid-done-task-border-color', h3),
    1301 +    199 +          critBorderColor: get('--mermaid-crit-border-color', h2),
    1302 +    200 +          critBkgColor: get('--mermaid-crit-bkg-color', h2),
    1303 +    201 +          todayLineColor: get('--mermaid-today-line-color', h2),
    1304 +    202 +          gridColor: get('--mermaid-grid-color', bgTer),
    1305 +    203 +          sectionTextColor: get('--mermaid-section-text-color', txtPri),
    1306 +    204 +          taskBorderColor: get('--mermaid-task-border-color', h1),
    1307 +    205 +
    1308 +    206 +          // ER Diagram
    1309 +    207 +          attributeBackgroundColorOdd: get('--mermaid-attribute-background-color-odd', bgSec),
    1310 +    208 +          attributeBackgroundColorEven: get('--mermaid-attribute-background-color-even', bgPri),
    1311 +    209 +          relationshipLabelBackground: get('--mermaid-relationship-label-background', bgPri),
    1312 +    210 +          relationshipLabelColor: get('--mermaid-relationship-label-color', txtPri),
    1313 +    211 +          entityBackground: get('--mermaid-entity-background', nodeBkg),
    1314 +    212 +          entityBorderColor: get('--mermaid-entity-border-color', h1),
    1315 +    213 +
    1316 +    214 +          // Git Graph
    1317 +    215 +          git0: get('--mermaid-git0', h1),
    1318 +    216 +          git1: get('--mermaid-git1', h2),
    1319 +    217 +          git2: get('--mermaid-git2', h3),
    1320 +    218 +          git3: get('--mermaid-git3', txtSec),
    1321 +    219 +          git4: get('--mermaid-git4', h1),
    1322 +    220 +          git5: get('--mermaid-git5', h2),
    1323 +    221 +          git6: get('--mermaid-git6', h3),
    1324 +    222 +          git7: get('--mermaid-git7', txtSec),
    1325 +    223 +          gitInv0: get('--mermaid-git-inv0', bgPri),
    1326 +    224 +          gitBranchLabel0: get('--mermaid-git-branch-label0', txtPri),
    1327 +    225 +          gitBranchLabel1: get('--mermaid-git-branch-label1', txtPri),
    1328 +    226 +          gitBranchLabel2: get('--mermaid-git-branch-label2', txtPri),
    1329 +    227 +          gitBranchLabel3: get('--mermaid-git-branch-label3', txtPri),
    1330 +    228 +          gitBranchLabel4: get('--mermaid-git-branch-label4', txtPri),
    1331 +    229 +          commitLabelColor: get('--mermaid-commit-label-color', txtPri),
    1332 +    230 +          commitLabelBackground: get('--mermaid-commit-label-background', bgPri),
    1333 +    231 +          tagLabelColor: get('--mermaid-tag-label-color', txtPri),
    1334 +    232 +          tagLabelBackground: get('--mermaid-tag-label-background', nodeBkg),
    1335 +    233 +          tagLabelBorder: get('--mermaid-tag-label-border', h1),
    1336 + 62 234          },
    1337 + 63 235        });
    1338 + 64 236  
    1339 + 65 237        this.initialized = true;
    1340 +    238 +
    1341 +    239 +      // Debug: Log sample of loaded variables
    1342 +    240 +      console.log(`‚úÖ Mermaid initialized`);
    1343 +    241 +      console.log(`  - Background: ${get('--mermaid-background', bgPri)}`);
    1344 +    242 +      console.log(`  - Text: ${get('--mermaid-text-color', txtPri)}`);
    1345 +    243 +      console.log(`  - Line: ${get('--mermaid-line-color', h2)}`);
    1346 +    244 +      console.log(`  - Primary: ${get('--mermaid-primary-color', nodeBkg)}`);
    1347 +    245 +      console.log(`  - Pie1: ${get('--mermaid-pie1', h1)}`);
    1348 + 66 246      } else {
    1349 + 67 247        console.warn('Mermaid library not loaded');
    1350 + 68 248      }
    1351 + 69 249  
    1352 +
    1353 +```
    1354 +
    1355 +
    1356 +### üìÑ `style.css`
    1357 +
    1358 +**Type:** Stylesheet üé®
    1359 +
    1360 +```diff
    1361 +@@ -297,68 +297,119 @@ body {
    1362 +297 297    padding: 0;
    1363 +298 298  }
    1364 +299 299  
    1365 +300     -/* Syntax Highlighting with Custom Variables - Comprehensive Token Coverage */
    1366 +301     -#markdown-preview .token.keyword {
    1367 +302     -  color: var(--syntax-keyword, #c792ea) !important;
    1368 +    300 +/* ==================== PRISM SYNTAX HIGHLIGHTING - PRODUCTION GRADE ==================== */
    1369 +    301 +/* Based on One Dark theme architecture - comprehensive token coverage */
    1370 +    302 +
    1371 +    303 +/* Group 1: Comments and documentation */
    1372 +    304 +#markdown-preview .token.comment,
    1373 +    305 +#markdown-preview .token.prolog,
    1374 +    306 +#markdown-preview .token.cdata {
    1375 +    307 +  color: var(--syntax-comment, #7f85a3);
    1376 +    308 +  font-style: italic;
    1377 +303 309  }
    1378 +304 310  
    1379 +305     -#markdown-preview .token.string {
    1380 +306     -  color: var(--syntax-string, #a5e844) !important;
    1381 +307     -}
    1382 +308     -
    1383 +309     -#markdown-preview .token.number,
    1384 +310     -#markdown-preview .token.boolean {
    1385 +311     -  color: var(--syntax-number, #ffcb6b) !important;
    1386 +312     -}
    1387 +313     -
    1388 +314     -#markdown-preview .token.function,
    1389 +315     -#markdown-preview .token.function-variable,
    1390 +316     -#markdown-preview .token.method,
    1391 +317     -#markdown-preview .token.method-variable {
    1392 +318     -  color: var(--syntax-function, #82aaff) !important;
    1393 +319     -  font-weight: 600;
    1394 +320     -}
    1395 +321     -
    1396 +322     -#markdown-preview .token.comment {
    1397 +323     -  color: var(--syntax-comment, #7f85a3) !important;
    1398 +324     -}
    1399 +325     -
    1400 +326     -#markdown-preview .token.operator {
    1401 +327     -  color: var(--syntax-operator, #89ddff) !important;
    1402 +328     -}
    1403 +329     -
    1404 +330     -#markdown-preview .token.punctuation {
    1405 +331     -  color: var(--syntax-punctuation, #89ddff) !important;
    1406 +    311 +/* Group 2: Neutral tokens (inherit or subtle) */
    1407 +    312 +#markdown-preview .token.doctype,
    1408 +    313 +#markdown-preview .token.punctuation,
    1409 +    314 +#markdown-preview .token.entity {
    1410 +    315 +  color: var(--syntax-punctuation, #64748b);
    1411 +332 316  }
    1412 +333 317  
    1413 +    318 +/* Group 3: Orange hue - Class names, constants, numbers, booleans, atrules */
    1414 +    319 +#markdown-preview .token.attr-name,
    1415 +334 320  #markdown-preview .token.class-name,
    1416 +335     -#markdown-preview .token.type-class-name {
    1417 +336     -  color: var(--syntax-keyword, #ffcb6b) !important;
    1418 +    321 +#markdown-preview .token.boolean,
    1419 +    322 +#markdown-preview .token.constant,
    1420 +    323 +#markdown-preview .token.number,
    1421 +    324 +#markdown-preview .token.atrule {
    1422 +    325 +  color: var(--syntax-class-name, #f97316);
    1423 +337 326    font-weight: 600;
    1424 +338 327  }
    1425 +339 328  
    1426 +340     -/* Variables and Parameters - NEW */
    1427 +341     -#markdown-preview .token.parameter,
    1428 +342     -#markdown-preview .token.variable,
    1429 +343     -#markdown-preview .token.plain {
    1430 +344     -  color: var(--syntax-variable, var(--text-primary)) !important;
    1431 +345     -  font-weight: 500;
    1432 +    329 +/* Group 4: Purple hue - Keywords (distinct from class names!) */
    1433 +    330 +#markdown-preview .token.keyword {
    1434 +    331 +  color: var(--syntax-keyword, #a855f7);
    1435 +    332 +  font-weight: 700;
    1436 +346 333  }
    1437 +347 334  
    1438 +348     -/* Properties and Namespaces - NEW */
    1439 +    335 +/* Group 5: Red hue - Properties, tags, symbols, deleted, important */
    1440 +349 336  #markdown-preview .token.property,
    1441 +350     -#markdown-preview .token.property-access {
    1442 +351     -  color: var(--syntax-property, var(--syntax-function)) !important;
    1443 +    337 +#markdown-preview .token.tag,
    1444 +    338 +#markdown-preview .token.symbol,
    1445 +    339 +#markdown-preview .token.deleted,
    1446 +    340 +#markdown-preview .token.important {
    1447 +    341 +  color: var(--syntax-property, #ef4444);
    1448 +    342 +  font-weight: 600;
    1449 +352 343  }
    1450 +353 344  
    1451 +    345 +/* Group 6: Green hue - Strings, chars, builtins, inserted, regex, selectors */
    1452 +    346 +#markdown-preview .token.selector,
    1453 +    347 +#markdown-preview .token.string,
    1454 +    348 +#markdown-preview .token.char,
    1455 +    349 +#markdown-preview .token.builtin,
    1456 +    350 +#markdown-preview .token.inserted,
    1457 +    351 +#markdown-preview .token.regex,
    1458 +    352 +#markdown-preview .token.attr-value {
    1459 +    353 +  color: var(--syntax-string, #10b981);
    1460 +    354 +}
    1461 +    355 +
    1462 +    356 +/* Nested attr-value punctuation (quotes) */
    1463 +    357 +#markdown-preview .token.attr-value > .token.punctuation {
    1464 +    358 +  color: var(--syntax-string, #10b981);
    1465 +    359 +}
    1466 +    360 +
    1467 +    361 +/* Group 7: Blue hue - Variables, operators, functions */
    1468 +    362 +#markdown-preview .token.variable,
    1469 +    363 +#markdown-preview .token.operator,
    1470 +    364 +#markdown-preview .token.function {
    1471 +    365 +  color: var(--syntax-function, #3b82f6);
    1472 +    366 +  font-weight: 600;
    1473 +    367 +}
    1474 +    368 +
    1475 +    369 +/* Group 8: Cyan hue - URLs */
    1476 +    370 +#markdown-preview .token.url {
    1477 +    371 +  color: var(--syntax-url, #14b8a6);
    1478 +    372 +}
    1479 +    373 +
    1480 +    374 +/* ==================== LANGUAGE-SPECIFIC OVERRIDES ==================== */
    1481 +    375 +
    1482 +    376 +/* JavaScript overrides */
    1483 +    377 +#markdown-preview .language-javascript .token.operator {
    1484 +    378 +  color: var(--syntax-keyword, #a855f7);
    1485 +    379 +}
    1486 +    380 +
    1487 +    381 +/* CSS overrides */
    1488 +    382 +#markdown-preview .language-css .token.selector {
    1489 +    383 +  color: var(--syntax-property, #ef4444);
    1490 +    384 +}
    1491 +    385 +
    1492 +    386 +#markdown-preview .language-css .token.property {
    1493 +    387 +  color: var(--text-primary);
    1494 +    388 +}
    1495 +    389 +
    1496 +    390 +/* JSON overrides */
    1497 +    391 +#markdown-preview .language-json .token.operator {
    1498 +    392 +  color: var(--syntax-punctuation, #64748b);
    1499 +    393 +}
    1500 +    394 +
    1501 +    395 +#markdown-preview .language-json .token.null.keyword {
    1502 +    396 +  color: var(--syntax-number, #fb923c);
    1503 +    397 +}
    1504 +    398 +
    1505 +    399 +/* ==================== VISUAL ENHANCEMENTS ==================== */
    1506 +    400 +
    1507 +    401 +/* Bold/italic styling */
    1508 +    402 +#markdown-preview .token.bold {
    1509 +    403 +  font-weight: bold;
    1510 +    404 +}
    1511 +    405 +
    1512 +    406 +#markdown-preview .token.italic {
    1513 +    407 +  font-style: italic;
    1514 +    408 +}
    1515 +    409 +
    1516 +    410 +/* Namespace opacity */
    1517 +354 411  #markdown-preview .token.namespace {
    1518 +355     -  color: var(--syntax-namespace, var(--syntax-keyword)) !important;
    1519 +356     -  font-weight: 500;
    1520 +357     -}
    1521 +358     -
    1522 +359     -#markdown-preview .token.builtin {
    1523 +360     -  color: var(--syntax-builtin, var(--syntax-function)) !important;
    1524 +361     -  font-weight: 500;
    1525 +    412 +  opacity: 0.8;
    1526 +362 413  }
    1527 +363 414  
    1528 +364 415  #markdown-preview blockquote {
    1529 +365 416  
    1530 +
    1531 +```
    1532 +
    1533 +
    1534 +### üìÑ `themes/default-dark.css`
    1535 +
    1536 +**Type:** Stylesheet üé®
    1537 +
    1538 +```diff
    1539 +@@ -26,24 +26,184 @@
    1540 + 26  26    --code-block-bg: #0d1117;
    1541 + 27  27    --code-border: #30363d;
    1542 + 28  28  
    1543 + 29     -  /* Syntax Highlighting */
    1544 + 30     -  --syntax-keyword: #ff7b72;
    1545 + 31     -  --syntax-string: #a5e844;
    1546 + 32     -  --syntax-number: #79c0ff;
    1547 + 33     -  --syntax-function: #d2a8ff;
    1548 + 34     -  --syntax-comment: #8b949e;
    1549 + 35     -  --syntax-operator: #ff7b72;
    1550 + 36     -  --syntax-punctuation: #7d8590;
    1551 +     29 +  /* Syntax Highlighting - Production-Grade Token Colors (One Dark Architecture) */
    1552 + 37  30  
    1553 + 38     -  /* Additional Token Types */
    1554 + 39     -  --syntax-variable: #79c0ff; /* Variables - blue (distinct from text #e6edf3) */
    1555 + 40     -  --syntax-property: #d2a8ff; /* Properties - purple */
    1556 + 41     -  --syntax-namespace: #ff7b72; /* Namespaces - red */
    1557 + 42     -  --syntax-builtin: #d2a8ff; /* Builtins - purple */
    1558 +     31 +  /* Core hue-1: Cyan - URLs */
    1559 +     32 +  --syntax-url: #56d4dd; /* Cyan for URLs */
    1560 +     33 +
    1561 +     34 +  /* Core hue-2: Blue - Functions, variables */
    1562 +     35 +  --syntax-function: #d2a8ff; /* Purple for functions */
    1563 +     36 +  --syntax-variable: #79c0ff; /* Bright blue for variables */
    1564 +     37 +
    1565 +     38 +  /* Core hue-3: Red - Keywords */
    1566 +     39 +  --syntax-keyword: #ff7b72; /* Coral red for keywords (final, sealed, class) */
    1567 +     40 +
    1568 +     41 +  /* Core hue-4: Green - Strings, builtins */
    1569 +     42 +  --syntax-string: #a5d6ff; /* Light blue-green for strings */
    1570 +     43 +  --syntax-builtin: #7ee787; /* Vibrant green for builtins (String, List) */
    1571 +     44 +  --syntax-char: #a5d6ff; /* Same as strings */
    1572 +     45 +  --syntax-regex: #a5d6ff; /* Same as strings */
    1573 +     46 +  --syntax-inserted: #7ee787; /* For diff */
    1574 +     47 +
    1575 +     48 +  /* Core hue-5: Orange - Properties, tags */
    1576 +     49 +  --syntax-property: #ffa657; /* Orange for properties */
    1577 +     50 +  --syntax-tag: #ff7b72; /* Coral for tags */
    1578 +     51 +  --syntax-deleted: #ff7b72; /* For diff */
    1579 +     52 +  --syntax-important: #ffa657; /* For !important */
    1580 +     53 +
    1581 +     54 +  /* Core hue-6: Yellow - Class names, constants, numbers */
    1582 +     55 +  --syntax-class-name: #ffa657; /* Orange for class names (Rectangle, Shape) */
    1583 +     56 +  --syntax-number: #79c0ff; /* Blue for numbers */
    1584 +     57 +  --syntax-constant: #79c0ff; /* Blue for constants */
    1585 +     58 +  --syntax-boolean: #79c0ff; /* Same as numbers */
    1586 +     59 +  --syntax-atrule: #d2a8ff; /* Purple for CSS @ rules */
    1587 +     60 +
    1588 +     61 +  /* Neutral colors */
    1589 +     62 +  --syntax-comment: #8b949e; /* Gray for comments */
    1590 +     63 +  --syntax-punctuation: #7d8590; /* Muted gray for punctuation */
    1591 +     64 +  --syntax-operator: #ff7b72; /* Coral for operators */
    1592 +     65 +
    1593 +     66 +  /* Markup specific */
    1594 +     67 +  --syntax-attr-name: #ffa657; /* Orange like class-name */
    1595 +     68 +  --syntax-attr-value: #a5d6ff; /* Light blue like strings */
    1596 +     69 +  --syntax-namespace: #d2a8ff; /* Purple */
    1597 +     70 +  --syntax-entity: #7d8590; /* Neutral */
    1598 +     71 +  --syntax-selector: #ffa657; /* Orange like properties */
    1599 + 43  72  
    1600 + 44  73    --blockquote-border: #bc8cff;
    1601 + 45  74    --blockquote-bg: #161b22;
    1602 + 46  75  
    1603 + 47  76    --table-header-bg: #21262d;
    1604 + 48  77    --table-border: #30363d;
    1605 +     78 +
    1606 +     79 +  /* === MERMAID COMPREHENSIVE CONFIGURATION === */
    1607 +     80 +
    1608 +     81 +  /* Core Global */
    1609 +     82 +  --mermaid-background: #0d1117;
    1610 +     83 +  --mermaid-text-color: #e6edf3;
    1611 +     84 +  --mermaid-line-color: #58a6ff;
    1612 +     85 +  --mermaid-main-bkg: #1c2128;
    1613 +     86 +
    1614 +     87 +  /* Primary Set - Main nodes/boxes */
    1615 +     88 +  --mermaid-primary-color: #1c2128;
    1616 +     89 +  --mermaid-primary-text-color: #e6edf3;
    1617 +     90 +  --mermaid-primary-border-color: #58a6ff;
    1618 +     91 +
    1619 +     92 +  /* Secondary Set - Clusters/subgraphs */
    1620 +     93 +  --mermaid-secondary-color: #161b22;
    1621 +     94 +  --mermaid-secondary-text-color: #e6edf3;
    1622 +     95 +  --mermaid-secondary-border-color: #bc8cff;
    1623 +     96 +
    1624 +     97 +  /* Tertiary Set - Edge labels */
    1625 +     98 +  --mermaid-tertiary-color: #0d1117;
    1626 +     99 +  --mermaid-tertiary-text-color: #e6edf3;
    1627 +    100 +  --mermaid-tertiary-border-color: #ff7b72;
    1628 +    101 +
    1629 +    102 +  /* Flowchart */
    1630 +    103 +  --mermaid-node-border: #58a6ff;
    1631 +    104 +  --mermaid-cluster-bkg: #161b22;
    1632 +    105 +  --mermaid-cluster-border: #bc8cff;
    1633 +    106 +  --mermaid-default-link-color: #58a6ff;
    1634 +    107 +  --mermaid-title-color: #e6edf3;
    1635 +    108 +  --mermaid-edge-label-background: #0d1117;
    1636 +    109 +  --mermaid-node-text-color: #e6edf3;
    1637 +    110 +
    1638 +    111 +  /* Sequence Diagram */
    1639 +    112 +  --mermaid-actor-bkg: #1c2128;
    1640 +    113 +  --mermaid-actor-border: #58a6ff;
    1641 +    114 +  --mermaid-actor-text-color: #e6edf3;
    1642 +    115 +  --mermaid-actor-line-color: #58a6ff;
    1643 +    116 +  --mermaid-signal-color: #bc8cff;
    1644 +    117 +  --mermaid-signal-text-color: #e6edf3;
    1645 +    118 +  --mermaid-label-box-bkg-color: #1c2128;
    1646 +    119 +  --mermaid-label-box-border-color: #58a6ff;
    1647 +    120 +  --mermaid-label-text-color: #e6edf3;
    1648 +    121 +  --mermaid-loop-text-color: #e6edf3;
    1649 +    122 +  --mermaid-activation-border-color: #bc8cff;
    1650 +    123 +  --mermaid-activation-bkg-color: #161b22;
    1651 +    124 +  --mermaid-sequence-number-color: #e6edf3;
    1652 +    125 +
    1653 +    126 +  /* Pie Chart - 12 distinct slice colors + text */
    1654 +    127 +  --mermaid-pie1: #58a6ff;
    1655 +    128 +  --mermaid-pie2: #bc8cff;
    1656 +    129 +  --mermaid-pie3: #ff7b72;
    1657 +    130 +  --mermaid-pie4: #3fb950;
    1658 +    131 +  --mermaid-pie5: #ffa657;
    1659 +    132 +  --mermaid-pie6: #d2a8ff;
    1660 +    133 +  --mermaid-pie7: #56d4dd;
    1661 +    134 +  --mermaid-pie8: #7ee787;
    1662 +    135 +  --mermaid-pie9: #a5d6ff;
    1663 +    136 +  --mermaid-pie10: #79c0ff;
    1664 +    137 +  --mermaid-pie11: #d2a8ff;
    1665 +    138 +  --mermaid-pie12: #ffa657;
    1666 +    139 +  --mermaid-pie-title-text-color: #e6edf3;
    1667 +    140 +  --mermaid-pie-section-text-color: #0d1117; /* Dark on vibrant slices */
    1668 +    141 +  --mermaid-pie-legend-text-color: #e6edf3;
    1669 +    142 +  --mermaid-pie-stroke-color: #58a6ff;
    1670 +    143 +  --mermaid-pie-outer-stroke-color: #58a6ff;
    1671 +    144 +
    1672 +    145 +  /* State Diagram */
    1673 +    146 +  --mermaid-label-color: #e6edf3;
    1674 +    147 +  --mermaid-alt-background: #161b22;
    1675 +    148 +
    1676 +    149 +  /* Class Diagram */
    1677 +    150 +  --mermaid-class-text: #e6edf3;
    1678 +    151 +
    1679 +    152 +  /* User Journey - 8 distinct colors */
    1680 +    153 +  --mermaid-fill-type0: #58a6ff;
    1681 +    154 +  --mermaid-fill-type1: #bc8cff;
    1682 +    155 +  --mermaid-fill-type2: #ff7b72;
    1683 +    156 +  --mermaid-fill-type3: #3fb950;
    1684 +    157 +  --mermaid-fill-type4: #ffa657;
    1685 +    158 +  --mermaid-fill-type5: #d2a8ff;
    1686 +    159 +  --mermaid-fill-type6: #56d4dd;
    1687 +    160 +  --mermaid-fill-type7: #7ee787;
    1688 +    161 +
    1689 +    162 +  /* Gantt Chart */
    1690 +    163 +  --mermaid-section-bkg-color: #1c2128;
    1691 +    164 +  --mermaid-alt-section-bkg-color: #161b22;
    1692 +    165 +  --mermaid-section-bkg-color2: #1c2128;
    1693 +    166 +  --mermaid-task-text-color: #e6edf3;
    1694 +    167 +  --mermaid-task-text-light-color: #e6edf3;
    1695 +    168 +  --mermaid-task-text-outside-color: #e6edf3;
    1696 +    169 +  --mermaid-task-text-clickable-color: #58a6ff;
    1697 +    170 +  --mermaid-active-task-bkg-color: #58a6ff;
    1698 +    171 +  --mermaid-active-task-border-color: #58a6ff;
    1699 +    172 +  --mermaid-done-task-bkg-color: #3fb950;
    1700 +    173 +  --mermaid-done-task-border-color: #3fb950;
    1701 +    174 +  --mermaid-crit-border-color: #ff7b72;
    1702 +    175 +  --mermaid-crit-bkg-color: #ff7b72;
    1703 +    176 +  --mermaid-today-line-color: #ff7b72;
    1704 +    177 +  --mermaid-grid-color: #30363d;
    1705 +    178 +  --mermaid-section-text-color: #e6edf3;
    1706 +    179 +  --mermaid-task-border-color: #58a6ff;
    1707 +    180 +
    1708 +    181 +  /* ER Diagram */
    1709 +    182 +  --mermaid-attribute-background-color-odd: #161b22;
    1710 +    183 +  --mermaid-attribute-background-color-even: #0d1117;
    1711 +    184 +  --mermaid-relationship-label-background: #0d1117;
    1712 +    185 +  --mermaid-relationship-label-color: #e6edf3;
    1713 +    186 +  --mermaid-entity-background: #1c2128;
    1714 +    187 +  --mermaid-entity-border-color: #58a6ff;
    1715 +    188 +
    1716 +    189 +  /* Git Graph */
    1717 +    190 +  --mermaid-git0: #58a6ff;
    1718 +    191 +  --mermaid-git1: #bc8cff;
    1719 +    192 +  --mermaid-git2: #ff7b72;
    1720 +    193 +  --mermaid-git3: #3fb950;
    1721 +    194 +  --mermaid-git4: #ffa657;
    1722 +    195 +  --mermaid-git5: #d2a8ff;
    1723 +    196 +  --mermaid-git6: #56d4dd;
    1724 +    197 +  --mermaid-git7: #7ee787;
    1725 +    198 +  --mermaid-git-inv0: #0d1117;
    1726 +    199 +  --mermaid-git-branch-label0: #e6edf3;
    1727 +    200 +  --mermaid-git-branch-label1: #e6edf3;
    1728 +    201 +  --mermaid-git-branch-label2: #e6edf3;
    1729 +    202 +  --mermaid-git-branch-label3: #e6edf3;
    1730 +    203 +  --mermaid-git-branch-label4: #e6edf3;
    1731 +    204 +  --mermaid-commit-label-color: #e6edf3;
    1732 +    205 +  --mermaid-commit-label-background: #0d1117;
    1733 +    206 +  --mermaid-tag-label-color: #e6edf3;
    1734 +    207 +  --mermaid-tag-label-background: #1c2128;
    1735 +    208 +  --mermaid-tag-label-border: #58a6ff;
    1736 + 49 209  }
    1737 + 50 210  
    1738 +
    1739 +```
    1740 +
    1741 +
    1742 +### üìÑ `themes/default-light.css`
    1743 +
    1744 +**Type:** Stylesheet üé®
    1745 +
    1746 +```diff
    1747 +@@ -26,24 +26,184 @@
    1748 + 26  26    --code-block-bg: #f6f8fa;
    1749 + 27  27    --code-border: #d0d7de;
    1750 + 28  28  
    1751 + 29     -  /* Syntax Highlighting - Comprehensive Token Colors */
    1752 + 30     -  --syntax-keyword: #cf222e;
    1753 + 31     -  --syntax-string: #1a7f37;
    1754 + 32     -  --syntax-number: #0550ae;
    1755 + 33     -  --syntax-function: #8250df;
    1756 + 34     -  --syntax-comment: #636c76;
    1757 + 35     -  --syntax-operator: #cf222e;
    1758 + 36     -  --syntax-punctuation: #636c76;
    1759 +     29 +  /* Syntax Highlighting - Production-Grade Token Colors (One Dark Architecture) */
    1760 + 37  30  
    1761 + 38     -  /* Additional Token Types for Full Customization */
    1762 + 39     -  --syntax-variable: #0550ae; /* Variables, parameters */
    1763 + 40     -  --syntax-property: #1a7f37; /* Properties, attributes */
    1764 + 41     -  --syntax-namespace: #cf222e; /* Namespaces */
    1765 + 42     -  --syntax-builtin: #8250df; /* Built-in functions */
    1766 +     31 +  /* Core hue-1: Cyan - URLs */
    1767 +     32 +  --syntax-url: #0969da; /* GitHub blue for URLs */
    1768 +     33 +
    1769 +     34 +  /* Core hue-2: Blue - Functions, variables */
    1770 +     35 +  --syntax-function: #8250df; /* Purple-blue for functions */
    1771 +     36 +  --syntax-variable: #0550ae; /* Deep blue for variables */
    1772 +     37 +
    1773 +     38 +  /* Core hue-3: Red - Keywords */
    1774 +     39 +  --syntax-keyword: #cf222e; /* GitHub red for keywords (final, sealed, class) */
    1775 +     40 +
    1776 +     41 +  /* Core hue-4: Green - Strings, builtins */
    1777 +     42 +  --syntax-string: #1a7f37; /* GitHub green for strings */
    1778 +     43 +  --syntax-builtin: #116329; /* Darker green for builtins (String, List) */
    1779 +     44 +  --syntax-char: #1a7f37; /* Same as strings */
    1780 +     45 +  --syntax-regex: #1a7f37; /* Same as strings */
    1781 +     46 +  --syntax-inserted: #1a7f37; /* For diff */
    1782 +     47 +
    1783 +     48 +  /* Core hue-5: Orange/Brown - Properties, tags */
    1784 +     49 +  --syntax-property: #bc4c00; /* Orange-brown for properties */
    1785 +     50 +  --syntax-tag: #cf222e; /* Red for tags */
    1786 +     51 +  --syntax-deleted: #cf222e; /* For diff */
    1787 +     52 +  --syntax-important: #bc4c00; /* For !important */
    1788 +     53 +
    1789 +     54 +  /* Core hue-6: Blue - Class names, constants, numbers */
    1790 +     55 +  --syntax-class-name: #0969da; /* Bright blue for class names (Rectangle, Shape) */
    1791 +     56 +  --syntax-number: #0550ae; /* Deep blue for numbers */
    1792 +     57 +  --syntax-constant: #0969da; /* Bright blue for constants */
    1793 +     58 +  --syntax-boolean: #0550ae; /* Same as numbers */
    1794 +     59 +  --syntax-atrule: #8250df; /* Purple for CSS @ rules */
    1795 +     60 +
    1796 +     61 +  /* Neutral colors */
    1797 +     62 +  --syntax-comment: #636c76; /* GitHub gray for comments */
    1798 +     63 +  --syntax-punctuation: #636c76; /* Gray for punctuation */
    1799 +     64 +  --syntax-operator: #cf222e; /* Red for operators */
    1800 +     65 +
    1801 +     66 +  /* Markup specific */
    1802 +     67 +  --syntax-attr-name: #0969da; /* Blue like class-name */
    1803 +     68 +  --syntax-attr-value: #1a7f37; /* Green like strings */
    1804 +     69 +  --syntax-namespace: #8250df; /* Purple */
    1805 +     70 +  --syntax-entity: #636c76; /* Neutral */
    1806 +     71 +  --syntax-selector: #bc4c00; /* Orange like properties */
    1807 + 43  72  
    1808 + 44  73    --blockquote-border: #0969da;
    1809 + 45  74    --blockquote-bg: #ddf4ff;
    1810 + 46  75  
    1811 + 47  76    --table-header-bg: #f6f8fa;
    1812 + 48  77    --table-border: #d0d7de;
    1813 +     78 +
    1814 +     79 +  /* === MERMAID COMPREHENSIVE CONFIGURATION === */
    1815 +     80 +
    1816 +     81 +  /* Core Global */
    1817 +     82 +  --mermaid-background: #ffffff;
    1818 +     83 +  --mermaid-text-color: #1f2328;
    1819 +     84 +  --mermaid-line-color: #0969da;
    1820 +     85 +  --mermaid-main-bkg: #eaeef2;
    1821 +     86 +
    1822 +     87 +  /* Primary Set */
    1823 +     88 +  --mermaid-primary-color: #eaeef2;
    1824 +     89 +  --mermaid-primary-text-color: #1f2328;
    1825 +     90 +  --mermaid-primary-border-color: #0969da;
    1826 +     91 +
    1827 +     92 +  /* Secondary Set */
    1828 +     93 +  --mermaid-secondary-color: #f6f8fa;
    1829 +     94 +  --mermaid-secondary-text-color: #1f2328;
    1830 +     95 +  --mermaid-secondary-border-color: #8250df;
    1831 +     96 +
    1832 +     97 +  /* Tertiary Set */
    1833 +     98 +  --mermaid-tertiary-color: #ffffff;
    1834 +     99 +  --mermaid-tertiary-text-color: #1f2328;
    1835 +    100 +  --mermaid-tertiary-border-color: #cf222e;
    1836 +    101 +
    1837 +    102 +  /* Flowchart */
    1838 +    103 +  --mermaid-node-border: #0969da;
    1839 +    104 +  --mermaid-cluster-bkg: #f6f8fa;
    1840 +    105 +  --mermaid-cluster-border: #8250df;
    1841 +    106 +  --mermaid-default-link-color: #0969da;
    1842 +    107 +  --mermaid-title-color: #1f2328;
    1843 +    108 +  --mermaid-edge-label-background: #ffffff;
    1844 +    109 +  --mermaid-node-text-color: #1f2328;
    1845 +    110 +
    1846 +    111 +  /* Sequence Diagram */
    1847 +    112 +  --mermaid-actor-bkg: #eaeef2;
    1848 +    113 +  --mermaid-actor-border: #0969da;
    1849 +    114 +  --mermaid-actor-text-color: #1f2328;
    1850 +    115 +  --mermaid-actor-line-color: #0969da;
    1851 +    116 +  --mermaid-signal-color: #8250df;
    1852 +    117 +  --mermaid-signal-text-color: #1f2328;
    1853 +    118 +  --mermaid-label-box-bkg-color: #eaeef2;
    1854 +    119 +  --mermaid-label-box-border-color: #0969da;
    1855 +    120 +  --mermaid-label-text-color: #1f2328;
    1856 +    121 +  --mermaid-loop-text-color: #1f2328;
    1857 +    122 +  --mermaid-activation-border-color: #8250df;
    1858 +    123 +  --mermaid-activation-bkg-color: #f6f8fa;
    1859 +    124 +  --mermaid-sequence-number-color: #1f2328;
    1860 +    125 +
    1861 +    126 +  /* Pie Chart */
    1862 +    127 +  --mermaid-pie1: #0969da;
    1863 +    128 +  --mermaid-pie2: #8250df;
    1864 +    129 +  --mermaid-pie3: #cf222e;
    1865 +    130 +  --mermaid-pie4: #1a7f37;
    1866 +    131 +  --mermaid-pie5: #bc4c00;
    1867 +    132 +  --mermaid-pie6: #0550ae;
    1868 +    133 +  --mermaid-pie7: #116329;
    1869 +    134 +  --mermaid-pie8: #0969da;
    1870 +    135 +  --mermaid-pie9: #8250df;
    1871 +    136 +  --mermaid-pie10: #cf222e;
    1872 +    137 +  --mermaid-pie11: #1a7f37;
    1873 +    138 +  --mermaid-pie12: #bc4c00;
    1874 +    139 +  --mermaid-pie-title-text-color: #1f2328;
    1875 +    140 +  --mermaid-pie-section-text-color: #ffffff; /* White on vibrant slices */
    1876 +    141 +  --mermaid-pie-legend-text-color: #1f2328;
    1877 +    142 +  --mermaid-pie-stroke-color: #0969da;
    1878 +    143 +  --mermaid-pie-outer-stroke-color: #0969da;
    1879 +    144 +
    1880 +    145 +  /* State Diagram */
    1881 +    146 +  --mermaid-label-color: #1f2328;
    1882 +    147 +  --mermaid-alt-background: #f6f8fa;
    1883 +    148 +
    1884 +    149 +  /* Class Diagram */
    1885 +    150 +  --mermaid-class-text: #1f2328;
    1886 +    151 +
    1887 +    152 +  /* User Journey */
    1888 +    153 +  --mermaid-fill-type0: #0969da;
    1889 +    154 +  --mermaid-fill-type1: #8250df;
    1890 +    155 +  --mermaid-fill-type2: #cf222e;
    1891 +    156 +  --mermaid-fill-type3: #1a7f37;
    1892 +    157 +  --mermaid-fill-type4: #bc4c00;
    1893 +    158 +  --mermaid-fill-type5: #0550ae;
    1894 +    159 +  --mermaid-fill-type6: #116329;
    1895 +    160 +  --mermaid-fill-type7: #0969da;
    1896 +    161 +
    1897 +    162 +  /* Gantt Chart */
    1898 +    163 +  --mermaid-section-bkg-color: #eaeef2;
    1899 +    164 +  --mermaid-alt-section-bkg-color: #f6f8fa;
    1900 +    165 +  --mermaid-section-bkg-color2: #eaeef2;
    1901 +    166 +  --mermaid-task-text-color: #1f2328;
    1902 +    167 +  --mermaid-task-text-light-color: #1f2328;
    1903 +    168 +  --mermaid-task-text-outside-color: #1f2328;
    1904 +    169 +  --mermaid-task-text-clickable-color: #0969da;
    1905 +    170 +  --mermaid-active-task-bkg-color: #0969da;
    1906 +    171 +  --mermaid-active-task-border-color: #0969da;
    1907 +    172 +  --mermaid-done-task-bkg-color: #1a7f37;
    1908 +    173 +  --mermaid-done-task-border-color: #1a7f37;
    1909 +    174 +  --mermaid-crit-border-color: #cf222e;
    1910 +    175 +  --mermaid-crit-bkg-color: #cf222e;
    1911 +    176 +  --mermaid-today-line-color: #cf222e;
    1912 +    177 +  --mermaid-grid-color: #d0d7de;
    1913 +    178 +  --mermaid-section-text-color: #1f2328;
    1914 +    179 +  --mermaid-task-border-color: #0969da;
    1915 +    180 +
    1916 +    181 +  /* ER Diagram */
    1917 +    182 +  --mermaid-attribute-background-color-odd: #f6f8fa;
    1918 +    183 +  --mermaid-attribute-background-color-even: #ffffff;
    1919 +    184 +  --mermaid-relationship-label-background: #ffffff;
    1920 +    185 +  --mermaid-relationship-label-color: #1f2328;
    1921 +    186 +  --mermaid-entity-background: #eaeef2;
    1922 +    187 +  --mermaid-entity-border-color: #0969da;
    1923 +    188 +
    1924 +    189 +  /* Git Graph */
    1925 +    190 +  --mermaid-git0: #0969da;
    1926 +    191 +  --mermaid-git1: #8250df;
    1927 +    192 +  --mermaid-git2: #cf222e;
    1928 +    193 +  --mermaid-git3: #1a7f37;
    1929 +    194 +  --mermaid-git4: #bc4c00;
    1930 +    195 +  --mermaid-git5: #0550ae;
    1931 +    196 +  --mermaid-git6: #116329;
    1932 +    197 +  --mermaid-git7: #0969da;
    1933 +    198 +  --mermaid-git-inv0: #ffffff;
    1934 +    199 +  --mermaid-git-branch-label0: #1f2328;
    1935 +    200 +  --mermaid-git-branch-label1: #1f2328;
    1936 +    201 +  --mermaid-git-branch-label2: #1f2328;
    1937 +    202 +  --mermaid-git-branch-label3: #1f2328;
    1938 +    203 +  --mermaid-git-branch-label4: #1f2328;
    1939 +    204 +  --mermaid-commit-label-color: #1f2328;
    1940 +    205 +  --mermaid-commit-label-background: #ffffff;
    1941 +    206 +  --mermaid-tag-label-color: #1f2328;
    1942 +    207 +  --mermaid-tag-label-background: #eaeef2;
    1943 +    208 +  --mermaid-tag-label-border: #0969da;
    1944 + 49 209  }
    1945 + 50 210  
    1946 +
    1947 +```
    1948 +
    1949 +
    1950 +### üìÑ `themes/forest-dark.css`
    1951 +
    1952 +**Type:** Stylesheet üé®
    1953 +
    1954 +```diff
    1955 +@@ -1,11 +1,11 @@
    1956 +  1     -/* Forest Dark Theme */
    1957 +      1 +/* Forest Dark Theme - Deep Jungle Aesthetic */
    1958 +  2   2  :root {
    1959 +  3     -  --bg-primary: #0f1c0a;
    1960 +  4     -  --bg-secondary: #1a2817;
    1961 +  5     -  --bg-tertiary: #2d4a2b;
    1962 +  6     -  --text-primary: #d9f99d;
    1963 +  7     -  --text-secondary: #a3e635;
    1964 +  8     -  --border-color: #3f6212;
    1965 +      3 +  --bg-primary: #0a1408; /* Deep forest green with blue undertones */
    1966 +      4 +  --bg-secondary: #132118; /* Darker moss green */
    1967 +      5 +  --bg-tertiary: #1e3a29; /* Rich forest green */
    1968 +      6 +  --text-primary: #d9f99d; /* Bright lime (firefly glow) */
    1969 +      7 +  --text-secondary: #a3e635; /* Vibrant lime */
    1970 +      8 +  --border-color: #2d5a3d; /* Forest green border */
    1971 +  9   9  
    1972 + 10  10    --h1-color: #84cc16;
    1973 + 11  11    --h2-color: #a3e635;
    1974 +@@ -17,31 +17,144 @@
    1975 + 17  17    --link-color: #84cc16;
    1976 + 18  18    --link-hover: #a3e635;
    1977 + 19  19  
    1978 + 20     -  /* Code Colors */
    1979 + 21     -  --code-bg: #1a2817;
    1980 +     20 +  /* Code Colors - Organic forest glow */
    1981 +     21 +  --code-bg: rgba(132, 204, 22, 0.12); /* Lime-tinted background */
    1982 + 22  22    --code-text: #a3e635;
    1983 + 23     -  --code-block-bg: #0f1c0a;
    1984 + 24     -  --code-border: #3f6212;
    1985 +     23 +  --code-block-bg: #0d1a11; /* Deep forest with blue-green tint */
    1986 +     24 +  --code-border: rgba(163, 230, 53, 0.3); /* Lime glow border */
    1987 + 25  25  
    1988 + 26     -  /* Syntax Highlighting - Comprehensive Token Colors */
    1989 + 27     -  --syntax-keyword: #84cc16;
    1990 + 28     -  --syntax-string: #a3e635;
    1991 + 29     -  --syntax-number: #bef264;
    1992 + 30     -  --syntax-function: #4ade80;
    1993 + 31     -  --syntax-comment: #737373;
    1994 + 32     -  --syntax-operator: #22c55e;
    1995 + 33     -  --syntax-punctuation: #a3a3a3;
    1996 +     26 +  /* Syntax Highlighting - Production-Grade Token Colors (One Dark Architecture) */
    1997 + 34  27  
    1998 + 35     -  /* Additional Token Types */
    1999 + 36     -  --syntax-variable: #bef264; /* Variables - bright lime (distinct from text #d9f99d) */
    2000 + 37     -  --syntax-property: #4ade80; /* Properties - green */
    2001 + 38     -  --syntax-namespace: #84cc16; /* Namespaces - lime */
    2002 + 39     -  --syntax-builtin: #22c55e; /* Builtins - green */
    2003 +     28 +  /* Core hue-1: Teal - URLs */
    2004 +     29 +  --syntax-url: #5eead4; /* Bright teal for URLs */
    2005 +     30 +
    2006 +     31 +  /* Core hue-2: Green - Functions, variables */
    2007 +     32 +  --syntax-function: #4ade80; /* Bright green for functions */
    2008 +     33 +  --syntax-variable: #22c55e; /* Medium green for variables */
    2009 +     34 +
    2010 +     35 +  /* Core hue-3: Yellow - Keywords */
    2011 +     36 +  --syntax-keyword: #fbbf24; /* Golden yellow for keywords (final, sealed, class) */
    2012 +     37 +
    2013 +     38 +  /* Core hue-4: Lime - Strings, builtins */
    2014 +     39 +  --syntax-string: #a3e635; /* Bright lime for strings */
    2015 +     40 +  --syntax-builtin: #84cc16; /* Lime for builtins (String, List) */
    2016 +     41 +  --syntax-char: #a3e635; /* Same as strings */
    2017 +     42 +  --syntax-regex: #a3e635; /* Same as strings */
    2018 +     43 +  --syntax-inserted: #84cc16; /* For diff */
    2019 +     44 +
    2020 +     45 +  /* Core hue-5: Orange/Amber - Properties, tags */
    2021 +     46 +  --syntax-property: #fb923c; /* Orange for properties */
    2022 +     47 +  --syntax-tag: #f97316; /* Burnt orange for tags */
    2023 +     48 +  --syntax-deleted: #f87171; /* Coral for diff */
    2024 +     49 +  --syntax-important: #fb923c; /* Orange for !important */
    2025 +     50 +
    2026 +     51 +  /* Core hue-6: Yellow-green - Class names, constants, numbers */
    2027 +     52 +  --syntax-class-name: #bef264; /* Bright yellow-green for class names (Rectangle, Shape) */
    2028 +     53 +  --syntax-number: #fde047; /* Bright yellow for numbers */
    2029 +     54 +  --syntax-constant: #84cc16; /* Lime for constants */
    2030 +     55 +  --syntax-boolean: #fde047; /* Same as numbers */
    2031 +     56 +  --syntax-atrule: #a3e635; /* Lime for CSS @ rules */
    2032 +     57 +
    2033 +     58 +  /* Neutral colors */
    2034 +     59 +  --syntax-comment: #737373; /* Gray for comments */
    2035 +     60 +  --syntax-punctuation: #a3a3a3; /* Light gray for punctuation */
    2036 +     61 +  --syntax-operator: #22c55e; /* Green for operators */
    2037 +     62 +
    2038 +     63 +  /* Markup specific */
    2039 +     64 +  --syntax-attr-name: #bef264; /* Yellow-green like class-name */
    2040 +     65 +  --syntax-attr-value: #a3e635; /* Lime like strings */
    2041 +     66 +  --syntax-namespace: #fbbf24; /* Yellow like keywords */
    2042 +     67 +  --syntax-entity: #a3a3a3; /* Neutral */
    2043 +     68 +  --syntax-selector: #fb923c; /* Orange like properties */
    2044 + 40  69  
    2045 + 41  70    --blockquote-border: #84cc16;
    2046 + 42     -  --blockquote-bg: #1a2817;
    2047 +     71 +  --blockquote-bg: rgba(132, 204, 22, 0.08); /* Lime-tinted blockquote */
    2048 + 43  72    --bold-color: #fbbf24;
    2049 + 44  73    --italic-color: #84cc16;
    2050 + 45     -  --table-header-bg: #2d4a2b;
    2051 + 46     -  --table-border: #3f6212;
    2052 +     74 +  --table-header-bg: rgba(74, 222, 128, 0.12); /* Green-tinted table header */
    2053 +     75 +  --table-border: rgba(45, 90, 61, 0.4); /* Forest-tinted border */
    2054 +     76 +
    2055 +     77 +  /* === MERMAID COMPREHENSIVE CONFIGURATION === */
    2056 +     78 +  /* Complete control over ALL diagram elements */
    2057 +     79 +
    2058 +     80 +  /* Core Global */
    2059 +     81 +  --mermaid-background: #0a1408;
    2060 +     82 +  --mermaid-text-color: #d9f99d;
    2061 +     83 +  --mermaid-line-color: #a3e635;
    2062 +     84 +  --mermaid-main-bkg: #2d5a3d;
    2063 +     85 +
    2064 +     86 +  /* Primary Set - Main nodes/boxes */
    2065 +     87 +  --mermaid-primary-color: #2d5a3d;
    2066 +     88 +  --mermaid-primary-text-color: #d9f99d;
    2067 +     89 +  --mermaid-primary-border-color: #84cc16;
    2068 +     90 +
    2069 +     91 +  /* Secondary Set - Clusters/subgraphs */
    2070 +     92 +  --mermaid-secondary-color: #1e3a29;
    2071 +     93 +  --mermaid-secondary-text-color: #d9f99d;
    2072 +     94 +  --mermaid-secondary-border-color: #a3e635;
    2073 +     95 +
    2074 +     96 +  /* Tertiary Set - Edge labels */
    2075 +     97 +  --mermaid-tertiary-color: #0a1408;
    2076 +     98 +  --mermaid-tertiary-text-color: #d9f99d;
    2077 +     99 +  --mermaid-tertiary-border-color: #bef264;
    2078 +    100 +
    2079 +    101 +  /* Flowchart */
    2080 +    102 +  --mermaid-node-border: #84cc16;
    2081 +    103 +  --mermaid-cluster-bkg: #1e3a29;
    2082 +    104 +  --mermaid-cluster-border: #a3e635;
    2083 +    105 +  --mermaid-default-link-color: #a3e635;
    2084 +    106 +  --mermaid-title-color: #d9f99d;
    2085 +    107 +  --mermaid-edge-label-background: #0a1408;
    2086 +    108 +  --mermaid-node-text-color: #d9f99d;
    2087 +    109 +
    2088 +    110 +  /* Sequence Diagram */
    2089 +    111 +  --mermaid-actor-bkg: #2d5a3d;
    2090 +    112 +  --mermaid-actor-border: #84cc16;
    2091 +    113 +  --mermaid-actor-text-color: #d9f99d;
    2092 +    114 +  --mermaid-actor-line-color: #84cc16;
    2093 +    115 +  --mermaid-signal-color: #a3e635;
    2094 +    116 +  --mermaid-signal-text-color: #d9f99d;
    2095 +    117 +  --mermaid-label-box-bkg-color: #2d5a3d;
    2096 +    118 +  --mermaid-label-box-border-color: #84cc16;
    2097 +    119 +  --mermaid-label-text-color: #d9f99d;
    2098 +    120 +  --mermaid-loop-text-color: #d9f99d;
    2099 +    121 +  --mermaid-activation-border-color: #a3e635;
    2100 +    122 +  --mermaid-activation-bkg-color: #1e3a29;
    2101 +    123 +  --mermaid-sequence-number-color: #d9f99d;
    2102 +    124 +
    2103 +    125 +  /* Pie Chart - 12 distinct slice colors + text colors */
    2104 +    126 +  --mermaid-pie1: #4ade80;
    2105 +    127 +  --mermaid-pie2: #fbbf24;
    2106 +    128 +  --mermaid-pie3: #fb923c;
    2107 +    129 +  --mermaid-pie4: #5eead4;
    2108 +    130 +  --mermaid-pie5: #a3e635;
    2109 +    131 +  --mermaid-pie6: #22c55e;
    2110 +    132 +  --mermaid-pie7: #84cc16;
    2111 +    133 +  --mermaid-pie8: #fde047;
    2112 +    134 +  --mermaid-pie9: #4ade80;
    2113 +    135 +  --mermaid-pie10: #fbbf24;
    2114 +    136 +  --mermaid-pie11: #fb923c;
    2115 +    137 +  --mermaid-pie12: #5eead4;
    2116 +    138 +  --mermaid-pie-title-text-color: #d9f99d;
    2117 +    139 +  --mermaid-pie-section-text-color: #0a1408; /* Dark on vibrant slices */
    2118 +    140 +  --mermaid-pie-legend-text-color: #d9f99d;
    2119 +    141 +  --mermaid-pie-stroke-color: #84cc16;
    2120 +    142 +  --mermaid-pie-outer-stroke-color: #84cc16;
    2121 +    143 +
    2122 +    144 +  /* State Diagram */
    2123 +    145 +  --mermaid-label-color: #d9f99d;
    2124 +    146 +  --mermaid-alt-background: #1e3a29;
    2125 +    147 +
    2126 +    148 +  /* Class Diagram */
    2127 +    149 +  --mermaid-class-text: #d9f99d;
    2128 +    150 +
    2129 +    151 +  /* User Journey - 8 distinct colors */
    2130 +    152 +  --mermaid-fill-type0: #4ade80;
    2131 +    153 +  --mermaid-fill-type1: #fbbf24;
    2132 +    154 +  --mermaid-fill-type2: #fb923c;
    2133 +    155 +  --mermaid-fill-type3: #5eead4;
    2134 +    156 +  --mermaid-fill-type4: #a3e635;
    2135 +    157 +  --mermaid-fill-type5: #22c55e;
    2136 +    158 +  --mermaid-fill-type6: #84cc16;
    2137 +    159 +  --mermaid-fill-type7: #fde047;
    2138 + 47 160  }
    2139 + 48 161  
    2140 +
    2141 +```
    2142 +
    2143 +
    2144 +### üìÑ `themes/forest-light.css`
    2145 +
    2146 +**Type:** Stylesheet üé®
    2147 +
    2148 +```diff
    2149 +@@ -23,20 +23,49 @@
    2150 + 23  23    --code-block-bg: #ecfccb; /* Light green background */
    2151 + 24  24    --code-border: #bef264;
    2152 + 25  25  
    2153 + 26     -  /* Syntax Highlighting - Comprehensive Token Colors */
    2154 + 27     -  --syntax-keyword: #15803d;
    2155 + 28     -  --syntax-string: #16a34a;
    2156 + 29     -  --syntax-number: #84cc16;
    2157 + 30     -  --syntax-function: #22c55e;
    2158 + 31     -  --syntax-comment: #737373;
    2159 + 32     -  --syntax-operator: #3f6212;
    2160 + 33     -  --syntax-punctuation: #525252;
    2161 +     26 +  /* Syntax Highlighting - Production-Grade Token Colors (One Dark Architecture) */
    2162 + 34  27  
    2163 + 35     -  /* Additional Token Types for Full Customization */
    2164 + 36     -  --syntax-variable: #15803d; /* Variables - forest green */
    2165 + 37     -  --syntax-property: #16a34a; /* Properties - bright green */
    2166 + 38     -  --syntax-namespace: #84cc16; /* Namespaces - lime */
    2167 + 39     -  --syntax-builtin: #22c55e; /* Builtins - bright green */
    2168 +     28 +  /* Core hue-1: Teal - URLs */
    2169 +     29 +  --syntax-url: #14b8a6; /* Teal for URLs */
    2170 +     30 +
    2171 +     31 +  /* Core hue-2: Green - Functions, variables */
    2172 +     32 +  --syntax-function: #22c55e; /* Bright green for functions */
    2173 +     33 +  --syntax-variable: #16a34a; /* Forest green for variables */
    2174 +     34 +
    2175 +     35 +  /* Core hue-3: Emerald - Keywords */
    2176 +     36 +  --syntax-keyword: #059669; /* Deep emerald for keywords (final, sealed, class) */
    2177 +     37 +
    2178 +     38 +  /* Core hue-4: Lime - Strings, builtins */
    2179 +     39 +  --syntax-string: #84cc16; /* Lime green for strings */
    2180 +     40 +  --syntax-builtin: #65a30d; /* Vibrant lime for builtins (String, List) */
    2181 +     41 +  --syntax-char: #84cc16; /* Same as strings */
    2182 +     42 +  --syntax-regex: #84cc16; /* Same as strings */
    2183 +     43 +  --syntax-inserted: #65a30d; /* For diff */
    2184 +     44 +
    2185 +     45 +  /* Core hue-5: Amber/Brown - Properties, tags */
    2186 +     46 +  --syntax-property: #b45309; /* Amber-brown for properties */
    2187 +     47 +  --syntax-tag: #854d0e; /* Brown for tags */
    2188 +     48 +  --syntax-deleted: #dc2626; /* Red for diff */
    2189 +     49 +  --syntax-important: #b45309; /* Amber for !important */
    2190 +     50 +
    2191 +     51 +  /* Core hue-6: Yellow/Green - Class names, constants, numbers */
    2192 +     52 +  --syntax-class-name: #facc15; /* Bright yellow for class names (Rectangle, Shape) */
    2193 +     53 +  --syntax-number: #eab308; /* Yellow for numbers */
    2194 +     54 +  --syntax-constant: #15803d; /* Forest green for constants */
    2195 +     55 +  --syntax-boolean: #eab308; /* Same as numbers */
    2196 +     56 +  --syntax-atrule: #84cc16; /* Lime for CSS @ rules */
    2197 +     57 +
    2198 +     58 +  /* Neutral colors */
    2199 +     59 +  --syntax-comment: #737373; /* Gray for comments */
    2200 +     60 +  --syntax-punctuation: #525252; /* Dark gray for punctuation */
    2201 +     61 +  --syntax-operator: #3f6212; /* Olive for operators */
    2202 +     62 +
    2203 +     63 +  /* Markup specific */
    2204 +     64 +  --syntax-attr-name: #facc15; /* Yellow like class-name */
    2205 +     65 +  --syntax-attr-value: #84cc16; /* Lime like strings */
    2206 +     66 +  --syntax-namespace: #059669; /* Emerald like keywords */
    2207 +     67 +  --syntax-entity: #525252; /* Neutral */
    2208 +     68 +  --syntax-selector: #b45309; /* Amber like properties */
    2209 + 40  69  
    2210 + 41  70    --blockquote-border: #16a34a;
    2211 + 42  71    --blockquote-bg: #ecfccb;
    2212 +@@ -44,4 +73,87 @@
    2213 + 44  73    --italic-color: #15803d;
    2214 + 45  74    --table-header-bg: #d9f99d;
    2215 + 46  75    --table-border: #bef264;
    2216 +     76 +
    2217 +     77 +  /* === MERMAID COMPREHENSIVE CONFIGURATION === */
    2218 +     78 +
    2219 +     79 +  /* Core Global */
    2220 +     80 +  --mermaid-background: #f7fee7;
    2221 +     81 +  --mermaid-text-color: #1a2e05;
    2222 +     82 +  --mermaid-line-color: #16a34a;
    2223 +     83 +  --mermaid-main-bkg: #d9f99d;
    2224 +     84 +
    2225 +     85 +  /* Primary Set */
    2226 +     86 +  --mermaid-primary-color: #d9f99d;
    2227 +     87 +  --mermaid-primary-text-color: #1a2e05;
    2228 +     88 +  --mermaid-primary-border-color: #15803d;
    2229 +     89 +
    2230 +     90 +  /* Secondary Set */
    2231 +     91 +  --mermaid-secondary-color: #ecfccb;
    2232 +     92 +  --mermaid-secondary-text-color: #1a2e05;
    2233 +     93 +  --mermaid-secondary-border-color: #16a34a;
    2234 +     94 +
    2235 +     95 +  /* Tertiary Set */
    2236 +     96 +  --mermaid-tertiary-color: #f7fee7;
    2237 +     97 +  --mermaid-tertiary-text-color: #1a2e05;
    2238 +     98 +  --mermaid-tertiary-border-color: #22c55e;
    2239 +     99 +
    2240 +    100 +  /* Flowchart */
    2241 +    101 +  --mermaid-node-border: #15803d;
    2242 +    102 +  --mermaid-cluster-bkg: #ecfccb;
    2243 +    103 +  --mermaid-cluster-border: #16a34a;
    2244 +    104 +  --mermaid-default-link-color: #16a34a;
    2245 +    105 +  --mermaid-title-color: #1a2e05;
    2246 +    106 +  --mermaid-edge-label-background: #f7fee7;
    2247 +    107 +  --mermaid-node-text-color: #1a2e05;
    2248 +    108 +
    2249 +    109 +  /* Sequence Diagram */
    2250 +    110 +  --mermaid-actor-bkg: #d9f99d;
    2251 +    111 +  --mermaid-actor-border: #15803d;
    2252 +    112 +  --mermaid-actor-text-color: #1a2e05;
    2253 +    113 +  --mermaid-actor-line-color: #15803d;
    2254 +    114 +  --mermaid-signal-color: #16a34a;
    2255 +    115 +  --mermaid-signal-text-color: #1a2e05;
    2256 +    116 +  --mermaid-label-box-bkg-color: #d9f99d;
    2257 +    117 +  --mermaid-label-box-border-color: #15803d;
    2258 +    118 +  --mermaid-label-text-color: #1a2e05;
    2259 +    119 +  --mermaid-loop-text-color: #1a2e05;
    2260 +    120 +  --mermaid-activation-border-color: #16a34a;
    2261 +    121 +  --mermaid-activation-bkg-color: #ecfccb;
    2262 +    122 +  --mermaid-sequence-number-color: #1a2e05;
    2263 +    123 +
    2264 +    124 +  /* Pie Chart */
    2265 +    125 +  --mermaid-pie1: #15803d;
    2266 +    126 +  --mermaid-pie2: #16a34a;
    2267 +    127 +  --mermaid-pie3: #22c55e;
    2268 +    128 +  --mermaid-pie4: #4ade80;
    2269 +    129 +  --mermaid-pie5: #84cc16;
    2270 +    130 +  --mermaid-pie6: #a3e635;
    2271 +    131 +  --mermaid-pie7: #14b8a6;
    2272 +    132 +  --mermaid-pie8: #facc15;
    2273 +    133 +  --mermaid-pie9: #b45309;
    2274 +    134 +  --mermaid-pie10: #15803d;
    2275 +    135 +  --mermaid-pie11: #16a34a;
    2276 +    136 +  --mermaid-pie12: #22c55e;
    2277 +    137 +  --mermaid-pie-title-text-color: #1a2e05;
    2278 +    138 +  --mermaid-pie-section-text-color: #f7fee7; /* Light on vibrant slices */
    2279 +    139 +  --mermaid-pie-legend-text-color: #1a2e05;
    2280 +    140 +  --mermaid-pie-stroke-color: #15803d;
    2281 +    141 +  --mermaid-pie-outer-stroke-color: #15803d;
    2282 +    142 +
    2283 +    143 +  /* State Diagram */
    2284 +    144 +  --mermaid-label-color: #1a2e05;
    2285 +    145 +  --mermaid-alt-background: #ecfccb;
    2286 +    146 +
    2287 +    147 +  /* Class Diagram */
    2288 +    148 +  --mermaid-class-text: #1a2e05;
    2289 +    149 +
    2290 +    150 +  /* User Journey */
    2291 +    151 +  --mermaid-fill-type0: #15803d;
    2292 +    152 +  --mermaid-fill-type1: #16a34a;
    2293 +    153 +  --mermaid-fill-type2: #22c55e;
    2294 +    154 +  --mermaid-fill-type3: #4ade80;
    2295 +    155 +  --mermaid-fill-type4: #84cc16;
    2296 +    156 +  --mermaid-fill-type5: #a3e635;
    2297 +    157 +  --mermaid-fill-type6: #14b8a6;
    2298 +    158 +  --mermaid-fill-type7: #facc15;
    2299 + 47 159  }
    2300 + 48 160  
    2301 +
    2302 +```
    2303 +
    2304 +
    2305 +### üìÑ `themes/neon-dark.css`
    2306 +
    2307 +**Type:** Stylesheet üé®
    2308 +
    2309 +```diff
    2310 +@@ -1,11 +1,11 @@
    2311 +  1     -/* Neon Dark Theme */
    2312 +      1 +/* Neon Dark Theme - Cyberpunk Aesthetic */
    2313 +  2   2  :root {
    2314 +  3     -  --bg-primary: #0d0d0d;
    2315 +  4     -  --bg-secondary: #1a1a1a;
    2316 +  5     -  --bg-tertiary: #262626;
    2317 +  6     -  --text-primary: #ffffff;
    2318 +  7     -  --text-secondary: #a3a3a3;
    2319 +  8     -  --border-color: #404040;
    2320 +      3 +  --bg-primary: #0a0e1a; /* Dark blue-purple, not pure black */
    2321 +      4 +  --bg-secondary: #141827; /* Dark navy with purple tint */
    2322 +      5 +  --bg-tertiary: #1e2539; /* Lighter navy */
    2323 +      6 +  --text-primary: #e0e7ff; /* Slightly blue-tinted white */
    2324 +      7 +  --text-secondary: #a5b4fc; /* Light indigo */
    2325 +      8 +  --border-color: #4c1d95; /* Purple border for neon feel */
    2326 +  9   9  
    2327 + 10  10    --h1-color: #ff006e;
    2328 + 11  11    --h2-color: #8338ec;
    2329 +@@ -17,31 +17,143 @@
    2330 + 17  17    --link-color: #ff006e;
    2331 + 18  18    --link-hover: #ff1a8c;
    2332 + 19  19  
    2333 + 20     -  /* Code Colors */
    2334 + 21     -  --code-bg: #1a1a1a;
    2335 +     20 +  /* Code Colors - Neonic with purple glow */
    2336 +     21 +  --code-bg: rgba(131, 56, 236, 0.15); /* Purple-tinted background */
    2337 + 22  22    --code-text: #00f5d4;
    2338 + 23     -  --code-block-bg: #0d0d0d;
    2339 + 24     -  --code-border: #404040;
    2340 +     23 +  --code-block-bg: #0f1419; /* Dark blue-black with hint of purple */
    2341 +     24 +  --code-border: rgba(255, 0, 110, 0.3); /* Pink glow border */
    2342 + 25  25  
    2343 + 26     -  /* Syntax Highlighting - Comprehensive Token Colors */
    2344 + 27     -  --syntax-keyword: #ff006e;
    2345 + 28     -  --syntax-string: #00f5d4;
    2346 + 29     -  --syntax-number: #ffbe0b;
    2347 + 30     -  --syntax-function: #8338ec;
    2348 + 31     -  --syntax-comment: #737373;
    2349 + 32     -  --syntax-operator: #ff1a8c;
    2350 + 33     -  --syntax-punctuation: #a3a3a3;
    2351 +     26 +  /* Syntax Highlighting - Production-Grade Token Colors (One Dark Architecture) */
    2352 + 34  27  
    2353 + 35     -  /* Additional Token Types */
    2354 + 36     -  --syntax-variable: #3a86ff; /* Variables - bright blue (distinct from text #ffffff) */
    2355 + 37     -  --syntax-property: #8338ec; /* Properties - purple */
    2356 + 38     -  --syntax-namespace: #ff006e; /* Namespaces - neon pink */
    2357 + 39     -  --syntax-builtin: #00f5d4; /* Builtins - cyan */
    2358 +     28 +  /* Core hue-1: Cyan - URLs */
    2359 +     29 +  --syntax-url: #00f5d4; /* Electric cyan for URLs */
    2360 +     30 +
    2361 +     31 +  /* Core hue-2: Purple/Blue - Functions, variables */
    2362 +     32 +  --syntax-function: #8338ec; /* Neon purple for functions */
    2363 +     33 +  --syntax-variable: #3a86ff; /* Electric blue for variables */
    2364 +     34 +
    2365 +     35 +  /* Core hue-3: Pink - Keywords */
    2366 +     36 +  --syntax-keyword: #ff006e; /* Hot pink for keywords (final, sealed, class) */
    2367 +     37 +
    2368 +     38 +  /* Core hue-4: Cyan/Teal - Strings, builtins */
    2369 +     39 +  --syntax-string: #00f5d4; /* Electric cyan for strings */
    2370 +     40 +  --syntax-builtin: #00d4aa; /* Bright teal for builtins (String, List) */
    2371 +     41 +  --syntax-char: #00f5d4; /* Same as strings */
    2372 +     42 +  --syntax-regex: #00f5d4; /* Same as strings */
    2373 +     43 +  --syntax-inserted: #00d4aa; /* For diff */
    2374 +     44 +
    2375 +     45 +  /* Core hue-5: Orange/Red - Properties, tags */
    2376 +     46 +  --syntax-property: #fb5607; /* Neon orange for properties */
    2377 +     47 +  --syntax-tag: #ff006e; /* Hot pink for tags */
    2378 +     48 +  --syntax-deleted: #ff006e; /* Pink for diff */
    2379 +     49 +  --syntax-important: #fb5607; /* Orange for !important */
    2380 +     50 +
    2381 +     51 +  /* Core hue-6: Yellow/Purple - Class names, constants, numbers */
    2382 +     52 +  --syntax-class-name: #ffbe0b; /* Electric yellow for class names (Rectangle, Shape) */
    2383 +     53 +  --syntax-number: #ffbe0b; /* Yellow for numbers */
    2384 +     54 +  --syntax-constant: #fb5607; /* Orange for constants */
    2385 +     55 +  --syntax-boolean: #ffbe0b; /* Same as numbers */
    2386 +     56 +  --syntax-atrule: #8338ec; /* Purple for CSS @ rules */
    2387 +     57 +
    2388 +     58 +  /* Neutral colors */
    2389 +     59 +  --syntax-comment: #737373; /* Gray for comments */
    2390 +     60 +  --syntax-punctuation: #a3a3a3; /* Light gray for punctuation */
    2391 +     61 +  --syntax-operator: #ff1a8c; /* Pink for operators */
    2392 +     62 +
    2393 +     63 +  /* Markup specific */
    2394 +     64 +  --syntax-attr-name: #ffbe0b; /* Yellow like class-name */
    2395 +     65 +  --syntax-attr-value: #00f5d4; /* Cyan like strings */
    2396 +     66 +  --syntax-namespace: #8338ec; /* Purple */
    2397 +     67 +  --syntax-entity: #a3a3a3; /* Neutral */
    2398 +     68 +  --syntax-selector: #fb5607; /* Orange like properties */
    2399 + 40  69  
    2400 + 41  70    --blockquote-border: #8338ec;
    2401 + 42     -  --blockquote-bg: #1a1a1a;
    2402 +     71 +  --blockquote-bg: rgba(131, 56, 236, 0.1); /* Purple-tinted blockquote */
    2403 + 43  72    --bold-color: #ffbe0b;
    2404 + 44  73    --italic-color: #ff006e;
    2405 + 45     -  --table-header-bg: #262626;
    2406 + 46     -  --table-border: #404040;
    2407 +     74 +  --table-header-bg: rgba(58, 134, 255, 0.15); /* Blue-tinted table header */
    2408 +     75 +  --table-border: rgba(76, 29, 149, 0.3); /* Purple-tinted border */
    2409 +     76 +
    2410 +     77 +  /* === MERMAID COMPREHENSIVE CONFIGURATION === */
    2411 +     78 +
    2412 +     79 +  /* Core Global */
    2413 +     80 +  --mermaid-background: #0a0e1a;
    2414 +     81 +  --mermaid-text-color: #e0e7ff;
    2415 +     82 +  --mermaid-line-color: #3a86ff;
    2416 +     83 +  --mermaid-main-bkg: #1e2539;
    2417 +     84 +
    2418 +     85 +  /* Primary Set */
    2419 +     86 +  --mermaid-primary-color: #1e2539;
    2420 +     87 +  --mermaid-primary-text-color: #e0e7ff;
    2421 +     88 +  --mermaid-primary-border-color: #8338ec;
    2422 +     89 +
    2423 +     90 +  /* Secondary Set */
    2424 +     91 +  --mermaid-secondary-color: #141827;
    2425 +     92 +  --mermaid-secondary-text-color: #e0e7ff;
    2426 +     93 +  --mermaid-secondary-border-color: #3a86ff;
    2427 +     94 +
    2428 +     95 +  /* Tertiary Set */
    2429 +     96 +  --mermaid-tertiary-color: #0a0e1a;
    2430 +     97 +  --mermaid-tertiary-text-color: #e0e7ff;
    2431 +     98 +  --mermaid-tertiary-border-color: #ff006e;
    2432 +     99 +
    2433 +    100 +  /* Flowchart */
    2434 +    101 +  --mermaid-node-border: #8338ec;
    2435 +    102 +  --mermaid-cluster-bkg: #141827;
    2436 +    103 +  --mermaid-cluster-border: #3a86ff;
    2437 +    104 +  --mermaid-default-link-color: #3a86ff;
    2438 +    105 +  --mermaid-title-color: #e0e7ff;
    2439 +    106 +  --mermaid-edge-label-background: #0a0e1a;
    2440 +    107 +  --mermaid-node-text-color: #e0e7ff;
    2441 +    108 +
    2442 +    109 +  /* Sequence Diagram */
    2443 +    110 +  --mermaid-actor-bkg: #1e2539;
    2444 +    111 +  --mermaid-actor-border: #8338ec;
    2445 +    112 +  --mermaid-actor-text-color: #e0e7ff;
    2446 +    113 +  --mermaid-actor-line-color: #8338ec;
    2447 +    114 +  --mermaid-signal-color: #3a86ff;
    2448 +    115 +  --mermaid-signal-text-color: #e0e7ff;
    2449 +    116 +  --mermaid-label-box-bkg-color: #1e2539;
    2450 +    117 +  --mermaid-label-box-border-color: #8338ec;
    2451 +    118 +  --mermaid-label-text-color: #e0e7ff;
    2452 +    119 +  --mermaid-loop-text-color: #e0e7ff;
    2453 +    120 +  --mermaid-activation-border-color: #3a86ff;
    2454 +    121 +  --mermaid-activation-bkg-color: #141827;
    2455 +    122 +  --mermaid-sequence-number-color: #e0e7ff;
    2456 +    123 +
    2457 +    124 +  /* Pie Chart */
    2458 +    125 +  --mermaid-pie1: #ff006e;
    2459 +    126 +  --mermaid-pie2: #8338ec;
    2460 +    127 +  --mermaid-pie3: #3a86ff;
    2461 +    128 +  --mermaid-pie4: #00f5d4;
    2462 +    129 +  --mermaid-pie5: #ffbe0b;
    2463 +    130 +  --mermaid-pie6: #fb5607;
    2464 +    131 +  --mermaid-pie7: #ff1a8c;
    2465 +    132 +  --mermaid-pie8: #00d4aa;
    2466 +    133 +  --mermaid-pie9: #a5b4fc;
    2467 +    134 +  --mermaid-pie10: #ff006e;
    2468 +    135 +  --mermaid-pie11: #8338ec;
    2469 +    136 +  --mermaid-pie12: #3a86ff;
    2470 +    137 +  --mermaid-pie-title-text-color: #e0e7ff;
    2471 +    138 +  --mermaid-pie-section-text-color: #0a0e1a; /* Dark on vibrant slices */
    2472 +    139 +  --mermaid-pie-legend-text-color: #e0e7ff;
    2473 +    140 +  --mermaid-pie-stroke-color: #8338ec;
    2474 +    141 +  --mermaid-pie-outer-stroke-color: #8338ec;
    2475 +    142 +
    2476 +    143 +  /* State Diagram */
    2477 +    144 +  --mermaid-label-color: #e0e7ff;
    2478 +    145 +  --mermaid-alt-background: #141827;
    2479 +    146 +
    2480 +    147 +  /* Class Diagram */
    2481 +    148 +  --mermaid-class-text: #e0e7ff;
    2482 +    149 +
    2483 +    150 +  /* User Journey */
    2484 +    151 +  --mermaid-fill-type0: #ff006e;
    2485 +    152 +  --mermaid-fill-type1: #8338ec;
    2486 +    153 +  --mermaid-fill-type2: #3a86ff;
    2487 +    154 +  --mermaid-fill-type3: #00f5d4;
    2488 +    155 +  --mermaid-fill-type4: #ffbe0b;
    2489 +    156 +  --mermaid-fill-type5: #fb5607;
    2490 +    157 +  --mermaid-fill-type6: #ff1a8c;
    2491 +    158 +  --mermaid-fill-type7: #00d4aa;
    2492 + 47 159  }
    2493 + 48 160  
    2494 +
    2495 +```
    2496 +
    2497 +
    2498 +### üìÑ `themes/neon-light.css`
    2499 +
    2500 +**Type:** Stylesheet üé®
    2501 +
    2502 +```diff
    2503 +@@ -23,20 +23,49 @@
    2504 + 23  23    --code-block-bg: #fef3ff; /* Light purple background */
    2505 + 24  24    --code-border: #e9d5ff;
    2506 + 25  25  
    2507 + 26     -  /* Syntax Highlighting - Comprehensive Token Colors */
    2508 + 27     -  --syntax-keyword: #c026d3;
    2509 + 28     -  --syntax-string: #10b981;
    2510 + 29     -  --syntax-number: #f59e0b;
    2511 + 30     -  --syntax-function: #7c3aed;
    2512 + 31     -  --syntax-comment: #9ca3af;
    2513 + 32     -  --syntax-operator: #a21caf;
    2514 + 33     -  --syntax-punctuation: #6b7280;
    2515 +     26 +  /* Syntax Highlighting - Production-Grade Token Colors (One Dark Architecture) */
    2516 + 34  27  
    2517 + 35     -  /* Additional Token Types for Full Customization */
    2518 + 36     -  --syntax-variable: #7c3aed; /* Variables - purple */
    2519 + 37     -  --syntax-property: #a21caf; /* Properties - magenta */
    2520 + 38     -  --syntax-namespace: #c026d3; /* Namespaces - pink */
    2521 + 39     -  --syntax-builtin: #7c3aed; /* Builtins - purple */
    2522 +     28 +  /* Core hue-1: Cyan - URLs */
    2523 +     29 +  --syntax-url: #06b6d4; /* Cyan for URLs */
    2524 +     30 +
    2525 +     31 +  /* Core hue-2: Purple/Violet - Functions, variables */
    2526 +     32 +  --syntax-function: #7c3aed; /* Vibrant purple for functions */
    2527 +     33 +  --syntax-variable: #6366f1; /* Indigo for variables */
    2528 +     34 +
    2529 +     35 +  /* Core hue-3: Magenta - Keywords */
    2530 +     36 +  --syntax-keyword: #c026d3; /* Bright magenta for keywords (final, sealed, class) */
    2531 +     37 +
    2532 +     38 +  /* Core hue-4: Green - Strings, builtins */
    2533 +     39 +  --syntax-string: #10b981; /* Emerald green for strings */
    2534 +     40 +  --syntax-builtin: #059669; /* Dark emerald for builtins (String, List) */
    2535 +     41 +  --syntax-char: #10b981; /* Same as strings */
    2536 +     42 +  --syntax-regex: #10b981; /* Same as strings */
    2537 +     43 +  --syntax-inserted: #10b981; /* For diff */
    2538 +     44 +
    2539 +     45 +  /* Core hue-5: Blue - Properties, tags */
    2540 +     46 +  --syntax-property: #3b82f6; /* Blue for properties */
    2541 +     47 +  --syntax-tag: #2563eb; /* Dark blue for tags */
    2542 +     48 +  --syntax-deleted: #ef4444; /* Red for diff */
    2543 +     49 +  --syntax-important: #3b82f6; /* Blue for !important */
    2544 +     50 +
    2545 +     51 +  /* Core hue-6: Amber/Pink - Class names, constants, numbers */
    2546 +     52 +  --syntax-class-name: #d946ef; /* Fuchsia for class names (Rectangle, Shape) */
    2547 +     53 +  --syntax-number: #f59e0b; /* Amber for numbers */
    2548 +     54 +  --syntax-constant: #c026d3; /* Magenta for constants */
    2549 +     55 +  --syntax-boolean: #f59e0b; /* Same as numbers */
    2550 +     56 +  --syntax-atrule: #d946ef; /* Fuchsia for CSS @ rules */
    2551 +     57 +
    2552 +     58 +  /* Neutral colors */
    2553 +     59 +  --syntax-comment: #9ca3af; /* Gray for comments */
    2554 +     60 +  --syntax-punctuation: #6b7280; /* Dark gray for punctuation */
    2555 +     61 +  --syntax-operator: #a21caf; /* Magenta-pink for operators */
    2556 +     62 +
    2557 +     63 +  /* Markup specific */
    2558 +     64 +  --syntax-attr-name: #d946ef; /* Fuchsia like class-name */
    2559 +     65 +  --syntax-attr-value: #10b981; /* Green like strings */
    2560 +     66 +  --syntax-namespace: #7c3aed; /* Purple like keywords */
    2561 +     67 +  --syntax-entity: #6b7280; /* Neutral */
    2562 +     68 +  --syntax-selector: #3b82f6; /* Blue like properties */
    2563 + 40  69  
    2564 + 41  70    --blockquote-border: #c026d3;
    2565 + 42  71    --blockquote-bg: #fef3ff;
    2566 +@@ -44,4 +73,87 @@
    2567 + 44  73    --italic-color: #c026d3;
    2568 + 45  74    --table-header-bg: #fce7f3;
    2569 + 46  75    --table-border: #e9d5ff;
    2570 +     76 +
    2571 +     77 +  /* === MERMAID COMPREHENSIVE CONFIGURATION === */
    2572 +     78 +
    2573 +     79 +  /* Core Global */
    2574 +     80 +  --mermaid-background: #ffffff;
    2575 +     81 +  --mermaid-text-color: #3b0764;
    2576 +     82 +  --mermaid-line-color: #7c3aed;
    2577 +     83 +  --mermaid-main-bkg: #fce7f3;
    2578 +     84 +
    2579 +     85 +  /* Primary Set */
    2580 +     86 +  --mermaid-primary-color: #fce7f3;
    2581 +     87 +  --mermaid-primary-text-color: #3b0764;
    2582 +     88 +  --mermaid-primary-border-color: #c026d3;
    2583 +     89 +
    2584 +     90 +  /* Secondary Set */
    2585 +     91 +  --mermaid-secondary-color: #fef3ff;
    2586 +     92 +  --mermaid-secondary-text-color: #3b0764;
    2587 +     93 +  --mermaid-secondary-border-color: #7c3aed;
    2588 +     94 +
    2589 +     95 +  /* Tertiary Set */
    2590 +     96 +  --mermaid-tertiary-color: #ffffff;
    2591 +     97 +  --mermaid-tertiary-text-color: #3b0764;
    2592 +     98 +  --mermaid-tertiary-border-color: #d946ef;
    2593 +     99 +
    2594 +    100 +  /* Flowchart */
    2595 +    101 +  --mermaid-node-border: #c026d3;
    2596 +    102 +  --mermaid-cluster-bkg: #fef3ff;
    2597 +    103 +  --mermaid-cluster-border: #7c3aed;
    2598 +    104 +  --mermaid-default-link-color: #7c3aed;
    2599 +    105 +  --mermaid-title-color: #3b0764;
    2600 +    106 +  --mermaid-edge-label-background: #ffffff;
    2601 +    107 +  --mermaid-node-text-color: #3b0764;
    2602 +    108 +
    2603 +    109 +  /* Sequence Diagram */
    2604 +    110 +  --mermaid-actor-bkg: #fce7f3;
    2605 +    111 +  --mermaid-actor-border: #c026d3;
    2606 +    112 +  --mermaid-actor-text-color: #3b0764;
    2607 +    113 +  --mermaid-actor-line-color: #c026d3;
    2608 +    114 +  --mermaid-signal-color: #7c3aed;
    2609 +    115 +  --mermaid-signal-text-color: #3b0764;
    2610 +    116 +  --mermaid-label-box-bkg-color: #fce7f3;
    2611 +    117 +  --mermaid-label-box-border-color: #c026d3;
    2612 +    118 +  --mermaid-label-text-color: #3b0764;
    2613 +    119 +  --mermaid-loop-text-color: #3b0764;
    2614 +    120 +  --mermaid-activation-border-color: #7c3aed;
    2615 +    121 +  --mermaid-activation-bkg-color: #fef3ff;
    2616 +    122 +  --mermaid-sequence-number-color: #3b0764;
    2617 +    123 +
    2618 +    124 +  /* Pie Chart */
    2619 +    125 +  --mermaid-pie1: #c026d3;
    2620 +    126 +  --mermaid-pie2: #7c3aed;
    2621 +    127 +  --mermaid-pie3: #3b82f6;
    2622 +    128 +  --mermaid-pie4: #06b6d4;
    2623 +    129 +  --mermaid-pie5: #f59e0b;
    2624 +    130 +  --mermaid-pie6: #ef4444;
    2625 +    131 +  --mermaid-pie7: #d946ef;
    2626 +    132 +  --mermaid-pie8: #6366f1;
    2627 +    133 +  --mermaid-pie9: #10b981;
    2628 +    134 +  --mermaid-pie10: #c026d3;
    2629 +    135 +  --mermaid-pie11: #7c3aed;
    2630 +    136 +  --mermaid-pie12: #3b82f6;
    2631 +    137 +  --mermaid-pie-title-text-color: #3b0764;
    2632 +    138 +  --mermaid-pie-section-text-color: #ffffff; /* White on vibrant slices */
    2633 +    139 +  --mermaid-pie-legend-text-color: #3b0764;
    2634 +    140 +  --mermaid-pie-stroke-color: #c026d3;
    2635 +    141 +  --mermaid-pie-outer-stroke-color: #c026d3;
    2636 +    142 +
    2637 +    143 +  /* State Diagram */
    2638 +    144 +  --mermaid-label-color: #3b0764;
    2639 +    145 +  --mermaid-alt-background: #fef3ff;
    2640 +    146 +
    2641 +    147 +  /* Class Diagram */
    2642 +    148 +  --mermaid-class-text: #3b0764;
    2643 +    149 +
    2644 +    150 +  /* User Journey */
    2645 +    151 +  --mermaid-fill-type0: #c026d3;
    2646 +    152 +  --mermaid-fill-type1: #7c3aed;
    2647 +    153 +  --mermaid-fill-type2: #3b82f6;
    2648 +    154 +  --mermaid-fill-type3: #06b6d4;
    2649 +    155 +  --mermaid-fill-type4: #f59e0b;
    2650 +    156 +  --mermaid-fill-type5: #ef4444;
    2651 +    157 +  --mermaid-fill-type6: #d946ef;
    2652 +    158 +  --mermaid-fill-type7: #6366f1;
    2653 + 47 159  }
    2654 + 48 160  
    2655 +
    2656 +```
    2657 +
    2658 +
    2659 +### üìÑ `themes/obsidian-dark.css`
    2660 +
    2661 +**Type:** Stylesheet üé®
    2662 +
    2663 +```diff
    2664 +@@ -52,20 +52,49 @@
    2665 + 52  52    --code-block-bg: #232635;
    2666 + 53  53    --code-border: rgba(78, 205, 196, 0.2);
    2667 + 54  54  
    2668 + 55     -  /* Syntax Highlighting */
    2669 + 56     -  --syntax-keyword: #c792ea;
    2670 + 57     -  --syntax-string: #6bcf7f;
    2671 + 58     -  --syntax-number: #ffcb6b;
    2672 + 59     -  --syntax-function: #82aaff;
    2673 + 60     -  --syntax-comment: #7f85a3;
    2674 + 61     -  --syntax-operator: #89ddff;
    2675 + 62     -  --syntax-punctuation: #b8bcc8;
    2676 +     55 +  /* Syntax Highlighting - Production-Grade Token Colors (One Dark Architecture) */
    2677 + 63  56  
    2678 + 64     -  /* Additional Token Types */
    2679 + 65     -  --syntax-variable: #82aaff; /* Variables - blue (distinct from text #f5f7ff) */
    2680 + 66     -  --syntax-property: #4ecdc4; /* Properties - cyan */
    2681 + 67     -  --syntax-namespace: #ffb86c; /* Namespaces - orange */
    2682 + 68     -  --syntax-builtin: #c77dff; /* Builtins - purple */
    2683 +     57 +  /* Core hue-1: Cyan - URLs */
    2684 +     58 +  --syntax-url: #4ecdc4; /* Bright cyan for URLs */
    2685 +     59 +
    2686 +     60 +  /* Core hue-2: Blue - Functions, variables */
    2687 +     61 +  --syntax-function: #82aaff; /* Bright blue for functions */
    2688 +     62 +  --syntax-variable: #5da9ff; /* Sky blue for variables */
    2689 +     63 +
    2690 +     64 +  /* Core hue-3: Purple - Keywords */
    2691 +     65 +  --syntax-keyword: #c792ea; /* Lavender purple for keywords (final, sealed, class) */
    2692 +     66 +
    2693 +     67 +  /* Core hue-4: Green - Strings, builtins */
    2694 +     68 +  --syntax-string: #95e1d3; /* Mint green for strings */
    2695 +     69 +  --syntax-builtin: #6bcf7f; /* Vibrant green for builtins (String, List) */
    2696 +     70 +  --syntax-char: #95e1d3; /* Same as strings */
    2697 +     71 +  --syntax-regex: #95e1d3; /* Same as strings */
    2698 +     72 +  --syntax-inserted: #6bcf7f; /* For diff */
    2699 +     73 +
    2700 +     74 +  /* Core hue-5: Pink - Properties, tags */
    2701 +     75 +  --syntax-property: #ff6b9d; /* Hot pink for properties */
    2702 +     76 +  --syntax-tag: #ff7eb3; /* Coral pink for tags */
    2703 +     77 +  --syntax-deleted: #f38ba8; /* Pink-red for diff */
    2704 +     78 +  --syntax-important: #ff6b9d; /* Hot pink for !important */
    2705 +     79 +
    2706 +     80 +  /* Core hue-6: Yellow/Orange - Class names, constants, numbers */
    2707 +     81 +  --syntax-class-name: #ffb86c; /* Peach orange for class names (Rectangle, Shape) */
    2708 +     82 +  --syntax-number: #ffd93d; /* Bright yellow for numbers */
    2709 +     83 +  --syntax-constant: #ffb86c; /* Peach for constants */
    2710 +     84 +  --syntax-boolean: #ffd93d; /* Same as numbers */
    2711 +     85 +  --syntax-atrule: #c77dff; /* Purple for CSS @ rules */
    2712 +     86 +
    2713 +     87 +  /* Neutral colors */
    2714 +     88 +  --syntax-comment: #7f85a3; /* Muted blue-gray for comments */
    2715 +     89 +  --syntax-punctuation: #b8bcc8; /* Light gray for punctuation */
    2716 +     90 +  --syntax-operator: #89ddff; /* Cyan for operators */
    2717 +     91 +
    2718 +     92 +  /* Markup specific */
    2719 +     93 +  --syntax-attr-name: #ffb86c; /* Peach like class-name */
    2720 +     94 +  --syntax-attr-value: #95e1d3; /* Mint like strings */
    2721 +     95 +  --syntax-namespace: #c792ea; /* Purple like keywords */
    2722 +     96 +  --syntax-entity: #b8bcc8; /* Neutral */
    2723 +     97 +  --syntax-selector: #ff6b9d; /* Pink like properties */
    2724 + 69  98  
    2725 + 70  99    /* Blockquote */
    2726 + 71 100    --blockquote-border: #ff6b9d;
    2727 +@@ -77,4 +106,87 @@
    2728 + 77 106  
    2729 + 78 107    /* Border */
    2730 + 79 108    --border-color: rgba(255, 255, 255, 0.1);
    2731 +    109 +
    2732 +    110 +  /* === MERMAID COMPREHENSIVE CONFIGURATION === */
    2733 +    111 +
    2734 +    112 +  /* Core Global */
    2735 +    113 +  --mermaid-background: #1e1e2e;
    2736 +    114 +  --mermaid-text-color: #f5f7ff;
    2737 +    115 +  --mermaid-line-color: #82aaff;
    2738 +    116 +  --mermaid-main-bkg: #383a4f;
    2739 +    117 +
    2740 +    118 +  /* Primary Set */
    2741 +    119 +  --mermaid-primary-color: #383a4f;
    2742 +    120 +  --mermaid-primary-text-color: #f5f7ff;
    2743 +    121 +  --mermaid-primary-border-color: #ff6b9d;
    2744 +    122 +
    2745 +    123 +  /* Secondary Set */
    2746 +    124 +  --mermaid-secondary-color: #2b2d3e;
    2747 +    125 +  --mermaid-secondary-text-color: #f5f7ff;
    2748 +    126 +  --mermaid-secondary-border-color: #82aaff;
    2749 +    127 +
    2750 +    128 +  /* Tertiary Set */
    2751 +    129 +  --mermaid-tertiary-color: #1e1e2e;
    2752 +    130 +  --mermaid-tertiary-text-color: #f5f7ff;
    2753 +    131 +  --mermaid-tertiary-border-color: #4ecdc4;
    2754 +    132 +
    2755 +    133 +  /* Flowchart */
    2756 +    134 +  --mermaid-node-border: #ff6b9d;
    2757 +    135 +  --mermaid-cluster-bkg: #2b2d3e;
    2758 +    136 +  --mermaid-cluster-border: #82aaff;
    2759 +    137 +  --mermaid-default-link-color: #82aaff;
    2760 +    138 +  --mermaid-title-color: #f5f7ff;
    2761 +    139 +  --mermaid-edge-label-background: #1e1e2e;
    2762 +    140 +  --mermaid-node-text-color: #f5f7ff;
    2763 +    141 +
    2764 +    142 +  /* Sequence Diagram */
    2765 +    143 +  --mermaid-actor-bkg: #383a4f;
    2766 +    144 +  --mermaid-actor-border: #ff6b9d;
    2767 +    145 +  --mermaid-actor-text-color: #f5f7ff;
    2768 +    146 +  --mermaid-actor-line-color: #ff6b9d;
    2769 +    147 +  --mermaid-signal-color: #82aaff;
    2770 +    148 +  --mermaid-signal-text-color: #f5f7ff;
    2771 +    149 +  --mermaid-label-box-bkg-color: #383a4f;
    2772 +    150 +  --mermaid-label-box-border-color: #ff6b9d;
    2773 +    151 +  --mermaid-label-text-color: #f5f7ff;
    2774 +    152 +  --mermaid-loop-text-color: #f5f7ff;
    2775 +    153 +  --mermaid-activation-border-color: #82aaff;
    2776 +    154 +  --mermaid-activation-bkg-color: #2b2d3e;
    2777 +    155 +  --mermaid-sequence-number-color: #f5f7ff;
    2778 +    156 +
    2779 +    157 +  /* Pie Chart */
    2780 +    158 +  --mermaid-pie1: #ff6b9d;
    2781 +    159 +  --mermaid-pie2: #ffd93d;
    2782 +    160 +  --mermaid-pie3: #4ecdc4;
    2783 +    161 +  --mermaid-pie4: #c77dff;
    2784 +    162 +  --mermaid-pie5: #ffb86c;
    2785 +    163 +  --mermaid-pie6: #95e1d3;
    2786 +    164 +  --mermaid-pie7: #82aaff;
    2787 +    165 +  --mermaid-pie8: #ff7eb3;
    2788 +    166 +  --mermaid-pie9: #c8f6c2;
    2789 +    167 +  --mermaid-pie10: #89dceb;
    2790 +    168 +  --mermaid-pie11: #ff6b9d;
    2791 +    169 +  --mermaid-pie12: #ffd93d;
    2792 +    170 +  --mermaid-pie-title-text-color: #f5f7ff;
    2793 +    171 +  --mermaid-pie-section-text-color: #1e1e2e; /* Dark on vibrant slices */
    2794 +    172 +  --mermaid-pie-legend-text-color: #f5f7ff;
    2795 +    173 +  --mermaid-pie-stroke-color: #ff6b9d;
    2796 +    174 +  --mermaid-pie-outer-stroke-color: #ff6b9d;
    2797 +    175 +
    2798 +    176 +  /* State Diagram */
    2799 +    177 +  --mermaid-label-color: #f5f7ff;
    2800 +    178 +  --mermaid-alt-background: #2b2d3e;
    2801 +    179 +
    2802 +    180 +  /* Class Diagram */
    2803 +    181 +  --mermaid-class-text: #f5f7ff;
    2804 +    182 +
    2805 +    183 +  /* User Journey */
    2806 +    184 +  --mermaid-fill-type0: #ff6b9d;
    2807 +    185 +  --mermaid-fill-type1: #ffd93d;
    2808 +    186 +  --mermaid-fill-type2: #4ecdc4;
    2809 +    187 +  --mermaid-fill-type3: #c77dff;
    2810 +    188 +  --mermaid-fill-type4: #ffb86c;
    2811 +    189 +  --mermaid-fill-type5: #95e1d3;
    2812 +    190 +  --mermaid-fill-type6: #82aaff;
    2813 +    191 +  --mermaid-fill-type7: #ff7eb3;
    2814 + 80 192  }
    2815 + 81 193  
    2816 +
    2817 +```
    2818 +
    2819 +
    2820 +### üìÑ `themes/obsidian-light.css`
    2821 +
    2822 +**Type:** Stylesheet üé®
    2823 +
    2824 +```diff
    2825 +@@ -52,20 +52,49 @@
    2826 + 52  52    --code-block-bg: #f8f9fc;
    2827 + 53  53    --code-border: rgba(0, 188, 212, 0.2);
    2828 + 54  54  
    2829 + 55     -  /* Syntax Highlighting - Comprehensive Token Colors */
    2830 + 56     -  --syntax-keyword: #9c27b0;
    2831 + 57     -  --syntax-string: #4caf50;
    2832 + 58     -  --syntax-number: #f57c00;
    2833 + 59     -  --syntax-function: #2196f3;
    2834 + 60     -  --syntax-comment: #9e9e9e;
    2835 + 61     -  --syntax-operator: #00bcd4;
    2836 + 62     -  --syntax-punctuation: #616161;
    2837 +     55 +  /* Syntax Highlighting - Production-Grade Token Colors (One Dark Architecture) */
    2838 + 63  56  
    2839 + 64     -  /* Additional Token Types for Full Customization */
    2840 + 65     -  --syntax-variable: #2196f3; /* Variables, parameters - bright blue */
    2841 + 66     -  --syntax-property: #00bcd4; /* Properties - cyan */
    2842 + 67     -  --syntax-namespace: #f57c00; /* Namespaces - orange */
    2843 + 68     -  --syntax-builtin: #9c27b0; /* Built-in functions - purple */
    2844 +     57 +  /* Core hue-1: Cyan - URLs */
    2845 +     58 +  --syntax-url: #00bcd4; /* Cyan for URLs */
    2846 +     59 +
    2847 +     60 +  /* Core hue-2: Blue - Functions, variables */
    2848 +     61 +  --syntax-function: #2196f3; /* Bright blue for functions */
    2849 +     62 +  --syntax-variable: #1976d2; /* Deep blue for variables */
    2850 +     63 +
    2851 +     64 +  /* Core hue-3: Purple - Keywords */
    2852 +     65 +  --syntax-keyword: #9c27b0; /* Vibrant purple for keywords (final, sealed, class) */
    2853 +     66 +
    2854 +     67 +  /* Core hue-4: Green - Strings, builtins */
    2855 +     68 +  --syntax-string: #4caf50; /* Green for strings */
    2856 +     69 +  --syntax-builtin: #388e3c; /* Dark green for builtins (String, List) */
    2857 +     70 +  --syntax-char: #4caf50; /* Same as strings */
    2858 +     71 +  --syntax-regex: #4caf50; /* Same as strings */
    2859 +     72 +  --syntax-inserted: #388e3c; /* For diff */
    2860 +     73 +
    2861 +     74 +  /* Core hue-5: Pink/Orange - Properties, tags */
    2862 +     75 +  --syntax-property: #e91e63; /* Pink for properties */
    2863 +     76 +  --syntax-tag: #ff4081; /* Coral for tags */
    2864 +     77 +  --syntax-deleted: #d32f2f; /* Red for diff */
    2865 +     78 +  --syntax-important: #e91e63; /* Pink for !important */
    2866 +     79 +
    2867 +     80 +  /* Core hue-6: Orange/Yellow - Class names, constants, numbers */
    2868 +     81 +  --syntax-class-name: #ff9800; /* Orange for class names (Rectangle, Shape) */
    2869 +     82 +  --syntax-number: #f57c00; /* Dark orange for numbers */
    2870 +     83 +  --syntax-constant: #ff9800; /* Orange for constants */
    2871 +     84 +  --syntax-boolean: #f57c00; /* Same as numbers */
    2872 +     85 +  --syntax-atrule: #9c27b0; /* Purple for CSS @ rules */
    2873 +     86 +
    2874 +     87 +  /* Neutral colors */
    2875 +     88 +  --syntax-comment: #9e9e9e; /* Gray for comments */
    2876 +     89 +  --syntax-punctuation: #616161; /* Dark gray for punctuation */
    2877 +     90 +  --syntax-operator: #00bcd4; /* Cyan for operators */
    2878 +     91 +
    2879 +     92 +  /* Markup specific */
    2880 +     93 +  --syntax-attr-name: #ff9800; /* Orange like class-name */
    2881 +     94 +  --syntax-attr-value: #4caf50; /* Green like strings */
    2882 +     95 +  --syntax-namespace: #9c27b0; /* Purple like keywords */
    2883 +     96 +  --syntax-entity: #616161; /* Neutral */
    2884 +     97 +  --syntax-selector: #e91e63; /* Pink like properties */
    2885 + 69  98  
    2886 + 70  99    /* Blockquote */
    2887 + 71 100    --blockquote-border: #e91e63;
    2888 +@@ -77,4 +106,87 @@
    2889 + 77 106  
    2890 + 78 107    /* Border */
    2891 + 79 108    --border-color: rgba(0, 0, 0, 0.12);
    2892 +    109 +
    2893 +    110 +  /* === MERMAID COMPREHENSIVE CONFIGURATION === */
    2894 +    111 +
    2895 +    112 +  /* Core Global */
    2896 +    113 +  --mermaid-background: #ffffff;
    2897 +    114 +  --mermaid-text-color: #1a1a1a;
    2898 +    115 +  --mermaid-line-color: #9c27b0;
    2899 +    116 +  --mermaid-main-bkg: #e8ecf1;
    2900 +    117 +
    2901 +    118 +  /* Primary Set */
    2902 +    119 +  --mermaid-primary-color: #e8ecf1;
    2903 +    120 +  --mermaid-primary-text-color: #1a1a1a;
    2904 +    121 +  --mermaid-primary-border-color: #e91e63;
    2905 +    122 +
    2906 +    123 +  /* Secondary Set */
    2907 +    124 +  --mermaid-secondary-color: #f5f7fa;
    2908 +    125 +  --mermaid-secondary-text-color: #1a1a1a;
    2909 +    126 +  --mermaid-secondary-border-color: #9c27b0;
    2910 +    127 +
    2911 +    128 +  /* Tertiary Set */
    2912 +    129 +  --mermaid-tertiary-color: #ffffff;
    2913 +    130 +  --mermaid-tertiary-text-color: #1a1a1a;
    2914 +    131 +  --mermaid-tertiary-border-color: #00bcd4;
    2915 +    132 +
    2916 +    133 +  /* Flowchart */
    2917 +    134 +  --mermaid-node-border: #e91e63;
    2918 +    135 +  --mermaid-cluster-bkg: #f5f7fa;
    2919 +    136 +  --mermaid-cluster-border: #9c27b0;
    2920 +    137 +  --mermaid-default-link-color: #9c27b0;
    2921 +    138 +  --mermaid-title-color: #1a1a1a;
    2922 +    139 +  --mermaid-edge-label-background: #ffffff;
    2923 +    140 +  --mermaid-node-text-color: #1a1a1a;
    2924 +    141 +
    2925 +    142 +  /* Sequence Diagram */
    2926 +    143 +  --mermaid-actor-bkg: #e8ecf1;
    2927 +    144 +  --mermaid-actor-border: #e91e63;
    2928 +    145 +  --mermaid-actor-text-color: #1a1a1a;
    2929 +    146 +  --mermaid-actor-line-color: #e91e63;
    2930 +    147 +  --mermaid-signal-color: #9c27b0;
    2931 +    148 +  --mermaid-signal-text-color: #1a1a1a;
    2932 +    149 +  --mermaid-label-box-bkg-color: #e8ecf1;
    2933 +    150 +  --mermaid-label-box-border-color: #e91e63;
    2934 +    151 +  --mermaid-label-text-color: #1a1a1a;
    2935 +    152 +  --mermaid-loop-text-color: #1a1a1a;
    2936 +    153 +  --mermaid-activation-border-color: #9c27b0;
    2937 +    154 +  --mermaid-activation-bkg-color: #f5f7fa;
    2938 +    155 +  --mermaid-sequence-number-color: #1a1a1a;
    2939 +    156 +
    2940 +    157 +  /* Pie Chart */
    2941 +    158 +  --mermaid-pie1: #e91e63;
    2942 +    159 +  --mermaid-pie2: #9c27b0;
    2943 +    160 +  --mermaid-pie3: #2196f3;
    2944 +    161 +  --mermaid-pie4: #00bcd4;
    2945 +    162 +  --mermaid-pie5: #4caf50;
    2946 +    163 +  --mermaid-pie6: #ff9800;
    2947 +    164 +  --mermaid-pie7: #f57c00;
    2948 +    165 +  --mermaid-pie8: #ff4081;
    2949 +    166 +  --mermaid-pie9: #1976d2;
    2950 +    167 +  --mermaid-pie10: #388e3c;
    2951 +    168 +  --mermaid-pie11: #e91e63;
    2952 +    169 +  --mermaid-pie12: #9c27b0;
    2953 +    170 +  --mermaid-pie-title-text-color: #1a1a1a;
    2954 +    171 +  --mermaid-pie-section-text-color: #ffffff; /* White on vibrant slices */
    2955 +    172 +  --mermaid-pie-legend-text-color: #1a1a1a;
    2956 +    173 +  --mermaid-pie-stroke-color: #e91e63;
    2957 +    174 +  --mermaid-pie-outer-stroke-color: #e91e63;
    2958 +    175 +
    2959 +    176 +  /* State Diagram */
    2960 +    177 +  --mermaid-label-color: #1a1a1a;
    2961 +    178 +  --mermaid-alt-background: #f5f7fa;
    2962 +    179 +
    2963 +    180 +  /* Class Diagram */
    2964 +    181 +  --mermaid-class-text: #1a1a1a;
    2965 +    182 +
    2966 +    183 +  /* User Journey */
    2967 +    184 +  --mermaid-fill-type0: #e91e63;
    2968 +    185 +  --mermaid-fill-type1: #9c27b0;
    2969 +    186 +  --mermaid-fill-type2: #2196f3;
    2970 +    187 +  --mermaid-fill-type3: #00bcd4;
    2971 +    188 +  --mermaid-fill-type4: #4caf50;
    2972 +    189 +  --mermaid-fill-type5: #ff9800;
    2973 +    190 +  --mermaid-fill-type6: #f57c00;
    2974 +    191 +  --mermaid-fill-type7: #ff4081;
    2975 + 80 192  }
    2976 + 81 193  
    2977 +
    2978 +```
    2979 +
    2980 +
    2981 +### üìÑ `themes/ocean-dark.css`
    2982 +
    2983 +**Type:** Stylesheet üé®
    2984 +
    2985 +```diff
    2986 +@@ -23,20 +23,49 @@
    2987 + 23  23    --code-block-bg: #0a192f;
    2988 + 24  24    --code-border: #233554;
    2989 + 25  25  
    2990 + 26     -  /* Syntax Highlighting - Comprehensive Token Colors */
    2991 + 27     -  --syntax-keyword: #64ffda;
    2992 + 28     -  --syntax-string: #5eead4;
    2993 + 29     -  --syntax-number: #38bdf8;
    2994 + 30     -  --syntax-function: #22d3ee;
    2995 + 31     -  --syntax-comment: #8892b0;
    2996 + 32     -  --syntax-operator: #06b6d4;
    2997 + 33     -  --syntax-punctuation: #8892b0;
    2998 +     26 +  /* Syntax Highlighting - Production-Grade Token Colors (One Dark Architecture) */
    2999 + 34  27  
    3000 + 35     -  /* Additional Token Types */
    3001 + 36     -  --syntax-variable: #38bdf8; /* Variables - cyan (distinct from text #ccd6f6) */
    3002 + 37     -  --syntax-property: #22d3ee; /* Properties - teal */
    3003 + 38     -  --syntax-namespace: #64ffda; /* Namespaces - mint */
    3004 + 39     -  --syntax-builtin: #5eead4; /* Builtins - teal */
    3005 +     28 +  /* Core hue-1: Bright Cyan - URLs */
    3006 +     29 +  --syntax-url: #67e8f9; /* Electric cyan for URLs */
    3007 +     30 +
    3008 +     31 +  /* Core hue-2: Blue - Functions, variables */
    3009 +     32 +  --syntax-function: #38bdf8; /* Sky blue for functions */
    3010 +     33 +  --syntax-variable: #0ea5e9; /* Deep sky for variables */
    3011 +     34 +
    3012 +     35 +  /* Core hue-3: Violet/Purple - Keywords */
    3013 +     36 +  --syntax-keyword: #c084fc; /* Bright violet for keywords (final, sealed, class) */
    3014 +     37 +
    3015 +     38 +  /* Core hue-4: Green/Teal - Strings, builtins */
    3016 +     39 +  --syntax-string: #5eead4; /* Teal for strings */
    3017 +     40 +  --syntax-builtin: #2dd4bf; /* Vibrant teal for builtins (String, List) */
    3018 +     41 +  --syntax-char: #5eead4; /* Same as strings */
    3019 +     42 +  --syntax-regex: #5eead4; /* Same as strings */
    3020 +     43 +  --syntax-inserted: #2dd4bf; /* For diff */
    3021 +     44 +
    3022 +     45 +  /* Core hue-5: Pink/Rose - Properties, tags */
    3023 +     46 +  --syntax-property: #f472b6; /* Pink for properties */
    3024 +     47 +  --syntax-tag: #fb7185; /* Rose for tags */
    3025 +     48 +  --syntax-deleted: #f87171; /* Coral for diff */
    3026 +     49 +  --syntax-important: #f472b6; /* Pink for !important */
    3027 +     50 +
    3028 +     51 +  /* Core hue-6: Mint/Cyan - Class names, constants, numbers */
    3029 +     52 +  --syntax-class-name: #64ffda; /* Mint green for class names (Rectangle, Shape) */
    3030 +     53 +  --syntax-number: #22d3ee; /* Bright cyan for numbers */
    3031 +     54 +  --syntax-constant: #06b6d4; /* Cyan for constants */
    3032 +     55 +  --syntax-boolean: #22d3ee; /* Same as numbers */
    3033 +     56 +  --syntax-atrule: #64ffda; /* Mint for CSS @ rules */
    3034 +     57 +
    3035 +     58 +  /* Neutral colors */
    3036 +     59 +  --syntax-comment: #8892b0; /* Muted blue-gray for comments */
    3037 +     60 +  --syntax-punctuation: #a0aec0; /* Light gray for punctuation */
    3038 +     61 +  --syntax-operator: #0891b2; /* Teal for operators */
    3039 +     62 +
    3040 +     63 +  /* Markup specific */
    3041 +     64 +  --syntax-attr-name: #64ffda; /* Mint like class-name */
    3042 +     65 +  --syntax-attr-value: #5eead4; /* Teal like strings */
    3043 +     66 +  --syntax-namespace: #c084fc; /* Violet like keywords */
    3044 +     67 +  --syntax-entity: #a0aec0; /* Neutral */
    3045 +     68 +  --syntax-selector: #f472b6; /* Pink like properties */
    3046 + 40  69  
    3047 + 41  70    --blockquote-border: #64ffda;
    3048 + 42  71    --blockquote-bg: #112240;
    3049 +@@ -44,4 +73,87 @@
    3050 + 44  73    --italic-color: #5eead4;
    3051 + 45  74    --table-header-bg: #1d3461;
    3052 + 46  75    --table-border: #233554;
    3053 +     76 +
    3054 +     77 +  /* === MERMAID COMPREHENSIVE CONFIGURATION === */
    3055 +     78 +
    3056 +     79 +  /* Core Global */
    3057 +     80 +  --mermaid-background: #0a192f;
    3058 +     81 +  --mermaid-text-color: #ccd6f6;
    3059 +     82 +  --mermaid-line-color: #5eead4;
    3060 +     83 +  --mermaid-main-bkg: #1d3461;
    3061 +     84 +
    3062 +     85 +  /* Primary Set */
    3063 +     86 +  --mermaid-primary-color: #1d3461;
    3064 +     87 +  --mermaid-primary-text-color: #ccd6f6;
    3065 +     88 +  --mermaid-primary-border-color: #64ffda;
    3066 +     89 +
    3067 +     90 +  /* Secondary Set */
    3068 +     91 +  --mermaid-secondary-color: #112240;
    3069 +     92 +  --mermaid-secondary-text-color: #ccd6f6;
    3070 +     93 +  --mermaid-secondary-border-color: #5eead4;
    3071 +     94 +
    3072 +     95 +  /* Tertiary Set */
    3073 +     96 +  --mermaid-tertiary-color: #0a192f;
    3074 +     97 +  --mermaid-tertiary-text-color: #ccd6f6;
    3075 +     98 +  --mermaid-tertiary-border-color: #38bdf8;
    3076 +     99 +
    3077 +    100 +  /* Flowchart */
    3078 +    101 +  --mermaid-node-border: #64ffda;
    3079 +    102 +  --mermaid-cluster-bkg: #112240;
    3080 +    103 +  --mermaid-cluster-border: #5eead4;
    3081 +    104 +  --mermaid-default-link-color: #5eead4;
    3082 +    105 +  --mermaid-title-color: #ccd6f6;
    3083 +    106 +  --mermaid-edge-label-background: #0a192f;
    3084 +    107 +  --mermaid-node-text-color: #ccd6f6;
    3085 +    108 +
    3086 +    109 +  /* Sequence Diagram */
    3087 +    110 +  --mermaid-actor-bkg: #1d3461;
    3088 +    111 +  --mermaid-actor-border: #64ffda;
    3089 +    112 +  --mermaid-actor-text-color: #ccd6f6;
    3090 +    113 +  --mermaid-actor-line-color: #64ffda;
    3091 +    114 +  --mermaid-signal-color: #5eead4;
    3092 +    115 +  --mermaid-signal-text-color: #ccd6f6;
    3093 +    116 +  --mermaid-label-box-bkg-color: #1d3461;
    3094 +    117 +  --mermaid-label-box-border-color: #64ffda;
    3095 +    118 +  --mermaid-label-text-color: #ccd6f6;
    3096 +    119 +  --mermaid-loop-text-color: #ccd6f6;
    3097 +    120 +  --mermaid-activation-border-color: #5eead4;
    3098 +    121 +  --mermaid-activation-bkg-color: #112240;
    3099 +    122 +  --mermaid-sequence-number-color: #ccd6f6;
    3100 +    123 +
    3101 +    124 +  /* Pie Chart */
    3102 +    125 +  --mermaid-pie1: #64ffda;
    3103 +    126 +  --mermaid-pie2: #5eead4;
    3104 +    127 +  --mermaid-pie3: #38bdf8;
    3105 +    128 +  --mermaid-pie4: #22d3ee;
    3106 +    129 +  --mermaid-pie5: #06b6d4;
    3107 +    130 +  --mermaid-pie6: #0891b2;
    3108 +    131 +  --mermaid-pie7: #c084fc;
    3109 +    132 +  --mermaid-pie8: #f472b6;
    3110 +    133 +  --mermaid-pie9: #0ea5e9;
    3111 +    134 +  --mermaid-pie10: #64ffda;
    3112 +    135 +  --mermaid-pie11: #5eead4;
    3113 +    136 +  --mermaid-pie12: #38bdf8;
    3114 +    137 +  --mermaid-pie-title-text-color: #ccd6f6;
    3115 +    138 +  --mermaid-pie-section-text-color: #0a192f; /* Dark on vibrant slices */
    3116 +    139 +  --mermaid-pie-legend-text-color: #ccd6f6;
    3117 +    140 +  --mermaid-pie-stroke-color: #64ffda;
    3118 +    141 +  --mermaid-pie-outer-stroke-color: #64ffda;
    3119 +    142 +
    3120 +    143 +  /* State Diagram */
    3121 +    144 +  --mermaid-label-color: #ccd6f6;
    3122 +    145 +  --mermaid-alt-background: #112240;
    3123 +    146 +
    3124 +    147 +  /* Class Diagram */
    3125 +    148 +  --mermaid-class-text: #ccd6f6;
    3126 +    149 +
    3127 +    150 +  /* User Journey */
    3128 +    151 +  --mermaid-fill-type0: #64ffda;
    3129 +    152 +  --mermaid-fill-type1: #5eead4;
    3130 +    153 +  --mermaid-fill-type2: #38bdf8;
    3131 +    154 +  --mermaid-fill-type3: #22d3ee;
    3132 +    155 +  --mermaid-fill-type4: #06b6d4;
    3133 +    156 +  --mermaid-fill-type5: #0891b2;
    3134 +    157 +  --mermaid-fill-type6: #c084fc;
    3135 +    158 +  --mermaid-fill-type7: #f472b6;
    3136 + 47 159  }
    3137 + 48 160  
    3138 +
    3139 +```
    3140 +
    3141 +
    3142 +### üìÑ `themes/ocean-light.css`
    3143 +
    3144 +**Type:** Stylesheet üé®
    3145 +
    3146 +```diff
    3147 +@@ -23,20 +23,49 @@
    3148 + 23  23    --code-block-bg: #e0f2fe; /* Light cyan background */
    3149 + 24  24    --code-border: #7dd3fc;
    3150 + 25  25  
    3151 + 26     -  /* Syntax Highlighting - Comprehensive Token Colors */
    3152 + 27     -  --syntax-keyword: #0284c7;
    3153 + 28     -  --syntax-string: #0891b2;
    3154 + 29     -  --syntax-number: #06b6d4;
    3155 + 30     -  --syntax-function: #22d3ee;
    3156 + 31     -  --syntax-comment: #64748b;
    3157 + 32     -  --syntax-operator: #0369a1;
    3158 + 33     -  --syntax-punctuation: #475569;
    3159 +     26 +  /* Syntax Highlighting - Production-Grade Token Colors (One Dark Architecture) */
    3160 + 34  27  
    3161 + 35     -  /* Additional Token Types for Full Customization */
    3162 + 36     -  --syntax-variable: #0369a1; /* Variables - ocean blue */
    3163 + 37     -  --syntax-property: #0891b2; /* Properties - teal */
    3164 + 38     -  --syntax-namespace: #0284c7; /* Namespaces - cyan */
    3165 + 39     -  --syntax-builtin: #22d3ee; /* Builtins - bright cyan */
    3166 +     28 +  /* Core hue-1: Cyan - URLs */
    3167 +     29 +  --syntax-url: #06b6d4; /* Bright cyan for URLs */
    3168 +     30 +
    3169 +     31 +  /* Core hue-2: Blue - Functions, variables */
    3170 +     32 +  --syntax-function: #0284c7; /* Ocean blue for functions */
    3171 +     33 +  --syntax-variable: #0369a1; /* Deep blue for variables */
    3172 +     34 +
    3173 +     35 +  /* Core hue-3: Purple/Violet - Keywords */
    3174 +     36 +  --syntax-keyword: #7c3aed; /* Vivid purple for keywords (final, sealed, class) */
    3175 +     37 +
    3176 +     38 +  /* Core hue-4: Green/Teal - Strings, builtins */
    3177 +     39 +  --syntax-string: #0891b2; /* Teal for strings */
    3178 +     40 +  --syntax-builtin: #14b8a6; /* Bright teal for builtins (String, List) */
    3179 +     41 +  --syntax-char: #0891b2; /* Same as strings */
    3180 +     42 +  --syntax-regex: #0891b2; /* Same as strings */
    3181 +     43 +  --syntax-inserted: #14b8a6; /* For diff */
    3182 +     44 +
    3183 +     45 +  /* Core hue-5: Orange/Amber - Properties, tags */
    3184 +     46 +  --syntax-property: #f59e0b; /* Amber for properties */
    3185 +     47 +  --syntax-tag: #ea580c; /* Orange for tags */
    3186 +     48 +  --syntax-deleted: #ef4444; /* Red for diff */
    3187 +     49 +  --syntax-important: #f59e0b; /* Amber for !important */
    3188 +     50 +
    3189 +     51 +  /* Core hue-6: Cyan - Class names, constants, numbers */
    3190 +     52 +  --syntax-class-name: #22d3ee; /* Bright cyan for class names (Rectangle, Shape) */
    3191 +     53 +  --syntax-number: #06b6d4; /* Cyan for numbers */
    3192 +     54 +  --syntax-constant: #0891b2; /* Teal for constants */
    3193 +     55 +  --syntax-boolean: #06b6d4; /* Same as numbers */
    3194 +     56 +  --syntax-atrule: #22d3ee; /* Bright cyan for CSS @ rules */
    3195 +     57 +
    3196 +     58 +  /* Neutral colors */
    3197 +     59 +  --syntax-comment: #64748b; /* Slate gray for comments */
    3198 +     60 +  --syntax-punctuation: #475569; /* Dark slate for punctuation */
    3199 +     61 +  --syntax-operator: #0369a1; /* Deep ocean for operators */
    3200 +     62 +
    3201 +     63 +  /* Markup specific */
    3202 +     64 +  --syntax-attr-name: #22d3ee; /* Cyan like class-name */
    3203 +     65 +  --syntax-attr-value: #0891b2; /* Teal like strings */
    3204 +     66 +  --syntax-namespace: #7c3aed; /* Purple like keywords */
    3205 +     67 +  --syntax-entity: #475569; /* Neutral */
    3206 +     68 +  --syntax-selector: #f59e0b; /* Amber like properties */
    3207 + 40  69  
    3208 + 41  70    --blockquote-border: #0891b2;
    3209 + 42  71    --blockquote-bg: #e0f2fe;
    3210 +@@ -44,4 +73,87 @@
    3211 + 44  73    --italic-color: #0891b2;
    3212 + 45  74    --table-header-bg: #bae6fd;
    3213 + 46  75    --table-border: #7dd3fc;
    3214 +     76 +
    3215 +     77 +  /* === MERMAID COMPREHENSIVE CONFIGURATION === */
    3216 +     78 +
    3217 +     79 +  /* Core Global */
    3218 +     80 +  --mermaid-background: #f0f9ff;
    3219 +     81 +  --mermaid-text-color: #0c4a6e;
    3220 +     82 +  --mermaid-line-color: #0891b2;
    3221 +     83 +  --mermaid-main-bkg: #bae6fd;
    3222 +     84 +
    3223 +     85 +  /* Primary Set */
    3224 +     86 +  --mermaid-primary-color: #bae6fd;
    3225 +     87 +  --mermaid-primary-text-color: #0c4a6e;
    3226 +     88 +  --mermaid-primary-border-color: #0284c7;
    3227 +     89 +
    3228 +     90 +  /* Secondary Set */
    3229 +     91 +  --mermaid-secondary-color: #e0f2fe;
    3230 +     92 +  --mermaid-secondary-text-color: #0c4a6e;
    3231 +     93 +  --mermaid-secondary-border-color: #0891b2;
    3232 +     94 +
    3233 +     95 +  /* Tertiary Set */
    3234 +     96 +  --mermaid-tertiary-color: #f0f9ff;
    3235 +     97 +  --mermaid-tertiary-text-color: #0c4a6e;
    3236 +     98 +  --mermaid-tertiary-border-color: #06b6d4;
    3237 +     99 +
    3238 +    100 +  /* Flowchart */
    3239 +    101 +  --mermaid-node-border: #0284c7;
    3240 +    102 +  --mermaid-cluster-bkg: #e0f2fe;
    3241 +    103 +  --mermaid-cluster-border: #0891b2;
    3242 +    104 +  --mermaid-default-link-color: #0891b2;
    3243 +    105 +  --mermaid-title-color: #0c4a6e;
    3244 +    106 +  --mermaid-edge-label-background: #f0f9ff;
    3245 +    107 +  --mermaid-node-text-color: #0c4a6e;
    3246 +    108 +
    3247 +    109 +  /* Sequence Diagram */
    3248 +    110 +  --mermaid-actor-bkg: #bae6fd;
    3249 +    111 +  --mermaid-actor-border: #0284c7;
    3250 +    112 +  --mermaid-actor-text-color: #0c4a6e;
    3251 +    113 +  --mermaid-actor-line-color: #0284c7;
    3252 +    114 +  --mermaid-signal-color: #0891b2;
    3253 +    115 +  --mermaid-signal-text-color: #0c4a6e;
    3254 +    116 +  --mermaid-label-box-bkg-color: #bae6fd;
    3255 +    117 +  --mermaid-label-box-border-color: #0284c7;
    3256 +    118 +  --mermaid-label-text-color: #0c4a6e;
    3257 +    119 +  --mermaid-loop-text-color: #0c4a6e;
    3258 +    120 +  --mermaid-activation-border-color: #0891b2;
    3259 +    121 +  --mermaid-activation-bkg-color: #e0f2fe;
    3260 +    122 +  --mermaid-sequence-number-color: #0c4a6e;
    3261 +    123 +
    3262 +    124 +  /* Pie Chart */
    3263 +    125 +  --mermaid-pie1: #0284c7;
    3264 +    126 +  --mermaid-pie2: #0891b2;
    3265 +    127 +  --mermaid-pie3: #06b6d4;
    3266 +    128 +  --mermaid-pie4: #22d3ee;
    3267 +    129 +  --mermaid-pie5: #7c3aed;
    3268 +    130 +  --mermaid-pie6: #f59e0b;
    3269 +    131 +  --mermaid-pie7: #14b8a6;
    3270 +    132 +  --mermaid-pie8: #0369a1;
    3271 +    133 +  --mermaid-pie9: #0284c7;
    3272 +    134 +  --mermaid-pie10: #0891b2;
    3273 +    135 +  --mermaid-pie11: #06b6d4;
    3274 +    136 +  --mermaid-pie12: #22d3ee;
    3275 +    137 +  --mermaid-pie-title-text-color: #0c4a6e;
    3276 +    138 +  --mermaid-pie-section-text-color: #f0f9ff; /* Light on vibrant slices */
    3277 +    139 +  --mermaid-pie-legend-text-color: #0c4a6e;
    3278 +    140 +  --mermaid-pie-stroke-color: #0284c7;
    3279 +    141 +  --mermaid-pie-outer-stroke-color: #0284c7;
    3280 +    142 +
    3281 +    143 +  /* State Diagram */
    3282 +    144 +  --mermaid-label-color: #0c4a6e;
    3283 +    145 +  --mermaid-alt-background: #e0f2fe;
    3284 +    146 +
    3285 +    147 +  /* Class Diagram */
    3286 +    148 +  --mermaid-class-text: #0c4a6e;
    3287 +    149 +
    3288 +    150 +  /* User Journey */
    3289 +    151 +  --mermaid-fill-type0: #0284c7;
    3290 +    152 +  --mermaid-fill-type1: #0891b2;
    3291 +    153 +  --mermaid-fill-type2: #06b6d4;
    3292 +    154 +  --mermaid-fill-type3: #22d3ee;
    3293 +    155 +  --mermaid-fill-type4: #7c3aed;
    3294 +    156 +  --mermaid-fill-type5: #f59e0b;
    3295 +    157 +  --mermaid-fill-type6: #14b8a6;
    3296 +    158 +  --mermaid-fill-type7: #0369a1;
    3297 + 47 159  }
    3298 + 48 160  
363 3299  
364 3300  ```
365 3301  
@@ -369,13 +3305,319 @@ memory-bank/activeContext.md |  52 +++++++++-
369 3305  **Type:** Stylesheet üé®
370 3306  
371 3307  ```diff
372     -@@ -1,4 +1,4 @@
373     -  1     -r/* Sunset Dark Theme */
374     -      1 +/* Sunset Dark Theme */
375     -  2   2  :root {
376     -  3   3    --bg-primary: #1c0a00;
377     -  4   4    --bg-secondary: #2d1b0e;
378     -  5   5  
    3308 +@@ -23,20 +23,49 @@
    3309 + 23  23    --code-block-bg: #1c0a00;
    3310 + 24  24    --code-border: #7c2d12;
    3311 + 25  25  
    3312 + 26     -  /* Syntax Highlighting - Comprehensive Token Colors */
    3313 + 27     -  --syntax-keyword: #fb923c;
    3314 + 28     -  --syntax-string: #a3e635;
    3315 + 29     -  --syntax-number: #fbbf24;
    3316 + 30     -  --syntax-function: #f87171;
    3317 + 31     -  --syntax-comment: #78716c;
    3318 + 32     -  --syntax-operator: #fdba74;
    3319 + 33     -  --syntax-punctuation: #d4d4d4;
    3320 +     26 +  /* Syntax Highlighting - Production-Grade Token Colors (One Dark Architecture) */
    3321 + 34  27  
    3322 + 35     -  /* Additional Token Types */
    3323 + 36     -  --syntax-variable: #fcd34d; /* Variables - bright yellow (distinct from text #fed7aa) */
    3324 + 37     -  --syntax-property: #f87171; /* Properties - coral */
    3325 + 38     -  --syntax-namespace: #fb923c; /* Namespaces - sunset orange */
    3326 + 39     -  --syntax-builtin: #f87171; /* Builtins - coral */
    3327 +     28 +  /* Core hue-1: Cyan (187¬∞) - URLs */
    3328 +     29 +  --syntax-url: #5eead4; /* Bright teal for URLs */
    3329 +     30 +
    3330 +     31 +  /* Core hue-2: Blue (207¬∞) - Functions, variables */
    3331 +     32 +  --syntax-function: #60a5fa; /* Bright blue for functions */
    3332 +     33 +  --syntax-variable: #38bdf8; /* Sky blue for variables */
    3333 +     34 +
    3334 +     35 +  /* Core hue-3: Purple (286¬∞) - Keywords */
    3335 +     36 +  --syntax-keyword: #c084fc; /* Bright purple for keywords (final, sealed, class keyword) */
    3336 +     37 +
    3337 +     38 +  /* Core hue-4: Green (95¬∞) - Strings, builtins */
    3338 +     39 +  --syntax-string: #a3e635; /* Lime green for strings */
    3339 +     40 +  --syntax-builtin: #84cc16; /* Vibrant green for builtins (String, List) */
    3340 +     41 +  --syntax-char: #a3e635; /* Same as strings */
    3341 +     42 +  --syntax-regex: #a3e635; /* Same as strings */
    3342 +     43 +  --syntax-inserted: #a3e635; /* For diff */
    3343 +     44 +
    3344 +     45 +  /* Core hue-5: Red (355¬∞) - Properties, tags */
    3345 +     46 +  --syntax-property: #fb7185; /* Coral rose for properties */
    3346 +     47 +  --syntax-tag: #f87171; /* Coral for tags */
    3347 +     48 +  --syntax-deleted: #f87171; /* For diff */
    3348 +     49 +  --syntax-important: #fb7185; /* For !important */
    3349 +     50 +
    3350 +     51 +  /* Core hue-6: Orange (29¬∞) - Class names, constants, numbers */
    3351 +     52 +  --syntax-class-name: #fb923c; /* Bright sunset orange for class names (Rectangle, Shape) */
    3352 +     53 +  --syntax-number: #fbbf24; /* Golden yellow for numbers */
    3353 +     54 +  --syntax-constant: #f97316; /* Burnt orange for constants */
    3354 +     55 +  --syntax-boolean: #fbbf24; /* Same as numbers */
    3355 +     56 +  --syntax-atrule: #fb923c; /* CSS @ rules */
    3356 +     57 +
    3357 +     58 +  /* Neutral colors */
    3358 +     59 +  --syntax-comment: #a8a29e; /* Muted for comments */
    3359 +     60 +  --syntax-punctuation: #d4d4d8; /* Light gray for punctuation */
    3360 +     61 +  --syntax-operator: #fdba74; /* Light sunset for operators */
    3361 +     62 +
    3362 +     63 +  /* Markup specific */
    3363 +     64 +  --syntax-attr-name: #fb923c; /* Orange like class-name */
    3364 +     65 +  --syntax-attr-value: #a3e635; /* Green like strings */
    3365 +     66 +  --syntax-namespace: #c084fc; /* Purple like keywords */
    3366 +     67 +  --syntax-entity: #d4d4d8; /* Neutral */
    3367 +     68 +  --syntax-selector: #fb7185; /* Red like properties */
    3368 + 40  69  
    3369 + 41  70    --blockquote-border: #f97316;
    3370 + 42  71    --blockquote-bg: #2d1b0e;
    3371 +@@ -44,4 +73,87 @@
    3372 + 44  73    --italic-color: #fb923c;
    3373 + 45  74    --table-header-bg: #3d2417;
    3374 + 46  75    --table-border: #7c2d12;
    3375 +     76 +
    3376 +     77 +  /* === MERMAID COMPREHENSIVE CONFIGURATION === */
    3377 +     78 +
    3378 +     79 +  /* Core Global */
    3379 +     80 +  --mermaid-background: #1c0a00;
    3380 +     81 +  --mermaid-text-color: #fed7aa;
    3381 +     82 +  --mermaid-line-color: #f97316;
    3382 +     83 +  --mermaid-main-bkg: #3d2417;
    3383 +     84 +
    3384 +     85 +  /* Primary Set */
    3385 +     86 +  --mermaid-primary-color: #3d2417;
    3386 +     87 +  --mermaid-primary-text-color: #fed7aa;
    3387 +     88 +  --mermaid-primary-border-color: #fb923c;
    3388 +     89 +
    3389 +     90 +  /* Secondary Set */
    3390 +     91 +  --mermaid-secondary-color: #2d1b0e;
    3391 +     92 +  --mermaid-secondary-text-color: #fed7aa;
    3392 +     93 +  --mermaid-secondary-border-color: #f97316;
    3393 +     94 +
    3394 +     95 +  /* Tertiary Set */
    3395 +     96 +  --mermaid-tertiary-color: #1c0a00;
    3396 +     97 +  --mermaid-tertiary-text-color: #fed7aa;
    3397 +     98 +  --mermaid-tertiary-border-color: #ea580c;
    3398 +     99 +
    3399 +    100 +  /* Flowchart */
    3400 +    101 +  --mermaid-node-border: #fb923c;
    3401 +    102 +  --mermaid-cluster-bkg: #2d1b0e;
    3402 +    103 +  --mermaid-cluster-border: #f97316;
    3403 +    104 +  --mermaid-default-link-color: #f97316;
    3404 +    105 +  --mermaid-title-color: #fed7aa;
    3405 +    106 +  --mermaid-edge-label-background: #1c0a00;
    3406 +    107 +  --mermaid-node-text-color: #fed7aa;
    3407 +    108 +
    3408 +    109 +  /* Sequence Diagram */
    3409 +    110 +  --mermaid-actor-bkg: #3d2417;
    3410 +    111 +  --mermaid-actor-border: #fb923c;
    3411 +    112 +  --mermaid-actor-text-color: #fed7aa;
    3412 +    113 +  --mermaid-actor-line-color: #fb923c;
    3413 +    114 +  --mermaid-signal-color: #f97316;
    3414 +    115 +  --mermaid-signal-text-color: #fed7aa;
    3415 +    116 +  --mermaid-label-box-bkg-color: #3d2417;
    3416 +    117 +  --mermaid-label-box-border-color: #fb923c;
    3417 +    118 +  --mermaid-label-text-color: #fed7aa;
    3418 +    119 +  --mermaid-loop-text-color: #fed7aa;
    3419 +    120 +  --mermaid-activation-border-color: #f97316;
    3420 +    121 +  --mermaid-activation-bkg-color: #2d1b0e;
    3421 +    122 +  --mermaid-sequence-number-color: #fed7aa;
    3422 +    123 +
    3423 +    124 +  /* Pie Chart */
    3424 +    125 +  --mermaid-pie1: #fb923c;
    3425 +    126 +  --mermaid-pie2: #f97316;
    3426 +    127 +  --mermaid-pie3: #ea580c;
    3427 +    128 +  --mermaid-pie4: #f87171;
    3428 +    129 +  --mermaid-pie5: #fb7185;
    3429 +    130 +  --mermaid-pie6: #f472b6;
    3430 +    131 +  --mermaid-pie7: #fdba74;
    3431 +    132 +  --mermaid-pie8: #5eead4;
    3432 +    133 +  --mermaid-pie9: #60a5fa;
    3433 +    134 +  --mermaid-pie10: #c084fc;
    3434 +    135 +  --mermaid-pie11: #a3e635;
    3435 +    136 +  --mermaid-pie12: #fbbf24;
    3436 +    137 +  --mermaid-pie-title-text-color: #fed7aa;
    3437 +    138 +  --mermaid-pie-section-text-color: #1c0a00; /* Dark on vibrant slices */
    3438 +    139 +  --mermaid-pie-legend-text-color: #fed7aa;
    3439 +    140 +  --mermaid-pie-stroke-color: #fb923c;
    3440 +    141 +  --mermaid-pie-outer-stroke-color: #fb923c;
    3441 +    142 +
    3442 +    143 +  /* State Diagram */
    3443 +    144 +  --mermaid-label-color: #fed7aa;
    3444 +    145 +  --mermaid-alt-background: #2d1b0e;
    3445 +    146 +
    3446 +    147 +  /* Class Diagram */
    3447 +    148 +  --mermaid-class-text: #fed7aa;
    3448 +    149 +
    3449 +    150 +  /* User Journey */
    3450 +    151 +  --mermaid-fill-type0: #fb923c;
    3451 +    152 +  --mermaid-fill-type1: #f97316;
    3452 +    153 +  --mermaid-fill-type2: #ea580c;
    3453 +    154 +  --mermaid-fill-type3: #f87171;
    3454 +    155 +  --mermaid-fill-type4: #fb7185;
    3455 +    156 +  --mermaid-fill-type5: #f472b6;
    3456 +    157 +  --mermaid-fill-type6: #fdba74;
    3457 +    158 +  --mermaid-fill-type7: #5eead4;
    3458 + 47 159  }
    3459 + 48 160  
    3460 +
    3461 +```
    3462 +
    3463 +
    3464 +### üìÑ `themes/sunset-light.css`
    3465 +
    3466 +**Type:** Stylesheet üé®
    3467 +
    3468 +```diff
    3469 +@@ -23,20 +23,49 @@
    3470 + 23  23    --code-block-bg: #ffedd5; /* Light orange background */
    3471 + 24  24    --code-border: #fdba74;
    3472 + 25  25  
    3473 + 26     -  /* Syntax Highlighting - Comprehensive Token Colors */
    3474 + 27     -  --syntax-keyword: #ea580c;
    3475 + 28     -  --syntax-string: #16a34a;
    3476 + 29     -  --syntax-number: #f59e0b;
    3477 + 30     -  --syntax-function: #dc2626;
    3478 + 31     -  --syntax-comment: #78716c;
    3479 + 32     -  --syntax-operator: #c2410c;
    3480 + 33     -  --syntax-punctuation: #57534e;
    3481 +     26 +  /* Syntax Highlighting - Production-Grade Token Colors (Based on One Dark Architecture) */
    3482 + 34  27  
    3483 + 35     -  /* Additional Token Types for Full Customization */
    3484 + 36     -  --syntax-variable: #ea580c; /* Variables - sunset orange */
    3485 + 37     -  --syntax-property: #dc2626; /* Properties - red */
    3486 + 38     -  --syntax-namespace: #f97316; /* Namespaces - bright orange */
    3487 + 39     -  --syntax-builtin: #dc2626; /* Builtins - red */
    3488 +     28 +  /* Core hue-1: Cyan (187¬∞) - URLs, special strings */
    3489 +     29 +  --syntax-url: #14b8a6; /* Teal/cyan for URLs */
    3490 +     30 +
    3491 +     31 +  /* Core hue-2: Blue (207¬∞) - Functions, variables, operators */
    3492 +     32 +  --syntax-function: #3b82f6; /* Bright blue for functions */
    3493 +     33 +  --syntax-variable: #0ea5e9; /* Sky blue for variables */
    3494 +     34 +
    3495 +     35 +  /* Core hue-3: Purple (286¬∞) - Keywords */
    3496 +     36 +  --syntax-keyword: #a855f7; /* Vibrant purple for keywords (if, final, sealed) */
    3497 +     37 +
    3498 +     38 +  /* Core hue-4: Green (95¬∞) - Strings, builtins, inserted */
    3499 +     39 +  --syntax-string: #10b981; /* Emerald green for strings */
    3500 +     40 +  --syntax-builtin: #059669; /* Darker green for builtins (String, List, Array) */
    3501 +     41 +  --syntax-char: #10b981; /* Same as strings */
    3502 +     42 +  --syntax-regex: #10b981; /* Same as strings */
    3503 +     43 +  --syntax-inserted: #10b981; /* For diff highlights */
    3504 +     44 +
    3505 +     45 +  /* Core hue-5: Red (355¬∞) - Properties, tags, deleted, important */
    3506 +     46 +  --syntax-property: #ef4444; /* Red for properties */
    3507 +     47 +  --syntax-tag: #ef4444; /* Red for HTML tags */
    3508 +     48 +  --syntax-deleted: #ef4444; /* For diff highlights */
    3509 +     49 +  --syntax-important: #ef4444; /* For !important */
    3510 +     50 +
    3511 +     51 +  /* Core hue-6: Orange (29¬∞) - Class names, constants, numbers, atrules */
    3512 +     52 +  --syntax-class-name: #f97316; /* Orange for class/type names (Rectangle, Shape) */
    3513 +     53 +  --syntax-number: #fb923c; /* Bright orange for numbers */
    3514 +     54 +  --syntax-constant: #ea580c; /* Burnt orange for constants */
    3515 +     55 +  --syntax-boolean: #fb923c; /* Same as numbers */
    3516 +     56 +  --syntax-atrule: #fb923c; /* CSS @ rules */
    3517 +     57 +
    3518 +     58 +  /* Neutral colors */
    3519 +     59 +  --syntax-comment: #a8a29e; /* Muted stone for comments */
    3520 +     60 +  --syntax-punctuation: #64748b; /* Slate for punctuation */
    3521 +     61 +  --syntax-operator: #fb7185; /* Coral rose for operators */
    3522 +     62 +
    3523 +     63 +  /* Markup specific */
    3524 +     64 +  --syntax-attr-name: #f97316; /* Orange like class-name */
    3525 +     65 +  --syntax-attr-value: #10b981; /* Green like strings */
    3526 +     66 +  --syntax-namespace: #a855f7; /* Purple like keywords */
    3527 +     67 +  --syntax-entity: #64748b; /* Neutral */
    3528 +     68 +  --syntax-selector: #ef4444; /* Red like properties */
    3529 + 40  69  
    3530 + 41  70    --blockquote-border: #f97316;
    3531 + 42  71    --blockquote-bg: #ffedd5;
    3532 +@@ -44,4 +73,87 @@
    3533 + 44  73    --italic-color: #e11d48;
    3534 + 45  74    --table-header-bg: #fed7aa;
    3535 + 46  75    --table-border: #fdba74;
    3536 +     76 +
    3537 +     77 +  /* === MERMAID COMPREHENSIVE CONFIGURATION === */
    3538 +     78 +
    3539 +     79 +  /* Core Global */
    3540 +     80 +  --mermaid-background: #fff7ed;
    3541 +     81 +  --mermaid-text-color: #431407;
    3542 +     82 +  --mermaid-line-color: #f97316;
    3543 +     83 +  --mermaid-main-bkg: #fed7aa;
    3544 +     84 +
    3545 +     85 +  /* Primary Set */
    3546 +     86 +  --mermaid-primary-color: #fed7aa;
    3547 +     87 +  --mermaid-primary-text-color: #431407;
    3548 +     88 +  --mermaid-primary-border-color: #ea580c;
    3549 +     89 +
    3550 +     90 +  /* Secondary Set */
    3551 +     91 +  --mermaid-secondary-color: #ffedd5;
    3552 +     92 +  --mermaid-secondary-text-color: #431407;
    3553 +     93 +  --mermaid-secondary-border-color: #f97316;
    3554 +     94 +
    3555 +     95 +  /* Tertiary Set */
    3556 +     96 +  --mermaid-tertiary-color: #fff7ed;
    3557 +     97 +  --mermaid-tertiary-text-color: #431407;
    3558 +     98 +  --mermaid-tertiary-border-color: #fb923c;
    3559 +     99 +
    3560 +    100 +  /* Flowchart */
    3561 +    101 +  --mermaid-node-border: #ea580c;
    3562 +    102 +  --mermaid-cluster-bkg: #ffedd5;
    3563 +    103 +  --mermaid-cluster-border: #f97316;
    3564 +    104 +  --mermaid-default-link-color: #f97316;
    3565 +    105 +  --mermaid-title-color: #431407;
    3566 +    106 +  --mermaid-edge-label-background: #fff7ed;
    3567 +    107 +  --mermaid-node-text-color: #431407;
    3568 +    108 +
    3569 +    109 +  /* Sequence Diagram */
    3570 +    110 +  --mermaid-actor-bkg: #fed7aa;
    3571 +    111 +  --mermaid-actor-border: #ea580c;
    3572 +    112 +  --mermaid-actor-text-color: #431407;
    3573 +    113 +  --mermaid-actor-line-color: #ea580c;
    3574 +    114 +  --mermaid-signal-color: #f97316;
    3575 +    115 +  --mermaid-signal-text-color: #431407;
    3576 +    116 +  --mermaid-label-box-bkg-color: #fed7aa;
    3577 +    117 +  --mermaid-label-box-border-color: #ea580c;
    3578 +    118 +  --mermaid-label-text-color: #431407;
    3579 +    119 +  --mermaid-loop-text-color: #431407;
    3580 +    120 +  --mermaid-activation-border-color: #f97316;
    3581 +    121 +  --mermaid-activation-bkg-color: #ffedd5;
    3582 +    122 +  --mermaid-sequence-number-color: #431407;
    3583 +    123 +
    3584 +    124 +  /* Pie Chart */
    3585 +    125 +  --mermaid-pie1: #ea580c;
    3586 +    126 +  --mermaid-pie2: #f97316;
    3587 +    127 +  --mermaid-pie3: #fb923c;
    3588 +    128 +  --mermaid-pie4: #dc2626;
    3589 +    129 +  --mermaid-pie5: #e11d48;
    3590 +    130 +  --mermaid-pie6: #db2777;
    3591 +    131 +  --mermaid-pie7: #c2410c;
    3592 +    132 +  --mermaid-pie8: #14b8a6;
    3593 +    133 +  --mermaid-pie9: #3b82f6;
    3594 +    134 +  --mermaid-pie10: #a855f7;
    3595 +    135 +  --mermaid-pie11: #ef4444;
    3596 +    136 +  --mermaid-pie12: #10b981;
    3597 +    137 +  --mermaid-pie-title-text-color: #431407;
    3598 +    138 +  --mermaid-pie-section-text-color: #fff7ed; /* Light on vibrant slices */
    3599 +    139 +  --mermaid-pie-legend-text-color: #431407;
    3600 +    140 +  --mermaid-pie-stroke-color: #ea580c;
    3601 +    141 +  --mermaid-pie-outer-stroke-color: #ea580c;
    3602 +    142 +
    3603 +    143 +  /* State Diagram */
    3604 +    144 +  --mermaid-label-color: #431407;
    3605 +    145 +  --mermaid-alt-background: #ffedd5;
    3606 +    146 +
    3607 +    147 +  /* Class Diagram */
    3608 +    148 +  --mermaid-class-text: #431407;
    3609 +    149 +
    3610 +    150 +  /* User Journey */
    3611 +    151 +  --mermaid-fill-type0: #ea580c;
    3612 +    152 +  --mermaid-fill-type1: #f97316;
    3613 +    153 +  --mermaid-fill-type2: #fb923c;
    3614 +    154 +  --mermaid-fill-type3: #dc2626;
    3615 +    155 +  --mermaid-fill-type4: #e11d48;
    3616 +    156 +  --mermaid-fill-type5: #db2777;
    3617 +    157 +  --mermaid-fill-type6: #c2410c;
    3618 +    158 +  --mermaid-fill-type7: #14b8a6;
    3619 + 47 159  }
    3620 + 48 160  
379 3621  
380 3622  ```
381 3623  
@@ -421,4 +3663,4 @@ Please provide specific feedback on:
421 3663  
422 3664  ---
423 3665  *Generated by AI Visual Code Review v2.0 - Unified Export Script*
424     -*Files processed: 3/3 | Errors: 0 | Generated: 2025-12-07T02:57:20.361Z*
    3666 +*Files processed: 18/18 | Errors: 0 | Generated: 2025-12-07T04:29:24.609Z*
425 3667  

```


### ‚ú® `codebase_audit/audit_summary.md` **[ADDED]**

**Status:** ‚úÖ **NEW FILE** - This file has been newly created

**Type:** Documentation üìñ

```diff
@@ -0,0 +1,49 @@
      1 +# üìä Codebase Audit Summary
      2 +
      3 +**Date:** 2025-12-09
      4 +**Auditor:** CodeBaseGPT
      5 +**Repository:** `markdown-viewer-app`
      6 +
      7 +---
      8 +
      9 +## üèÅ Executive Summary
     10 +
     11 +The `markdown-viewer-app` is a **Client-Side SPA** built with **Vanilla JavaScript**. It has a solid modular foundation (`Services` directory) but suffers from "Controller Bloat" in `script.js`.
     12 +
     13 +**Health Score:** üü° **C+ (Needs Attention)**
     14 +
     15 +- **Architecture:** ‚≠ê‚≠ê‚≠ê (3/5) - Good service separation, but monolithic controller.
     16 +- **Security:** ‚≠ê (1/5) - **CRITICAL** Stored XSS vulnerability detected.
     17 +- **Code Quality:** ‚≠ê‚≠ê‚≠ê (3/5) - Human-readable, but prone to race conditions.
     18 +- **Documentation:** ‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê (5/5) - Excellent, comprehensive documentation.
     19 +
     20 +---
     21 +
     22 +## üìÇ Audit Artifacts
     23 +
     24 +1.  **[Repo Manifest](./repo_manifest.json)** - Full inventory of files.
     25 +2.  **[Consolidated Findings](./phase4_consolidated_findings.md)** - High-level issue list.
     26 +3.  **[Implementation Plan](./phase4_implementation_plan.md)** - Step-by-step roadmap.
     27 +4.  **[Detailed Roadmap](./phase5_recommendations.md)** - Strategic recommendations.
     28 +
     29 +### üî¨ Deep Dive Reviews
     30 +*   **[script.js Review](./deep_dive_reviews/script_js_review.md)** (Critical Issues)
     31 +*   **[ThemeManager.js Review](./deep_dive_reviews/theme_manager_review.md)** (Performance Notes)
     32 +*   **[MermaidService.js Review](./deep_dive_reviews/mermaid_service_review.md)** (Coupling Notes)
     33 +
     34 +---
     35 +
     36 +## üõë Top 3 Priorities
     37 +
     38 +1.  **üî• FIX:** Install `dompurify` and sanitize Markdown rendering immediately.
     39 +2.  **üèóÔ∏è REFACTOR:** Break `script.js` into `UIManager`, `EventManager`, and `AppController`.
     40 +3.  **üêõ BUG:** Replace `setTimeout` callbacks with `Promise` chains for robust rendering.
     41 +
     42 +---
     43 +
     44 +## üìù Next Steps
     45 +
     46 +Ready to begin **Phase 1 of Remediation**:
     47 +> Executing `npm install dompurify` and patching `script.js` to fix the XSS vulnerability.
     48 +
     49 +**Proceed?**
     50  

```


### ‚ú® `codebase_audit/deep_dive_reviews/mermaid_service_review.md` **[ADDED]**

**Status:** ‚úÖ **NEW FILE** - This file has been newly created

**Type:** Documentation üìñ

```diff
@@ -0,0 +1,47 @@
      1 +# üïµÔ∏è‚Äç‚ôÇÔ∏è Deep Dive Code Review: `MermaidService.js`
      2 +
      3 +**Reviewer:** CodeBaseGPT (Senior SDE Persona)
      4 +**Date:** 2025-12-09
      5 +**File:** `src/js/services/MermaidService.js` (302 Lines)
      6 +
      7 +---
      8 +
      9 +## ‚ö†Ô∏è Issues & Observations
     10 +
     11 +### 1. ‚öôÔ∏è Massive Configuration Object (Line 96)
     12 +```javascript
     13 +themeVariables: { ... 100+ lines ... }
     14 +```
     15 +**Critique:** You are explicitly mapping every single Mermaid variable (60+) to your own CSS variables.
     16 +- **Pros:** Total control over the look.
     17 +- **Cons:** **High Coupling**. If Mermaid v12 changes its variable names (e.g., `primaryColor` -> `mainColor`), your integration breaks or looks wrong.
     18 +- **Suggestion:** Consider whether mapped sets (Primary, Secondary, Tertiary) are sufficient, or if this granular control is truly business-critical.
     19 +
     20 +### 2. üî¢ Hardcoded Font configurations (Lines 99, 100)
     21 +```javascript
     22 +fontFamily: '-apple-system, ...',
     23 +fontSize: '16px',
     24 +```
     25 +**Critique:** You are hardcoding fonts in JS.
     26 +- **Issue:** If the user changes the font in `style.css`, the diagrams won't match the rest of the app.
     27 +- **Fix:** Use `getCssVariable('--font-family')` and `getCssVariable('--font-size-base')`.
     28 +
     29 +### 3. üìâ Missing Debounce/Cancellation
     30 +**Critique:** `MermaidService.render` is async.
     31 +- **Scenario:** User types fast. `render('id', 'graph TD...')` is called 5 times in 200ms.
     32 +- **Result:** You might have 5 parallel rendering processes competing.
     33 +- **Fix:** Implement a `Cancellation` mechanism or rely on the Controller to debounce calls (which `script.js` currently fails to do properly).
     34 +
     35 +### 4. üé≠ Theme Detection Logic (Line 45)
     36 +```javascript
     37 +function isLightTheme(bgColor) { ... }
     38 +```
     39 +**Critique:** Clever use of luminance calculation!
     40 +- **Positive:** This is a nice "Senior Dev" touch. It ensures that even if I pick a weird Custom Theme color (e.g., bright yellow background), Mermaid will likely pick the correct "Dark/Light" base mode.
     41 +- **Refactor:** Move `getRelativeLuminance` to `src/js/utils/colorHelpers.js`. It is a pure utility function and might be useful elsewhere (e.g., checking text contrast accessibility).
     42 +
     43 +---
     44 +
     45 +## üèÅ Verdict
     46 +**Grade: B+**
     47 +The logic is solid, but the coupling to Mermaid's specific variable names is a risk. It's "Enterprise Grade" in the sense that it handles everything, but "Enterprise Grade" also means "Heavy maintenance".
     48  

```


### ‚ú® `codebase_audit/deep_dive_reviews/script_js_review.md` **[ADDED]**

**Status:** ‚úÖ **NEW FILE** - This file has been newly created

**Type:** Documentation üìñ

```diff
@@ -0,0 +1,121 @@
      1 +# üïµÔ∏è‚Äç‚ôÇÔ∏è Deep Dive Code Review: `script.js`
      2 +
      3 +**Reviewer:** CodeBaseGPT (Senior SDE Persona)
      4 +**Date:** 2025-12-09
      5 +**File:** `script.js` (1372 Lines)
      6 +
      7 +---
      8 +
      9 +## üõë Critical Issues (Must Fix)
     10 +
     11 +### 1. üíÄ Stored XSS Vulnerability (Line 512)
     12 +```javascript
     13 +preview.innerHTML = html;
     14 +```
     15 +**Critique:** You are taking the output of `marked.parse()` and dumping it directly into the DOM. `marked` does **not** sanitize HTML execution by default.
     16 +- **Scenario:** A user opens a markdown file containing `<img src=x onerror=alert(1)>`.
     17 +- ** Impact:** Arbitrary code execution.
     18 +- **Fix:** You **MUST** use `DOMPurify.sanitize(html)` before assignment.
     19 +
     20 +### 2. üê¢ recursive Polling for Dependencies (Lines 46-75)
     21 +```javascript
     22 +if (typeof marked === 'undefined' ...) {
     23 +    setTimeout(initializeApp, 100);
     24 +    return;
     25 +}
     26 +```
     27 +**Critique:** This "check and retry" pattern is an anti-pattern.
     28 +- **Why:** It burns CPU in a tight loop. It complicates the startup race conditions.
     29 +- **Fix:** Use standard `<script defer>` or ES Module `import` statements to guarantee execution order. If you strictly need globals, use `window.onload`.
     30 +
     31 +### 3. üí• Race Condition "Magic Numbers" (Lines 490, 535)
     32 +```javascript
     33 +// Line 490
     34 +setTimeout(() => { ... mermaid.render(...) }, 100);
     35 +
     36 +// Line 535
     37 +setTimeout(() => { ... renderMarkdown() }, 100);
     38 +```
     39 +**Critique:** You are using `setTimeout` with a magic number (`100ms`) to "wait" for the DOM or other processes.
     40 +- **Why:** This is unreliable. On a slow machine, 100ms isn't enough, and the render fails. On a fast machine, it causes a perceptible UI stutter.
     41 +- **Fix:** Use **Promises** and `requestAnimationFrame`. `mermaid.render` returns a promise; await it.
     42 +
     43 +### 4. üî• Un-Debounced Rendering (Line 666)
     44 +```javascript
     45 +editor.addEventListener('input', renderMarkdown);
     46 +```
     47 +**Critique:** `renderMarkdown` is heavy (Regex + Parsing + DOM clear + Prism + Mermaid).
     48 +- **Why:** Triggers on *every keystroke*. Typing fast will freeze the UI.
     49 +- **Fix:** Wrap the handler in a `debounce` function (e.g., wait 300ms after last keystroke).
     50 +
     51 +---
     52 +
     53 +## ‚ö†Ô∏è Major Logic Flaws & Architecture
     54 +
     55 +### 5. üèóÔ∏è The "God Function": `setupEditor` (Lines 295-1372)
     56 +**Critique:** This function is **1077 lines long**.
     57 +- **Issue:** It contains state (`folderFiles`), event listeners, UI logic (`updatePDFPreview`), and utility helpers (`renderFileTree`).
     58 +- **Impact:** It is effectively impossible to unit test. Scope pollution is rampant.
     59 +- **Fix:** Break this file apart immediately.
     60 +    - `setupEditor()` should only orchestrate.
     61 +    - `setupPDFHandling()` should be its own module.
     62 +    - `setupFolderBrowser()` should be its own module.
     63 +
     64 +### 6. üçù Spaghetti Events (Global Scope Pollution)
     65 +```javascript
     66 +let globalRenderMarkdown = null; // Line 24
     67 +...
     68 +globalRenderMarkdown = renderMarkdown; // Line 1367
     69 +```
     70 +**Critique:** You are leaking a local function to the global scope to hack around scope limitations for the theme manager callback.
     71 +- **Fix:** Pass `renderMarkdown` as a dependency or use a proper `EventManager` (Pub/Sub pattern).
     72 +
     73 +### 7. üìÅ Hardcoded DOM Generation (Lines 1241-1334)
     74 +**Critique:** The `renderFileTree` function essentially constructs a Virtual DOM manually using `document.createElement`.
     75 +- **Issue:** This logic is mixed with the controller.
     76 +- **Fix:** Move this to a `FileTreeView.js` class. The controller should just say `treeView.render(files)`.
     77 +
     78 +---
     79 +
     80 +## üîç Nitpicks & Code Style (Senior SDE Standards)
     81 +
     82 +### 8. üìù Hardcoded Content (Lines 297-381)
     83 +**Critique:** The default "Welcome" markdown is 84 lines of hardcoded string inside a logic file.
     84 +- **Fix:** Move to `src/js/config/defaultContent.js` or load from a file.
     85 +
     86 +### 9. üé® CSS Variable Extraction (Line 553)
     87 +```javascript
     88 +const currentValue = getComputedStyle(document.documentElement).getPropertyValue(varName).trim();
     89 +```
     90 +**Critique:** You are calling `getComputedStyle` inside a loop (`forEach` on Line 550).
     91 +- **Impact:** This forces a **Style Recalculation** (Reflow) on every iteration. Expensive.
     92 +- **Fix:** Cache `getComputedStyle` once outside the loop.
     93 +
     94 +### 10. ‚ùå Regex ReDoS Potential (Lines 111, 485)
     95 +```javascript
     96 +// Line 485
     97 +html = html.replace(/<pre><code class="language-mermaid">([\s\S]*?)<\/code><\/pre>/g, ...
     98 +```
     99 +**Critique:** `[\s\S]*?` is generally safe-ish, but processing the entire HTML output with regex to find code blocks is fragile HTML parsing.
    100 +- **Fix:** Marked.js has a `renderer` option. Override the `code` renderer instead of string-replacing the output HTML. This is much cleaner and safer.
    101 +
    102 +### 11. üß© Mixed 'var' and 'let' (Lines 884-885)
    103 +```javascript
    104 +var syncScrollEnabled = ...
    105 +var syncScrolling = ...
    106 +```
    107 +**Critique:** Why `var`? You used `const/let` everywhere else.
    108 +- **Fix:** Be consistent. Use `let`.
    109 +
    110 +### 12. üêõ Error Handling in `loadTheme` (Line 1008)
    111 +```javascript
    112 +.catch(err => {
    113 +  console.error('Failed to load saved theme:', err);
    114 +  // Fallback to default-light
    115 +```
    116 +**Critique:** Good fallback logic, but `alert()` or `toast` missing. User won't know why their theme didn't load.
    117 +
    118 +---
    119 +
    120 +## ‚úÖ Summary
    121 +The code works "happy path" but is brittle. The usage of `setTimeout` for flow control and the lack of debouncing are the biggest "Senior SDE" red flags. The Security hole (XSS) is a blocker for any production release.
    122  

```


### ‚ú® `codebase_audit/deep_dive_reviews/theme_manager_review.md` **[ADDED]**

**Status:** ‚úÖ **NEW FILE** - This file has been newly created

**Type:** Documentation üìñ

```diff
@@ -0,0 +1,53 @@
      1 +# üïµÔ∏è‚Äç‚ôÇÔ∏è Deep Dive Code Review: `ThemeManager.js`
      2 +
      3 +**Reviewer:** CodeBaseGPT (Senior SDE Persona)
      4 +**Date:** 2025-12-09
      5 +**File:** `src/js/core/ThemeManager.js` (263 Lines)
      6 +
      7 +---
      8 +
      9 +## üü¢ strengths
     10 +*   **SOLID Principles:** Class has a clear Single Responsibility.
     11 +*   **Error Handling:** `try...catch` blocks are present in `loadBuiltInTheme` and `loadCustomTheme`.
     12 +*   **JSDoc:** Excellent documentation and usage examples.
     13 +
     14 +## ‚ö†Ô∏è Issues & Observations
     15 +
     16 +### 1. üêå Performance: `clearInlineStyles` (Line 205)
     17 +```javascript
     18 +for (let i = styles.length - 1; i >= 0; i--) {
     19 +  const prop = styles[i];
     20 +  if (prop.startsWith('--')) {
     21 +    removeCssVariable(prop);
     22 +  }
     23 +}
     24 +```
     25 +**Critique:** This loop calls `removeProperty` repeatedly on the root element.
     26 +- **Impact:** Each removal can trigger a Style Recalculation (Reflow) in the browser engine.
     27 +- **Optimization:** If you only use inline styles for custom themes, you could simply clear the `style` attribute: `document.documentElement.removeAttribute('style');` (unless there are other non-theme inline styles needed).
     28 +
     29 +### 2. üß© Hardcoded Variable List (Line 171)
     30 +```javascript
     31 +const cssVarNames = [ '--bg-primary', ... ];
     32 +```
     33 +**Critique:** You manually list 18 variables here to "capture" the current theme colors.
     34 +- **Risk:** This list is a **Maintenance Liability**. If a developer adds a new color (e.g., `--warning-color`) to `style.css` but forgets to add it here, the "Save Custom Theme" feature will silently drop that color.
     35 +- **Fix:** Import this list from `src/js/config/constants.js` (SSOT). Do not define it inside the method.
     36 +
     37 +### 3. üß™ Production Path Resolution (Line 80)
     38 +```javascript
     39 +const baseUrl = import.meta.env.BASE_URL || '/';
     40 +stylesheet.href = `${baseUrl}themes/${themeName}.css`;
     41 +```
     42 +**Critique:** Good job anticipating Vite's `BASE_URL`.
     43 +- **Observation:** Ensure `themes/` folder is actually copied to `dist/` during build. Since they are static assets referenced via code (not import), Vite might not hash/include them unless configured in `vite.config.js` static assets.
     44 +
     45 +### 4. üîí Private Methods (Semantics)
     46 +**Critique:** You use JSDoc `@private` but the methods `loadBuiltInTheme` are technically public.
     47 +- **Suggestion:** Use `#privateFields` (ES2022) if you want true privacy, e.g., `#loadBuiltInTheme`.
     48 +
     49 +---
     50 +
     51 +## üèÅ Verdict
     52 +**Grade: A-**
     53 +This is high-quality code. The issues are mostly maintenance optimizations. The logic is sound.
     54  

```


### ‚ú® `codebase_audit/docs_summary.json` **[ADDED]**

**Status:** ‚úÖ **NEW FILE** - This file has been newly created

**Type:** Configuration/Data File üìã

```diff
@@ -0,0 +1,12 @@
      1 +{
      2 +  "hld": "The application follows a client-side monolithic architecture with pure vanilla JavaScript, CSS variables for theming, and no backend. It uses a \"Service Layer\" pattern to isolate business logic (Mermaid, Prism) from UI, and an \"Observer Pattern\" for theme changes. Data is persisted solely via browser `localStorage`. Security relies on client-side sanitization (Marked.js) and no external data transmission.",
      3 +  "lld": "The codebase is organized into modular layers: `UI` (HTML), `Application` (script.js controller), `Core` (StorageManager, ThemeManager), `Services` (MermaidService, PrismService), and `Utils` (HTML/Color helpers). The `ThemeManager` handles 12 built-in themes + custom themes using CSS variables. `MermaidService` and `PrismService` wrap external libraries with lazy initialization and error handling. `script.js` acts as the entry point, treating other modules as injected dependencies.",
      4 +  "other": {
      5 +    "folder-browser-plan": "Plan to add a file system sidebar using the File System Access API for local folder navigation.",
      6 +    "math-rendering-plan": "Proposal to integrate KaTeX for LaTeX math rendering ($ and $$ syntax) via marked extension.",
      7 +    "pdf-export-plan": "Design to add PDF export using html2pdf.js, preserving styles and Mermaid diagrams.",
      8 +    "implementation-plan": "6-week refactoring roadmap moving from monolithic script.js to modular ES modules structure (currently in progress/partially complete).",
      9 +    "deployment-guide": "Documentation for deploying to Vercel, Netlify, or GitHub Pages as a static site.",
     10 +    "ai-review": "Recent automated code review log highlighting fixes for theme dropdown sync and architecture documentation additions."
     11 +  }
     12 +}
     13  

```


### ‚ú® `codebase_audit/future_enhancements_roadmap.md` **[ADDED]**

**Status:** ‚úÖ **NEW FILE** - This file has been newly created

**Type:** Documentation üìñ

```diff
@@ -0,0 +1,87 @@
      1 +# üöÄ Future Enhancements: Enterprise-Grade Roadmap
      2 +
      3 +This document outlines the strategic roadmap to transform the `markdown-viewer-app` into a truly **Enterprise-Grade** web application.
      4 +
      5 +---
      6 +
      7 +## üèóÔ∏è Phase 1: Robust Application Architecture (Modernization)
      8 +
      9 +To support enterprise scale, we must move beyond the "Vanilla JS" constraints suitable for prototypes and adopt a robust, type-safe ecosystem.
     10 +
     11 +### 1.1 Migrate to TypeScript
     12 +*   **Why:** Enterprise apps require type safety to prevent runtime errors (undefined is not ...).
     13 +*   **Plan:** Rename `.js` to `.ts`. Define interfaces for `Theme`, `FileNode`, and `AppConfig`. Strict null checks.
     14 +
     15 +### 1.2 Component-Based Architecture (Web Components or Framework)
     16 +*   **Why:** The `script.js` monolith is unmaintainable.
     17 +*   **Plan:**
     18 +    *   **Option A (Vanilla):** Adopt Web Components (`<markdown-editor>`, `<file-tree>`).
     19 +    *   **Option B (Standard):** Migrate to **React** or **Vue**. This allows us to use massive ecosystems of tested components (e.g., `Monaco Editor` for better markdown editing).
     20 +
     21 +### 1.3 State Management
     22 +*   **Why:** Passing `globalRenderMarkdown` around is fragile.
     23 +*   **Plan:** Implement a centralized store (e.g., `Redux`, `Zustand`, or a simple `StateService` observable) to manage:
     24 +    *   `currentFile`
     25 +    *   `theme`
     26 +    *   `settings`
     27 +    *   `folderStructure`
     28 +
     29 +---
     30 +
     31 +## üõ°Ô∏è Phase 2: Enterprise Security & Compliance
     32 +
     33 +### 2.1 Content Security Policy (CSP)
     34 +*   **Goal:** Prevent XSS and Data Exfiltration.
     35 +*   **Action:** implement strict CSP headers (or `<meta>` tags):
     36 +    ```html
     37 +    <meta http-equiv="Content-Security-Policy" content="default-src 'self'; script-src 'self' 'unsafe-eval' (for mermaid); style-src 'self' 'unsafe-inline';">
     38 +    ```
     39 +
     40 +### 2.2 Input Sanitization Layer
     41 +*   **Goal:** trust No Input.
     42 +*   **Action:** Integrate `DOMPurify` deeply into the rendering pipeline. Create a `SanitizationService` that all HTML output must pass through.
     43 +
     44 +---
     45 +
     46 +## ‚ö° Phase 3: Performance & Scalability
     47 +
     48 +### 3.1 Web Workers for Parsing
     49 +*   **Issue:** Parsing large markdown files (1000+ lines) freezes the UI.
     50 +*   **Solution:** Move `marked.parse` and syntax highlighting logic to a **Web Worker**. The main thread should only handle User Input and DOM updates.
     51 +
     52 +### 3.2 Virtualized Rendering
     53 +*   **Issue:** The File Browser and Large Preview will lag with thousands of items.
     54 +*   **Solution:** Implement "Virtual Scrolling" (Windowing). Only render the DOM nodes currently visible on screen.
     55 +
     56 +### 3.3 Offline-First (PWA)
     57 +*   **Goal:** Native-like reliability.
     58 +*   **Action:**
     59 +    *   Add a Service Worker to cache App Shell and Assets (Fonts, CSS).
     60 +    *   Use `IndexedDB` instead of `localStorage` for saving files (allows saving images/blobs).
     61 +
     62 +---
     63 +
     64 +## üß© Phase 4: Advanced Features (The "Wow" Factor)
     65 +
     66 +### 4.1 Collaborative Editing (Real-Time)
     67 +*   **Tech:** `Yjs` or `Automerge` (CRDTs).
     68 +*   **Feature:** Allow two users to edit the same doc via WebRTC (local peer-to-peer) without a central server.
     69 +
     70 +### 4.2 Semantic Search (AI)
     71 +*   **Start:** Implement client-side full-text search (FlexSearch).
     72 +*   **Upgrade:** Use a local LLM or Embedding model (via WebGPU) to allow "Chat with my Docs".
     73 +
     74 +### 4.3 Plugin System
     75 +*   **Architecture:** Allow users to write JavaScript "plugins" to extend functionality (e.g., a "Date Picker" markdown extension).
     76 +*   **Security:** Run plugins in a Sandboxed Iframe.
     77 +
     78 +---
     79 +
     80 +## üìà Roadmap Estimate
     81 +
     82 +| Feature | Complexity | Impact | Timeline |
     83 +|---------|------------|--------|----------|
     84 +| **TS Migration** | Medium | High | Q1 |
     85 +| **PWA / Offline** | Low | High | Q1 |
     86 +| **Web Workers** | High | Medium | Q2 |
     87 +| **Collaboration**| Very High| High | Q3 |
     88  

```


### ‚ú® `codebase_audit/phase3_codebase_review.json` **[ADDED]**

**Status:** ‚úÖ **NEW FILE** - This file has been newly created

**Type:** Configuration/Data File üìã

```diff
@@ -0,0 +1,68 @@
      1 +{
      2 +  "phase": "3 - Codebase Review",
      3 +  "status": "COMPLETED",
      4 +  "findings": {
      5 +    "security": [
      6 +      {
      7 +        "severity": "CRITICAL",
      8 +        "type": "Stored XSS",
      9 +        "location": "script.js:512",
     10 +        "description": "Marked.js output is assigned to innerHTML without sanitization. DOMPurify is missing from dependencies.",
     11 +        "remediation": "Install dompurify and sanitize 'html' variable before assignment."
     12 +      },
     13 +      {
     14 +        "severity": "LOW",
     15 +        "type": "Data Privacy",
     16 +        "location": "script.js:522",
     17 +        "description": "User content stored in localStorage unencrypted. Acceptable for MVP but should be noted.",
     18 +        "remediation": "Add warning or option to disable local storage persistence."
     19 +      }
     20 +    ],
     21 +    "architecture": [
     22 +      {
     23 +        "severity": "HIGH",
     24 +        "type": "Monolithic Controller",
     25 +        "location": "script.js",
     26 +        "description": "script.js is over 1300 lines and handles UI, logic, and service orchestration. Needs splitting.",
     27 +        "remediation": "Extract UI logic into UIManager.js and EventManager.js."
     28 +      },
     29 +      {
     30 +        "severity": "MEDIUM",
     31 +        "type": "Race Condition",
     32 +        "location": "script.js:490,535",
     33 +        "description": "Reliance on setTimeout magic numbers (100ms) for synchronization between Theme loading and Mermaid rendering.",
     34 +        "remediation": "Implement proper Promise-based initialization chain."
     35 +      },
     36 +      {
     37 +        "severity": "LOW",
     38 +        "type": "Mixed Dependency Management",
     39 +        "location": "index.html / package.json",
     40 +        "description": "Project uses NPM for dev tools but CDNs for runtime libraries (marked, plotly, etc.). Hard to version control runtime deps.",
     41 +        "remediation": "Migrate runtime dependencies to NPM and bundle with Vite."
     42 +      }
     43 +    ],
     44 +    "code_quality": [
     45 +      {
     46 +        "severity": "MEDIUM",
     47 +        "type": "Redundant Logic",
     48 +        "location": "script.js:1241",
     49 +        "description": "DOM generation for File Browser is hardcoded in script.js instead of being in FolderBrowserService or a View component.",
     50 +        "remediation": "Move renderFileTree logic to a dedicated UI component."
     51 +      },
     52 +      {
     53 +        "severity": "LOW",
     54 +        "type": "Hardcoded Config",
     55 +        "location": "script.js",
     56 +        "description": "Some configuration values (sidebar width limits) are hardcoded in script.js, duplicating constants potential.",
     57 +        "remediation": "Move all magic numbers to src/js/config/constants.js."
     58 +      }
     59 +    ]
     60 +  },
     61 +  "metrics": {
     62 +    "files_reviewed": 18,
     63 +    "lines_of_code": "~3000",
     64 +    "critical_issues": 1,
     65 +    "high_issues": 1,
     66 +    "medium_issues": 2
     67 +  }
     68 +}
     69  

```


### ‚ú® `codebase_audit/phase4_consolidated_findings.md` **[ADDED]**

**Status:** ‚úÖ **NEW FILE** - This file has been newly created

**Type:** Documentation üìñ

```diff
@@ -0,0 +1,31 @@
      1 +# üß© Phase 4: Consolidated Findings
      2 +
      3 +This document consolidates all findings from the Codebase Review (Phase 3) and Documentation Review (Phase 2), grouped by category.
      4 +
      5 +## 1. Security Findings
      6 +| ID | Severity | Issue | Location |
      7 +|----|----------|-------|----------|
      8 +| SEC-01 | **CRITICAL** | **Stored XSS Vulnerability**<br>Markdown renders directly to `innerHTML` without sanitization. | `script.js:512` |
      9 +| SEC-02 | LOW | **Unencrypted Local Storage**<br>User content persists in plain text in browser storage. | `StorageManager.js` |
     10 +| SEC-03 | LOW | **External CDN Dependency**<br>Runtime libraries loaded from third-party CDNs (jsdelivr/cdnjs). | `index.html` |
     11 +
     12 +## 2. Architecture & Design
     13 +| ID | Severity | Issue | Location |
     14 +|----|----------|-------|----------|
     15 +| ARC-01 | **HIGH** | **Monolithic Controller**<br>`script.js` (1300+ lines) violates Single Responsibility Principle. | `script.js` |
     16 +| ARC-02 | MEDIUM | **Tight Coupling**<br>`script.js` directly manipulates DOM, manages state, and calls services. | `script.js` |
     17 +| ARC-03 | MEDIUM | **Race Conditions**<br>Reliance on `setTimeout` for synchronization between themes/Mermaid. | `script.js:490` |
     18 +| ARC-04 | LOW | **Hardcoded Configuration**<br>Magic numbers (sidebar width, zoom limits) found in logic. | `script.js` |
     19 +
     20 +## 3. Code Quality & Maintenance
     21 +| ID | Severity | Issue | Location |
     22 +|----|----------|-------|----------|
     23 +| COD-01 | MEDIUM | **No Type Safety**<br>Pure JavaScript used; logic errors (e.g. string vs number) possible. | All Files |
     24 +| COD-02 | LOW | **Incomplete Tests**<br>Tests exist but coverage for UI interactions is manual. | `tests/` |
     25 +| COD-03 | LOW | **Redundant Logic**<br>DOM generation for File Browse tree is inline, not reusable. | `script.js:1241` |
     26 +
     27 +## 4. Documentation Gaps
     28 +| ID | Severity | Issue | Location |
     29 +|----|----------|-------|----------|
     30 +| DOC-01 | LOW | **Stack Mismatch**<br>README mentions Java/Python support (likely meant highlighting), implying backend. | `README.md` |
     31 +| DOC-02 | LOW | **Install Instructions**<br>No "Install" section for local dev beyond "Open index.html". | `README.md` |
     32  

```


### ‚ú® `codebase_audit/phase4_implementation_plan.md` **[ADDED]**

**Status:** ‚úÖ **NEW FILE** - This file has been newly created

**Type:** Documentation üìñ

```diff
@@ -0,0 +1,71 @@
      1 +# üõ°Ô∏è Audit Phase 4: Consolidation & Implementation Plan
      2 +
      3 +## üö® Critical Priority (Immediate Action Required)
      4 +
      5 +### 1. Fix Stored XSS Vulnerability
      6 +- **Severity:** Critical
      7 +- **Location:** `script.js` (Line 512)
      8 +- **Issue:** Markdown is parsed and injected directly into `innerHTML` without sanitization. Malicious markdown files can execute arbitrary JavaScript.
      9 +- **Action Plan:**
     10 +  1. Install `dompurify`: `npm install dompurify`
     11 +  2. Import it in `script.js` (or load via CDN if sticking to hybrid approach).
     12 +  3. Wrap parsing: `preview.innerHTML = DOMPurify.sanitize(marked.parse(markdownText));`
     13 +
     14 +### 2. Remove Race Conditions in Threading
     15 +- **Severity:** High
     16 +- **Location:** `script.js` (Lines 490, 535)
     17 +- **Issue:** `setTimeout` (100ms) used to guess when libraries are ready. This leads to flaky rendering and "pop-in" effects.
     18 +- **Action Plan:**
     19 +  1. Refactor `MermaidService.render()` to return a Promise that resolves *only* when rendering is complete.
     20 +  2. Await this promise in `renderMarkdown()` instead of using `setTimeout`.
     21 +
     22 +---
     23 +
     24 +## üèóÔ∏è High Priority (Architectural Refactoring)
     25 +
     26 +### 3. Decompose Monolithic `script.js`
     27 +- **Severity:** High
     28 +- **Location:** `script.js` (1372 lines)
     29 +- **Issue:** File violates Single Responsibility Principle. Handles initialization, event binding, UI rendering, logic, and service orchestration.
     30 +- **Action Plan:**
     31 +  1. **Extract `UIManager`**: Move all `document.getElementById` and UI toggling logic here.
     32 +  2. **Extract `FileTreeView`**: Move the 200+ lines of DOM generation for the folder browser out of `script.js`.
     33 +  3. **Extract `EventManager`**: Centralize event listener bindings.
     34 +
     35 +### 4. Standardize Dependency Management
     36 +- **Severity:** Medium
     37 +- **Location:** `index.html`
     38 +- **Issue:** Runtime dependencies (Marked, Prism, Mermaid, KaTeX) are loaded via CDNs, while dev tools are in `package.json`. This creates a fragility where internet access is required for the "local" app to run.
     39 +- **Action Plan:**
     40 +  1. Install runtime deps: `npm install marked prismjs mermaid katex html2pdf.js`
     41 +  2. Update `vite.config.js` to bundle these assets.
     42 +  3. Remove CDN links from `index.html`.
     43 +
     44 +---
     45 +
     46 +## üßπ Medium Priority (Cleanup)
     47 +
     48 +### 5. Update Documentation
     49 +- **Severity:** Low
     50 +- **Location:** `README.md`
     51 +- **Issue:** Documentation mentions Java/Python support, implying backend code, but the repo is purely static frontend.
     52 +- **Action Plan:**
     53 +  1. Clarify "Client-Side Only" architecture in README.
     54 +  2. Update "Tech Stack" section to reflect actual discovered files.
     55 +
     56 +### 6. Centralize Configuration
     57 +- **Severity:** Low
     58 +- **Issue:** Some magic numbers (sidebar widths, zoom limits) are still hardcoded in `script.js`.
     59 +- **Action Plan:**
     60 +  1. Move all remaining constants to `src/js/config/constants.js`.
     61 +
     62 +---
     63 +
     64 +## üìÖ Roadmap
     65 +
     66 +| Phase | Task | Est. Effort |
     67 +|-------|------|-------------|
     68 +| **Week 1** | Security Fixes (XSS) + `setTimeout` Removal | 1 Day |
     69 +| **Week 2** | Split `script.js` -> `UIManager`, `AppController` | 3 Days |
     70 +| **Week 3** | Dependency Migration (CDN -> NPM) | 2 Days |
     71 +| **Week 4** | Documentation & Final Polish | 1 Day |
     72  

```


### ‚ú® `codebase_audit/phase5_recommendations.md` **[ADDED]**

**Status:** ‚úÖ **NEW FILE** - This file has been newly created

**Type:** Documentation üìñ

```diff
@@ -0,0 +1,41 @@
      1 +# üí° Phase 5: Recommendations & Roadmap
      2 +
      3 +Based on the consolidated findings, here are the strategic recommendations for the `markdown-viewer-app`.
      4 +
      5 +## üß† Strategic Recommendations
      6 +
      7 +### 1. Security Hardening (Immediate)
      8 +*   **Mitigate XSS:** The application **must** integrate a sanitization library (e.g., `DOMPurify`) before rendering any Markdown content. This is non-negotiable for a viewer app.
      9 +*   **Content Security Policy (CSP):** Implement a strict CSP in `index.html` to prevent unauthorized script execution, especially since we rely on CDNs.
     10 +
     11 +### 2. Architectural Refactoring (Short Term)
     12 +*   **Adopt MVC/MVVM:** Move away from the "Giant Script" pattern.
     13 +    *   **Model:** `StorageManager.js` (Already exists, good).
     14 +    *   **View:** Create `UIManager.js` to handle all DOM updates.
     15 +    *   **Controller:** Slim down `script.js` to only handle event orchestration.
     16 +*   **Event-Driven Architecture:** Expand the `ThemeManager`'s observer pattern to a global `EventManager` to decouple components.
     17 +
     18 +### 3. Modernization (Medium Term)
     19 +*   **Migrate to TypeScript:** The project checks for TS in `package.json` but uses JS. Migrating to TypeScript will eliminate type-related bugs and self-document the code.
     20 +*   **Bundle Management:** Move from CDN links in `index.html` to a built bundle (Vite). This ensures the app works offline (a key value prop) and stabilizes dependency versions.
     21 +
     22 +### 4. Quality Assurance (Long Term)
     23 +*   **Automated E2E Testing:** Implement Playwright or Cypress tests to verify the "Sync Scroll" and "Theme Switching" features automatically, reducing manual testing burden.
     24 +
     25 +## üó∫Ô∏è Proposed Roadmap
     26 +
     27 +### Phase A: Stability & Security (Week 1)
     28 +- [ ] Install `dompurify`
     29 +- [ ] Implement input sanitization
     30 +- [ ] Replace `setTimeout` with `Promise` chains
     31 +- [ ] Fix race conditions in Theme/Mermaid loading
     32 +
     33 +### Phase B: decoupling (Week 2)
     34 +- [ ] Extract `FolderBrowser` logic to `src/js/components/FileTree.js`
     35 +- [ ] Extract global event listeners to `src/js/core/EventManager.js`
     36 +- [ ] Refactor `script.js` to use these new modules
     37 +
     38 +### Phase C: Infrastructure (Week 3)
     39 +- [ ] Migrate runtime deps (Marked, Mermaid) to `npm`
     40 +- [ ] Configure Vite for production bundling
     41 +- [ ] Set up basic E2E tests for critical paths (Render, Export)
     42  

```


### ‚ú® `codebase_audit/phase6_final_deliverables.md` **[ADDED]**

**Status:** ‚úÖ **NEW FILE** - This file has been newly created

**Type:** Documentation üìñ

```diff
@@ -0,0 +1,44 @@
      1 +# üì¶ Phase 6: Final Deliverables
      2 +
      3 +## 1. Audit Summary
      4 +The `markdown-viewer-app` is a capable, feature-rich static web application. It delivers on its core promise of "no set-up" markdown viewing. However, it carries significant **Technical Debt** in its control structure (`script.js`) and a **Critical Security Vulnerability** that makes it unsafe for handling untrusted files.
      5 +
      6 +## 2. Test Strategy Outline
      7 +To ensure quality during the proposed refactoring, we recommend the following test strategy:
      8 +
      9 +*   **Unit Tests (Vitest):**
     10 +    *   Cover `StorageManager` (Data persistence).
     11 +    *   Cover `ThemeManager` (Logic correctness).
     12 +    *   Cover `Sanitization` (Verify malicious inputs are stripped).
     13 +*   **Integration Tests:**
     14 +    *   Verify `MermaidService` correctly loads config from `ThemeManager`.
     15 +*   **Manual Acceptance Tests:**
     16 +    *   "The Scroll Sync Test": Verify proportional scrolling in split view.
     17 +    *   "The Theme Switch Test": Verify no "flash of white" or broken diagrams on switch.
     18 +
     19 +## 3. Stakeholder Slide-Deck Outline
     20 +
     21 +**Slide 1: Title**
     22 +*   **audit Report: Markdown Viewer Pro**
     23 +*   *Status: Critical Issues Found*
     24 +
     25 +**Slide 2: The Good**
     26 +*   Zero-config, runs everywhere.
     27 +*   Modular Service layer (Mermaid, Prism, PDF) is well-designed.
     28 +*   Excellent Documentation.
     29 +
     30 +**Slide 3: The Bad (Critical Findings)**
     31 +*   **Security:** XSS Vulnerability (Malicious MD files can hack users).
     32 +*   **Stability:** Race conditions cause occasional rendering glitches.
     33 +
     34 +**Slide 4: The Ugly (Tech Debt)**
     35 +*   `script.js` is a "God Object" (1300+ lines).
     36 +*   Hard to maintain or extend without accidental breakage.
     37 +
     38 +**Slide 5: The Plan**
     39 +*   **Immediate:** Fix Security.
     40 +*   **Next:** Refactor Controller.
     41 +*   **Future:** TypeScript & Bundling.
     42 +
     43 +**Slide 6: Approval Request**
     44 +*   Requesting approval to proceed with Phase A (Security Fixes).
     45  

```


### ‚ú® `codebase_audit/repo_manifest.json` **[ADDED]**

**Status:** ‚úÖ **NEW FILE** - This file has been newly created

**Type:** Configuration/Data File üìã

```diff
@@ -0,0 +1,74 @@
      1 +{
      2 +  "documentation": [
      3 +    "AI_REVIEW.md",
      4 +    "MARKDOWN_TEST.md",
      5 +    "QUICK-REFERENCE.md",
      6 +    "README.md",
      7 +    "docs/01-requirements/folder-browser-feature-plan.md",
      8 +    "docs/01-requirements/math-rendering-feature-plan.md",
      9 +    "docs/01-requirements/pdf-export-plan.md",
     10 +    "docs/01-requirements/pdf-viewer-feature-plan.md",
     11 +    "docs/02-architecture/architecture-review.md",
     12 +    "docs/02-architecture/architecture.md",
     13 +    "docs/02-architecture/mermaid-theme-architecture.md",
     14 +    "docs/02-architecture/phase6-improvements.md",
     15 +    "docs/02-architecture/prism-token-architecture.md",
     16 +    "docs/02-architecture/syntax-highlighting-architecture.md",
     17 +    "docs/05-implementation/implementation-plan.md",
     18 +    "docs/05-implementation/refactoring-guide.md",
     19 +    "docs/05-implementation/refactoring-strategy.md",
     20 +    "docs/05-implementation/week6-final-integration.md",
     21 +    "docs/08-deployment/deployment.md",
     22 +    "docs/08-deployment/github-pages-deployment.md",
     23 +    "memory-bank/activeContext.md",
     24 +    "memory-bank/productContext.md",
     25 +    "memory-bank/progress.md",
     26 +    "memory-bank/projectbrief.md",
     27 +    "memory-bank/systemPatterns.md",
     28 +    "memory-bank/techContext.md"
     29 +  ],
     30 +  "source_code": {
     31 +    "javascript": [
     32 +      "script.js",
     33 +      "src/js/services/MermaidService.js",
     34 +      "src/js/services/FolderBrowserService.js",
     35 +      "src/js/services/PDFService.js",
     36 +      "src/js/services/PrismService.js",
     37 +      "src/js/utils/htmlHelpers.js",
     38 +      "src/js/utils/colorHelpers.js",
     39 +      "src/js/utils/validators.js",
     40 +      "src/js/config/featureFlags.js",
     41 +      "src/js/config/constants.js",
     42 +      "src/js/core/ThemeManager.js",
     43 +      "src/js/core/StorageManager.js"
     44 +    ],
     45 +    "css": [
     46 +      "style.css",
     47 +      "themes/obsidian-light.css",
     48 +      "themes/ocean-light.css",
     49 +      "themes/sunset-light.css",
     50 +      "themes/default-light.css",
     51 +      "themes/obsidian-dark.css",
     52 +      "themes/sunset-dark.css",
     53 +      "themes/neon-light.css",
     54 +      "themes/forest-light.css",
     55 +      "themes/forest-dark.css",
     56 +      "themes/ocean-dark.css",
     57 +      "themes/neon-dark.css",
     58 +      "themes/default-dark.css"
     59 +    ],
     60 +    "html": [
     61 +      "index.html"
     62 +    ]
     63 +  },
     64 +  "config": [
     65 +    ".clinerules",
     66 +    ".eslintrc.js",
     67 +    ".gitignore",
     68 +    ".prettierrc",
     69 +    "package.json",
     70 +    "vite.config.js",
     71 +    "vitest.config.js",
     72 +    "tests/setup.js"
     73 +  ]
     74 +}
     75  

```

---

## ü§ñ AI Review Checklist

Please review these changes for:

### üîç Code Quality
- [ ] **Linting Compliance**: No unused imports/variables, proper formatting
- [ ] **Type Safety**: Proper typing throughout (TypeScript/Python type hints)
- [ ] **Best Practices**: Framework-specific conventions and patterns
- [ ] **Performance**: Efficient algorithms, proper memoization
- [ ] **Documentation**: Clear comments and function descriptions

### üêõ Potential Issues
- [ ] **Runtime Errors**: Type mismatches, null/undefined handling
- [ ] **Logic Bugs**: Incorrect calculations, edge cases
- [ ] **Memory Leaks**: Cleanup in lifecycle methods, event listeners
- [ ] **Error Handling**: Proper try-catch blocks, user feedback
- [ ] **Accessibility**: ARIA labels, keyboard navigation, screen readers

### üîí Security & Data
- [ ] **Input Validation**: Sanitization, XSS prevention, SQL injection
- [ ] **Authentication**: Proper access controls and permissions
- [ ] **Privacy**: No sensitive data exposure in logs/client
- [ ] **Dependencies**: Updated packages, vulnerability checks

### üì± UX/UI
- [ ] **Responsive Design**: Mobile/desktop/tablet compatibility
- [ ] **Loading States**: Proper feedback during async operations
- [ ] **Error Messages**: User-friendly error handling and recovery
- [ ] **Performance**: Fast loading, smooth animations

### üí° Suggestions & Improvements
Please provide specific feedback on:
1. Code organization and structure improvements
2. Performance optimization opportunities
3. Security considerations and hardening
4. Testing coverage and strategies
5. Documentation and maintainability

---
*Generated by AI Visual Code Review v2.0 - Unified Export Script*
*Files processed: 13/13 | Errors: 0 | Generated: 2025-12-09T01:32:01.029Z*
