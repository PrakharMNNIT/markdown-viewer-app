# üîç Code Review - 12/9/2025, 7:04:12 AM

**Project:** AI Visual Code Review
**Generated by:** AI Visual Code Review v2.0

## üìä Change Summary

```
.agent/workflows/code-change-workflow.md |   13 +
 AI_REVIEW.md                             | 8282 +++++++++++++++++-------------
 package-lock.json                        |   17 +
 package.json                             |    1 +
 script.js                                | 1454 +++---
 5 files changed, 5530 insertions(+), 4237 deletions(-)
```

## üìù Files Changed (5/5 selected)


### ‚ú® `.agent/workflows/code-change-workflow.md` **[ADDED]**

**Status:** ‚úÖ **NEW FILE** - This file has been newly created

**Type:** Documentation üìñ

```diff
@@ -0,0 +1,13 @@
      1 +---
      2 +description: Standard process for making code changes with AI review validation
      3 +---
      4 +
      5 +# Code Change Process
      6 +
      7 +1. **Make Code Changes**: Apply fixes or new features.
      8 +2. **Stage Changes**: `git add .`
      9 +3. **AI Validation**: `npx ai-review quick`
     10 +4. **Self/User Review**: Read `AI_REVIEW.md` and verify changes.
     11 +5. **Fix Issues**: If review finds issues, repeat steps 1-4.
     12 +6. **Commit**: Only commit after a passing review.
     13 +   `git commit -m "feat: description"`
     14  

```


### üìÑ `AI_REVIEW.md`

**Type:** Documentation üìñ

```diff
@@ -1,4 +1,4 @@
  1     -# üîç Code Review - 12/7/2025, 9:59:24 AM
      1 +# üîç Code Review - 12/9/2025, 7:02:00 AM
  2   2  
  3   3  **Project:** AI Visual Code Review
  4   4  **Generated by:** AI Visual Code Review v2.0
@@ -6,28 +6,23 @@
  6   6  ## üìä Change Summary
  7   7  
  8   8  ```
  9     -AI_REVIEW.md                                       | 428 +++++++++++++++++----
 10     - docs/02-architecture/mermaid-theme-architecture.md | 208 ++++++++++
 11     - docs/02-architecture/prism-token-architecture.md   | 226 +++++++++++
 12     - script.js                                          |  52 ++-
 13     - src/js/services/MermaidService.js                  | 230 +++++++++--
 14     - style.css                                          | 147 ++++---
 15     - themes/default-dark.css                            | 186 ++++++++-
 16     - themes/default-light.css                           | 186 ++++++++-
 17     - themes/forest-dark.css                             | 167 ++++++--
 18     - themes/forest-light.css                            | 138 ++++++-
 19     - themes/neon-dark.css                               | 166 ++++++--
 20     - themes/neon-light.css                              | 138 ++++++-
 21     - themes/obsidian-dark.css                           | 138 ++++++-
 22     - themes/obsidian-light.css                          | 138 ++++++-
 23     - themes/ocean-dark.css                              | 138 ++++++-
 24     - themes/ocean-light.css                             | 138 ++++++-
 25     - themes/sunset-dark.css                             | 138 ++++++-
 26     - themes/sunset-light.css                            | 138 ++++++-
 27     - 18 files changed, 2762 insertions(+), 338 deletions(-)
      9 +AI_REVIEW.md                                       | 3926 ++++++++++++++++++--
     10 + codebase_audit/audit_summary.md                    |   49 +
     11 + .../deep_dive_reviews/mermaid_service_review.md    |   47 +
     12 + .../deep_dive_reviews/script_js_review.md          |  121 +
     13 + .../deep_dive_reviews/theme_manager_review.md      |   53 +
     14 + codebase_audit/docs_summary.json                   |   12 +
     15 + codebase_audit/future_enhancements_roadmap.md      |   87 +
     16 + codebase_audit/phase3_codebase_review.json         |   68 +
     17 + codebase_audit/phase4_consolidated_findings.md     |   31 +
     18 + codebase_audit/phase4_implementation_plan.md       |   71 +
     19 + codebase_audit/phase5_recommendations.md           |   41 +
     20 + codebase_audit/phase6_final_deliverables.md        |   44 +
     21 + codebase_audit/repo_manifest.json                  |   74 +
     22 + 13 files changed, 4282 insertions(+), 342 deletions(-)
 28  23  ```
 29  24  
 30     -## üìù Files Changed (18/18 selected)
     25 +## üìù Files Changed (13/13 selected)
 31  26  
 32  27  
 33  28  ### üìÑ `AI_REVIEW.md`
@@ -36,3588 +31,4827 @@ AI_REVIEW.md                                       | 428 +++++++++++++++++----
 36  31  
 37  32  ```diff
 38  33  @@ -1,4 +1,4 @@
 39     -  1     -# üîç Code Review - 12/7/2025, 4:25:31 AM
 40     -      1 +# üîç Code Review - 12/7/2025, 8:27:20 AM
     34 +  1     -# üîç Code Review - 12/7/2025, 8:27:20 AM
     35 +      1 +# üîç Code Review - 12/7/2025, 9:59:24 AM
 41  36    2   2  
 42  37    3   3  **Project:** AI Visual Code Review
 43  38    4   4  **Generated by:** AI Visual Code Review v2.0
 44     -@@ -6,38 +6,80 @@
     39 +@@ -6,80 +6,953 @@
 45  40    6   6  ## üìä Change Summary
 46  41    7   7  
 47  42    8   8  ```
 48     -  9     -index.html | 11 +++++++++++
 49     - 10     - script.js  | 21 ++++++++++++++++++++-
 50     - 11     - 2 files changed, 31 insertions(+), 1 deletion(-)
 51     -      9 +memory-bank/activeContext.md |  52 +++++++++-
 52     -     10 + script.js                    | 231 +++++--------------------------------------
 53     -     11 + themes/sunset-dark.css       |   2 +-
 54     -     12 + 3 files changed, 75 insertions(+), 210 deletions(-)
 55     - 12  13  ```
 56     - 13  14  
 57     - 14     -## üìù Files Changed (2/2 selected)
 58     -     15 +## üìù Files Changed (3/3 selected)
 59     - 15  16  
 60     - 16  17  
 61     - 17     -### üìÑ `index.html`
 62     -     18 +### üìÑ `memory-bank/activeContext.md`
 63     - 18  19  
 64     - 19     -**Type:** HTML Template üåê
 65     -     20 +**Type:** Documentation üìñ
 66     - 20  21  
 67     - 21  22  ```diff
 68     - 22     -@@ -55,6 +55,17 @@
 69     - 23     - 55  55              üìÅ Open Folder
 70     - 24     - 56  56            </button>
 71     - 25     - 57  57  
 72     - 26     -     58 +          <!-- Collapse/Expand Sidebar -->
 73     - 27     -     59 +          <button
 74     - 28     -     60 +            class="btn"
 75     - 29     -     61 +            id="toggle-sidebar-btn"
 76     - 30     -     62 +            title="Toggle File Browser"
 77     - 31     -     63 +            aria-label="Toggle File Browser Sidebar"
 78     - 32     -     64 +            style="display: none"
 79     - 33     -     65 +          >
 80     - 34     -     66 +            ‚óÄ Hide Files
 81     - 35     -     67 +          </button>
 82     - 36     -     68 +
 83     - 37     - 58  69            <!-- View Mode Buttons -->
 84     - 38     - 59  70            <div class="view-mode-buttons">
 85     - 39     - 60  71              <button
 86     - 40     - 61  72  
 87     -     23 +@@ -202,7 +202,57 @@ html = restoreLatexEnvironments(html);
 88     -     24 +202 202  
 89     -     25 +203 203  ## Open Questions
 90     -     26 +204 204  
 91     -     27 +205     -None - All LaTeX rendering issues resolved
 92     -     28 +    205 +None - All issues resolved
 93     -     29 +    206 +
 94     -     30 +    207 +## Recent Fixes (Latest Session)
 95     -     31 +    208 +
 96     -     32 +    209 +### Theme Dropdown Sync Fix ‚úÖ
 97     -     33 +    210 +
 98     -     34 +    211 +**Problem:** Theme dropdown showing "Default Light" even when sunset-dark theme was loaded from LocalStorage.
 99     -     35 +    212 +
100     -     36 +    213 +**Root Cause:** Race condition in theme loading - dropdown was being set BEFORE async theme load completed.
101     -     37 +    214 +
102     -     38 +    215 +**Solution:**
103     -     39 +    216 +
104     -     40 +    217 +```javascript
105     -     41 +    218 +// OLD (buggy):
106     -     42 +    219 +if (savedTheme) {
107     -     43 +    220 +  themeSelector.value = savedTheme; // Sets immediately
108     -     44 +    221 +  themeManager.loadTheme(savedTheme); // Async, not awaited
109     -     45 +    222 +}
110     -     46 +    223 +
111     -     47 +    224 +// NEW (fixed):
112     -     48 +    225 +if (savedTheme) {
113     -     49 +    226 +  themeManager
114     -     50 +    227 +    .loadTheme(savedTheme)
115     -     51 +    228 +    .then(() => {
116     -     52 +    229 +      themeSelector.value = savedTheme; // Only after successful load
117     -     53 +    230 +      console.log(`‚úÖ Theme restored: ${savedTheme}`);
118     -     54 +    231 +    })
119     -     55 +    232 +    .catch(err => {
120     -     56 +    233 +      // Fallback with proper sync
121     -     57 +    234 +      themeManager.loadTheme('default-light').then(() => {
122     -     58 +    235 +        themeSelector.value = 'default-light';
123     -     59 +    236 +      });
124     -     60 +    237 +    });
125     -     61 +    238 +}
126     -     62 +    239 +```
127     -     63 +    240 +
128     -     64 +    241 +**Key Changes:**
129     -     65 +    242 +
130     -     66 +    243 +1. Await theme load completion before syncing dropdown
131     -     67 +    244 +2. Added success callback for dropdown update
132     -     68 +    245 +3. Added error handling with fallback
133     -     69 +    246 +4. Added console logging for debugging
134     -     70 +    247 +
135     -     71 +    248 +**Results:**
136     -     72 +    249 +
137     -     73 +    250 +- ‚úÖ Dropdown now syncs correctly with all themes
138     -     74 +    251 +- ‚úÖ No more race conditions
139     -     75 +    252 +- ‚úÖ Proper error handling
140     -     76 +    253 +- ‚úÖ Works for all 12 themes (6 theme families √ó 2 variants)
141     -     77 +    254 +
142     -     78 +    255 +**Files Modified:** `script.js` (lines 1167-1183)
143     -     79 +206 256  
144     -     80 +207 257  ## Performance Observations
145     -     81 +208 258  
146     -     82 +209 259  
147     - 41  83  
148     - 42  84  ```
149     - 43  85  
150     -@@ -47,51 +89,293 @@ index.html | 11 +++++++++++
151     - 47  89  **Type:** JavaScript Source File üü®
152     - 48  90  
153     - 49  91  ```diff
154     - 50     -@@ -796,6 +796,7 @@ graph TD
155     - 51     -796 796    // Folder browser DOM elements
156     - 52     -797 797    const fileBrowser = document.getElementById('file-browser');
157     - 53     -798 798    const openFolderBtn = document.getElementById('open-folder-btn');
158     - 54     -    799 +  const toggleSidebarBtn = document.getElementById('toggle-sidebar-btn');
159     - 55     -799 800    const closeBrowserBtn = document.getElementById('close-browser-btn');
160     - 56     -800 801    const fileTree = document.getElementById('file-tree');
161     - 57     -801 802    const currentFolderNameEl = document.getElementById('current-folder-name');
162     - 58     -@@ -804,6 +805,7 @@ graph TD
163     - 59     -804 805    // Folder browser state (using let to allow reassignment)
164     - 60     -805 806    let folderFiles = [];
165     - 61     -806 807    let activeFileHandle = null;
166     - 62     -    808 +  const sidebarCollapsed = false;
167     - 63     -807 809  
168     - 64     -808 810    // Open folder handler
169     - 65     -809 811    openFolderBtn.addEventListener('click', async () => {
170     - 66     -@@ -843,9 +845,26 @@ graph TD
171     - 67     -843 845      console.log(`‚úÖ Loaded ${result.totalFiles} markdown files from ${result.folderName}`);
172     - 68     -844 846    });
173     - 69     -845 847  
174     - 70     -846     -  // Close browser handler
175     - 71     -    848 +  // Toggle sidebar collapse/expand
176     - 72     -    849 +  toggleSidebarBtn.addEventListener('click', () => {
177     - 73     -    850 +    if (fileBrowser.style.display === 'none') {
178     - 74     -    851 +      // Expand sidebar
179     - 75     -    852 +      fileBrowser.style.display = 'flex';
180     - 76     -    853 +      toggleSidebarBtn.textContent = '‚óÄ Hide Files';
181     - 77     -    854 +      toggleSidebarBtn.title = 'Hide File Browser';
182     - 78     -    855 +    } else {
183     - 79     -    856 +      // Collapse sidebar (keep data)
184     - 80     -    857 +      fileBrowser.style.display = 'none';
185     - 81     -    858 +      toggleSidebarBtn.textContent = '‚ñ∂ Show Files';
186     - 82     -    859 +      toggleSidebarBtn.title = 'Show File Browser';
187     - 83     -    860 +    }
188     - 84     -    861 +  });
189     - 85     -    862 +
190     - 86     -    863 +  // Close browser handler (clears data)
191     - 87     -847 864    closeBrowserBtn.addEventListener('click', () => {
192     - 88     -848 865      fileBrowser.style.display = 'none';
193     - 89     -    866 +    toggleSidebarBtn.style.display = 'none';
194     - 90     -    867 +    openFolderBtn.style.display = 'inline-block';
195     - 91     -849 868      folderFiles = [];
196     - 92     -850 869      activeFileHandle = null;
197     - 93     -851 870    });
198     - 94     -852 871  
199     -     92 +@@ -145,101 +145,10 @@ function configureMarkedExtensions() {
200     -     93 +145 145      return;
201     -     94 +146 146    }
202     -     95 +147 147  
203     -     96 +148     -  // Add LaTeX environment extensions
204     -     97 +    148 +  // Add inline math and text formatting extensions only
205     -     98 +    149 +  // LaTeX environments (align, gather, etc.) are not supported by KaTeX
206     -     99 +149 150    marked.use({
207     -    100 +150 151      extensions: [
208     -    101 +151     -      {
209     -    102 +152     -        name: 'latexEnvironment',
210     -    103 +153     -        level: 'block',
211     -    104 +154     -        start(src) {
212     -    105 +155     -          return src.match(/^\\begin\{/)?.index;
213     -    106 +156     -        },
214     -    107 +157     -        tokenizer(src) {
215     -    108 +158     -          const match = src.match(/^\\begin\{([^}]+)\}([\s\S]*?)\\end\{\1\}/);
216     -    109 +159     -          if (match) {
217     -    110 +160     -            return {
218     -    111 +161     -              type: 'latexEnvironment',
219     -    112 +162     -              raw: match[0],
220     -    113 +163     -              text: match[0],
221     -    114 +164     -            };
222     -    115 +165     -          }
223     -    116 +166     -        },
224     -    117 +167     -        renderer(token) {
225     -    118 +168     -          try {
226     -    119 +169     -            const rendered = katex.renderToString(token.text, {
227     -    120 +170     -              displayMode: true,
228     -    121 +171     -              throwOnError: false,
229     -    122 +172     -              trust: true,
230     -    123 +173     -              strict: false,
231     -    124 +174     -            });
232     -    125 +175     -            return `<div class="katex-display">${rendered}</div>`;
233     -    126 +176     -          } catch (e) {
234     -    127 +177     -            console.warn('KaTeX environment render error:', e);
235     -    128 +178     -            return `<div style="color: red; padding: 10px;">LaTeX Error: ${e.message}</div>`;
236     -    129 +179     -          }
237     -    130 +180     -        },
238     -    131 +181     -      },
239     -    132 +182     -      {
240     -    133 +183     -        name: 'latexDisplayBracket',
241     -    134 +184     -        level: 'block',
242     -    135 +185     -        start(src) {
243     -    136 +186     -          return src.match(/^\\\[/)?.index;
244     -    137 +187     -        },
245     -    138 +188     -        tokenizer(src) {
246     -    139 +189     -          const match = src.match(/^\\\[([\s\S]*?)\\\]/);
247     -    140 +190     -          if (match) {
248     -    141 +191     -            return {
249     -    142 +192     -              type: 'latexDisplayBracket',
250     -    143 +193     -              raw: match[0],
251     -    144 +194     -              text: match[1].trim(),
252     -    145 +195     -            };
253     -    146 +196     -          }
254     -    147 +197     -        },
255     -    148 +198     -        renderer(token) {
256     -    149 +199     -          try {
257     -    150 +200     -            const rendered = katex.renderToString(token.text, {
258     -    151 +201     -              displayMode: true,
259     -    152 +202     -              throwOnError: false,
260     -    153 +203     -              trust: true,
261     -    154 +204     -              strict: false,
262     -    155 +205     -            });
263     -    156 +206     -            return `<div class="katex-display">${rendered}</div>`;
264     -    157 +207     -          } catch (e) {
265     -    158 +208     -            console.warn('KaTeX bracket render error:', e);
266     -    159 +209     -            return `<div style="color: red; padding: 10px;">LaTeX Error: ${e.message}</div>`;
267     -    160 +210     -          }
268     -    161 +211     -        },
269     -    162 +212     -      },
270     -    163 +213     -      {
271     -    164 +214     -        name: 'latexInlineParen',
272     -    165 +215     -        level: 'inline',
273     -    166 +216     -        start(src) {
274     -    167 +217     -          return src.match(/\\\(/)?.index;
275     -    168 +218     -        },
276     -    169 +219     -        tokenizer(src) {
277     -    170 +220     -          const match = src.match(/^\\\(([\s\S]*?)\\\)/);
278     -    171 +221     -          if (match) {
279     -    172 +222     -            return {
280     -    173 +223     -              type: 'latexInlineParen',
281     -    174 +224     -              raw: match[0],
282     -    175 +225     -              text: match[1].trim(),
283     -    176 +226     -            };
284     -    177 +227     -          }
285     -    178 +228     -        },
286     -    179 +229     -        renderer(token) {
287     -    180 +230     -          try {
288     -    181 +231     -            return katex.renderToString(token.text, {
289     -    182 +232     -              displayMode: false,
290     -    183 +233     -              throwOnError: false,
291     -    184 +234     -              trust: true,
292     -    185 +235     -              strict: false,
293     -    186 +236     -            });
294     -    187 +237     -          } catch (e) {
295     -    188 +238     -            console.warn('KaTeX paren render error:', e);
296     -    189 +239     -            return `<span style="color: red;">LaTeX Error</span>`;
297     -    190 +240     -          }
298     -    191 +241     -        },
299     -    192 +242     -      },
300     -    193 +243 152        {
301     -    194 +244 153          name: 'mathBlock',
302     -    195 +245 154          level: 'block',
303     -    196 +@@ -503,101 +412,10 @@ graph TD
304     -    197 +503 412      return textarea.value;
305     -    198 +504 413    }
306     -    199 +505 414  
307     -    200 +506     -  // Add LaTeX environment extensions that render directly with KaTeX
308     -    201 +    415 +  // Keep only subscript and superscript extensions
309     -    202 +    416 +  // Remove LaTeX environment extensions that don't work with KaTeX
310     -    203 +507 417    marked.use({
311     -    204 +508 418      extensions: [
312     -    205 +509     -      {
313     -    206 +510     -        name: 'latexEnvironment',
314     -    207 +511     -        level: 'block',
315     -    208 +512     -        start(src) {
316     -    209 +513     -          return src.match(/^\\begin\{/)?.index;
317     -    210 +514     -        },
318     -    211 +515     -        tokenizer(src) {
319     -    212 +516     -          const match = src.match(/^\\begin\{([^}]+)\}([\s\S]*?)\\end\{\1\}/);
320     -    213 +517     -          if (match) {
321     -    214 +518     -            return {
322     -    215 +519     -              type: 'latexEnvironment',
323     -    216 +520     -              raw: match[0],
324     -    217 +521     -              text: match[0],
325     -    218 +522     -            };
326     -    219 +523     -          }
327     -    220 +524     -        },
328     -    221 +525     -        renderer(token) {
329     -    222 +526     -          try {
330     -    223 +527     -            const rendered = katex.renderToString(token.text, {
331     -    224 +528     -              displayMode: true,
332     -    225 +529     -              throwOnError: false,
333     -    226 +530     -              trust: true,
334     -    227 +531     -              strict: false,
335     -    228 +532     -            });
336     -    229 +533     -            return `<div class="katex-display">${rendered}</div>`;
337     -    230 +534     -          } catch (e) {
338     -    231 +535     -            console.warn('KaTeX environment render error:', e);
339     -    232 +536     -            return `<div style="color: red; padding: 10px;">LaTeX Error: ${e.message}</div>`;
340     -    233 +537     -          }
341     -    234 +538     -        },
342     -    235 +539     -      },
343     -    236 +540     -      {
344     -    237 +541     -        name: 'latexDisplayBracket',
345     -    238 +542     -        level: 'block',
346     -    239 +543     -        start(src) {
347     -    240 +544     -          return src.match(/^\\\[/)?.index;
348     -    241 +545     -        },
349     -    242 +546     -        tokenizer(src) {
350     -    243 +547     -          const match = src.match(/^\\\[([\s\S]*?)\\\]/);
351     -    244 +548     -          if (match) {
352     -    245 +549     -            return {
353     -    246 +550     -              type: 'latexDisplayBracket',
354     -    247 +551     -              raw: match[0],
355     -    248 +552     -              text: match[1].trim(),
356     -    249 +553     -            };
357     -    250 +554     -          }
358     -    251 +555     -        },
359     -    252 +556     -        renderer(token) {
360     -    253 +557     -          try {
361     -    254 +558     -            const rendered = katex.renderToString(token.text, {
362     -    255 +559     -              displayMode: true,
363     -    256 +560     -              throwOnError: false,
364     -    257 +561     -              trust: true,
365     -    258 +562     -              strict: false,
366     -    259 +563     -            });
367     -    260 +564     -            return `<div class="katex-display">${rendered}</div>`;
368     -    261 +565     -          } catch (e) {
369     -    262 +566     -            console.warn('KaTeX bracket render error:', e);
370     -    263 +567     -            return `<div style="color: red; padding: 10px;">LaTeX Error: ${e.message}</div>`;
371     -    264 +568     -          }
372     -    265 +569     -        },
373     -    266 +570     -      },
374     -    267 +571     -      {
375     -    268 +572     -        name: 'latexInlineParen',
376     -    269 +573     -        level: 'inline',
377     -    270 +574     -        start(src) {
378     -    271 +575     -          return src.match(/\\\(/)?.index;
379     -    272 +576     -        },
380     -    273 +577     -        tokenizer(src) {
381     -    274 +578     -          const match = src.match(/^\\\(([\s\S]*?)\\\)/);
382     -    275 +579     -          if (match) {
383     -    276 +580     -            return {
384     -    277 +581     -              type: 'latexInlineParen',
385     -    278 +582     -              raw: match[0],
386     -    279 +583     -              text: match[1].trim(),
387     -    280 +584     -            };
388     -    281 +585     -          }
389     -    282 +586     -        },
390     -    283 +587     -        renderer(token) {
391     -    284 +588     -          try {
392     -    285 +589     -            return katex.renderToString(token.text, {
393     -    286 +590     -              displayMode: false,
394     -    287 +591     -              throwOnError: false,
395     -    288 +592     -              trust: true,
396     -    289 +593     -              strict: false,
397     -    290 +594     -            });
398     -    291 +595     -          } catch (e) {
399     -    292 +596     -            console.warn('KaTeX paren render error:', e);
400     -    293 +597     -            return `<span style="color: red;">LaTeX Error</span>`;
401     -    294 +598     -          }
402     -    295 +599     -        },
403     -    296 +600     -      },
404     -    297 +601 419        {
405     -    298 +602 420          name: 'subscript',
406     -    299 +603 421          level: 'inline',
407     -    300 +@@ -641,7 +459,7 @@ graph TD
408     -    301 +641 459      ],
409     -    302 +642 460    });
410     -    303 +643 461  
411     -    304 +644     -  console.log('‚úÖ LaTeX environments, subscript, and superscript enabled');
412     -    305 +    462 +  console.log('‚úÖ Subscript and superscript enabled (LaTeX environments display as-is)');
413     -    306 +645 463  
414     -    307 +646 464    // Render markdown
415     -    308 +647 465    function renderMarkdown() {
416     -    309 +@@ -685,22 +503,9 @@ graph TD
417     -    310 +685 503        // Apply Prism syntax highlighting using PrismService
418     -    311 +686 504        prismService.highlightAll(preview);
419     -    312 +687 505  
420     -    313 +688     -      // Apply KaTeX auto-render only for any remaining $...$ syntax
421     -    314 +689     -      if (typeof renderMathInElement !== 'undefined') {
422     -    315 +690     -        try {
423     -    316 +691     -          renderMathInElement(preview, {
424     -    317 +692     -            delimiters: [
425     -    318 +693     -              { left: '$$', right: '$$', display: true },
426     -    319 +694     -              { left: '$', right: '$', display: false },
427     -    320 +695     -            ],
428     -    321 +696     -            throwOnError: false,
429     -    322 +697     -            trust: true,
430     -    323 +698     -            strict: false,
431     -    324 +699     -          });
432     -    325 +700     -        } catch (e) {
433     -    326 +701     -          console.warn('KaTeX auto-render error:', e);
434     -    327 +702     -        }
435     -    328 +703     -      }
436     -    329 +    506 +      // NOTE: KaTeX auto-render is DISABLED
437     -    330 +    507 +      // We handle all math via marked.js extensions ($...$ and $$...$$)
438     -    331 +    508 +      // KaTeX auto-render was causing issues with unsupported LaTeX environments
439     -    332 +704 509  
440     -    333 +705 510        // Save content using StorageManager
441     -    334 +706 511        storageManager.set('markdownContent', markdownText);
442     -    335 +@@ -1167,11 +972,21 @@ graph TD
443     -    336 +1167 972    // Load saved theme using ThemeManager
444     -    337 +1168 973    const savedTheme = storageManager.get('selectedTheme');
445     -    338 +1169 974    if (savedTheme) {
446     -    339 +1170     -    themeSelector.value = savedTheme;
447     -    340 +1171     -    themeManager.loadTheme(savedTheme).catch(err => {
448     -    341 +1172     -      console.error('Failed to load saved theme:', err);
449     -    342 +1173     -      themeManager.loadTheme('default-light');
450     -    343 +1174     -    });
451     -    344 +    975 +    // Load theme first, then sync dropdown only on success
452     -    345 +    976 +    themeManager
453     -    346 +    977 +      .loadTheme(savedTheme)
454     -    347 +    978 +      .then(() => {
455     -    348 +    979 +        // Theme loaded successfully - sync dropdown
456     -    349 +    980 +        themeSelector.value = savedTheme;
457     -    350 +    981 +        console.log(`‚úÖ Theme restored: ${savedTheme}`);
458     -    351 +    982 +      })
459     -    352 +    983 +      .catch(err => {
460     -    353 +    984 +        console.error('Failed to load saved theme:', err);
461     -    354 +    985 +        // Fallback to default-light on error
462     -    355 +    986 +        themeManager.loadTheme('default-light').then(() => {
463     -    356 +    987 +          themeSelector.value = 'default-light';
464     -    357 +    988 +        });
465     -    358 +    989 +      });
466     -    359 +1175 990    }
467     -    360 +1176 991  
468     -    361 +1177 992    // Zoom functionality
469     -    362 +1178 993  
470     -    363 +
471     -    364 +```
472     -    365 +
473     -    366 +
474     -    367 +### üìÑ `themes/sunset-dark.css`
475     -    368 +
476     -    369 +**Type:** Stylesheet üé®
477     -    370 +
478     -    371 +```diff
479     -    372 +@@ -1,4 +1,4 @@
480     -    373 +  1     -r/* Sunset Dark Theme */
481     -    374 +      1 +/* Sunset Dark Theme */
482     -    375 +  2   2  :root {
483     -    376 +  3   3    --bg-primary: #1c0a00;
484     -    377 +  4   4    --bg-secondary: #2d1b0e;
485     -    378 +  5   5  
486     - 95 379  
487     - 96 380  ```
488     - 97 381  
489     -@@ -137,4 +421,4 @@ Please provide specific feedback on:
490     -137 421  
491     -138 422  ---
492     -139 423  *Generated by AI Visual Code Review v2.0 - Unified Export Script*
493     -140     -*Files processed: 2/2 | Errors: 0 | Generated: 2025-12-06T22:55:31.083Z*
494     -    424 +*Files processed: 3/3 | Errors: 0 | Generated: 2025-12-07T02:57:20.361Z*
495     -141 425  
     43 +  9     -memory-bank/activeContext.md |  52 +++++++++-
     44 + 10     - script.js                    | 231 +++++--------------------------------------
     45 + 11     - themes/sunset-dark.css       |   2 +-
     46 + 12     - 3 files changed, 75 insertions(+), 210 deletions(-)
     47 +      9 +AI_REVIEW.md                                       | 428 +++++++++++++++++----
     48 +     10 + docs/02-architecture/mermaid-theme-architecture.md | 208 ++++++++++
     49 +     11 + docs/02-architecture/prism-token-architecture.md   | 226 +++++++++++
     50 +     12 + script.js                                          |  52 ++-
     51 +     13 + src/js/services/MermaidService.js                  | 230 +++++++++--
     52 +     14 + style.css                                          | 147 ++++---
     53 +     15 + themes/default-dark.css                            | 186 ++++++++-
     54 +     16 + themes/default-light.css                           | 186 ++++++++-
     55 +     17 + themes/forest-dark.css                             | 167 ++++++--
     56 +     18 + themes/forest-light.css                            | 138 ++++++-
     57 +     19 + themes/neon-dark.css                               | 166 ++++++--
     58 +     20 + themes/neon-light.css                              | 138 ++++++-
     59 +     21 + themes/obsidian-dark.css                           | 138 ++++++-
     60 +     22 + themes/obsidian-light.css                          | 138 ++++++-
     61 +     23 + themes/ocean-dark.css                              | 138 ++++++-
     62 +     24 + themes/ocean-light.css                             | 138 ++++++-
     63 +     25 + themes/sunset-dark.css                             | 138 ++++++-
     64 +     26 + themes/sunset-light.css                            | 138 ++++++-
     65 +     27 + 18 files changed, 2762 insertions(+), 338 deletions(-)
     66 + 13  28  ```
     67 + 14  29  
     68 + 15     -## üìù Files Changed (3/3 selected)
     69 +     30 +## üìù Files Changed (18/18 selected)
     70 + 16  31  
     71 + 17  32  
     72 + 18     -### üìÑ `memory-bank/activeContext.md`
     73 +     33 +### üìÑ `AI_REVIEW.md`
     74 + 19  34  
     75 + 20  35  **Type:** Documentation üìñ
     76 + 21  36  
     77 + 22  37  ```diff
     78 + 23     -@@ -202,7 +202,57 @@ html = restoreLatexEnvironments(html);
     79 + 24     -202 202  
     80 + 25     -203 203  ## Open Questions
     81 + 26     -204 204  
     82 + 27     -205     -None - All LaTeX rendering issues resolved
     83 + 28     -    205 +None - All issues resolved
     84 +     38 +@@ -1,4 +1,4 @@
     85 +     39 +  1     -# üîç Code Review - 12/7/2025, 4:25:31 AM
     86 +     40 +      1 +# üîç Code Review - 12/7/2025, 8:27:20 AM
     87 +     41 +  2   2  
     88 +     42 +  3   3  **Project:** AI Visual Code Review
     89 +     43 +  4   4  **Generated by:** AI Visual Code Review v2.0
     90 +     44 +@@ -6,38 +6,80 @@
     91 +     45 +  6   6  ## üìä Change Summary
     92 +     46 +  7   7  
     93 +     47 +  8   8  ```
     94 +     48 +  9     -index.html | 11 +++++++++++
     95 +     49 + 10     - script.js  | 21 ++++++++++++++++++++-
     96 +     50 + 11     - 2 files changed, 31 insertions(+), 1 deletion(-)
     97 +     51 +      9 +memory-bank/activeContext.md |  52 +++++++++-
     98 +     52 +     10 + script.js                    | 231 +++++--------------------------------------
     99 +     53 +     11 + themes/sunset-dark.css       |   2 +-
    100 +     54 +     12 + 3 files changed, 75 insertions(+), 210 deletions(-)
    101 +     55 + 12  13  ```
    102 +     56 + 13  14  
    103 +     57 + 14     -## üìù Files Changed (2/2 selected)
    104 +     58 +     15 +## üìù Files Changed (3/3 selected)
    105 +     59 + 15  16  
    106 +     60 + 16  17  
    107 +     61 + 17     -### üìÑ `index.html`
    108 +     62 +     18 +### üìÑ `memory-bank/activeContext.md`
    109 +     63 + 18  19  
    110 +     64 + 19     -**Type:** HTML Template üåê
    111 +     65 +     20 +**Type:** Documentation üìñ
    112 +     66 + 20  21  
    113 +     67 + 21  22  ```diff
    114 +     68 + 22     -@@ -55,6 +55,17 @@
    115 +     69 + 23     - 55  55              üìÅ Open Folder
    116 +     70 + 24     - 56  56            </button>
    117 +     71 + 25     - 57  57  
    118 +     72 + 26     -     58 +          <!-- Collapse/Expand Sidebar -->
    119 +     73 + 27     -     59 +          <button
    120 +     74 + 28     -     60 +            class="btn"
    121 +     75 + 29     -     61 +            id="toggle-sidebar-btn"
    122 +     76 + 30     -     62 +            title="Toggle File Browser"
    123 +     77 + 31     -     63 +            aria-label="Toggle File Browser Sidebar"
    124 +     78 + 32     -     64 +            style="display: none"
    125 +     79 + 33     -     65 +          >
    126 +     80 + 34     -     66 +            ‚óÄ Hide Files
    127 +     81 + 35     -     67 +          </button>
    128 +     82 + 36     -     68 +
    129 +     83 + 37     - 58  69            <!-- View Mode Buttons -->
    130 +     84 + 38     - 59  70            <div class="view-mode-buttons">
    131 +     85 + 39     - 60  71              <button
    132 +     86 + 40     - 61  72  
    133 +     87 +     23 +@@ -202,7 +202,57 @@ html = restoreLatexEnvironments(html);
    134 +     88 +     24 +202 202  
    135 +     89 +     25 +203 203  ## Open Questions
    136 +     90 +     26 +204 204  
    137 +     91 +     27 +205     -None - All LaTeX rendering issues resolved
    138 +     92 +     28 +    205 +None - All issues resolved
    139 +     93 +     29 +    206 +
    140 +     94 +     30 +    207 +## Recent Fixes (Latest Session)
    141 +     95 +     31 +    208 +
    142 +     96 +     32 +    209 +### Theme Dropdown Sync Fix ‚úÖ
    143 +     97 +     33 +    210 +
    144 +     98 +     34 +    211 +**Problem:** Theme dropdown showing "Default Light" even when sunset-dark theme was loaded from LocalStorage.
    145 +     99 +     35 +    212 +
    146 +    100 +     36 +    213 +**Root Cause:** Race condition in theme loading - dropdown was being set BEFORE async theme load completed.
    147 +    101 +     37 +    214 +
    148 +    102 +     38 +    215 +**Solution:**
    149 +    103 +     39 +    216 +
    150 +    104 +     40 +    217 +```javascript
    151 +    105 +     41 +    218 +// OLD (buggy):
    152 +    106 +     42 +    219 +if (savedTheme) {
    153 +    107 +     43 +    220 +  themeSelector.value = savedTheme; // Sets immediately
    154 +    108 +     44 +    221 +  themeManager.loadTheme(savedTheme); // Async, not awaited
    155 +    109 +     45 +    222 +}
    156 +    110 +     46 +    223 +
    157 +    111 +     47 +    224 +// NEW (fixed):
    158 +    112 +     48 +    225 +if (savedTheme) {
    159 +    113 +     49 +    226 +  themeManager
    160 +    114 +     50 +    227 +    .loadTheme(savedTheme)
    161 +    115 +     51 +    228 +    .then(() => {
    162 +    116 +     52 +    229 +      themeSelector.value = savedTheme; // Only after successful load
    163 +    117 +     53 +    230 +      console.log(`‚úÖ Theme restored: ${savedTheme}`);
    164 +    118 +     54 +    231 +    })
    165 +    119 +     55 +    232 +    .catch(err => {
    166 +    120 +     56 +    233 +      // Fallback with proper sync
    167 +    121 +     57 +    234 +      themeManager.loadTheme('default-light').then(() => {
    168 +    122 +     58 +    235 +        themeSelector.value = 'default-light';
    169 +    123 +     59 +    236 +      });
    170 +    124 +     60 +    237 +    });
    171 +    125 +     61 +    238 +}
    172 +    126 +     62 +    239 +```
    173 +    127 +     63 +    240 +
    174 +    128 +     64 +    241 +**Key Changes:**
    175 +    129 +     65 +    242 +
    176 +    130 +     66 +    243 +1. Await theme load completion before syncing dropdown
    177 +    131 +     67 +    244 +2. Added success callback for dropdown update
    178 +    132 +     68 +    245 +3. Added error handling with fallback
    179 +    133 +     69 +    246 +4. Added console logging for debugging
    180 +    134 +     70 +    247 +
    181 +    135 +     71 +    248 +**Results:**
    182 +    136 +     72 +    249 +
    183 +    137 +     73 +    250 +- ‚úÖ Dropdown now syncs correctly with all themes
    184 +    138 +     74 +    251 +- ‚úÖ No more race conditions
    185 +    139 +     75 +    252 +- ‚úÖ Proper error handling
    186 +    140 +     76 +    253 +- ‚úÖ Works for all 12 themes (6 theme families √ó 2 variants)
    187 +    141 +     77 +    254 +
    188 +    142 +     78 +    255 +**Files Modified:** `script.js` (lines 1167-1183)
    189 +    143 +     79 +206 256  
    190 +    144 +     80 +207 257  ## Performance Observations
    191 +    145 +     81 +208 258  
    192 +    146 +     82 +209 259  
    193 +    147 + 41  83  
    194 +    148 + 42  84  ```
    195 +    149 + 43  85  
    196 +    150 +@@ -47,51 +89,293 @@ index.html | 11 +++++++++++
    197 +    151 + 47  89  **Type:** JavaScript Source File üü®
    198 +    152 + 48  90  
    199 +    153 + 49  91  ```diff
    200 +    154 + 50     -@@ -796,6 +796,7 @@ graph TD
    201 +    155 + 51     -796 796    // Folder browser DOM elements
    202 +    156 + 52     -797 797    const fileBrowser = document.getElementById('file-browser');
    203 +    157 + 53     -798 798    const openFolderBtn = document.getElementById('open-folder-btn');
    204 +    158 + 54     -    799 +  const toggleSidebarBtn = document.getElementById('toggle-sidebar-btn');
    205 +    159 + 55     -799 800    const closeBrowserBtn = document.getElementById('close-browser-btn');
    206 +    160 + 56     -800 801    const fileTree = document.getElementById('file-tree');
    207 +    161 + 57     -801 802    const currentFolderNameEl = document.getElementById('current-folder-name');
    208 +    162 + 58     -@@ -804,6 +805,7 @@ graph TD
    209 +    163 + 59     -804 805    // Folder browser state (using let to allow reassignment)
    210 +    164 + 60     -805 806    let folderFiles = [];
    211 +    165 + 61     -806 807    let activeFileHandle = null;
    212 +    166 + 62     -    808 +  const sidebarCollapsed = false;
    213 +    167 + 63     -807 809  
    214 +    168 + 64     -808 810    // Open folder handler
    215 +    169 + 65     -809 811    openFolderBtn.addEventListener('click', async () => {
    216 +    170 + 66     -@@ -843,9 +845,26 @@ graph TD
    217 +    171 + 67     -843 845      console.log(`‚úÖ Loaded ${result.totalFiles} markdown files from ${result.folderName}`);
    218 +    172 + 68     -844 846    });
    219 +    173 + 69     -845 847  
    220 +    174 + 70     -846     -  // Close browser handler
    221 +    175 + 71     -    848 +  // Toggle sidebar collapse/expand
    222 +    176 + 72     -    849 +  toggleSidebarBtn.addEventListener('click', () => {
    223 +    177 + 73     -    850 +    if (fileBrowser.style.display === 'none') {
    224 +    178 + 74     -    851 +      // Expand sidebar
    225 +    179 + 75     -    852 +      fileBrowser.style.display = 'flex';
    226 +    180 + 76     -    853 +      toggleSidebarBtn.textContent = '‚óÄ Hide Files';
    227 +    181 + 77     -    854 +      toggleSidebarBtn.title = 'Hide File Browser';
    228 +    182 + 78     -    855 +    } else {
    229 +    183 + 79     -    856 +      // Collapse sidebar (keep data)
    230 +    184 + 80     -    857 +      fileBrowser.style.display = 'none';
    231 +    185 + 81     -    858 +      toggleSidebarBtn.textContent = '‚ñ∂ Show Files';
    232 +    186 + 82     -    859 +      toggleSidebarBtn.title = 'Show File Browser';
    233 +    187 + 83     -    860 +    }
    234 +    188 + 84     -    861 +  });
    235 +    189 + 85     -    862 +
    236 +    190 + 86     -    863 +  // Close browser handler (clears data)
    237 +    191 + 87     -847 864    closeBrowserBtn.addEventListener('click', () => {
    238 +    192 + 88     -848 865      fileBrowser.style.display = 'none';
    239 +    193 + 89     -    866 +    toggleSidebarBtn.style.display = 'none';
    240 +    194 + 90     -    867 +    openFolderBtn.style.display = 'inline-block';
    241 +    195 + 91     -849 868      folderFiles = [];
    242 +    196 + 92     -850 869      activeFileHandle = null;
    243 +    197 + 93     -851 870    });
    244 +    198 + 94     -852 871  
    245 +    199 +     92 +@@ -145,101 +145,10 @@ function configureMarkedExtensions() {
    246 +    200 +     93 +145 145      return;
    247 +    201 +     94 +146 146    }
    248 +    202 +     95 +147 147  
    249 +    203 +     96 +148     -  // Add LaTeX environment extensions
    250 +    204 +     97 +    148 +  // Add inline math and text formatting extensions only
    251 +    205 +     98 +    149 +  // LaTeX environments (align, gather, etc.) are not supported by KaTeX
    252 +    206 +     99 +149 150    marked.use({
    253 +    207 +    100 +150 151      extensions: [
    254 +    208 +    101 +151     -      {
    255 +    209 +    102 +152     -        name: 'latexEnvironment',
    256 +    210 +    103 +153     -        level: 'block',
    257 +    211 +    104 +154     -        start(src) {
    258 +    212 +    105 +155     -          return src.match(/^\\begin\{/)?.index;
    259 +    213 +    106 +156     -        },
    260 +    214 +    107 +157     -        tokenizer(src) {
    261 +    215 +    108 +158     -          const match = src.match(/^\\begin\{([^}]+)\}([\s\S]*?)\\end\{\1\}/);
    262 +    216 +    109 +159     -          if (match) {
    263 +    217 +    110 +160     -            return {
    264 +    218 +    111 +161     -              type: 'latexEnvironment',
    265 +    219 +    112 +162     -              raw: match[0],
    266 +    220 +    113 +163     -              text: match[0],
    267 +    221 +    114 +164     -            };
    268 +    222 +    115 +165     -          }
    269 +    223 +    116 +166     -        },
    270 +    224 +    117 +167     -        renderer(token) {
    271 +    225 +    118 +168     -          try {
    272 +    226 +    119 +169     -            const rendered = katex.renderToString(token.text, {
    273 +    227 +    120 +170     -              displayMode: true,
    274 +    228 +    121 +171     -              throwOnError: false,
    275 +    229 +    122 +172     -              trust: true,
    276 +    230 +    123 +173     -              strict: false,
    277 +    231 +    124 +174     -            });
    278 +    232 +    125 +175     -            return `<div class="katex-display">${rendered}</div>`;
    279 +    233 +    126 +176     -          } catch (e) {
    280 +    234 +    127 +177     -            console.warn('KaTeX environment render error:', e);
    281 +    235 +    128 +178     -            return `<div style="color: red; padding: 10px;">LaTeX Error: ${e.message}</div>`;
    282 +    236 +    129 +179     -          }
    283 +    237 +    130 +180     -        },
    284 +    238 +    131 +181     -      },
    285 +    239 +    132 +182     -      {
    286 +    240 +    133 +183     -        name: 'latexDisplayBracket',
    287 +    241 +    134 +184     -        level: 'block',
    288 +    242 +    135 +185     -        start(src) {
    289 +    243 +    136 +186     -          return src.match(/^\\\[/)?.index;
    290 +    244 +    137 +187     -        },
    291 +    245 +    138 +188     -        tokenizer(src) {
    292 +    246 +    139 +189     -          const match = src.match(/^\\\[([\s\S]*?)\\\]/);
    293 +    247 +    140 +190     -          if (match) {
    294 +    248 +    141 +191     -            return {
    295 +    249 +    142 +192     -              type: 'latexDisplayBracket',
    296 +    250 +    143 +193     -              raw: match[0],
    297 +    251 +    144 +194     -              text: match[1].trim(),
    298 +    252 +    145 +195     -            };
    299 +    253 +    146 +196     -          }
    300 +    254 +    147 +197     -        },
    301 +    255 +    148 +198     -        renderer(token) {
    302 +    256 +    149 +199     -          try {
    303 +    257 +    150 +200     -            const rendered = katex.renderToString(token.text, {
    304 +    258 +    151 +201     -              displayMode: true,
    305 +    259 +    152 +202     -              throwOnError: false,
    306 +    260 +    153 +203     -              trust: true,
    307 +    261 +    154 +204     -              strict: false,
    308 +    262 +    155 +205     -            });
    309 +    263 +    156 +206     -            return `<div class="katex-display">${rendered}</div>`;
    310 +    264 +    157 +207     -          } catch (e) {
    311 +    265 +    158 +208     -            console.warn('KaTeX bracket render error:', e);
    312 +    266 +    159 +209     -            return `<div style="color: red; padding: 10px;">LaTeX Error: ${e.message}</div>`;
    313 +    267 +    160 +210     -          }
    314 +    268 +    161 +211     -        },
    315 +    269 +    162 +212     -      },
    316 +    270 +    163 +213     -      {
    317 +    271 +    164 +214     -        name: 'latexInlineParen',
    318 +    272 +    165 +215     -        level: 'inline',
    319 +    273 +    166 +216     -        start(src) {
    320 +    274 +    167 +217     -          return src.match(/\\\(/)?.index;
    321 +    275 +    168 +218     -        },
    322 +    276 +    169 +219     -        tokenizer(src) {
    323 +    277 +    170 +220     -          const match = src.match(/^\\\(([\s\S]*?)\\\)/);
    324 +    278 +    171 +221     -          if (match) {
    325 +    279 +    172 +222     -            return {
    326 +    280 +    173 +223     -              type: 'latexInlineParen',
    327 +    281 +    174 +224     -              raw: match[0],
    328 +    282 +    175 +225     -              text: match[1].trim(),
    329 +    283 +    176 +226     -            };
    330 +    284 +    177 +227     -          }
    331 +    285 +    178 +228     -        },
    332 +    286 +    179 +229     -        renderer(token) {
    333 +    287 +    180 +230     -          try {
    334 +    288 +    181 +231     -            return katex.renderToString(token.text, {
    335 +    289 +    182 +232     -              displayMode: false,
    336 +    290 +    183 +233     -              throwOnError: false,
    337 +    291 +    184 +234     -              trust: true,
    338 +    292 +    185 +235     -              strict: false,
    339 +    293 +    186 +236     -            });
    340 +    294 +    187 +237     -          } catch (e) {
    341 +    295 +    188 +238     -            console.warn('KaTeX paren render error:', e);
    342 +    296 +    189 +239     -            return `<span style="color: red;">LaTeX Error</span>`;
    343 +    297 +    190 +240     -          }
    344 +    298 +    191 +241     -        },
    345 +    299 +    192 +242     -      },
    346 +    300 +    193 +243 152        {
    347 +    301 +    194 +244 153          name: 'mathBlock',
    348 +    302 +    195 +245 154          level: 'block',
    349 +    303 +    196 +@@ -503,101 +412,10 @@ graph TD
    350 +    304 +    197 +503 412      return textarea.value;
    351 +    305 +    198 +504 413    }
    352 +    306 +    199 +505 414  
    353 +    307 +    200 +506     -  // Add LaTeX environment extensions that render directly with KaTeX
    354 +    308 +    201 +    415 +  // Keep only subscript and superscript extensions
    355 +    309 +    202 +    416 +  // Remove LaTeX environment extensions that don't work with KaTeX
    356 +    310 +    203 +507 417    marked.use({
    357 +    311 +    204 +508 418      extensions: [
    358 +    312 +    205 +509     -      {
    359 +    313 +    206 +510     -        name: 'latexEnvironment',
    360 +    314 +    207 +511     -        level: 'block',
    361 +    315 +    208 +512     -        start(src) {
    362 +    316 +    209 +513     -          return src.match(/^\\begin\{/)?.index;
    363 +    317 +    210 +514     -        },
    364 +    318 +    211 +515     -        tokenizer(src) {
    365 +    319 +    212 +516     -          const match = src.match(/^\\begin\{([^}]+)\}([\s\S]*?)\\end\{\1\}/);
    366 +    320 +    213 +517     -          if (match) {
    367 +    321 +    214 +518     -            return {
    368 +    322 +    215 +519     -              type: 'latexEnvironment',
    369 +    323 +    216 +520     -              raw: match[0],
    370 +    324 +    217 +521     -              text: match[0],
    371 +    325 +    218 +522     -            };
    372 +    326 +    219 +523     -          }
    373 +    327 +    220 +524     -        },
    374 +    328 +    221 +525     -        renderer(token) {
    375 +    329 +    222 +526     -          try {
    376 +    330 +    223 +527     -            const rendered = katex.renderToString(token.text, {
    377 +    331 +    224 +528     -              displayMode: true,
    378 +    332 +    225 +529     -              throwOnError: false,
    379 +    333 +    226 +530     -              trust: true,
    380 +    334 +    227 +531     -              strict: false,
    381 +    335 +    228 +532     -            });
    382 +    336 +    229 +533     -            return `<div class="katex-display">${rendered}</div>`;
    383 +    337 +    230 +534     -          } catch (e) {
    384 +    338 +    231 +535     -            console.warn('KaTeX environment render error:', e);
    385 +    339 +    232 +536     -            return `<div style="color: red; padding: 10px;">LaTeX Error: ${e.message}</div>`;
    386 +    340 +    233 +537     -          }
    387 +    341 +    234 +538     -        },
    388 +    342 +    235 +539     -      },
    389 +    343 +    236 +540     -      {
    390 +    344 +    237 +541     -        name: 'latexDisplayBracket',
    391 +    345 +    238 +542     -        level: 'block',
    392 +    346 +    239 +543     -        start(src) {
    393 +    347 +    240 +544     -          return src.match(/^\\\[/)?.index;
    394 +    348 +    241 +545     -        },
    395 +    349 +    242 +546     -        tokenizer(src) {
    396 +    350 +    243 +547     -          const match = src.match(/^\\\[([\s\S]*?)\\\]/);
    397 +    351 +    244 +548     -          if (match) {
    398 +    352 +    245 +549     -            return {
    399 +    353 +    246 +550     -              type: 'latexDisplayBracket',
    400 +    354 +    247 +551     -              raw: match[0],
    401 +    355 +    248 +552     -              text: match[1].trim(),
    402 +    356 +    249 +553     -            };
    403 +    357 +    250 +554     -          }
    404 +    358 +    251 +555     -        },
    405 +    359 +    252 +556     -        renderer(token) {
    406 +    360 +    253 +557     -          try {
    407 +    361 +    254 +558     -            const rendered = katex.renderToString(token.text, {
    408 +    362 +    255 +559     -              displayMode: true,
    409 +    363 +    256 +560     -              throwOnError: false,
    410 +    364 +    257 +561     -              trust: true,
    411 +    365 +    258 +562     -              strict: false,
    412 +    366 +    259 +563     -            });
    413 +    367 +    260 +564     -            return `<div class="katex-display">${rendered}</div>`;
    414 +    368 +    261 +565     -          } catch (e) {
    415 +    369 +    262 +566     -            console.warn('KaTeX bracket render error:', e);
    416 +    370 +    263 +567     -            return `<div style="color: red; padding: 10px;">LaTeX Error: ${e.message}</div>`;
    417 +    371 +    264 +568     -          }
    418 +    372 +    265 +569     -        },
    419 +    373 +    266 +570     -      },
    420 +    374 +    267 +571     -      {
    421 +    375 +    268 +572     -        name: 'latexInlineParen',
    422 +    376 +    269 +573     -        level: 'inline',
    423 +    377 +    270 +574     -        start(src) {
    424 +    378 +    271 +575     -          return src.match(/\\\(/)?.index;
    425 +    379 +    272 +576     -        },
    426 +    380 +    273 +577     -        tokenizer(src) {
    427 +    381 +    274 +578     -          const match = src.match(/^\\\(([\s\S]*?)\\\)/);
    428 +    382 +    275 +579     -          if (match) {
    429 +    383 +    276 +580     -            return {
    430 +    384 +    277 +581     -              type: 'latexInlineParen',
    431 +    385 +    278 +582     -              raw: match[0],
    432 +    386 +    279 +583     -              text: match[1].trim(),
    433 +    387 +    280 +584     -            };
    434 +    388 +    281 +585     -          }
    435 +    389 +    282 +586     -        },
    436 +    390 +    283 +587     -        renderer(token) {
    437 +    391 +    284 +588     -          try {
    438 +    392 +    285 +589     -            return katex.renderToString(token.text, {
    439 +    393 +    286 +590     -              displayMode: false,
    440 +    394 +    287 +591     -              throwOnError: false,
    441 +    395 +    288 +592     -              trust: true,
    442 +    396 +    289 +593     -              strict: false,
    443 +    397 +    290 +594     -            });
    444 +    398 +    291 +595     -          } catch (e) {
    445 +    399 +    292 +596     -            console.warn('KaTeX paren render error:', e);
    446 +    400 +    293 +597     -            return `<span style="color: red;">LaTeX Error</span>`;
    447 +    401 +    294 +598     -          }
    448 +    402 +    295 +599     -        },
    449 +    403 +    296 +600     -      },
    450 +    404 +    297 +601 419        {
    451 +    405 +    298 +602 420          name: 'subscript',
    452 +    406 +    299 +603 421          level: 'inline',
    453 +    407 +    300 +@@ -641,7 +459,7 @@ graph TD
    454 +    408 +    301 +641 459      ],
    455 +    409 +    302 +642 460    });
    456 +    410 +    303 +643 461  
    457 +    411 +    304 +644     -  console.log('‚úÖ LaTeX environments, subscript, and superscript enabled');
    458 +    412 +    305 +    462 +  console.log('‚úÖ Subscript and superscript enabled (LaTeX environments display as-is)');
    459 +    413 +    306 +645 463  
    460 +    414 +    307 +646 464    // Render markdown
    461 +    415 +    308 +647 465    function renderMarkdown() {
    462 +    416 +    309 +@@ -685,22 +503,9 @@ graph TD
    463 +    417 +    310 +685 503        // Apply Prism syntax highlighting using PrismService
    464 +    418 +    311 +686 504        prismService.highlightAll(preview);
    465 +    419 +    312 +687 505  
    466 +    420 +    313 +688     -      // Apply KaTeX auto-render only for any remaining $...$ syntax
    467 +    421 +    314 +689     -      if (typeof renderMathInElement !== 'undefined') {
    468 +    422 +    315 +690     -        try {
    469 +    423 +    316 +691     -          renderMathInElement(preview, {
    470 +    424 +    317 +692     -            delimiters: [
    471 +    425 +    318 +693     -              { left: '$$', right: '$$', display: true },
    472 +    426 +    319 +694     -              { left: '$', right: '$', display: false },
    473 +    427 +    320 +695     -            ],
    474 +    428 +    321 +696     -            throwOnError: false,
    475 +    429 +    322 +697     -            trust: true,
    476 +    430 +    323 +698     -            strict: false,
    477 +    431 +    324 +699     -          });
    478 +    432 +    325 +700     -        } catch (e) {
    479 +    433 +    326 +701     -          console.warn('KaTeX auto-render error:', e);
    480 +    434 +    327 +702     -        }
    481 +    435 +    328 +703     -      }
    482 +    436 +    329 +    506 +      // NOTE: KaTeX auto-render is DISABLED
    483 +    437 +    330 +    507 +      // We handle all math via marked.js extensions ($...$ and $$...$$)
    484 +    438 +    331 +    508 +      // KaTeX auto-render was causing issues with unsupported LaTeX environments
    485 +    439 +    332 +704 509  
    486 +    440 +    333 +705 510        // Save content using StorageManager
    487 +    441 +    334 +706 511        storageManager.set('markdownContent', markdownText);
    488 +    442 +    335 +@@ -1167,11 +972,21 @@ graph TD
    489 +    443 +    336 +1167 972    // Load saved theme using ThemeManager
    490 +    444 +    337 +1168 973    const savedTheme = storageManager.get('selectedTheme');
    491 +    445 +    338 +1169 974    if (savedTheme) {
    492 +    446 +    339 +1170     -    themeSelector.value = savedTheme;
    493 +    447 +    340 +1171     -    themeManager.loadTheme(savedTheme).catch(err => {
    494 +    448 +    341 +1172     -      console.error('Failed to load saved theme:', err);
    495 +    449 +    342 +1173     -      themeManager.loadTheme('default-light');
    496 +    450 +    343 +1174     -    });
    497 +    451 +    344 +    975 +    // Load theme first, then sync dropdown only on success
    498 +    452 +    345 +    976 +    themeManager
    499 +    453 +    346 +    977 +      .loadTheme(savedTheme)
    500 +    454 +    347 +    978 +      .then(() => {
    501 +    455 +    348 +    979 +        // Theme loaded successfully - sync dropdown
    502 +    456 +    349 +    980 +        themeSelector.value = savedTheme;
    503 +    457 +    350 +    981 +        console.log(`‚úÖ Theme restored: ${savedTheme}`);
    504 +    458 +    351 +    982 +      })
    505 +    459 +    352 +    983 +      .catch(err => {
    506 +    460 +    353 +    984 +        console.error('Failed to load saved theme:', err);
    507 +    461 +    354 +    985 +        // Fallback to default-light on error
    508 +    462 +    355 +    986 +        themeManager.loadTheme('default-light').then(() => {
    509 +    463 +    356 +    987 +          themeSelector.value = 'default-light';
    510 +    464 +    357 +    988 +        });
    511 +    465 +    358 +    989 +      });
    512 +    466 +    359 +1175 990    }
    513 +    467 +    360 +1176 991  
    514 +    468 +    361 +1177 992    // Zoom functionality
    515 +    469 +    362 +1178 993  
    516 +    470 +    363 +
    517 +    471 +    364 +```
    518 +    472 +    365 +
    519 +    473 +    366 +
    520 +    474 +    367 +### üìÑ `themes/sunset-dark.css`
    521 +    475 +    368 +
    522 +    476 +    369 +**Type:** Stylesheet üé®
    523 +    477 +    370 +
    524 +    478 +    371 +```diff
    525 +    479 +    372 +@@ -1,4 +1,4 @@
    526 +    480 +    373 +  1     -r/* Sunset Dark Theme */
    527 +    481 +    374 +      1 +/* Sunset Dark Theme */
    528 +    482 +    375 +  2   2  :root {
    529 +    483 +    376 +  3   3    --bg-primary: #1c0a00;
    530 +    484 +    377 +  4   4    --bg-secondary: #2d1b0e;
    531 +    485 +    378 +  5   5  
    532 +    486 + 95 379  
    533 +    487 + 96 380  ```
    534 +    488 + 97 381  
    535 +    489 +@@ -137,4 +421,4 @@ Please provide specific feedback on:
    536 +    490 +137 421  
    537 +    491 +138 422  ---
    538 +    492 +139 423  *Generated by AI Visual Code Review v2.0 - Unified Export Script*
    539 +    493 +140     -*Files processed: 2/2 | Errors: 0 | Generated: 2025-12-06T22:55:31.083Z*
    540 +    494 +    424 +*Files processed: 3/3 | Errors: 0 | Generated: 2025-12-07T02:57:20.361Z*
    541 +    495 +141 425  
    542 +    496 +
    543 +    497 +```
    544 +    498 +
    545 +    499 +
    546 +    500 +### ‚ú® `docs/02-architecture/mermaid-theme-architecture.md` **[ADDED]**
    547 +    501 +
    548 +    502 +**Status:** ‚úÖ **NEW FILE** - This file has been newly created
    549 +    503 +
    550 +    504 +**Type:** Documentation üìñ
    551 +    505 +
    552 +    506 +```diff
    553 +    507 +@@ -0,0 +1,208 @@
    554 +    508 +      1 +# Mermaid Theme Architecture - Comprehensive Reference
    555 +    509 +      2 +
    556 +    510 +      3 +**Last Updated:** 12/7/2025
    557 +    511 +      4 +**Source:** Official Mermaid.js theming documentation
    558 +    512 +      5 +
    559 +    513 +      6 +## Complete Mermaid Theme Variables
    560 +    514 +      7 +
    561 +    515 +      8 +### Core Global Variables
    562 +    516 +      9 +
    563 +    517 +     10 +| Variable     | Type       | Description                  | Default                        |
    564 +    518 +     11 +| ------------ | ---------- | ---------------------------- | ------------------------------ |
    565 +    519 +     12 +| `background` | Background | Page background              | `#f4f4f4`                      |
    566 +    520 +     13 +| `fontFamily` | Text       | Font family                  | `trebuchet ms, verdana, arial` |
    567 +    521 +     14 +| `fontSize`   | Text       | Font size                    | `16px`                         |
    568 +    522 +     15 +| `darkMode`   | Boolean    | Affects color calculations   | `false`                        |
    569 +    523 +     16 +| `textColor`  | Text       | General text over background | calculated                     |
    570 +    524 +     17 +| `lineColor`  | Line       | Lines and connections        | calculated                     |
    571 +    525 +     18 +| `mainBkg`    | Background | Main background for objects  | calculated                     |
    572 +    526 +     19 +
    573 +    527 +     20 +### Primary/Secondary/Tertiary Color Sets
    574 +    528 +     21 +
    575 +    529 +     22 +Each set has 3 variables (background, text, border):
    576 +    530 +     23 +
    577 +    531 +     24 +| Variable               | Type       | Description                |
    578 +    532 +     25 +| ---------------------- | ---------- | -------------------------- |
    579 +    533 +     26 +| `primaryColor`         | Background | Primary node background    |
    580 +    534 +     27 +| `primaryTextColor`     | Text       | Text in primary nodes      |
    581 +    535 +     28 +| `primaryBorderColor`   | Border     | Border for primary nodes   |
    582 +    536 +     29 +| `secondaryColor`       | Background | Secondary node background  |
    583 +    537 +     30 +| `secondaryTextColor`   | Text       | Text in secondary nodes    |
    584 +    538 +     31 +| `secondaryBorderColor` | Border     | Border for secondary nodes |
    585 +    539 +     32 +| `tertiaryColor`        | Background | Tertiary node background   |
    586 +    540 +     33 +| `tertiaryTextColor`    | Text       | Text in tertiary nodes     |
    587 +    541 +     34 +| `tertiaryBorderColor`  | Border     | Border for tertiary nodes  |
    588 +    542 +     35 +
    589 +    543 +     36 +### Flowchart-Specific Variables
    590 +    544 +     37 +
    591 +    545 +     38 +| Variable              | Type       | Description           |
    592 +    546 +     39 +| --------------------- | ---------- | --------------------- |
    593 +    547 +     40 +| `nodeBorder`          | Border     | Node border color     |
    594 +    548 +     41 +| `clusterBkg`          | Background | Subgraph background   |
    595 +    549 +     42 +| `clusterBorder`       | Border     | Subgraph border       |
    596 +    550 +     43 +| `defaultLinkColor`    | Line       | Link/edge color       |
    597 +    551 +     44 +| `titleColor`          | Text       | Title text color      |
    598 +    552 +     45 +| `edgeLabelBackground` | Background | Edge label background |
    599 +    553 +     46 +| `nodeTextColor`       | Text       | Text inside nodes     |
    600 +    554 +     47 +
    601 +    555 +     48 +### Sequence Diagram Variables
    602 +    556 +     49 +
    603 +    557 +     50 +| Variable                | Type       | Description           |
    604 +    558 +     51 +| ----------------------- | ---------- | --------------------- |
    605 +    559 +     52 +| `actorBkg`              | Background | Actor box background  |
    606 +    560 +     53 +| `actorBorder`           | Border     | Actor box border      |
    607 +    561 +     54 +| `actorTextColor`        | Text       | Actor text            |
    608 +    562 +     55 +| `actorLineColor`        | Line       | Actor lifeline        |
    609 +    563 +     56 +| `signalColor`           | Line       | Signal arrows         |
    610 +    564 +     57 +| `signalTextColor`       | Text       | Signal labels         |
    611 +    565 +     58 +| `labelBoxBkgColor`      | Background | Label box background  |
    612 +    566 +     59 +| `labelBoxBorderColor`   | Border     | Label box border      |
    613 +    567 +     60 +| `labelTextColor`        | Text       | Label text            |
    614 +    568 +     61 +| `loopTextColor`         | Text       | Loop text             |
    615 +    569 +     62 +| `activationBorderColor` | Border     | Activation border     |
    616 +    570 +     63 +| `activationBkgColor`    | Background | Activation background |
    617 +    571 +     64 +| `sequenceNumberColor`   | Text       | Sequence numbers      |
    618 +    572 +     65 +
    619 +    573 +     66 +### Pie Chart Variables
    620 +    574 +     67 +
    621 +    575 +     68 +| Variable              | Type       | Description                           |
    622 +    576 +     69 +| --------------------- | ---------- | ------------------------------------- |
    623 +    577 +     70 +| `pie1` - `pie12`      | Background | Fill colors for sections              |
    624 +    578 +     71 +| `pieTitleTextSize`    | Text       | Title font size (default: `25px`)     |
    625 +    579 +     72 +| `pieTitleTextColor`   | Text       | Title text color                      |
    626 +    580 +     73 +| `pieSectionTextSize`  | Text       | Section label size (default: `17px`)  |
    627 +    581 +     74 +| `pieSectionTextColor` | Text       | **Section label color (ON SLICES!)**  |
    628 +    582 +     75 +| `pieLegendTextSize`   | Text       | Legend font size (default: `17px`)    |
    629 +    583 +     76 +| `pieLegendTextColor`  | Text       | Legend text color                     |
    630 +    584 +     77 +| `pieStrokeColor`      | Border     | Slice borders (default: `black`)      |
    631 +    585 +     78 +| `pieStrokeWidth`      | Border     | Slice border width (default: `2px`)   |
    632 +    586 +     79 +| `pieOuterStrokeWidth` | Border     | Outer circle width (default: `2px`)   |
    633 +    587 +     80 +| `pieOuterStrokeColor` | Border     | Outer circle color (default: `black`) |
    634 +    588 +     81 +| `pieOpacity`          | Visual     | Slice opacity (default: `0.7`)        |
    635 +    589 +     82 +
    636 +    590 +     83 +### State Diagram Variables
    637 +    591 +     84 +
    638 +    592 +     85 +| Variable        | Type       | Description                |
    639 +    593 +     86 +| --------------- | ---------- | -------------------------- |
    640 +    594 +     87 +| `labelColor`    | Text       | State label color          |
    641 +    595 +     88 +| `altBackground` | Background | Composite state background |
    642 +    596 +     89 +
    643 +    597 +     90 +### Class Diagram Variables
    644 +    598 +     91 +
    645 +    599 +     92 +| Variable    | Type | Description      |
    646 +    600 +     93 +| ----------- | ---- | ---------------- |
    647 +    601 +     94 +| `classText` | Text | Class text color |
    648 +    602 +     95 +
    649 +    603 +     96 +### User Journey Variables
    650 +    604 +     97 +
    651 +    605 +     98 +| Variable                  | Type       | Description   |
    652 +    606 +     99 +| ------------------------- | ---------- | ------------- |
    653 +    607 +    100 +| `fillType0` - `fillType7` | Background | Section fills |
    654 +    608 +    101 +
    655 +    609 +    102 +## Critical Insights
    656 +    610 +    103 +
    657 +    611 +    104 +### 1. Pie Section Text Contrast Issue
    658 +    612 +    105 +
    659 +    613 +    106 +**Problem:** `pieSectionTextColor` is text **ON** the colored pie slices!
    660 +    614 +    107 +
    661 +    615 +    108 +- If slices are dark and text is dark ‚Üí **UNREADABLE**
    662 +    616 +    109 +- If slices are light and text is light ‚Üí **UNREADABLE**
    663 +    617 +    110 +
    664 +    618 +    111 +**Solution:** `pieSectionTextColor` must contrast with `pie1-pie12` colors!
    665 +    619 +    112 +
    666 +    620 +    113 +### 2. Background vs Text Variables
    667 +    621 +    114 +
    668 +    622 +    115 +- **Background variables** (end with `Bkg`, `Color`, or are named `pie1-12`)
    669 +    623 +    116 +- **Text variables** (contain `Text` or `textColor`)
    670 +    624 +    117 +- **Border variables** (contain `Border` or `Stroke`)
    671 +    625 +    118 +- **Line variables** (contain `Line` or `lineColor`)
    672 +    626 +    119 +
    673 +    627 +    120 +### 3. Calculated vs Explicit
    674 +    628 +    121 +
    675 +    629 +    122 +- Mermaid **calculates** many colors if not provided
    676 +    630 +    123 +- But calculation may not match our theme aesthetics
    677 +    631 +    124 +- **We should set ALL critical variables explicitly**
    678 +    632 +    125 +
    679 +    633 +    126 +## Implementation Strategy
    680 +    634 +    127 +
    681 +    635 +    128 +### For Each Theme, Define
    682 +    636 +    129 +
    683 +    637 +    130 +1. **Core Backgrounds** (3 levels for hierarchy)
    684 +    638 +    131 +   - `primaryColor`, `secondaryColor`, `tertiaryColor`
    685 +    639 +    132 +
    686 +    640 +    133 +2. **All Text Colors** (must contrast with their backgrounds!)
    687 +    641 +    134 +   - `primaryTextColor`, `secondaryTextColor`, `tertiaryTextColor`
    688 +    642 +    135 +   - `nodeTextColor`, `actorTextColor`, `signalTextColor`
    689 +    643 +    136 +   - `pieTitleTextColor`, `pieSectionTextColor`, `pieLegendTextColor`
    690 +    644 +    137 +
    691 +    645 +    138 +3. **All Border Colors** (visible against backgrounds)
    692 +    646 +    139 +   - `primaryBorderColor`, `secondaryBorderColor`, `tertiaryBorderColor`
    693 +    647 +    140 +   - `nodeBorder`, `actorBorder`, `clusterBorder`
    694 +    648 +    141 +   - `pieStrokeColor`, `pieOuterStrokeColor`
    695 +    649 +    142 +
    696 +    650 +    143 +4. **Line/Connection Colors**
    697 +    651 +    144 +   - `lineColor`, `defaultLinkColor`
    698 +    652 +    145 +   - `signalColor`, `actorLineColor`
    699 +    653 +    146 +
    700 +    654 +    147 +5. **Pie Slice Backgrounds** (12 distinct colors)
    701 +    655 +    148 +   - `pie1` through `pie12` - must be DISTINCT from text color!
    702 +    656 +    149 +
    703 +    657 +    150 +## Architecture Pattern
    704 +    658 +    151 +
    705 +    659 +    152 +```javascript
    706 +    660 +    153 +mermaid.initialize({
    707 +    661 +    154 +  theme: 'base',
    708 +    662 +    155 +  themeVariables: {
    709 +    663 +    156 +    // Core (affects ALL diagrams)
    710 +    664 +    157 +    background: bgPrimary,
    711 +    665 +    158 +    fontFamily: '...',
    712 +    666 +    159 +    fontSize: '16px',
    713 +    667 +    160 +
    714 +    668 +    161 +    // Primary set (most nodes)
    715 +    669 +    162 +    primaryColor: [BACKGROUND],
    716 +    670 +    163 +    primaryTextColor: [TEXT - must contrast!],
    717 +    671 +    164 +    primaryBorderColor: [BORDER - visible],
    718 +    672 +    165 +
    719 +    673 +    166 +    // Secondary set (clusters, special nodes)
    720 +    674 +    167 +    secondaryColor: [BACKGROUND],
    721 +    675 +    168 +    secondaryTextColor: [TEXT - must contrast!],
    722 +    676 +    169 +    secondaryBorderColor: [BORDER - visible],
    723 +    677 +    170 +
    724 +    678 +    171 +    // Tertiary set (nested elements)
    725 +    679 +    172 +    tertiaryColor: [BACKGROUND],
    726 +    680 +    173 +    tertiaryTextColor: [TEXT - must contrast!],
    727 +    681 +    174 +    tertiaryBorderColor: [BORDER - visible],
    728 +    682 +    175 +
    729 +    683 +    176 +    // Flowchart specific
    730 +    684 +    177 +    nodeBorder: [VISIBLE],
    731 +    685 +    178 +    nodeTextColor: [CONTRASTING],
    732 +    686 +    179 +    edgeLabelBackground: [BACKGROUND],
    733 +    687 +    180 +
    734 +    688 +    181 +    // Sequence diagram specific
    735 +    689 +    182 +    actorBkg: [BACKGROUND],
    736 +    690 +    183 +    actorTextColor: [CONTRASTING],
    737 +    691 +    184 +
    738 +    692 +    185 +    // Pie chart specific
    739 +    693 +    186 +    pie1-12: [12 DISTINCT COLORS],
    740 +    694 +    187 +    pieSectionTextColor: [CONTRASTS WITH pie1-12!],
    741 +    695 +    188 +
    742 +    696 +    189 +    // Lines
    743 +    697 +    190 +    lineColor: [VISIBLE],
    744 +    698 +    191 +    signalColor: [VISIBLE],
    745 +    699 +    192 +  }
    746 +    700 +    193 +});
    747 +    701 +    194 +```
    748 +    702 +    195 +
    749 +    703 +    196 +## Testing Checklist
    750 +    704 +    197 +
    751 +    705 +    198 +- [ ] Flowchart - nodes, clusters, edges readable
    752 +    706 +    199 +- [ ] Sequence diagram - actors, signals, loops readable
    753 +    707 +    200 +- [ ] Pie chart - slices, percentages, legend readable
    754 +    708 +    201 +- [ ] State diagram - states, transitions readable
    755 +    709 +    202 +- [ ] Class diagram - classes, methods readable
    756 +    710 +    203 +- [ ] User journey - tasks, emotions readable
    757 +    711 +    204 +
    758 +    712 +    205 +## References
    759 + 29 713      206 +
    760 + 30     -    207 +## Recent Fixes (Latest Session)
    761 + 31     -    208 +
    762 + 32     -    209 +### Theme Dropdown Sync Fix ‚úÖ
    763 +    714 +    207 +- [Mermaid Theming Documentation](https://mermaid.js.org/config/theming.html)
    764 +    715 +    208 +- [Base Theme Source](https://github.com/mermaid-js/mermaid/blob/develop/packages/mermaid/src/themes/theme-base.js)
    765 +    716 +    209  
    766 +    717 +
    767 +    718 +```
    768 +    719 +
    769 +    720 +
    770 +    721 +### ‚ú® `docs/02-architecture/prism-token-architecture.md` **[ADDED]**
    771 +    722 +
    772 +    723 +**Status:** ‚úÖ **NEW FILE** - This file has been newly created
    773 +    724 +
    774 +    725 +**Type:** Documentation üìñ
    775 +    726 +
    776 +    727 +```diff
    777 +    728 +@@ -0,0 +1,226 @@
    778 +    729 +      1 +# Prism Token Architecture - Comprehensive Reference
    779 +    730 +      2 +
    780 +    731 +      3 +**Last Updated:** 12/7/2025
    781 +    732 +      4 +**Source:** Official Prism.js documentation + One Dark theme analysis
    782 +    733 +      5 +
    783 +    734 +      6 +## Standard Token Classes
    784 +    735 +      7 +
    785 +    736 +      8 +### Core Language Constructs
    786 +    737 +      9 +
    787 +    738 +     10 +| Token Class   | Purpose                    | Example                                  | Recommended Color Hue             |
    788 +    739 +     11 +| ------------- | -------------------------- | ---------------------------------------- | --------------------------------- |
    789 +    740 +     12 +| `keyword`     | Reserved words             | `if`, `else`, `class`, `final`, `sealed` | Purple/Magenta (286¬∞)             |
    790 +    741 +     13 +| `builtin`     | Built-in functions/types   | `String`, `Array`, `Console`             | Green (95¬∞)                       |
    791 +    742 +     14 +| `class-name`  | Class/Interface/Type names | `Rectangle`, `Shape`, `Person`           | Orange (29¬∞)                      |
    792 +    743 +     15 +| `function`    | Function/method names      | `main`, `println`, `forEach`             | Blue (207¬∞)                       |
    793 +    744 +     16 +| `boolean`     | True/false values          | `true`, `false`                          | Orange (29¬∞)                      |
    794 +    745 +     17 +| `number`      | Numeric literals           | `42`, `3.14`, `0xDEADBEEF`               | Orange (29¬∞)                      |
    795 +    746 +     18 +| `string`      | String literals            | `"Hello"`, `'World'`                     | Green (95¬∞)                       |
    796 +    747 +     19 +| `char`        | Character literals         | `'A'`, `'\n'`                            | Green (95¬∞)                       |
    797 +    748 +     20 +| `symbol`      | Symbols (Smalltalk, Ruby)  | `:mySymbol`                              | Green (95¬∞)                       |
    798 +    749 +     21 +| `regex`       | Regular expressions        | `/[a-z]+/i`                              | Green (95¬∞)                       |
    799 +    750 +     22 +| `operator`    | Operators                  | `+`, `-`, `*`, `/`, `=`, `==`            | Purple (286¬∞)                     |
    800 +    751 +     23 +| `variable`    | Variable names (special)   | Less/Bash variables                      | Blue (207¬∞)                       |
    801 +    752 +     24 +| `constant`    | Constants                  | `PI`, `MAX_SIZE`, `stdout`               | Orange (29¬∞)                      |
    802 +    753 +     25 +| `property`    | Object properties          | CSS properties, JSON keys                | Red (355¬∞)                        |
    803 +    754 +     26 +| `punctuation` | Delimiters                 | `{`, `}`, `;`, `,`                       | Gray/White                        |
    804 +    755 +     27 +| `comment`     | Code comments              | `// comment`, `/* block */`              | Muted gray (220¬∞, low saturation) |
    805 +    756 +     28 +
    806 +    757 +     29 +### Markup-Specific Tokens
    807 +    758 +     30 +
    808 +    759 +     31 +| Token Class  | Purpose             | Example                     |
    809 +    760 +     32 +| ------------ | ------------------- | --------------------------- |
    810 +    761 +     33 +| `tag`        | HTML/XML tags       | `<div>`, `<p>`              |
    811 +    762 +     34 +| `attr-name`  | Attribute names     | `id`, `class`, `href`       |
    812 +    763 +     35 +| `attr-value` | Attribute values    | `"header"`, `"https://..."` |
    813 +    764 +     36 +| `namespace`  | XML namespaces      | `html:p`, `foo:bar`         |
    814 +    765 +     37 +| `prolog`     | XML prolog          | `<?xml version="1.0"?>`     |
    815 +    766 +     38 +| `doctype`    | DOCTYPE declaration | `<!DOCTYPE html>`           |
    816 +    767 +     39 +| `cdata`      | CDATA sections      | `<![CDATA[...]]>`           |
    817 +    768 +     40 +| `entity`     | HTML entities       | `&amp;`, `&#x2665;`         |
    818 +    769 +     41 +
    819 +    770 +     42 +### Document Markup Tokens
    820 +    771 +     43 +
    821 +    772 +     44 +| Token Class | Purpose         | Example      |
    822 +    773 +     45 +| ----------- | --------------- | ------------ |
    823 +    774 +     46 +| `bold`      | Bold text       | `**bold**`   |
    824 +    775 +     47 +| `italic`    | Italic text     | `*italic*`   |
    825 +    776 +     48 +| `important` | Important (CSS) | `!important` |
    826 +    777 +     49 +
    827 +    778 +     50 +### Stylesheet Tokens
    828 +    779 +     51 +
    829 +    780 +     52 +| Token Class | Purpose       | Example                  |
    830 +    781 +     53 +| ----------- | ------------- | ------------------------ |
    831 +    782 +     54 +| `atrule`    | CSS @ rules   | `@media`, `@import`      |
    832 +    783 +     55 +| `selector`  | CSS selectors | `.class`, `#id`, `div p` |
    833 +    784 +     56 +| `url`       | URLs          | `url(image.png)`         |
    834 +    785 +     57 +
    835 +    786 +     58 +### Diff Tokens
    836 +    787 +     59 +
    837 +    788 +     60 +| Token Class | Purpose       |
    838 +    789 +     61 +| ----------- | ------------- |
    839 +    790 +     62 +| `inserted`  | Added lines   |
    840 +    791 +     63 +| `deleted`   | Removed lines |
    841 +    792 +     64 +
    842 +    793 +     65 +## Professional Theme Analysis (One Dark)
    843 +    794 +     66 +
    844 +    795 +     67 +### Color Grouping Strategy
    845 +    796 +     68 +
    846 +    797 +     69 +One Dark uses **7 core hues** systematically:
    847 +    798 +     70 +
    848 +    799 +     71 +1. **mono-1** (220¬∞, 14%, 71%) - Default text
    849 +    800 +     72 +2. **mono-2** (220¬∞, 9%, 55%) - Secondary text
    850 +    801 +     73 +3. **mono-3** (220¬∞, 10%, 40%) - Comments
    851 +    802 +     74 +4. **hue-1** (187¬∞, 47%, 55%) - Cyan - URLs
    852 +    803 +     75 +5. **hue-2** (207¬∞, 82%, 66%) - Blue - Variables, operators, functions
    853 +    804 +     76 +6. **hue-3** (286¬∞, 60%, 67%) - Purple - Keywords
    854 +    805 +     77 +7. **hue-4** (95¬∞, 38%, 62%) - Green - Strings
    855 +    806 +     78 +8. **hue-5** (355¬∞, 65%, 65%) - Red - Properties, tags, symbols
    856 +    807 +     79 +9. **hue-6** (29¬∞, 54%, 61%) - Orange - Class names, constants, numbers
    857 +    808 +     80 +
    858 +    809 +     81 +### Token Grouping
    859 +    810 +     82 +
    860 +    811 +     83 +```css
    861 +    812 +     84 +/* Group 1: Comments */
    862 +    813 +     85 +.token.comment, .token.prolog, .token.cdata
    863 +    814 +     86 +
    864 +    815 +     87 +/* Group 2: Neutral (inherit default color) */
    865 +    816 +     88 +.token.doctype, .token.punctuation, .token.entity
    866 +    817 +     89 +
    867 +    818 +     90 +/* Group 3: Orange - Class names, constants, numbers */
    868 +    819 +     91 +.token.attr-name, .token.class-name, .token.boolean,
    869 +    820 +     92 +.token.constant, .token.number, .token.atrule
    870 +    821 +     93 +
    871 +    822 +     94 +/* Group 4: Purple - Keywords */
    872 +    823 +     95 +.token.keyword
    873 +    824 +     96 +
    874 +    825 +     97 +/* Group 5: Red - Properties, tags */
    875 +    826 +     98 +.token.property, .token.tag, .token.symbol,
    876 +    827 +     99 +.token.deleted, .token.important
    877 +    828 +    100 +
    878 +    829 +    101 +/* Group 6: Green - Strings, builtins */
    879 +    830 +    102 +.token.selector, .token.string, .token.char,
    880 +    831 +    103 +.token.builtin, .token.inserted, .token.regex,
    881 +    832 +    104 +.token.attr-value
    882 +    833 +    105 +
    883 +    834 +    106 +/* Group 7: Blue - Variables, operators, functions */
    884 +    835 +    107 +.token.variable, .token.operator, .token.function
    885 +    836 +    108 +
    886 +    837 +    109 +/* Group 8: Cyan - URLs */
    887 +    838 +    110 +.token.url
    888 +    839 +    111 +```
    889 +    840 +    112 +
    890 +    841 +    113 +### Language-Specific Overrides
    891 +    842 +    114 +
    892 +    843 +    115 +Professional themes use **cascading specificity** for language-specific rules:
    893 +    844 +    116 +
    894 +    845 +    117 +```css
    895 +    846 +    118 +/* JavaScript overrides */
    896 +    847 +    119 +.language-javascript .token.operator { color: purple; }
    897 +    848 +    120 +.language-javascript .token.template-string > .token.interpolation { ... }
    898 +    849 +    121 +
    899 +    850 +    122 +/* CSS overrides */
    900 +    851 +    123 +.language-css .token.selector { color: red; }
    901 +    852 +    124 +.language-css .token.property { color: gray; }
    902 +    853 +    125 +
    903 +    854 +    126 +/* JSON overrides */
    904 +    855 +    127 +.language-json .token.null.keyword { color: orange; }
    905 +    856 +    128 +
    906 +    857 +    129 +/* Markdown overrides */
    907 +    858 +    130 +.language-markdown .token.url { ... }
    908 +    859 +    131 +```
    909 +    860 +    132 +
    910 +    861 +    133 +## Implementation Architecture
    911 +    862 +    134 +
    912 +    863 +    135 +### CSS Specificity Levels
    913 +    864 +    136 +
    914 +    865 +    137 +1. **Base tokens** - All languages
    915 +    866 +    138 +2. **Language-specific overrides** - `.language-xxx .token.yyy`
    916 +    867 +    139 +3. **Nested tokens** - `.token.xxx > .token.yyy`
    917 +    868 +    140 +4. **Plugin overrides** - `.rainbow-braces`, `.diff-highlight`, etc.
    918 +    869 +    141 +
    919 +    870 +    142 +### Variable Mapping Strategy
    920 +    871 +    143 +
    921 +    872 +    144 +```css
    922 +    873 +    145 +/* Map standard Prism tokens to theme CSS variables */
    923 +    874 +    146 +.token.keyword {
    924 +    875 +    147 +  color: var(--syntax-keyword);
    925 +    876 +    148 +}
    926 +    877 +    149 +.token.string {
    927 +    878 +    150 +  color: var(--syntax-string);
    928 +    879 +    151 +}
    929 +    880 +    152 +.token.class-name {
    930 +    881 +    153 +  color: var(--syntax-class-name); /* Distinct variable! */
    931 +    882 +    154 +}
    932 +    883 +    155 +```
    933 +    884 +    156 +
    934 +    885 +    157 +### Token Aliases
    935 +    886 +    158 +
    936 +    887 +    159 +Prism uses aliases to group similar tokens:
    937 +    888 +    160 +
    938 +    889 +    161 +- `attr-value` can contain nested `punctuation` tokens
    939 +    890 +    162 +- `template-string` can contain `interpolation` with nested tokens
    940 +    891 +    163 +- Language definitions use `alias` property to inherit styles
    941 +    892 +    164 +
    942 +    893 +    165 +## Best Practices
    943 +    894 +    166 +
    944 +    895 +    167 +1. **Use Distinct Variables** - Don't reuse variables across semantically different tokens
    945 +    896 +    168 +2. **Follow Standards** - Match Prism's standard token names
    946 +    897 +    169 +3. **Language Overrides** - Use when default grouping doesn't fit
    947 +    898 +    170 +4. **Test Comprehensively** - Verify with multiple languages (Java, Python, JS, CSS, etc.)
    948 +    899 +    171 +5. **Font Weight** - Use bold/normal strategically for visual hierarchy
    949 +    900 +    172 +6. **Color Contrast** - Ensure WCAG AA compliance (4.5:1 for text)
    950 +    901 +    173 +
    951 +    902 +    174 +## Token Coverage Checklist
    952 +    903 +    175 +
    953 +    904 +    176 +### Must Cover (Core)
    954 +    905 +    177 +
    955 +    906 +    178 +- [ ] keyword
    956 +    907 +    179 +- [ ] builtin
    957 +    908 +    180 +- [ ] class-name (distinct from keyword!)
    958 +    909 +    181 +- [ ] function
    959 +    910 +    182 +- [ ] string
    960 +    911 +    183 +- [ ] number
    961 +    912 +    184 +- [ ] boolean
    962 +    913 +    185 +- [ ] comment
    963 +    914 +    186 +- [ ] operator
    964 +    915 +    187 +- [ ] punctuation
    965 +    916 +    188 +- [ ] variable
    966 +    917 +    189 +- [ ] property
    967 +    918 +    190 +- [ ] constant
    968 +    919 +    191 +- [ ] regex
    969 +    920 +    192 +
    970 +    921 +    193 +### Markup Languages
    971 +    922 +    194 +
    972 +    923 +    195 +- [ ] tag
    973 +    924 +    196 +- [ ] attr-name
    974 +    925 +    197 +- [ ] attr-value
    975 +    926 +    198 +- [ ] namespace
    976 +    927 +    199 +- [ ] doctype
    977 +    928 +    200 +- [ ] entity
    978 +    929 +    201 +
    979 +    930 +    202 +### Advanced
    980 +    931 +    203 +
    981 +    932 +    204 +- [ ] atrule (CSS)
    982 +    933 +    205 +- [ ] selector (CSS)
    983 +    934 +    206 +- [ ] url
    984 +    935 +    207 +- [ ] inserted/deleted (Diff)
    985 +    936 +    208 +- [ ] bold/italic (Markdown)
    986 +    937 +    209 +- [ ] important (CSS)
    987 + 33 938      210 +
    988 + 34     -    211 +**Problem:** Theme dropdown showing "Default Light" even when sunset-dark theme was loaded from LocalStorage.
    989 +    939 +    211 +## Implementation Checklist
    990 + 35 940      212 +
    991 + 36     -    213 +**Root Cause:** Race condition in theme loading - dropdown was being set BEFORE async theme load completed.
    992 + 37     -    214 +
    993 + 38     -    215 +**Solution:**
    994 + 39     -    216 +
    995 + 40     -    217 +```javascript
    996 + 41     -    218 +// OLD (buggy):
    997 + 42     -    219 +if (savedTheme) {
    998 + 43     -    220 +  themeSelector.value = savedTheme; // Sets immediately
    999 + 44     -    221 +  themeManager.loadTheme(savedTheme); // Async, not awaited
    1000 + 45     -    222 +}
    1001 +    941 +    213 +- [ ] Define comprehensive CSS variable palette (8-10 distinct hues)
    1002 +    942 +    214 +- [ ] Map ALL standard tokens to variables
    1003 +    943 +    215 +- [ ] Add language-specific overrides where needed
    1004 +    944 +    216 +- [ ] Test with Java (most complex token usage)
    1005 +    945 +    217 +- [ ] Test with Python, JavaScript, CSS
    1006 +    946 +    218 +- [ ] Verify font-weight hierarchy
    1007 +    947 +    219 +- [ ] Check color contrast ratios
    1008 +    948 +    220 +- [ ] Document color semantics
    1009 +    949 +    221 +
    1010 +    950 +    222 +## References
    1011 + 46 951      223 +
    1012 + 47     -    224 +// NEW (fixed):
    1013 + 48     -    225 +if (savedTheme) {
    1014 + 49     -    226 +  themeManager
    1015 + 50     -    227 +    .loadTheme(savedTheme)
    1016 + 51     -    228 +    .then(() => {
    1017 + 52     -    229 +      themeSelector.value = savedTheme; // Only after successful load
    1018 + 53     -    230 +      console.log(`‚úÖ Theme restored: ${savedTheme}`);
    1019 + 54     -    231 +    })
    1020 + 55     -    232 +    .catch(err => {
    1021 + 56     -    233 +      // Fallback with proper sync
    1022 + 57     -    234 +      themeManager.loadTheme('default-light').then(() => {
    1023 + 58     -    235 +        themeSelector.value = 'default-light';
    1024 + 59     -    236 +      });
    1025 + 60     -    237 +    });
    1026 + 61     -    238 +}
    1027 + 62     -    239 +```
    1028 + 63     -    240 +
    1029 + 64     -    241 +**Key Changes:**
    1030 + 65     -    242 +
    1031 + 66     -    243 +1. Await theme load completion before syncing dropdown
    1032 + 67     -    244 +2. Added success callback for dropdown update
    1033 + 68     -    245 +3. Added error handling with fallback
    1034 + 69     -    246 +4. Added console logging for debugging
    1035 + 70     -    247 +
    1036 + 71     -    248 +**Results:**
    1037 + 72     -    249 +
    1038 + 73     -    250 +- ‚úÖ Dropdown now syncs correctly with all themes
    1039 + 74     -    251 +- ‚úÖ No more race conditions
    1040 + 75     -    252 +- ‚úÖ Proper error handling
    1041 + 76     -    253 +- ‚úÖ Works for all 12 themes (6 theme families √ó 2 variants)
    1042 + 77     -    254 +
    1043 + 78     -    255 +**Files Modified:** `script.js` (lines 1167-1183)
    1044 + 79     -206 256  
    1045 + 80     -207 257  ## Performance Observations
    1046 + 81     -208 258  
    1047 + 82     -209 259  
    1048 +    952 +    224 +- [Prism Standard Tokens](https://prismjs.com/tokens.html)
    1049 +    953 +    225 +- [Prism Theme: One Dark](https://github.com/PrismJS/prism-themes/blob/master/themes/prism-one-dark.css)
    1050 +    954 +    226 +- [Atom One Dark Colors](https://github.com/atom/atom/tree/master/packages/one-dark-syntax)
    1051 +    955 +    227  
    1052 + 83 956  
    1053 + 84 957  ```
    1054 + 85 958  
    1055 +@@ -89,277 +962,2340 @@ memory-bank/activeContext.md |  52 +++++++++-
    1056 + 89 962  **Type:** JavaScript Source File üü®
    1057 + 90 963  
    1058 + 91 964  ```diff
    1059 + 92     -@@ -145,101 +145,10 @@ function configureMarkedExtensions() {
    1060 + 93     -145 145      return;
    1061 + 94     -146 146    }
    1062 + 95     -147 147  
    1063 + 96     -148     -  // Add LaTeX environment extensions
    1064 + 97     -    148 +  // Add inline math and text formatting extensions only
    1065 + 98     -    149 +  // LaTeX environments (align, gather, etc.) are not supported by KaTeX
    1066 + 99     -149 150    marked.use({
    1067 +100     -150 151      extensions: [
    1068 +101     -151     -      {
    1069 +102     -152     -        name: 'latexEnvironment',
    1070 +103     -153     -        level: 'block',
    1071 +104     -154     -        start(src) {
    1072 +105     -155     -          return src.match(/^\\begin\{/)?.index;
    1073 +106     -156     -        },
    1074 +107     -157     -        tokenizer(src) {
    1075 +108     -158     -          const match = src.match(/^\\begin\{([^}]+)\}([\s\S]*?)\\end\{\1\}/);
    1076 +109     -159     -          if (match) {
    1077 +110     -160     -            return {
    1078 +111     -161     -              type: 'latexEnvironment',
    1079 +112     -162     -              raw: match[0],
    1080 +113     -163     -              text: match[0],
    1081 +114     -164     -            };
    1082 +115     -165     -          }
    1083 +116     -166     -        },
    1084 +117     -167     -        renderer(token) {
    1085 +118     -168     -          try {
    1086 +119     -169     -            const rendered = katex.renderToString(token.text, {
    1087 +120     -170     -              displayMode: true,
    1088 +121     -171     -              throwOnError: false,
    1089 +122     -172     -              trust: true,
    1090 +123     -173     -              strict: false,
    1091 +124     -174     -            });
    1092 +125     -175     -            return `<div class="katex-display">${rendered}</div>`;
    1093 +126     -176     -          } catch (e) {
    1094 +127     -177     -            console.warn('KaTeX environment render error:', e);
    1095 +128     -178     -            return `<div style="color: red; padding: 10px;">LaTeX Error: ${e.message}</div>`;
    1096 +129     -179     -          }
    1097 +130     -180     -        },
    1098 +131     -181     -      },
    1099 +132     -182     -      {
    1100 +133     -183     -        name: 'latexDisplayBracket',
    1101 +134     -184     -        level: 'block',
    1102 +135     -185     -        start(src) {
    1103 +136     -186     -          return src.match(/^\\\[/)?.index;
    1104 +137     -187     -        },
    1105 +138     -188     -        tokenizer(src) {
    1106 +139     -189     -          const match = src.match(/^\\\[([\s\S]*?)\\\]/);
    1107 +140     -190     -          if (match) {
    1108 +141     -191     -            return {
    1109 +142     -192     -              type: 'latexDisplayBracket',
    1110 +143     -193     -              raw: match[0],
    1111 +144     -194     -              text: match[1].trim(),
    1112 +145     -195     -            };
    1113 +146     -196     -          }
    1114 +147     -197     -        },
    1115 +148     -198     -        renderer(token) {
    1116 +149     -199     -          try {
    1117 +150     -200     -            const rendered = katex.renderToString(token.text, {
    1118 +151     -201     -              displayMode: true,
    1119 +152     -202     -              throwOnError: false,
    1120 +153     -203     -              trust: true,
    1121 +154     -204     -              strict: false,
    1122 +155     -205     -            });
    1123 +156     -206     -            return `<div class="katex-display">${rendered}</div>`;
    1124 +157     -207     -          } catch (e) {
    1125 +158     -208     -            console.warn('KaTeX bracket render error:', e);
    1126 +159     -209     -            return `<div style="color: red; padding: 10px;">LaTeX Error: ${e.message}</div>`;
    1127 +160     -210     -          }
    1128 +161     -211     -        },
    1129 +162     -212     -      },
    1130 +163     -213     -      {
    1131 +164     -214     -        name: 'latexInlineParen',
    1132 +165     -215     -        level: 'inline',
    1133 +166     -216     -        start(src) {
    1134 +167     -217     -          return src.match(/\\\(/)?.index;
    1135 +168     -218     -        },
    1136 +169     -219     -        tokenizer(src) {
    1137 +170     -220     -          const match = src.match(/^\\\(([\s\S]*?)\\\)/);
    1138 +171     -221     -          if (match) {
    1139 +172     -222     -            return {
    1140 +173     -223     -              type: 'latexInlineParen',
    1141 +174     -224     -              raw: match[0],
    1142 +175     -225     -              text: match[1].trim(),
    1143 +176     -226     -            };
    1144 +177     -227     -          }
    1145 +178     -228     -        },
    1146 +179     -229     -        renderer(token) {
    1147 +180     -230     -          try {
    1148 +181     -231     -            return katex.renderToString(token.text, {
    1149 +182     -232     -              displayMode: false,
    1150 +183     -233     -              throwOnError: false,
    1151 +184     -234     -              trust: true,
    1152 +185     -235     -              strict: false,
    1153 +186     -236     -            });
    1154 +187     -237     -          } catch (e) {
    1155 +188     -238     -            console.warn('KaTeX paren render error:', e);
    1156 +189     -239     -            return `<span style="color: red;">LaTeX Error</span>`;
    1157 +190     -240     -          }
    1158 +191     -241     -        },
    1159 +192     -242     -      },
    1160 +193     -243 152        {
    1161 +194     -244 153          name: 'mathBlock',
    1162 +195     -245 154          level: 'block',
    1163 +196     -@@ -503,101 +412,10 @@ graph TD
    1164 +197     -503 412      return textarea.value;
    1165 +198     -504 413    }
    1166 +199     -505 414  
    1167 +200     -506     -  // Add LaTeX environment extensions that render directly with KaTeX
    1168 +201     -    415 +  // Keep only subscript and superscript extensions
    1169 +202     -    416 +  // Remove LaTeX environment extensions that don't work with KaTeX
    1170 +203     -507 417    marked.use({
    1171 +204     -508 418      extensions: [
    1172 +205     -509     -      {
    1173 +206     -510     -        name: 'latexEnvironment',
    1174 +207     -511     -        level: 'block',
    1175 +208     -512     -        start(src) {
    1176 +209     -513     -          return src.match(/^\\begin\{/)?.index;
    1177 +210     -514     -        },
    1178 +211     -515     -        tokenizer(src) {
    1179 +212     -516     -          const match = src.match(/^\\begin\{([^}]+)\}([\s\S]*?)\\end\{\1\}/);
    1180 +213     -517     -          if (match) {
    1181 +214     -518     -            return {
    1182 +215     -519     -              type: 'latexEnvironment',
    1183 +216     -520     -              raw: match[0],
    1184 +217     -521     -              text: match[0],
    1185 +218     -522     -            };
    1186 +219     -523     -          }
    1187 +220     -524     -        },
    1188 +221     -525     -        renderer(token) {
    1189 +222     -526     -          try {
    1190 +223     -527     -            const rendered = katex.renderToString(token.text, {
    1191 +224     -528     -              displayMode: true,
    1192 +225     -529     -              throwOnError: false,
    1193 +226     -530     -              trust: true,
    1194 +227     -531     -              strict: false,
    1195 +228     -532     -            });
    1196 +229     -533     -            return `<div class="katex-display">${rendered}</div>`;
    1197 +230     -534     -          } catch (e) {
    1198 +231     -535     -            console.warn('KaTeX environment render error:', e);
    1199 +232     -536     -            return `<div style="color: red; padding: 10px;">LaTeX Error: ${e.message}</div>`;
    1200 +233     -537     -          }
    1201 +234     -538     -        },
    1202 +235     -539     -      },
    1203 +236     -540     -      {
    1204 +237     -541     -        name: 'latexDisplayBracket',
    1205 +238     -542     -        level: 'block',
    1206 +239     -543     -        start(src) {
    1207 +240     -544     -          return src.match(/^\\\[/)?.index;
    1208 +241     -545     -        },
    1209 +242     -546     -        tokenizer(src) {
    1210 +243     -547     -          const match = src.match(/^\\\[([\s\S]*?)\\\]/);
    1211 +244     -548     -          if (match) {
    1212 +245     -549     -            return {
    1213 +246     -550     -              type: 'latexDisplayBracket',
    1214 +247     -551     -              raw: match[0],
    1215 +248     -552     -              text: match[1].trim(),
    1216 +249     -553     -            };
    1217 +250     -554     -          }
    1218 +251     -555     -        },
    1219 +252     -556     -        renderer(token) {
    1220 +253     -557     -          try {
    1221 +254     -558     -            const rendered = katex.renderToString(token.text, {
    1222 +255     -559     -              displayMode: true,
    1223 +256     -560     -              throwOnError: false,
    1224 +257     -561     -              trust: true,
    1225 +258     -562     -              strict: false,
    1226 +259     -563     -            });
    1227 +260     -564     -            return `<div class="katex-display">${rendered}</div>`;
    1228 +261     -565     -          } catch (e) {
    1229 +262     -566     -            console.warn('KaTeX bracket render error:', e);
    1230 +263     -567     -            return `<div style="color: red; padding: 10px;">LaTeX Error: ${e.message}</div>`;
    1231 +264     -568     -          }
    1232 +265     -569     -        },
    1233 +266     -570     -      },
    1234 +267     -571     -      {
    1235 +268     -572     -        name: 'latexInlineParen',
    1236 +269     -573     -        level: 'inline',
    1237 +270     -574     -        start(src) {
    1238 +271     -575     -          return src.match(/\\\(/)?.index;
    1239 +272     -576     -        },
    1240 +273     -577     -        tokenizer(src) {
    1241 +274     -578     -          const match = src.match(/^\\\(([\s\S]*?)\\\)/);
    1242 +275     -579     -          if (match) {
    1243 +276     -580     -            return {
    1244 +277     -581     -              type: 'latexInlineParen',
    1245 +278     -582     -              raw: match[0],
    1246 +279     -583     -              text: match[1].trim(),
    1247 +280     -584     -            };
    1248 +281     -585     -          }
    1249 +282     -586     -        },
    1250 +283     -587     -        renderer(token) {
    1251 +284     -588     -          try {
    1252 +285     -589     -            return katex.renderToString(token.text, {
    1253 +286     -590     -              displayMode: false,
    1254 +287     -591     -              throwOnError: false,
    1255 +288     -592     -              trust: true,
    1256 +289     -593     -              strict: false,
    1257 +290     -594     -            });
    1258 +291     -595     -          } catch (e) {
    1259 +292     -596     -            console.warn('KaTeX paren render error:', e);
    1260 +293     -597     -            return `<span style="color: red;">LaTeX Error</span>`;
    1261 +294     -598     -          }
    1262 +295     -599     -        },
    1263 +296     -600     -      },
    1264 +297     -601 419        {
    1265 +298     -602 420          name: 'subscript',
    1266 +299     -603 421          level: 'inline',
    1267 +300     -@@ -641,7 +459,7 @@ graph TD
    1268 +301     -641 459      ],
    1269 +302     -642 460    });
    1270 +303     -643 461  
    1271 +304     -644     -  console.log('‚úÖ LaTeX environments, subscript, and superscript enabled');
    1272 +305     -    462 +  console.log('‚úÖ Subscript and superscript enabled (LaTeX environments display as-is)');
    1273 +306     -645 463  
    1274 +307     -646 464    // Render markdown
    1275 +308     -647 465    function renderMarkdown() {
    1276 +309     -@@ -685,22 +503,9 @@ graph TD
    1277 +310     -685 503        // Apply Prism syntax highlighting using PrismService
    1278 +311     -686 504        prismService.highlightAll(preview);
    1279 +312     -687 505  
    1280 +313     -688     -      // Apply KaTeX auto-render only for any remaining $...$ syntax
    1281 +314     -689     -      if (typeof renderMathInElement !== 'undefined') {
    1282 +315     -690     -        try {
    1283 +316     -691     -          renderMathInElement(preview, {
    1284 +317     -692     -            delimiters: [
    1285 +318     -693     -              { left: '$$', right: '$$', display: true },
    1286 +319     -694     -              { left: '$', right: '$', display: false },
    1287 +320     -695     -            ],
    1288 +321     -696     -            throwOnError: false,
    1289 +322     -697     -            trust: true,
    1290 +323     -698     -            strict: false,
    1291 +324     -699     -          });
    1292 +325     -700     -        } catch (e) {
    1293 +326     -701     -          console.warn('KaTeX auto-render error:', e);
    1294 +327     -702     -        }
    1295 +328     -703     -      }
    1296 +329     -    506 +      // NOTE: KaTeX auto-render is DISABLED
    1297 +330     -    507 +      // We handle all math via marked.js extensions ($...$ and $$...$$)
    1298 +331     -    508 +      // KaTeX auto-render was causing issues with unsupported LaTeX environments
    1299 +332     -704 509  
    1300 +333     -705 510        // Save content using StorageManager
    1301 +334     -706 511        storageManager.set('markdownContent', markdownText);
    1302 +335     -@@ -1167,11 +972,21 @@ graph TD
    1303 +336     -1167 972    // Load saved theme using ThemeManager
    1304 +337     -1168 973    const savedTheme = storageManager.get('selectedTheme');
    1305 +338     -1169 974    if (savedTheme) {
    1306 +339     -1170     -    themeSelector.value = savedTheme;
    1307 +340     -1171     -    themeManager.loadTheme(savedTheme).catch(err => {
    1308 +341     -1172     -      console.error('Failed to load saved theme:', err);
    1309 +342     -1173     -      themeManager.loadTheme('default-light');
    1310 +343     -1174     -    });
    1311 +344     -    975 +    // Load theme first, then sync dropdown only on success
    1312 +345     -    976 +    themeManager
    1313 +346     -    977 +      .loadTheme(savedTheme)
    1314 +347     -    978 +      .then(() => {
    1315 +348     -    979 +        // Theme loaded successfully - sync dropdown
    1316 +349     -    980 +        themeSelector.value = savedTheme;
    1317 +350     -    981 +        console.log(`‚úÖ Theme restored: ${savedTheme}`);
    1318 +351     -    982 +      })
    1319 +352     -    983 +      .catch(err => {
    1320 +353     -    984 +        console.error('Failed to load saved theme:', err);
    1321 +354     -    985 +        // Fallback to default-light on error
    1322 +355     -    986 +        themeManager.loadTheme('default-light').then(() => {
    1323 +356     -    987 +          themeSelector.value = 'default-light';
    1324 +357     -    988 +        });
    1325 +358     -    989 +      });
    1326 +359     -1175 990    }
    1327 +360     -1176 991  
    1328 +361     -1177 992    // Zoom functionality
    1329 +362     -1178 993  
    1330 +    965 +@@ -20,9 +20,20 @@ const folderBrowserService = new FolderBrowserService(storageManager);
    1331 +    966 + 20  20  const currentFolderFiles = [];
    1332 +    967 + 21  21  const currentFileHandle = null;
    1333 +    968 + 22  22  
    1334 +    969 + 23     -// Configure theme change listener to update Mermaid
    1335 +    970 +     23 +// Global render function reference (will be set in setupEditor)
    1336 +    971 +     24 +let globalRenderMarkdown = null;
    1337 +    972 +     25 +
    1338 +    973 +     26 +// Configure theme change listener to update Mermaid and force re-render
    1339 +    974 + 24  27  themeManager.setThemeChangeListener(() => {
    1340 +    975 + 25  28    mermaidService.reinitialize();
    1341 +    976 +     29 +
    1342 +    977 +     30 +  // Force re-render of markdown to apply new Mermaid colors
    1343 +    978 +     31 +  setTimeout(() => {
    1344 +    979 +     32 +    if (globalRenderMarkdown) {
    1345 +    980 +     33 +      console.log('üîÑ Re-rendering diagrams with new theme colors');
    1346 +    981 +     34 +      globalRenderMarkdown();
    1347 +    982 +     35 +    }
    1348 +    983 +     36 +  }, 200);
    1349 +    984 + 26  37  });
    1350 +    985 + 27  38  
    1351 +    986 + 28  39  // Wait for all scripts to load
    1352 +    987 +@@ -77,8 +88,8 @@ function initializeApp() {
    1353 +    988 + 77  88    // Configure marked.js extensions
    1354 +    989 + 78  89    configureMarkedExtensions();
    1355 +    990 + 79  90  
    1356 +    991 + 80     -  // Initialize Mermaid with theme-aware configuration
    1357 +    992 + 81     -  initMermaidTheme();
    1358 +    993 +     91 +  // DON'T initialize Mermaid here - let saved theme load first
    1359 +    994 +     92 +  // Mermaid will initialize after theme loads in setupEditor()
    1360 +    995 + 82  93  
    1361 +    996 + 83  94    setupEditor();
    1362 +    997 + 84  95  }
    1363 +    998 +@@ -461,7 +472,7 @@ graph TD
    1364 +    999 +461 472  
    1365 +    1000 +462 473    console.log('‚úÖ Subscript and superscript enabled (LaTeX environments display as-is)');
    1366 +    1001 +463 474  
    1367 +    1002 +464     -  // Render markdown
    1368 +    1003 +    475 +  // Render markdown (expose globally for theme changes)
    1369 +    1004 +465 476    function renderMarkdown() {
    1370 +    1005 +466 477      try {
    1371 +    1006 +467 478        const markdownText = editor.value;
    1372 +    1007 +@@ -520,8 +531,16 @@ graph TD
    1373 +    1008 +520 531    async function changeTheme(themeName) {
    1374 +    1009 +521 532      await themeManager.loadTheme(themeName);
    1375 +    1010 +522 533  
    1376 +    1011 +523     -    // Re-render to apply new Mermaid theme (observer already handles reinit)
    1377 +    1012 +    534 +    // Wait for theme to load, then reinitialize Mermaid and force re-render
    1378 +    1013 +524 535      setTimeout(() => {
    1379 +    1014 +    536 +      // Clear existing Mermaid diagrams to force fresh render with new colors
    1380 +    1015 +    537 +      const mermaidElements = preview.querySelectorAll('.mermaid');
    1381 +    1016 +    538 +      mermaidElements.forEach(el => {
    1382 +    1017 +    539 +        // Reset to original code to force re-render
    1383 +    1018 +    540 +        el.innerHTML = el.dataset.originalCode || '';
    1384 +    1019 +    541 +      });
    1385 +    1020 +    542 +
    1386 +    1021 +    543 +      // Re-render markdown with new theme
    1387 +    1022 +525 544        renderMarkdown();
    1388 +    1023 +526 545      }, 100);
    1389 +    1024 +527 546    }
    1390 +    1025 +@@ -969,24 +988,36 @@ graph TD
    1391 +    1026 +969 988    // Initialize visibility
    1392 +    1027 +970 989    updateSyncScrollVisibility();
    1393 +    1028 +971 990  
    1394 +    1029 +972     -  // Load saved theme using ThemeManager
    1395 +    1030 +    991 +  // Load saved theme FIRST, then initialize Mermaid with correct colors
    1396 +    1031 +973 992    const savedTheme = storageManager.get('selectedTheme');
    1397 +    1032 +974 993    if (savedTheme) {
    1398 +    1033 +975     -    // Load theme first, then sync dropdown only on success
    1399 +    1034 +    994 +    // Load theme first, then sync dropdown and reinit Mermaid
    1400 +    1035 +976 995      themeManager
    1401 +    1036 +977 996        .loadTheme(savedTheme)
    1402 +    1037 +978 997        .then(() => {
    1403 +    1038 +979 998          // Theme loaded successfully - sync dropdown
    1404 +    1039 +980 999          themeSelector.value = savedTheme;
    1405 +    1040 +981 1000          console.log(`‚úÖ Theme restored: ${savedTheme}`);
    1406 +    1041 +    1001 +
    1407 +    1042 +    1002 +        // NOW initialize Mermaid with correct theme colors
    1408 +    1043 +    1003 +        mermaidService.initialize();
    1409 +    1044 +    1004 +
    1410 +    1045 +    1005 +        // Re-render to apply theme
    1411 +    1046 +    1006 +        renderMarkdown();
    1412 +    1047 +982 1007        })
    1413 +    1048 +983 1008        .catch(err => {
    1414 +    1049 +984 1009          console.error('Failed to load saved theme:', err);
    1415 +    1050 +985 1010          // Fallback to default-light on error
    1416 +    1051 +986 1011          themeManager.loadTheme('default-light').then(() => {
    1417 +    1052 +987 1012            themeSelector.value = 'default-light';
    1418 +    1053 +    1013 +          mermaidService.initialize();
    1419 +    1054 +    1014 +          renderMarkdown();
    1420 +    1055 +988 1015          });
    1421 +    1056 +989 1016        });
    1422 +    1057 +    1017 +  } else {
    1423 +    1058 +    1018 +    // No saved theme - initialize with default-light
    1424 +    1059 +    1019 +    mermaidService.initialize();
    1425 +    1060 +    1020 +    renderMarkdown();
    1426 +    1061 +990 1021    }
    1427 +    1062 +991 1022  
    1428 +    1063 +992 1023    // Zoom functionality
    1429 +    1064 +@@ -1332,6 +1363,9 @@ graph TD
    1430 +    1065 +1332 1363      console.log(`‚úÖ Loaded file: ${fileItem.name} (${result.size} bytes)`);
    1431 +    1066 +1333 1364    }
    1432 +    1067 +1334 1365  
    1433 +    1068 +1335     -  // Initial render
    1434 +    1069 +1336     -  renderMarkdown();
    1435 +    1070 +    1366 +  // Expose renderMarkdown globally for theme changes
    1436 +    1071 +    1367 +  globalRenderMarkdown = renderMarkdown;
    1437 +    1072 +    1368 +
    1438 +    1073 +    1369 +  // DON'T render immediately - wait for theme to load
    1439 +    1074 +    1370 +  // renderMarkdown will be called after theme loads above
    1440 +    1075 +1337 1371  }
    1441 +    1076 +1338 1372  
    1442 +    1077 +
    1443 +    1078 +```
    1444 +    1079 +
    1445 +    1080 +
    1446 +    1081 +### üìÑ `src/js/services/MermaidService.js`
    1447 +    1082 +
    1448 +    1083 +**Type:** JavaScript Source File üü®
    1449 +    1084 +
    1450 +    1085 +```diff
    1451 +    1086 +@@ -2,12 +2,51 @@
    1452 +    1087 +  2   2   * MermaidService - Mermaid Diagram Rendering Service
    1453 +    1088 +  3   3   *
    1454 +    1089 +  4   4   * Handles all Mermaid diagram rendering with theme-aware configuration.
    1455 +    1090 +      5 + * Automatically detects light/dark themes and adjusts for optimal readability.
    1456 +    1091 +  5   6   * Isolated service for better testability and maintainability.
    1457 +    1092 +  6   7   */
    1458 +    1093 +  7   8  
    1459 +    1094 +  8   9  import { MERMAID_CONFIG } from '../config/constants.js';
    1460 +    1095 +  9  10  import { getCssVariable } from '../utils/colorHelpers.js';
    1461 +    1096 + 10  11  
    1462 +    1097 +     12 +/**
    1463 +    1098 +     13 + * Calculate relative luminance of a color
    1464 +    1099 +     14 + * Used to detect if theme is light or dark
    1465 +    1100 +     15 + *
    1466 +    1101 +     16 + * @param {string} color - Hex color (#rrggbb)
    1467 +    1102 +     17 + * @returns {number} Luminance value (0-1)
    1468 +    1103 +     18 + * @private
    1469 +    1104 +     19 + */
    1470 +    1105 +     20 +function getRelativeLuminance(color) {
    1471 +    1106 +     21 +  // Remove # if present
    1472 +    1107 +     22 +  const hex = color.replace('#', '');
    1473 +    1108 +     23 +
    1474 +    1109 +     24 +  // Convert to RGB
    1475 +    1110 +     25 +  const r = parseInt(hex.substr(0, 2), 16) / 255;
    1476 +    1111 +     26 +  const g = parseInt(hex.substr(2, 2), 16) / 255;
    1477 +    1112 +     27 +  const b = parseInt(hex.substr(4, 2), 16) / 255;
    1478 +    1113 +     28 +
    1479 +    1114 +     29 +  // Apply sRGB gamma correction
    1480 +    1115 +     30 +  const rsRGB = r <= 0.03928 ? r / 12.92 : ((r + 0.055) / 1.055) ** 2.4;
    1481 +    1116 +     31 +  const gsRGB = g <= 0.03928 ? g / 12.92 : ((g + 0.055) / 1.055) ** 2.4;
    1482 +    1117 +     32 +  const bsRGB = b <= 0.03928 ? b / 12.92 : ((b + 0.055) / 1.055) ** 2.4;
    1483 +    1118 +     33 +
    1484 +    1119 +     34 +  // Calculate relative luminance
    1485 +    1120 +     35 +  return 0.2126 * rsRGB + 0.7152 * gsRGB + 0.0722 * bsRGB;
    1486 +    1121 +     36 +}
    1487 +    1122 +     37 +
    1488 +    1123 +     38 +/**
    1489 +    1124 +     39 + * Detect if current theme is light or dark
    1490 +    1125 +     40 + *
    1491 +    1126 +     41 + * @param {string} bgColor - Background color
    1492 +    1127 +     42 + * @returns {boolean} True if light theme
    1493 +    1128 +     43 + * @private
    1494 +    1129 +     44 + */
    1495 +    1130 +     45 +function isLightTheme(bgColor) {
    1496 +    1131 +     46 +  const luminance = getRelativeLuminance(bgColor);
    1497 +    1132 +     47 +  return luminance > 0.5; // Threshold for light/dark
    1498 +    1133 +     48 +}
    1499 +    1134 +     49 +
    1500 +    1135 + 11  50  /**
    1501 +    1136 + 12  51   * @class MermaidService
    1502 +    1137 + 13  52   * @description Service for rendering Mermaid diagrams with theme integration
    1503 +    1138 +@@ -23,46 +62,187 @@ export class MermaidService {
    1504 +    1139 + 23  62    }
    1505 +    1140 + 24  63  
    1506 +    1141 + 25  64    /**
    1507 +    1142 + 26     -   * Initialize Mermaid with current theme colors
    1508 +    1143 + 27     -   * Extracts theme colors from CSS variables and configures Mermaid
    1509 +    1144 +     65 +   * Initialize Mermaid with COMPREHENSIVE theme configuration
    1510 +    1145 +     66 +   * Reads ALL 60+ variables from theme CSS with smart fallbacks
    1511 +    1146 +     67 +   * Based on official Mermaid.js theming documentation
    1512 +    1147 + 28  68     *
    1513 +    1148 + 29  69     * @returns {void}
    1514 +    1149 + 30  70     */
    1515 +    1150 + 31  71    initialize() {
    1516 +    1151 + 32     -    // Extract theme colors from CSS variables
    1517 +    1152 + 33     -    const h1Color = getCssVariable('--h1-color');
    1518 +    1153 + 34     -    const h2Color = getCssVariable('--h2-color');
    1519 +    1154 + 35     -    const h3Color = getCssVariable('--h3-color');
    1520 +    1155 + 36     -    const bgSecondary = getCssVariable('--bg-secondary');
    1521 +    1156 + 37     -    const textPrimary = getCssVariable('--text-primary');
    1522 +    1157 +     72 +    // Helper to get variable with fallback
    1523 +    1158 +     73 +    const get = (varName, fallback) => {
    1524 +    1159 +     74 +      const value = getCssVariable(varName);
    1525 +    1160 +     75 +      return value && value.trim() !== '' ? value : fallback;
    1526 +    1161 +     76 +    };
    1527 +    1162 +     77 +
    1528 +    1163 +     78 +    // Extract core theme colors for fallbacks
    1529 +    1164 +     79 +    const bgPri = getCssVariable('--bg-primary');
    1530 +    1165 +     80 +    const bgSec = getCssVariable('--bg-secondary');
    1531 +    1166 +     81 +    const bgTer = getCssVariable('--bg-tertiary');
    1532 +    1167 +     82 +    const txtPri = getCssVariable('--text-primary');
    1533 +    1168 +     83 +    const txtSec = getCssVariable('--text-secondary');
    1534 +    1169 +     84 +    const h1 = getCssVariable('--h1-color');
    1535 +    1170 +     85 +    const h2 = getCssVariable('--h2-color');
    1536 +    1171 +     86 +    const h3 = getCssVariable('--h3-color');
    1537 +    1172 +     87 +
    1538 +    1173 +     88 +    const isLight = isLightTheme(bgPri);
    1539 +    1174 +     89 +    const nodeBkg = isLight ? bgTer : bgSec;
    1540 +    1175 +     90 +    const clusterBkg = isLight ? bgSec : bgTer;
    1541 +    1176 + 38  91  
    1542 +    1177 + 39     -    // Configure Mermaid with theme colors
    1543 +    1178 + 40  92      if (typeof mermaid !== 'undefined') {
    1544 +    1179 + 41  93        mermaid.initialize({
    1545 +    1180 + 42  94          startOnLoad: MERMAID_CONFIG.START_ON_LOAD,
    1546 +    1181 + 43  95          theme: MERMAID_CONFIG.THEME,
    1547 +    1182 + 44  96          themeVariables: {
    1548 +    1183 + 45     -          primaryColor: bgSecondary,
    1549 +    1184 + 46     -          primaryTextColor: textPrimary,
    1550 +    1185 + 47     -          primaryBorderColor: h1Color,
    1551 +    1186 + 48     -          lineColor: h2Color,
    1552 +    1187 + 49     -          secondaryColor: bgSecondary,
    1553 +    1188 + 50     -          tertiaryColor: bgSecondary,
    1554 +    1189 + 51     -          background: bgSecondary,
    1555 +    1190 + 52     -          mainBkg: bgSecondary,
    1556 +    1191 + 53     -          secondBkg: bgSecondary,
    1557 +    1192 + 54     -          tertiaryBkg: bgSecondary,
    1558 +    1193 + 55     -          nodeBorder: h1Color,
    1559 +    1194 + 56     -          clusterBkg: bgSecondary,
    1560 +    1195 + 57     -          clusterBorder: h3Color,
    1561 +    1196 + 58     -          titleColor: textPrimary,
    1562 +    1197 + 59     -          edgeLabelBackground: bgSecondary,
    1563 +    1198 + 60     -          nodeTextColor: textPrimary,
    1564 +    1199 +     97 +          // Core Global
    1565 +    1200 +     98 +          background: get('--mermaid-background', bgPri),
    1566 +    1201 + 61  99            fontFamily: '-apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif',
    1567 +    1202 +    100 +          fontSize: '16px',
    1568 +    1203 +    101 +          darkMode: !isLight,
    1569 +    1204 +    102 +          textColor: get('--mermaid-text-color', txtPri),
    1570 +    1205 +    103 +          lineColor: get('--mermaid-line-color', h2),
    1571 +    1206 +    104 +          mainBkg: get('--mermaid-main-bkg', nodeBkg),
    1572 +    1207 +    105 +
    1573 +    1208 +    106 +          // Primary Set
    1574 +    1209 +    107 +          primaryColor: get('--mermaid-primary-color', nodeBkg),
    1575 +    1210 +    108 +          primaryTextColor: get('--mermaid-primary-text-color', txtPri),
    1576 +    1211 +    109 +          primaryBorderColor: get('--mermaid-primary-border-color', h1),
    1577 +    1212 +    110 +
    1578 +    1213 +    111 +          // Secondary Set
    1579 +    1214 +    112 +          secondaryColor: get('--mermaid-secondary-color', clusterBkg),
    1580 +    1215 +    113 +          secondaryTextColor: get('--mermaid-secondary-text-color', txtPri),
    1581 +    1216 +    114 +          secondaryBorderColor: get('--mermaid-secondary-border-color', h2),
    1582 +    1217 +    115 +
    1583 +    1218 +    116 +          // Tertiary Set
    1584 +    1219 +    117 +          tertiaryColor: get('--mermaid-tertiary-color', bgPri),
    1585 +    1220 +    118 +          tertiaryTextColor: get('--mermaid-tertiary-text-color', txtPri),
    1586 +    1221 +    119 +          tertiaryBorderColor: get('--mermaid-tertiary-border-color', h3),
    1587 +    1222 +    120 +
    1588 +    1223 +    121 +          // Flowchart
    1589 +    1224 +    122 +          nodeBorder: get('--mermaid-node-border', h1),
    1590 +    1225 +    123 +          clusterBkg: get('--mermaid-cluster-bkg', clusterBkg),
    1591 +    1226 +    124 +          clusterBorder: get('--mermaid-cluster-border', h2),
    1592 +    1227 +    125 +          defaultLinkColor: get('--mermaid-default-link-color', h2),
    1593 +    1228 +    126 +          titleColor: get('--mermaid-title-color', txtPri),
    1594 +    1229 +    127 +          edgeLabelBackground: get('--mermaid-edge-label-background', bgPri),
    1595 +    1230 +    128 +          nodeTextColor: get('--mermaid-node-text-color', txtPri),
    1596 +    1231 +    129 +
    1597 +    1232 +    130 +          // Sequence Diagram
    1598 +    1233 +    131 +          actorBkg: get('--mermaid-actor-bkg', nodeBkg),
    1599 +    1234 +    132 +          actorBorder: get('--mermaid-actor-border', h1),
    1600 +    1235 +    133 +          actorTextColor: get('--mermaid-actor-text-color', txtPri),
    1601 +    1236 +    134 +          actorLineColor: get('--mermaid-actor-line-color', h1),
    1602 +    1237 +    135 +          signalColor: get('--mermaid-signal-color', h2),
    1603 +    1238 +    136 +          signalTextColor: get('--mermaid-signal-text-color', txtPri),
    1604 +    1239 +    137 +          labelBoxBkgColor: get('--mermaid-label-box-bkg-color', nodeBkg),
    1605 +    1240 +    138 +          labelBoxBorderColor: get('--mermaid-label-box-border-color', h1),
    1606 +    1241 +    139 +          labelTextColor: get('--mermaid-label-text-color', txtPri),
    1607 +    1242 +    140 +          loopTextColor: get('--mermaid-loop-text-color', txtPri),
    1608 +    1243 +    141 +          activationBorderColor: get('--mermaid-activation-border-color', h2),
    1609 +    1244 +    142 +          activationBkgColor: get('--mermaid-activation-bkg-color', clusterBkg),
    1610 +    1245 +    143 +          sequenceNumberColor: get('--mermaid-sequence-number-color', txtPri),
    1611 +    1246 +    144 +
    1612 +    1247 +    145 +          // Pie Chart
    1613 +    1248 +    146 +          pie1: get('--mermaid-pie1', h1),
    1614 +    1249 +    147 +          pie2: get('--mermaid-pie2', h2),
    1615 +    1250 +    148 +          pie3: get('--mermaid-pie3', h3),
    1616 +    1251 +    149 +          pie4: get('--mermaid-pie4', txtSec),
    1617 +    1252 +    150 +          pie5: get('--mermaid-pie5', h1),
    1618 +    1253 +    151 +          pie6: get('--mermaid-pie6', h2),
    1619 +    1254 +    152 +          pie7: get('--mermaid-pie7', h3),
    1620 +    1255 +    153 +          pie8: get('--mermaid-pie8', txtSec),
    1621 +    1256 +    154 +          pie9: get('--mermaid-pie9', h1),
    1622 +    1257 +    155 +          pie10: get('--mermaid-pie10', h2),
    1623 +    1258 +    156 +          pie11: get('--mermaid-pie11', h3),
    1624 +    1259 +    157 +          pie12: get('--mermaid-pie12', txtSec),
    1625 +    1260 +    158 +          pieTitleTextSize: '25px',
    1626 +    1261 +    159 +          pieTitleTextColor: get('--mermaid-pie-title-text-color', txtPri),
    1627 +    1262 +    160 +          pieSectionTextSize: '17px',
    1628 +    1263 +    161 +          pieSectionTextColor: get('--mermaid-pie-section-text-color', bgPri),
    1629 +    1264 +    162 +          pieLegendTextSize: '17px',
    1630 +    1265 +    163 +          pieLegendTextColor: get('--mermaid-pie-legend-text-color', txtPri),
    1631 +    1266 +    164 +          pieStrokeColor: get('--mermaid-pie-stroke-color', h1),
    1632 +    1267 +    165 +          pieStrokeWidth: '2px',
    1633 +    1268 +    166 +          pieOuterStrokeWidth: '2px',
    1634 +    1269 +    167 +          pieOuterStrokeColor: get('--mermaid-pie-outer-stroke-color', h1),
    1635 +    1270 +    168 +          pieOpacity: '0.9',
    1636 +    1271 +    169 +
    1637 +    1272 +    170 +          // State Diagram
    1638 +    1273 +    171 +          labelColor: get('--mermaid-label-color', txtPri),
    1639 +    1274 +    172 +          altBackground: get('--mermaid-alt-background', clusterBkg),
    1640 +    1275 +    173 +
    1641 +    1276 +    174 +          // Class Diagram
    1642 +    1277 +    175 +          classText: get('--mermaid-class-text', txtPri),
    1643 +    1278 +    176 +
    1644 +    1279 +    177 +          // User Journey
    1645 +    1280 +    178 +          fillType0: get('--mermaid-fill-type0', h1),
    1646 +    1281 +    179 +          fillType1: get('--mermaid-fill-type1', h2),
    1647 +    1282 +    180 +          fillType2: get('--mermaid-fill-type2', h3),
    1648 +    1283 +    181 +          fillType3: get('--mermaid-fill-type3', txtSec),
    1649 +    1284 +    182 +          fillType4: get('--mermaid-fill-type4', h1),
    1650 +    1285 +    183 +          fillType5: get('--mermaid-fill-type5', h2),
    1651 +    1286 +    184 +          fillType6: get('--mermaid-fill-type6', h3),
    1652 +    1287 +    185 +          fillType7: get('--mermaid-fill-type7', txtSec),
    1653 +    1288 +    186 +
    1654 +    1289 +    187 +          // Gantt Chart
    1655 +    1290 +    188 +          sectionBkgColor: get('--mermaid-section-bkg-color', bgSec),
    1656 +    1291 +    189 +          altSectionBkgColor: get('--mermaid-alt-section-bkg-color', bgTer),
    1657 +    1292 +    190 +          sectionBkgColor2: get('--mermaid-section-bkg-color2', bgSec),
    1658 +    1293 +    191 +          taskTextColor: get('--mermaid-task-text-color', txtPri),
    1659 +    1294 +    192 +          taskTextLightColor: get('--mermaid-task-text-light-color', txtPri),
    1660 +    1295 +    193 +          taskTextOutsideColor: get('--mermaid-task-text-outside-color', txtPri),
    1661 +    1296 +    194 +          taskTextClickableColor: get('--mermaid-task-text-clickable-color', h1),
    1662 +    1297 +    195 +          activeTaskBkgColor: get('--mermaid-active-task-bkg-color', h1),
    1663 +    1298 +    196 +          activeTaskBorderColor: get('--mermaid-active-task-border-color', h1),
    1664 +    1299 +    197 +          doneTaskBkgColor: get('--mermaid-done-task-bkg-color', h3),
    1665 +    1300 +    198 +          doneTaskBorderColor: get('--mermaid-done-task-border-color', h3),
    1666 +    1301 +    199 +          critBorderColor: get('--mermaid-crit-border-color', h2),
    1667 +    1302 +    200 +          critBkgColor: get('--mermaid-crit-bkg-color', h2),
    1668 +    1303 +    201 +          todayLineColor: get('--mermaid-today-line-color', h2),
    1669 +    1304 +    202 +          gridColor: get('--mermaid-grid-color', bgTer),
    1670 +    1305 +    203 +          sectionTextColor: get('--mermaid-section-text-color', txtPri),
    1671 +    1306 +    204 +          taskBorderColor: get('--mermaid-task-border-color', h1),
    1672 +    1307 +    205 +
    1673 +    1308 +    206 +          // ER Diagram
    1674 +    1309 +    207 +          attributeBackgroundColorOdd: get('--mermaid-attribute-background-color-odd', bgSec),
    1675 +    1310 +    208 +          attributeBackgroundColorEven: get('--mermaid-attribute-background-color-even', bgPri),
    1676 +    1311 +    209 +          relationshipLabelBackground: get('--mermaid-relationship-label-background', bgPri),
    1677 +    1312 +    210 +          relationshipLabelColor: get('--mermaid-relationship-label-color', txtPri),
    1678 +    1313 +    211 +          entityBackground: get('--mermaid-entity-background', nodeBkg),
    1679 +    1314 +    212 +          entityBorderColor: get('--mermaid-entity-border-color', h1),
    1680 +    1315 +    213 +
    1681 +    1316 +    214 +          // Git Graph
    1682 +    1317 +    215 +          git0: get('--mermaid-git0', h1),
    1683 +    1318 +    216 +          git1: get('--mermaid-git1', h2),
    1684 +    1319 +    217 +          git2: get('--mermaid-git2', h3),
    1685 +    1320 +    218 +          git3: get('--mermaid-git3', txtSec),
    1686 +    1321 +    219 +          git4: get('--mermaid-git4', h1),
    1687 +    1322 +    220 +          git5: get('--mermaid-git5', h2),
    1688 +    1323 +    221 +          git6: get('--mermaid-git6', h3),
    1689 +    1324 +    222 +          git7: get('--mermaid-git7', txtSec),
    1690 +    1325 +    223 +          gitInv0: get('--mermaid-git-inv0', bgPri),
    1691 +    1326 +    224 +          gitBranchLabel0: get('--mermaid-git-branch-label0', txtPri),
    1692 +    1327 +    225 +          gitBranchLabel1: get('--mermaid-git-branch-label1', txtPri),
    1693 +    1328 +    226 +          gitBranchLabel2: get('--mermaid-git-branch-label2', txtPri),
    1694 +    1329 +    227 +          gitBranchLabel3: get('--mermaid-git-branch-label3', txtPri),
    1695 +    1330 +    228 +          gitBranchLabel4: get('--mermaid-git-branch-label4', txtPri),
    1696 +    1331 +    229 +          commitLabelColor: get('--mermaid-commit-label-color', txtPri),
    1697 +    1332 +    230 +          commitLabelBackground: get('--mermaid-commit-label-background', bgPri),
    1698 +    1333 +    231 +          tagLabelColor: get('--mermaid-tag-label-color', txtPri),
    1699 +    1334 +    232 +          tagLabelBackground: get('--mermaid-tag-label-background', nodeBkg),
    1700 +    1335 +    233 +          tagLabelBorder: get('--mermaid-tag-label-border', h1),
    1701 +    1336 + 62 234          },
    1702 +    1337 + 63 235        });
    1703 +    1338 + 64 236  
    1704 +    1339 + 65 237        this.initialized = true;
    1705 +    1340 +    238 +
    1706 +    1341 +    239 +      // Debug: Log sample of loaded variables
    1707 +    1342 +    240 +      console.log(`‚úÖ Mermaid initialized`);
    1708 +    1343 +    241 +      console.log(`  - Background: ${get('--mermaid-background', bgPri)}`);
    1709 +    1344 +    242 +      console.log(`  - Text: ${get('--mermaid-text-color', txtPri)}`);
    1710 +    1345 +    243 +      console.log(`  - Line: ${get('--mermaid-line-color', h2)}`);
    1711 +    1346 +    244 +      console.log(`  - Primary: ${get('--mermaid-primary-color', nodeBkg)}`);
    1712 +    1347 +    245 +      console.log(`  - Pie1: ${get('--mermaid-pie1', h1)}`);
    1713 +    1348 + 66 246      } else {
    1714 +    1349 + 67 247        console.warn('Mermaid library not loaded');
    1715 +    1350 + 68 248      }
    1716 +    1351 + 69 249  
    1717 +    1352 +
    1718 +    1353 +```
    1719 +    1354 +
    1720 +    1355 +
    1721 +    1356 +### üìÑ `style.css`
    1722 +    1357 +
    1723 +    1358 +**Type:** Stylesheet üé®
    1724 +    1359 +
    1725 +    1360 +```diff
    1726 +    1361 +@@ -297,68 +297,119 @@ body {
    1727 +    1362 +297 297    padding: 0;
    1728 +    1363 +298 298  }
    1729 +    1364 +299 299  
    1730 +    1365 +300     -/* Syntax Highlighting with Custom Variables - Comprehensive Token Coverage */
    1731 +    1366 +301     -#markdown-preview .token.keyword {
    1732 +    1367 +302     -  color: var(--syntax-keyword, #c792ea) !important;
    1733 +    1368 +    300 +/* ==================== PRISM SYNTAX HIGHLIGHTING - PRODUCTION GRADE ==================== */
    1734 +    1369 +    301 +/* Based on One Dark theme architecture - comprehensive token coverage */
    1735 +    1370 +    302 +
    1736 +    1371 +    303 +/* Group 1: Comments and documentation */
    1737 +    1372 +    304 +#markdown-preview .token.comment,
    1738 +    1373 +    305 +#markdown-preview .token.prolog,
    1739 +    1374 +    306 +#markdown-preview .token.cdata {
    1740 +    1375 +    307 +  color: var(--syntax-comment, #7f85a3);
    1741 +    1376 +    308 +  font-style: italic;
    1742 +    1377 +303 309  }
    1743 +    1378 +304 310  
    1744 +    1379 +305     -#markdown-preview .token.string {
    1745 +    1380 +306     -  color: var(--syntax-string, #a5e844) !important;
    1746 +    1381 +307     -}
    1747 +    1382 +308     -
    1748 +    1383 +309     -#markdown-preview .token.number,
    1749 +    1384 +310     -#markdown-preview .token.boolean {
    1750 +    1385 +311     -  color: var(--syntax-number, #ffcb6b) !important;
    1751 +    1386 +312     -}
    1752 +    1387 +313     -
    1753 +    1388 +314     -#markdown-preview .token.function,
    1754 +    1389 +315     -#markdown-preview .token.function-variable,
    1755 +    1390 +316     -#markdown-preview .token.method,
    1756 +    1391 +317     -#markdown-preview .token.method-variable {
    1757 +    1392 +318     -  color: var(--syntax-function, #82aaff) !important;
    1758 +    1393 +319     -  font-weight: 600;
    1759 +    1394 +320     -}
    1760 +    1395 +321     -
    1761 +    1396 +322     -#markdown-preview .token.comment {
    1762 +    1397 +323     -  color: var(--syntax-comment, #7f85a3) !important;
    1763 +    1398 +324     -}
    1764 +    1399 +325     -
    1765 +    1400 +326     -#markdown-preview .token.operator {
    1766 +    1401 +327     -  color: var(--syntax-operator, #89ddff) !important;
    1767 +    1402 +328     -}
    1768 +    1403 +329     -
    1769 +    1404 +330     -#markdown-preview .token.punctuation {
    1770 +    1405 +331     -  color: var(--syntax-punctuation, #89ddff) !important;
    1771 +    1406 +    311 +/* Group 2: Neutral tokens (inherit or subtle) */
    1772 +    1407 +    312 +#markdown-preview .token.doctype,
    1773 +    1408 +    313 +#markdown-preview .token.punctuation,
    1774 +    1409 +    314 +#markdown-preview .token.entity {
    1775 +    1410 +    315 +  color: var(--syntax-punctuation, #64748b);
    1776 +    1411 +332 316  }
    1777 +    1412 +333 317  
    1778 +    1413 +    318 +/* Group 3: Orange hue - Class names, constants, numbers, booleans, atrules */
    1779 +    1414 +    319 +#markdown-preview .token.attr-name,
    1780 +    1415 +334 320  #markdown-preview .token.class-name,
    1781 +    1416 +335     -#markdown-preview .token.type-class-name {
    1782 +    1417 +336     -  color: var(--syntax-keyword, #ffcb6b) !important;
    1783 +    1418 +    321 +#markdown-preview .token.boolean,
    1784 +    1419 +    322 +#markdown-preview .token.constant,
    1785 +    1420 +    323 +#markdown-preview .token.number,
    1786 +    1421 +    324 +#markdown-preview .token.atrule {
    1787 +    1422 +    325 +  color: var(--syntax-class-name, #f97316);
    1788 +    1423 +337 326    font-weight: 600;
    1789 +    1424 +338 327  }
    1790 +    1425 +339 328  
    1791 +    1426 +340     -/* Variables and Parameters - NEW */
    1792 +    1427 +341     -#markdown-preview .token.parameter,
    1793 +    1428 +342     -#markdown-preview .token.variable,
    1794 +    1429 +343     -#markdown-preview .token.plain {
    1795 +    1430 +344     -  color: var(--syntax-variable, var(--text-primary)) !important;
    1796 +    1431 +345     -  font-weight: 500;
    1797 +    1432 +    329 +/* Group 4: Purple hue - Keywords (distinct from class names!) */
    1798 +    1433 +    330 +#markdown-preview .token.keyword {
    1799 +    1434 +    331 +  color: var(--syntax-keyword, #a855f7);
    1800 +    1435 +    332 +  font-weight: 700;
    1801 +    1436 +346 333  }
    1802 +    1437 +347 334  
    1803 +    1438 +348     -/* Properties and Namespaces - NEW */
    1804 +    1439 +    335 +/* Group 5: Red hue - Properties, tags, symbols, deleted, important */
    1805 +    1440 +349 336  #markdown-preview .token.property,
    1806 +    1441 +350     -#markdown-preview .token.property-access {
    1807 +    1442 +351     -  color: var(--syntax-property, var(--syntax-function)) !important;
    1808 +    1443 +    337 +#markdown-preview .token.tag,
    1809 +    1444 +    338 +#markdown-preview .token.symbol,
    1810 +    1445 +    339 +#markdown-preview .token.deleted,
    1811 +    1446 +    340 +#markdown-preview .token.important {
    1812 +    1447 +    341 +  color: var(--syntax-property, #ef4444);
    1813 +    1448 +    342 +  font-weight: 600;
    1814 +    1449 +352 343  }
    1815 +    1450 +353 344  
    1816 +    1451 +    345 +/* Group 6: Green hue - Strings, chars, builtins, inserted, regex, selectors */
    1817 +    1452 +    346 +#markdown-preview .token.selector,
    1818 +    1453 +    347 +#markdown-preview .token.string,
    1819 +    1454 +    348 +#markdown-preview .token.char,
    1820 +    1455 +    349 +#markdown-preview .token.builtin,
    1821 +    1456 +    350 +#markdown-preview .token.inserted,
    1822 +    1457 +    351 +#markdown-preview .token.regex,
    1823 +    1458 +    352 +#markdown-preview .token.attr-value {
    1824 +    1459 +    353 +  color: var(--syntax-string, #10b981);
    1825 +    1460 +    354 +}
    1826 +    1461 +    355 +
    1827 +    1462 +    356 +/* Nested attr-value punctuation (quotes) */
    1828 +    1463 +    357 +#markdown-preview .token.attr-value > .token.punctuation {
    1829 +    1464 +    358 +  color: var(--syntax-string, #10b981);
    1830 +    1465 +    359 +}
    1831 +    1466 +    360 +
    1832 +    1467 +    361 +/* Group 7: Blue hue - Variables, operators, functions */
    1833 +    1468 +    362 +#markdown-preview .token.variable,
    1834 +    1469 +    363 +#markdown-preview .token.operator,
    1835 +    1470 +    364 +#markdown-preview .token.function {
    1836 +    1471 +    365 +  color: var(--syntax-function, #3b82f6);
    1837 +    1472 +    366 +  font-weight: 600;
    1838 +    1473 +    367 +}
    1839 +    1474 +    368 +
    1840 +    1475 +    369 +/* Group 8: Cyan hue - URLs */
    1841 +    1476 +    370 +#markdown-preview .token.url {
    1842 +    1477 +    371 +  color: var(--syntax-url, #14b8a6);
    1843 +    1478 +    372 +}
    1844 +    1479 +    373 +
    1845 +    1480 +    374 +/* ==================== LANGUAGE-SPECIFIC OVERRIDES ==================== */
    1846 +    1481 +    375 +
    1847 +    1482 +    376 +/* JavaScript overrides */
    1848 +    1483 +    377 +#markdown-preview .language-javascript .token.operator {
    1849 +    1484 +    378 +  color: var(--syntax-keyword, #a855f7);
    1850 +    1485 +    379 +}
    1851 +    1486 +    380 +
    1852 +    1487 +    381 +/* CSS overrides */
    1853 +    1488 +    382 +#markdown-preview .language-css .token.selector {
    1854 +    1489 +    383 +  color: var(--syntax-property, #ef4444);
    1855 +    1490 +    384 +}
    1856 +    1491 +    385 +
    1857 +    1492 +    386 +#markdown-preview .language-css .token.property {
    1858 +    1493 +    387 +  color: var(--text-primary);
    1859 +    1494 +    388 +}
    1860 +    1495 +    389 +
    1861 +    1496 +    390 +/* JSON overrides */
    1862 +    1497 +    391 +#markdown-preview .language-json .token.operator {
    1863 +    1498 +    392 +  color: var(--syntax-punctuation, #64748b);
    1864 +    1499 +    393 +}
    1865 +    1500 +    394 +
    1866 +    1501 +    395 +#markdown-preview .language-json .token.null.keyword {
    1867 +    1502 +    396 +  color: var(--syntax-number, #fb923c);
    1868 +    1503 +    397 +}
    1869 +    1504 +    398 +
    1870 +    1505 +    399 +/* ==================== VISUAL ENHANCEMENTS ==================== */
    1871 +    1506 +    400 +
    1872 +    1507 +    401 +/* Bold/italic styling */
    1873 +    1508 +    402 +#markdown-preview .token.bold {
    1874 +    1509 +    403 +  font-weight: bold;
    1875 +    1510 +    404 +}
    1876 +    1511 +    405 +
    1877 +    1512 +    406 +#markdown-preview .token.italic {
    1878 +    1513 +    407 +  font-style: italic;
    1879 +    1514 +    408 +}
    1880 +    1515 +    409 +
    1881 +    1516 +    410 +/* Namespace opacity */
    1882 +    1517 +354 411  #markdown-preview .token.namespace {
    1883 +    1518 +355     -  color: var(--syntax-namespace, var(--syntax-keyword)) !important;
    1884 +    1519 +356     -  font-weight: 500;
    1885 +    1520 +357     -}
    1886 +    1521 +358     -
    1887 +    1522 +359     -#markdown-preview .token.builtin {
    1888 +    1523 +360     -  color: var(--syntax-builtin, var(--syntax-function)) !important;
    1889 +    1524 +361     -  font-weight: 500;
    1890 +    1525 +    412 +  opacity: 0.8;
    1891 +    1526 +362 413  }
    1892 +    1527 +363 414  
    1893 +    1528 +364 415  #markdown-preview blockquote {
    1894 +    1529 +365 416  
    1895 +    1530 +
    1896 +    1531 +```
    1897 +    1532 +
    1898 +    1533 +
    1899 +    1534 +### üìÑ `themes/default-dark.css`
    1900 +    1535 +
    1901 +    1536 +**Type:** Stylesheet üé®
    1902 +    1537 +
    1903 +    1538 +```diff
    1904 +    1539 +@@ -26,24 +26,184 @@
    1905 +    1540 + 26  26    --code-block-bg: #0d1117;
    1906 +    1541 + 27  27    --code-border: #30363d;
    1907 +    1542 + 28  28  
    1908 +    1543 + 29     -  /* Syntax Highlighting */
    1909 +    1544 + 30     -  --syntax-keyword: #ff7b72;
    1910 +    1545 + 31     -  --syntax-string: #a5e844;
    1911 +    1546 + 32     -  --syntax-number: #79c0ff;
    1912 +    1547 + 33     -  --syntax-function: #d2a8ff;
    1913 +    1548 + 34     -  --syntax-comment: #8b949e;
    1914 +    1549 + 35     -  --syntax-operator: #ff7b72;
    1915 +    1550 + 36     -  --syntax-punctuation: #7d8590;
    1916 +    1551 +     29 +  /* Syntax Highlighting - Production-Grade Token Colors (One Dark Architecture) */
    1917 +    1552 + 37  30  
    1918 +    1553 + 38     -  /* Additional Token Types */
    1919 +    1554 + 39     -  --syntax-variable: #79c0ff; /* Variables - blue (distinct from text #e6edf3) */
    1920 +    1555 + 40     -  --syntax-property: #d2a8ff; /* Properties - purple */
    1921 +    1556 + 41     -  --syntax-namespace: #ff7b72; /* Namespaces - red */
    1922 +    1557 + 42     -  --syntax-builtin: #d2a8ff; /* Builtins - purple */
    1923 +    1558 +     31 +  /* Core hue-1: Cyan - URLs */
    1924 +    1559 +     32 +  --syntax-url: #56d4dd; /* Cyan for URLs */
    1925 +    1560 +     33 +
    1926 +    1561 +     34 +  /* Core hue-2: Blue - Functions, variables */
    1927 +    1562 +     35 +  --syntax-function: #d2a8ff; /* Purple for functions */
    1928 +    1563 +     36 +  --syntax-variable: #79c0ff; /* Bright blue for variables */
    1929 +    1564 +     37 +
    1930 +    1565 +     38 +  /* Core hue-3: Red - Keywords */
    1931 +    1566 +     39 +  --syntax-keyword: #ff7b72; /* Coral red for keywords (final, sealed, class) */
    1932 +    1567 +     40 +
    1933 +    1568 +     41 +  /* Core hue-4: Green - Strings, builtins */
    1934 +    1569 +     42 +  --syntax-string: #a5d6ff; /* Light blue-green for strings */
    1935 +    1570 +     43 +  --syntax-builtin: #7ee787; /* Vibrant green for builtins (String, List) */
    1936 +    1571 +     44 +  --syntax-char: #a5d6ff; /* Same as strings */
    1937 +    1572 +     45 +  --syntax-regex: #a5d6ff; /* Same as strings */
    1938 +    1573 +     46 +  --syntax-inserted: #7ee787; /* For diff */
    1939 +    1574 +     47 +
    1940 +    1575 +     48 +  /* Core hue-5: Orange - Properties, tags */
    1941 +    1576 +     49 +  --syntax-property: #ffa657; /* Orange for properties */
    1942 +    1577 +     50 +  --syntax-tag: #ff7b72; /* Coral for tags */
    1943 +    1578 +     51 +  --syntax-deleted: #ff7b72; /* For diff */
    1944 +    1579 +     52 +  --syntax-important: #ffa657; /* For !important */
    1945 +    1580 +     53 +
    1946 +    1581 +     54 +  /* Core hue-6: Yellow - Class names, constants, numbers */
    1947 +    1582 +     55 +  --syntax-class-name: #ffa657; /* Orange for class names (Rectangle, Shape) */
    1948 +    1583 +     56 +  --syntax-number: #79c0ff; /* Blue for numbers */
    1949 +    1584 +     57 +  --syntax-constant: #79c0ff; /* Blue for constants */
    1950 +    1585 +     58 +  --syntax-boolean: #79c0ff; /* Same as numbers */
    1951 +    1586 +     59 +  --syntax-atrule: #d2a8ff; /* Purple for CSS @ rules */
    1952 +    1587 +     60 +
    1953 +    1588 +     61 +  /* Neutral colors */
    1954 +    1589 +     62 +  --syntax-comment: #8b949e; /* Gray for comments */
    1955 +    1590 +     63 +  --syntax-punctuation: #7d8590; /* Muted gray for punctuation */
    1956 +    1591 +     64 +  --syntax-operator: #ff7b72; /* Coral for operators */
    1957 +    1592 +     65 +
    1958 +    1593 +     66 +  /* Markup specific */
    1959 +    1594 +     67 +  --syntax-attr-name: #ffa657; /* Orange like class-name */
    1960 +    1595 +     68 +  --syntax-attr-value: #a5d6ff; /* Light blue like strings */
    1961 +    1596 +     69 +  --syntax-namespace: #d2a8ff; /* Purple */
    1962 +    1597 +     70 +  --syntax-entity: #7d8590; /* Neutral */
    1963 +    1598 +     71 +  --syntax-selector: #ffa657; /* Orange like properties */
    1964 +    1599 + 43  72  
    1965 +    1600 + 44  73    --blockquote-border: #bc8cff;
    1966 +    1601 + 45  74    --blockquote-bg: #161b22;
    1967 +    1602 + 46  75  
    1968 +    1603 + 47  76    --table-header-bg: #21262d;
    1969 +    1604 + 48  77    --table-border: #30363d;
    1970 +    1605 +     78 +
    1971 +    1606 +     79 +  /* === MERMAID COMPREHENSIVE CONFIGURATION === */
    1972 +    1607 +     80 +
    1973 +    1608 +     81 +  /* Core Global */
    1974 +    1609 +     82 +  --mermaid-background: #0d1117;
    1975 +    1610 +     83 +  --mermaid-text-color: #e6edf3;
    1976 +    1611 +     84 +  --mermaid-line-color: #58a6ff;
    1977 +    1612 +     85 +  --mermaid-main-bkg: #1c2128;
    1978 +    1613 +     86 +
    1979 +    1614 +     87 +  /* Primary Set - Main nodes/boxes */
    1980 +    1615 +     88 +  --mermaid-primary-color: #1c2128;
    1981 +    1616 +     89 +  --mermaid-primary-text-color: #e6edf3;
    1982 +    1617 +     90 +  --mermaid-primary-border-color: #58a6ff;
    1983 +    1618 +     91 +
    1984 +    1619 +     92 +  /* Secondary Set - Clusters/subgraphs */
    1985 +    1620 +     93 +  --mermaid-secondary-color: #161b22;
    1986 +    1621 +     94 +  --mermaid-secondary-text-color: #e6edf3;
    1987 +    1622 +     95 +  --mermaid-secondary-border-color: #bc8cff;
    1988 +    1623 +     96 +
    1989 +    1624 +     97 +  /* Tertiary Set - Edge labels */
    1990 +    1625 +     98 +  --mermaid-tertiary-color: #0d1117;
    1991 +    1626 +     99 +  --mermaid-tertiary-text-color: #e6edf3;
    1992 +    1627 +    100 +  --mermaid-tertiary-border-color: #ff7b72;
    1993 +    1628 +    101 +
    1994 +    1629 +    102 +  /* Flowchart */
    1995 +    1630 +    103 +  --mermaid-node-border: #58a6ff;
    1996 +    1631 +    104 +  --mermaid-cluster-bkg: #161b22;
    1997 +    1632 +    105 +  --mermaid-cluster-border: #bc8cff;
    1998 +    1633 +    106 +  --mermaid-default-link-color: #58a6ff;
    1999 +    1634 +    107 +  --mermaid-title-color: #e6edf3;
    2000 +    1635 +    108 +  --mermaid-edge-label-background: #0d1117;
    2001 +    1636 +    109 +  --mermaid-node-text-color: #e6edf3;
    2002 +    1637 +    110 +
    2003 +    1638 +    111 +  /* Sequence Diagram */
    2004 +    1639 +    112 +  --mermaid-actor-bkg: #1c2128;
    2005 +    1640 +    113 +  --mermaid-actor-border: #58a6ff;
    2006 +    1641 +    114 +  --mermaid-actor-text-color: #e6edf3;
    2007 +    1642 +    115 +  --mermaid-actor-line-color: #58a6ff;
    2008 +    1643 +    116 +  --mermaid-signal-color: #bc8cff;
    2009 +    1644 +    117 +  --mermaid-signal-text-color: #e6edf3;
    2010 +    1645 +    118 +  --mermaid-label-box-bkg-color: #1c2128;
    2011 +    1646 +    119 +  --mermaid-label-box-border-color: #58a6ff;
    2012 +    1647 +    120 +  --mermaid-label-text-color: #e6edf3;
    2013 +    1648 +    121 +  --mermaid-loop-text-color: #e6edf3;
    2014 +    1649 +    122 +  --mermaid-activation-border-color: #bc8cff;
    2015 +    1650 +    123 +  --mermaid-activation-bkg-color: #161b22;
    2016 +    1651 +    124 +  --mermaid-sequence-number-color: #e6edf3;
    2017 +    1652 +    125 +
    2018 +    1653 +    126 +  /* Pie Chart - 12 distinct slice colors + text */
    2019 +    1654 +    127 +  --mermaid-pie1: #58a6ff;
    2020 +    1655 +    128 +  --mermaid-pie2: #bc8cff;
    2021 +    1656 +    129 +  --mermaid-pie3: #ff7b72;
    2022 +    1657 +    130 +  --mermaid-pie4: #3fb950;
    2023 +    1658 +    131 +  --mermaid-pie5: #ffa657;
    2024 +    1659 +    132 +  --mermaid-pie6: #d2a8ff;
    2025 +    1660 +    133 +  --mermaid-pie7: #56d4dd;
    2026 +    1661 +    134 +  --mermaid-pie8: #7ee787;
    2027 +    1662 +    135 +  --mermaid-pie9: #a5d6ff;
    2028 +    1663 +    136 +  --mermaid-pie10: #79c0ff;
    2029 +    1664 +    137 +  --mermaid-pie11: #d2a8ff;
    2030 +    1665 +    138 +  --mermaid-pie12: #ffa657;
    2031 +    1666 +    139 +  --mermaid-pie-title-text-color: #e6edf3;
    2032 +    1667 +    140 +  --mermaid-pie-section-text-color: #0d1117; /* Dark on vibrant slices */
    2033 +    1668 +    141 +  --mermaid-pie-legend-text-color: #e6edf3;
    2034 +    1669 +    142 +  --mermaid-pie-stroke-color: #58a6ff;
    2035 +    1670 +    143 +  --mermaid-pie-outer-stroke-color: #58a6ff;
    2036 +    1671 +    144 +
    2037 +    1672 +    145 +  /* State Diagram */
    2038 +    1673 +    146 +  --mermaid-label-color: #e6edf3;
    2039 +    1674 +    147 +  --mermaid-alt-background: #161b22;
    2040 +    1675 +    148 +
    2041 +    1676 +    149 +  /* Class Diagram */
    2042 +    1677 +    150 +  --mermaid-class-text: #e6edf3;
    2043 +    1678 +    151 +
    2044 +    1679 +    152 +  /* User Journey - 8 distinct colors */
    2045 +    1680 +    153 +  --mermaid-fill-type0: #58a6ff;
    2046 +    1681 +    154 +  --mermaid-fill-type1: #bc8cff;
    2047 +    1682 +    155 +  --mermaid-fill-type2: #ff7b72;
    2048 +    1683 +    156 +  --mermaid-fill-type3: #3fb950;
    2049 +    1684 +    157 +  --mermaid-fill-type4: #ffa657;
    2050 +    1685 +    158 +  --mermaid-fill-type5: #d2a8ff;
    2051 +    1686 +    159 +  --mermaid-fill-type6: #56d4dd;
    2052 +    1687 +    160 +  --mermaid-fill-type7: #7ee787;
    2053 +    1688 +    161 +
    2054 +    1689 +    162 +  /* Gantt Chart */
    2055 +    1690 +    163 +  --mermaid-section-bkg-color: #1c2128;
    2056 +    1691 +    164 +  --mermaid-alt-section-bkg-color: #161b22;
    2057 +    1692 +    165 +  --mermaid-section-bkg-color2: #1c2128;
    2058 +    1693 +    166 +  --mermaid-task-text-color: #e6edf3;
    2059 +    1694 +    167 +  --mermaid-task-text-light-color: #e6edf3;
    2060 +    1695 +    168 +  --mermaid-task-text-outside-color: #e6edf3;
    2061 +    1696 +    169 +  --mermaid-task-text-clickable-color: #58a6ff;
    2062 +    1697 +    170 +  --mermaid-active-task-bkg-color: #58a6ff;
    2063 +    1698 +    171 +  --mermaid-active-task-border-color: #58a6ff;
    2064 +    1699 +    172 +  --mermaid-done-task-bkg-color: #3fb950;
    2065 +    1700 +    173 +  --mermaid-done-task-border-color: #3fb950;
    2066 +    1701 +    174 +  --mermaid-crit-border-color: #ff7b72;
    2067 +    1702 +    175 +  --mermaid-crit-bkg-color: #ff7b72;
    2068 +    1703 +    176 +  --mermaid-today-line-color: #ff7b72;
    2069 +    1704 +    177 +  --mermaid-grid-color: #30363d;
    2070 +    1705 +    178 +  --mermaid-section-text-color: #e6edf3;
    2071 +    1706 +    179 +  --mermaid-task-border-color: #58a6ff;
    2072 +    1707 +    180 +
    2073 +    1708 +    181 +  /* ER Diagram */
    2074 +    1709 +    182 +  --mermaid-attribute-background-color-odd: #161b22;
    2075 +    1710 +    183 +  --mermaid-attribute-background-color-even: #0d1117;
    2076 +    1711 +    184 +  --mermaid-relationship-label-background: #0d1117;
    2077 +    1712 +    185 +  --mermaid-relationship-label-color: #e6edf3;
    2078 +    1713 +    186 +  --mermaid-entity-background: #1c2128;
    2079 +    1714 +    187 +  --mermaid-entity-border-color: #58a6ff;
    2080 +    1715 +    188 +
    2081 +    1716 +    189 +  /* Git Graph */
    2082 +    1717 +    190 +  --mermaid-git0: #58a6ff;
    2083 +    1718 +    191 +  --mermaid-git1: #bc8cff;
    2084 +    1719 +    192 +  --mermaid-git2: #ff7b72;
    2085 +    1720 +    193 +  --mermaid-git3: #3fb950;
    2086 +    1721 +    194 +  --mermaid-git4: #ffa657;
    2087 +    1722 +    195 +  --mermaid-git5: #d2a8ff;
    2088 +    1723 +    196 +  --mermaid-git6: #56d4dd;
    2089 +    1724 +    197 +  --mermaid-git7: #7ee787;
    2090 +    1725 +    198 +  --mermaid-git-inv0: #0d1117;
    2091 +    1726 +    199 +  --mermaid-git-branch-label0: #e6edf3;
    2092 +    1727 +    200 +  --mermaid-git-branch-label1: #e6edf3;
    2093 +    1728 +    201 +  --mermaid-git-branch-label2: #e6edf3;
    2094 +    1729 +    202 +  --mermaid-git-branch-label3: #e6edf3;
    2095 +    1730 +    203 +  --mermaid-git-branch-label4: #e6edf3;
    2096 +    1731 +    204 +  --mermaid-commit-label-color: #e6edf3;
    2097 +    1732 +    205 +  --mermaid-commit-label-background: #0d1117;
    2098 +    1733 +    206 +  --mermaid-tag-label-color: #e6edf3;
    2099 +    1734 +    207 +  --mermaid-tag-label-background: #1c2128;
    2100 +    1735 +    208 +  --mermaid-tag-label-border: #58a6ff;
    2101 +    1736 + 49 209  }
    2102 +    1737 + 50 210  
    2103 +    1738 +
    2104 +    1739 +```
    2105 +    1740 +
    2106 +    1741 +
    2107 +    1742 +### üìÑ `themes/default-light.css`
    2108 +    1743 +
    2109 +    1744 +**Type:** Stylesheet üé®
    2110 +    1745 +
    2111 +    1746 +```diff
    2112 +    1747 +@@ -26,24 +26,184 @@
    2113 +    1748 + 26  26    --code-block-bg: #f6f8fa;
    2114 +    1749 + 27  27    --code-border: #d0d7de;
    2115 +    1750 + 28  28  
    2116 +    1751 + 29     -  /* Syntax Highlighting - Comprehensive Token Colors */
    2117 +    1752 + 30     -  --syntax-keyword: #cf222e;
    2118 +    1753 + 31     -  --syntax-string: #1a7f37;
    2119 +    1754 + 32     -  --syntax-number: #0550ae;
    2120 +    1755 + 33     -  --syntax-function: #8250df;
    2121 +    1756 + 34     -  --syntax-comment: #636c76;
    2122 +    1757 + 35     -  --syntax-operator: #cf222e;
    2123 +    1758 + 36     -  --syntax-punctuation: #636c76;
    2124 +    1759 +     29 +  /* Syntax Highlighting - Production-Grade Token Colors (One Dark Architecture) */
    2125 +    1760 + 37  30  
    2126 +    1761 + 38     -  /* Additional Token Types for Full Customization */
    2127 +    1762 + 39     -  --syntax-variable: #0550ae; /* Variables, parameters */
    2128 +    1763 + 40     -  --syntax-property: #1a7f37; /* Properties, attributes */
    2129 +    1764 + 41     -  --syntax-namespace: #cf222e; /* Namespaces */
    2130 +    1765 + 42     -  --syntax-builtin: #8250df; /* Built-in functions */
    2131 +    1766 +     31 +  /* Core hue-1: Cyan - URLs */
    2132 +    1767 +     32 +  --syntax-url: #0969da; /* GitHub blue for URLs */
    2133 +    1768 +     33 +
    2134 +    1769 +     34 +  /* Core hue-2: Blue - Functions, variables */
    2135 +    1770 +     35 +  --syntax-function: #8250df; /* Purple-blue for functions */
    2136 +    1771 +     36 +  --syntax-variable: #0550ae; /* Deep blue for variables */
    2137 +    1772 +     37 +
    2138 +    1773 +     38 +  /* Core hue-3: Red - Keywords */
    2139 +    1774 +     39 +  --syntax-keyword: #cf222e; /* GitHub red for keywords (final, sealed, class) */
    2140 +    1775 +     40 +
    2141 +    1776 +     41 +  /* Core hue-4: Green - Strings, builtins */
    2142 +    1777 +     42 +  --syntax-string: #1a7f37; /* GitHub green for strings */
    2143 +    1778 +     43 +  --syntax-builtin: #116329; /* Darker green for builtins (String, List) */
    2144 +    1779 +     44 +  --syntax-char: #1a7f37; /* Same as strings */
    2145 +    1780 +     45 +  --syntax-regex: #1a7f37; /* Same as strings */
    2146 +    1781 +     46 +  --syntax-inserted: #1a7f37; /* For diff */
    2147 +    1782 +     47 +
    2148 +    1783 +     48 +  /* Core hue-5: Orange/Brown - Properties, tags */
    2149 +    1784 +     49 +  --syntax-property: #bc4c00; /* Orange-brown for properties */
    2150 +    1785 +     50 +  --syntax-tag: #cf222e; /* Red for tags */
    2151 +    1786 +     51 +  --syntax-deleted: #cf222e; /* For diff */
    2152 +    1787 +     52 +  --syntax-important: #bc4c00; /* For !important */
    2153 +    1788 +     53 +
    2154 +    1789 +     54 +  /* Core hue-6: Blue - Class names, constants, numbers */
    2155 +    1790 +     55 +  --syntax-class-name: #0969da; /* Bright blue for class names (Rectangle, Shape) */
    2156 +    1791 +     56 +  --syntax-number: #0550ae; /* Deep blue for numbers */
    2157 +    1792 +     57 +  --syntax-constant: #0969da; /* Bright blue for constants */
    2158 +    1793 +     58 +  --syntax-boolean: #0550ae; /* Same as numbers */
    2159 +    1794 +     59 +  --syntax-atrule: #8250df; /* Purple for CSS @ rules */
    2160 +    1795 +     60 +
    2161 +    1796 +     61 +  /* Neutral colors */
    2162 +    1797 +     62 +  --syntax-comment: #636c76; /* GitHub gray for comments */
    2163 +    1798 +     63 +  --syntax-punctuation: #636c76; /* Gray for punctuation */
    2164 +    1799 +     64 +  --syntax-operator: #cf222e; /* Red for operators */
    2165 +    1800 +     65 +
    2166 +    1801 +     66 +  /* Markup specific */
    2167 +    1802 +     67 +  --syntax-attr-name: #0969da; /* Blue like class-name */
    2168 +    1803 +     68 +  --syntax-attr-value: #1a7f37; /* Green like strings */
    2169 +    1804 +     69 +  --syntax-namespace: #8250df; /* Purple */
    2170 +    1805 +     70 +  --syntax-entity: #636c76; /* Neutral */
    2171 +    1806 +     71 +  --syntax-selector: #bc4c00; /* Orange like properties */
    2172 +    1807 + 43  72  
    2173 +    1808 + 44  73    --blockquote-border: #0969da;
    2174 +    1809 + 45  74    --blockquote-bg: #ddf4ff;
    2175 +    1810 + 46  75  
    2176 +    1811 + 47  76    --table-header-bg: #f6f8fa;
    2177 +    1812 + 48  77    --table-border: #d0d7de;
    2178 +    1813 +     78 +
    2179 +    1814 +     79 +  /* === MERMAID COMPREHENSIVE CONFIGURATION === */
    2180 +    1815 +     80 +
    2181 +    1816 +     81 +  /* Core Global */
    2182 +    1817 +     82 +  --mermaid-background: #ffffff;
    2183 +    1818 +     83 +  --mermaid-text-color: #1f2328;
    2184 +    1819 +     84 +  --mermaid-line-color: #0969da;
    2185 +    1820 +     85 +  --mermaid-main-bkg: #eaeef2;
    2186 +    1821 +     86 +
    2187 +    1822 +     87 +  /* Primary Set */
    2188 +    1823 +     88 +  --mermaid-primary-color: #eaeef2;
    2189 +    1824 +     89 +  --mermaid-primary-text-color: #1f2328;
    2190 +    1825 +     90 +  --mermaid-primary-border-color: #0969da;
    2191 +    1826 +     91 +
    2192 +    1827 +     92 +  /* Secondary Set */
    2193 +    1828 +     93 +  --mermaid-secondary-color: #f6f8fa;
    2194 +    1829 +     94 +  --mermaid-secondary-text-color: #1f2328;
    2195 +    1830 +     95 +  --mermaid-secondary-border-color: #8250df;
    2196 +    1831 +     96 +
    2197 +    1832 +     97 +  /* Tertiary Set */
    2198 +    1833 +     98 +  --mermaid-tertiary-color: #ffffff;
    2199 +    1834 +     99 +  --mermaid-tertiary-text-color: #1f2328;
    2200 +    1835 +    100 +  --mermaid-tertiary-border-color: #cf222e;
    2201 +    1836 +    101 +
    2202 +    1837 +    102 +  /* Flowchart */
    2203 +    1838 +    103 +  --mermaid-node-border: #0969da;
    2204 +    1839 +    104 +  --mermaid-cluster-bkg: #f6f8fa;
    2205 +    1840 +    105 +  --mermaid-cluster-border: #8250df;
    2206 +    1841 +    106 +  --mermaid-default-link-color: #0969da;
    2207 +    1842 +    107 +  --mermaid-title-color: #1f2328;
    2208 +    1843 +    108 +  --mermaid-edge-label-background: #ffffff;
    2209 +    1844 +    109 +  --mermaid-node-text-color: #1f2328;
    2210 +    1845 +    110 +
    2211 +    1846 +    111 +  /* Sequence Diagram */
    2212 +    1847 +    112 +  --mermaid-actor-bkg: #eaeef2;
    2213 +    1848 +    113 +  --mermaid-actor-border: #0969da;
    2214 +    1849 +    114 +  --mermaid-actor-text-color: #1f2328;
    2215 +    1850 +    115 +  --mermaid-actor-line-color: #0969da;
    2216 +    1851 +    116 +  --mermaid-signal-color: #8250df;
    2217 +    1852 +    117 +  --mermaid-signal-text-color: #1f2328;
    2218 +    1853 +    118 +  --mermaid-label-box-bkg-color: #eaeef2;
    2219 +    1854 +    119 +  --mermaid-label-box-border-color: #0969da;
    2220 +    1855 +    120 +  --mermaid-label-text-color: #1f2328;
    2221 +    1856 +    121 +  --mermaid-loop-text-color: #1f2328;
    2222 +    1857 +    122 +  --mermaid-activation-border-color: #8250df;
    2223 +    1858 +    123 +  --mermaid-activation-bkg-color: #f6f8fa;
    2224 +    1859 +    124 +  --mermaid-sequence-number-color: #1f2328;
    2225 +    1860 +    125 +
    2226 +    1861 +    126 +  /* Pie Chart */
    2227 +    1862 +    127 +  --mermaid-pie1: #0969da;
    2228 +    1863 +    128 +  --mermaid-pie2: #8250df;
    2229 +    1864 +    129 +  --mermaid-pie3: #cf222e;
    2230 +    1865 +    130 +  --mermaid-pie4: #1a7f37;
    2231 +    1866 +    131 +  --mermaid-pie5: #bc4c00;
    2232 +    1867 +    132 +  --mermaid-pie6: #0550ae;
    2233 +    1868 +    133 +  --mermaid-pie7: #116329;
    2234 +    1869 +    134 +  --mermaid-pie8: #0969da;
    2235 +    1870 +    135 +  --mermaid-pie9: #8250df;
    2236 +    1871 +    136 +  --mermaid-pie10: #cf222e;
    2237 +    1872 +    137 +  --mermaid-pie11: #1a7f37;
    2238 +    1873 +    138 +  --mermaid-pie12: #bc4c00;
    2239 +    1874 +    139 +  --mermaid-pie-title-text-color: #1f2328;
    2240 +    1875 +    140 +  --mermaid-pie-section-text-color: #ffffff; /* White on vibrant slices */
    2241 +    1876 +    141 +  --mermaid-pie-legend-text-color: #1f2328;
    2242 +    1877 +    142 +  --mermaid-pie-stroke-color: #0969da;
    2243 +    1878 +    143 +  --mermaid-pie-outer-stroke-color: #0969da;
    2244 +    1879 +    144 +
    2245 +    1880 +    145 +  /* State Diagram */
    2246 +    1881 +    146 +  --mermaid-label-color: #1f2328;
    2247 +    1882 +    147 +  --mermaid-alt-background: #f6f8fa;
    2248 +    1883 +    148 +
    2249 +    1884 +    149 +  /* Class Diagram */
    2250 +    1885 +    150 +  --mermaid-class-text: #1f2328;
    2251 +    1886 +    151 +
    2252 +    1887 +    152 +  /* User Journey */
    2253 +    1888 +    153 +  --mermaid-fill-type0: #0969da;
    2254 +    1889 +    154 +  --mermaid-fill-type1: #8250df;
    2255 +    1890 +    155 +  --mermaid-fill-type2: #cf222e;
    2256 +    1891 +    156 +  --mermaid-fill-type3: #1a7f37;
    2257 +    1892 +    157 +  --mermaid-fill-type4: #bc4c00;
    2258 +    1893 +    158 +  --mermaid-fill-type5: #0550ae;
    2259 +    1894 +    159 +  --mermaid-fill-type6: #116329;
    2260 +    1895 +    160 +  --mermaid-fill-type7: #0969da;
    2261 +    1896 +    161 +
    2262 +    1897 +    162 +  /* Gantt Chart */
    2263 +    1898 +    163 +  --mermaid-section-bkg-color: #eaeef2;
    2264 +    1899 +    164 +  --mermaid-alt-section-bkg-color: #f6f8fa;
    2265 +    1900 +    165 +  --mermaid-section-bkg-color2: #eaeef2;
    2266 +    1901 +    166 +  --mermaid-task-text-color: #1f2328;
    2267 +    1902 +    167 +  --mermaid-task-text-light-color: #1f2328;
    2268 +    1903 +    168 +  --mermaid-task-text-outside-color: #1f2328;
    2269 +    1904 +    169 +  --mermaid-task-text-clickable-color: #0969da;
    2270 +    1905 +    170 +  --mermaid-active-task-bkg-color: #0969da;
    2271 +    1906 +    171 +  --mermaid-active-task-border-color: #0969da;
    2272 +    1907 +    172 +  --mermaid-done-task-bkg-color: #1a7f37;
    2273 +    1908 +    173 +  --mermaid-done-task-border-color: #1a7f37;
    2274 +    1909 +    174 +  --mermaid-crit-border-color: #cf222e;
    2275 +    1910 +    175 +  --mermaid-crit-bkg-color: #cf222e;
    2276 +    1911 +    176 +  --mermaid-today-line-color: #cf222e;
    2277 +    1912 +    177 +  --mermaid-grid-color: #d0d7de;
    2278 +    1913 +    178 +  --mermaid-section-text-color: #1f2328;
    2279 +    1914 +    179 +  --mermaid-task-border-color: #0969da;
    2280 +    1915 +    180 +
    2281 +    1916 +    181 +  /* ER Diagram */
    2282 +    1917 +    182 +  --mermaid-attribute-background-color-odd: #f6f8fa;
    2283 +    1918 +    183 +  --mermaid-attribute-background-color-even: #ffffff;
    2284 +    1919 +    184 +  --mermaid-relationship-label-background: #ffffff;
    2285 +    1920 +    185 +  --mermaid-relationship-label-color: #1f2328;
    2286 +    1921 +    186 +  --mermaid-entity-background: #eaeef2;
    2287 +    1922 +    187 +  --mermaid-entity-border-color: #0969da;
    2288 +    1923 +    188 +
    2289 +    1924 +    189 +  /* Git Graph */
    2290 +    1925 +    190 +  --mermaid-git0: #0969da;
    2291 +    1926 +    191 +  --mermaid-git1: #8250df;
    2292 +    1927 +    192 +  --mermaid-git2: #cf222e;
    2293 +    1928 +    193 +  --mermaid-git3: #1a7f37;
    2294 +    1929 +    194 +  --mermaid-git4: #bc4c00;
    2295 +    1930 +    195 +  --mermaid-git5: #0550ae;
    2296 +    1931 +    196 +  --mermaid-git6: #116329;
    2297 +    1932 +    197 +  --mermaid-git7: #0969da;
    2298 +    1933 +    198 +  --mermaid-git-inv0: #ffffff;
    2299 +    1934 +    199 +  --mermaid-git-branch-label0: #1f2328;
    2300 +    1935 +    200 +  --mermaid-git-branch-label1: #1f2328;
    2301 +    1936 +    201 +  --mermaid-git-branch-label2: #1f2328;
    2302 +    1937 +    202 +  --mermaid-git-branch-label3: #1f2328;
    2303 +    1938 +    203 +  --mermaid-git-branch-label4: #1f2328;
    2304 +    1939 +    204 +  --mermaid-commit-label-color: #1f2328;
    2305 +    1940 +    205 +  --mermaid-commit-label-background: #ffffff;
    2306 +    1941 +    206 +  --mermaid-tag-label-color: #1f2328;
    2307 +    1942 +    207 +  --mermaid-tag-label-background: #eaeef2;
    2308 +    1943 +    208 +  --mermaid-tag-label-border: #0969da;
    2309 +    1944 + 49 209  }
    2310 +    1945 + 50 210  
    2311 +    1946 +
    2312 +    1947 +```
    2313 +    1948 +
    2314 +    1949 +
    2315 +    1950 +### üìÑ `themes/forest-dark.css`
    2316 +    1951 +
    2317 +    1952 +**Type:** Stylesheet üé®
    2318 +    1953 +
    2319 +    1954 +```diff
    2320 +    1955 +@@ -1,11 +1,11 @@
    2321 +    1956 +  1     -/* Forest Dark Theme */
    2322 +    1957 +      1 +/* Forest Dark Theme - Deep Jungle Aesthetic */
    2323 +    1958 +  2   2  :root {
    2324 +    1959 +  3     -  --bg-primary: #0f1c0a;
    2325 +    1960 +  4     -  --bg-secondary: #1a2817;
    2326 +    1961 +  5     -  --bg-tertiary: #2d4a2b;
    2327 +    1962 +  6     -  --text-primary: #d9f99d;
    2328 +    1963 +  7     -  --text-secondary: #a3e635;
    2329 +    1964 +  8     -  --border-color: #3f6212;
    2330 +    1965 +      3 +  --bg-primary: #0a1408; /* Deep forest green with blue undertones */
    2331 +    1966 +      4 +  --bg-secondary: #132118; /* Darker moss green */
    2332 +    1967 +      5 +  --bg-tertiary: #1e3a29; /* Rich forest green */
    2333 +    1968 +      6 +  --text-primary: #d9f99d; /* Bright lime (firefly glow) */
    2334 +    1969 +      7 +  --text-secondary: #a3e635; /* Vibrant lime */
    2335 +    1970 +      8 +  --border-color: #2d5a3d; /* Forest green border */
    2336 +    1971 +  9   9  
    2337 +    1972 + 10  10    --h1-color: #84cc16;
    2338 +    1973 + 11  11    --h2-color: #a3e635;
    2339 +    1974 +@@ -17,31 +17,144 @@
    2340 +    1975 + 17  17    --link-color: #84cc16;
    2341 +    1976 + 18  18    --link-hover: #a3e635;
    2342 +    1977 + 19  19  
    2343 +    1978 + 20     -  /* Code Colors */
    2344 +    1979 + 21     -  --code-bg: #1a2817;
    2345 +    1980 +     20 +  /* Code Colors - Organic forest glow */
    2346 +    1981 +     21 +  --code-bg: rgba(132, 204, 22, 0.12); /* Lime-tinted background */
    2347 +    1982 + 22  22    --code-text: #a3e635;
    2348 +    1983 + 23     -  --code-block-bg: #0f1c0a;
    2349 +    1984 + 24     -  --code-border: #3f6212;
    2350 +    1985 +     23 +  --code-block-bg: #0d1a11; /* Deep forest with blue-green tint */
    2351 +    1986 +     24 +  --code-border: rgba(163, 230, 53, 0.3); /* Lime glow border */
    2352 +    1987 + 25  25  
    2353 +    1988 + 26     -  /* Syntax Highlighting - Comprehensive Token Colors */
    2354 +    1989 + 27     -  --syntax-keyword: #84cc16;
    2355 +    1990 + 28     -  --syntax-string: #a3e635;
    2356 +    1991 + 29     -  --syntax-number: #bef264;
    2357 +    1992 + 30     -  --syntax-function: #4ade80;
    2358 +    1993 + 31     -  --syntax-comment: #737373;
    2359 +    1994 + 32     -  --syntax-operator: #22c55e;
    2360 +    1995 + 33     -  --syntax-punctuation: #a3a3a3;
    2361 +    1996 +     26 +  /* Syntax Highlighting - Production-Grade Token Colors (One Dark Architecture) */
    2362 +    1997 + 34  27  
    2363 +    1998 + 35     -  /* Additional Token Types */
    2364 +    1999 + 36     -  --syntax-variable: #bef264; /* Variables - bright lime (distinct from text #d9f99d) */
    2365 +    2000 + 37     -  --syntax-property: #4ade80; /* Properties - green */
    2366 +    2001 + 38     -  --syntax-namespace: #84cc16; /* Namespaces - lime */
    2367 +    2002 + 39     -  --syntax-builtin: #22c55e; /* Builtins - green */
    2368 +    2003 +     28 +  /* Core hue-1: Teal - URLs */
    2369 +    2004 +     29 +  --syntax-url: #5eead4; /* Bright teal for URLs */
    2370 +    2005 +     30 +
    2371 +    2006 +     31 +  /* Core hue-2: Green - Functions, variables */
    2372 +    2007 +     32 +  --syntax-function: #4ade80; /* Bright green for functions */
    2373 +    2008 +     33 +  --syntax-variable: #22c55e; /* Medium green for variables */
    2374 +    2009 +     34 +
    2375 +    2010 +     35 +  /* Core hue-3: Yellow - Keywords */
    2376 +    2011 +     36 +  --syntax-keyword: #fbbf24; /* Golden yellow for keywords (final, sealed, class) */
    2377 +    2012 +     37 +
    2378 +    2013 +     38 +  /* Core hue-4: Lime - Strings, builtins */
    2379 +    2014 +     39 +  --syntax-string: #a3e635; /* Bright lime for strings */
    2380 +    2015 +     40 +  --syntax-builtin: #84cc16; /* Lime for builtins (String, List) */
    2381 +    2016 +     41 +  --syntax-char: #a3e635; /* Same as strings */
    2382 +    2017 +     42 +  --syntax-regex: #a3e635; /* Same as strings */
    2383 +    2018 +     43 +  --syntax-inserted: #84cc16; /* For diff */
    2384 +    2019 +     44 +
    2385 +    2020 +     45 +  /* Core hue-5: Orange/Amber - Properties, tags */
    2386 +    2021 +     46 +  --syntax-property: #fb923c; /* Orange for properties */
    2387 +    2022 +     47 +  --syntax-tag: #f97316; /* Burnt orange for tags */
    2388 +    2023 +     48 +  --syntax-deleted: #f87171; /* Coral for diff */
    2389 +    2024 +     49 +  --syntax-important: #fb923c; /* Orange for !important */
    2390 +    2025 +     50 +
    2391 +    2026 +     51 +  /* Core hue-6: Yellow-green - Class names, constants, numbers */
    2392 +    2027 +     52 +  --syntax-class-name: #bef264; /* Bright yellow-green for class names (Rectangle, Shape) */
    2393 +    2028 +     53 +  --syntax-number: #fde047; /* Bright yellow for numbers */
    2394 +    2029 +     54 +  --syntax-constant: #84cc16; /* Lime for constants */
    2395 +    2030 +     55 +  --syntax-boolean: #fde047; /* Same as numbers */
    2396 +    2031 +     56 +  --syntax-atrule: #a3e635; /* Lime for CSS @ rules */
    2397 +    2032 +     57 +
    2398 +    2033 +     58 +  /* Neutral colors */
    2399 +    2034 +     59 +  --syntax-comment: #737373; /* Gray for comments */
    2400 +    2035 +     60 +  --syntax-punctuation: #a3a3a3; /* Light gray for punctuation */
    2401 +    2036 +     61 +  --syntax-operator: #22c55e; /* Green for operators */
    2402 +    2037 +     62 +
    2403 +    2038 +     63 +  /* Markup specific */
    2404 +    2039 +     64 +  --syntax-attr-name: #bef264; /* Yellow-green like class-name */
    2405 +    2040 +     65 +  --syntax-attr-value: #a3e635; /* Lime like strings */
    2406 +    2041 +     66 +  --syntax-namespace: #fbbf24; /* Yellow like keywords */
    2407 +    2042 +     67 +  --syntax-entity: #a3a3a3; /* Neutral */
    2408 +    2043 +     68 +  --syntax-selector: #fb923c; /* Orange like properties */
    2409 +    2044 + 40  69  
    2410 +    2045 + 41  70    --blockquote-border: #84cc16;
    2411 +    2046 + 42     -  --blockquote-bg: #1a2817;
    2412 +    2047 +     71 +  --blockquote-bg: rgba(132, 204, 22, 0.08); /* Lime-tinted blockquote */
    2413 +    2048 + 43  72    --bold-color: #fbbf24;
    2414 +    2049 + 44  73    --italic-color: #84cc16;
    2415 +    2050 + 45     -  --table-header-bg: #2d4a2b;
    2416 +    2051 + 46     -  --table-border: #3f6212;
    2417 +    2052 +     74 +  --table-header-bg: rgba(74, 222, 128, 0.12); /* Green-tinted table header */
    2418 +    2053 +     75 +  --table-border: rgba(45, 90, 61, 0.4); /* Forest-tinted border */
    2419 +    2054 +     76 +
    2420 +    2055 +     77 +  /* === MERMAID COMPREHENSIVE CONFIGURATION === */
    2421 +    2056 +     78 +  /* Complete control over ALL diagram elements */
    2422 +    2057 +     79 +
    2423 +    2058 +     80 +  /* Core Global */
    2424 +    2059 +     81 +  --mermaid-background: #0a1408;
    2425 +    2060 +     82 +  --mermaid-text-color: #d9f99d;
    2426 +    2061 +     83 +  --mermaid-line-color: #a3e635;
    2427 +    2062 +     84 +  --mermaid-main-bkg: #2d5a3d;
    2428 +    2063 +     85 +
    2429 +    2064 +     86 +  /* Primary Set - Main nodes/boxes */
    2430 +    2065 +     87 +  --mermaid-primary-color: #2d5a3d;
    2431 +    2066 +     88 +  --mermaid-primary-text-color: #d9f99d;
    2432 +    2067 +     89 +  --mermaid-primary-border-color: #84cc16;
    2433 +    2068 +     90 +
    2434 +    2069 +     91 +  /* Secondary Set - Clusters/subgraphs */
    2435 +    2070 +     92 +  --mermaid-secondary-color: #1e3a29;
    2436 +    2071 +     93 +  --mermaid-secondary-text-color: #d9f99d;
    2437 +    2072 +     94 +  --mermaid-secondary-border-color: #a3e635;
    2438 +    2073 +     95 +
    2439 +    2074 +     96 +  /* Tertiary Set - Edge labels */
    2440 +    2075 +     97 +  --mermaid-tertiary-color: #0a1408;
    2441 +    2076 +     98 +  --mermaid-tertiary-text-color: #d9f99d;
    2442 +    2077 +     99 +  --mermaid-tertiary-border-color: #bef264;
    2443 +    2078 +    100 +
    2444 +    2079 +    101 +  /* Flowchart */
    2445 +    2080 +    102 +  --mermaid-node-border: #84cc16;
    2446 +    2081 +    103 +  --mermaid-cluster-bkg: #1e3a29;
    2447 +    2082 +    104 +  --mermaid-cluster-border: #a3e635;
    2448 +    2083 +    105 +  --mermaid-default-link-color: #a3e635;
    2449 +    2084 +    106 +  --mermaid-title-color: #d9f99d;
    2450 +    2085 +    107 +  --mermaid-edge-label-background: #0a1408;
    2451 +    2086 +    108 +  --mermaid-node-text-color: #d9f99d;
    2452 +    2087 +    109 +
    2453 +    2088 +    110 +  /* Sequence Diagram */
    2454 +    2089 +    111 +  --mermaid-actor-bkg: #2d5a3d;
    2455 +    2090 +    112 +  --mermaid-actor-border: #84cc16;
    2456 +    2091 +    113 +  --mermaid-actor-text-color: #d9f99d;
    2457 +    2092 +    114 +  --mermaid-actor-line-color: #84cc16;
    2458 +    2093 +    115 +  --mermaid-signal-color: #a3e635;
    2459 +    2094 +    116 +  --mermaid-signal-text-color: #d9f99d;
    2460 +    2095 +    117 +  --mermaid-label-box-bkg-color: #2d5a3d;
    2461 +    2096 +    118 +  --mermaid-label-box-border-color: #84cc16;
    2462 +    2097 +    119 +  --mermaid-label-text-color: #d9f99d;
    2463 +    2098 +    120 +  --mermaid-loop-text-color: #d9f99d;
    2464 +    2099 +    121 +  --mermaid-activation-border-color: #a3e635;
    2465 +    2100 +    122 +  --mermaid-activation-bkg-color: #1e3a29;
    2466 +    2101 +    123 +  --mermaid-sequence-number-color: #d9f99d;
    2467 +    2102 +    124 +
    2468 +    2103 +    125 +  /* Pie Chart - 12 distinct slice colors + text colors */
    2469 +    2104 +    126 +  --mermaid-pie1: #4ade80;
    2470 +    2105 +    127 +  --mermaid-pie2: #fbbf24;
    2471 +    2106 +    128 +  --mermaid-pie3: #fb923c;
    2472 +    2107 +    129 +  --mermaid-pie4: #5eead4;
    2473 +    2108 +    130 +  --mermaid-pie5: #a3e635;
    2474 +    2109 +    131 +  --mermaid-pie6: #22c55e;
    2475 +    2110 +    132 +  --mermaid-pie7: #84cc16;
    2476 +    2111 +    133 +  --mermaid-pie8: #fde047;
    2477 +    2112 +    134 +  --mermaid-pie9: #4ade80;
    2478 +    2113 +    135 +  --mermaid-pie10: #fbbf24;
    2479 +    2114 +    136 +  --mermaid-pie11: #fb923c;
    2480 +    2115 +    137 +  --mermaid-pie12: #5eead4;
    2481 +    2116 +    138 +  --mermaid-pie-title-text-color: #d9f99d;
    2482 +    2117 +    139 +  --mermaid-pie-section-text-color: #0a1408; /* Dark on vibrant slices */
    2483 +    2118 +    140 +  --mermaid-pie-legend-text-color: #d9f99d;
    2484 +    2119 +    141 +  --mermaid-pie-stroke-color: #84cc16;
    2485 +    2120 +    142 +  --mermaid-pie-outer-stroke-color: #84cc16;
    2486 +    2121 +    143 +
    2487 +    2122 +    144 +  /* State Diagram */
    2488 +    2123 +    145 +  --mermaid-label-color: #d9f99d;
    2489 +    2124 +    146 +  --mermaid-alt-background: #1e3a29;
    2490 +    2125 +    147 +
    2491 +    2126 +    148 +  /* Class Diagram */
    2492 +    2127 +    149 +  --mermaid-class-text: #d9f99d;
    2493 +    2128 +    150 +
    2494 +    2129 +    151 +  /* User Journey - 8 distinct colors */
    2495 +    2130 +    152 +  --mermaid-fill-type0: #4ade80;
    2496 +    2131 +    153 +  --mermaid-fill-type1: #fbbf24;
    2497 +    2132 +    154 +  --mermaid-fill-type2: #fb923c;
    2498 +    2133 +    155 +  --mermaid-fill-type3: #5eead4;
    2499 +    2134 +    156 +  --mermaid-fill-type4: #a3e635;
    2500 +    2135 +    157 +  --mermaid-fill-type5: #22c55e;
    2501 +    2136 +    158 +  --mermaid-fill-type6: #84cc16;
    2502 +    2137 +    159 +  --mermaid-fill-type7: #fde047;
    2503 +    2138 + 47 160  }
    2504 +    2139 + 48 161  
    2505 +    2140 +
    2506 +    2141 +```
    2507 +    2142 +
    2508 +    2143 +
    2509 +    2144 +### üìÑ `themes/forest-light.css`
    2510 +    2145 +
    2511 +    2146 +**Type:** Stylesheet üé®
    2512 +    2147 +
    2513 +    2148 +```diff
    2514 +    2149 +@@ -23,20 +23,49 @@
    2515 +    2150 + 23  23    --code-block-bg: #ecfccb; /* Light green background */
    2516 +    2151 + 24  24    --code-border: #bef264;
    2517 +    2152 + 25  25  
    2518 +    2153 + 26     -  /* Syntax Highlighting - Comprehensive Token Colors */
    2519 +    2154 + 27     -  --syntax-keyword: #15803d;
    2520 +    2155 + 28     -  --syntax-string: #16a34a;
    2521 +    2156 + 29     -  --syntax-number: #84cc16;
    2522 +    2157 + 30     -  --syntax-function: #22c55e;
    2523 +    2158 + 31     -  --syntax-comment: #737373;
    2524 +    2159 + 32     -  --syntax-operator: #3f6212;
    2525 +    2160 + 33     -  --syntax-punctuation: #525252;
    2526 +    2161 +     26 +  /* Syntax Highlighting - Production-Grade Token Colors (One Dark Architecture) */
    2527 +    2162 + 34  27  
    2528 +    2163 + 35     -  /* Additional Token Types for Full Customization */
    2529 +    2164 + 36     -  --syntax-variable: #15803d; /* Variables - forest green */
    2530 +    2165 + 37     -  --syntax-property: #16a34a; /* Properties - bright green */
    2531 +    2166 + 38     -  --syntax-namespace: #84cc16; /* Namespaces - lime */
    2532 +    2167 + 39     -  --syntax-builtin: #22c55e; /* Builtins - bright green */
    2533 +    2168 +     28 +  /* Core hue-1: Teal - URLs */
    2534 +    2169 +     29 +  --syntax-url: #14b8a6; /* Teal for URLs */
    2535 +    2170 +     30 +
    2536 +    2171 +     31 +  /* Core hue-2: Green - Functions, variables */
    2537 +    2172 +     32 +  --syntax-function: #22c55e; /* Bright green for functions */
    2538 +    2173 +     33 +  --syntax-variable: #16a34a; /* Forest green for variables */
    2539 +    2174 +     34 +
    2540 +    2175 +     35 +  /* Core hue-3: Emerald - Keywords */
    2541 +    2176 +     36 +  --syntax-keyword: #059669; /* Deep emerald for keywords (final, sealed, class) */
    2542 +    2177 +     37 +
    2543 +    2178 +     38 +  /* Core hue-4: Lime - Strings, builtins */
    2544 +    2179 +     39 +  --syntax-string: #84cc16; /* Lime green for strings */
    2545 +    2180 +     40 +  --syntax-builtin: #65a30d; /* Vibrant lime for builtins (String, List) */
    2546 +    2181 +     41 +  --syntax-char: #84cc16; /* Same as strings */
    2547 +    2182 +     42 +  --syntax-regex: #84cc16; /* Same as strings */
    2548 +    2183 +     43 +  --syntax-inserted: #65a30d; /* For diff */
    2549 +    2184 +     44 +
    2550 +    2185 +     45 +  /* Core hue-5: Amber/Brown - Properties, tags */
    2551 +    2186 +     46 +  --syntax-property: #b45309; /* Amber-brown for properties */
    2552 +    2187 +     47 +  --syntax-tag: #854d0e; /* Brown for tags */
    2553 +    2188 +     48 +  --syntax-deleted: #dc2626; /* Red for diff */
    2554 +    2189 +     49 +  --syntax-important: #b45309; /* Amber for !important */
    2555 +    2190 +     50 +
    2556 +    2191 +     51 +  /* Core hue-6: Yellow/Green - Class names, constants, numbers */
    2557 +    2192 +     52 +  --syntax-class-name: #facc15; /* Bright yellow for class names (Rectangle, Shape) */
    2558 +    2193 +     53 +  --syntax-number: #eab308; /* Yellow for numbers */
    2559 +    2194 +     54 +  --syntax-constant: #15803d; /* Forest green for constants */
    2560 +    2195 +     55 +  --syntax-boolean: #eab308; /* Same as numbers */
    2561 +    2196 +     56 +  --syntax-atrule: #84cc16; /* Lime for CSS @ rules */
    2562 +    2197 +     57 +
    2563 +    2198 +     58 +  /* Neutral colors */
    2564 +    2199 +     59 +  --syntax-comment: #737373; /* Gray for comments */
    2565 +    2200 +     60 +  --syntax-punctuation: #525252; /* Dark gray for punctuation */
    2566 +    2201 +     61 +  --syntax-operator: #3f6212; /* Olive for operators */
    2567 +    2202 +     62 +
    2568 +    2203 +     63 +  /* Markup specific */
    2569 +    2204 +     64 +  --syntax-attr-name: #facc15; /* Yellow like class-name */
    2570 +    2205 +     65 +  --syntax-attr-value: #84cc16; /* Lime like strings */
    2571 +    2206 +     66 +  --syntax-namespace: #059669; /* Emerald like keywords */
    2572 +    2207 +     67 +  --syntax-entity: #525252; /* Neutral */
    2573 +    2208 +     68 +  --syntax-selector: #b45309; /* Amber like properties */
    2574 +    2209 + 40  69  
    2575 +    2210 + 41  70    --blockquote-border: #16a34a;
    2576 +    2211 + 42  71    --blockquote-bg: #ecfccb;
    2577 +    2212 +@@ -44,4 +73,87 @@
    2578 +    2213 + 44  73    --italic-color: #15803d;
    2579 +    2214 + 45  74    --table-header-bg: #d9f99d;
    2580 +    2215 + 46  75    --table-border: #bef264;
    2581 +    2216 +     76 +
    2582 +    2217 +     77 +  /* === MERMAID COMPREHENSIVE CONFIGURATION === */
    2583 +    2218 +     78 +
    2584 +    2219 +     79 +  /* Core Global */
    2585 +    2220 +     80 +  --mermaid-background: #f7fee7;
    2586 +    2221 +     81 +  --mermaid-text-color: #1a2e05;
    2587 +    2222 +     82 +  --mermaid-line-color: #16a34a;
    2588 +    2223 +     83 +  --mermaid-main-bkg: #d9f99d;
    2589 +    2224 +     84 +
    2590 +    2225 +     85 +  /* Primary Set */
    2591 +    2226 +     86 +  --mermaid-primary-color: #d9f99d;
    2592 +    2227 +     87 +  --mermaid-primary-text-color: #1a2e05;
    2593 +    2228 +     88 +  --mermaid-primary-border-color: #15803d;
    2594 +    2229 +     89 +
    2595 +    2230 +     90 +  /* Secondary Set */
    2596 +    2231 +     91 +  --mermaid-secondary-color: #ecfccb;
    2597 +    2232 +     92 +  --mermaid-secondary-text-color: #1a2e05;
    2598 +    2233 +     93 +  --mermaid-secondary-border-color: #16a34a;
    2599 +    2234 +     94 +
    2600 +    2235 +     95 +  /* Tertiary Set */
    2601 +    2236 +     96 +  --mermaid-tertiary-color: #f7fee7;
    2602 +    2237 +     97 +  --mermaid-tertiary-text-color: #1a2e05;
    2603 +    2238 +     98 +  --mermaid-tertiary-border-color: #22c55e;
    2604 +    2239 +     99 +
    2605 +    2240 +    100 +  /* Flowchart */
    2606 +    2241 +    101 +  --mermaid-node-border: #15803d;
    2607 +    2242 +    102 +  --mermaid-cluster-bkg: #ecfccb;
    2608 +    2243 +    103 +  --mermaid-cluster-border: #16a34a;
    2609 +    2244 +    104 +  --mermaid-default-link-color: #16a34a;
    2610 +    2245 +    105 +  --mermaid-title-color: #1a2e05;
    2611 +    2246 +    106 +  --mermaid-edge-label-background: #f7fee7;
    2612 +    2247 +    107 +  --mermaid-node-text-color: #1a2e05;
    2613 +    2248 +    108 +
    2614 +    2249 +    109 +  /* Sequence Diagram */
    2615 +    2250 +    110 +  --mermaid-actor-bkg: #d9f99d;
    2616 +    2251 +    111 +  --mermaid-actor-border: #15803d;
    2617 +    2252 +    112 +  --mermaid-actor-text-color: #1a2e05;
    2618 +    2253 +    113 +  --mermaid-actor-line-color: #15803d;
    2619 +    2254 +    114 +  --mermaid-signal-color: #16a34a;
    2620 +    2255 +    115 +  --mermaid-signal-text-color: #1a2e05;
    2621 +    2256 +    116 +  --mermaid-label-box-bkg-color: #d9f99d;
    2622 +    2257 +    117 +  --mermaid-label-box-border-color: #15803d;
    2623 +    2258 +    118 +  --mermaid-label-text-color: #1a2e05;
    2624 +    2259 +    119 +  --mermaid-loop-text-color: #1a2e05;
    2625 +    2260 +    120 +  --mermaid-activation-border-color: #16a34a;
    2626 +    2261 +    121 +  --mermaid-activation-bkg-color: #ecfccb;
    2627 +    2262 +    122 +  --mermaid-sequence-number-color: #1a2e05;
    2628 +    2263 +    123 +
    2629 +    2264 +    124 +  /* Pie Chart */
    2630 +    2265 +    125 +  --mermaid-pie1: #15803d;
    2631 +    2266 +    126 +  --mermaid-pie2: #16a34a;
    2632 +    2267 +    127 +  --mermaid-pie3: #22c55e;
    2633 +    2268 +    128 +  --mermaid-pie4: #4ade80;
    2634 +    2269 +    129 +  --mermaid-pie5: #84cc16;
    2635 +    2270 +    130 +  --mermaid-pie6: #a3e635;
    2636 +    2271 +    131 +  --mermaid-pie7: #14b8a6;
    2637 +    2272 +    132 +  --mermaid-pie8: #facc15;
    2638 +    2273 +    133 +  --mermaid-pie9: #b45309;
    2639 +    2274 +    134 +  --mermaid-pie10: #15803d;
    2640 +    2275 +    135 +  --mermaid-pie11: #16a34a;
    2641 +    2276 +    136 +  --mermaid-pie12: #22c55e;
    2642 +    2277 +    137 +  --mermaid-pie-title-text-color: #1a2e05;
    2643 +    2278 +    138 +  --mermaid-pie-section-text-color: #f7fee7; /* Light on vibrant slices */
    2644 +    2279 +    139 +  --mermaid-pie-legend-text-color: #1a2e05;
    2645 +    2280 +    140 +  --mermaid-pie-stroke-color: #15803d;
    2646 +    2281 +    141 +  --mermaid-pie-outer-stroke-color: #15803d;
    2647 +    2282 +    142 +
    2648 +    2283 +    143 +  /* State Diagram */
    2649 +    2284 +    144 +  --mermaid-label-color: #1a2e05;
    2650 +    2285 +    145 +  --mermaid-alt-background: #ecfccb;
    2651 +    2286 +    146 +
    2652 +    2287 +    147 +  /* Class Diagram */
    2653 +    2288 +    148 +  --mermaid-class-text: #1a2e05;
    2654 +    2289 +    149 +
    2655 +    2290 +    150 +  /* User Journey */
    2656 +    2291 +    151 +  --mermaid-fill-type0: #15803d;
    2657 +    2292 +    152 +  --mermaid-fill-type1: #16a34a;
    2658 +    2293 +    153 +  --mermaid-fill-type2: #22c55e;
    2659 +    2294 +    154 +  --mermaid-fill-type3: #4ade80;
    2660 +    2295 +    155 +  --mermaid-fill-type4: #84cc16;
    2661 +    2296 +    156 +  --mermaid-fill-type5: #a3e635;
    2662 +    2297 +    157 +  --mermaid-fill-type6: #14b8a6;
    2663 +    2298 +    158 +  --mermaid-fill-type7: #facc15;
    2664 +    2299 + 47 159  }
    2665 +    2300 + 48 160  
    2666 +    2301 +
    2667 +    2302 +```
    2668 +    2303 +
    2669 +    2304 +
    2670 +    2305 +### üìÑ `themes/neon-dark.css`
    2671 +    2306 +
    2672 +    2307 +**Type:** Stylesheet üé®
    2673 +    2308 +
    2674 +    2309 +```diff
    2675 +    2310 +@@ -1,11 +1,11 @@
    2676 +    2311 +  1     -/* Neon Dark Theme */
    2677 +    2312 +      1 +/* Neon Dark Theme - Cyberpunk Aesthetic */
    2678 +    2313 +  2   2  :root {
    2679 +    2314 +  3     -  --bg-primary: #0d0d0d;
    2680 +    2315 +  4     -  --bg-secondary: #1a1a1a;
    2681 +    2316 +  5     -  --bg-tertiary: #262626;
    2682 +    2317 +  6     -  --text-primary: #ffffff;
    2683 +    2318 +  7     -  --text-secondary: #a3a3a3;
    2684 +    2319 +  8     -  --border-color: #404040;
    2685 +    2320 +      3 +  --bg-primary: #0a0e1a; /* Dark blue-purple, not pure black */
    2686 +    2321 +      4 +  --bg-secondary: #141827; /* Dark navy with purple tint */
    2687 +    2322 +      5 +  --bg-tertiary: #1e2539; /* Lighter navy */
    2688 +    2323 +      6 +  --text-primary: #e0e7ff; /* Slightly blue-tinted white */
    2689 +    2324 +      7 +  --text-secondary: #a5b4fc; /* Light indigo */
    2690 +    2325 +      8 +  --border-color: #4c1d95; /* Purple border for neon feel */
    2691 +    2326 +  9   9  
    2692 +    2327 + 10  10    --h1-color: #ff006e;
    2693 +    2328 + 11  11    --h2-color: #8338ec;
    2694 +    2329 +@@ -17,31 +17,143 @@
    2695 +    2330 + 17  17    --link-color: #ff006e;
    2696 +    2331 + 18  18    --link-hover: #ff1a8c;
    2697 +    2332 + 19  19  
    2698 +    2333 + 20     -  /* Code Colors */
    2699 +    2334 + 21     -  --code-bg: #1a1a1a;
    2700 +    2335 +     20 +  /* Code Colors - Neonic with purple glow */
    2701 +    2336 +     21 +  --code-bg: rgba(131, 56, 236, 0.15); /* Purple-tinted background */
    2702 +    2337 + 22  22    --code-text: #00f5d4;
    2703 +    2338 + 23     -  --code-block-bg: #0d0d0d;
    2704 +    2339 + 24     -  --code-border: #404040;
    2705 +    2340 +     23 +  --code-block-bg: #0f1419; /* Dark blue-black with hint of purple */
    2706 +    2341 +     24 +  --code-border: rgba(255, 0, 110, 0.3); /* Pink glow border */
    2707 +    2342 + 25  25  
    2708 +    2343 + 26     -  /* Syntax Highlighting - Comprehensive Token Colors */
    2709 +    2344 + 27     -  --syntax-keyword: #ff006e;
    2710 +    2345 + 28     -  --syntax-string: #00f5d4;
    2711 +    2346 + 29     -  --syntax-number: #ffbe0b;
    2712 +    2347 + 30     -  --syntax-function: #8338ec;
    2713 +    2348 + 31     -  --syntax-comment: #737373;
    2714 +    2349 + 32     -  --syntax-operator: #ff1a8c;
    2715 +    2350 + 33     -  --syntax-punctuation: #a3a3a3;
    2716 +    2351 +     26 +  /* Syntax Highlighting - Production-Grade Token Colors (One Dark Architecture) */
    2717 +    2352 + 34  27  
    2718 +    2353 + 35     -  /* Additional Token Types */
    2719 +    2354 + 36     -  --syntax-variable: #3a86ff; /* Variables - bright blue (distinct from text #ffffff) */
    2720 +    2355 + 37     -  --syntax-property: #8338ec; /* Properties - purple */
    2721 +    2356 + 38     -  --syntax-namespace: #ff006e; /* Namespaces - neon pink */
    2722 +    2357 + 39     -  --syntax-builtin: #00f5d4; /* Builtins - cyan */
    2723 +    2358 +     28 +  /* Core hue-1: Cyan - URLs */
    2724 +    2359 +     29 +  --syntax-url: #00f5d4; /* Electric cyan for URLs */
    2725 +    2360 +     30 +
    2726 +    2361 +     31 +  /* Core hue-2: Purple/Blue - Functions, variables */
    2727 +    2362 +     32 +  --syntax-function: #8338ec; /* Neon purple for functions */
    2728 +    2363 +     33 +  --syntax-variable: #3a86ff; /* Electric blue for variables */
    2729 +    2364 +     34 +
    2730 +    2365 +     35 +  /* Core hue-3: Pink - Keywords */
    2731 +    2366 +     36 +  --syntax-keyword: #ff006e; /* Hot pink for keywords (final, sealed, class) */
    2732 +    2367 +     37 +
    2733 +    2368 +     38 +  /* Core hue-4: Cyan/Teal - Strings, builtins */
    2734 +    2369 +     39 +  --syntax-string: #00f5d4; /* Electric cyan for strings */
    2735 +    2370 +     40 +  --syntax-builtin: #00d4aa; /* Bright teal for builtins (String, List) */
    2736 +    2371 +     41 +  --syntax-char: #00f5d4; /* Same as strings */
    2737 +    2372 +     42 +  --syntax-regex: #00f5d4; /* Same as strings */
    2738 +    2373 +     43 +  --syntax-inserted: #00d4aa; /* For diff */
    2739 +    2374 +     44 +
    2740 +    2375 +     45 +  /* Core hue-5: Orange/Red - Properties, tags */
    2741 +    2376 +     46 +  --syntax-property: #fb5607; /* Neon orange for properties */
    2742 +    2377 +     47 +  --syntax-tag: #ff006e; /* Hot pink for tags */
    2743 +    2378 +     48 +  --syntax-deleted: #ff006e; /* Pink for diff */
    2744 +    2379 +     49 +  --syntax-important: #fb5607; /* Orange for !important */
    2745 +    2380 +     50 +
    2746 +    2381 +     51 +  /* Core hue-6: Yellow/Purple - Class names, constants, numbers */
    2747 +    2382 +     52 +  --syntax-class-name: #ffbe0b; /* Electric yellow for class names (Rectangle, Shape) */
    2748 +    2383 +     53 +  --syntax-number: #ffbe0b; /* Yellow for numbers */
    2749 +    2384 +     54 +  --syntax-constant: #fb5607; /* Orange for constants */
    2750 +    2385 +     55 +  --syntax-boolean: #ffbe0b; /* Same as numbers */
    2751 +    2386 +     56 +  --syntax-atrule: #8338ec; /* Purple for CSS @ rules */
    2752 +    2387 +     57 +
    2753 +    2388 +     58 +  /* Neutral colors */
    2754 +    2389 +     59 +  --syntax-comment: #737373; /* Gray for comments */
    2755 +    2390 +     60 +  --syntax-punctuation: #a3a3a3; /* Light gray for punctuation */
    2756 +    2391 +     61 +  --syntax-operator: #ff1a8c; /* Pink for operators */
    2757 +    2392 +     62 +
    2758 +    2393 +     63 +  /* Markup specific */
    2759 +    2394 +     64 +  --syntax-attr-name: #ffbe0b; /* Yellow like class-name */
    2760 +    2395 +     65 +  --syntax-attr-value: #00f5d4; /* Cyan like strings */
    2761 +    2396 +     66 +  --syntax-namespace: #8338ec; /* Purple */
    2762 +    2397 +     67 +  --syntax-entity: #a3a3a3; /* Neutral */
    2763 +    2398 +     68 +  --syntax-selector: #fb5607; /* Orange like properties */
    2764 +    2399 + 40  69  
    2765 +    2400 + 41  70    --blockquote-border: #8338ec;
    2766 +    2401 + 42     -  --blockquote-bg: #1a1a1a;
    2767 +    2402 +     71 +  --blockquote-bg: rgba(131, 56, 236, 0.1); /* Purple-tinted blockquote */
    2768 +    2403 + 43  72    --bold-color: #ffbe0b;
    2769 +    2404 + 44  73    --italic-color: #ff006e;
    2770 +    2405 + 45     -  --table-header-bg: #262626;
    2771 +    2406 + 46     -  --table-border: #404040;
    2772 +    2407 +     74 +  --table-header-bg: rgba(58, 134, 255, 0.15); /* Blue-tinted table header */
    2773 +    2408 +     75 +  --table-border: rgba(76, 29, 149, 0.3); /* Purple-tinted border */
    2774 +    2409 +     76 +
    2775 +    2410 +     77 +  /* === MERMAID COMPREHENSIVE CONFIGURATION === */
    2776 +    2411 +     78 +
    2777 +    2412 +     79 +  /* Core Global */
    2778 +    2413 +     80 +  --mermaid-background: #0a0e1a;
    2779 +    2414 +     81 +  --mermaid-text-color: #e0e7ff;
    2780 +    2415 +     82 +  --mermaid-line-color: #3a86ff;
    2781 +    2416 +     83 +  --mermaid-main-bkg: #1e2539;
    2782 +    2417 +     84 +
    2783 +    2418 +     85 +  /* Primary Set */
    2784 +    2419 +     86 +  --mermaid-primary-color: #1e2539;
    2785 +    2420 +     87 +  --mermaid-primary-text-color: #e0e7ff;
    2786 +    2421 +     88 +  --mermaid-primary-border-color: #8338ec;
    2787 +    2422 +     89 +
    2788 +    2423 +     90 +  /* Secondary Set */
    2789 +    2424 +     91 +  --mermaid-secondary-color: #141827;
    2790 +    2425 +     92 +  --mermaid-secondary-text-color: #e0e7ff;
    2791 +    2426 +     93 +  --mermaid-secondary-border-color: #3a86ff;
    2792 +    2427 +     94 +
    2793 +    2428 +     95 +  /* Tertiary Set */
    2794 +    2429 +     96 +  --mermaid-tertiary-color: #0a0e1a;
    2795 +    2430 +     97 +  --mermaid-tertiary-text-color: #e0e7ff;
    2796 +    2431 +     98 +  --mermaid-tertiary-border-color: #ff006e;
    2797 +    2432 +     99 +
    2798 +    2433 +    100 +  /* Flowchart */
    2799 +    2434 +    101 +  --mermaid-node-border: #8338ec;
    2800 +    2435 +    102 +  --mermaid-cluster-bkg: #141827;
    2801 +    2436 +    103 +  --mermaid-cluster-border: #3a86ff;
    2802 +    2437 +    104 +  --mermaid-default-link-color: #3a86ff;
    2803 +    2438 +    105 +  --mermaid-title-color: #e0e7ff;
    2804 +    2439 +    106 +  --mermaid-edge-label-background: #0a0e1a;
    2805 +    2440 +    107 +  --mermaid-node-text-color: #e0e7ff;
    2806 +    2441 +    108 +
    2807 +    2442 +    109 +  /* Sequence Diagram */
    2808 +    2443 +    110 +  --mermaid-actor-bkg: #1e2539;
    2809 +    2444 +    111 +  --mermaid-actor-border: #8338ec;
    2810 +    2445 +    112 +  --mermaid-actor-text-color: #e0e7ff;
    2811 +    2446 +    113 +  --mermaid-actor-line-color: #8338ec;
    2812 +    2447 +    114 +  --mermaid-signal-color: #3a86ff;
    2813 +    2448 +    115 +  --mermaid-signal-text-color: #e0e7ff;
    2814 +    2449 +    116 +  --mermaid-label-box-bkg-color: #1e2539;
    2815 +    2450 +    117 +  --mermaid-label-box-border-color: #8338ec;
    2816 +    2451 +    118 +  --mermaid-label-text-color: #e0e7ff;
    2817 +    2452 +    119 +  --mermaid-loop-text-color: #e0e7ff;
    2818 +    2453 +    120 +  --mermaid-activation-border-color: #3a86ff;
    2819 +    2454 +    121 +  --mermaid-activation-bkg-color: #141827;
    2820 +    2455 +    122 +  --mermaid-sequence-number-color: #e0e7ff;
    2821 +    2456 +    123 +
    2822 +    2457 +    124 +  /* Pie Chart */
    2823 +    2458 +    125 +  --mermaid-pie1: #ff006e;
    2824 +    2459 +    126 +  --mermaid-pie2: #8338ec;
    2825 +    2460 +    127 +  --mermaid-pie3: #3a86ff;
    2826 +    2461 +    128 +  --mermaid-pie4: #00f5d4;
    2827 +    2462 +    129 +  --mermaid-pie5: #ffbe0b;
    2828 +    2463 +    130 +  --mermaid-pie6: #fb5607;
    2829 +    2464 +    131 +  --mermaid-pie7: #ff1a8c;
    2830 +    2465 +    132 +  --mermaid-pie8: #00d4aa;
    2831 +    2466 +    133 +  --mermaid-pie9: #a5b4fc;
    2832 +    2467 +    134 +  --mermaid-pie10: #ff006e;
    2833 +    2468 +    135 +  --mermaid-pie11: #8338ec;
    2834 +    2469 +    136 +  --mermaid-pie12: #3a86ff;
    2835 +    2470 +    137 +  --mermaid-pie-title-text-color: #e0e7ff;
    2836 +    2471 +    138 +  --mermaid-pie-section-text-color: #0a0e1a; /* Dark on vibrant slices */
    2837 +    2472 +    139 +  --mermaid-pie-legend-text-color: #e0e7ff;
    2838 +    2473 +    140 +  --mermaid-pie-stroke-color: #8338ec;
    2839 +    2474 +    141 +  --mermaid-pie-outer-stroke-color: #8338ec;
    2840 +    2475 +    142 +
    2841 +    2476 +    143 +  /* State Diagram */
    2842 +    2477 +    144 +  --mermaid-label-color: #e0e7ff;
    2843 +    2478 +    145 +  --mermaid-alt-background: #141827;
    2844 +    2479 +    146 +
    2845 +    2480 +    147 +  /* Class Diagram */
    2846 +    2481 +    148 +  --mermaid-class-text: #e0e7ff;
    2847 +    2482 +    149 +
    2848 +    2483 +    150 +  /* User Journey */
    2849 +    2484 +    151 +  --mermaid-fill-type0: #ff006e;
    2850 +    2485 +    152 +  --mermaid-fill-type1: #8338ec;
    2851 +    2486 +    153 +  --mermaid-fill-type2: #3a86ff;
    2852 +    2487 +    154 +  --mermaid-fill-type3: #00f5d4;
    2853 +    2488 +    155 +  --mermaid-fill-type4: #ffbe0b;
    2854 +    2489 +    156 +  --mermaid-fill-type5: #fb5607;
    2855 +    2490 +    157 +  --mermaid-fill-type6: #ff1a8c;
    2856 +    2491 +    158 +  --mermaid-fill-type7: #00d4aa;
    2857 +    2492 + 47 159  }
    2858 +    2493 + 48 160  
    2859 +    2494 +
    2860 +    2495 +```
    2861 +    2496 +
    2862 +    2497 +
    2863 +    2498 +### üìÑ `themes/neon-light.css`
    2864 +    2499 +
    2865 +    2500 +**Type:** Stylesheet üé®
    2866 +    2501 +
    2867 +    2502 +```diff
    2868 +    2503 +@@ -23,20 +23,49 @@
    2869 +    2504 + 23  23    --code-block-bg: #fef3ff; /* Light purple background */
    2870 +    2505 + 24  24    --code-border: #e9d5ff;
    2871 +    2506 + 25  25  
    2872 +    2507 + 26     -  /* Syntax Highlighting - Comprehensive Token Colors */
    2873 +    2508 + 27     -  --syntax-keyword: #c026d3;
    2874 +    2509 + 28     -  --syntax-string: #10b981;
    2875 +    2510 + 29     -  --syntax-number: #f59e0b;
    2876 +    2511 + 30     -  --syntax-function: #7c3aed;
    2877 +    2512 + 31     -  --syntax-comment: #9ca3af;
    2878 +    2513 + 32     -  --syntax-operator: #a21caf;
    2879 +    2514 + 33     -  --syntax-punctuation: #6b7280;
    2880 +    2515 +     26 +  /* Syntax Highlighting - Production-Grade Token Colors (One Dark Architecture) */
    2881 +    2516 + 34  27  
    2882 +    2517 + 35     -  /* Additional Token Types for Full Customization */
    2883 +    2518 + 36     -  --syntax-variable: #7c3aed; /* Variables - purple */
    2884 +    2519 + 37     -  --syntax-property: #a21caf; /* Properties - magenta */
    2885 +    2520 + 38     -  --syntax-namespace: #c026d3; /* Namespaces - pink */
    2886 +    2521 + 39     -  --syntax-builtin: #7c3aed; /* Builtins - purple */
    2887 +    2522 +     28 +  /* Core hue-1: Cyan - URLs */
    2888 +    2523 +     29 +  --syntax-url: #06b6d4; /* Cyan for URLs */
    2889 +    2524 +     30 +
    2890 +    2525 +     31 +  /* Core hue-2: Purple/Violet - Functions, variables */
    2891 +    2526 +     32 +  --syntax-function: #7c3aed; /* Vibrant purple for functions */
    2892 +    2527 +     33 +  --syntax-variable: #6366f1; /* Indigo for variables */
    2893 +    2528 +     34 +
    2894 +    2529 +     35 +  /* Core hue-3: Magenta - Keywords */
    2895 +    2530 +     36 +  --syntax-keyword: #c026d3; /* Bright magenta for keywords (final, sealed, class) */
    2896 +    2531 +     37 +
    2897 +    2532 +     38 +  /* Core hue-4: Green - Strings, builtins */
    2898 +    2533 +     39 +  --syntax-string: #10b981; /* Emerald green for strings */
    2899 +    2534 +     40 +  --syntax-builtin: #059669; /* Dark emerald for builtins (String, List) */
    2900 +    2535 +     41 +  --syntax-char: #10b981; /* Same as strings */
    2901 +    2536 +     42 +  --syntax-regex: #10b981; /* Same as strings */
    2902 +    2537 +     43 +  --syntax-inserted: #10b981; /* For diff */
    2903 +    2538 +     44 +
    2904 +    2539 +     45 +  /* Core hue-5: Blue - Properties, tags */
    2905 +    2540 +     46 +  --syntax-property: #3b82f6; /* Blue for properties */
    2906 +    2541 +     47 +  --syntax-tag: #2563eb; /* Dark blue for tags */
    2907 +    2542 +     48 +  --syntax-deleted: #ef4444; /* Red for diff */
    2908 +    2543 +     49 +  --syntax-important: #3b82f6; /* Blue for !important */
    2909 +    2544 +     50 +
    2910 +    2545 +     51 +  /* Core hue-6: Amber/Pink - Class names, constants, numbers */
    2911 +    2546 +     52 +  --syntax-class-name: #d946ef; /* Fuchsia for class names (Rectangle, Shape) */
    2912 +    2547 +     53 +  --syntax-number: #f59e0b; /* Amber for numbers */
    2913 +    2548 +     54 +  --syntax-constant: #c026d3; /* Magenta for constants */
    2914 +    2549 +     55 +  --syntax-boolean: #f59e0b; /* Same as numbers */
    2915 +    2550 +     56 +  --syntax-atrule: #d946ef; /* Fuchsia for CSS @ rules */
    2916 +    2551 +     57 +
    2917 +    2552 +     58 +  /* Neutral colors */
    2918 +    2553 +     59 +  --syntax-comment: #9ca3af; /* Gray for comments */
    2919 +    2554 +     60 +  --syntax-punctuation: #6b7280; /* Dark gray for punctuation */
    2920 +    2555 +     61 +  --syntax-operator: #a21caf; /* Magenta-pink for operators */
    2921 +    2556 +     62 +
    2922 +    2557 +     63 +  /* Markup specific */
    2923 +    2558 +     64 +  --syntax-attr-name: #d946ef; /* Fuchsia like class-name */
    2924 +    2559 +     65 +  --syntax-attr-value: #10b981; /* Green like strings */
    2925 +    2560 +     66 +  --syntax-namespace: #7c3aed; /* Purple like keywords */
    2926 +    2561 +     67 +  --syntax-entity: #6b7280; /* Neutral */
    2927 +    2562 +     68 +  --syntax-selector: #3b82f6; /* Blue like properties */
    2928 +    2563 + 40  69  
    2929 +    2564 + 41  70    --blockquote-border: #c026d3;
    2930 +    2565 + 42  71    --blockquote-bg: #fef3ff;
    2931 +    2566 +@@ -44,4 +73,87 @@
    2932 +    2567 + 44  73    --italic-color: #c026d3;
    2933 +    2568 + 45  74    --table-header-bg: #fce7f3;
    2934 +    2569 + 46  75    --table-border: #e9d5ff;
    2935 +    2570 +     76 +
    2936 +    2571 +     77 +  /* === MERMAID COMPREHENSIVE CONFIGURATION === */
    2937 +    2572 +     78 +
    2938 +    2573 +     79 +  /* Core Global */
    2939 +    2574 +     80 +  --mermaid-background: #ffffff;
    2940 +    2575 +     81 +  --mermaid-text-color: #3b0764;
    2941 +    2576 +     82 +  --mermaid-line-color: #7c3aed;
    2942 +    2577 +     83 +  --mermaid-main-bkg: #fce7f3;
    2943 +    2578 +     84 +
    2944 +    2579 +     85 +  /* Primary Set */
    2945 +    2580 +     86 +  --mermaid-primary-color: #fce7f3;
    2946 +    2581 +     87 +  --mermaid-primary-text-color: #3b0764;
    2947 +    2582 +     88 +  --mermaid-primary-border-color: #c026d3;
    2948 +    2583 +     89 +
    2949 +    2584 +     90 +  /* Secondary Set */
    2950 +    2585 +     91 +  --mermaid-secondary-color: #fef3ff;
    2951 +    2586 +     92 +  --mermaid-secondary-text-color: #3b0764;
    2952 +    2587 +     93 +  --mermaid-secondary-border-color: #7c3aed;
    2953 +    2588 +     94 +
    2954 +    2589 +     95 +  /* Tertiary Set */
    2955 +    2590 +     96 +  --mermaid-tertiary-color: #ffffff;
    2956 +    2591 +     97 +  --mermaid-tertiary-text-color: #3b0764;
    2957 +    2592 +     98 +  --mermaid-tertiary-border-color: #d946ef;
    2958 +    2593 +     99 +
    2959 +    2594 +    100 +  /* Flowchart */
    2960 +    2595 +    101 +  --mermaid-node-border: #c026d3;
    2961 +    2596 +    102 +  --mermaid-cluster-bkg: #fef3ff;
    2962 +    2597 +    103 +  --mermaid-cluster-border: #7c3aed;
    2963 +    2598 +    104 +  --mermaid-default-link-color: #7c3aed;
    2964 +    2599 +    105 +  --mermaid-title-color: #3b0764;
    2965 +    2600 +    106 +  --mermaid-edge-label-background: #ffffff;
    2966 +    2601 +    107 +  --mermaid-node-text-color: #3b0764;
    2967 +    2602 +    108 +
    2968 +    2603 +    109 +  /* Sequence Diagram */
    2969 +    2604 +    110 +  --mermaid-actor-bkg: #fce7f3;
    2970 +    2605 +    111 +  --mermaid-actor-border: #c026d3;
    2971 +    2606 +    112 +  --mermaid-actor-text-color: #3b0764;
    2972 +    2607 +    113 +  --mermaid-actor-line-color: #c026d3;
    2973 +    2608 +    114 +  --mermaid-signal-color: #7c3aed;
    2974 +    2609 +    115 +  --mermaid-signal-text-color: #3b0764;
    2975 +    2610 +    116 +  --mermaid-label-box-bkg-color: #fce7f3;
    2976 +    2611 +    117 +  --mermaid-label-box-border-color: #c026d3;
    2977 +    2612 +    118 +  --mermaid-label-text-color: #3b0764;
    2978 +    2613 +    119 +  --mermaid-loop-text-color: #3b0764;
    2979 +    2614 +    120 +  --mermaid-activation-border-color: #7c3aed;
    2980 +    2615 +    121 +  --mermaid-activation-bkg-color: #fef3ff;
    2981 +    2616 +    122 +  --mermaid-sequence-number-color: #3b0764;
    2982 +    2617 +    123 +
    2983 +    2618 +    124 +  /* Pie Chart */
    2984 +    2619 +    125 +  --mermaid-pie1: #c026d3;
    2985 +    2620 +    126 +  --mermaid-pie2: #7c3aed;
    2986 +    2621 +    127 +  --mermaid-pie3: #3b82f6;
    2987 +    2622 +    128 +  --mermaid-pie4: #06b6d4;
    2988 +    2623 +    129 +  --mermaid-pie5: #f59e0b;
    2989 +    2624 +    130 +  --mermaid-pie6: #ef4444;
    2990 +    2625 +    131 +  --mermaid-pie7: #d946ef;
    2991 +    2626 +    132 +  --mermaid-pie8: #6366f1;
    2992 +    2627 +    133 +  --mermaid-pie9: #10b981;
    2993 +    2628 +    134 +  --mermaid-pie10: #c026d3;
    2994 +    2629 +    135 +  --mermaid-pie11: #7c3aed;
    2995 +    2630 +    136 +  --mermaid-pie12: #3b82f6;
    2996 +    2631 +    137 +  --mermaid-pie-title-text-color: #3b0764;
    2997 +    2632 +    138 +  --mermaid-pie-section-text-color: #ffffff; /* White on vibrant slices */
    2998 +    2633 +    139 +  --mermaid-pie-legend-text-color: #3b0764;
    2999 +    2634 +    140 +  --mermaid-pie-stroke-color: #c026d3;
    3000 +    2635 +    141 +  --mermaid-pie-outer-stroke-color: #c026d3;
    3001 +    2636 +    142 +
    3002 +    2637 +    143 +  /* State Diagram */
    3003 +    2638 +    144 +  --mermaid-label-color: #3b0764;
    3004 +    2639 +    145 +  --mermaid-alt-background: #fef3ff;
    3005 +    2640 +    146 +
    3006 +    2641 +    147 +  /* Class Diagram */
    3007 +    2642 +    148 +  --mermaid-class-text: #3b0764;
    3008 +    2643 +    149 +
    3009 +    2644 +    150 +  /* User Journey */
    3010 +    2645 +    151 +  --mermaid-fill-type0: #c026d3;
    3011 +    2646 +    152 +  --mermaid-fill-type1: #7c3aed;
    3012 +    2647 +    153 +  --mermaid-fill-type2: #3b82f6;
    3013 +    2648 +    154 +  --mermaid-fill-type3: #06b6d4;
    3014 +    2649 +    155 +  --mermaid-fill-type4: #f59e0b;
    3015 +    2650 +    156 +  --mermaid-fill-type5: #ef4444;
    3016 +    2651 +    157 +  --mermaid-fill-type6: #d946ef;
    3017 +    2652 +    158 +  --mermaid-fill-type7: #6366f1;
    3018 +    2653 + 47 159  }
    3019 +    2654 + 48 160  
    3020 +    2655 +
    3021 +    2656 +```
    3022 +    2657 +
    3023 +    2658 +
    3024 +    2659 +### üìÑ `themes/obsidian-dark.css`
    3025 +    2660 +
    3026 +    2661 +**Type:** Stylesheet üé®
    3027 +    2662 +
    3028 +    2663 +```diff
    3029 +    2664 +@@ -52,20 +52,49 @@
    3030 +    2665 + 52  52    --code-block-bg: #232635;
    3031 +    2666 + 53  53    --code-border: rgba(78, 205, 196, 0.2);
    3032 +    2667 + 54  54  
    3033 +    2668 + 55     -  /* Syntax Highlighting */
    3034 +    2669 + 56     -  --syntax-keyword: #c792ea;
    3035 +    2670 + 57     -  --syntax-string: #6bcf7f;
    3036 +    2671 + 58     -  --syntax-number: #ffcb6b;
    3037 +    2672 + 59     -  --syntax-function: #82aaff;
    3038 +    2673 + 60     -  --syntax-comment: #7f85a3;
    3039 +    2674 + 61     -  --syntax-operator: #89ddff;
    3040 +    2675 + 62     -  --syntax-punctuation: #b8bcc8;
    3041 +    2676 +     55 +  /* Syntax Highlighting - Production-Grade Token Colors (One Dark Architecture) */
    3042 +    2677 + 63  56  
    3043 +    2678 + 64     -  /* Additional Token Types */
    3044 +    2679 + 65     -  --syntax-variable: #82aaff; /* Variables - blue (distinct from text #f5f7ff) */
    3045 +    2680 + 66     -  --syntax-property: #4ecdc4; /* Properties - cyan */
    3046 +    2681 + 67     -  --syntax-namespace: #ffb86c; /* Namespaces - orange */
    3047 +    2682 + 68     -  --syntax-builtin: #c77dff; /* Builtins - purple */
    3048 +    2683 +     57 +  /* Core hue-1: Cyan - URLs */
    3049 +    2684 +     58 +  --syntax-url: #4ecdc4; /* Bright cyan for URLs */
    3050 +    2685 +     59 +
    3051 +    2686 +     60 +  /* Core hue-2: Blue - Functions, variables */
    3052 +    2687 +     61 +  --syntax-function: #82aaff; /* Bright blue for functions */
    3053 +    2688 +     62 +  --syntax-variable: #5da9ff; /* Sky blue for variables */
    3054 +    2689 +     63 +
    3055 +    2690 +     64 +  /* Core hue-3: Purple - Keywords */
    3056 +    2691 +     65 +  --syntax-keyword: #c792ea; /* Lavender purple for keywords (final, sealed, class) */
    3057 +    2692 +     66 +
    3058 +    2693 +     67 +  /* Core hue-4: Green - Strings, builtins */
    3059 +    2694 +     68 +  --syntax-string: #95e1d3; /* Mint green for strings */
    3060 +    2695 +     69 +  --syntax-builtin: #6bcf7f; /* Vibrant green for builtins (String, List) */
    3061 +    2696 +     70 +  --syntax-char: #95e1d3; /* Same as strings */
    3062 +    2697 +     71 +  --syntax-regex: #95e1d3; /* Same as strings */
    3063 +    2698 +     72 +  --syntax-inserted: #6bcf7f; /* For diff */
    3064 +    2699 +     73 +
    3065 +    2700 +     74 +  /* Core hue-5: Pink - Properties, tags */
    3066 +    2701 +     75 +  --syntax-property: #ff6b9d; /* Hot pink for properties */
    3067 +    2702 +     76 +  --syntax-tag: #ff7eb3; /* Coral pink for tags */
    3068 +    2703 +     77 +  --syntax-deleted: #f38ba8; /* Pink-red for diff */
    3069 +    2704 +     78 +  --syntax-important: #ff6b9d; /* Hot pink for !important */
    3070 +    2705 +     79 +
    3071 +    2706 +     80 +  /* Core hue-6: Yellow/Orange - Class names, constants, numbers */
    3072 +    2707 +     81 +  --syntax-class-name: #ffb86c; /* Peach orange for class names (Rectangle, Shape) */
    3073 +    2708 +     82 +  --syntax-number: #ffd93d; /* Bright yellow for numbers */
    3074 +    2709 +     83 +  --syntax-constant: #ffb86c; /* Peach for constants */
    3075 +    2710 +     84 +  --syntax-boolean: #ffd93d; /* Same as numbers */
    3076 +    2711 +     85 +  --syntax-atrule: #c77dff; /* Purple for CSS @ rules */
    3077 +    2712 +     86 +
    3078 +    2713 +     87 +  /* Neutral colors */
    3079 +    2714 +     88 +  --syntax-comment: #7f85a3; /* Muted blue-gray for comments */
    3080 +    2715 +     89 +  --syntax-punctuation: #b8bcc8; /* Light gray for punctuation */
    3081 +    2716 +     90 +  --syntax-operator: #89ddff; /* Cyan for operators */
    3082 +    2717 +     91 +
    3083 +    2718 +     92 +  /* Markup specific */
    3084 +    2719 +     93 +  --syntax-attr-name: #ffb86c; /* Peach like class-name */
    3085 +    2720 +     94 +  --syntax-attr-value: #95e1d3; /* Mint like strings */
    3086 +    2721 +     95 +  --syntax-namespace: #c792ea; /* Purple like keywords */
    3087 +    2722 +     96 +  --syntax-entity: #b8bcc8; /* Neutral */
    3088 +    2723 +     97 +  --syntax-selector: #ff6b9d; /* Pink like properties */
    3089 +    2724 + 69  98  
    3090 +    2725 + 70  99    /* Blockquote */
    3091 +    2726 + 71 100    --blockquote-border: #ff6b9d;
    3092 +    2727 +@@ -77,4 +106,87 @@
    3093 +    2728 + 77 106  
    3094 +    2729 + 78 107    /* Border */
    3095 +    2730 + 79 108    --border-color: rgba(255, 255, 255, 0.1);
    3096 +    2731 +    109 +
    3097 +    2732 +    110 +  /* === MERMAID COMPREHENSIVE CONFIGURATION === */
    3098 +    2733 +    111 +
    3099 +    2734 +    112 +  /* Core Global */
    3100 +    2735 +    113 +  --mermaid-background: #1e1e2e;
    3101 +    2736 +    114 +  --mermaid-text-color: #f5f7ff;
    3102 +    2737 +    115 +  --mermaid-line-color: #82aaff;
    3103 +    2738 +    116 +  --mermaid-main-bkg: #383a4f;
    3104 +    2739 +    117 +
    3105 +    2740 +    118 +  /* Primary Set */
    3106 +    2741 +    119 +  --mermaid-primary-color: #383a4f;
    3107 +    2742 +    120 +  --mermaid-primary-text-color: #f5f7ff;
    3108 +    2743 +    121 +  --mermaid-primary-border-color: #ff6b9d;
    3109 +    2744 +    122 +
    3110 +    2745 +    123 +  /* Secondary Set */
    3111 +    2746 +    124 +  --mermaid-secondary-color: #2b2d3e;
    3112 +    2747 +    125 +  --mermaid-secondary-text-color: #f5f7ff;
    3113 +    2748 +    126 +  --mermaid-secondary-border-color: #82aaff;
    3114 +    2749 +    127 +
    3115 +    2750 +    128 +  /* Tertiary Set */
    3116 +    2751 +    129 +  --mermaid-tertiary-color: #1e1e2e;
    3117 +    2752 +    130 +  --mermaid-tertiary-text-color: #f5f7ff;
    3118 +    2753 +    131 +  --mermaid-tertiary-border-color: #4ecdc4;
    3119 +    2754 +    132 +
    3120 +    2755 +    133 +  /* Flowchart */
    3121 +    2756 +    134 +  --mermaid-node-border: #ff6b9d;
    3122 +    2757 +    135 +  --mermaid-cluster-bkg: #2b2d3e;
    3123 +    2758 +    136 +  --mermaid-cluster-border: #82aaff;
    3124 +    2759 +    137 +  --mermaid-default-link-color: #82aaff;
    3125 +    2760 +    138 +  --mermaid-title-color: #f5f7ff;
    3126 +    2761 +    139 +  --mermaid-edge-label-background: #1e1e2e;
    3127 +    2762 +    140 +  --mermaid-node-text-color: #f5f7ff;
    3128 +    2763 +    141 +
    3129 +    2764 +    142 +  /* Sequence Diagram */
    3130 +    2765 +    143 +  --mermaid-actor-bkg: #383a4f;
    3131 +    2766 +    144 +  --mermaid-actor-border: #ff6b9d;
    3132 +    2767 +    145 +  --mermaid-actor-text-color: #f5f7ff;
    3133 +    2768 +    146 +  --mermaid-actor-line-color: #ff6b9d;
    3134 +    2769 +    147 +  --mermaid-signal-color: #82aaff;
    3135 +    2770 +    148 +  --mermaid-signal-text-color: #f5f7ff;
    3136 +    2771 +    149 +  --mermaid-label-box-bkg-color: #383a4f;
    3137 +    2772 +    150 +  --mermaid-label-box-border-color: #ff6b9d;
    3138 +    2773 +    151 +  --mermaid-label-text-color: #f5f7ff;
    3139 +    2774 +    152 +  --mermaid-loop-text-color: #f5f7ff;
    3140 +    2775 +    153 +  --mermaid-activation-border-color: #82aaff;
    3141 +    2776 +    154 +  --mermaid-activation-bkg-color: #2b2d3e;
    3142 +    2777 +    155 +  --mermaid-sequence-number-color: #f5f7ff;
    3143 +    2778 +    156 +
    3144 +    2779 +    157 +  /* Pie Chart */
    3145 +    2780 +    158 +  --mermaid-pie1: #ff6b9d;
    3146 +    2781 +    159 +  --mermaid-pie2: #ffd93d;
    3147 +    2782 +    160 +  --mermaid-pie3: #4ecdc4;
    3148 +    2783 +    161 +  --mermaid-pie4: #c77dff;
    3149 +    2784 +    162 +  --mermaid-pie5: #ffb86c;
    3150 +    2785 +    163 +  --mermaid-pie6: #95e1d3;
    3151 +    2786 +    164 +  --mermaid-pie7: #82aaff;
    3152 +    2787 +    165 +  --mermaid-pie8: #ff7eb3;
    3153 +    2788 +    166 +  --mermaid-pie9: #c8f6c2;
    3154 +    2789 +    167 +  --mermaid-pie10: #89dceb;
    3155 +    2790 +    168 +  --mermaid-pie11: #ff6b9d;
    3156 +    2791 +    169 +  --mermaid-pie12: #ffd93d;
    3157 +    2792 +    170 +  --mermaid-pie-title-text-color: #f5f7ff;
    3158 +    2793 +    171 +  --mermaid-pie-section-text-color: #1e1e2e; /* Dark on vibrant slices */
    3159 +    2794 +    172 +  --mermaid-pie-legend-text-color: #f5f7ff;
    3160 +    2795 +    173 +  --mermaid-pie-stroke-color: #ff6b9d;
    3161 +    2796 +    174 +  --mermaid-pie-outer-stroke-color: #ff6b9d;
    3162 +    2797 +    175 +
    3163 +    2798 +    176 +  /* State Diagram */
    3164 +    2799 +    177 +  --mermaid-label-color: #f5f7ff;
    3165 +    2800 +    178 +  --mermaid-alt-background: #2b2d3e;
    3166 +    2801 +    179 +
    3167 +    2802 +    180 +  /* Class Diagram */
    3168 +    2803 +    181 +  --mermaid-class-text: #f5f7ff;
    3169 +    2804 +    182 +
    3170 +    2805 +    183 +  /* User Journey */
    3171 +    2806 +    184 +  --mermaid-fill-type0: #ff6b9d;
    3172 +    2807 +    185 +  --mermaid-fill-type1: #ffd93d;
    3173 +    2808 +    186 +  --mermaid-fill-type2: #4ecdc4;
    3174 +    2809 +    187 +  --mermaid-fill-type3: #c77dff;
    3175 +    2810 +    188 +  --mermaid-fill-type4: #ffb86c;
    3176 +    2811 +    189 +  --mermaid-fill-type5: #95e1d3;
    3177 +    2812 +    190 +  --mermaid-fill-type6: #82aaff;
    3178 +    2813 +    191 +  --mermaid-fill-type7: #ff7eb3;
    3179 +    2814 + 80 192  }
    3180 +    2815 + 81 193  
    3181 +    2816 +
    3182 +    2817 +```
    3183 +    2818 +
    3184 +    2819 +
    3185 +    2820 +### üìÑ `themes/obsidian-light.css`
    3186 +    2821 +
    3187 +    2822 +**Type:** Stylesheet üé®
    3188 +    2823 +
    3189 +    2824 +```diff
    3190 +    2825 +@@ -52,20 +52,49 @@
    3191 +    2826 + 52  52    --code-block-bg: #f8f9fc;
    3192 +    2827 + 53  53    --code-border: rgba(0, 188, 212, 0.2);
    3193 +    2828 + 54  54  
    3194 +    2829 + 55     -  /* Syntax Highlighting - Comprehensive Token Colors */
    3195 +    2830 + 56     -  --syntax-keyword: #9c27b0;
    3196 +    2831 + 57     -  --syntax-string: #4caf50;
    3197 +    2832 + 58     -  --syntax-number: #f57c00;
    3198 +    2833 + 59     -  --syntax-function: #2196f3;
    3199 +    2834 + 60     -  --syntax-comment: #9e9e9e;
    3200 +    2835 + 61     -  --syntax-operator: #00bcd4;
    3201 +    2836 + 62     -  --syntax-punctuation: #616161;
    3202 +    2837 +     55 +  /* Syntax Highlighting - Production-Grade Token Colors (One Dark Architecture) */
    3203 +    2838 + 63  56  
    3204 +    2839 + 64     -  /* Additional Token Types for Full Customization */
    3205 +    2840 + 65     -  --syntax-variable: #2196f3; /* Variables, parameters - bright blue */
    3206 +    2841 + 66     -  --syntax-property: #00bcd4; /* Properties - cyan */
    3207 +    2842 + 67     -  --syntax-namespace: #f57c00; /* Namespaces - orange */
    3208 +    2843 + 68     -  --syntax-builtin: #9c27b0; /* Built-in functions - purple */
    3209 +    2844 +     57 +  /* Core hue-1: Cyan - URLs */
    3210 +    2845 +     58 +  --syntax-url: #00bcd4; /* Cyan for URLs */
    3211 +    2846 +     59 +
    3212 +    2847 +     60 +  /* Core hue-2: Blue - Functions, variables */
    3213 +    2848 +     61 +  --syntax-function: #2196f3; /* Bright blue for functions */
    3214 +    2849 +     62 +  --syntax-variable: #1976d2; /* Deep blue for variables */
    3215 +    2850 +     63 +
    3216 +    2851 +     64 +  /* Core hue-3: Purple - Keywords */
    3217 +    2852 +     65 +  --syntax-keyword: #9c27b0; /* Vibrant purple for keywords (final, sealed, class) */
    3218 +    2853 +     66 +
    3219 +    2854 +     67 +  /* Core hue-4: Green - Strings, builtins */
    3220 +    2855 +     68 +  --syntax-string: #4caf50; /* Green for strings */
    3221 +    2856 +     69 +  --syntax-builtin: #388e3c; /* Dark green for builtins (String, List) */
    3222 +    2857 +     70 +  --syntax-char: #4caf50; /* Same as strings */
    3223 +    2858 +     71 +  --syntax-regex: #4caf50; /* Same as strings */
    3224 +    2859 +     72 +  --syntax-inserted: #388e3c; /* For diff */
    3225 +    2860 +     73 +
    3226 +    2861 +     74 +  /* Core hue-5: Pink/Orange - Properties, tags */
    3227 +    2862 +     75 +  --syntax-property: #e91e63; /* Pink for properties */
    3228 +    2863 +     76 +  --syntax-tag: #ff4081; /* Coral for tags */
    3229 +    2864 +     77 +  --syntax-deleted: #d32f2f; /* Red for diff */
    3230 +    2865 +     78 +  --syntax-important: #e91e63; /* Pink for !important */
    3231 +    2866 +     79 +
    3232 +    2867 +     80 +  /* Core hue-6: Orange/Yellow - Class names, constants, numbers */
    3233 +    2868 +     81 +  --syntax-class-name: #ff9800; /* Orange for class names (Rectangle, Shape) */
    3234 +    2869 +     82 +  --syntax-number: #f57c00; /* Dark orange for numbers */
    3235 +    2870 +     83 +  --syntax-constant: #ff9800; /* Orange for constants */
    3236 +    2871 +     84 +  --syntax-boolean: #f57c00; /* Same as numbers */
    3237 +    2872 +     85 +  --syntax-atrule: #9c27b0; /* Purple for CSS @ rules */
    3238 +    2873 +     86 +
    3239 +    2874 +     87 +  /* Neutral colors */
    3240 +    2875 +     88 +  --syntax-comment: #9e9e9e; /* Gray for comments */
    3241 +    2876 +     89 +  --syntax-punctuation: #616161; /* Dark gray for punctuation */
    3242 +    2877 +     90 +  --syntax-operator: #00bcd4; /* Cyan for operators */
    3243 +    2878 +     91 +
    3244 +    2879 +     92 +  /* Markup specific */
    3245 +    2880 +     93 +  --syntax-attr-name: #ff9800; /* Orange like class-name */
    3246 +    2881 +     94 +  --syntax-attr-value: #4caf50; /* Green like strings */
    3247 +    2882 +     95 +  --syntax-namespace: #9c27b0; /* Purple like keywords */
    3248 +    2883 +     96 +  --syntax-entity: #616161; /* Neutral */
    3249 +    2884 +     97 +  --syntax-selector: #e91e63; /* Pink like properties */
    3250 +    2885 + 69  98  
    3251 +    2886 + 70  99    /* Blockquote */
    3252 +    2887 + 71 100    --blockquote-border: #e91e63;
    3253 +    2888 +@@ -77,4 +106,87 @@
    3254 +    2889 + 77 106  
    3255 +    2890 + 78 107    /* Border */
    3256 +    2891 + 79 108    --border-color: rgba(0, 0, 0, 0.12);
    3257 +    2892 +    109 +
    3258 +    2893 +    110 +  /* === MERMAID COMPREHENSIVE CONFIGURATION === */
    3259 +    2894 +    111 +
    3260 +    2895 +    112 +  /* Core Global */
    3261 +    2896 +    113 +  --mermaid-background: #ffffff;
    3262 +    2897 +    114 +  --mermaid-text-color: #1a1a1a;
    3263 +    2898 +    115 +  --mermaid-line-color: #9c27b0;
    3264 +    2899 +    116 +  --mermaid-main-bkg: #e8ecf1;
    3265 +    2900 +    117 +
    3266 +    2901 +    118 +  /* Primary Set */
    3267 +    2902 +    119 +  --mermaid-primary-color: #e8ecf1;
    3268 +    2903 +    120 +  --mermaid-primary-text-color: #1a1a1a;
    3269 +    2904 +    121 +  --mermaid-primary-border-color: #e91e63;
    3270 +    2905 +    122 +
    3271 +    2906 +    123 +  /* Secondary Set */
    3272 +    2907 +    124 +  --mermaid-secondary-color: #f5f7fa;
    3273 +    2908 +    125 +  --mermaid-secondary-text-color: #1a1a1a;
    3274 +    2909 +    126 +  --mermaid-secondary-border-color: #9c27b0;
    3275 +    2910 +    127 +
    3276 +    2911 +    128 +  /* Tertiary Set */
    3277 +    2912 +    129 +  --mermaid-tertiary-color: #ffffff;
    3278 +    2913 +    130 +  --mermaid-tertiary-text-color: #1a1a1a;
    3279 +    2914 +    131 +  --mermaid-tertiary-border-color: #00bcd4;
    3280 +    2915 +    132 +
    3281 +    2916 +    133 +  /* Flowchart */
    3282 +    2917 +    134 +  --mermaid-node-border: #e91e63;
    3283 +    2918 +    135 +  --mermaid-cluster-bkg: #f5f7fa;
    3284 +    2919 +    136 +  --mermaid-cluster-border: #9c27b0;
    3285 +    2920 +    137 +  --mermaid-default-link-color: #9c27b0;
    3286 +    2921 +    138 +  --mermaid-title-color: #1a1a1a;
    3287 +    2922 +    139 +  --mermaid-edge-label-background: #ffffff;
    3288 +    2923 +    140 +  --mermaid-node-text-color: #1a1a1a;
    3289 +    2924 +    141 +
    3290 +    2925 +    142 +  /* Sequence Diagram */
    3291 +    2926 +    143 +  --mermaid-actor-bkg: #e8ecf1;
    3292 +    2927 +    144 +  --mermaid-actor-border: #e91e63;
    3293 +    2928 +    145 +  --mermaid-actor-text-color: #1a1a1a;
    3294 +    2929 +    146 +  --mermaid-actor-line-color: #e91e63;
    3295 +    2930 +    147 +  --mermaid-signal-color: #9c27b0;
    3296 +    2931 +    148 +  --mermaid-signal-text-color: #1a1a1a;
    3297 +    2932 +    149 +  --mermaid-label-box-bkg-color: #e8ecf1;
    3298 +    2933 +    150 +  --mermaid-label-box-border-color: #e91e63;
    3299 +    2934 +    151 +  --mermaid-label-text-color: #1a1a1a;
    3300 +    2935 +    152 +  --mermaid-loop-text-color: #1a1a1a;
    3301 +    2936 +    153 +  --mermaid-activation-border-color: #9c27b0;
    3302 +    2937 +    154 +  --mermaid-activation-bkg-color: #f5f7fa;
    3303 +    2938 +    155 +  --mermaid-sequence-number-color: #1a1a1a;
    3304 +    2939 +    156 +
    3305 +    2940 +    157 +  /* Pie Chart */
    3306 +    2941 +    158 +  --mermaid-pie1: #e91e63;
    3307 +    2942 +    159 +  --mermaid-pie2: #9c27b0;
    3308 +    2943 +    160 +  --mermaid-pie3: #2196f3;
    3309 +    2944 +    161 +  --mermaid-pie4: #00bcd4;
    3310 +    2945 +    162 +  --mermaid-pie5: #4caf50;
    3311 +    2946 +    163 +  --mermaid-pie6: #ff9800;
    3312 +    2947 +    164 +  --mermaid-pie7: #f57c00;
    3313 +    2948 +    165 +  --mermaid-pie8: #ff4081;
    3314 +    2949 +    166 +  --mermaid-pie9: #1976d2;
    3315 +    2950 +    167 +  --mermaid-pie10: #388e3c;
    3316 +    2951 +    168 +  --mermaid-pie11: #e91e63;
    3317 +    2952 +    169 +  --mermaid-pie12: #9c27b0;
    3318 +    2953 +    170 +  --mermaid-pie-title-text-color: #1a1a1a;
    3319 +    2954 +    171 +  --mermaid-pie-section-text-color: #ffffff; /* White on vibrant slices */
    3320 +    2955 +    172 +  --mermaid-pie-legend-text-color: #1a1a1a;
    3321 +    2956 +    173 +  --mermaid-pie-stroke-color: #e91e63;
    3322 +    2957 +    174 +  --mermaid-pie-outer-stroke-color: #e91e63;
    3323 +    2958 +    175 +
    3324 +    2959 +    176 +  /* State Diagram */
    3325 +    2960 +    177 +  --mermaid-label-color: #1a1a1a;
    3326 +    2961 +    178 +  --mermaid-alt-background: #f5f7fa;
    3327 +    2962 +    179 +
    3328 +    2963 +    180 +  /* Class Diagram */
    3329 +    2964 +    181 +  --mermaid-class-text: #1a1a1a;
    3330 +    2965 +    182 +
    3331 +    2966 +    183 +  /* User Journey */
    3332 +    2967 +    184 +  --mermaid-fill-type0: #e91e63;
    3333 +    2968 +    185 +  --mermaid-fill-type1: #9c27b0;
    3334 +    2969 +    186 +  --mermaid-fill-type2: #2196f3;
    3335 +    2970 +    187 +  --mermaid-fill-type3: #00bcd4;
    3336 +    2971 +    188 +  --mermaid-fill-type4: #4caf50;
    3337 +    2972 +    189 +  --mermaid-fill-type5: #ff9800;
    3338 +    2973 +    190 +  --mermaid-fill-type6: #f57c00;
    3339 +    2974 +    191 +  --mermaid-fill-type7: #ff4081;
    3340 +    2975 + 80 192  }
    3341 +    2976 + 81 193  
    3342 +    2977 +
    3343 +    2978 +```
    3344 +    2979 +
    3345 +    2980 +
    3346 +    2981 +### üìÑ `themes/ocean-dark.css`
    3347 +    2982 +
    3348 +    2983 +**Type:** Stylesheet üé®
    3349 +    2984 +
    3350 +    2985 +```diff
    3351 +    2986 +@@ -23,20 +23,49 @@
    3352 +    2987 + 23  23    --code-block-bg: #0a192f;
    3353 +    2988 + 24  24    --code-border: #233554;
    3354 +    2989 + 25  25  
    3355 +    2990 + 26     -  /* Syntax Highlighting - Comprehensive Token Colors */
    3356 +    2991 + 27     -  --syntax-keyword: #64ffda;
    3357 +    2992 + 28     -  --syntax-string: #5eead4;
    3358 +    2993 + 29     -  --syntax-number: #38bdf8;
    3359 +    2994 + 30     -  --syntax-function: #22d3ee;
    3360 +    2995 + 31     -  --syntax-comment: #8892b0;
    3361 +    2996 + 32     -  --syntax-operator: #06b6d4;
    3362 +    2997 + 33     -  --syntax-punctuation: #8892b0;
    3363 +    2998 +     26 +  /* Syntax Highlighting - Production-Grade Token Colors (One Dark Architecture) */
    3364 +    2999 + 34  27  
    3365 +    3000 + 35     -  /* Additional Token Types */
    3366 +    3001 + 36     -  --syntax-variable: #38bdf8; /* Variables - cyan (distinct from text #ccd6f6) */
    3367 +    3002 + 37     -  --syntax-property: #22d3ee; /* Properties - teal */
    3368 +    3003 + 38     -  --syntax-namespace: #64ffda; /* Namespaces - mint */
    3369 +    3004 + 39     -  --syntax-builtin: #5eead4; /* Builtins - teal */
    3370 +    3005 +     28 +  /* Core hue-1: Bright Cyan - URLs */
    3371 +    3006 +     29 +  --syntax-url: #67e8f9; /* Electric cyan for URLs */
    3372 +    3007 +     30 +
    3373 +    3008 +     31 +  /* Core hue-2: Blue - Functions, variables */
    3374 +    3009 +     32 +  --syntax-function: #38bdf8; /* Sky blue for functions */
    3375 +    3010 +     33 +  --syntax-variable: #0ea5e9; /* Deep sky for variables */
    3376 +    3011 +     34 +
    3377 +    3012 +     35 +  /* Core hue-3: Violet/Purple - Keywords */
    3378 +    3013 +     36 +  --syntax-keyword: #c084fc; /* Bright violet for keywords (final, sealed, class) */
    3379 +    3014 +     37 +
    3380 +    3015 +     38 +  /* Core hue-4: Green/Teal - Strings, builtins */
    3381 +    3016 +     39 +  --syntax-string: #5eead4; /* Teal for strings */
    3382 +    3017 +     40 +  --syntax-builtin: #2dd4bf; /* Vibrant teal for builtins (String, List) */
    3383 +    3018 +     41 +  --syntax-char: #5eead4; /* Same as strings */
    3384 +    3019 +     42 +  --syntax-regex: #5eead4; /* Same as strings */
    3385 +    3020 +     43 +  --syntax-inserted: #2dd4bf; /* For diff */
    3386 +    3021 +     44 +
    3387 +    3022 +     45 +  /* Core hue-5: Pink/Rose - Properties, tags */
    3388 +    3023 +     46 +  --syntax-property: #f472b6; /* Pink for properties */
    3389 +    3024 +     47 +  --syntax-tag: #fb7185; /* Rose for tags */
    3390 +    3025 +     48 +  --syntax-deleted: #f87171; /* Coral for diff */
    3391 +    3026 +     49 +  --syntax-important: #f472b6; /* Pink for !important */
    3392 +    3027 +     50 +
    3393 +    3028 +     51 +  /* Core hue-6: Mint/Cyan - Class names, constants, numbers */
    3394 +    3029 +     52 +  --syntax-class-name: #64ffda; /* Mint green for class names (Rectangle, Shape) */
    3395 +    3030 +     53 +  --syntax-number: #22d3ee; /* Bright cyan for numbers */
    3396 +    3031 +     54 +  --syntax-constant: #06b6d4; /* Cyan for constants */
    3397 +    3032 +     55 +  --syntax-boolean: #22d3ee; /* Same as numbers */
    3398 +    3033 +     56 +  --syntax-atrule: #64ffda; /* Mint for CSS @ rules */
    3399 +    3034 +     57 +
    3400 +    3035 +     58 +  /* Neutral colors */
    3401 +    3036 +     59 +  --syntax-comment: #8892b0; /* Muted blue-gray for comments */
    3402 +    3037 +     60 +  --syntax-punctuation: #a0aec0; /* Light gray for punctuation */
    3403 +    3038 +     61 +  --syntax-operator: #0891b2; /* Teal for operators */
    3404 +    3039 +     62 +
    3405 +    3040 +     63 +  /* Markup specific */
    3406 +    3041 +     64 +  --syntax-attr-name: #64ffda; /* Mint like class-name */
    3407 +    3042 +     65 +  --syntax-attr-value: #5eead4; /* Teal like strings */
    3408 +    3043 +     66 +  --syntax-namespace: #c084fc; /* Violet like keywords */
    3409 +    3044 +     67 +  --syntax-entity: #a0aec0; /* Neutral */
    3410 +    3045 +     68 +  --syntax-selector: #f472b6; /* Pink like properties */
    3411 +    3046 + 40  69  
    3412 +    3047 + 41  70    --blockquote-border: #64ffda;
    3413 +    3048 + 42  71    --blockquote-bg: #112240;
    3414 +    3049 +@@ -44,4 +73,87 @@
    3415 +    3050 + 44  73    --italic-color: #5eead4;
    3416 +    3051 + 45  74    --table-header-bg: #1d3461;
    3417 +    3052 + 46  75    --table-border: #233554;
    3418 +    3053 +     76 +
    3419 +    3054 +     77 +  /* === MERMAID COMPREHENSIVE CONFIGURATION === */
    3420 +    3055 +     78 +
    3421 +    3056 +     79 +  /* Core Global */
    3422 +    3057 +     80 +  --mermaid-background: #0a192f;
    3423 +    3058 +     81 +  --mermaid-text-color: #ccd6f6;
    3424 +    3059 +     82 +  --mermaid-line-color: #5eead4;
    3425 +    3060 +     83 +  --mermaid-main-bkg: #1d3461;
    3426 +    3061 +     84 +
    3427 +    3062 +     85 +  /* Primary Set */
    3428 +    3063 +     86 +  --mermaid-primary-color: #1d3461;
    3429 +    3064 +     87 +  --mermaid-primary-text-color: #ccd6f6;
    3430 +    3065 +     88 +  --mermaid-primary-border-color: #64ffda;
    3431 +    3066 +     89 +
    3432 +    3067 +     90 +  /* Secondary Set */
    3433 +    3068 +     91 +  --mermaid-secondary-color: #112240;
    3434 +    3069 +     92 +  --mermaid-secondary-text-color: #ccd6f6;
    3435 +    3070 +     93 +  --mermaid-secondary-border-color: #5eead4;
    3436 +    3071 +     94 +
    3437 +    3072 +     95 +  /* Tertiary Set */
    3438 +    3073 +     96 +  --mermaid-tertiary-color: #0a192f;
    3439 +    3074 +     97 +  --mermaid-tertiary-text-color: #ccd6f6;
    3440 +    3075 +     98 +  --mermaid-tertiary-border-color: #38bdf8;
    3441 +    3076 +     99 +
    3442 +    3077 +    100 +  /* Flowchart */
    3443 +    3078 +    101 +  --mermaid-node-border: #64ffda;
    3444 +    3079 +    102 +  --mermaid-cluster-bkg: #112240;
    3445 +    3080 +    103 +  --mermaid-cluster-border: #5eead4;
    3446 +    3081 +    104 +  --mermaid-default-link-color: #5eead4;
    3447 +    3082 +    105 +  --mermaid-title-color: #ccd6f6;
    3448 +    3083 +    106 +  --mermaid-edge-label-background: #0a192f;
    3449 +    3084 +    107 +  --mermaid-node-text-color: #ccd6f6;
    3450 +    3085 +    108 +
    3451 +    3086 +    109 +  /* Sequence Diagram */
    3452 +    3087 +    110 +  --mermaid-actor-bkg: #1d3461;
    3453 +    3088 +    111 +  --mermaid-actor-border: #64ffda;
    3454 +    3089 +    112 +  --mermaid-actor-text-color: #ccd6f6;
    3455 +    3090 +    113 +  --mermaid-actor-line-color: #64ffda;
    3456 +    3091 +    114 +  --mermaid-signal-color: #5eead4;
    3457 +    3092 +    115 +  --mermaid-signal-text-color: #ccd6f6;
    3458 +    3093 +    116 +  --mermaid-label-box-bkg-color: #1d3461;
    3459 +    3094 +    117 +  --mermaid-label-box-border-color: #64ffda;
    3460 +    3095 +    118 +  --mermaid-label-text-color: #ccd6f6;
    3461 +    3096 +    119 +  --mermaid-loop-text-color: #ccd6f6;
    3462 +    3097 +    120 +  --mermaid-activation-border-color: #5eead4;
    3463 +    3098 +    121 +  --mermaid-activation-bkg-color: #112240;
    3464 +    3099 +    122 +  --mermaid-sequence-number-color: #ccd6f6;
    3465 +    3100 +    123 +
    3466 +    3101 +    124 +  /* Pie Chart */
    3467 +    3102 +    125 +  --mermaid-pie1: #64ffda;
    3468 +    3103 +    126 +  --mermaid-pie2: #5eead4;
    3469 +    3104 +    127 +  --mermaid-pie3: #38bdf8;
    3470 +    3105 +    128 +  --mermaid-pie4: #22d3ee;
    3471 +    3106 +    129 +  --mermaid-pie5: #06b6d4;
    3472 +    3107 +    130 +  --mermaid-pie6: #0891b2;
    3473 +    3108 +    131 +  --mermaid-pie7: #c084fc;
    3474 +    3109 +    132 +  --mermaid-pie8: #f472b6;
    3475 +    3110 +    133 +  --mermaid-pie9: #0ea5e9;
    3476 +    3111 +    134 +  --mermaid-pie10: #64ffda;
    3477 +    3112 +    135 +  --mermaid-pie11: #5eead4;
    3478 +    3113 +    136 +  --mermaid-pie12: #38bdf8;
    3479 +    3114 +    137 +  --mermaid-pie-title-text-color: #ccd6f6;
    3480 +    3115 +    138 +  --mermaid-pie-section-text-color: #0a192f; /* Dark on vibrant slices */
    3481 +    3116 +    139 +  --mermaid-pie-legend-text-color: #ccd6f6;
    3482 +    3117 +    140 +  --mermaid-pie-stroke-color: #64ffda;
    3483 +    3118 +    141 +  --mermaid-pie-outer-stroke-color: #64ffda;
    3484 +    3119 +    142 +
    3485 +    3120 +    143 +  /* State Diagram */
    3486 +    3121 +    144 +  --mermaid-label-color: #ccd6f6;
    3487 +    3122 +    145 +  --mermaid-alt-background: #112240;
    3488 +    3123 +    146 +
    3489 +    3124 +    147 +  /* Class Diagram */
    3490 +    3125 +    148 +  --mermaid-class-text: #ccd6f6;
    3491 +    3126 +    149 +
    3492 +    3127 +    150 +  /* User Journey */
    3493 +    3128 +    151 +  --mermaid-fill-type0: #64ffda;
    3494 +    3129 +    152 +  --mermaid-fill-type1: #5eead4;
    3495 +    3130 +    153 +  --mermaid-fill-type2: #38bdf8;
    3496 +    3131 +    154 +  --mermaid-fill-type3: #22d3ee;
    3497 +    3132 +    155 +  --mermaid-fill-type4: #06b6d4;
    3498 +    3133 +    156 +  --mermaid-fill-type5: #0891b2;
    3499 +    3134 +    157 +  --mermaid-fill-type6: #c084fc;
    3500 +    3135 +    158 +  --mermaid-fill-type7: #f472b6;
    3501 +    3136 + 47 159  }
    3502 +    3137 + 48 160  
    3503 +    3138 +
    3504 +    3139 +```
    3505 +    3140 +
    3506 +    3141 +
    3507 +    3142 +### üìÑ `themes/ocean-light.css`
    3508 +    3143 +
    3509 +    3144 +**Type:** Stylesheet üé®
    3510 +    3145 +
    3511 +    3146 +```diff
    3512 +    3147 +@@ -23,20 +23,49 @@
    3513 +    3148 + 23  23    --code-block-bg: #e0f2fe; /* Light cyan background */
    3514 +    3149 + 24  24    --code-border: #7dd3fc;
    3515 +    3150 + 25  25  
    3516 +    3151 + 26     -  /* Syntax Highlighting - Comprehensive Token Colors */
    3517 +    3152 + 27     -  --syntax-keyword: #0284c7;
    3518 +    3153 + 28     -  --syntax-string: #0891b2;
    3519 +    3154 + 29     -  --syntax-number: #06b6d4;
    3520 +    3155 + 30     -  --syntax-function: #22d3ee;
    3521 +    3156 + 31     -  --syntax-comment: #64748b;
    3522 +    3157 + 32     -  --syntax-operator: #0369a1;
    3523 +    3158 + 33     -  --syntax-punctuation: #475569;
    3524 +    3159 +     26 +  /* Syntax Highlighting - Production-Grade Token Colors (One Dark Architecture) */
    3525 +    3160 + 34  27  
    3526 +    3161 + 35     -  /* Additional Token Types for Full Customization */
    3527 +    3162 + 36     -  --syntax-variable: #0369a1; /* Variables - ocean blue */
    3528 +    3163 + 37     -  --syntax-property: #0891b2; /* Properties - teal */
    3529 +    3164 + 38     -  --syntax-namespace: #0284c7; /* Namespaces - cyan */
    3530 +    3165 + 39     -  --syntax-builtin: #22d3ee; /* Builtins - bright cyan */
    3531 +    3166 +     28 +  /* Core hue-1: Cyan - URLs */
    3532 +    3167 +     29 +  --syntax-url: #06b6d4; /* Bright cyan for URLs */
    3533 +    3168 +     30 +
    3534 +    3169 +     31 +  /* Core hue-2: Blue - Functions, variables */
    3535 +    3170 +     32 +  --syntax-function: #0284c7; /* Ocean blue for functions */
    3536 +    3171 +     33 +  --syntax-variable: #0369a1; /* Deep blue for variables */
    3537 +    3172 +     34 +
    3538 +    3173 +     35 +  /* Core hue-3: Purple/Violet - Keywords */
    3539 +    3174 +     36 +  --syntax-keyword: #7c3aed; /* Vivid purple for keywords (final, sealed, class) */
    3540 +    3175 +     37 +
    3541 +    3176 +     38 +  /* Core hue-4: Green/Teal - Strings, builtins */
    3542 +    3177 +     39 +  --syntax-string: #0891b2; /* Teal for strings */
    3543 +    3178 +     40 +  --syntax-builtin: #14b8a6; /* Bright teal for builtins (String, List) */
    3544 +    3179 +     41 +  --syntax-char: #0891b2; /* Same as strings */
    3545 +    3180 +     42 +  --syntax-regex: #0891b2; /* Same as strings */
    3546 +    3181 +     43 +  --syntax-inserted: #14b8a6; /* For diff */
    3547 +    3182 +     44 +
    3548 +    3183 +     45 +  /* Core hue-5: Orange/Amber - Properties, tags */
    3549 +    3184 +     46 +  --syntax-property: #f59e0b; /* Amber for properties */
    3550 +    3185 +     47 +  --syntax-tag: #ea580c; /* Orange for tags */
    3551 +    3186 +     48 +  --syntax-deleted: #ef4444; /* Red for diff */
    3552 +    3187 +     49 +  --syntax-important: #f59e0b; /* Amber for !important */
    3553 +    3188 +     50 +
    3554 +    3189 +     51 +  /* Core hue-6: Cyan - Class names, constants, numbers */
    3555 +    3190 +     52 +  --syntax-class-name: #22d3ee; /* Bright cyan for class names (Rectangle, Shape) */
    3556 +    3191 +     53 +  --syntax-number: #06b6d4; /* Cyan for numbers */
    3557 +    3192 +     54 +  --syntax-constant: #0891b2; /* Teal for constants */
    3558 +    3193 +     55 +  --syntax-boolean: #06b6d4; /* Same as numbers */
    3559 +    3194 +     56 +  --syntax-atrule: #22d3ee; /* Bright cyan for CSS @ rules */
    3560 +    3195 +     57 +
    3561 +    3196 +     58 +  /* Neutral colors */
    3562 +    3197 +     59 +  --syntax-comment: #64748b; /* Slate gray for comments */
    3563 +    3198 +     60 +  --syntax-punctuation: #475569; /* Dark slate for punctuation */
    3564 +    3199 +     61 +  --syntax-operator: #0369a1; /* Deep ocean for operators */
    3565 +    3200 +     62 +
    3566 +    3201 +     63 +  /* Markup specific */
    3567 +    3202 +     64 +  --syntax-attr-name: #22d3ee; /* Cyan like class-name */
    3568 +    3203 +     65 +  --syntax-attr-value: #0891b2; /* Teal like strings */
    3569 +    3204 +     66 +  --syntax-namespace: #7c3aed; /* Purple like keywords */
    3570 +    3205 +     67 +  --syntax-entity: #475569; /* Neutral */
    3571 +    3206 +     68 +  --syntax-selector: #f59e0b; /* Amber like properties */
    3572 +    3207 + 40  69  
    3573 +    3208 + 41  70    --blockquote-border: #0891b2;
    3574 +    3209 + 42  71    --blockquote-bg: #e0f2fe;
    3575 +    3210 +@@ -44,4 +73,87 @@
    3576 +    3211 + 44  73    --italic-color: #0891b2;
    3577 +    3212 + 45  74    --table-header-bg: #bae6fd;
    3578 +    3213 + 46  75    --table-border: #7dd3fc;
    3579 +    3214 +     76 +
    3580 +    3215 +     77 +  /* === MERMAID COMPREHENSIVE CONFIGURATION === */
    3581 +    3216 +     78 +
    3582 +    3217 +     79 +  /* Core Global */
    3583 +    3218 +     80 +  --mermaid-background: #f0f9ff;
    3584 +    3219 +     81 +  --mermaid-text-color: #0c4a6e;
    3585 +    3220 +     82 +  --mermaid-line-color: #0891b2;
    3586 +    3221 +     83 +  --mermaid-main-bkg: #bae6fd;
    3587 +    3222 +     84 +
    3588 +    3223 +     85 +  /* Primary Set */
    3589 +    3224 +     86 +  --mermaid-primary-color: #bae6fd;
    3590 +    3225 +     87 +  --mermaid-primary-text-color: #0c4a6e;
    3591 +    3226 +     88 +  --mermaid-primary-border-color: #0284c7;
    3592 +    3227 +     89 +
    3593 +    3228 +     90 +  /* Secondary Set */
    3594 +    3229 +     91 +  --mermaid-secondary-color: #e0f2fe;
    3595 +    3230 +     92 +  --mermaid-secondary-text-color: #0c4a6e;
    3596 +    3231 +     93 +  --mermaid-secondary-border-color: #0891b2;
    3597 +    3232 +     94 +
    3598 +    3233 +     95 +  /* Tertiary Set */
    3599 +    3234 +     96 +  --mermaid-tertiary-color: #f0f9ff;
    3600 +    3235 +     97 +  --mermaid-tertiary-text-color: #0c4a6e;
    3601 +    3236 +     98 +  --mermaid-tertiary-border-color: #06b6d4;
    3602 +    3237 +     99 +
    3603 +    3238 +    100 +  /* Flowchart */
    3604 +    3239 +    101 +  --mermaid-node-border: #0284c7;
    3605 +    3240 +    102 +  --mermaid-cluster-bkg: #e0f2fe;
    3606 +    3241 +    103 +  --mermaid-cluster-border: #0891b2;
    3607 +    3242 +    104 +  --mermaid-default-link-color: #0891b2;
    3608 +    3243 +    105 +  --mermaid-title-color: #0c4a6e;
    3609 +    3244 +    106 +  --mermaid-edge-label-background: #f0f9ff;
    3610 +    3245 +    107 +  --mermaid-node-text-color: #0c4a6e;
    3611 +    3246 +    108 +
    3612 +    3247 +    109 +  /* Sequence Diagram */
    3613 +    3248 +    110 +  --mermaid-actor-bkg: #bae6fd;
    3614 +    3249 +    111 +  --mermaid-actor-border: #0284c7;
    3615 +    3250 +    112 +  --mermaid-actor-text-color: #0c4a6e;
    3616 +    3251 +    113 +  --mermaid-actor-line-color: #0284c7;
    3617 +    3252 +    114 +  --mermaid-signal-color: #0891b2;
    3618 +    3253 +    115 +  --mermaid-signal-text-color: #0c4a6e;
    3619 +    3254 +    116 +  --mermaid-label-box-bkg-color: #bae6fd;
    3620 +    3255 +    117 +  --mermaid-label-box-border-color: #0284c7;
    3621 +    3256 +    118 +  --mermaid-label-text-color: #0c4a6e;
    3622 +    3257 +    119 +  --mermaid-loop-text-color: #0c4a6e;
    3623 +    3258 +    120 +  --mermaid-activation-border-color: #0891b2;
    3624 +    3259 +    121 +  --mermaid-activation-bkg-color: #e0f2fe;
    3625 +    3260 +    122 +  --mermaid-sequence-number-color: #0c4a6e;
    3626 +    3261 +    123 +
    3627 +    3262 +    124 +  /* Pie Chart */
    3628 +    3263 +    125 +  --mermaid-pie1: #0284c7;
    3629 +    3264 +    126 +  --mermaid-pie2: #0891b2;
    3630 +    3265 +    127 +  --mermaid-pie3: #06b6d4;
    3631 +    3266 +    128 +  --mermaid-pie4: #22d3ee;
    3632 +    3267 +    129 +  --mermaid-pie5: #7c3aed;
    3633 +    3268 +    130 +  --mermaid-pie6: #f59e0b;
    3634 +    3269 +    131 +  --mermaid-pie7: #14b8a6;
    3635 +    3270 +    132 +  --mermaid-pie8: #0369a1;
    3636 +    3271 +    133 +  --mermaid-pie9: #0284c7;
    3637 +    3272 +    134 +  --mermaid-pie10: #0891b2;
    3638 +    3273 +    135 +  --mermaid-pie11: #06b6d4;
    3639 +    3274 +    136 +  --mermaid-pie12: #22d3ee;
    3640 +    3275 +    137 +  --mermaid-pie-title-text-color: #0c4a6e;
    3641 +    3276 +    138 +  --mermaid-pie-section-text-color: #f0f9ff; /* Light on vibrant slices */
    3642 +    3277 +    139 +  --mermaid-pie-legend-text-color: #0c4a6e;
    3643 +    3278 +    140 +  --mermaid-pie-stroke-color: #0284c7;
    3644 +    3279 +    141 +  --mermaid-pie-outer-stroke-color: #0284c7;
    3645 +    3280 +    142 +
    3646 +    3281 +    143 +  /* State Diagram */
    3647 +    3282 +    144 +  --mermaid-label-color: #0c4a6e;
    3648 +    3283 +    145 +  --mermaid-alt-background: #e0f2fe;
    3649 +    3284 +    146 +
    3650 +    3285 +    147 +  /* Class Diagram */
    3651 +    3286 +    148 +  --mermaid-class-text: #0c4a6e;
    3652 +    3287 +    149 +
    3653 +    3288 +    150 +  /* User Journey */
    3654 +    3289 +    151 +  --mermaid-fill-type0: #0284c7;
    3655 +    3290 +    152 +  --mermaid-fill-type1: #0891b2;
    3656 +    3291 +    153 +  --mermaid-fill-type2: #06b6d4;
    3657 +    3292 +    154 +  --mermaid-fill-type3: #22d3ee;
    3658 +    3293 +    155 +  --mermaid-fill-type4: #7c3aed;
    3659 +    3294 +    156 +  --mermaid-fill-type5: #f59e0b;
    3660 +    3295 +    157 +  --mermaid-fill-type6: #14b8a6;
    3661 +    3296 +    158 +  --mermaid-fill-type7: #0369a1;
    3662 +    3297 + 47 159  }
    3663 +    3298 + 48 160  
    3664 +363 3299  
    3665 +364 3300  ```
    3666 +365 3301  
    3667 +@@ -369,13 +3305,319 @@ memory-bank/activeContext.md |  52 +++++++++-
    3668 +369 3305  **Type:** Stylesheet üé®
    3669 +370 3306  
    3670 +371 3307  ```diff
    3671 +372     -@@ -1,4 +1,4 @@
    3672 +373     -  1     -r/* Sunset Dark Theme */
    3673 +374     -      1 +/* Sunset Dark Theme */
    3674 +375     -  2   2  :root {
    3675 +376     -  3   3    --bg-primary: #1c0a00;
    3676 +377     -  4   4    --bg-secondary: #2d1b0e;
    3677 +378     -  5   5  
    3678 +    3308 +@@ -23,20 +23,49 @@
    3679 +    3309 + 23  23    --code-block-bg: #1c0a00;
    3680 +    3310 + 24  24    --code-border: #7c2d12;
    3681 +    3311 + 25  25  
    3682 +    3312 + 26     -  /* Syntax Highlighting - Comprehensive Token Colors */
    3683 +    3313 + 27     -  --syntax-keyword: #fb923c;
    3684 +    3314 + 28     -  --syntax-string: #a3e635;
    3685 +    3315 + 29     -  --syntax-number: #fbbf24;
    3686 +    3316 + 30     -  --syntax-function: #f87171;
    3687 +    3317 + 31     -  --syntax-comment: #78716c;
    3688 +    3318 + 32     -  --syntax-operator: #fdba74;
    3689 +    3319 + 33     -  --syntax-punctuation: #d4d4d4;
    3690 +    3320 +     26 +  /* Syntax Highlighting - Production-Grade Token Colors (One Dark Architecture) */
    3691 +    3321 + 34  27  
    3692 +    3322 + 35     -  /* Additional Token Types */
    3693 +    3323 + 36     -  --syntax-variable: #fcd34d; /* Variables - bright yellow (distinct from text #fed7aa) */
    3694 +    3324 + 37     -  --syntax-property: #f87171; /* Properties - coral */
    3695 +    3325 + 38     -  --syntax-namespace: #fb923c; /* Namespaces - sunset orange */
    3696 +    3326 + 39     -  --syntax-builtin: #f87171; /* Builtins - coral */
    3697 +    3327 +     28 +  /* Core hue-1: Cyan (187¬∞) - URLs */
    3698 +    3328 +     29 +  --syntax-url: #5eead4; /* Bright teal for URLs */
    3699 +    3329 +     30 +
    3700 +    3330 +     31 +  /* Core hue-2: Blue (207¬∞) - Functions, variables */
    3701 +    3331 +     32 +  --syntax-function: #60a5fa; /* Bright blue for functions */
    3702 +    3332 +     33 +  --syntax-variable: #38bdf8; /* Sky blue for variables */
    3703 +    3333 +     34 +
    3704 +    3334 +     35 +  /* Core hue-3: Purple (286¬∞) - Keywords */
    3705 +    3335 +     36 +  --syntax-keyword: #c084fc; /* Bright purple for keywords (final, sealed, class keyword) */
    3706 +    3336 +     37 +
    3707 +    3337 +     38 +  /* Core hue-4: Green (95¬∞) - Strings, builtins */
    3708 +    3338 +     39 +  --syntax-string: #a3e635; /* Lime green for strings */
    3709 +    3339 +     40 +  --syntax-builtin: #84cc16; /* Vibrant green for builtins (String, List) */
    3710 +    3340 +     41 +  --syntax-char: #a3e635; /* Same as strings */
    3711 +    3341 +     42 +  --syntax-regex: #a3e635; /* Same as strings */
    3712 +    3342 +     43 +  --syntax-inserted: #a3e635; /* For diff */
    3713 +    3343 +     44 +
    3714 +    3344 +     45 +  /* Core hue-5: Red (355¬∞) - Properties, tags */
    3715 +    3345 +     46 +  --syntax-property: #fb7185; /* Coral rose for properties */
    3716 +    3346 +     47 +  --syntax-tag: #f87171; /* Coral for tags */
    3717 +    3347 +     48 +  --syntax-deleted: #f87171; /* For diff */
    3718 +    3348 +     49 +  --syntax-important: #fb7185; /* For !important */
    3719 +    3349 +     50 +
    3720 +    3350 +     51 +  /* Core hue-6: Orange (29¬∞) - Class names, constants, numbers */
    3721 +    3351 +     52 +  --syntax-class-name: #fb923c; /* Bright sunset orange for class names (Rectangle, Shape) */
    3722 +    3352 +     53 +  --syntax-number: #fbbf24; /* Golden yellow for numbers */
    3723 +    3353 +     54 +  --syntax-constant: #f97316; /* Burnt orange for constants */
    3724 +    3354 +     55 +  --syntax-boolean: #fbbf24; /* Same as numbers */
    3725 +    3355 +     56 +  --syntax-atrule: #fb923c; /* CSS @ rules */
    3726 +    3356 +     57 +
    3727 +    3357 +     58 +  /* Neutral colors */
    3728 +    3358 +     59 +  --syntax-comment: #a8a29e; /* Muted for comments */
    3729 +    3359 +     60 +  --syntax-punctuation: #d4d4d8; /* Light gray for punctuation */
    3730 +    3360 +     61 +  --syntax-operator: #fdba74; /* Light sunset for operators */
    3731 +    3361 +     62 +
    3732 +    3362 +     63 +  /* Markup specific */
    3733 +    3363 +     64 +  --syntax-attr-name: #fb923c; /* Orange like class-name */
    3734 +    3364 +     65 +  --syntax-attr-value: #a3e635; /* Green like strings */
    3735 +    3365 +     66 +  --syntax-namespace: #c084fc; /* Purple like keywords */
    3736 +    3366 +     67 +  --syntax-entity: #d4d4d8; /* Neutral */
    3737 +    3367 +     68 +  --syntax-selector: #fb7185; /* Red like properties */
    3738 +    3368 + 40  69  
    3739 +    3369 + 41  70    --blockquote-border: #f97316;
    3740 +    3370 + 42  71    --blockquote-bg: #2d1b0e;
    3741 +    3371 +@@ -44,4 +73,87 @@
    3742 +    3372 + 44  73    --italic-color: #fb923c;
    3743 +    3373 + 45  74    --table-header-bg: #3d2417;
    3744 +    3374 + 46  75    --table-border: #7c2d12;
    3745 +    3375 +     76 +
    3746 +    3376 +     77 +  /* === MERMAID COMPREHENSIVE CONFIGURATION === */
    3747 +    3377 +     78 +
    3748 +    3378 +     79 +  /* Core Global */
    3749 +    3379 +     80 +  --mermaid-background: #1c0a00;
    3750 +    3380 +     81 +  --mermaid-text-color: #fed7aa;
    3751 +    3381 +     82 +  --mermaid-line-color: #f97316;
    3752 +    3382 +     83 +  --mermaid-main-bkg: #3d2417;
    3753 +    3383 +     84 +
    3754 +    3384 +     85 +  /* Primary Set */
    3755 +    3385 +     86 +  --mermaid-primary-color: #3d2417;
    3756 +    3386 +     87 +  --mermaid-primary-text-color: #fed7aa;
    3757 +    3387 +     88 +  --mermaid-primary-border-color: #fb923c;
    3758 +    3388 +     89 +
    3759 +    3389 +     90 +  /* Secondary Set */
    3760 +    3390 +     91 +  --mermaid-secondary-color: #2d1b0e;
    3761 +    3391 +     92 +  --mermaid-secondary-text-color: #fed7aa;
    3762 +    3392 +     93 +  --mermaid-secondary-border-color: #f97316;
    3763 +    3393 +     94 +
    3764 +    3394 +     95 +  /* Tertiary Set */
    3765 +    3395 +     96 +  --mermaid-tertiary-color: #1c0a00;
    3766 +    3396 +     97 +  --mermaid-tertiary-text-color: #fed7aa;
    3767 +    3397 +     98 +  --mermaid-tertiary-border-color: #ea580c;
    3768 +    3398 +     99 +
    3769 +    3399 +    100 +  /* Flowchart */
    3770 +    3400 +    101 +  --mermaid-node-border: #fb923c;
    3771 +    3401 +    102 +  --mermaid-cluster-bkg: #2d1b0e;
    3772 +    3402 +    103 +  --mermaid-cluster-border: #f97316;
    3773 +    3403 +    104 +  --mermaid-default-link-color: #f97316;
    3774 +    3404 +    105 +  --mermaid-title-color: #fed7aa;
    3775 +    3405 +    106 +  --mermaid-edge-label-background: #1c0a00;
    3776 +    3406 +    107 +  --mermaid-node-text-color: #fed7aa;
    3777 +    3407 +    108 +
    3778 +    3408 +    109 +  /* Sequence Diagram */
    3779 +    3409 +    110 +  --mermaid-actor-bkg: #3d2417;
    3780 +    3410 +    111 +  --mermaid-actor-border: #fb923c;
    3781 +    3411 +    112 +  --mermaid-actor-text-color: #fed7aa;
    3782 +    3412 +    113 +  --mermaid-actor-line-color: #fb923c;
    3783 +    3413 +    114 +  --mermaid-signal-color: #f97316;
    3784 +    3414 +    115 +  --mermaid-signal-text-color: #fed7aa;
    3785 +    3415 +    116 +  --mermaid-label-box-bkg-color: #3d2417;
    3786 +    3416 +    117 +  --mermaid-label-box-border-color: #fb923c;
    3787 +    3417 +    118 +  --mermaid-label-text-color: #fed7aa;
    3788 +    3418 +    119 +  --mermaid-loop-text-color: #fed7aa;
    3789 +    3419 +    120 +  --mermaid-activation-border-color: #f97316;
    3790 +    3420 +    121 +  --mermaid-activation-bkg-color: #2d1b0e;
    3791 +    3421 +    122 +  --mermaid-sequence-number-color: #fed7aa;
    3792 +    3422 +    123 +
    3793 +    3423 +    124 +  /* Pie Chart */
    3794 +    3424 +    125 +  --mermaid-pie1: #fb923c;
    3795 +    3425 +    126 +  --mermaid-pie2: #f97316;
    3796 +    3426 +    127 +  --mermaid-pie3: #ea580c;
    3797 +    3427 +    128 +  --mermaid-pie4: #f87171;
    3798 +    3428 +    129 +  --mermaid-pie5: #fb7185;
    3799 +    3429 +    130 +  --mermaid-pie6: #f472b6;
    3800 +    3430 +    131 +  --mermaid-pie7: #fdba74;
    3801 +    3431 +    132 +  --mermaid-pie8: #5eead4;
    3802 +    3432 +    133 +  --mermaid-pie9: #60a5fa;
    3803 +    3433 +    134 +  --mermaid-pie10: #c084fc;
    3804 +    3434 +    135 +  --mermaid-pie11: #a3e635;
    3805 +    3435 +    136 +  --mermaid-pie12: #fbbf24;
    3806 +    3436 +    137 +  --mermaid-pie-title-text-color: #fed7aa;
    3807 +    3437 +    138 +  --mermaid-pie-section-text-color: #1c0a00; /* Dark on vibrant slices */
    3808 +    3438 +    139 +  --mermaid-pie-legend-text-color: #fed7aa;
    3809 +    3439 +    140 +  --mermaid-pie-stroke-color: #fb923c;
    3810 +    3440 +    141 +  --mermaid-pie-outer-stroke-color: #fb923c;
    3811 +    3441 +    142 +
    3812 +    3442 +    143 +  /* State Diagram */
    3813 +    3443 +    144 +  --mermaid-label-color: #fed7aa;
    3814 +    3444 +    145 +  --mermaid-alt-background: #2d1b0e;
    3815 +    3445 +    146 +
    3816 +    3446 +    147 +  /* Class Diagram */
    3817 +    3447 +    148 +  --mermaid-class-text: #fed7aa;
    3818 +    3448 +    149 +
    3819 +    3449 +    150 +  /* User Journey */
    3820 +    3450 +    151 +  --mermaid-fill-type0: #fb923c;
    3821 +    3451 +    152 +  --mermaid-fill-type1: #f97316;
    3822 +    3452 +    153 +  --mermaid-fill-type2: #ea580c;
    3823 +    3453 +    154 +  --mermaid-fill-type3: #f87171;
    3824 +    3454 +    155 +  --mermaid-fill-type4: #fb7185;
    3825 +    3455 +    156 +  --mermaid-fill-type5: #f472b6;
    3826 +    3456 +    157 +  --mermaid-fill-type6: #fdba74;
    3827 +    3457 +    158 +  --mermaid-fill-type7: #5eead4;
    3828 +    3458 + 47 159  }
    3829 +    3459 + 48 160  
    3830 +    3460 +
    3831 +    3461 +```
    3832 +    3462 +
    3833 +    3463 +
    3834 +    3464 +### üìÑ `themes/sunset-light.css`
    3835 +    3465 +
    3836 +    3466 +**Type:** Stylesheet üé®
    3837 +    3467 +
    3838 +    3468 +```diff
    3839 +    3469 +@@ -23,20 +23,49 @@
    3840 +    3470 + 23  23    --code-block-bg: #ffedd5; /* Light orange background */
    3841 +    3471 + 24  24    --code-border: #fdba74;
    3842 +    3472 + 25  25  
    3843 +    3473 + 26     -  /* Syntax Highlighting - Comprehensive Token Colors */
    3844 +    3474 + 27     -  --syntax-keyword: #ea580c;
    3845 +    3475 + 28     -  --syntax-string: #16a34a;
    3846 +    3476 + 29     -  --syntax-number: #f59e0b;
    3847 +    3477 + 30     -  --syntax-function: #dc2626;
    3848 +    3478 + 31     -  --syntax-comment: #78716c;
    3849 +    3479 + 32     -  --syntax-operator: #c2410c;
    3850 +    3480 + 33     -  --syntax-punctuation: #57534e;
    3851 +    3481 +     26 +  /* Syntax Highlighting - Production-Grade Token Colors (Based on One Dark Architecture) */
    3852 +    3482 + 34  27  
    3853 +    3483 + 35     -  /* Additional Token Types for Full Customization */
    3854 +    3484 + 36     -  --syntax-variable: #ea580c; /* Variables - sunset orange */
    3855 +    3485 + 37     -  --syntax-property: #dc2626; /* Properties - red */
    3856 +    3486 + 38     -  --syntax-namespace: #f97316; /* Namespaces - bright orange */
    3857 +    3487 + 39     -  --syntax-builtin: #dc2626; /* Builtins - red */
    3858 +    3488 +     28 +  /* Core hue-1: Cyan (187¬∞) - URLs, special strings */
    3859 +    3489 +     29 +  --syntax-url: #14b8a6; /* Teal/cyan for URLs */
    3860 +    3490 +     30 +
    3861 +    3491 +     31 +  /* Core hue-2: Blue (207¬∞) - Functions, variables, operators */
    3862 +    3492 +     32 +  --syntax-function: #3b82f6; /* Bright blue for functions */
    3863 +    3493 +     33 +  --syntax-variable: #0ea5e9; /* Sky blue for variables */
    3864 +    3494 +     34 +
    3865 +    3495 +     35 +  /* Core hue-3: Purple (286¬∞) - Keywords */
    3866 +    3496 +     36 +  --syntax-keyword: #a855f7; /* Vibrant purple for keywords (if, final, sealed) */
    3867 +    3497 +     37 +
    3868 +    3498 +     38 +  /* Core hue-4: Green (95¬∞) - Strings, builtins, inserted */
    3869 +    3499 +     39 +  --syntax-string: #10b981; /* Emerald green for strings */
    3870 +    3500 +     40 +  --syntax-builtin: #059669; /* Darker green for builtins (String, List, Array) */
    3871 +    3501 +     41 +  --syntax-char: #10b981; /* Same as strings */
    3872 +    3502 +     42 +  --syntax-regex: #10b981; /* Same as strings */
    3873 +    3503 +     43 +  --syntax-inserted: #10b981; /* For diff highlights */
    3874 +    3504 +     44 +
    3875 +    3505 +     45 +  /* Core hue-5: Red (355¬∞) - Properties, tags, deleted, important */
    3876 +    3506 +     46 +  --syntax-property: #ef4444; /* Red for properties */
    3877 +    3507 +     47 +  --syntax-tag: #ef4444; /* Red for HTML tags */
    3878 +    3508 +     48 +  --syntax-deleted: #ef4444; /* For diff highlights */
    3879 +    3509 +     49 +  --syntax-important: #ef4444; /* For !important */
    3880 +    3510 +     50 +
    3881 +    3511 +     51 +  /* Core hue-6: Orange (29¬∞) - Class names, constants, numbers, atrules */
    3882 +    3512 +     52 +  --syntax-class-name: #f97316; /* Orange for class/type names (Rectangle, Shape) */
    3883 +    3513 +     53 +  --syntax-number: #fb923c; /* Bright orange for numbers */
    3884 +    3514 +     54 +  --syntax-constant: #ea580c; /* Burnt orange for constants */
    3885 +    3515 +     55 +  --syntax-boolean: #fb923c; /* Same as numbers */
    3886 +    3516 +     56 +  --syntax-atrule: #fb923c; /* CSS @ rules */
    3887 +    3517 +     57 +
    3888 +    3518 +     58 +  /* Neutral colors */
    3889 +    3519 +     59 +  --syntax-comment: #a8a29e; /* Muted stone for comments */
    3890 +    3520 +     60 +  --syntax-punctuation: #64748b; /* Slate for punctuation */
    3891 +    3521 +     61 +  --syntax-operator: #fb7185; /* Coral rose for operators */
    3892 +    3522 +     62 +
    3893 +    3523 +     63 +  /* Markup specific */
    3894 +    3524 +     64 +  --syntax-attr-name: #f97316; /* Orange like class-name */
    3895 +    3525 +     65 +  --syntax-attr-value: #10b981; /* Green like strings */
    3896 +    3526 +     66 +  --syntax-namespace: #a855f7; /* Purple like keywords */
    3897 +    3527 +     67 +  --syntax-entity: #64748b; /* Neutral */
    3898 +    3528 +     68 +  --syntax-selector: #ef4444; /* Red like properties */
    3899 +    3529 + 40  69  
    3900 +    3530 + 41  70    --blockquote-border: #f97316;
    3901 +    3531 + 42  71    --blockquote-bg: #ffedd5;
    3902 +    3532 +@@ -44,4 +73,87 @@
    3903 +    3533 + 44  73    --italic-color: #e11d48;
    3904 +    3534 + 45  74    --table-header-bg: #fed7aa;
    3905 +    3535 + 46  75    --table-border: #fdba74;
    3906 +    3536 +     76 +
    3907 +    3537 +     77 +  /* === MERMAID COMPREHENSIVE CONFIGURATION === */
    3908 +    3538 +     78 +
    3909 +    3539 +     79 +  /* Core Global */
    3910 +    3540 +     80 +  --mermaid-background: #fff7ed;
    3911 +    3541 +     81 +  --mermaid-text-color: #431407;
    3912 +    3542 +     82 +  --mermaid-line-color: #f97316;
    3913 +    3543 +     83 +  --mermaid-main-bkg: #fed7aa;
    3914 +    3544 +     84 +
    3915 +    3545 +     85 +  /* Primary Set */
    3916 +    3546 +     86 +  --mermaid-primary-color: #fed7aa;
    3917 +    3547 +     87 +  --mermaid-primary-text-color: #431407;
    3918 +    3548 +     88 +  --mermaid-primary-border-color: #ea580c;
    3919 +    3549 +     89 +
    3920 +    3550 +     90 +  /* Secondary Set */
    3921 +    3551 +     91 +  --mermaid-secondary-color: #ffedd5;
    3922 +    3552 +     92 +  --mermaid-secondary-text-color: #431407;
    3923 +    3553 +     93 +  --mermaid-secondary-border-color: #f97316;
    3924 +    3554 +     94 +
    3925 +    3555 +     95 +  /* Tertiary Set */
    3926 +    3556 +     96 +  --mermaid-tertiary-color: #fff7ed;
    3927 +    3557 +     97 +  --mermaid-tertiary-text-color: #431407;
    3928 +    3558 +     98 +  --mermaid-tertiary-border-color: #fb923c;
    3929 +    3559 +     99 +
    3930 +    3560 +    100 +  /* Flowchart */
    3931 +    3561 +    101 +  --mermaid-node-border: #ea580c;
    3932 +    3562 +    102 +  --mermaid-cluster-bkg: #ffedd5;
    3933 +    3563 +    103 +  --mermaid-cluster-border: #f97316;
    3934 +    3564 +    104 +  --mermaid-default-link-color: #f97316;
    3935 +    3565 +    105 +  --mermaid-title-color: #431407;
    3936 +    3566 +    106 +  --mermaid-edge-label-background: #fff7ed;
    3937 +    3567 +    107 +  --mermaid-node-text-color: #431407;
    3938 +    3568 +    108 +
    3939 +    3569 +    109 +  /* Sequence Diagram */
    3940 +    3570 +    110 +  --mermaid-actor-bkg: #fed7aa;
    3941 +    3571 +    111 +  --mermaid-actor-border: #ea580c;
    3942 +    3572 +    112 +  --mermaid-actor-text-color: #431407;
    3943 +    3573 +    113 +  --mermaid-actor-line-color: #ea580c;
    3944 +    3574 +    114 +  --mermaid-signal-color: #f97316;
    3945 +    3575 +    115 +  --mermaid-signal-text-color: #431407;
    3946 +    3576 +    116 +  --mermaid-label-box-bkg-color: #fed7aa;
    3947 +    3577 +    117 +  --mermaid-label-box-border-color: #ea580c;
    3948 +    3578 +    118 +  --mermaid-label-text-color: #431407;
    3949 +    3579 +    119 +  --mermaid-loop-text-color: #431407;
    3950 +    3580 +    120 +  --mermaid-activation-border-color: #f97316;
    3951 +    3581 +    121 +  --mermaid-activation-bkg-color: #ffedd5;
    3952 +    3582 +    122 +  --mermaid-sequence-number-color: #431407;
    3953 +    3583 +    123 +
    3954 +    3584 +    124 +  /* Pie Chart */
    3955 +    3585 +    125 +  --mermaid-pie1: #ea580c;
    3956 +    3586 +    126 +  --mermaid-pie2: #f97316;
    3957 +    3587 +    127 +  --mermaid-pie3: #fb923c;
    3958 +    3588 +    128 +  --mermaid-pie4: #dc2626;
    3959 +    3589 +    129 +  --mermaid-pie5: #e11d48;
    3960 +    3590 +    130 +  --mermaid-pie6: #db2777;
    3961 +    3591 +    131 +  --mermaid-pie7: #c2410c;
    3962 +    3592 +    132 +  --mermaid-pie8: #14b8a6;
    3963 +    3593 +    133 +  --mermaid-pie9: #3b82f6;
    3964 +    3594 +    134 +  --mermaid-pie10: #a855f7;
    3965 +    3595 +    135 +  --mermaid-pie11: #ef4444;
    3966 +    3596 +    136 +  --mermaid-pie12: #10b981;
    3967 +    3597 +    137 +  --mermaid-pie-title-text-color: #431407;
    3968 +    3598 +    138 +  --mermaid-pie-section-text-color: #fff7ed; /* Light on vibrant slices */
    3969 +    3599 +    139 +  --mermaid-pie-legend-text-color: #431407;
    3970 +    3600 +    140 +  --mermaid-pie-stroke-color: #ea580c;
    3971 +    3601 +    141 +  --mermaid-pie-outer-stroke-color: #ea580c;
    3972 +    3602 +    142 +
    3973 +    3603 +    143 +  /* State Diagram */
    3974 +    3604 +    144 +  --mermaid-label-color: #431407;
    3975 +    3605 +    145 +  --mermaid-alt-background: #ffedd5;
    3976 +    3606 +    146 +
    3977 +    3607 +    147 +  /* Class Diagram */
    3978 +    3608 +    148 +  --mermaid-class-text: #431407;
    3979 +    3609 +    149 +
    3980 +    3610 +    150 +  /* User Journey */
    3981 +    3611 +    151 +  --mermaid-fill-type0: #ea580c;
    3982 +    3612 +    152 +  --mermaid-fill-type1: #f97316;
    3983 +    3613 +    153 +  --mermaid-fill-type2: #fb923c;
    3984 +    3614 +    154 +  --mermaid-fill-type3: #dc2626;
    3985 +    3615 +    155 +  --mermaid-fill-type4: #e11d48;
    3986 +    3616 +    156 +  --mermaid-fill-type5: #db2777;
    3987 +    3617 +    157 +  --mermaid-fill-type6: #c2410c;
    3988 +    3618 +    158 +  --mermaid-fill-type7: #14b8a6;
    3989 +    3619 + 47 159  }
    3990 +    3620 + 48 160  
    3991 +379 3621  
    3992 +380 3622  ```
    3993 +381 3623  
    3994 +@@ -421,4 +3663,4 @@ Please provide specific feedback on:
    3995 +421 3663  
    3996 +422 3664  ---
    3997 +423 3665  *Generated by AI Visual Code Review v2.0 - Unified Export Script*
    3998 +424     -*Files processed: 3/3 | Errors: 0 | Generated: 2025-12-07T02:57:20.361Z*
    3999 +    3666 +*Files processed: 18/18 | Errors: 0 | Generated: 2025-12-07T04:29:24.609Z*
    4000 +425 3667  
496 4001  
497 4002  ```
498 4003  
499 4004  
500     -### ‚ú® `docs/02-architecture/mermaid-theme-architecture.md` **[ADDED]**
    4005 +### ‚ú® `codebase_audit/audit_summary.md` **[ADDED]**
501 4006  
502 4007  **Status:** ‚úÖ **NEW FILE** - This file has been newly created
503 4008  
504 4009  **Type:** Documentation üìñ
505 4010  
506 4011  ```diff
507     -@@ -0,0 +1,208 @@
508     -      1 +# Mermaid Theme Architecture - Comprehensive Reference
    4012 +@@ -0,0 +1,49 @@
    4013 +      1 +# üìä Codebase Audit Summary
509 4014        2 +
510     -      3 +**Last Updated:** 12/7/2025
511     -      4 +**Source:** Official Mermaid.js theming documentation
512     -      5 +
513     -      6 +## Complete Mermaid Theme Variables
514     -      7 +
515     -      8 +### Core Global Variables
516     -      9 +
517     -     10 +| Variable     | Type       | Description                  | Default                        |
518     -     11 +| ------------ | ---------- | ---------------------------- | ------------------------------ |
519     -     12 +| `background` | Background | Page background              | `#f4f4f4`                      |
520     -     13 +| `fontFamily` | Text       | Font family                  | `trebuchet ms, verdana, arial` |
521     -     14 +| `fontSize`   | Text       | Font size                    | `16px`                         |
522     -     15 +| `darkMode`   | Boolean    | Affects color calculations   | `false`                        |
523     -     16 +| `textColor`  | Text       | General text over background | calculated                     |
524     -     17 +| `lineColor`  | Line       | Lines and connections        | calculated                     |
525     -     18 +| `mainBkg`    | Background | Main background for objects  | calculated                     |
    4015 +      3 +**Date:** 2025-12-09
    4016 +      4 +**Auditor:** CodeBaseGPT
    4017 +      5 +**Repository:** `markdown-viewer-app`
    4018 +      6 +
    4019 +      7 +---
    4020 +      8 +
    4021 +      9 +## üèÅ Executive Summary
    4022 +     10 +
    4023 +     11 +The `markdown-viewer-app` is a **Client-Side SPA** built with **Vanilla JavaScript**. It has a solid modular foundation (`Services` directory) but suffers from "Controller Bloat" in `script.js`.
    4024 +     12 +
    4025 +     13 +**Health Score:** üü° **C+ (Needs Attention)**
    4026 +     14 +
    4027 +     15 +- **Architecture:** ‚≠ê‚≠ê‚≠ê (3/5) - Good service separation, but monolithic controller.
    4028 +     16 +- **Security:** ‚≠ê (1/5) - **CRITICAL** Stored XSS vulnerability detected.
    4029 +     17 +- **Code Quality:** ‚≠ê‚≠ê‚≠ê (3/5) - Human-readable, but prone to race conditions.
    4030 +     18 +- **Documentation:** ‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê (5/5) - Excellent, comprehensive documentation.
526 4031       19 +
527     -     20 +### Primary/Secondary/Tertiary Color Sets
    4032 +     20 +---
528 4033       21 +
529     -     22 +Each set has 3 variables (background, text, border):
    4034 +     22 +## üìÇ Audit Artifacts
530 4035       23 +
531     -     24 +| Variable               | Type       | Description                |
532     -     25 +| ---------------------- | ---------- | -------------------------- |
533     -     26 +| `primaryColor`         | Background | Primary node background    |
534     -     27 +| `primaryTextColor`     | Text       | Text in primary nodes      |
535     -     28 +| `primaryBorderColor`   | Border     | Border for primary nodes   |
536     -     29 +| `secondaryColor`       | Background | Secondary node background  |
537     -     30 +| `secondaryTextColor`   | Text       | Text in secondary nodes    |
538     -     31 +| `secondaryBorderColor` | Border     | Border for secondary nodes |
539     -     32 +| `tertiaryColor`        | Background | Tertiary node background   |
540     -     33 +| `tertiaryTextColor`    | Text       | Text in tertiary nodes     |
541     -     34 +| `tertiaryBorderColor`  | Border     | Border for tertiary nodes  |
    4036 +     24 +1.  **[Repo Manifest](./repo_manifest.json)** - Full inventory of files.
    4037 +     25 +2.  **[Consolidated Findings](./phase4_consolidated_findings.md)** - High-level issue list.
    4038 +     26 +3.  **[Implementation Plan](./phase4_implementation_plan.md)** - Step-by-step roadmap.
    4039 +     27 +4.  **[Detailed Roadmap](./phase5_recommendations.md)** - Strategic recommendations.
    4040 +     28 +
    4041 +     29 +### üî¨ Deep Dive Reviews
    4042 +     30 +*   **[script.js Review](./deep_dive_reviews/script_js_review.md)** (Critical Issues)
    4043 +     31 +*   **[ThemeManager.js Review](./deep_dive_reviews/theme_manager_review.md)** (Performance Notes)
    4044 +     32 +*   **[MermaidService.js Review](./deep_dive_reviews/mermaid_service_review.md)** (Coupling Notes)
    4045 +     33 +
    4046 +     34 +---
542 4047       35 +
543     -     36 +### Flowchart-Specific Variables
    4048 +     36 +## üõë Top 3 Priorities
544 4049       37 +
545     -     38 +| Variable              | Type       | Description           |
546     -     39 +| --------------------- | ---------- | --------------------- |
547     -     40 +| `nodeBorder`          | Border     | Node border color     |
548     -     41 +| `clusterBkg`          | Background | Subgraph background   |
549     -     42 +| `clusterBorder`       | Border     | Subgraph border       |
550     -     43 +| `defaultLinkColor`    | Line       | Link/edge color       |
551     -     44 +| `titleColor`          | Text       | Title text color      |
552     -     45 +| `edgeLabelBackground` | Background | Edge label background |
553     -     46 +| `nodeTextColor`       | Text       | Text inside nodes     |
554     -     47 +
555     -     48 +### Sequence Diagram Variables
556     -     49 +
557     -     50 +| Variable                | Type       | Description           |
558     -     51 +| ----------------------- | ---------- | --------------------- |
559     -     52 +| `actorBkg`              | Background | Actor box background  |
560     -     53 +| `actorBorder`           | Border     | Actor box border      |
561     -     54 +| `actorTextColor`        | Text       | Actor text            |
562     -     55 +| `actorLineColor`        | Line       | Actor lifeline        |
563     -     56 +| `signalColor`           | Line       | Signal arrows         |
564     -     57 +| `signalTextColor`       | Text       | Signal labels         |
565     -     58 +| `labelBoxBkgColor`      | Background | Label box background  |
566     -     59 +| `labelBoxBorderColor`   | Border     | Label box border      |
567     -     60 +| `labelTextColor`        | Text       | Label text            |
568     -     61 +| `loopTextColor`         | Text       | Loop text             |
569     -     62 +| `activationBorderColor` | Border     | Activation border     |
570     -     63 +| `activationBkgColor`    | Background | Activation background |
571     -     64 +| `sequenceNumberColor`   | Text       | Sequence numbers      |
572     -     65 +
573     -     66 +### Pie Chart Variables
574     -     67 +
575     -     68 +| Variable              | Type       | Description                           |
576     -     69 +| --------------------- | ---------- | ------------------------------------- |
577     -     70 +| `pie1` - `pie12`      | Background | Fill colors for sections              |
578     -     71 +| `pieTitleTextSize`    | Text       | Title font size (default: `25px`)     |
579     -     72 +| `pieTitleTextColor`   | Text       | Title text color                      |
580     -     73 +| `pieSectionTextSize`  | Text       | Section label size (default: `17px`)  |
581     -     74 +| `pieSectionTextColor` | Text       | **Section label color (ON SLICES!)**  |
582     -     75 +| `pieLegendTextSize`   | Text       | Legend font size (default: `17px`)    |
583     -     76 +| `pieLegendTextColor`  | Text       | Legend text color                     |
584     -     77 +| `pieStrokeColor`      | Border     | Slice borders (default: `black`)      |
585     -     78 +| `pieStrokeWidth`      | Border     | Slice border width (default: `2px`)   |
586     -     79 +| `pieOuterStrokeWidth` | Border     | Outer circle width (default: `2px`)   |
587     -     80 +| `pieOuterStrokeColor` | Border     | Outer circle color (default: `black`) |
588     -     81 +| `pieOpacity`          | Visual     | Slice opacity (default: `0.7`)        |
589     -     82 +
590     -     83 +### State Diagram Variables
591     -     84 +
592     -     85 +| Variable        | Type       | Description                |
593     -     86 +| --------------- | ---------- | -------------------------- |
594     -     87 +| `labelColor`    | Text       | State label color          |
595     -     88 +| `altBackground` | Background | Composite state background |
596     -     89 +
597     -     90 +### Class Diagram Variables
598     -     91 +
599     -     92 +| Variable    | Type | Description      |
600     -     93 +| ----------- | ---- | ---------------- |
601     -     94 +| `classText` | Text | Class text color |
602     -     95 +
603     -     96 +### User Journey Variables
604     -     97 +
605     -     98 +| Variable                  | Type       | Description   |
606     -     99 +| ------------------------- | ---------- | ------------- |
607     -    100 +| `fillType0` - `fillType7` | Background | Section fills |
608     -    101 +
609     -    102 +## Critical Insights
610     -    103 +
611     -    104 +### 1. Pie Section Text Contrast Issue
612     -    105 +
613     -    106 +**Problem:** `pieSectionTextColor` is text **ON** the colored pie slices!
614     -    107 +
615     -    108 +- If slices are dark and text is dark ‚Üí **UNREADABLE**
616     -    109 +- If slices are light and text is light ‚Üí **UNREADABLE**
617     -    110 +
618     -    111 +**Solution:** `pieSectionTextColor` must contrast with `pie1-pie12` colors!
619     -    112 +
620     -    113 +### 2. Background vs Text Variables
621     -    114 +
622     -    115 +- **Background variables** (end with `Bkg`, `Color`, or are named `pie1-12`)
623     -    116 +- **Text variables** (contain `Text` or `textColor`)
624     -    117 +- **Border variables** (contain `Border` or `Stroke`)
625     -    118 +- **Line variables** (contain `Line` or `lineColor`)
626     -    119 +
627     -    120 +### 3. Calculated vs Explicit
628     -    121 +
629     -    122 +- Mermaid **calculates** many colors if not provided
630     -    123 +- But calculation may not match our theme aesthetics
631     -    124 +- **We should set ALL critical variables explicitly**
632     -    125 +
633     -    126 +## Implementation Strategy
634     -    127 +
635     -    128 +### For Each Theme, Define
636     -    129 +
637     -    130 +1. **Core Backgrounds** (3 levels for hierarchy)
638     -    131 +   - `primaryColor`, `secondaryColor`, `tertiaryColor`
639     -    132 +
640     -    133 +2. **All Text Colors** (must contrast with their backgrounds!)
641     -    134 +   - `primaryTextColor`, `secondaryTextColor`, `tertiaryTextColor`
642     -    135 +   - `nodeTextColor`, `actorTextColor`, `signalTextColor`
643     -    136 +   - `pieTitleTextColor`, `pieSectionTextColor`, `pieLegendTextColor`
644     -    137 +
645     -    138 +3. **All Border Colors** (visible against backgrounds)
646     -    139 +   - `primaryBorderColor`, `secondaryBorderColor`, `tertiaryBorderColor`
647     -    140 +   - `nodeBorder`, `actorBorder`, `clusterBorder`
648     -    141 +   - `pieStrokeColor`, `pieOuterStrokeColor`
649     -    142 +
650     -    143 +4. **Line/Connection Colors**
651     -    144 +   - `lineColor`, `defaultLinkColor`
652     -    145 +   - `signalColor`, `actorLineColor`
653     -    146 +
654     -    147 +5. **Pie Slice Backgrounds** (12 distinct colors)
655     -    148 +   - `pie1` through `pie12` - must be DISTINCT from text color!
656     -    149 +
657     -    150 +## Architecture Pattern
658     -    151 +
659     -    152 +```javascript
660     -    153 +mermaid.initialize({
661     -    154 +  theme: 'base',
662     -    155 +  themeVariables: {
663     -    156 +    // Core (affects ALL diagrams)
664     -    157 +    background: bgPrimary,
665     -    158 +    fontFamily: '...',
666     -    159 +    fontSize: '16px',
667     -    160 +
668     -    161 +    // Primary set (most nodes)
669     -    162 +    primaryColor: [BACKGROUND],
670     -    163 +    primaryTextColor: [TEXT - must contrast!],
671     -    164 +    primaryBorderColor: [BORDER - visible],
672     -    165 +
673     -    166 +    // Secondary set (clusters, special nodes)
674     -    167 +    secondaryColor: [BACKGROUND],
675     -    168 +    secondaryTextColor: [TEXT - must contrast!],
676     -    169 +    secondaryBorderColor: [BORDER - visible],
677     -    170 +
678     -    171 +    // Tertiary set (nested elements)
679     -    172 +    tertiaryColor: [BACKGROUND],
680     -    173 +    tertiaryTextColor: [TEXT - must contrast!],
681     -    174 +    tertiaryBorderColor: [BORDER - visible],
682     -    175 +
683     -    176 +    // Flowchart specific
684     -    177 +    nodeBorder: [VISIBLE],
685     -    178 +    nodeTextColor: [CONTRASTING],
686     -    179 +    edgeLabelBackground: [BACKGROUND],
687     -    180 +
688     -    181 +    // Sequence diagram specific
689     -    182 +    actorBkg: [BACKGROUND],
690     -    183 +    actorTextColor: [CONTRASTING],
691     -    184 +
692     -    185 +    // Pie chart specific
693     -    186 +    pie1-12: [12 DISTINCT COLORS],
694     -    187 +    pieSectionTextColor: [CONTRASTS WITH pie1-12!],
695     -    188 +
696     -    189 +    // Lines
697     -    190 +    lineColor: [VISIBLE],
698     -    191 +    signalColor: [VISIBLE],
699     -    192 +  }
700     -    193 +});
701     -    194 +```
702     -    195 +
703     -    196 +## Testing Checklist
704     -    197 +
705     -    198 +- [ ] Flowchart - nodes, clusters, edges readable
706     -    199 +- [ ] Sequence diagram - actors, signals, loops readable
707     -    200 +- [ ] Pie chart - slices, percentages, legend readable
708     -    201 +- [ ] State diagram - states, transitions readable
709     -    202 +- [ ] Class diagram - classes, methods readable
710     -    203 +- [ ] User journey - tasks, emotions readable
711     -    204 +
712     -    205 +## References
713     -    206 +
714     -    207 +- [Mermaid Theming Documentation](https://mermaid.js.org/config/theming.html)
715     -    208 +- [Base Theme Source](https://github.com/mermaid-js/mermaid/blob/develop/packages/mermaid/src/themes/theme-base.js)
716     -    209  
    4050 +     38 +1.  **üî• FIX:** Install `dompurify` and sanitize Markdown rendering immediately.
    4051 +     39 +2.  **üèóÔ∏è REFACTOR:** Break `script.js` into `UIManager`, `EventManager`, and `AppController`.
    4052 +     40 +3.  **üêõ BUG:** Replace `setTimeout` callbacks with `Promise` chains for robust rendering.
    4053 +     41 +
    4054 +     42 +---
    4055 +     43 +
    4056 +     44 +## üìù Next Steps
    4057 +     45 +
    4058 +     46 +Ready to begin **Phase 1 of Remediation**:
    4059 +     47 +> Executing `npm install dompurify` and patching `script.js` to fix the XSS vulnerability.
    4060 +     48 +
    4061 +     49 +**Proceed?**
    4062 +     50  
717 4063  
718 4064  ```
719 4065  
720 4066  
721     -### ‚ú® `docs/02-architecture/prism-token-architecture.md` **[ADDED]**
    4067 +### ‚ú® `codebase_audit/deep_dive_reviews/mermaid_service_review.md` **[ADDED]**
722 4068  
723 4069  **Status:** ‚úÖ **NEW FILE** - This file has been newly created
724 4070  
725 4071  **Type:** Documentation üìñ
726 4072  
727 4073  ```diff
728     -@@ -0,0 +1,226 @@
729     -      1 +# Prism Token Architecture - Comprehensive Reference
    4074 +@@ -0,0 +1,47 @@
    4075 +      1 +# üïµÔ∏è‚Äç‚ôÇÔ∏è Deep Dive Code Review: `MermaidService.js`
730 4076        2 +
731     -      3 +**Last Updated:** 12/7/2025
732     -      4 +**Source:** Official Prism.js documentation + One Dark theme analysis
733     -      5 +
734     -      6 +## Standard Token Classes
735     -      7 +
736     -      8 +### Core Language Constructs
737     -      9 +
738     -     10 +| Token Class   | Purpose                    | Example                                  | Recommended Color Hue             |
739     -     11 +| ------------- | -------------------------- | ---------------------------------------- | --------------------------------- |
740     -     12 +| `keyword`     | Reserved words             | `if`, `else`, `class`, `final`, `sealed` | Purple/Magenta (286¬∞)             |
741     -     13 +| `builtin`     | Built-in functions/types   | `String`, `Array`, `Console`             | Green (95¬∞)                       |
742     -     14 +| `class-name`  | Class/Interface/Type names | `Rectangle`, `Shape`, `Person`           | Orange (29¬∞)                      |
743     -     15 +| `function`    | Function/method names      | `main`, `println`, `forEach`             | Blue (207¬∞)                       |
744     -     16 +| `boolean`     | True/false values          | `true`, `false`                          | Orange (29¬∞)                      |
745     -     17 +| `number`      | Numeric literals           | `42`, `3.14`, `0xDEADBEEF`               | Orange (29¬∞)                      |
746     -     18 +| `string`      | String literals            | `"Hello"`, `'World'`                     | Green (95¬∞)                       |
747     -     19 +| `char`        | Character literals         | `'A'`, `'\n'`                            | Green (95¬∞)                       |
748     -     20 +| `symbol`      | Symbols (Smalltalk, Ruby)  | `:mySymbol`                              | Green (95¬∞)                       |
749     -     21 +| `regex`       | Regular expressions        | `/[a-z]+/i`                              | Green (95¬∞)                       |
750     -     22 +| `operator`    | Operators                  | `+`, `-`, `*`, `/`, `=`, `==`            | Purple (286¬∞)                     |
751     -     23 +| `variable`    | Variable names (special)   | Less/Bash variables                      | Blue (207¬∞)                       |
752     -     24 +| `constant`    | Constants                  | `PI`, `MAX_SIZE`, `stdout`               | Orange (29¬∞)                      |
753     -     25 +| `property`    | Object properties          | CSS properties, JSON keys                | Red (355¬∞)                        |
754     -     26 +| `punctuation` | Delimiters                 | `{`, `}`, `;`, `,`                       | Gray/White                        |
755     -     27 +| `comment`     | Code comments              | `// comment`, `/* block */`              | Muted gray (220¬∞, low saturation) |
    4077 +      3 +**Reviewer:** CodeBaseGPT (Senior SDE Persona)
    4078 +      4 +**Date:** 2025-12-09
    4079 +      5 +**File:** `src/js/services/MermaidService.js` (302 Lines)
    4080 +      6 +
    4081 +      7 +---
    4082 +      8 +
    4083 +      9 +## ‚ö†Ô∏è Issues & Observations
    4084 +     10 +
    4085 +     11 +### 1. ‚öôÔ∏è Massive Configuration Object (Line 96)
    4086 +     12 +```javascript
    4087 +     13 +themeVariables: { ... 100+ lines ... }
    4088 +     14 +```
    4089 +     15 +**Critique:** You are explicitly mapping every single Mermaid variable (60+) to your own CSS variables.
    4090 +     16 +- **Pros:** Total control over the look.
    4091 +     17 +- **Cons:** **High Coupling**. If Mermaid v12 changes its variable names (e.g., `primaryColor` -> `mainColor`), your integration breaks or looks wrong.
    4092 +     18 +- **Suggestion:** Consider whether mapped sets (Primary, Secondary, Tertiary) are sufficient, or if this granular control is truly business-critical.
    4093 +     19 +
    4094 +     20 +### 2. üî¢ Hardcoded Font configurations (Lines 99, 100)
    4095 +     21 +```javascript
    4096 +     22 +fontFamily: '-apple-system, ...',
    4097 +     23 +fontSize: '16px',
    4098 +     24 +```
    4099 +     25 +**Critique:** You are hardcoding fonts in JS.
    4100 +     26 +- **Issue:** If the user changes the font in `style.css`, the diagrams won't match the rest of the app.
    4101 +     27 +- **Fix:** Use `getCssVariable('--font-family')` and `getCssVariable('--font-size-base')`.
756 4102       28 +
757     -     29 +### Markup-Specific Tokens
    4103 +     29 +### 3. üìâ Missing Debounce/Cancellation
    4104 +     30 +**Critique:** `MermaidService.render` is async.
    4105 +     31 +- **Scenario:** User types fast. `render('id', 'graph TD...')` is called 5 times in 200ms.
    4106 +     32 +- **Result:** You might have 5 parallel rendering processes competing.
    4107 +     33 +- **Fix:** Implement a `Cancellation` mechanism or rely on the Controller to debounce calls (which `script.js` currently fails to do properly).
    4108 +     34 +
    4109 +     35 +### 4. üé≠ Theme Detection Logic (Line 45)
    4110 +     36 +```javascript
    4111 +     37 +function isLightTheme(bgColor) { ... }
    4112 +     38 +```
    4113 +     39 +**Critique:** Clever use of luminance calculation!
    4114 +     40 +- **Positive:** This is a nice "Senior Dev" touch. It ensures that even if I pick a weird Custom Theme color (e.g., bright yellow background), Mermaid will likely pick the correct "Dark/Light" base mode.
    4115 +     41 +- **Refactor:** Move `getRelativeLuminance` to `src/js/utils/colorHelpers.js`. It is a pure utility function and might be useful elsewhere (e.g., checking text contrast accessibility).
    4116 +     42 +
    4117 +     43 +---
    4118 +     44 +
    4119 +     45 +## üèÅ Verdict
    4120 +     46 +**Grade: B+**
    4121 +     47 +The logic is solid, but the coupling to Mermaid's specific variable names is a risk. It's "Enterprise Grade" in the sense that it handles everything, but "Enterprise Grade" also means "Heavy maintenance".
    4122 +     48  
    4123 +
    4124 +```
    4125 +
    4126 +
    4127 +### ‚ú® `codebase_audit/deep_dive_reviews/script_js_review.md` **[ADDED]**
    4128 +
    4129 +**Status:** ‚úÖ **NEW FILE** - This file has been newly created
    4130 +
    4131 +**Type:** Documentation üìñ
    4132 +
    4133 +```diff
    4134 +@@ -0,0 +1,121 @@
    4135 +      1 +# üïµÔ∏è‚Äç‚ôÇÔ∏è Deep Dive Code Review: `script.js`
    4136 +      2 +
    4137 +      3 +**Reviewer:** CodeBaseGPT (Senior SDE Persona)
    4138 +      4 +**Date:** 2025-12-09
    4139 +      5 +**File:** `script.js` (1372 Lines)
    4140 +      6 +
    4141 +      7 +---
    4142 +      8 +
    4143 +      9 +## üõë Critical Issues (Must Fix)
    4144 +     10 +
    4145 +     11 +### 1. üíÄ Stored XSS Vulnerability (Line 512)
    4146 +     12 +```javascript
    4147 +     13 +preview.innerHTML = html;
    4148 +     14 +```
    4149 +     15 +**Critique:** You are taking the output of `marked.parse()` and dumping it directly into the DOM. `marked` does **not** sanitize HTML execution by default.
    4150 +     16 +- **Scenario:** A user opens a markdown file containing `<img src=x onerror=alert(1)>`.
    4151 +     17 +- ** Impact:** Arbitrary code execution.
    4152 +     18 +- **Fix:** You **MUST** use `DOMPurify.sanitize(html)` before assignment.
    4153 +     19 +
    4154 +     20 +### 2. üê¢ recursive Polling for Dependencies (Lines 46-75)
    4155 +     21 +```javascript
    4156 +     22 +if (typeof marked === 'undefined' ...) {
    4157 +     23 +    setTimeout(initializeApp, 100);
    4158 +     24 +    return;
    4159 +     25 +}
    4160 +     26 +```
    4161 +     27 +**Critique:** This "check and retry" pattern is an anti-pattern.
    4162 +     28 +- **Why:** It burns CPU in a tight loop. It complicates the startup race conditions.
    4163 +     29 +- **Fix:** Use standard `<script defer>` or ES Module `import` statements to guarantee execution order. If you strictly need globals, use `window.onload`.
758 4164       30 +
759     -     31 +| Token Class  | Purpose             | Example                     |
760     -     32 +| ------------ | ------------------- | --------------------------- |
761     -     33 +| `tag`        | HTML/XML tags       | `<div>`, `<p>`              |
762     -     34 +| `attr-name`  | Attribute names     | `id`, `class`, `href`       |
763     -     35 +| `attr-value` | Attribute values    | `"header"`, `"https://..."` |
764     -     36 +| `namespace`  | XML namespaces      | `html:p`, `foo:bar`         |
765     -     37 +| `prolog`     | XML prolog          | `<?xml version="1.0"?>`     |
766     -     38 +| `doctype`    | DOCTYPE declaration | `<!DOCTYPE html>`           |
767     -     39 +| `cdata`      | CDATA sections      | `<![CDATA[...]]>`           |
768     -     40 +| `entity`     | HTML entities       | `&amp;`, `&#x2665;`         |
769     -     41 +
770     -     42 +### Document Markup Tokens
771     -     43 +
772     -     44 +| Token Class | Purpose         | Example      |
773     -     45 +| ----------- | --------------- | ------------ |
774     -     46 +| `bold`      | Bold text       | `**bold**`   |
775     -     47 +| `italic`    | Italic text     | `*italic*`   |
776     -     48 +| `important` | Important (CSS) | `!important` |
777     -     49 +
778     -     50 +### Stylesheet Tokens
779     -     51 +
780     -     52 +| Token Class | Purpose       | Example                  |
781     -     53 +| ----------- | ------------- | ------------------------ |
782     -     54 +| `atrule`    | CSS @ rules   | `@media`, `@import`      |
783     -     55 +| `selector`  | CSS selectors | `.class`, `#id`, `div p` |
784     -     56 +| `url`       | URLs          | `url(image.png)`         |
785     -     57 +
786     -     58 +### Diff Tokens
787     -     59 +
788     -     60 +| Token Class | Purpose       |
789     -     61 +| ----------- | ------------- |
790     -     62 +| `inserted`  | Added lines   |
791     -     63 +| `deleted`   | Removed lines |
792     -     64 +
793     -     65 +## Professional Theme Analysis (One Dark)
794     -     66 +
795     -     67 +### Color Grouping Strategy
796     -     68 +
797     -     69 +One Dark uses **7 core hues** systematically:
798     -     70 +
799     -     71 +1. **mono-1** (220¬∞, 14%, 71%) - Default text
800     -     72 +2. **mono-2** (220¬∞, 9%, 55%) - Secondary text
801     -     73 +3. **mono-3** (220¬∞, 10%, 40%) - Comments
802     -     74 +4. **hue-1** (187¬∞, 47%, 55%) - Cyan - URLs
803     -     75 +5. **hue-2** (207¬∞, 82%, 66%) - Blue - Variables, operators, functions
804     -     76 +6. **hue-3** (286¬∞, 60%, 67%) - Purple - Keywords
805     -     77 +7. **hue-4** (95¬∞, 38%, 62%) - Green - Strings
806     -     78 +8. **hue-5** (355¬∞, 65%, 65%) - Red - Properties, tags, symbols
807     -     79 +9. **hue-6** (29¬∞, 54%, 61%) - Orange - Class names, constants, numbers
808     -     80 +
809     -     81 +### Token Grouping
810     -     82 +
811     -     83 +```css
812     -     84 +/* Group 1: Comments */
813     -     85 +.token.comment, .token.prolog, .token.cdata
814     -     86 +
815     -     87 +/* Group 2: Neutral (inherit default color) */
816     -     88 +.token.doctype, .token.punctuation, .token.entity
817     -     89 +
818     -     90 +/* Group 3: Orange - Class names, constants, numbers */
819     -     91 +.token.attr-name, .token.class-name, .token.boolean,
820     -     92 +.token.constant, .token.number, .token.atrule
821     -     93 +
822     -     94 +/* Group 4: Purple - Keywords */
823     -     95 +.token.keyword
824     -     96 +
825     -     97 +/* Group 5: Red - Properties, tags */
826     -     98 +.token.property, .token.tag, .token.symbol,
827     -     99 +.token.deleted, .token.important
828     -    100 +
829     -    101 +/* Group 6: Green - Strings, builtins */
830     -    102 +.token.selector, .token.string, .token.char,
831     -    103 +.token.builtin, .token.inserted, .token.regex,
832     -    104 +.token.attr-value
833     -    105 +
834     -    106 +/* Group 7: Blue - Variables, operators, functions */
835     -    107 +.token.variable, .token.operator, .token.function
836     -    108 +
837     -    109 +/* Group 8: Cyan - URLs */
838     -    110 +.token.url
839     -    111 +```
840     -    112 +
841     -    113 +### Language-Specific Overrides
842     -    114 +
843     -    115 +Professional themes use **cascading specificity** for language-specific rules:
844     -    116 +
845     -    117 +```css
846     -    118 +/* JavaScript overrides */
847     -    119 +.language-javascript .token.operator { color: purple; }
848     -    120 +.language-javascript .token.template-string > .token.interpolation { ... }
849     -    121 +
850     -    122 +/* CSS overrides */
851     -    123 +.language-css .token.selector { color: red; }
852     -    124 +.language-css .token.property { color: gray; }
853     -    125 +
854     -    126 +/* JSON overrides */
855     -    127 +.language-json .token.null.keyword { color: orange; }
856     -    128 +
857     -    129 +/* Markdown overrides */
858     -    130 +.language-markdown .token.url { ... }
859     -    131 +```
860     -    132 +
861     -    133 +## Implementation Architecture
862     -    134 +
863     -    135 +### CSS Specificity Levels
864     -    136 +
865     -    137 +1. **Base tokens** - All languages
866     -    138 +2. **Language-specific overrides** - `.language-xxx .token.yyy`
867     -    139 +3. **Nested tokens** - `.token.xxx > .token.yyy`
868     -    140 +4. **Plugin overrides** - `.rainbow-braces`, `.diff-highlight`, etc.
869     -    141 +
870     -    142 +### Variable Mapping Strategy
871     -    143 +
872     -    144 +```css
873     -    145 +/* Map standard Prism tokens to theme CSS variables */
874     -    146 +.token.keyword {
875     -    147 +  color: var(--syntax-keyword);
876     -    148 +}
877     -    149 +.token.string {
878     -    150 +  color: var(--syntax-string);
879     -    151 +}
880     -    152 +.token.class-name {
881     -    153 +  color: var(--syntax-class-name); /* Distinct variable! */
882     -    154 +}
883     -    155 +```
884     -    156 +
885     -    157 +### Token Aliases
886     -    158 +
887     -    159 +Prism uses aliases to group similar tokens:
888     -    160 +
889     -    161 +- `attr-value` can contain nested `punctuation` tokens
890     -    162 +- `template-string` can contain `interpolation` with nested tokens
891     -    163 +- Language definitions use `alias` property to inherit styles
892     -    164 +
893     -    165 +## Best Practices
894     -    166 +
895     -    167 +1. **Use Distinct Variables** - Don't reuse variables across semantically different tokens
896     -    168 +2. **Follow Standards** - Match Prism's standard token names
897     -    169 +3. **Language Overrides** - Use when default grouping doesn't fit
898     -    170 +4. **Test Comprehensively** - Verify with multiple languages (Java, Python, JS, CSS, etc.)
899     -    171 +5. **Font Weight** - Use bold/normal strategically for visual hierarchy
900     -    172 +6. **Color Contrast** - Ensure WCAG AA compliance (4.5:1 for text)
901     -    173 +
902     -    174 +## Token Coverage Checklist
903     -    175 +
904     -    176 +### Must Cover (Core)
905     -    177 +
906     -    178 +- [ ] keyword
907     -    179 +- [ ] builtin
908     -    180 +- [ ] class-name (distinct from keyword!)
909     -    181 +- [ ] function
910     -    182 +- [ ] string
911     -    183 +- [ ] number
912     -    184 +- [ ] boolean
913     -    185 +- [ ] comment
914     -    186 +- [ ] operator
915     -    187 +- [ ] punctuation
916     -    188 +- [ ] variable
917     -    189 +- [ ] property
918     -    190 +- [ ] constant
919     -    191 +- [ ] regex
920     -    192 +
921     -    193 +### Markup Languages
922     -    194 +
923     -    195 +- [ ] tag
924     -    196 +- [ ] attr-name
925     -    197 +- [ ] attr-value
926     -    198 +- [ ] namespace
927     -    199 +- [ ] doctype
928     -    200 +- [ ] entity
929     -    201 +
930     -    202 +### Advanced
931     -    203 +
932     -    204 +- [ ] atrule (CSS)
933     -    205 +- [ ] selector (CSS)
934     -    206 +- [ ] url
935     -    207 +- [ ] inserted/deleted (Diff)
936     -    208 +- [ ] bold/italic (Markdown)
937     -    209 +- [ ] important (CSS)
938     -    210 +
939     -    211 +## Implementation Checklist
940     -    212 +
941     -    213 +- [ ] Define comprehensive CSS variable palette (8-10 distinct hues)
942     -    214 +- [ ] Map ALL standard tokens to variables
943     -    215 +- [ ] Add language-specific overrides where needed
944     -    216 +- [ ] Test with Java (most complex token usage)
945     -    217 +- [ ] Test with Python, JavaScript, CSS
946     -    218 +- [ ] Verify font-weight hierarchy
947     -    219 +- [ ] Check color contrast ratios
948     -    220 +- [ ] Document color semantics
949     -    221 +
950     -    222 +## References
951     -    223 +
952     -    224 +- [Prism Standard Tokens](https://prismjs.com/tokens.html)
953     -    225 +- [Prism Theme: One Dark](https://github.com/PrismJS/prism-themes/blob/master/themes/prism-one-dark.css)
954     -    226 +- [Atom One Dark Colors](https://github.com/atom/atom/tree/master/packages/one-dark-syntax)
955     -    227  
956     -
957     -```
958     -
959     -
960     -### üìÑ `script.js`
961     -
962     -**Type:** JavaScript Source File üü®
963     -
964     -```diff
965     -@@ -20,9 +20,20 @@ const folderBrowserService = new FolderBrowserService(storageManager);
966     - 20  20  const currentFolderFiles = [];
967     - 21  21  const currentFileHandle = null;
968     - 22  22  
969     - 23     -// Configure theme change listener to update Mermaid
970     -     23 +// Global render function reference (will be set in setupEditor)
971     -     24 +let globalRenderMarkdown = null;
972     -     25 +
973     -     26 +// Configure theme change listener to update Mermaid and force re-render
974     - 24  27  themeManager.setThemeChangeListener(() => {
975     - 25  28    mermaidService.reinitialize();
976     -     29 +
977     -     30 +  // Force re-render of markdown to apply new Mermaid colors
978     -     31 +  setTimeout(() => {
979     -     32 +    if (globalRenderMarkdown) {
980     -     33 +      console.log('üîÑ Re-rendering diagrams with new theme colors');
981     -     34 +      globalRenderMarkdown();
982     -     35 +    }
983     -     36 +  }, 200);
984     - 26  37  });
985     - 27  38  
986     - 28  39  // Wait for all scripts to load
987     -@@ -77,8 +88,8 @@ function initializeApp() {
988     - 77  88    // Configure marked.js extensions
989     - 78  89    configureMarkedExtensions();
990     - 79  90  
991     - 80     -  // Initialize Mermaid with theme-aware configuration
992     - 81     -  initMermaidTheme();
993     -     91 +  // DON'T initialize Mermaid here - let saved theme load first
994     -     92 +  // Mermaid will initialize after theme loads in setupEditor()
995     - 82  93  
996     - 83  94    setupEditor();
997     - 84  95  }
998     -@@ -461,7 +472,7 @@ graph TD
999     -461 472  
1000     -462 473    console.log('‚úÖ Subscript and superscript enabled (LaTeX environments display as-is)');
1001     -463 474  
1002     -464     -  // Render markdown
1003     -    475 +  // Render markdown (expose globally for theme changes)
1004     -465 476    function renderMarkdown() {
1005     -466 477      try {
1006     -467 478        const markdownText = editor.value;
1007     -@@ -520,8 +531,16 @@ graph TD
1008     -520 531    async function changeTheme(themeName) {
1009     -521 532      await themeManager.loadTheme(themeName);
1010     -522 533  
1011     -523     -    // Re-render to apply new Mermaid theme (observer already handles reinit)
1012     -    534 +    // Wait for theme to load, then reinitialize Mermaid and force re-render
1013     -524 535      setTimeout(() => {
1014     -    536 +      // Clear existing Mermaid diagrams to force fresh render with new colors
1015     -    537 +      const mermaidElements = preview.querySelectorAll('.mermaid');
1016     -    538 +      mermaidElements.forEach(el => {
1017     -    539 +        // Reset to original code to force re-render
1018     -    540 +        el.innerHTML = el.dataset.originalCode || '';
1019     -    541 +      });
1020     -    542 +
1021     -    543 +      // Re-render markdown with new theme
1022     -525 544        renderMarkdown();
1023     -526 545      }, 100);
1024     -527 546    }
1025     -@@ -969,24 +988,36 @@ graph TD
1026     -969 988    // Initialize visibility
1027     -970 989    updateSyncScrollVisibility();
1028     -971 990  
1029     -972     -  // Load saved theme using ThemeManager
1030     -    991 +  // Load saved theme FIRST, then initialize Mermaid with correct colors
1031     -973 992    const savedTheme = storageManager.get('selectedTheme');
1032     -974 993    if (savedTheme) {
1033     -975     -    // Load theme first, then sync dropdown only on success
1034     -    994 +    // Load theme first, then sync dropdown and reinit Mermaid
1035     -976 995      themeManager
1036     -977 996        .loadTheme(savedTheme)
1037     -978 997        .then(() => {
1038     -979 998          // Theme loaded successfully - sync dropdown
1039     -980 999          themeSelector.value = savedTheme;
1040     -981 1000          console.log(`‚úÖ Theme restored: ${savedTheme}`);
1041     -    1001 +
1042     -    1002 +        // NOW initialize Mermaid with correct theme colors
1043     -    1003 +        mermaidService.initialize();
1044     -    1004 +
1045     -    1005 +        // Re-render to apply theme
1046     -    1006 +        renderMarkdown();
1047     -982 1007        })
1048     -983 1008        .catch(err => {
1049     -984 1009          console.error('Failed to load saved theme:', err);
1050     -985 1010          // Fallback to default-light on error
1051     -986 1011          themeManager.loadTheme('default-light').then(() => {
1052     -987 1012            themeSelector.value = 'default-light';
1053     -    1013 +          mermaidService.initialize();
1054     -    1014 +          renderMarkdown();
1055     -988 1015          });
1056     -989 1016        });
1057     -    1017 +  } else {
1058     -    1018 +    // No saved theme - initialize with default-light
1059     -    1019 +    mermaidService.initialize();
1060     -    1020 +    renderMarkdown();
1061     -990 1021    }
1062     -991 1022  
1063     -992 1023    // Zoom functionality
1064     -@@ -1332,6 +1363,9 @@ graph TD
1065     -1332 1363      console.log(`‚úÖ Loaded file: ${fileItem.name} (${result.size} bytes)`);
1066     -1333 1364    }
1067     -1334 1365  
1068     -1335     -  // Initial render
1069     -1336     -  renderMarkdown();
1070     -    1366 +  // Expose renderMarkdown globally for theme changes
1071     -    1367 +  globalRenderMarkdown = renderMarkdown;
1072     -    1368 +
1073     -    1369 +  // DON'T render immediately - wait for theme to load
1074     -    1370 +  // renderMarkdown will be called after theme loads above
1075     -1337 1371  }
1076     -1338 1372  
1077     -
1078     -```
1079     -
1080     -
1081     -### üìÑ `src/js/services/MermaidService.js`
1082     -
1083     -**Type:** JavaScript Source File üü®
1084     -
1085     -```diff
1086     -@@ -2,12 +2,51 @@
1087     -  2   2   * MermaidService - Mermaid Diagram Rendering Service
1088     -  3   3   *
1089     -  4   4   * Handles all Mermaid diagram rendering with theme-aware configuration.
1090     -      5 + * Automatically detects light/dark themes and adjusts for optimal readability.
1091     -  5   6   * Isolated service for better testability and maintainability.
1092     -  6   7   */
1093     -  7   8  
1094     -  8   9  import { MERMAID_CONFIG } from '../config/constants.js';
1095     -  9  10  import { getCssVariable } from '../utils/colorHelpers.js';
1096     - 10  11  
1097     -     12 +/**
1098     -     13 + * Calculate relative luminance of a color
1099     -     14 + * Used to detect if theme is light or dark
1100     -     15 + *
1101     -     16 + * @param {string} color - Hex color (#rrggbb)
1102     -     17 + * @returns {number} Luminance value (0-1)
1103     -     18 + * @private
1104     -     19 + */
1105     -     20 +function getRelativeLuminance(color) {
1106     -     21 +  // Remove # if present
1107     -     22 +  const hex = color.replace('#', '');
1108     -     23 +
1109     -     24 +  // Convert to RGB
1110     -     25 +  const r = parseInt(hex.substr(0, 2), 16) / 255;
1111     -     26 +  const g = parseInt(hex.substr(2, 2), 16) / 255;
1112     -     27 +  const b = parseInt(hex.substr(4, 2), 16) / 255;
1113     -     28 +
1114     -     29 +  // Apply sRGB gamma correction
1115     -     30 +  const rsRGB = r <= 0.03928 ? r / 12.92 : ((r + 0.055) / 1.055) ** 2.4;
1116     -     31 +  const gsRGB = g <= 0.03928 ? g / 12.92 : ((g + 0.055) / 1.055) ** 2.4;
1117     -     32 +  const bsRGB = b <= 0.03928 ? b / 12.92 : ((b + 0.055) / 1.055) ** 2.4;
1118     -     33 +
1119     -     34 +  // Calculate relative luminance
1120     -     35 +  return 0.2126 * rsRGB + 0.7152 * gsRGB + 0.0722 * bsRGB;
1121     -     36 +}
1122     -     37 +
1123     -     38 +/**
1124     -     39 + * Detect if current theme is light or dark
1125     -     40 + *
1126     -     41 + * @param {string} bgColor - Background color
1127     -     42 + * @returns {boolean} True if light theme
1128     -     43 + * @private
1129     -     44 + */
1130     -     45 +function isLightTheme(bgColor) {
1131     -     46 +  const luminance = getRelativeLuminance(bgColor);
1132     -     47 +  return luminance > 0.5; // Threshold for light/dark
1133     -     48 +}
1134     -     49 +
1135     - 11  50  /**
1136     - 12  51   * @class MermaidService
1137     - 13  52   * @description Service for rendering Mermaid diagrams with theme integration
1138     -@@ -23,46 +62,187 @@ export class MermaidService {
1139     - 23  62    }
1140     - 24  63  
1141     - 25  64    /**
1142     - 26     -   * Initialize Mermaid with current theme colors
1143     - 27     -   * Extracts theme colors from CSS variables and configures Mermaid
1144     -     65 +   * Initialize Mermaid with COMPREHENSIVE theme configuration
1145     -     66 +   * Reads ALL 60+ variables from theme CSS with smart fallbacks
1146     -     67 +   * Based on official Mermaid.js theming documentation
1147     - 28  68     *
1148     - 29  69     * @returns {void}
1149     - 30  70     */
1150     - 31  71    initialize() {
1151     - 32     -    // Extract theme colors from CSS variables
1152     - 33     -    const h1Color = getCssVariable('--h1-color');
1153     - 34     -    const h2Color = getCssVariable('--h2-color');
1154     - 35     -    const h3Color = getCssVariable('--h3-color');
1155     - 36     -    const bgSecondary = getCssVariable('--bg-secondary');
1156     - 37     -    const textPrimary = getCssVariable('--text-primary');
1157     -     72 +    // Helper to get variable with fallback
1158     -     73 +    const get = (varName, fallback) => {
1159     -     74 +      const value = getCssVariable(varName);
1160     -     75 +      return value && value.trim() !== '' ? value : fallback;
1161     -     76 +    };
    4165 +     31 +### 3. üí• Race Condition "Magic Numbers" (Lines 490, 535)
    4166 +     32 +```javascript
    4167 +     33 +// Line 490
    4168 +     34 +setTimeout(() => { ... mermaid.render(...) }, 100);
    4169 +     35 +
    4170 +     36 +// Line 535
    4171 +     37 +setTimeout(() => { ... renderMarkdown() }, 100);
    4172 +     38 +```
    4173 +     39 +**Critique:** You are using `setTimeout` with a magic number (`100ms`) to "wait" for the DOM or other processes.
    4174 +     40 +- **Why:** This is unreliable. On a slow machine, 100ms isn't enough, and the render fails. On a fast machine, it causes a perceptible UI stutter.
    4175 +     41 +- **Fix:** Use **Promises** and `requestAnimationFrame`. `mermaid.render` returns a promise; await it.
    4176 +     42 +
    4177 +     43 +### 4. üî• Un-Debounced Rendering (Line 666)
    4178 +     44 +```javascript
    4179 +     45 +editor.addEventListener('input', renderMarkdown);
    4180 +     46 +```
    4181 +     47 +**Critique:** `renderMarkdown` is heavy (Regex + Parsing + DOM clear + Prism + Mermaid).
    4182 +     48 +- **Why:** Triggers on *every keystroke*. Typing fast will freeze the UI.
    4183 +     49 +- **Fix:** Wrap the handler in a `debounce` function (e.g., wait 300ms after last keystroke).
    4184 +     50 +
    4185 +     51 +---
    4186 +     52 +
    4187 +     53 +## ‚ö†Ô∏è Major Logic Flaws & Architecture
    4188 +     54 +
    4189 +     55 +### 5. üèóÔ∏è The "God Function": `setupEditor` (Lines 295-1372)
    4190 +     56 +**Critique:** This function is **1077 lines long**.
    4191 +     57 +- **Issue:** It contains state (`folderFiles`), event listeners, UI logic (`updatePDFPreview`), and utility helpers (`renderFileTree`).
    4192 +     58 +- **Impact:** It is effectively impossible to unit test. Scope pollution is rampant.
    4193 +     59 +- **Fix:** Break this file apart immediately.
    4194 +     60 +    - `setupEditor()` should only orchestrate.
    4195 +     61 +    - `setupPDFHandling()` should be its own module.
    4196 +     62 +    - `setupFolderBrowser()` should be its own module.
    4197 +     63 +
    4198 +     64 +### 6. üçù Spaghetti Events (Global Scope Pollution)
    4199 +     65 +```javascript
    4200 +     66 +let globalRenderMarkdown = null; // Line 24
    4201 +     67 +...
    4202 +     68 +globalRenderMarkdown = renderMarkdown; // Line 1367
    4203 +     69 +```
    4204 +     70 +**Critique:** You are leaking a local function to the global scope to hack around scope limitations for the theme manager callback.
    4205 +     71 +- **Fix:** Pass `renderMarkdown` as a dependency or use a proper `EventManager` (Pub/Sub pattern).
    4206 +     72 +
    4207 +     73 +### 7. üìÅ Hardcoded DOM Generation (Lines 1241-1334)
    4208 +     74 +**Critique:** The `renderFileTree` function essentially constructs a Virtual DOM manually using `document.createElement`.
    4209 +     75 +- **Issue:** This logic is mixed with the controller.
    4210 +     76 +- **Fix:** Move this to a `FileTreeView.js` class. The controller should just say `treeView.render(files)`.
1162 4211       77 +
1163     -     78 +    // Extract core theme colors for fallbacks
1164     -     79 +    const bgPri = getCssVariable('--bg-primary');
1165     -     80 +    const bgSec = getCssVariable('--bg-secondary');
1166     -     81 +    const bgTer = getCssVariable('--bg-tertiary');
1167     -     82 +    const txtPri = getCssVariable('--text-primary');
1168     -     83 +    const txtSec = getCssVariable('--text-secondary');
1169     -     84 +    const h1 = getCssVariable('--h1-color');
1170     -     85 +    const h2 = getCssVariable('--h2-color');
1171     -     86 +    const h3 = getCssVariable('--h3-color');
1172     -     87 +
1173     -     88 +    const isLight = isLightTheme(bgPri);
1174     -     89 +    const nodeBkg = isLight ? bgTer : bgSec;
1175     -     90 +    const clusterBkg = isLight ? bgSec : bgTer;
1176     - 38  91  
1177     - 39     -    // Configure Mermaid with theme colors
1178     - 40  92      if (typeof mermaid !== 'undefined') {
1179     - 41  93        mermaid.initialize({
1180     - 42  94          startOnLoad: MERMAID_CONFIG.START_ON_LOAD,
1181     - 43  95          theme: MERMAID_CONFIG.THEME,
1182     - 44  96          themeVariables: {
1183     - 45     -          primaryColor: bgSecondary,
1184     - 46     -          primaryTextColor: textPrimary,
1185     - 47     -          primaryBorderColor: h1Color,
1186     - 48     -          lineColor: h2Color,
1187     - 49     -          secondaryColor: bgSecondary,
1188     - 50     -          tertiaryColor: bgSecondary,
1189     - 51     -          background: bgSecondary,
1190     - 52     -          mainBkg: bgSecondary,
1191     - 53     -          secondBkg: bgSecondary,
1192     - 54     -          tertiaryBkg: bgSecondary,
1193     - 55     -          nodeBorder: h1Color,
1194     - 56     -          clusterBkg: bgSecondary,
1195     - 57     -          clusterBorder: h3Color,
1196     - 58     -          titleColor: textPrimary,
1197     - 59     -          edgeLabelBackground: bgSecondary,
1198     - 60     -          nodeTextColor: textPrimary,
1199     -     97 +          // Core Global
1200     -     98 +          background: get('--mermaid-background', bgPri),
1201     - 61  99            fontFamily: '-apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif',
1202     -    100 +          fontSize: '16px',
1203     -    101 +          darkMode: !isLight,
1204     -    102 +          textColor: get('--mermaid-text-color', txtPri),
1205     -    103 +          lineColor: get('--mermaid-line-color', h2),
1206     -    104 +          mainBkg: get('--mermaid-main-bkg', nodeBkg),
1207     -    105 +
1208     -    106 +          // Primary Set
1209     -    107 +          primaryColor: get('--mermaid-primary-color', nodeBkg),
1210     -    108 +          primaryTextColor: get('--mermaid-primary-text-color', txtPri),
1211     -    109 +          primaryBorderColor: get('--mermaid-primary-border-color', h1),
1212     -    110 +
1213     -    111 +          // Secondary Set
1214     -    112 +          secondaryColor: get('--mermaid-secondary-color', clusterBkg),
1215     -    113 +          secondaryTextColor: get('--mermaid-secondary-text-color', txtPri),
1216     -    114 +          secondaryBorderColor: get('--mermaid-secondary-border-color', h2),
1217     -    115 +
1218     -    116 +          // Tertiary Set
1219     -    117 +          tertiaryColor: get('--mermaid-tertiary-color', bgPri),
1220     -    118 +          tertiaryTextColor: get('--mermaid-tertiary-text-color', txtPri),
1221     -    119 +          tertiaryBorderColor: get('--mermaid-tertiary-border-color', h3),
1222     -    120 +
1223     -    121 +          // Flowchart
1224     -    122 +          nodeBorder: get('--mermaid-node-border', h1),
1225     -    123 +          clusterBkg: get('--mermaid-cluster-bkg', clusterBkg),
1226     -    124 +          clusterBorder: get('--mermaid-cluster-border', h2),
1227     -    125 +          defaultLinkColor: get('--mermaid-default-link-color', h2),
1228     -    126 +          titleColor: get('--mermaid-title-color', txtPri),
1229     -    127 +          edgeLabelBackground: get('--mermaid-edge-label-background', bgPri),
1230     -    128 +          nodeTextColor: get('--mermaid-node-text-color', txtPri),
1231     -    129 +
1232     -    130 +          // Sequence Diagram
1233     -    131 +          actorBkg: get('--mermaid-actor-bkg', nodeBkg),
1234     -    132 +          actorBorder: get('--mermaid-actor-border', h1),
1235     -    133 +          actorTextColor: get('--mermaid-actor-text-color', txtPri),
1236     -    134 +          actorLineColor: get('--mermaid-actor-line-color', h1),
1237     -    135 +          signalColor: get('--mermaid-signal-color', h2),
1238     -    136 +          signalTextColor: get('--mermaid-signal-text-color', txtPri),
1239     -    137 +          labelBoxBkgColor: get('--mermaid-label-box-bkg-color', nodeBkg),
1240     -    138 +          labelBoxBorderColor: get('--mermaid-label-box-border-color', h1),
1241     -    139 +          labelTextColor: get('--mermaid-label-text-color', txtPri),
1242     -    140 +          loopTextColor: get('--mermaid-loop-text-color', txtPri),
1243     -    141 +          activationBorderColor: get('--mermaid-activation-border-color', h2),
1244     -    142 +          activationBkgColor: get('--mermaid-activation-bkg-color', clusterBkg),
1245     -    143 +          sequenceNumberColor: get('--mermaid-sequence-number-color', txtPri),
1246     -    144 +
1247     -    145 +          // Pie Chart
1248     -    146 +          pie1: get('--mermaid-pie1', h1),
1249     -    147 +          pie2: get('--mermaid-pie2', h2),
1250     -    148 +          pie3: get('--mermaid-pie3', h3),
1251     -    149 +          pie4: get('--mermaid-pie4', txtSec),
1252     -    150 +          pie5: get('--mermaid-pie5', h1),
1253     -    151 +          pie6: get('--mermaid-pie6', h2),
1254     -    152 +          pie7: get('--mermaid-pie7', h3),
1255     -    153 +          pie8: get('--mermaid-pie8', txtSec),
1256     -    154 +          pie9: get('--mermaid-pie9', h1),
1257     -    155 +          pie10: get('--mermaid-pie10', h2),
1258     -    156 +          pie11: get('--mermaid-pie11', h3),
1259     -    157 +          pie12: get('--mermaid-pie12', txtSec),
1260     -    158 +          pieTitleTextSize: '25px',
1261     -    159 +          pieTitleTextColor: get('--mermaid-pie-title-text-color', txtPri),
1262     -    160 +          pieSectionTextSize: '17px',
1263     -    161 +          pieSectionTextColor: get('--mermaid-pie-section-text-color', bgPri),
1264     -    162 +          pieLegendTextSize: '17px',
1265     -    163 +          pieLegendTextColor: get('--mermaid-pie-legend-text-color', txtPri),
1266     -    164 +          pieStrokeColor: get('--mermaid-pie-stroke-color', h1),
1267     -    165 +          pieStrokeWidth: '2px',
1268     -    166 +          pieOuterStrokeWidth: '2px',
1269     -    167 +          pieOuterStrokeColor: get('--mermaid-pie-outer-stroke-color', h1),
1270     -    168 +          pieOpacity: '0.9',
1271     -    169 +
1272     -    170 +          // State Diagram
1273     -    171 +          labelColor: get('--mermaid-label-color', txtPri),
1274     -    172 +          altBackground: get('--mermaid-alt-background', clusterBkg),
1275     -    173 +
1276     -    174 +          // Class Diagram
1277     -    175 +          classText: get('--mermaid-class-text', txtPri),
1278     -    176 +
1279     -    177 +          // User Journey
1280     -    178 +          fillType0: get('--mermaid-fill-type0', h1),
1281     -    179 +          fillType1: get('--mermaid-fill-type1', h2),
1282     -    180 +          fillType2: get('--mermaid-fill-type2', h3),
1283     -    181 +          fillType3: get('--mermaid-fill-type3', txtSec),
1284     -    182 +          fillType4: get('--mermaid-fill-type4', h1),
1285     -    183 +          fillType5: get('--mermaid-fill-type5', h2),
1286     -    184 +          fillType6: get('--mermaid-fill-type6', h3),
1287     -    185 +          fillType7: get('--mermaid-fill-type7', txtSec),
1288     -    186 +
1289     -    187 +          // Gantt Chart
1290     -    188 +          sectionBkgColor: get('--mermaid-section-bkg-color', bgSec),
1291     -    189 +          altSectionBkgColor: get('--mermaid-alt-section-bkg-color', bgTer),
1292     -    190 +          sectionBkgColor2: get('--mermaid-section-bkg-color2', bgSec),
1293     -    191 +          taskTextColor: get('--mermaid-task-text-color', txtPri),
1294     -    192 +          taskTextLightColor: get('--mermaid-task-text-light-color', txtPri),
1295     -    193 +          taskTextOutsideColor: get('--mermaid-task-text-outside-color', txtPri),
1296     -    194 +          taskTextClickableColor: get('--mermaid-task-text-clickable-color', h1),
1297     -    195 +          activeTaskBkgColor: get('--mermaid-active-task-bkg-color', h1),
1298     -    196 +          activeTaskBorderColor: get('--mermaid-active-task-border-color', h1),
1299     -    197 +          doneTaskBkgColor: get('--mermaid-done-task-bkg-color', h3),
1300     -    198 +          doneTaskBorderColor: get('--mermaid-done-task-border-color', h3),
1301     -    199 +          critBorderColor: get('--mermaid-crit-border-color', h2),
1302     -    200 +          critBkgColor: get('--mermaid-crit-bkg-color', h2),
1303     -    201 +          todayLineColor: get('--mermaid-today-line-color', h2),
1304     -    202 +          gridColor: get('--mermaid-grid-color', bgTer),
1305     -    203 +          sectionTextColor: get('--mermaid-section-text-color', txtPri),
1306     -    204 +          taskBorderColor: get('--mermaid-task-border-color', h1),
1307     -    205 +
1308     -    206 +          // ER Diagram
1309     -    207 +          attributeBackgroundColorOdd: get('--mermaid-attribute-background-color-odd', bgSec),
1310     -    208 +          attributeBackgroundColorEven: get('--mermaid-attribute-background-color-even', bgPri),
1311     -    209 +          relationshipLabelBackground: get('--mermaid-relationship-label-background', bgPri),
1312     -    210 +          relationshipLabelColor: get('--mermaid-relationship-label-color', txtPri),
1313     -    211 +          entityBackground: get('--mermaid-entity-background', nodeBkg),
1314     -    212 +          entityBorderColor: get('--mermaid-entity-border-color', h1),
1315     -    213 +
1316     -    214 +          // Git Graph
1317     -    215 +          git0: get('--mermaid-git0', h1),
1318     -    216 +          git1: get('--mermaid-git1', h2),
1319     -    217 +          git2: get('--mermaid-git2', h3),
1320     -    218 +          git3: get('--mermaid-git3', txtSec),
1321     -    219 +          git4: get('--mermaid-git4', h1),
1322     -    220 +          git5: get('--mermaid-git5', h2),
1323     -    221 +          git6: get('--mermaid-git6', h3),
1324     -    222 +          git7: get('--mermaid-git7', txtSec),
1325     -    223 +          gitInv0: get('--mermaid-git-inv0', bgPri),
1326     -    224 +          gitBranchLabel0: get('--mermaid-git-branch-label0', txtPri),
1327     -    225 +          gitBranchLabel1: get('--mermaid-git-branch-label1', txtPri),
1328     -    226 +          gitBranchLabel2: get('--mermaid-git-branch-label2', txtPri),
1329     -    227 +          gitBranchLabel3: get('--mermaid-git-branch-label3', txtPri),
1330     -    228 +          gitBranchLabel4: get('--mermaid-git-branch-label4', txtPri),
1331     -    229 +          commitLabelColor: get('--mermaid-commit-label-color', txtPri),
1332     -    230 +          commitLabelBackground: get('--mermaid-commit-label-background', bgPri),
1333     -    231 +          tagLabelColor: get('--mermaid-tag-label-color', txtPri),
1334     -    232 +          tagLabelBackground: get('--mermaid-tag-label-background', nodeBkg),
1335     -    233 +          tagLabelBorder: get('--mermaid-tag-label-border', h1),
1336     - 62 234          },
1337     - 63 235        });
1338     - 64 236  
1339     - 65 237        this.initialized = true;
1340     -    238 +
1341     -    239 +      // Debug: Log sample of loaded variables
1342     -    240 +      console.log(`‚úÖ Mermaid initialized`);
1343     -    241 +      console.log(`  - Background: ${get('--mermaid-background', bgPri)}`);
1344     -    242 +      console.log(`  - Text: ${get('--mermaid-text-color', txtPri)}`);
1345     -    243 +      console.log(`  - Line: ${get('--mermaid-line-color', h2)}`);
1346     -    244 +      console.log(`  - Primary: ${get('--mermaid-primary-color', nodeBkg)}`);
1347     -    245 +      console.log(`  - Pie1: ${get('--mermaid-pie1', h1)}`);
1348     - 66 246      } else {
1349     - 67 247        console.warn('Mermaid library not loaded');
1350     - 68 248      }
1351     - 69 249  
1352     -
1353     -```
1354     -
1355     -
1356     -### üìÑ `style.css`
1357     -
1358     -**Type:** Stylesheet üé®
1359     -
1360     -```diff
1361     -@@ -297,68 +297,119 @@ body {
1362     -297 297    padding: 0;
1363     -298 298  }
1364     -299 299  
1365     -300     -/* Syntax Highlighting with Custom Variables - Comprehensive Token Coverage */
1366     -301     -#markdown-preview .token.keyword {
1367     -302     -  color: var(--syntax-keyword, #c792ea) !important;
1368     -    300 +/* ==================== PRISM SYNTAX HIGHLIGHTING - PRODUCTION GRADE ==================== */
1369     -    301 +/* Based on One Dark theme architecture - comprehensive token coverage */
1370     -    302 +
1371     -    303 +/* Group 1: Comments and documentation */
1372     -    304 +#markdown-preview .token.comment,
1373     -    305 +#markdown-preview .token.prolog,
1374     -    306 +#markdown-preview .token.cdata {
1375     -    307 +  color: var(--syntax-comment, #7f85a3);
1376     -    308 +  font-style: italic;
1377     -303 309  }
1378     -304 310  
1379     -305     -#markdown-preview .token.string {
1380     -306     -  color: var(--syntax-string, #a5e844) !important;
1381     -307     -}
1382     -308     -
1383     -309     -#markdown-preview .token.number,
1384     -310     -#markdown-preview .token.boolean {
1385     -311     -  color: var(--syntax-number, #ffcb6b) !important;
1386     -312     -}
1387     -313     -
1388     -314     -#markdown-preview .token.function,
1389     -315     -#markdown-preview .token.function-variable,
1390     -316     -#markdown-preview .token.method,
1391     -317     -#markdown-preview .token.method-variable {
1392     -318     -  color: var(--syntax-function, #82aaff) !important;
1393     -319     -  font-weight: 600;
1394     -320     -}
1395     -321     -
1396     -322     -#markdown-preview .token.comment {
1397     -323     -  color: var(--syntax-comment, #7f85a3) !important;
1398     -324     -}
1399     -325     -
1400     -326     -#markdown-preview .token.operator {
1401     -327     -  color: var(--syntax-operator, #89ddff) !important;
1402     -328     -}
1403     -329     -
1404     -330     -#markdown-preview .token.punctuation {
1405     -331     -  color: var(--syntax-punctuation, #89ddff) !important;
1406     -    311 +/* Group 2: Neutral tokens (inherit or subtle) */
1407     -    312 +#markdown-preview .token.doctype,
1408     -    313 +#markdown-preview .token.punctuation,
1409     -    314 +#markdown-preview .token.entity {
1410     -    315 +  color: var(--syntax-punctuation, #64748b);
1411     -332 316  }
1412     -333 317  
1413     -    318 +/* Group 3: Orange hue - Class names, constants, numbers, booleans, atrules */
1414     -    319 +#markdown-preview .token.attr-name,
1415     -334 320  #markdown-preview .token.class-name,
1416     -335     -#markdown-preview .token.type-class-name {
1417     -336     -  color: var(--syntax-keyword, #ffcb6b) !important;
1418     -    321 +#markdown-preview .token.boolean,
1419     -    322 +#markdown-preview .token.constant,
1420     -    323 +#markdown-preview .token.number,
1421     -    324 +#markdown-preview .token.atrule {
1422     -    325 +  color: var(--syntax-class-name, #f97316);
1423     -337 326    font-weight: 600;
1424     -338 327  }
1425     -339 328  
1426     -340     -/* Variables and Parameters - NEW */
1427     -341     -#markdown-preview .token.parameter,
1428     -342     -#markdown-preview .token.variable,
1429     -343     -#markdown-preview .token.plain {
1430     -344     -  color: var(--syntax-variable, var(--text-primary)) !important;
1431     -345     -  font-weight: 500;
1432     -    329 +/* Group 4: Purple hue - Keywords (distinct from class names!) */
1433     -    330 +#markdown-preview .token.keyword {
1434     -    331 +  color: var(--syntax-keyword, #a855f7);
1435     -    332 +  font-weight: 700;
1436     -346 333  }
1437     -347 334  
1438     -348     -/* Properties and Namespaces - NEW */
1439     -    335 +/* Group 5: Red hue - Properties, tags, symbols, deleted, important */
1440     -349 336  #markdown-preview .token.property,
1441     -350     -#markdown-preview .token.property-access {
1442     -351     -  color: var(--syntax-property, var(--syntax-function)) !important;
1443     -    337 +#markdown-preview .token.tag,
1444     -    338 +#markdown-preview .token.symbol,
1445     -    339 +#markdown-preview .token.deleted,
1446     -    340 +#markdown-preview .token.important {
1447     -    341 +  color: var(--syntax-property, #ef4444);
1448     -    342 +  font-weight: 600;
1449     -352 343  }
1450     -353 344  
1451     -    345 +/* Group 6: Green hue - Strings, chars, builtins, inserted, regex, selectors */
1452     -    346 +#markdown-preview .token.selector,
1453     -    347 +#markdown-preview .token.string,
1454     -    348 +#markdown-preview .token.char,
1455     -    349 +#markdown-preview .token.builtin,
1456     -    350 +#markdown-preview .token.inserted,
1457     -    351 +#markdown-preview .token.regex,
1458     -    352 +#markdown-preview .token.attr-value {
1459     -    353 +  color: var(--syntax-string, #10b981);
1460     -    354 +}
1461     -    355 +
1462     -    356 +/* Nested attr-value punctuation (quotes) */
1463     -    357 +#markdown-preview .token.attr-value > .token.punctuation {
1464     -    358 +  color: var(--syntax-string, #10b981);
1465     -    359 +}
1466     -    360 +
1467     -    361 +/* Group 7: Blue hue - Variables, operators, functions */
1468     -    362 +#markdown-preview .token.variable,
1469     -    363 +#markdown-preview .token.operator,
1470     -    364 +#markdown-preview .token.function {
1471     -    365 +  color: var(--syntax-function, #3b82f6);
1472     -    366 +  font-weight: 600;
1473     -    367 +}
1474     -    368 +
1475     -    369 +/* Group 8: Cyan hue - URLs */
1476     -    370 +#markdown-preview .token.url {
1477     -    371 +  color: var(--syntax-url, #14b8a6);
1478     -    372 +}
1479     -    373 +
1480     -    374 +/* ==================== LANGUAGE-SPECIFIC OVERRIDES ==================== */
1481     -    375 +
1482     -    376 +/* JavaScript overrides */
1483     -    377 +#markdown-preview .language-javascript .token.operator {
1484     -    378 +  color: var(--syntax-keyword, #a855f7);
1485     -    379 +}
1486     -    380 +
1487     -    381 +/* CSS overrides */
1488     -    382 +#markdown-preview .language-css .token.selector {
1489     -    383 +  color: var(--syntax-property, #ef4444);
1490     -    384 +}
1491     -    385 +
1492     -    386 +#markdown-preview .language-css .token.property {
1493     -    387 +  color: var(--text-primary);
1494     -    388 +}
1495     -    389 +
1496     -    390 +/* JSON overrides */
1497     -    391 +#markdown-preview .language-json .token.operator {
1498     -    392 +  color: var(--syntax-punctuation, #64748b);
1499     -    393 +}
1500     -    394 +
1501     -    395 +#markdown-preview .language-json .token.null.keyword {
1502     -    396 +  color: var(--syntax-number, #fb923c);
1503     -    397 +}
1504     -    398 +
1505     -    399 +/* ==================== VISUAL ENHANCEMENTS ==================== */
1506     -    400 +
1507     -    401 +/* Bold/italic styling */
1508     -    402 +#markdown-preview .token.bold {
1509     -    403 +  font-weight: bold;
1510     -    404 +}
1511     -    405 +
1512     -    406 +#markdown-preview .token.italic {
1513     -    407 +  font-style: italic;
1514     -    408 +}
1515     -    409 +
1516     -    410 +/* Namespace opacity */
1517     -354 411  #markdown-preview .token.namespace {
1518     -355     -  color: var(--syntax-namespace, var(--syntax-keyword)) !important;
1519     -356     -  font-weight: 500;
1520     -357     -}
1521     -358     -
1522     -359     -#markdown-preview .token.builtin {
1523     -360     -  color: var(--syntax-builtin, var(--syntax-function)) !important;
1524     -361     -  font-weight: 500;
1525     -    412 +  opacity: 0.8;
1526     -362 413  }
1527     -363 414  
1528     -364 415  #markdown-preview blockquote {
1529     -365 416  
1530     -
1531     -```
1532     -
1533     -
1534     -### üìÑ `themes/default-dark.css`
1535     -
1536     -**Type:** Stylesheet üé®
1537     -
1538     -```diff
1539     -@@ -26,24 +26,184 @@
1540     - 26  26    --code-block-bg: #0d1117;
1541     - 27  27    --code-border: #30363d;
1542     - 28  28  
1543     - 29     -  /* Syntax Highlighting */
1544     - 30     -  --syntax-keyword: #ff7b72;
1545     - 31     -  --syntax-string: #a5e844;
1546     - 32     -  --syntax-number: #79c0ff;
1547     - 33     -  --syntax-function: #d2a8ff;
1548     - 34     -  --syntax-comment: #8b949e;
1549     - 35     -  --syntax-operator: #ff7b72;
1550     - 36     -  --syntax-punctuation: #7d8590;
1551     -     29 +  /* Syntax Highlighting - Production-Grade Token Colors (One Dark Architecture) */
1552     - 37  30  
1553     - 38     -  /* Additional Token Types */
1554     - 39     -  --syntax-variable: #79c0ff; /* Variables - blue (distinct from text #e6edf3) */
1555     - 40     -  --syntax-property: #d2a8ff; /* Properties - purple */
1556     - 41     -  --syntax-namespace: #ff7b72; /* Namespaces - red */
1557     - 42     -  --syntax-builtin: #d2a8ff; /* Builtins - purple */
1558     -     31 +  /* Core hue-1: Cyan - URLs */
1559     -     32 +  --syntax-url: #56d4dd; /* Cyan for URLs */
1560     -     33 +
1561     -     34 +  /* Core hue-2: Blue - Functions, variables */
1562     -     35 +  --syntax-function: #d2a8ff; /* Purple for functions */
1563     -     36 +  --syntax-variable: #79c0ff; /* Bright blue for variables */
1564     -     37 +
1565     -     38 +  /* Core hue-3: Red - Keywords */
1566     -     39 +  --syntax-keyword: #ff7b72; /* Coral red for keywords (final, sealed, class) */
1567     -     40 +
1568     -     41 +  /* Core hue-4: Green - Strings, builtins */
1569     -     42 +  --syntax-string: #a5d6ff; /* Light blue-green for strings */
1570     -     43 +  --syntax-builtin: #7ee787; /* Vibrant green for builtins (String, List) */
1571     -     44 +  --syntax-char: #a5d6ff; /* Same as strings */
1572     -     45 +  --syntax-regex: #a5d6ff; /* Same as strings */
1573     -     46 +  --syntax-inserted: #7ee787; /* For diff */
1574     -     47 +
1575     -     48 +  /* Core hue-5: Orange - Properties, tags */
1576     -     49 +  --syntax-property: #ffa657; /* Orange for properties */
1577     -     50 +  --syntax-tag: #ff7b72; /* Coral for tags */
1578     -     51 +  --syntax-deleted: #ff7b72; /* For diff */
1579     -     52 +  --syntax-important: #ffa657; /* For !important */
1580     -     53 +
1581     -     54 +  /* Core hue-6: Yellow - Class names, constants, numbers */
1582     -     55 +  --syntax-class-name: #ffa657; /* Orange for class names (Rectangle, Shape) */
1583     -     56 +  --syntax-number: #79c0ff; /* Blue for numbers */
1584     -     57 +  --syntax-constant: #79c0ff; /* Blue for constants */
1585     -     58 +  --syntax-boolean: #79c0ff; /* Same as numbers */
1586     -     59 +  --syntax-atrule: #d2a8ff; /* Purple for CSS @ rules */
1587     -     60 +
1588     -     61 +  /* Neutral colors */
1589     -     62 +  --syntax-comment: #8b949e; /* Gray for comments */
1590     -     63 +  --syntax-punctuation: #7d8590; /* Muted gray for punctuation */
1591     -     64 +  --syntax-operator: #ff7b72; /* Coral for operators */
1592     -     65 +
1593     -     66 +  /* Markup specific */
1594     -     67 +  --syntax-attr-name: #ffa657; /* Orange like class-name */
1595     -     68 +  --syntax-attr-value: #a5d6ff; /* Light blue like strings */
1596     -     69 +  --syntax-namespace: #d2a8ff; /* Purple */
1597     -     70 +  --syntax-entity: #7d8590; /* Neutral */
1598     -     71 +  --syntax-selector: #ffa657; /* Orange like properties */
1599     - 43  72  
1600     - 44  73    --blockquote-border: #bc8cff;
1601     - 45  74    --blockquote-bg: #161b22;
1602     - 46  75  
1603     - 47  76    --table-header-bg: #21262d;
1604     - 48  77    --table-border: #30363d;
1605     -     78 +
1606     -     79 +  /* === MERMAID COMPREHENSIVE CONFIGURATION === */
1607     -     80 +
1608     -     81 +  /* Core Global */
1609     -     82 +  --mermaid-background: #0d1117;
1610     -     83 +  --mermaid-text-color: #e6edf3;
1611     -     84 +  --mermaid-line-color: #58a6ff;
1612     -     85 +  --mermaid-main-bkg: #1c2128;
1613     -     86 +
1614     -     87 +  /* Primary Set - Main nodes/boxes */
1615     -     88 +  --mermaid-primary-color: #1c2128;
1616     -     89 +  --mermaid-primary-text-color: #e6edf3;
1617     -     90 +  --mermaid-primary-border-color: #58a6ff;
1618     -     91 +
1619     -     92 +  /* Secondary Set - Clusters/subgraphs */
1620     -     93 +  --mermaid-secondary-color: #161b22;
1621     -     94 +  --mermaid-secondary-text-color: #e6edf3;
1622     -     95 +  --mermaid-secondary-border-color: #bc8cff;
1623     -     96 +
1624     -     97 +  /* Tertiary Set - Edge labels */
1625     -     98 +  --mermaid-tertiary-color: #0d1117;
1626     -     99 +  --mermaid-tertiary-text-color: #e6edf3;
1627     -    100 +  --mermaid-tertiary-border-color: #ff7b72;
1628     -    101 +
1629     -    102 +  /* Flowchart */
1630     -    103 +  --mermaid-node-border: #58a6ff;
1631     -    104 +  --mermaid-cluster-bkg: #161b22;
1632     -    105 +  --mermaid-cluster-border: #bc8cff;
1633     -    106 +  --mermaid-default-link-color: #58a6ff;
1634     -    107 +  --mermaid-title-color: #e6edf3;
1635     -    108 +  --mermaid-edge-label-background: #0d1117;
1636     -    109 +  --mermaid-node-text-color: #e6edf3;
1637     -    110 +
1638     -    111 +  /* Sequence Diagram */
1639     -    112 +  --mermaid-actor-bkg: #1c2128;
1640     -    113 +  --mermaid-actor-border: #58a6ff;
1641     -    114 +  --mermaid-actor-text-color: #e6edf3;
1642     -    115 +  --mermaid-actor-line-color: #58a6ff;
1643     -    116 +  --mermaid-signal-color: #bc8cff;
1644     -    117 +  --mermaid-signal-text-color: #e6edf3;
1645     -    118 +  --mermaid-label-box-bkg-color: #1c2128;
1646     -    119 +  --mermaid-label-box-border-color: #58a6ff;
1647     -    120 +  --mermaid-label-text-color: #e6edf3;
1648     -    121 +  --mermaid-loop-text-color: #e6edf3;
1649     -    122 +  --mermaid-activation-border-color: #bc8cff;
1650     -    123 +  --mermaid-activation-bkg-color: #161b22;
1651     -    124 +  --mermaid-sequence-number-color: #e6edf3;
1652     -    125 +
1653     -    126 +  /* Pie Chart - 12 distinct slice colors + text */
1654     -    127 +  --mermaid-pie1: #58a6ff;
1655     -    128 +  --mermaid-pie2: #bc8cff;
1656     -    129 +  --mermaid-pie3: #ff7b72;
1657     -    130 +  --mermaid-pie4: #3fb950;
1658     -    131 +  --mermaid-pie5: #ffa657;
1659     -    132 +  --mermaid-pie6: #d2a8ff;
1660     -    133 +  --mermaid-pie7: #56d4dd;
1661     -    134 +  --mermaid-pie8: #7ee787;
1662     -    135 +  --mermaid-pie9: #a5d6ff;
1663     -    136 +  --mermaid-pie10: #79c0ff;
1664     -    137 +  --mermaid-pie11: #d2a8ff;
1665     -    138 +  --mermaid-pie12: #ffa657;
1666     -    139 +  --mermaid-pie-title-text-color: #e6edf3;
1667     -    140 +  --mermaid-pie-section-text-color: #0d1117; /* Dark on vibrant slices */
1668     -    141 +  --mermaid-pie-legend-text-color: #e6edf3;
1669     -    142 +  --mermaid-pie-stroke-color: #58a6ff;
1670     -    143 +  --mermaid-pie-outer-stroke-color: #58a6ff;
1671     -    144 +
1672     -    145 +  /* State Diagram */
1673     -    146 +  --mermaid-label-color: #e6edf3;
1674     -    147 +  --mermaid-alt-background: #161b22;
1675     -    148 +
1676     -    149 +  /* Class Diagram */
1677     -    150 +  --mermaid-class-text: #e6edf3;
1678     -    151 +
1679     -    152 +  /* User Journey - 8 distinct colors */
1680     -    153 +  --mermaid-fill-type0: #58a6ff;
1681     -    154 +  --mermaid-fill-type1: #bc8cff;
1682     -    155 +  --mermaid-fill-type2: #ff7b72;
1683     -    156 +  --mermaid-fill-type3: #3fb950;
1684     -    157 +  --mermaid-fill-type4: #ffa657;
1685     -    158 +  --mermaid-fill-type5: #d2a8ff;
1686     -    159 +  --mermaid-fill-type6: #56d4dd;
1687     -    160 +  --mermaid-fill-type7: #7ee787;
1688     -    161 +
1689     -    162 +  /* Gantt Chart */
1690     -    163 +  --mermaid-section-bkg-color: #1c2128;
1691     -    164 +  --mermaid-alt-section-bkg-color: #161b22;
1692     -    165 +  --mermaid-section-bkg-color2: #1c2128;
1693     -    166 +  --mermaid-task-text-color: #e6edf3;
1694     -    167 +  --mermaid-task-text-light-color: #e6edf3;
1695     -    168 +  --mermaid-task-text-outside-color: #e6edf3;
1696     -    169 +  --mermaid-task-text-clickable-color: #58a6ff;
1697     -    170 +  --mermaid-active-task-bkg-color: #58a6ff;
1698     -    171 +  --mermaid-active-task-border-color: #58a6ff;
1699     -    172 +  --mermaid-done-task-bkg-color: #3fb950;
1700     -    173 +  --mermaid-done-task-border-color: #3fb950;
1701     -    174 +  --mermaid-crit-border-color: #ff7b72;
1702     -    175 +  --mermaid-crit-bkg-color: #ff7b72;
1703     -    176 +  --mermaid-today-line-color: #ff7b72;
1704     -    177 +  --mermaid-grid-color: #30363d;
1705     -    178 +  --mermaid-section-text-color: #e6edf3;
1706     -    179 +  --mermaid-task-border-color: #58a6ff;
1707     -    180 +
1708     -    181 +  /* ER Diagram */
1709     -    182 +  --mermaid-attribute-background-color-odd: #161b22;
1710     -    183 +  --mermaid-attribute-background-color-even: #0d1117;
1711     -    184 +  --mermaid-relationship-label-background: #0d1117;
1712     -    185 +  --mermaid-relationship-label-color: #e6edf3;
1713     -    186 +  --mermaid-entity-background: #1c2128;
1714     -    187 +  --mermaid-entity-border-color: #58a6ff;
1715     -    188 +
1716     -    189 +  /* Git Graph */
1717     -    190 +  --mermaid-git0: #58a6ff;
1718     -    191 +  --mermaid-git1: #bc8cff;
1719     -    192 +  --mermaid-git2: #ff7b72;
1720     -    193 +  --mermaid-git3: #3fb950;
1721     -    194 +  --mermaid-git4: #ffa657;
1722     -    195 +  --mermaid-git5: #d2a8ff;
1723     -    196 +  --mermaid-git6: #56d4dd;
1724     -    197 +  --mermaid-git7: #7ee787;
1725     -    198 +  --mermaid-git-inv0: #0d1117;
1726     -    199 +  --mermaid-git-branch-label0: #e6edf3;
1727     -    200 +  --mermaid-git-branch-label1: #e6edf3;
1728     -    201 +  --mermaid-git-branch-label2: #e6edf3;
1729     -    202 +  --mermaid-git-branch-label3: #e6edf3;
1730     -    203 +  --mermaid-git-branch-label4: #e6edf3;
1731     -    204 +  --mermaid-commit-label-color: #e6edf3;
1732     -    205 +  --mermaid-commit-label-background: #0d1117;
1733     -    206 +  --mermaid-tag-label-color: #e6edf3;
1734     -    207 +  --mermaid-tag-label-background: #1c2128;
1735     -    208 +  --mermaid-tag-label-border: #58a6ff;
1736     - 49 209  }
1737     - 50 210  
1738     -
1739     -```
1740     -
1741     -
1742     -### üìÑ `themes/default-light.css`
1743     -
1744     -**Type:** Stylesheet üé®
1745     -
1746     -```diff
1747     -@@ -26,24 +26,184 @@
1748     - 26  26    --code-block-bg: #f6f8fa;
1749     - 27  27    --code-border: #d0d7de;
1750     - 28  28  
1751     - 29     -  /* Syntax Highlighting - Comprehensive Token Colors */
1752     - 30     -  --syntax-keyword: #cf222e;
1753     - 31     -  --syntax-string: #1a7f37;
1754     - 32     -  --syntax-number: #0550ae;
1755     - 33     -  --syntax-function: #8250df;
1756     - 34     -  --syntax-comment: #636c76;
1757     - 35     -  --syntax-operator: #cf222e;
1758     - 36     -  --syntax-punctuation: #636c76;
1759     -     29 +  /* Syntax Highlighting - Production-Grade Token Colors (One Dark Architecture) */
1760     - 37  30  
1761     - 38     -  /* Additional Token Types for Full Customization */
1762     - 39     -  --syntax-variable: #0550ae; /* Variables, parameters */
1763     - 40     -  --syntax-property: #1a7f37; /* Properties, attributes */
1764     - 41     -  --syntax-namespace: #cf222e; /* Namespaces */
1765     - 42     -  --syntax-builtin: #8250df; /* Built-in functions */
1766     -     31 +  /* Core hue-1: Cyan - URLs */
1767     -     32 +  --syntax-url: #0969da; /* GitHub blue for URLs */
1768     -     33 +
1769     -     34 +  /* Core hue-2: Blue - Functions, variables */
1770     -     35 +  --syntax-function: #8250df; /* Purple-blue for functions */
1771     -     36 +  --syntax-variable: #0550ae; /* Deep blue for variables */
1772     -     37 +
1773     -     38 +  /* Core hue-3: Red - Keywords */
1774     -     39 +  --syntax-keyword: #cf222e; /* GitHub red for keywords (final, sealed, class) */
1775     -     40 +
1776     -     41 +  /* Core hue-4: Green - Strings, builtins */
1777     -     42 +  --syntax-string: #1a7f37; /* GitHub green for strings */
1778     -     43 +  --syntax-builtin: #116329; /* Darker green for builtins (String, List) */
1779     -     44 +  --syntax-char: #1a7f37; /* Same as strings */
1780     -     45 +  --syntax-regex: #1a7f37; /* Same as strings */
1781     -     46 +  --syntax-inserted: #1a7f37; /* For diff */
1782     -     47 +
1783     -     48 +  /* Core hue-5: Orange/Brown - Properties, tags */
1784     -     49 +  --syntax-property: #bc4c00; /* Orange-brown for properties */
1785     -     50 +  --syntax-tag: #cf222e; /* Red for tags */
1786     -     51 +  --syntax-deleted: #cf222e; /* For diff */
1787     -     52 +  --syntax-important: #bc4c00; /* For !important */
1788     -     53 +
1789     -     54 +  /* Core hue-6: Blue - Class names, constants, numbers */
1790     -     55 +  --syntax-class-name: #0969da; /* Bright blue for class names (Rectangle, Shape) */
1791     -     56 +  --syntax-number: #0550ae; /* Deep blue for numbers */
1792     -     57 +  --syntax-constant: #0969da; /* Bright blue for constants */
1793     -     58 +  --syntax-boolean: #0550ae; /* Same as numbers */
1794     -     59 +  --syntax-atrule: #8250df; /* Purple for CSS @ rules */
1795     -     60 +
1796     -     61 +  /* Neutral colors */
1797     -     62 +  --syntax-comment: #636c76; /* GitHub gray for comments */
1798     -     63 +  --syntax-punctuation: #636c76; /* Gray for punctuation */
1799     -     64 +  --syntax-operator: #cf222e; /* Red for operators */
1800     -     65 +
1801     -     66 +  /* Markup specific */
1802     -     67 +  --syntax-attr-name: #0969da; /* Blue like class-name */
1803     -     68 +  --syntax-attr-value: #1a7f37; /* Green like strings */
1804     -     69 +  --syntax-namespace: #8250df; /* Purple */
1805     -     70 +  --syntax-entity: #636c76; /* Neutral */
1806     -     71 +  --syntax-selector: #bc4c00; /* Orange like properties */
1807     - 43  72  
1808     - 44  73    --blockquote-border: #0969da;
1809     - 45  74    --blockquote-bg: #ddf4ff;
1810     - 46  75  
1811     - 47  76    --table-header-bg: #f6f8fa;
1812     - 48  77    --table-border: #d0d7de;
1813     -     78 +
1814     -     79 +  /* === MERMAID COMPREHENSIVE CONFIGURATION === */
1815     -     80 +
1816     -     81 +  /* Core Global */
1817     -     82 +  --mermaid-background: #ffffff;
1818     -     83 +  --mermaid-text-color: #1f2328;
1819     -     84 +  --mermaid-line-color: #0969da;
1820     -     85 +  --mermaid-main-bkg: #eaeef2;
1821     -     86 +
1822     -     87 +  /* Primary Set */
1823     -     88 +  --mermaid-primary-color: #eaeef2;
1824     -     89 +  --mermaid-primary-text-color: #1f2328;
1825     -     90 +  --mermaid-primary-border-color: #0969da;
1826     -     91 +
1827     -     92 +  /* Secondary Set */
1828     -     93 +  --mermaid-secondary-color: #f6f8fa;
1829     -     94 +  --mermaid-secondary-text-color: #1f2328;
1830     -     95 +  --mermaid-secondary-border-color: #8250df;
1831     -     96 +
1832     -     97 +  /* Tertiary Set */
1833     -     98 +  --mermaid-tertiary-color: #ffffff;
1834     -     99 +  --mermaid-tertiary-text-color: #1f2328;
1835     -    100 +  --mermaid-tertiary-border-color: #cf222e;
1836     -    101 +
1837     -    102 +  /* Flowchart */
1838     -    103 +  --mermaid-node-border: #0969da;
1839     -    104 +  --mermaid-cluster-bkg: #f6f8fa;
1840     -    105 +  --mermaid-cluster-border: #8250df;
1841     -    106 +  --mermaid-default-link-color: #0969da;
1842     -    107 +  --mermaid-title-color: #1f2328;
1843     -    108 +  --mermaid-edge-label-background: #ffffff;
1844     -    109 +  --mermaid-node-text-color: #1f2328;
1845     -    110 +
1846     -    111 +  /* Sequence Diagram */
1847     -    112 +  --mermaid-actor-bkg: #eaeef2;
1848     -    113 +  --mermaid-actor-border: #0969da;
1849     -    114 +  --mermaid-actor-text-color: #1f2328;
1850     -    115 +  --mermaid-actor-line-color: #0969da;
1851     -    116 +  --mermaid-signal-color: #8250df;
1852     -    117 +  --mermaid-signal-text-color: #1f2328;
1853     -    118 +  --mermaid-label-box-bkg-color: #eaeef2;
1854     -    119 +  --mermaid-label-box-border-color: #0969da;
1855     -    120 +  --mermaid-label-text-color: #1f2328;
1856     -    121 +  --mermaid-loop-text-color: #1f2328;
1857     -    122 +  --mermaid-activation-border-color: #8250df;
1858     -    123 +  --mermaid-activation-bkg-color: #f6f8fa;
1859     -    124 +  --mermaid-sequence-number-color: #1f2328;
1860     -    125 +
1861     -    126 +  /* Pie Chart */
1862     -    127 +  --mermaid-pie1: #0969da;
1863     -    128 +  --mermaid-pie2: #8250df;
1864     -    129 +  --mermaid-pie3: #cf222e;
1865     -    130 +  --mermaid-pie4: #1a7f37;
1866     -    131 +  --mermaid-pie5: #bc4c00;
1867     -    132 +  --mermaid-pie6: #0550ae;
1868     -    133 +  --mermaid-pie7: #116329;
1869     -    134 +  --mermaid-pie8: #0969da;
1870     -    135 +  --mermaid-pie9: #8250df;
1871     -    136 +  --mermaid-pie10: #cf222e;
1872     -    137 +  --mermaid-pie11: #1a7f37;
1873     -    138 +  --mermaid-pie12: #bc4c00;
1874     -    139 +  --mermaid-pie-title-text-color: #1f2328;
1875     -    140 +  --mermaid-pie-section-text-color: #ffffff; /* White on vibrant slices */
1876     -    141 +  --mermaid-pie-legend-text-color: #1f2328;
1877     -    142 +  --mermaid-pie-stroke-color: #0969da;
1878     -    143 +  --mermaid-pie-outer-stroke-color: #0969da;
1879     -    144 +
1880     -    145 +  /* State Diagram */
1881     -    146 +  --mermaid-label-color: #1f2328;
1882     -    147 +  --mermaid-alt-background: #f6f8fa;
1883     -    148 +
1884     -    149 +  /* Class Diagram */
1885     -    150 +  --mermaid-class-text: #1f2328;
1886     -    151 +
1887     -    152 +  /* User Journey */
1888     -    153 +  --mermaid-fill-type0: #0969da;
1889     -    154 +  --mermaid-fill-type1: #8250df;
1890     -    155 +  --mermaid-fill-type2: #cf222e;
1891     -    156 +  --mermaid-fill-type3: #1a7f37;
1892     -    157 +  --mermaid-fill-type4: #bc4c00;
1893     -    158 +  --mermaid-fill-type5: #0550ae;
1894     -    159 +  --mermaid-fill-type6: #116329;
1895     -    160 +  --mermaid-fill-type7: #0969da;
1896     -    161 +
1897     -    162 +  /* Gantt Chart */
1898     -    163 +  --mermaid-section-bkg-color: #eaeef2;
1899     -    164 +  --mermaid-alt-section-bkg-color: #f6f8fa;
1900     -    165 +  --mermaid-section-bkg-color2: #eaeef2;
1901     -    166 +  --mermaid-task-text-color: #1f2328;
1902     -    167 +  --mermaid-task-text-light-color: #1f2328;
1903     -    168 +  --mermaid-task-text-outside-color: #1f2328;
1904     -    169 +  --mermaid-task-text-clickable-color: #0969da;
1905     -    170 +  --mermaid-active-task-bkg-color: #0969da;
1906     -    171 +  --mermaid-active-task-border-color: #0969da;
1907     -    172 +  --mermaid-done-task-bkg-color: #1a7f37;
1908     -    173 +  --mermaid-done-task-border-color: #1a7f37;
1909     -    174 +  --mermaid-crit-border-color: #cf222e;
1910     -    175 +  --mermaid-crit-bkg-color: #cf222e;
1911     -    176 +  --mermaid-today-line-color: #cf222e;
1912     -    177 +  --mermaid-grid-color: #d0d7de;
1913     -    178 +  --mermaid-section-text-color: #1f2328;
1914     -    179 +  --mermaid-task-border-color: #0969da;
1915     -    180 +
1916     -    181 +  /* ER Diagram */
1917     -    182 +  --mermaid-attribute-background-color-odd: #f6f8fa;
1918     -    183 +  --mermaid-attribute-background-color-even: #ffffff;
1919     -    184 +  --mermaid-relationship-label-background: #ffffff;
1920     -    185 +  --mermaid-relationship-label-color: #1f2328;
1921     -    186 +  --mermaid-entity-background: #eaeef2;
1922     -    187 +  --mermaid-entity-border-color: #0969da;
1923     -    188 +
1924     -    189 +  /* Git Graph */
1925     -    190 +  --mermaid-git0: #0969da;
1926     -    191 +  --mermaid-git1: #8250df;
1927     -    192 +  --mermaid-git2: #cf222e;
1928     -    193 +  --mermaid-git3: #1a7f37;
1929     -    194 +  --mermaid-git4: #bc4c00;
1930     -    195 +  --mermaid-git5: #0550ae;
1931     -    196 +  --mermaid-git6: #116329;
1932     -    197 +  --mermaid-git7: #0969da;
1933     -    198 +  --mermaid-git-inv0: #ffffff;
1934     -    199 +  --mermaid-git-branch-label0: #1f2328;
1935     -    200 +  --mermaid-git-branch-label1: #1f2328;
1936     -    201 +  --mermaid-git-branch-label2: #1f2328;
1937     -    202 +  --mermaid-git-branch-label3: #1f2328;
1938     -    203 +  --mermaid-git-branch-label4: #1f2328;
1939     -    204 +  --mermaid-commit-label-color: #1f2328;
1940     -    205 +  --mermaid-commit-label-background: #ffffff;
1941     -    206 +  --mermaid-tag-label-color: #1f2328;
1942     -    207 +  --mermaid-tag-label-background: #eaeef2;
1943     -    208 +  --mermaid-tag-label-border: #0969da;
1944     - 49 209  }
1945     - 50 210  
1946     -
1947     -```
1948     -
1949     -
1950     -### üìÑ `themes/forest-dark.css`
1951     -
1952     -**Type:** Stylesheet üé®
1953     -
1954     -```diff
1955     -@@ -1,11 +1,11 @@
1956     -  1     -/* Forest Dark Theme */
1957     -      1 +/* Forest Dark Theme - Deep Jungle Aesthetic */
1958     -  2   2  :root {
1959     -  3     -  --bg-primary: #0f1c0a;
1960     -  4     -  --bg-secondary: #1a2817;
1961     -  5     -  --bg-tertiary: #2d4a2b;
1962     -  6     -  --text-primary: #d9f99d;
1963     -  7     -  --text-secondary: #a3e635;
1964     -  8     -  --border-color: #3f6212;
1965     -      3 +  --bg-primary: #0a1408; /* Deep forest green with blue undertones */
1966     -      4 +  --bg-secondary: #132118; /* Darker moss green */
1967     -      5 +  --bg-tertiary: #1e3a29; /* Rich forest green */
1968     -      6 +  --text-primary: #d9f99d; /* Bright lime (firefly glow) */
1969     -      7 +  --text-secondary: #a3e635; /* Vibrant lime */
1970     -      8 +  --border-color: #2d5a3d; /* Forest green border */
1971     -  9   9  
1972     - 10  10    --h1-color: #84cc16;
1973     - 11  11    --h2-color: #a3e635;
1974     -@@ -17,31 +17,144 @@
1975     - 17  17    --link-color: #84cc16;
1976     - 18  18    --link-hover: #a3e635;
1977     - 19  19  
1978     - 20     -  /* Code Colors */
1979     - 21     -  --code-bg: #1a2817;
1980     -     20 +  /* Code Colors - Organic forest glow */
1981     -     21 +  --code-bg: rgba(132, 204, 22, 0.12); /* Lime-tinted background */
1982     - 22  22    --code-text: #a3e635;
1983     - 23     -  --code-block-bg: #0f1c0a;
1984     - 24     -  --code-border: #3f6212;
1985     -     23 +  --code-block-bg: #0d1a11; /* Deep forest with blue-green tint */
1986     -     24 +  --code-border: rgba(163, 230, 53, 0.3); /* Lime glow border */
1987     - 25  25  
1988     - 26     -  /* Syntax Highlighting - Comprehensive Token Colors */
1989     - 27     -  --syntax-keyword: #84cc16;
1990     - 28     -  --syntax-string: #a3e635;
1991     - 29     -  --syntax-number: #bef264;
1992     - 30     -  --syntax-function: #4ade80;
1993     - 31     -  --syntax-comment: #737373;
1994     - 32     -  --syntax-operator: #22c55e;
1995     - 33     -  --syntax-punctuation: #a3a3a3;
1996     -     26 +  /* Syntax Highlighting - Production-Grade Token Colors (One Dark Architecture) */
1997     - 34  27  
1998     - 35     -  /* Additional Token Types */
1999     - 36     -  --syntax-variable: #bef264; /* Variables - bright lime (distinct from text #d9f99d) */
2000     - 37     -  --syntax-property: #4ade80; /* Properties - green */
2001     - 38     -  --syntax-namespace: #84cc16; /* Namespaces - lime */
2002     - 39     -  --syntax-builtin: #22c55e; /* Builtins - green */
2003     -     28 +  /* Core hue-1: Teal - URLs */
2004     -     29 +  --syntax-url: #5eead4; /* Bright teal for URLs */
2005     -     30 +
2006     -     31 +  /* Core hue-2: Green - Functions, variables */
2007     -     32 +  --syntax-function: #4ade80; /* Bright green for functions */
2008     -     33 +  --syntax-variable: #22c55e; /* Medium green for variables */
2009     -     34 +
2010     -     35 +  /* Core hue-3: Yellow - Keywords */
2011     -     36 +  --syntax-keyword: #fbbf24; /* Golden yellow for keywords (final, sealed, class) */
2012     -     37 +
2013     -     38 +  /* Core hue-4: Lime - Strings, builtins */
2014     -     39 +  --syntax-string: #a3e635; /* Bright lime for strings */
2015     -     40 +  --syntax-builtin: #84cc16; /* Lime for builtins (String, List) */
2016     -     41 +  --syntax-char: #a3e635; /* Same as strings */
2017     -     42 +  --syntax-regex: #a3e635; /* Same as strings */
2018     -     43 +  --syntax-inserted: #84cc16; /* For diff */
2019     -     44 +
2020     -     45 +  /* Core hue-5: Orange/Amber - Properties, tags */
2021     -     46 +  --syntax-property: #fb923c; /* Orange for properties */
2022     -     47 +  --syntax-tag: #f97316; /* Burnt orange for tags */
2023     -     48 +  --syntax-deleted: #f87171; /* Coral for diff */
2024     -     49 +  --syntax-important: #fb923c; /* Orange for !important */
2025     -     50 +
2026     -     51 +  /* Core hue-6: Yellow-green - Class names, constants, numbers */
2027     -     52 +  --syntax-class-name: #bef264; /* Bright yellow-green for class names (Rectangle, Shape) */
2028     -     53 +  --syntax-number: #fde047; /* Bright yellow for numbers */
2029     -     54 +  --syntax-constant: #84cc16; /* Lime for constants */
2030     -     55 +  --syntax-boolean: #fde047; /* Same as numbers */
2031     -     56 +  --syntax-atrule: #a3e635; /* Lime for CSS @ rules */
2032     -     57 +
2033     -     58 +  /* Neutral colors */
2034     -     59 +  --syntax-comment: #737373; /* Gray for comments */
2035     -     60 +  --syntax-punctuation: #a3a3a3; /* Light gray for punctuation */
2036     -     61 +  --syntax-operator: #22c55e; /* Green for operators */
2037     -     62 +
2038     -     63 +  /* Markup specific */
2039     -     64 +  --syntax-attr-name: #bef264; /* Yellow-green like class-name */
2040     -     65 +  --syntax-attr-value: #a3e635; /* Lime like strings */
2041     -     66 +  --syntax-namespace: #fbbf24; /* Yellow like keywords */
2042     -     67 +  --syntax-entity: #a3a3a3; /* Neutral */
2043     -     68 +  --syntax-selector: #fb923c; /* Orange like properties */
2044     - 40  69  
2045     - 41  70    --blockquote-border: #84cc16;
2046     - 42     -  --blockquote-bg: #1a2817;
2047     -     71 +  --blockquote-bg: rgba(132, 204, 22, 0.08); /* Lime-tinted blockquote */
2048     - 43  72    --bold-color: #fbbf24;
2049     - 44  73    --italic-color: #84cc16;
2050     - 45     -  --table-header-bg: #2d4a2b;
2051     - 46     -  --table-border: #3f6212;
2052     -     74 +  --table-header-bg: rgba(74, 222, 128, 0.12); /* Green-tinted table header */
2053     -     75 +  --table-border: rgba(45, 90, 61, 0.4); /* Forest-tinted border */
2054     -     76 +
2055     -     77 +  /* === MERMAID COMPREHENSIVE CONFIGURATION === */
2056     -     78 +  /* Complete control over ALL diagram elements */
    4212 +     78 +---
2057 4213       79 +
2058     -     80 +  /* Core Global */
2059     -     81 +  --mermaid-background: #0a1408;
2060     -     82 +  --mermaid-text-color: #d9f99d;
2061     -     83 +  --mermaid-line-color: #a3e635;
2062     -     84 +  --mermaid-main-bkg: #2d5a3d;
    4214 +     80 +## üîç Nitpicks & Code Style (Senior SDE Standards)
    4215 +     81 +
    4216 +     82 +### 8. üìù Hardcoded Content (Lines 297-381)
    4217 +     83 +**Critique:** The default "Welcome" markdown is 84 lines of hardcoded string inside a logic file.
    4218 +     84 +- **Fix:** Move to `src/js/config/defaultContent.js` or load from a file.
2063 4219       85 +
2064     -     86 +  /* Primary Set - Main nodes/boxes */
2065     -     87 +  --mermaid-primary-color: #2d5a3d;
2066     -     88 +  --mermaid-primary-text-color: #d9f99d;
2067     -     89 +  --mermaid-primary-border-color: #84cc16;
2068     -     90 +
2069     -     91 +  /* Secondary Set - Clusters/subgraphs */
2070     -     92 +  --mermaid-secondary-color: #1e3a29;
2071     -     93 +  --mermaid-secondary-text-color: #d9f99d;
2072     -     94 +  --mermaid-secondary-border-color: #a3e635;
2073     -     95 +
2074     -     96 +  /* Tertiary Set - Edge labels */
2075     -     97 +  --mermaid-tertiary-color: #0a1408;
2076     -     98 +  --mermaid-tertiary-text-color: #d9f99d;
2077     -     99 +  --mermaid-tertiary-border-color: #bef264;
2078     -    100 +
2079     -    101 +  /* Flowchart */
2080     -    102 +  --mermaid-node-border: #84cc16;
2081     -    103 +  --mermaid-cluster-bkg: #1e3a29;
2082     -    104 +  --mermaid-cluster-border: #a3e635;
2083     -    105 +  --mermaid-default-link-color: #a3e635;
2084     -    106 +  --mermaid-title-color: #d9f99d;
2085     -    107 +  --mermaid-edge-label-background: #0a1408;
2086     -    108 +  --mermaid-node-text-color: #d9f99d;
    4220 +     86 +### 9. üé® CSS Variable Extraction (Line 553)
    4221 +     87 +```javascript
    4222 +     88 +const currentValue = getComputedStyle(document.documentElement).getPropertyValue(varName).trim();
    4223 +     89 +```
    4224 +     90 +**Critique:** You are calling `getComputedStyle` inside a loop (`forEach` on Line 550).
    4225 +     91 +- **Impact:** This forces a **Style Recalculation** (Reflow) on every iteration. Expensive.
    4226 +     92 +- **Fix:** Cache `getComputedStyle` once outside the loop.
    4227 +     93 +
    4228 +     94 +### 10. ‚ùå Regex ReDoS Potential (Lines 111, 485)
    4229 +     95 +```javascript
    4230 +     96 +// Line 485
    4231 +     97 +html = html.replace(/<pre><code class="language-mermaid">([\s\S]*?)<\/code><\/pre>/g, ...
    4232 +     98 +```
    4233 +     99 +**Critique:** `[\s\S]*?` is generally safe-ish, but processing the entire HTML output with regex to find code blocks is fragile HTML parsing.
    4234 +    100 +- **Fix:** Marked.js has a `renderer` option. Override the `code` renderer instead of string-replacing the output HTML. This is much cleaner and safer.
    4235 +    101 +
    4236 +    102 +### 11. üß© Mixed 'var' and 'let' (Lines 884-885)
    4237 +    103 +```javascript
    4238 +    104 +var syncScrollEnabled = ...
    4239 +    105 +var syncScrolling = ...
    4240 +    106 +```
    4241 +    107 +**Critique:** Why `var`? You used `const/let` everywhere else.
    4242 +    108 +- **Fix:** Be consistent. Use `let`.
2087 4243      109 +
2088     -    110 +  /* Sequence Diagram */
2089     -    111 +  --mermaid-actor-bkg: #2d5a3d;
2090     -    112 +  --mermaid-actor-border: #84cc16;
2091     -    113 +  --mermaid-actor-text-color: #d9f99d;
2092     -    114 +  --mermaid-actor-line-color: #84cc16;
2093     -    115 +  --mermaid-signal-color: #a3e635;
2094     -    116 +  --mermaid-signal-text-color: #d9f99d;
2095     -    117 +  --mermaid-label-box-bkg-color: #2d5a3d;
2096     -    118 +  --mermaid-label-box-border-color: #84cc16;
2097     -    119 +  --mermaid-label-text-color: #d9f99d;
2098     -    120 +  --mermaid-loop-text-color: #d9f99d;
2099     -    121 +  --mermaid-activation-border-color: #a3e635;
2100     -    122 +  --mermaid-activation-bkg-color: #1e3a29;
2101     -    123 +  --mermaid-sequence-number-color: #d9f99d;
2102     -    124 +
2103     -    125 +  /* Pie Chart - 12 distinct slice colors + text colors */
2104     -    126 +  --mermaid-pie1: #4ade80;
2105     -    127 +  --mermaid-pie2: #fbbf24;
2106     -    128 +  --mermaid-pie3: #fb923c;
2107     -    129 +  --mermaid-pie4: #5eead4;
2108     -    130 +  --mermaid-pie5: #a3e635;
2109     -    131 +  --mermaid-pie6: #22c55e;
2110     -    132 +  --mermaid-pie7: #84cc16;
2111     -    133 +  --mermaid-pie8: #fde047;
2112     -    134 +  --mermaid-pie9: #4ade80;
2113     -    135 +  --mermaid-pie10: #fbbf24;
2114     -    136 +  --mermaid-pie11: #fb923c;
2115     -    137 +  --mermaid-pie12: #5eead4;
2116     -    138 +  --mermaid-pie-title-text-color: #d9f99d;
2117     -    139 +  --mermaid-pie-section-text-color: #0a1408; /* Dark on vibrant slices */
2118     -    140 +  --mermaid-pie-legend-text-color: #d9f99d;
2119     -    141 +  --mermaid-pie-stroke-color: #84cc16;
2120     -    142 +  --mermaid-pie-outer-stroke-color: #84cc16;
2121     -    143 +
2122     -    144 +  /* State Diagram */
2123     -    145 +  --mermaid-label-color: #d9f99d;
2124     -    146 +  --mermaid-alt-background: #1e3a29;
2125     -    147 +
2126     -    148 +  /* Class Diagram */
2127     -    149 +  --mermaid-class-text: #d9f99d;
2128     -    150 +
2129     -    151 +  /* User Journey - 8 distinct colors */
2130     -    152 +  --mermaid-fill-type0: #4ade80;
2131     -    153 +  --mermaid-fill-type1: #fbbf24;
2132     -    154 +  --mermaid-fill-type2: #fb923c;
2133     -    155 +  --mermaid-fill-type3: #5eead4;
2134     -    156 +  --mermaid-fill-type4: #a3e635;
2135     -    157 +  --mermaid-fill-type5: #22c55e;
2136     -    158 +  --mermaid-fill-type6: #84cc16;
2137     -    159 +  --mermaid-fill-type7: #fde047;
2138     - 47 160  }
2139     - 48 161  
2140     -
2141     -```
2142     -
2143     -
2144     -### üìÑ `themes/forest-light.css`
2145     -
2146     -**Type:** Stylesheet üé®
2147     -
2148     -```diff
2149     -@@ -23,20 +23,49 @@
2150     - 23  23    --code-block-bg: #ecfccb; /* Light green background */
2151     - 24  24    --code-border: #bef264;
2152     - 25  25  
2153     - 26     -  /* Syntax Highlighting - Comprehensive Token Colors */
2154     - 27     -  --syntax-keyword: #15803d;
2155     - 28     -  --syntax-string: #16a34a;
2156     - 29     -  --syntax-number: #84cc16;
2157     - 30     -  --syntax-function: #22c55e;
2158     - 31     -  --syntax-comment: #737373;
2159     - 32     -  --syntax-operator: #3f6212;
2160     - 33     -  --syntax-punctuation: #525252;
2161     -     26 +  /* Syntax Highlighting - Production-Grade Token Colors (One Dark Architecture) */
2162     - 34  27  
2163     - 35     -  /* Additional Token Types for Full Customization */
2164     - 36     -  --syntax-variable: #15803d; /* Variables - forest green */
2165     - 37     -  --syntax-property: #16a34a; /* Properties - bright green */
2166     - 38     -  --syntax-namespace: #84cc16; /* Namespaces - lime */
2167     - 39     -  --syntax-builtin: #22c55e; /* Builtins - bright green */
2168     -     28 +  /* Core hue-1: Teal - URLs */
2169     -     29 +  --syntax-url: #14b8a6; /* Teal for URLs */
2170     -     30 +
2171     -     31 +  /* Core hue-2: Green - Functions, variables */
2172     -     32 +  --syntax-function: #22c55e; /* Bright green for functions */
2173     -     33 +  --syntax-variable: #16a34a; /* Forest green for variables */
2174     -     34 +
2175     -     35 +  /* Core hue-3: Emerald - Keywords */
2176     -     36 +  --syntax-keyword: #059669; /* Deep emerald for keywords (final, sealed, class) */
2177     -     37 +
2178     -     38 +  /* Core hue-4: Lime - Strings, builtins */
2179     -     39 +  --syntax-string: #84cc16; /* Lime green for strings */
2180     -     40 +  --syntax-builtin: #65a30d; /* Vibrant lime for builtins (String, List) */
2181     -     41 +  --syntax-char: #84cc16; /* Same as strings */
2182     -     42 +  --syntax-regex: #84cc16; /* Same as strings */
2183     -     43 +  --syntax-inserted: #65a30d; /* For diff */
2184     -     44 +
2185     -     45 +  /* Core hue-5: Amber/Brown - Properties, tags */
2186     -     46 +  --syntax-property: #b45309; /* Amber-brown for properties */
2187     -     47 +  --syntax-tag: #854d0e; /* Brown for tags */
2188     -     48 +  --syntax-deleted: #dc2626; /* Red for diff */
2189     -     49 +  --syntax-important: #b45309; /* Amber for !important */
2190     -     50 +
2191     -     51 +  /* Core hue-6: Yellow/Green - Class names, constants, numbers */
2192     -     52 +  --syntax-class-name: #facc15; /* Bright yellow for class names (Rectangle, Shape) */
2193     -     53 +  --syntax-number: #eab308; /* Yellow for numbers */
2194     -     54 +  --syntax-constant: #15803d; /* Forest green for constants */
2195     -     55 +  --syntax-boolean: #eab308; /* Same as numbers */
2196     -     56 +  --syntax-atrule: #84cc16; /* Lime for CSS @ rules */
2197     -     57 +
2198     -     58 +  /* Neutral colors */
2199     -     59 +  --syntax-comment: #737373; /* Gray for comments */
2200     -     60 +  --syntax-punctuation: #525252; /* Dark gray for punctuation */
2201     -     61 +  --syntax-operator: #3f6212; /* Olive for operators */
2202     -     62 +
2203     -     63 +  /* Markup specific */
2204     -     64 +  --syntax-attr-name: #facc15; /* Yellow like class-name */
2205     -     65 +  --syntax-attr-value: #84cc16; /* Lime like strings */
2206     -     66 +  --syntax-namespace: #059669; /* Emerald like keywords */
2207     -     67 +  --syntax-entity: #525252; /* Neutral */
2208     -     68 +  --syntax-selector: #b45309; /* Amber like properties */
2209     - 40  69  
2210     - 41  70    --blockquote-border: #16a34a;
2211     - 42  71    --blockquote-bg: #ecfccb;
2212     -@@ -44,4 +73,87 @@
2213     - 44  73    --italic-color: #15803d;
2214     - 45  74    --table-header-bg: #d9f99d;
2215     - 46  75    --table-border: #bef264;
2216     -     76 +
2217     -     77 +  /* === MERMAID COMPREHENSIVE CONFIGURATION === */
2218     -     78 +
2219     -     79 +  /* Core Global */
2220     -     80 +  --mermaid-background: #f7fee7;
2221     -     81 +  --mermaid-text-color: #1a2e05;
2222     -     82 +  --mermaid-line-color: #16a34a;
2223     -     83 +  --mermaid-main-bkg: #d9f99d;
2224     -     84 +
2225     -     85 +  /* Primary Set */
2226     -     86 +  --mermaid-primary-color: #d9f99d;
2227     -     87 +  --mermaid-primary-text-color: #1a2e05;
2228     -     88 +  --mermaid-primary-border-color: #15803d;
2229     -     89 +
2230     -     90 +  /* Secondary Set */
2231     -     91 +  --mermaid-secondary-color: #ecfccb;
2232     -     92 +  --mermaid-secondary-text-color: #1a2e05;
2233     -     93 +  --mermaid-secondary-border-color: #16a34a;
2234     -     94 +
2235     -     95 +  /* Tertiary Set */
2236     -     96 +  --mermaid-tertiary-color: #f7fee7;
2237     -     97 +  --mermaid-tertiary-text-color: #1a2e05;
2238     -     98 +  --mermaid-tertiary-border-color: #22c55e;
2239     -     99 +
2240     -    100 +  /* Flowchart */
2241     -    101 +  --mermaid-node-border: #15803d;
2242     -    102 +  --mermaid-cluster-bkg: #ecfccb;
2243     -    103 +  --mermaid-cluster-border: #16a34a;
2244     -    104 +  --mermaid-default-link-color: #16a34a;
2245     -    105 +  --mermaid-title-color: #1a2e05;
2246     -    106 +  --mermaid-edge-label-background: #f7fee7;
2247     -    107 +  --mermaid-node-text-color: #1a2e05;
2248     -    108 +
2249     -    109 +  /* Sequence Diagram */
2250     -    110 +  --mermaid-actor-bkg: #d9f99d;
2251     -    111 +  --mermaid-actor-border: #15803d;
2252     -    112 +  --mermaid-actor-text-color: #1a2e05;
2253     -    113 +  --mermaid-actor-line-color: #15803d;
2254     -    114 +  --mermaid-signal-color: #16a34a;
2255     -    115 +  --mermaid-signal-text-color: #1a2e05;
2256     -    116 +  --mermaid-label-box-bkg-color: #d9f99d;
2257     -    117 +  --mermaid-label-box-border-color: #15803d;
2258     -    118 +  --mermaid-label-text-color: #1a2e05;
2259     -    119 +  --mermaid-loop-text-color: #1a2e05;
2260     -    120 +  --mermaid-activation-border-color: #16a34a;
2261     -    121 +  --mermaid-activation-bkg-color: #ecfccb;
2262     -    122 +  --mermaid-sequence-number-color: #1a2e05;
2263     -    123 +
2264     -    124 +  /* Pie Chart */
2265     -    125 +  --mermaid-pie1: #15803d;
2266     -    126 +  --mermaid-pie2: #16a34a;
2267     -    127 +  --mermaid-pie3: #22c55e;
2268     -    128 +  --mermaid-pie4: #4ade80;
2269     -    129 +  --mermaid-pie5: #84cc16;
2270     -    130 +  --mermaid-pie6: #a3e635;
2271     -    131 +  --mermaid-pie7: #14b8a6;
2272     -    132 +  --mermaid-pie8: #facc15;
2273     -    133 +  --mermaid-pie9: #b45309;
2274     -    134 +  --mermaid-pie10: #15803d;
2275     -    135 +  --mermaid-pie11: #16a34a;
2276     -    136 +  --mermaid-pie12: #22c55e;
2277     -    137 +  --mermaid-pie-title-text-color: #1a2e05;
2278     -    138 +  --mermaid-pie-section-text-color: #f7fee7; /* Light on vibrant slices */
2279     -    139 +  --mermaid-pie-legend-text-color: #1a2e05;
2280     -    140 +  --mermaid-pie-stroke-color: #15803d;
2281     -    141 +  --mermaid-pie-outer-stroke-color: #15803d;
2282     -    142 +
2283     -    143 +  /* State Diagram */
2284     -    144 +  --mermaid-label-color: #1a2e05;
2285     -    145 +  --mermaid-alt-background: #ecfccb;
2286     -    146 +
2287     -    147 +  /* Class Diagram */
2288     -    148 +  --mermaid-class-text: #1a2e05;
2289     -    149 +
2290     -    150 +  /* User Journey */
2291     -    151 +  --mermaid-fill-type0: #15803d;
2292     -    152 +  --mermaid-fill-type1: #16a34a;
2293     -    153 +  --mermaid-fill-type2: #22c55e;
2294     -    154 +  --mermaid-fill-type3: #4ade80;
2295     -    155 +  --mermaid-fill-type4: #84cc16;
2296     -    156 +  --mermaid-fill-type5: #a3e635;
2297     -    157 +  --mermaid-fill-type6: #14b8a6;
2298     -    158 +  --mermaid-fill-type7: #facc15;
2299     - 47 159  }
2300     - 48 160  
2301     -
2302     -```
2303     -
2304     -
2305     -### üìÑ `themes/neon-dark.css`
2306     -
2307     -**Type:** Stylesheet üé®
2308     -
2309     -```diff
2310     -@@ -1,11 +1,11 @@
2311     -  1     -/* Neon Dark Theme */
2312     -      1 +/* Neon Dark Theme - Cyberpunk Aesthetic */
2313     -  2   2  :root {
2314     -  3     -  --bg-primary: #0d0d0d;
2315     -  4     -  --bg-secondary: #1a1a1a;
2316     -  5     -  --bg-tertiary: #262626;
2317     -  6     -  --text-primary: #ffffff;
2318     -  7     -  --text-secondary: #a3a3a3;
2319     -  8     -  --border-color: #404040;
2320     -      3 +  --bg-primary: #0a0e1a; /* Dark blue-purple, not pure black */
2321     -      4 +  --bg-secondary: #141827; /* Dark navy with purple tint */
2322     -      5 +  --bg-tertiary: #1e2539; /* Lighter navy */
2323     -      6 +  --text-primary: #e0e7ff; /* Slightly blue-tinted white */
2324     -      7 +  --text-secondary: #a5b4fc; /* Light indigo */
2325     -      8 +  --border-color: #4c1d95; /* Purple border for neon feel */
2326     -  9   9  
2327     - 10  10    --h1-color: #ff006e;
2328     - 11  11    --h2-color: #8338ec;
2329     -@@ -17,31 +17,143 @@
2330     - 17  17    --link-color: #ff006e;
2331     - 18  18    --link-hover: #ff1a8c;
2332     - 19  19  
2333     - 20     -  /* Code Colors */
2334     - 21     -  --code-bg: #1a1a1a;
2335     -     20 +  /* Code Colors - Neonic with purple glow */
2336     -     21 +  --code-bg: rgba(131, 56, 236, 0.15); /* Purple-tinted background */
2337     - 22  22    --code-text: #00f5d4;
2338     - 23     -  --code-block-bg: #0d0d0d;
2339     - 24     -  --code-border: #404040;
2340     -     23 +  --code-block-bg: #0f1419; /* Dark blue-black with hint of purple */
2341     -     24 +  --code-border: rgba(255, 0, 110, 0.3); /* Pink glow border */
2342     - 25  25  
2343     - 26     -  /* Syntax Highlighting - Comprehensive Token Colors */
2344     - 27     -  --syntax-keyword: #ff006e;
2345     - 28     -  --syntax-string: #00f5d4;
2346     - 29     -  --syntax-number: #ffbe0b;
2347     - 30     -  --syntax-function: #8338ec;
2348     - 31     -  --syntax-comment: #737373;
2349     - 32     -  --syntax-operator: #ff1a8c;
2350     - 33     -  --syntax-punctuation: #a3a3a3;
2351     -     26 +  /* Syntax Highlighting - Production-Grade Token Colors (One Dark Architecture) */
2352     - 34  27  
2353     - 35     -  /* Additional Token Types */
2354     - 36     -  --syntax-variable: #3a86ff; /* Variables - bright blue (distinct from text #ffffff) */
2355     - 37     -  --syntax-property: #8338ec; /* Properties - purple */
2356     - 38     -  --syntax-namespace: #ff006e; /* Namespaces - neon pink */
2357     - 39     -  --syntax-builtin: #00f5d4; /* Builtins - cyan */
2358     -     28 +  /* Core hue-1: Cyan - URLs */
2359     -     29 +  --syntax-url: #00f5d4; /* Electric cyan for URLs */
2360     -     30 +
2361     -     31 +  /* Core hue-2: Purple/Blue - Functions, variables */
2362     -     32 +  --syntax-function: #8338ec; /* Neon purple for functions */
2363     -     33 +  --syntax-variable: #3a86ff; /* Electric blue for variables */
2364     -     34 +
2365     -     35 +  /* Core hue-3: Pink - Keywords */
2366     -     36 +  --syntax-keyword: #ff006e; /* Hot pink for keywords (final, sealed, class) */
2367     -     37 +
2368     -     38 +  /* Core hue-4: Cyan/Teal - Strings, builtins */
2369     -     39 +  --syntax-string: #00f5d4; /* Electric cyan for strings */
2370     -     40 +  --syntax-builtin: #00d4aa; /* Bright teal for builtins (String, List) */
2371     -     41 +  --syntax-char: #00f5d4; /* Same as strings */
2372     -     42 +  --syntax-regex: #00f5d4; /* Same as strings */
2373     -     43 +  --syntax-inserted: #00d4aa; /* For diff */
2374     -     44 +
2375     -     45 +  /* Core hue-5: Orange/Red - Properties, tags */
2376     -     46 +  --syntax-property: #fb5607; /* Neon orange for properties */
2377     -     47 +  --syntax-tag: #ff006e; /* Hot pink for tags */
2378     -     48 +  --syntax-deleted: #ff006e; /* Pink for diff */
2379     -     49 +  --syntax-important: #fb5607; /* Orange for !important */
2380     -     50 +
2381     -     51 +  /* Core hue-6: Yellow/Purple - Class names, constants, numbers */
2382     -     52 +  --syntax-class-name: #ffbe0b; /* Electric yellow for class names (Rectangle, Shape) */
2383     -     53 +  --syntax-number: #ffbe0b; /* Yellow for numbers */
2384     -     54 +  --syntax-constant: #fb5607; /* Orange for constants */
2385     -     55 +  --syntax-boolean: #ffbe0b; /* Same as numbers */
2386     -     56 +  --syntax-atrule: #8338ec; /* Purple for CSS @ rules */
2387     -     57 +
2388     -     58 +  /* Neutral colors */
2389     -     59 +  --syntax-comment: #737373; /* Gray for comments */
2390     -     60 +  --syntax-punctuation: #a3a3a3; /* Light gray for punctuation */
2391     -     61 +  --syntax-operator: #ff1a8c; /* Pink for operators */
2392     -     62 +
2393     -     63 +  /* Markup specific */
2394     -     64 +  --syntax-attr-name: #ffbe0b; /* Yellow like class-name */
2395     -     65 +  --syntax-attr-value: #00f5d4; /* Cyan like strings */
2396     -     66 +  --syntax-namespace: #8338ec; /* Purple */
2397     -     67 +  --syntax-entity: #a3a3a3; /* Neutral */
2398     -     68 +  --syntax-selector: #fb5607; /* Orange like properties */
2399     - 40  69  
2400     - 41  70    --blockquote-border: #8338ec;
2401     - 42     -  --blockquote-bg: #1a1a1a;
2402     -     71 +  --blockquote-bg: rgba(131, 56, 236, 0.1); /* Purple-tinted blockquote */
2403     - 43  72    --bold-color: #ffbe0b;
2404     - 44  73    --italic-color: #ff006e;
2405     - 45     -  --table-header-bg: #262626;
2406     - 46     -  --table-border: #404040;
2407     -     74 +  --table-header-bg: rgba(58, 134, 255, 0.15); /* Blue-tinted table header */
2408     -     75 +  --table-border: rgba(76, 29, 149, 0.3); /* Purple-tinted border */
2409     -     76 +
2410     -     77 +  /* === MERMAID COMPREHENSIVE CONFIGURATION === */
2411     -     78 +
2412     -     79 +  /* Core Global */
2413     -     80 +  --mermaid-background: #0a0e1a;
2414     -     81 +  --mermaid-text-color: #e0e7ff;
2415     -     82 +  --mermaid-line-color: #3a86ff;
2416     -     83 +  --mermaid-main-bkg: #1e2539;
2417     -     84 +
2418     -     85 +  /* Primary Set */
2419     -     86 +  --mermaid-primary-color: #1e2539;
2420     -     87 +  --mermaid-primary-text-color: #e0e7ff;
2421     -     88 +  --mermaid-primary-border-color: #8338ec;
2422     -     89 +
2423     -     90 +  /* Secondary Set */
2424     -     91 +  --mermaid-secondary-color: #141827;
2425     -     92 +  --mermaid-secondary-text-color: #e0e7ff;
2426     -     93 +  --mermaid-secondary-border-color: #3a86ff;
2427     -     94 +
2428     -     95 +  /* Tertiary Set */
2429     -     96 +  --mermaid-tertiary-color: #0a0e1a;
2430     -     97 +  --mermaid-tertiary-text-color: #e0e7ff;
2431     -     98 +  --mermaid-tertiary-border-color: #ff006e;
2432     -     99 +
2433     -    100 +  /* Flowchart */
2434     -    101 +  --mermaid-node-border: #8338ec;
2435     -    102 +  --mermaid-cluster-bkg: #141827;
2436     -    103 +  --mermaid-cluster-border: #3a86ff;
2437     -    104 +  --mermaid-default-link-color: #3a86ff;
2438     -    105 +  --mermaid-title-color: #e0e7ff;
2439     -    106 +  --mermaid-edge-label-background: #0a0e1a;
2440     -    107 +  --mermaid-node-text-color: #e0e7ff;
2441     -    108 +
2442     -    109 +  /* Sequence Diagram */
2443     -    110 +  --mermaid-actor-bkg: #1e2539;
2444     -    111 +  --mermaid-actor-border: #8338ec;
2445     -    112 +  --mermaid-actor-text-color: #e0e7ff;
2446     -    113 +  --mermaid-actor-line-color: #8338ec;
2447     -    114 +  --mermaid-signal-color: #3a86ff;
2448     -    115 +  --mermaid-signal-text-color: #e0e7ff;
2449     -    116 +  --mermaid-label-box-bkg-color: #1e2539;
2450     -    117 +  --mermaid-label-box-border-color: #8338ec;
2451     -    118 +  --mermaid-label-text-color: #e0e7ff;
2452     -    119 +  --mermaid-loop-text-color: #e0e7ff;
2453     -    120 +  --mermaid-activation-border-color: #3a86ff;
2454     -    121 +  --mermaid-activation-bkg-color: #141827;
2455     -    122 +  --mermaid-sequence-number-color: #e0e7ff;
2456     -    123 +
2457     -    124 +  /* Pie Chart */
2458     -    125 +  --mermaid-pie1: #ff006e;
2459     -    126 +  --mermaid-pie2: #8338ec;
2460     -    127 +  --mermaid-pie3: #3a86ff;
2461     -    128 +  --mermaid-pie4: #00f5d4;
2462     -    129 +  --mermaid-pie5: #ffbe0b;
2463     -    130 +  --mermaid-pie6: #fb5607;
2464     -    131 +  --mermaid-pie7: #ff1a8c;
2465     -    132 +  --mermaid-pie8: #00d4aa;
2466     -    133 +  --mermaid-pie9: #a5b4fc;
2467     -    134 +  --mermaid-pie10: #ff006e;
2468     -    135 +  --mermaid-pie11: #8338ec;
2469     -    136 +  --mermaid-pie12: #3a86ff;
2470     -    137 +  --mermaid-pie-title-text-color: #e0e7ff;
2471     -    138 +  --mermaid-pie-section-text-color: #0a0e1a; /* Dark on vibrant slices */
2472     -    139 +  --mermaid-pie-legend-text-color: #e0e7ff;
2473     -    140 +  --mermaid-pie-stroke-color: #8338ec;
2474     -    141 +  --mermaid-pie-outer-stroke-color: #8338ec;
2475     -    142 +
2476     -    143 +  /* State Diagram */
2477     -    144 +  --mermaid-label-color: #e0e7ff;
2478     -    145 +  --mermaid-alt-background: #141827;
2479     -    146 +
2480     -    147 +  /* Class Diagram */
2481     -    148 +  --mermaid-class-text: #e0e7ff;
2482     -    149 +
2483     -    150 +  /* User Journey */
2484     -    151 +  --mermaid-fill-type0: #ff006e;
2485     -    152 +  --mermaid-fill-type1: #8338ec;
2486     -    153 +  --mermaid-fill-type2: #3a86ff;
2487     -    154 +  --mermaid-fill-type3: #00f5d4;
2488     -    155 +  --mermaid-fill-type4: #ffbe0b;
2489     -    156 +  --mermaid-fill-type5: #fb5607;
2490     -    157 +  --mermaid-fill-type6: #ff1a8c;
2491     -    158 +  --mermaid-fill-type7: #00d4aa;
2492     - 47 159  }
2493     - 48 160  
2494     -
2495     -```
2496     -
2497     -
2498     -### üìÑ `themes/neon-light.css`
2499     -
2500     -**Type:** Stylesheet üé®
2501     -
2502     -```diff
2503     -@@ -23,20 +23,49 @@
2504     - 23  23    --code-block-bg: #fef3ff; /* Light purple background */
2505     - 24  24    --code-border: #e9d5ff;
2506     - 25  25  
2507     - 26     -  /* Syntax Highlighting - Comprehensive Token Colors */
2508     - 27     -  --syntax-keyword: #c026d3;
2509     - 28     -  --syntax-string: #10b981;
2510     - 29     -  --syntax-number: #f59e0b;
2511     - 30     -  --syntax-function: #7c3aed;
2512     - 31     -  --syntax-comment: #9ca3af;
2513     - 32     -  --syntax-operator: #a21caf;
2514     - 33     -  --syntax-punctuation: #6b7280;
2515     -     26 +  /* Syntax Highlighting - Production-Grade Token Colors (One Dark Architecture) */
2516     - 34  27  
2517     - 35     -  /* Additional Token Types for Full Customization */
2518     - 36     -  --syntax-variable: #7c3aed; /* Variables - purple */
2519     - 37     -  --syntax-property: #a21caf; /* Properties - magenta */
2520     - 38     -  --syntax-namespace: #c026d3; /* Namespaces - pink */
2521     - 39     -  --syntax-builtin: #7c3aed; /* Builtins - purple */
2522     -     28 +  /* Core hue-1: Cyan - URLs */
2523     -     29 +  --syntax-url: #06b6d4; /* Cyan for URLs */
2524     -     30 +
2525     -     31 +  /* Core hue-2: Purple/Violet - Functions, variables */
2526     -     32 +  --syntax-function: #7c3aed; /* Vibrant purple for functions */
2527     -     33 +  --syntax-variable: #6366f1; /* Indigo for variables */
2528     -     34 +
2529     -     35 +  /* Core hue-3: Magenta - Keywords */
2530     -     36 +  --syntax-keyword: #c026d3; /* Bright magenta for keywords (final, sealed, class) */
2531     -     37 +
2532     -     38 +  /* Core hue-4: Green - Strings, builtins */
2533     -     39 +  --syntax-string: #10b981; /* Emerald green for strings */
2534     -     40 +  --syntax-builtin: #059669; /* Dark emerald for builtins (String, List) */
2535     -     41 +  --syntax-char: #10b981; /* Same as strings */
2536     -     42 +  --syntax-regex: #10b981; /* Same as strings */
2537     -     43 +  --syntax-inserted: #10b981; /* For diff */
2538     -     44 +
2539     -     45 +  /* Core hue-5: Blue - Properties, tags */
2540     -     46 +  --syntax-property: #3b82f6; /* Blue for properties */
2541     -     47 +  --syntax-tag: #2563eb; /* Dark blue for tags */
2542     -     48 +  --syntax-deleted: #ef4444; /* Red for diff */
2543     -     49 +  --syntax-important: #3b82f6; /* Blue for !important */
2544     -     50 +
2545     -     51 +  /* Core hue-6: Amber/Pink - Class names, constants, numbers */
2546     -     52 +  --syntax-class-name: #d946ef; /* Fuchsia for class names (Rectangle, Shape) */
2547     -     53 +  --syntax-number: #f59e0b; /* Amber for numbers */
2548     -     54 +  --syntax-constant: #c026d3; /* Magenta for constants */
2549     -     55 +  --syntax-boolean: #f59e0b; /* Same as numbers */
2550     -     56 +  --syntax-atrule: #d946ef; /* Fuchsia for CSS @ rules */
2551     -     57 +
2552     -     58 +  /* Neutral colors */
2553     -     59 +  --syntax-comment: #9ca3af; /* Gray for comments */
2554     -     60 +  --syntax-punctuation: #6b7280; /* Dark gray for punctuation */
2555     -     61 +  --syntax-operator: #a21caf; /* Magenta-pink for operators */
2556     -     62 +
2557     -     63 +  /* Markup specific */
2558     -     64 +  --syntax-attr-name: #d946ef; /* Fuchsia like class-name */
2559     -     65 +  --syntax-attr-value: #10b981; /* Green like strings */
2560     -     66 +  --syntax-namespace: #7c3aed; /* Purple like keywords */
2561     -     67 +  --syntax-entity: #6b7280; /* Neutral */
2562     -     68 +  --syntax-selector: #3b82f6; /* Blue like properties */
2563     - 40  69  
2564     - 41  70    --blockquote-border: #c026d3;
2565     - 42  71    --blockquote-bg: #fef3ff;
2566     -@@ -44,4 +73,87 @@
2567     - 44  73    --italic-color: #c026d3;
2568     - 45  74    --table-header-bg: #fce7f3;
2569     - 46  75    --table-border: #e9d5ff;
2570     -     76 +
2571     -     77 +  /* === MERMAID COMPREHENSIVE CONFIGURATION === */
2572     -     78 +
2573     -     79 +  /* Core Global */
2574     -     80 +  --mermaid-background: #ffffff;
2575     -     81 +  --mermaid-text-color: #3b0764;
2576     -     82 +  --mermaid-line-color: #7c3aed;
2577     -     83 +  --mermaid-main-bkg: #fce7f3;
2578     -     84 +
2579     -     85 +  /* Primary Set */
2580     -     86 +  --mermaid-primary-color: #fce7f3;
2581     -     87 +  --mermaid-primary-text-color: #3b0764;
2582     -     88 +  --mermaid-primary-border-color: #c026d3;
2583     -     89 +
2584     -     90 +  /* Secondary Set */
2585     -     91 +  --mermaid-secondary-color: #fef3ff;
2586     -     92 +  --mermaid-secondary-text-color: #3b0764;
2587     -     93 +  --mermaid-secondary-border-color: #7c3aed;
2588     -     94 +
2589     -     95 +  /* Tertiary Set */
2590     -     96 +  --mermaid-tertiary-color: #ffffff;
2591     -     97 +  --mermaid-tertiary-text-color: #3b0764;
2592     -     98 +  --mermaid-tertiary-border-color: #d946ef;
2593     -     99 +
2594     -    100 +  /* Flowchart */
2595     -    101 +  --mermaid-node-border: #c026d3;
2596     -    102 +  --mermaid-cluster-bkg: #fef3ff;
2597     -    103 +  --mermaid-cluster-border: #7c3aed;
2598     -    104 +  --mermaid-default-link-color: #7c3aed;
2599     -    105 +  --mermaid-title-color: #3b0764;
2600     -    106 +  --mermaid-edge-label-background: #ffffff;
2601     -    107 +  --mermaid-node-text-color: #3b0764;
2602     -    108 +
2603     -    109 +  /* Sequence Diagram */
2604     -    110 +  --mermaid-actor-bkg: #fce7f3;
2605     -    111 +  --mermaid-actor-border: #c026d3;
2606     -    112 +  --mermaid-actor-text-color: #3b0764;
2607     -    113 +  --mermaid-actor-line-color: #c026d3;
2608     -    114 +  --mermaid-signal-color: #7c3aed;
2609     -    115 +  --mermaid-signal-text-color: #3b0764;
2610     -    116 +  --mermaid-label-box-bkg-color: #fce7f3;
2611     -    117 +  --mermaid-label-box-border-color: #c026d3;
2612     -    118 +  --mermaid-label-text-color: #3b0764;
2613     -    119 +  --mermaid-loop-text-color: #3b0764;
2614     -    120 +  --mermaid-activation-border-color: #7c3aed;
2615     -    121 +  --mermaid-activation-bkg-color: #fef3ff;
2616     -    122 +  --mermaid-sequence-number-color: #3b0764;
2617     -    123 +
2618     -    124 +  /* Pie Chart */
2619     -    125 +  --mermaid-pie1: #c026d3;
2620     -    126 +  --mermaid-pie2: #7c3aed;
2621     -    127 +  --mermaid-pie3: #3b82f6;
2622     -    128 +  --mermaid-pie4: #06b6d4;
2623     -    129 +  --mermaid-pie5: #f59e0b;
2624     -    130 +  --mermaid-pie6: #ef4444;
2625     -    131 +  --mermaid-pie7: #d946ef;
2626     -    132 +  --mermaid-pie8: #6366f1;
2627     -    133 +  --mermaid-pie9: #10b981;
2628     -    134 +  --mermaid-pie10: #c026d3;
2629     -    135 +  --mermaid-pie11: #7c3aed;
2630     -    136 +  --mermaid-pie12: #3b82f6;
2631     -    137 +  --mermaid-pie-title-text-color: #3b0764;
2632     -    138 +  --mermaid-pie-section-text-color: #ffffff; /* White on vibrant slices */
2633     -    139 +  --mermaid-pie-legend-text-color: #3b0764;
2634     -    140 +  --mermaid-pie-stroke-color: #c026d3;
2635     -    141 +  --mermaid-pie-outer-stroke-color: #c026d3;
2636     -    142 +
2637     -    143 +  /* State Diagram */
2638     -    144 +  --mermaid-label-color: #3b0764;
2639     -    145 +  --mermaid-alt-background: #fef3ff;
2640     -    146 +
2641     -    147 +  /* Class Diagram */
2642     -    148 +  --mermaid-class-text: #3b0764;
2643     -    149 +
2644     -    150 +  /* User Journey */
2645     -    151 +  --mermaid-fill-type0: #c026d3;
2646     -    152 +  --mermaid-fill-type1: #7c3aed;
2647     -    153 +  --mermaid-fill-type2: #3b82f6;
2648     -    154 +  --mermaid-fill-type3: #06b6d4;
2649     -    155 +  --mermaid-fill-type4: #f59e0b;
2650     -    156 +  --mermaid-fill-type5: #ef4444;
2651     -    157 +  --mermaid-fill-type6: #d946ef;
2652     -    158 +  --mermaid-fill-type7: #6366f1;
2653     - 47 159  }
2654     - 48 160  
2655     -
2656     -```
2657     -
2658     -
2659     -### üìÑ `themes/obsidian-dark.css`
2660     -
2661     -**Type:** Stylesheet üé®
2662     -
2663     -```diff
2664     -@@ -52,20 +52,49 @@
2665     - 52  52    --code-block-bg: #232635;
2666     - 53  53    --code-border: rgba(78, 205, 196, 0.2);
2667     - 54  54  
2668     - 55     -  /* Syntax Highlighting */
2669     - 56     -  --syntax-keyword: #c792ea;
2670     - 57     -  --syntax-string: #6bcf7f;
2671     - 58     -  --syntax-number: #ffcb6b;
2672     - 59     -  --syntax-function: #82aaff;
2673     - 60     -  --syntax-comment: #7f85a3;
2674     - 61     -  --syntax-operator: #89ddff;
2675     - 62     -  --syntax-punctuation: #b8bcc8;
2676     -     55 +  /* Syntax Highlighting - Production-Grade Token Colors (One Dark Architecture) */
2677     - 63  56  
2678     - 64     -  /* Additional Token Types */
2679     - 65     -  --syntax-variable: #82aaff; /* Variables - blue (distinct from text #f5f7ff) */
2680     - 66     -  --syntax-property: #4ecdc4; /* Properties - cyan */
2681     - 67     -  --syntax-namespace: #ffb86c; /* Namespaces - orange */
2682     - 68     -  --syntax-builtin: #c77dff; /* Builtins - purple */
2683     -     57 +  /* Core hue-1: Cyan - URLs */
2684     -     58 +  --syntax-url: #4ecdc4; /* Bright cyan for URLs */
2685     -     59 +
2686     -     60 +  /* Core hue-2: Blue - Functions, variables */
2687     -     61 +  --syntax-function: #82aaff; /* Bright blue for functions */
2688     -     62 +  --syntax-variable: #5da9ff; /* Sky blue for variables */
2689     -     63 +
2690     -     64 +  /* Core hue-3: Purple - Keywords */
2691     -     65 +  --syntax-keyword: #c792ea; /* Lavender purple for keywords (final, sealed, class) */
2692     -     66 +
2693     -     67 +  /* Core hue-4: Green - Strings, builtins */
2694     -     68 +  --syntax-string: #95e1d3; /* Mint green for strings */
2695     -     69 +  --syntax-builtin: #6bcf7f; /* Vibrant green for builtins (String, List) */
2696     -     70 +  --syntax-char: #95e1d3; /* Same as strings */
2697     -     71 +  --syntax-regex: #95e1d3; /* Same as strings */
2698     -     72 +  --syntax-inserted: #6bcf7f; /* For diff */
2699     -     73 +
2700     -     74 +  /* Core hue-5: Pink - Properties, tags */
2701     -     75 +  --syntax-property: #ff6b9d; /* Hot pink for properties */
2702     -     76 +  --syntax-tag: #ff7eb3; /* Coral pink for tags */
2703     -     77 +  --syntax-deleted: #f38ba8; /* Pink-red for diff */
2704     -     78 +  --syntax-important: #ff6b9d; /* Hot pink for !important */
2705     -     79 +
2706     -     80 +  /* Core hue-6: Yellow/Orange - Class names, constants, numbers */
2707     -     81 +  --syntax-class-name: #ffb86c; /* Peach orange for class names (Rectangle, Shape) */
2708     -     82 +  --syntax-number: #ffd93d; /* Bright yellow for numbers */
2709     -     83 +  --syntax-constant: #ffb86c; /* Peach for constants */
2710     -     84 +  --syntax-boolean: #ffd93d; /* Same as numbers */
2711     -     85 +  --syntax-atrule: #c77dff; /* Purple for CSS @ rules */
2712     -     86 +
2713     -     87 +  /* Neutral colors */
2714     -     88 +  --syntax-comment: #7f85a3; /* Muted blue-gray for comments */
2715     -     89 +  --syntax-punctuation: #b8bcc8; /* Light gray for punctuation */
2716     -     90 +  --syntax-operator: #89ddff; /* Cyan for operators */
2717     -     91 +
2718     -     92 +  /* Markup specific */
2719     -     93 +  --syntax-attr-name: #ffb86c; /* Peach like class-name */
2720     -     94 +  --syntax-attr-value: #95e1d3; /* Mint like strings */
2721     -     95 +  --syntax-namespace: #c792ea; /* Purple like keywords */
2722     -     96 +  --syntax-entity: #b8bcc8; /* Neutral */
2723     -     97 +  --syntax-selector: #ff6b9d; /* Pink like properties */
2724     - 69  98  
2725     - 70  99    /* Blockquote */
2726     - 71 100    --blockquote-border: #ff6b9d;
2727     -@@ -77,4 +106,87 @@
2728     - 77 106  
2729     - 78 107    /* Border */
2730     - 79 108    --border-color: rgba(255, 255, 255, 0.1);
2731     -    109 +
2732     -    110 +  /* === MERMAID COMPREHENSIVE CONFIGURATION === */
2733     -    111 +
2734     -    112 +  /* Core Global */
2735     -    113 +  --mermaid-background: #1e1e2e;
2736     -    114 +  --mermaid-text-color: #f5f7ff;
2737     -    115 +  --mermaid-line-color: #82aaff;
2738     -    116 +  --mermaid-main-bkg: #383a4f;
    4244 +    110 +### 12. üêõ Error Handling in `loadTheme` (Line 1008)
    4245 +    111 +```javascript
    4246 +    112 +.catch(err => {
    4247 +    113 +  console.error('Failed to load saved theme:', err);
    4248 +    114 +  // Fallback to default-light
    4249 +    115 +```
    4250 +    116 +**Critique:** Good fallback logic, but `alert()` or `toast` missing. User won't know why their theme didn't load.
2739 4251      117 +
2740     -    118 +  /* Primary Set */
2741     -    119 +  --mermaid-primary-color: #383a4f;
2742     -    120 +  --mermaid-primary-text-color: #f5f7ff;
2743     -    121 +  --mermaid-primary-border-color: #ff6b9d;
2744     -    122 +
2745     -    123 +  /* Secondary Set */
2746     -    124 +  --mermaid-secondary-color: #2b2d3e;
2747     -    125 +  --mermaid-secondary-text-color: #f5f7ff;
2748     -    126 +  --mermaid-secondary-border-color: #82aaff;
2749     -    127 +
2750     -    128 +  /* Tertiary Set */
2751     -    129 +  --mermaid-tertiary-color: #1e1e2e;
2752     -    130 +  --mermaid-tertiary-text-color: #f5f7ff;
2753     -    131 +  --mermaid-tertiary-border-color: #4ecdc4;
2754     -    132 +
2755     -    133 +  /* Flowchart */
2756     -    134 +  --mermaid-node-border: #ff6b9d;
2757     -    135 +  --mermaid-cluster-bkg: #2b2d3e;
2758     -    136 +  --mermaid-cluster-border: #82aaff;
2759     -    137 +  --mermaid-default-link-color: #82aaff;
2760     -    138 +  --mermaid-title-color: #f5f7ff;
2761     -    139 +  --mermaid-edge-label-background: #1e1e2e;
2762     -    140 +  --mermaid-node-text-color: #f5f7ff;
2763     -    141 +
2764     -    142 +  /* Sequence Diagram */
2765     -    143 +  --mermaid-actor-bkg: #383a4f;
2766     -    144 +  --mermaid-actor-border: #ff6b9d;
2767     -    145 +  --mermaid-actor-text-color: #f5f7ff;
2768     -    146 +  --mermaid-actor-line-color: #ff6b9d;
2769     -    147 +  --mermaid-signal-color: #82aaff;
2770     -    148 +  --mermaid-signal-text-color: #f5f7ff;
2771     -    149 +  --mermaid-label-box-bkg-color: #383a4f;
2772     -    150 +  --mermaid-label-box-border-color: #ff6b9d;
2773     -    151 +  --mermaid-label-text-color: #f5f7ff;
2774     -    152 +  --mermaid-loop-text-color: #f5f7ff;
2775     -    153 +  --mermaid-activation-border-color: #82aaff;
2776     -    154 +  --mermaid-activation-bkg-color: #2b2d3e;
2777     -    155 +  --mermaid-sequence-number-color: #f5f7ff;
2778     -    156 +
2779     -    157 +  /* Pie Chart */
2780     -    158 +  --mermaid-pie1: #ff6b9d;
2781     -    159 +  --mermaid-pie2: #ffd93d;
2782     -    160 +  --mermaid-pie3: #4ecdc4;
2783     -    161 +  --mermaid-pie4: #c77dff;
2784     -    162 +  --mermaid-pie5: #ffb86c;
2785     -    163 +  --mermaid-pie6: #95e1d3;
2786     -    164 +  --mermaid-pie7: #82aaff;
2787     -    165 +  --mermaid-pie8: #ff7eb3;
2788     -    166 +  --mermaid-pie9: #c8f6c2;
2789     -    167 +  --mermaid-pie10: #89dceb;
2790     -    168 +  --mermaid-pie11: #ff6b9d;
2791     -    169 +  --mermaid-pie12: #ffd93d;
2792     -    170 +  --mermaid-pie-title-text-color: #f5f7ff;
2793     -    171 +  --mermaid-pie-section-text-color: #1e1e2e; /* Dark on vibrant slices */
2794     -    172 +  --mermaid-pie-legend-text-color: #f5f7ff;
2795     -    173 +  --mermaid-pie-stroke-color: #ff6b9d;
2796     -    174 +  --mermaid-pie-outer-stroke-color: #ff6b9d;
2797     -    175 +
2798     -    176 +  /* State Diagram */
2799     -    177 +  --mermaid-label-color: #f5f7ff;
2800     -    178 +  --mermaid-alt-background: #2b2d3e;
2801     -    179 +
2802     -    180 +  /* Class Diagram */
2803     -    181 +  --mermaid-class-text: #f5f7ff;
2804     -    182 +
2805     -    183 +  /* User Journey */
2806     -    184 +  --mermaid-fill-type0: #ff6b9d;
2807     -    185 +  --mermaid-fill-type1: #ffd93d;
2808     -    186 +  --mermaid-fill-type2: #4ecdc4;
2809     -    187 +  --mermaid-fill-type3: #c77dff;
2810     -    188 +  --mermaid-fill-type4: #ffb86c;
2811     -    189 +  --mermaid-fill-type5: #95e1d3;
2812     -    190 +  --mermaid-fill-type6: #82aaff;
2813     -    191 +  --mermaid-fill-type7: #ff7eb3;
2814     - 80 192  }
2815     - 81 193  
    4252 +    118 +---
    4253 +    119 +
    4254 +    120 +## ‚úÖ Summary
    4255 +    121 +The code works "happy path" but is brittle. The usage of `setTimeout` for flow control and the lack of debouncing are the biggest "Senior SDE" red flags. The Security hole (XSS) is a blocker for any production release.
    4256 +    122  
2816 4257  
2817 4258  ```
2818 4259  
2819 4260  
2820     -### üìÑ `themes/obsidian-light.css`
    4261 +### ‚ú® `codebase_audit/deep_dive_reviews/theme_manager_review.md` **[ADDED]**
2821 4262  
2822     -**Type:** Stylesheet üé®
    4263 +**Status:** ‚úÖ **NEW FILE** - This file has been newly created
    4264 +
    4265 +**Type:** Documentation üìñ
2823 4266  
2824 4267  ```diff
2825     -@@ -52,20 +52,49 @@
2826     - 52  52    --code-block-bg: #f8f9fc;
2827     - 53  53    --code-border: rgba(0, 188, 212, 0.2);
2828     - 54  54  
2829     - 55     -  /* Syntax Highlighting - Comprehensive Token Colors */
2830     - 56     -  --syntax-keyword: #9c27b0;
2831     - 57     -  --syntax-string: #4caf50;
2832     - 58     -  --syntax-number: #f57c00;
2833     - 59     -  --syntax-function: #2196f3;
2834     - 60     -  --syntax-comment: #9e9e9e;
2835     - 61     -  --syntax-operator: #00bcd4;
2836     - 62     -  --syntax-punctuation: #616161;
2837     -     55 +  /* Syntax Highlighting - Production-Grade Token Colors (One Dark Architecture) */
2838     - 63  56  
2839     - 64     -  /* Additional Token Types for Full Customization */
2840     - 65     -  --syntax-variable: #2196f3; /* Variables, parameters - bright blue */
2841     - 66     -  --syntax-property: #00bcd4; /* Properties - cyan */
2842     - 67     -  --syntax-namespace: #f57c00; /* Namespaces - orange */
2843     - 68     -  --syntax-builtin: #9c27b0; /* Built-in functions - purple */
2844     -     57 +  /* Core hue-1: Cyan - URLs */
2845     -     58 +  --syntax-url: #00bcd4; /* Cyan for URLs */
2846     -     59 +
2847     -     60 +  /* Core hue-2: Blue - Functions, variables */
2848     -     61 +  --syntax-function: #2196f3; /* Bright blue for functions */
2849     -     62 +  --syntax-variable: #1976d2; /* Deep blue for variables */
    4268 +@@ -0,0 +1,53 @@
    4269 +      1 +# üïµÔ∏è‚Äç‚ôÇÔ∏è Deep Dive Code Review: `ThemeManager.js`
    4270 +      2 +
    4271 +      3 +**Reviewer:** CodeBaseGPT (Senior SDE Persona)
    4272 +      4 +**Date:** 2025-12-09
    4273 +      5 +**File:** `src/js/core/ThemeManager.js` (263 Lines)
    4274 +      6 +
    4275 +      7 +---
    4276 +      8 +
    4277 +      9 +## üü¢ strengths
    4278 +     10 +*   **SOLID Principles:** Class has a clear Single Responsibility.
    4279 +     11 +*   **Error Handling:** `try...catch` blocks are present in `loadBuiltInTheme` and `loadCustomTheme`.
    4280 +     12 +*   **JSDoc:** Excellent documentation and usage examples.
    4281 +     13 +
    4282 +     14 +## ‚ö†Ô∏è Issues & Observations
    4283 +     15 +
    4284 +     16 +### 1. üêå Performance: `clearInlineStyles` (Line 205)
    4285 +     17 +```javascript
    4286 +     18 +for (let i = styles.length - 1; i >= 0; i--) {
    4287 +     19 +  const prop = styles[i];
    4288 +     20 +  if (prop.startsWith('--')) {
    4289 +     21 +    removeCssVariable(prop);
    4290 +     22 +  }
    4291 +     23 +}
    4292 +     24 +```
    4293 +     25 +**Critique:** This loop calls `removeProperty` repeatedly on the root element.
    4294 +     26 +- **Impact:** Each removal can trigger a Style Recalculation (Reflow) in the browser engine.
    4295 +     27 +- **Optimization:** If you only use inline styles for custom themes, you could simply clear the `style` attribute: `document.documentElement.removeAttribute('style');` (unless there are other non-theme inline styles needed).
    4296 +     28 +
    4297 +     29 +### 2. üß© Hardcoded Variable List (Line 171)
    4298 +     30 +```javascript
    4299 +     31 +const cssVarNames = [ '--bg-primary', ... ];
    4300 +     32 +```
    4301 +     33 +**Critique:** You manually list 18 variables here to "capture" the current theme colors.
    4302 +     34 +- **Risk:** This list is a **Maintenance Liability**. If a developer adds a new color (e.g., `--warning-color`) to `style.css` but forgets to add it here, the "Save Custom Theme" feature will silently drop that color.
    4303 +     35 +- **Fix:** Import this list from `src/js/config/constants.js` (SSOT). Do not define it inside the method.
    4304 +     36 +
    4305 +     37 +### 3. üß™ Production Path Resolution (Line 80)
    4306 +     38 +```javascript
    4307 +     39 +const baseUrl = import.meta.env.BASE_URL || '/';
    4308 +     40 +stylesheet.href = `${baseUrl}themes/${themeName}.css`;
    4309 +     41 +```
    4310 +     42 +**Critique:** Good job anticipating Vite's `BASE_URL`.
    4311 +     43 +- **Observation:** Ensure `themes/` folder is actually copied to `dist/` during build. Since they are static assets referenced via code (not import), Vite might not hash/include them unless configured in `vite.config.js` static assets.
    4312 +     44 +
    4313 +     45 +### 4. üîí Private Methods (Semantics)
    4314 +     46 +**Critique:** You use JSDoc `@private` but the methods `loadBuiltInTheme` are technically public.
    4315 +     47 +- **Suggestion:** Use `#privateFields` (ES2022) if you want true privacy, e.g., `#loadBuiltInTheme`.
    4316 +     48 +
    4317 +     49 +---
    4318 +     50 +
    4319 +     51 +## üèÅ Verdict
    4320 +     52 +**Grade: A-**
    4321 +     53 +This is high-quality code. The issues are mostly maintenance optimizations. The logic is sound.
    4322 +     54  
    4323 +
    4324 +```
    4325 +
    4326 +
    4327 +### ‚ú® `codebase_audit/docs_summary.json` **[ADDED]**
    4328 +
    4329 +**Status:** ‚úÖ **NEW FILE** - This file has been newly created
    4330 +
    4331 +**Type:** Configuration/Data File üìã
    4332 +
    4333 +```diff
    4334 +@@ -0,0 +1,12 @@
    4335 +      1 +{
    4336 +      2 +  "hld": "The application follows a client-side monolithic architecture with pure vanilla JavaScript, CSS variables for theming, and no backend. It uses a \"Service Layer\" pattern to isolate business logic (Mermaid, Prism) from UI, and an \"Observer Pattern\" for theme changes. Data is persisted solely via browser `localStorage`. Security relies on client-side sanitization (Marked.js) and no external data transmission.",
    4337 +      3 +  "lld": "The codebase is organized into modular layers: `UI` (HTML), `Application` (script.js controller), `Core` (StorageManager, ThemeManager), `Services` (MermaidService, PrismService), and `Utils` (HTML/Color helpers). The `ThemeManager` handles 12 built-in themes + custom themes using CSS variables. `MermaidService` and `PrismService` wrap external libraries with lazy initialization and error handling. `script.js` acts as the entry point, treating other modules as injected dependencies.",
    4338 +      4 +  "other": {
    4339 +      5 +    "folder-browser-plan": "Plan to add a file system sidebar using the File System Access API for local folder navigation.",
    4340 +      6 +    "math-rendering-plan": "Proposal to integrate KaTeX for LaTeX math rendering ($ and $$ syntax) via marked extension.",
    4341 +      7 +    "pdf-export-plan": "Design to add PDF export using html2pdf.js, preserving styles and Mermaid diagrams.",
    4342 +      8 +    "implementation-plan": "6-week refactoring roadmap moving from monolithic script.js to modular ES modules structure (currently in progress/partially complete).",
    4343 +      9 +    "deployment-guide": "Documentation for deploying to Vercel, Netlify, or GitHub Pages as a static site.",
    4344 +     10 +    "ai-review": "Recent automated code review log highlighting fixes for theme dropdown sync and architecture documentation additions."
    4345 +     11 +  }
    4346 +     12 +}
    4347 +     13  
    4348 +
    4349 +```
    4350 +
    4351 +
    4352 +### ‚ú® `codebase_audit/future_enhancements_roadmap.md` **[ADDED]**
    4353 +
    4354 +**Status:** ‚úÖ **NEW FILE** - This file has been newly created
    4355 +
    4356 +**Type:** Documentation üìñ
    4357 +
    4358 +```diff
    4359 +@@ -0,0 +1,87 @@
    4360 +      1 +# üöÄ Future Enhancements: Enterprise-Grade Roadmap
    4361 +      2 +
    4362 +      3 +This document outlines the strategic roadmap to transform the `markdown-viewer-app` into a truly **Enterprise-Grade** web application.
    4363 +      4 +
    4364 +      5 +---
    4365 +      6 +
    4366 +      7 +## üèóÔ∏è Phase 1: Robust Application Architecture (Modernization)
    4367 +      8 +
    4368 +      9 +To support enterprise scale, we must move beyond the "Vanilla JS" constraints suitable for prototypes and adopt a robust, type-safe ecosystem.
    4369 +     10 +
    4370 +     11 +### 1.1 Migrate to TypeScript
    4371 +     12 +*   **Why:** Enterprise apps require type safety to prevent runtime errors (undefined is not ...).
    4372 +     13 +*   **Plan:** Rename `.js` to `.ts`. Define interfaces for `Theme`, `FileNode`, and `AppConfig`. Strict null checks.
    4373 +     14 +
    4374 +     15 +### 1.2 Component-Based Architecture (Web Components or Framework)
    4375 +     16 +*   **Why:** The `script.js` monolith is unmaintainable.
    4376 +     17 +*   **Plan:**
    4377 +     18 +    *   **Option A (Vanilla):** Adopt Web Components (`<markdown-editor>`, `<file-tree>`).
    4378 +     19 +    *   **Option B (Standard):** Migrate to **React** or **Vue**. This allows us to use massive ecosystems of tested components (e.g., `Monaco Editor` for better markdown editing).
    4379 +     20 +
    4380 +     21 +### 1.3 State Management
    4381 +     22 +*   **Why:** Passing `globalRenderMarkdown` around is fragile.
    4382 +     23 +*   **Plan:** Implement a centralized store (e.g., `Redux`, `Zustand`, or a simple `StateService` observable) to manage:
    4383 +     24 +    *   `currentFile`
    4384 +     25 +    *   `theme`
    4385 +     26 +    *   `settings`
    4386 +     27 +    *   `folderStructure`
    4387 +     28 +
    4388 +     29 +---
    4389 +     30 +
    4390 +     31 +## üõ°Ô∏è Phase 2: Enterprise Security & Compliance
    4391 +     32 +
    4392 +     33 +### 2.1 Content Security Policy (CSP)
    4393 +     34 +*   **Goal:** Prevent XSS and Data Exfiltration.
    4394 +     35 +*   **Action:** implement strict CSP headers (or `<meta>` tags):
    4395 +     36 +    ```html
    4396 +     37 +    <meta http-equiv="Content-Security-Policy" content="default-src 'self'; script-src 'self' 'unsafe-eval' (for mermaid); style-src 'self' 'unsafe-inline';">
    4397 +     38 +    ```
    4398 +     39 +
    4399 +     40 +### 2.2 Input Sanitization Layer
    4400 +     41 +*   **Goal:** trust No Input.
    4401 +     42 +*   **Action:** Integrate `DOMPurify` deeply into the rendering pipeline. Create a `SanitizationService` that all HTML output must pass through.
    4402 +     43 +
    4403 +     44 +---
    4404 +     45 +
    4405 +     46 +## ‚ö° Phase 3: Performance & Scalability
    4406 +     47 +
    4407 +     48 +### 3.1 Web Workers for Parsing
    4408 +     49 +*   **Issue:** Parsing large markdown files (1000+ lines) freezes the UI.
    4409 +     50 +*   **Solution:** Move `marked.parse` and syntax highlighting logic to a **Web Worker**. The main thread should only handle User Input and DOM updates.
    4410 +     51 +
    4411 +     52 +### 3.2 Virtualized Rendering
    4412 +     53 +*   **Issue:** The File Browser and Large Preview will lag with thousands of items.
    4413 +     54 +*   **Solution:** Implement "Virtual Scrolling" (Windowing). Only render the DOM nodes currently visible on screen.
    4414 +     55 +
    4415 +     56 +### 3.3 Offline-First (PWA)
    4416 +     57 +*   **Goal:** Native-like reliability.
    4417 +     58 +*   **Action:**
    4418 +     59 +    *   Add a Service Worker to cache App Shell and Assets (Fonts, CSS).
    4419 +     60 +    *   Use `IndexedDB` instead of `localStorage` for saving files (allows saving images/blobs).
    4420 +     61 +
    4421 +     62 +---
2850 4422       63 +
2851     -     64 +  /* Core hue-3: Purple - Keywords */
2852     -     65 +  --syntax-keyword: #9c27b0; /* Vibrant purple for keywords (final, sealed, class) */
2853     -     66 +
2854     -     67 +  /* Core hue-4: Green - Strings, builtins */
2855     -     68 +  --syntax-string: #4caf50; /* Green for strings */
2856     -     69 +  --syntax-builtin: #388e3c; /* Dark green for builtins (String, List) */
2857     -     70 +  --syntax-char: #4caf50; /* Same as strings */
2858     -     71 +  --syntax-regex: #4caf50; /* Same as strings */
2859     -     72 +  --syntax-inserted: #388e3c; /* For diff */
    4423 +     64 +## üß© Phase 4: Advanced Features (The "Wow" Factor)
    4424 +     65 +
    4425 +     66 +### 4.1 Collaborative Editing (Real-Time)
    4426 +     67 +*   **Tech:** `Yjs` or `Automerge` (CRDTs).
    4427 +     68 +*   **Feature:** Allow two users to edit the same doc via WebRTC (local peer-to-peer) without a central server.
    4428 +     69 +
    4429 +     70 +### 4.2 Semantic Search (AI)
    4430 +     71 +*   **Start:** Implement client-side full-text search (FlexSearch).
    4431 +     72 +*   **Upgrade:** Use a local LLM or Embedding model (via WebGPU) to allow "Chat with my Docs".
2860 4432       73 +
2861     -     74 +  /* Core hue-5: Pink/Orange - Properties, tags */
2862     -     75 +  --syntax-property: #e91e63; /* Pink for properties */
2863     -     76 +  --syntax-tag: #ff4081; /* Coral for tags */
2864     -     77 +  --syntax-deleted: #d32f2f; /* Red for diff */
2865     -     78 +  --syntax-important: #e91e63; /* Pink for !important */
    4433 +     74 +### 4.3 Plugin System
    4434 +     75 +*   **Architecture:** Allow users to write JavaScript "plugins" to extend functionality (e.g., a "Date Picker" markdown extension).
    4435 +     76 +*   **Security:** Run plugins in a Sandboxed Iframe.
    4436 +     77 +
    4437 +     78 +---
2866 4438       79 +
2867     -     80 +  /* Core hue-6: Orange/Yellow - Class names, constants, numbers */
2868     -     81 +  --syntax-class-name: #ff9800; /* Orange for class names (Rectangle, Shape) */
2869     -     82 +  --syntax-number: #f57c00; /* Dark orange for numbers */
2870     -     83 +  --syntax-constant: #ff9800; /* Orange for constants */
2871     -     84 +  --syntax-boolean: #f57c00; /* Same as numbers */
2872     -     85 +  --syntax-atrule: #9c27b0; /* Purple for CSS @ rules */
2873     -     86 +
2874     -     87 +  /* Neutral colors */
2875     -     88 +  --syntax-comment: #9e9e9e; /* Gray for comments */
2876     -     89 +  --syntax-punctuation: #616161; /* Dark gray for punctuation */
2877     -     90 +  --syntax-operator: #00bcd4; /* Cyan for operators */
2878     -     91 +
2879     -     92 +  /* Markup specific */
2880     -     93 +  --syntax-attr-name: #ff9800; /* Orange like class-name */
2881     -     94 +  --syntax-attr-value: #4caf50; /* Green like strings */
2882     -     95 +  --syntax-namespace: #9c27b0; /* Purple like keywords */
2883     -     96 +  --syntax-entity: #616161; /* Neutral */
2884     -     97 +  --syntax-selector: #e91e63; /* Pink like properties */
2885     - 69  98  
2886     - 70  99    /* Blockquote */
2887     - 71 100    --blockquote-border: #e91e63;
2888     -@@ -77,4 +106,87 @@
2889     - 77 106  
2890     - 78 107    /* Border */
2891     - 79 108    --border-color: rgba(0, 0, 0, 0.12);
2892     -    109 +
2893     -    110 +  /* === MERMAID COMPREHENSIVE CONFIGURATION === */
2894     -    111 +
2895     -    112 +  /* Core Global */
2896     -    113 +  --mermaid-background: #ffffff;
2897     -    114 +  --mermaid-text-color: #1a1a1a;
2898     -    115 +  --mermaid-line-color: #9c27b0;
2899     -    116 +  --mermaid-main-bkg: #e8ecf1;
2900     -    117 +
2901     -    118 +  /* Primary Set */
2902     -    119 +  --mermaid-primary-color: #e8ecf1;
2903     -    120 +  --mermaid-primary-text-color: #1a1a1a;
2904     -    121 +  --mermaid-primary-border-color: #e91e63;
2905     -    122 +
2906     -    123 +  /* Secondary Set */
2907     -    124 +  --mermaid-secondary-color: #f5f7fa;
2908     -    125 +  --mermaid-secondary-text-color: #1a1a1a;
2909     -    126 +  --mermaid-secondary-border-color: #9c27b0;
2910     -    127 +
2911     -    128 +  /* Tertiary Set */
2912     -    129 +  --mermaid-tertiary-color: #ffffff;
2913     -    130 +  --mermaid-tertiary-text-color: #1a1a1a;
2914     -    131 +  --mermaid-tertiary-border-color: #00bcd4;
2915     -    132 +
2916     -    133 +  /* Flowchart */
2917     -    134 +  --mermaid-node-border: #e91e63;
2918     -    135 +  --mermaid-cluster-bkg: #f5f7fa;
2919     -    136 +  --mermaid-cluster-border: #9c27b0;
2920     -    137 +  --mermaid-default-link-color: #9c27b0;
2921     -    138 +  --mermaid-title-color: #1a1a1a;
2922     -    139 +  --mermaid-edge-label-background: #ffffff;
2923     -    140 +  --mermaid-node-text-color: #1a1a1a;
2924     -    141 +
2925     -    142 +  /* Sequence Diagram */
2926     -    143 +  --mermaid-actor-bkg: #e8ecf1;
2927     -    144 +  --mermaid-actor-border: #e91e63;
2928     -    145 +  --mermaid-actor-text-color: #1a1a1a;
2929     -    146 +  --mermaid-actor-line-color: #e91e63;
2930     -    147 +  --mermaid-signal-color: #9c27b0;
2931     -    148 +  --mermaid-signal-text-color: #1a1a1a;
2932     -    149 +  --mermaid-label-box-bkg-color: #e8ecf1;
2933     -    150 +  --mermaid-label-box-border-color: #e91e63;
2934     -    151 +  --mermaid-label-text-color: #1a1a1a;
2935     -    152 +  --mermaid-loop-text-color: #1a1a1a;
2936     -    153 +  --mermaid-activation-border-color: #9c27b0;
2937     -    154 +  --mermaid-activation-bkg-color: #f5f7fa;
2938     -    155 +  --mermaid-sequence-number-color: #1a1a1a;
2939     -    156 +
2940     -    157 +  /* Pie Chart */
2941     -    158 +  --mermaid-pie1: #e91e63;
2942     -    159 +  --mermaid-pie2: #9c27b0;
2943     -    160 +  --mermaid-pie3: #2196f3;
2944     -    161 +  --mermaid-pie4: #00bcd4;
2945     -    162 +  --mermaid-pie5: #4caf50;
2946     -    163 +  --mermaid-pie6: #ff9800;
2947     -    164 +  --mermaid-pie7: #f57c00;
2948     -    165 +  --mermaid-pie8: #ff4081;
2949     -    166 +  --mermaid-pie9: #1976d2;
2950     -    167 +  --mermaid-pie10: #388e3c;
2951     -    168 +  --mermaid-pie11: #e91e63;
2952     -    169 +  --mermaid-pie12: #9c27b0;
2953     -    170 +  --mermaid-pie-title-text-color: #1a1a1a;
2954     -    171 +  --mermaid-pie-section-text-color: #ffffff; /* White on vibrant slices */
2955     -    172 +  --mermaid-pie-legend-text-color: #1a1a1a;
2956     -    173 +  --mermaid-pie-stroke-color: #e91e63;
2957     -    174 +  --mermaid-pie-outer-stroke-color: #e91e63;
2958     -    175 +
2959     -    176 +  /* State Diagram */
2960     -    177 +  --mermaid-label-color: #1a1a1a;
2961     -    178 +  --mermaid-alt-background: #f5f7fa;
2962     -    179 +
2963     -    180 +  /* Class Diagram */
2964     -    181 +  --mermaid-class-text: #1a1a1a;
2965     -    182 +
2966     -    183 +  /* User Journey */
2967     -    184 +  --mermaid-fill-type0: #e91e63;
2968     -    185 +  --mermaid-fill-type1: #9c27b0;
2969     -    186 +  --mermaid-fill-type2: #2196f3;
2970     -    187 +  --mermaid-fill-type3: #00bcd4;
2971     -    188 +  --mermaid-fill-type4: #4caf50;
2972     -    189 +  --mermaid-fill-type5: #ff9800;
2973     -    190 +  --mermaid-fill-type6: #f57c00;
2974     -    191 +  --mermaid-fill-type7: #ff4081;
2975     - 80 192  }
2976     - 81 193  
    4439 +     80 +## üìà Roadmap Estimate
    4440 +     81 +
    4441 +     82 +| Feature | Complexity | Impact | Timeline |
    4442 +     83 +|---------|------------|--------|----------|
    4443 +     84 +| **TS Migration** | Medium | High | Q1 |
    4444 +     85 +| **PWA / Offline** | Low | High | Q1 |
    4445 +     86 +| **Web Workers** | High | Medium | Q2 |
    4446 +     87 +| **Collaboration**| Very High| High | Q3 |
    4447 +     88  
2977 4448  
2978 4449  ```
2979 4450  
2980 4451  
2981     -### üìÑ `themes/ocean-dark.css`
    4452 +### ‚ú® `codebase_audit/phase3_codebase_review.json` **[ADDED]**
2982 4453  
2983     -**Type:** Stylesheet üé®
    4454 +**Status:** ‚úÖ **NEW FILE** - This file has been newly created
    4455 +
    4456 +**Type:** Configuration/Data File üìã
2984 4457  
2985 4458  ```diff
2986     -@@ -23,20 +23,49 @@
2987     - 23  23    --code-block-bg: #0a192f;
2988     - 24  24    --code-border: #233554;
2989     - 25  25  
2990     - 26     -  /* Syntax Highlighting - Comprehensive Token Colors */
2991     - 27     -  --syntax-keyword: #64ffda;
2992     - 28     -  --syntax-string: #5eead4;
2993     - 29     -  --syntax-number: #38bdf8;
2994     - 30     -  --syntax-function: #22d3ee;
2995     - 31     -  --syntax-comment: #8892b0;
2996     - 32     -  --syntax-operator: #06b6d4;
2997     - 33     -  --syntax-punctuation: #8892b0;
2998     -     26 +  /* Syntax Highlighting - Production-Grade Token Colors (One Dark Architecture) */
2999     - 34  27  
3000     - 35     -  /* Additional Token Types */
3001     - 36     -  --syntax-variable: #38bdf8; /* Variables - cyan (distinct from text #ccd6f6) */
3002     - 37     -  --syntax-property: #22d3ee; /* Properties - teal */
3003     - 38     -  --syntax-namespace: #64ffda; /* Namespaces - mint */
3004     - 39     -  --syntax-builtin: #5eead4; /* Builtins - teal */
3005     -     28 +  /* Core hue-1: Bright Cyan - URLs */
3006     -     29 +  --syntax-url: #67e8f9; /* Electric cyan for URLs */
3007     -     30 +
3008     -     31 +  /* Core hue-2: Blue - Functions, variables */
3009     -     32 +  --syntax-function: #38bdf8; /* Sky blue for functions */
3010     -     33 +  --syntax-variable: #0ea5e9; /* Deep sky for variables */
3011     -     34 +
3012     -     35 +  /* Core hue-3: Violet/Purple - Keywords */
3013     -     36 +  --syntax-keyword: #c084fc; /* Bright violet for keywords (final, sealed, class) */
3014     -     37 +
3015     -     38 +  /* Core hue-4: Green/Teal - Strings, builtins */
3016     -     39 +  --syntax-string: #5eead4; /* Teal for strings */
3017     -     40 +  --syntax-builtin: #2dd4bf; /* Vibrant teal for builtins (String, List) */
3018     -     41 +  --syntax-char: #5eead4; /* Same as strings */
3019     -     42 +  --syntax-regex: #5eead4; /* Same as strings */
3020     -     43 +  --syntax-inserted: #2dd4bf; /* For diff */
3021     -     44 +
3022     -     45 +  /* Core hue-5: Pink/Rose - Properties, tags */
3023     -     46 +  --syntax-property: #f472b6; /* Pink for properties */
3024     -     47 +  --syntax-tag: #fb7185; /* Rose for tags */
3025     -     48 +  --syntax-deleted: #f87171; /* Coral for diff */
3026     -     49 +  --syntax-important: #f472b6; /* Pink for !important */
3027     -     50 +
3028     -     51 +  /* Core hue-6: Mint/Cyan - Class names, constants, numbers */
3029     -     52 +  --syntax-class-name: #64ffda; /* Mint green for class names (Rectangle, Shape) */
3030     -     53 +  --syntax-number: #22d3ee; /* Bright cyan for numbers */
3031     -     54 +  --syntax-constant: #06b6d4; /* Cyan for constants */
3032     -     55 +  --syntax-boolean: #22d3ee; /* Same as numbers */
3033     -     56 +  --syntax-atrule: #64ffda; /* Mint for CSS @ rules */
3034     -     57 +
3035     -     58 +  /* Neutral colors */
3036     -     59 +  --syntax-comment: #8892b0; /* Muted blue-gray for comments */
3037     -     60 +  --syntax-punctuation: #a0aec0; /* Light gray for punctuation */
3038     -     61 +  --syntax-operator: #0891b2; /* Teal for operators */
3039     -     62 +
3040     -     63 +  /* Markup specific */
3041     -     64 +  --syntax-attr-name: #64ffda; /* Mint like class-name */
3042     -     65 +  --syntax-attr-value: #5eead4; /* Teal like strings */
3043     -     66 +  --syntax-namespace: #c084fc; /* Violet like keywords */
3044     -     67 +  --syntax-entity: #a0aec0; /* Neutral */
3045     -     68 +  --syntax-selector: #f472b6; /* Pink like properties */
3046     - 40  69  
3047     - 41  70    --blockquote-border: #64ffda;
3048     - 42  71    --blockquote-bg: #112240;
3049     -@@ -44,4 +73,87 @@
3050     - 44  73    --italic-color: #5eead4;
3051     - 45  74    --table-header-bg: #1d3461;
3052     - 46  75    --table-border: #233554;
3053     -     76 +
3054     -     77 +  /* === MERMAID COMPREHENSIVE CONFIGURATION === */
3055     -     78 +
3056     -     79 +  /* Core Global */
3057     -     80 +  --mermaid-background: #0a192f;
3058     -     81 +  --mermaid-text-color: #ccd6f6;
3059     -     82 +  --mermaid-line-color: #5eead4;
3060     -     83 +  --mermaid-main-bkg: #1d3461;
3061     -     84 +
3062     -     85 +  /* Primary Set */
3063     -     86 +  --mermaid-primary-color: #1d3461;
3064     -     87 +  --mermaid-primary-text-color: #ccd6f6;
3065     -     88 +  --mermaid-primary-border-color: #64ffda;
3066     -     89 +
3067     -     90 +  /* Secondary Set */
3068     -     91 +  --mermaid-secondary-color: #112240;
3069     -     92 +  --mermaid-secondary-text-color: #ccd6f6;
3070     -     93 +  --mermaid-secondary-border-color: #5eead4;
3071     -     94 +
3072     -     95 +  /* Tertiary Set */
3073     -     96 +  --mermaid-tertiary-color: #0a192f;
3074     -     97 +  --mermaid-tertiary-text-color: #ccd6f6;
3075     -     98 +  --mermaid-tertiary-border-color: #38bdf8;
3076     -     99 +
3077     -    100 +  /* Flowchart */
3078     -    101 +  --mermaid-node-border: #64ffda;
3079     -    102 +  --mermaid-cluster-bkg: #112240;
3080     -    103 +  --mermaid-cluster-border: #5eead4;
3081     -    104 +  --mermaid-default-link-color: #5eead4;
3082     -    105 +  --mermaid-title-color: #ccd6f6;
3083     -    106 +  --mermaid-edge-label-background: #0a192f;
3084     -    107 +  --mermaid-node-text-color: #ccd6f6;
3085     -    108 +
3086     -    109 +  /* Sequence Diagram */
3087     -    110 +  --mermaid-actor-bkg: #1d3461;
3088     -    111 +  --mermaid-actor-border: #64ffda;
3089     -    112 +  --mermaid-actor-text-color: #ccd6f6;
3090     -    113 +  --mermaid-actor-line-color: #64ffda;
3091     -    114 +  --mermaid-signal-color: #5eead4;
3092     -    115 +  --mermaid-signal-text-color: #ccd6f6;
3093     -    116 +  --mermaid-label-box-bkg-color: #1d3461;
3094     -    117 +  --mermaid-label-box-border-color: #64ffda;
3095     -    118 +  --mermaid-label-text-color: #ccd6f6;
3096     -    119 +  --mermaid-loop-text-color: #ccd6f6;
3097     -    120 +  --mermaid-activation-border-color: #5eead4;
3098     -    121 +  --mermaid-activation-bkg-color: #112240;
3099     -    122 +  --mermaid-sequence-number-color: #ccd6f6;
3100     -    123 +
3101     -    124 +  /* Pie Chart */
3102     -    125 +  --mermaid-pie1: #64ffda;
3103     -    126 +  --mermaid-pie2: #5eead4;
3104     -    127 +  --mermaid-pie3: #38bdf8;
3105     -    128 +  --mermaid-pie4: #22d3ee;
3106     -    129 +  --mermaid-pie5: #06b6d4;
3107     -    130 +  --mermaid-pie6: #0891b2;
3108     -    131 +  --mermaid-pie7: #c084fc;
3109     -    132 +  --mermaid-pie8: #f472b6;
3110     -    133 +  --mermaid-pie9: #0ea5e9;
3111     -    134 +  --mermaid-pie10: #64ffda;
3112     -    135 +  --mermaid-pie11: #5eead4;
3113     -    136 +  --mermaid-pie12: #38bdf8;
3114     -    137 +  --mermaid-pie-title-text-color: #ccd6f6;
3115     -    138 +  --mermaid-pie-section-text-color: #0a192f; /* Dark on vibrant slices */
3116     -    139 +  --mermaid-pie-legend-text-color: #ccd6f6;
3117     -    140 +  --mermaid-pie-stroke-color: #64ffda;
3118     -    141 +  --mermaid-pie-outer-stroke-color: #64ffda;
3119     -    142 +
3120     -    143 +  /* State Diagram */
3121     -    144 +  --mermaid-label-color: #ccd6f6;
3122     -    145 +  --mermaid-alt-background: #112240;
3123     -    146 +
3124     -    147 +  /* Class Diagram */
3125     -    148 +  --mermaid-class-text: #ccd6f6;
3126     -    149 +
3127     -    150 +  /* User Journey */
3128     -    151 +  --mermaid-fill-type0: #64ffda;
3129     -    152 +  --mermaid-fill-type1: #5eead4;
3130     -    153 +  --mermaid-fill-type2: #38bdf8;
3131     -    154 +  --mermaid-fill-type3: #22d3ee;
3132     -    155 +  --mermaid-fill-type4: #06b6d4;
3133     -    156 +  --mermaid-fill-type5: #0891b2;
3134     -    157 +  --mermaid-fill-type6: #c084fc;
3135     -    158 +  --mermaid-fill-type7: #f472b6;
3136     - 47 159  }
3137     - 48 160  
    4459 +@@ -0,0 +1,68 @@
    4460 +      1 +{
    4461 +      2 +  "phase": "3 - Codebase Review",
    4462 +      3 +  "status": "COMPLETED",
    4463 +      4 +  "findings": {
    4464 +      5 +    "security": [
    4465 +      6 +      {
    4466 +      7 +        "severity": "CRITICAL",
    4467 +      8 +        "type": "Stored XSS",
    4468 +      9 +        "location": "script.js:512",
    4469 +     10 +        "description": "Marked.js output is assigned to innerHTML without sanitization. DOMPurify is missing from dependencies.",
    4470 +     11 +        "remediation": "Install dompurify and sanitize 'html' variable before assignment."
    4471 +     12 +      },
    4472 +     13 +      {
    4473 +     14 +        "severity": "LOW",
    4474 +     15 +        "type": "Data Privacy",
    4475 +     16 +        "location": "script.js:522",
    4476 +     17 +        "description": "User content stored in localStorage unencrypted. Acceptable for MVP but should be noted.",
    4477 +     18 +        "remediation": "Add warning or option to disable local storage persistence."
    4478 +     19 +      }
    4479 +     20 +    ],
    4480 +     21 +    "architecture": [
    4481 +     22 +      {
    4482 +     23 +        "severity": "HIGH",
    4483 +     24 +        "type": "Monolithic Controller",
    4484 +     25 +        "location": "script.js",
    4485 +     26 +        "description": "script.js is over 1300 lines and handles UI, logic, and service orchestration. Needs splitting.",
    4486 +     27 +        "remediation": "Extract UI logic into UIManager.js and EventManager.js."
    4487 +     28 +      },
    4488 +     29 +      {
    4489 +     30 +        "severity": "MEDIUM",
    4490 +     31 +        "type": "Race Condition",
    4491 +     32 +        "location": "script.js:490,535",
    4492 +     33 +        "description": "Reliance on setTimeout magic numbers (100ms) for synchronization between Theme loading and Mermaid rendering.",
    4493 +     34 +        "remediation": "Implement proper Promise-based initialization chain."
    4494 +     35 +      },
    4495 +     36 +      {
    4496 +     37 +        "severity": "LOW",
    4497 +     38 +        "type": "Mixed Dependency Management",
    4498 +     39 +        "location": "index.html / package.json",
    4499 +     40 +        "description": "Project uses NPM for dev tools but CDNs for runtime libraries (marked, plotly, etc.). Hard to version control runtime deps.",
    4500 +     41 +        "remediation": "Migrate runtime dependencies to NPM and bundle with Vite."
    4501 +     42 +      }
    4502 +     43 +    ],
    4503 +     44 +    "code_quality": [
    4504 +     45 +      {
    4505 +     46 +        "severity": "MEDIUM",
    4506 +     47 +        "type": "Redundant Logic",
    4507 +     48 +        "location": "script.js:1241",
    4508 +     49 +        "description": "DOM generation for File Browser is hardcoded in script.js instead of being in FolderBrowserService or a View component.",
    4509 +     50 +        "remediation": "Move renderFileTree logic to a dedicated UI component."
    4510 +     51 +      },
    4511 +     52 +      {
    4512 +     53 +        "severity": "LOW",
    4513 +     54 +        "type": "Hardcoded Config",
    4514 +     55 +        "location": "script.js",
    4515 +     56 +        "description": "Some configuration values (sidebar width limits) are hardcoded in script.js, duplicating constants potential.",
    4516 +     57 +        "remediation": "Move all magic numbers to src/js/config/constants.js."
    4517 +     58 +      }
    4518 +     59 +    ]
    4519 +     60 +  },
    4520 +     61 +  "metrics": {
    4521 +     62 +    "files_reviewed": 18,
    4522 +     63 +    "lines_of_code": "~3000",
    4523 +     64 +    "critical_issues": 1,
    4524 +     65 +    "high_issues": 1,
    4525 +     66 +    "medium_issues": 2
    4526 +     67 +  }
    4527 +     68 +}
    4528 +     69  
3138 4529  
3139 4530  ```
3140 4531  
3141 4532  
3142     -### üìÑ `themes/ocean-light.css`
    4533 +### ‚ú® `codebase_audit/phase4_consolidated_findings.md` **[ADDED]**
3143 4534  
3144     -**Type:** Stylesheet üé®
    4535 +**Status:** ‚úÖ **NEW FILE** - This file has been newly created
    4536 +
    4537 +**Type:** Documentation üìñ
3145 4538  
3146 4539  ```diff
3147     -@@ -23,20 +23,49 @@
3148     - 23  23    --code-block-bg: #e0f2fe; /* Light cyan background */
3149     - 24  24    --code-border: #7dd3fc;
3150     - 25  25  
3151     - 26     -  /* Syntax Highlighting - Comprehensive Token Colors */
3152     - 27     -  --syntax-keyword: #0284c7;
3153     - 28     -  --syntax-string: #0891b2;
3154     - 29     -  --syntax-number: #06b6d4;
3155     - 30     -  --syntax-function: #22d3ee;
3156     - 31     -  --syntax-comment: #64748b;
3157     - 32     -  --syntax-operator: #0369a1;
3158     - 33     -  --syntax-punctuation: #475569;
3159     -     26 +  /* Syntax Highlighting - Production-Grade Token Colors (One Dark Architecture) */
3160     - 34  27  
3161     - 35     -  /* Additional Token Types for Full Customization */
3162     - 36     -  --syntax-variable: #0369a1; /* Variables - ocean blue */
3163     - 37     -  --syntax-property: #0891b2; /* Properties - teal */
3164     - 38     -  --syntax-namespace: #0284c7; /* Namespaces - cyan */
3165     - 39     -  --syntax-builtin: #22d3ee; /* Builtins - bright cyan */
3166     -     28 +  /* Core hue-1: Cyan - URLs */
3167     -     29 +  --syntax-url: #06b6d4; /* Bright cyan for URLs */
3168     -     30 +
3169     -     31 +  /* Core hue-2: Blue - Functions, variables */
3170     -     32 +  --syntax-function: #0284c7; /* Ocean blue for functions */
3171     -     33 +  --syntax-variable: #0369a1; /* Deep blue for variables */
3172     -     34 +
3173     -     35 +  /* Core hue-3: Purple/Violet - Keywords */
3174     -     36 +  --syntax-keyword: #7c3aed; /* Vivid purple for keywords (final, sealed, class) */
3175     -     37 +
3176     -     38 +  /* Core hue-4: Green/Teal - Strings, builtins */
3177     -     39 +  --syntax-string: #0891b2; /* Teal for strings */
3178     -     40 +  --syntax-builtin: #14b8a6; /* Bright teal for builtins (String, List) */
3179     -     41 +  --syntax-char: #0891b2; /* Same as strings */
3180     -     42 +  --syntax-regex: #0891b2; /* Same as strings */
3181     -     43 +  --syntax-inserted: #14b8a6; /* For diff */
3182     -     44 +
3183     -     45 +  /* Core hue-5: Orange/Amber - Properties, tags */
3184     -     46 +  --syntax-property: #f59e0b; /* Amber for properties */
3185     -     47 +  --syntax-tag: #ea580c; /* Orange for tags */
3186     -     48 +  --syntax-deleted: #ef4444; /* Red for diff */
3187     -     49 +  --syntax-important: #f59e0b; /* Amber for !important */
3188     -     50 +
3189     -     51 +  /* Core hue-6: Cyan - Class names, constants, numbers */
3190     -     52 +  --syntax-class-name: #22d3ee; /* Bright cyan for class names (Rectangle, Shape) */
3191     -     53 +  --syntax-number: #06b6d4; /* Cyan for numbers */
3192     -     54 +  --syntax-constant: #0891b2; /* Teal for constants */
3193     -     55 +  --syntax-boolean: #06b6d4; /* Same as numbers */
3194     -     56 +  --syntax-atrule: #22d3ee; /* Bright cyan for CSS @ rules */
3195     -     57 +
3196     -     58 +  /* Neutral colors */
3197     -     59 +  --syntax-comment: #64748b; /* Slate gray for comments */
3198     -     60 +  --syntax-punctuation: #475569; /* Dark slate for punctuation */
3199     -     61 +  --syntax-operator: #0369a1; /* Deep ocean for operators */
3200     -     62 +
3201     -     63 +  /* Markup specific */
3202     -     64 +  --syntax-attr-name: #22d3ee; /* Cyan like class-name */
3203     -     65 +  --syntax-attr-value: #0891b2; /* Teal like strings */
3204     -     66 +  --syntax-namespace: #7c3aed; /* Purple like keywords */
3205     -     67 +  --syntax-entity: #475569; /* Neutral */
3206     -     68 +  --syntax-selector: #f59e0b; /* Amber like properties */
3207     - 40  69  
3208     - 41  70    --blockquote-border: #0891b2;
3209     - 42  71    --blockquote-bg: #e0f2fe;
3210     -@@ -44,4 +73,87 @@
3211     - 44  73    --italic-color: #0891b2;
3212     - 45  74    --table-header-bg: #bae6fd;
3213     - 46  75    --table-border: #7dd3fc;
3214     -     76 +
3215     -     77 +  /* === MERMAID COMPREHENSIVE CONFIGURATION === */
3216     -     78 +
3217     -     79 +  /* Core Global */
3218     -     80 +  --mermaid-background: #f0f9ff;
3219     -     81 +  --mermaid-text-color: #0c4a6e;
3220     -     82 +  --mermaid-line-color: #0891b2;
3221     -     83 +  --mermaid-main-bkg: #bae6fd;
3222     -     84 +
3223     -     85 +  /* Primary Set */
3224     -     86 +  --mermaid-primary-color: #bae6fd;
3225     -     87 +  --mermaid-primary-text-color: #0c4a6e;
3226     -     88 +  --mermaid-primary-border-color: #0284c7;
3227     -     89 +
3228     -     90 +  /* Secondary Set */
3229     -     91 +  --mermaid-secondary-color: #e0f2fe;
3230     -     92 +  --mermaid-secondary-text-color: #0c4a6e;
3231     -     93 +  --mermaid-secondary-border-color: #0891b2;
3232     -     94 +
3233     -     95 +  /* Tertiary Set */
3234     -     96 +  --mermaid-tertiary-color: #f0f9ff;
3235     -     97 +  --mermaid-tertiary-text-color: #0c4a6e;
3236     -     98 +  --mermaid-tertiary-border-color: #06b6d4;
3237     -     99 +
3238     -    100 +  /* Flowchart */
3239     -    101 +  --mermaid-node-border: #0284c7;
3240     -    102 +  --mermaid-cluster-bkg: #e0f2fe;
3241     -    103 +  --mermaid-cluster-border: #0891b2;
3242     -    104 +  --mermaid-default-link-color: #0891b2;
3243     -    105 +  --mermaid-title-color: #0c4a6e;
3244     -    106 +  --mermaid-edge-label-background: #f0f9ff;
3245     -    107 +  --mermaid-node-text-color: #0c4a6e;
3246     -    108 +
3247     -    109 +  /* Sequence Diagram */
3248     -    110 +  --mermaid-actor-bkg: #bae6fd;
3249     -    111 +  --mermaid-actor-border: #0284c7;
3250     -    112 +  --mermaid-actor-text-color: #0c4a6e;
3251     -    113 +  --mermaid-actor-line-color: #0284c7;
3252     -    114 +  --mermaid-signal-color: #0891b2;
3253     -    115 +  --mermaid-signal-text-color: #0c4a6e;
3254     -    116 +  --mermaid-label-box-bkg-color: #bae6fd;
3255     -    117 +  --mermaid-label-box-border-color: #0284c7;
3256     -    118 +  --mermaid-label-text-color: #0c4a6e;
3257     -    119 +  --mermaid-loop-text-color: #0c4a6e;
3258     -    120 +  --mermaid-activation-border-color: #0891b2;
3259     -    121 +  --mermaid-activation-bkg-color: #e0f2fe;
3260     -    122 +  --mermaid-sequence-number-color: #0c4a6e;
3261     -    123 +
3262     -    124 +  /* Pie Chart */
3263     -    125 +  --mermaid-pie1: #0284c7;
3264     -    126 +  --mermaid-pie2: #0891b2;
3265     -    127 +  --mermaid-pie3: #06b6d4;
3266     -    128 +  --mermaid-pie4: #22d3ee;
3267     -    129 +  --mermaid-pie5: #7c3aed;
3268     -    130 +  --mermaid-pie6: #f59e0b;
3269     -    131 +  --mermaid-pie7: #14b8a6;
3270     -    132 +  --mermaid-pie8: #0369a1;
3271     -    133 +  --mermaid-pie9: #0284c7;
3272     -    134 +  --mermaid-pie10: #0891b2;
3273     -    135 +  --mermaid-pie11: #06b6d4;
3274     -    136 +  --mermaid-pie12: #22d3ee;
3275     -    137 +  --mermaid-pie-title-text-color: #0c4a6e;
3276     -    138 +  --mermaid-pie-section-text-color: #f0f9ff; /* Light on vibrant slices */
3277     -    139 +  --mermaid-pie-legend-text-color: #0c4a6e;
3278     -    140 +  --mermaid-pie-stroke-color: #0284c7;
3279     -    141 +  --mermaid-pie-outer-stroke-color: #0284c7;
3280     -    142 +
3281     -    143 +  /* State Diagram */
3282     -    144 +  --mermaid-label-color: #0c4a6e;
3283     -    145 +  --mermaid-alt-background: #e0f2fe;
3284     -    146 +
3285     -    147 +  /* Class Diagram */
3286     -    148 +  --mermaid-class-text: #0c4a6e;
3287     -    149 +
3288     -    150 +  /* User Journey */
3289     -    151 +  --mermaid-fill-type0: #0284c7;
3290     -    152 +  --mermaid-fill-type1: #0891b2;
3291     -    153 +  --mermaid-fill-type2: #06b6d4;
3292     -    154 +  --mermaid-fill-type3: #22d3ee;
3293     -    155 +  --mermaid-fill-type4: #7c3aed;
3294     -    156 +  --mermaid-fill-type5: #f59e0b;
3295     -    157 +  --mermaid-fill-type6: #14b8a6;
3296     -    158 +  --mermaid-fill-type7: #0369a1;
3297     - 47 159  }
3298     - 48 160  
    4540 +@@ -0,0 +1,31 @@
    4541 +      1 +# üß© Phase 4: Consolidated Findings
    4542 +      2 +
    4543 +      3 +This document consolidates all findings from the Codebase Review (Phase 3) and Documentation Review (Phase 2), grouped by category.
    4544 +      4 +
    4545 +      5 +## 1. Security Findings
    4546 +      6 +| ID | Severity | Issue | Location |
    4547 +      7 +|----|----------|-------|----------|
    4548 +      8 +| SEC-01 | **CRITICAL** | **Stored XSS Vulnerability**<br>Markdown renders directly to `innerHTML` without sanitization. | `script.js:512` |
    4549 +      9 +| SEC-02 | LOW | **Unencrypted Local Storage**<br>User content persists in plain text in browser storage. | `StorageManager.js` |
    4550 +     10 +| SEC-03 | LOW | **External CDN Dependency**<br>Runtime libraries loaded from third-party CDNs (jsdelivr/cdnjs). | `index.html` |
    4551 +     11 +
    4552 +     12 +## 2. Architecture & Design
    4553 +     13 +| ID | Severity | Issue | Location |
    4554 +     14 +|----|----------|-------|----------|
    4555 +     15 +| ARC-01 | **HIGH** | **Monolithic Controller**<br>`script.js` (1300+ lines) violates Single Responsibility Principle. | `script.js` |
    4556 +     16 +| ARC-02 | MEDIUM | **Tight Coupling**<br>`script.js` directly manipulates DOM, manages state, and calls services. | `script.js` |
    4557 +     17 +| ARC-03 | MEDIUM | **Race Conditions**<br>Reliance on `setTimeout` for synchronization between themes/Mermaid. | `script.js:490` |
    4558 +     18 +| ARC-04 | LOW | **Hardcoded Configuration**<br>Magic numbers (sidebar width, zoom limits) found in logic. | `script.js` |
    4559 +     19 +
    4560 +     20 +## 3. Code Quality & Maintenance
    4561 +     21 +| ID | Severity | Issue | Location |
    4562 +     22 +|----|----------|-------|----------|
    4563 +     23 +| COD-01 | MEDIUM | **No Type Safety**<br>Pure JavaScript used; logic errors (e.g. string vs number) possible. | All Files |
    4564 +     24 +| COD-02 | LOW | **Incomplete Tests**<br>Tests exist but coverage for UI interactions is manual. | `tests/` |
    4565 +     25 +| COD-03 | LOW | **Redundant Logic**<br>DOM generation for File Browse tree is inline, not reusable. | `script.js:1241` |
    4566 +     26 +
    4567 +     27 +## 4. Documentation Gaps
    4568 +     28 +| ID | Severity | Issue | Location |
    4569 +     29 +|----|----------|-------|----------|
    4570 +     30 +| DOC-01 | LOW | **Stack Mismatch**<br>README mentions Java/Python support (likely meant highlighting), implying backend. | `README.md` |
    4571 +     31 +| DOC-02 | LOW | **Install Instructions**<br>No "Install" section for local dev beyond "Open index.html". | `README.md` |
    4572 +     32  
3299 4573  
3300 4574  ```
3301 4575  
3302 4576  
3303     -### üìÑ `themes/sunset-dark.css`
    4577 +### ‚ú® `codebase_audit/phase4_implementation_plan.md` **[ADDED]**
3304 4578  
3305     -**Type:** Stylesheet üé®
    4579 +**Status:** ‚úÖ **NEW FILE** - This file has been newly created
    4580 +
    4581 +**Type:** Documentation üìñ
3306 4582  
3307 4583  ```diff
3308     -@@ -23,20 +23,49 @@
3309     - 23  23    --code-block-bg: #1c0a00;
3310     - 24  24    --code-border: #7c2d12;
3311     - 25  25  
3312     - 26     -  /* Syntax Highlighting - Comprehensive Token Colors */
3313     - 27     -  --syntax-keyword: #fb923c;
3314     - 28     -  --syntax-string: #a3e635;
3315     - 29     -  --syntax-number: #fbbf24;
3316     - 30     -  --syntax-function: #f87171;
3317     - 31     -  --syntax-comment: #78716c;
3318     - 32     -  --syntax-operator: #fdba74;
3319     - 33     -  --syntax-punctuation: #d4d4d4;
3320     -     26 +  /* Syntax Highlighting - Production-Grade Token Colors (One Dark Architecture) */
3321     - 34  27  
3322     - 35     -  /* Additional Token Types */
3323     - 36     -  --syntax-variable: #fcd34d; /* Variables - bright yellow (distinct from text #fed7aa) */
3324     - 37     -  --syntax-property: #f87171; /* Properties - coral */
3325     - 38     -  --syntax-namespace: #fb923c; /* Namespaces - sunset orange */
3326     - 39     -  --syntax-builtin: #f87171; /* Builtins - coral */
3327     -     28 +  /* Core hue-1: Cyan (187¬∞) - URLs */
3328     -     29 +  --syntax-url: #5eead4; /* Bright teal for URLs */
3329     -     30 +
3330     -     31 +  /* Core hue-2: Blue (207¬∞) - Functions, variables */
3331     -     32 +  --syntax-function: #60a5fa; /* Bright blue for functions */
3332     -     33 +  --syntax-variable: #38bdf8; /* Sky blue for variables */
    4584 +@@ -0,0 +1,71 @@
    4585 +      1 +# üõ°Ô∏è Audit Phase 4: Consolidation & Implementation Plan
    4586 +      2 +
    4587 +      3 +## üö® Critical Priority (Immediate Action Required)
    4588 +      4 +
    4589 +      5 +### 1. Fix Stored XSS Vulnerability
    4590 +      6 +- **Severity:** Critical
    4591 +      7 +- **Location:** `script.js` (Line 512)
    4592 +      8 +- **Issue:** Markdown is parsed and injected directly into `innerHTML` without sanitization. Malicious markdown files can execute arbitrary JavaScript.
    4593 +      9 +- **Action Plan:**
    4594 +     10 +  1. Install `dompurify`: `npm install dompurify`
    4595 +     11 +  2. Import it in `script.js` (or load via CDN if sticking to hybrid approach).
    4596 +     12 +  3. Wrap parsing: `preview.innerHTML = DOMPurify.sanitize(marked.parse(markdownText));`
    4597 +     13 +
    4598 +     14 +### 2. Remove Race Conditions in Threading
    4599 +     15 +- **Severity:** High
    4600 +     16 +- **Location:** `script.js` (Lines 490, 535)
    4601 +     17 +- **Issue:** `setTimeout` (100ms) used to guess when libraries are ready. This leads to flaky rendering and "pop-in" effects.
    4602 +     18 +- **Action Plan:**
    4603 +     19 +  1. Refactor `MermaidService.render()` to return a Promise that resolves *only* when rendering is complete.
    4604 +     20 +  2. Await this promise in `renderMarkdown()` instead of using `setTimeout`.
    4605 +     21 +
    4606 +     22 +---
    4607 +     23 +
    4608 +     24 +## üèóÔ∏è High Priority (Architectural Refactoring)
    4609 +     25 +
    4610 +     26 +### 3. Decompose Monolithic `script.js`
    4611 +     27 +- **Severity:** High
    4612 +     28 +- **Location:** `script.js` (1372 lines)
    4613 +     29 +- **Issue:** File violates Single Responsibility Principle. Handles initialization, event binding, UI rendering, logic, and service orchestration.
    4614 +     30 +- **Action Plan:**
    4615 +     31 +  1. **Extract `UIManager`**: Move all `document.getElementById` and UI toggling logic here.
    4616 +     32 +  2. **Extract `FileTreeView`**: Move the 200+ lines of DOM generation for the folder browser out of `script.js`.
    4617 +     33 +  3. **Extract `EventManager`**: Centralize event listener bindings.
3333 4618       34 +
3334     -     35 +  /* Core hue-3: Purple (286¬∞) - Keywords */
3335     -     36 +  --syntax-keyword: #c084fc; /* Bright purple for keywords (final, sealed, class keyword) */
3336     -     37 +
3337     -     38 +  /* Core hue-4: Green (95¬∞) - Strings, builtins */
3338     -     39 +  --syntax-string: #a3e635; /* Lime green for strings */
3339     -     40 +  --syntax-builtin: #84cc16; /* Vibrant green for builtins (String, List) */
3340     -     41 +  --syntax-char: #a3e635; /* Same as strings */
3341     -     42 +  --syntax-regex: #a3e635; /* Same as strings */
3342     -     43 +  --syntax-inserted: #a3e635; /* For diff */
3343     -     44 +
3344     -     45 +  /* Core hue-5: Red (355¬∞) - Properties, tags */
3345     -     46 +  --syntax-property: #fb7185; /* Coral rose for properties */
3346     -     47 +  --syntax-tag: #f87171; /* Coral for tags */
3347     -     48 +  --syntax-deleted: #f87171; /* For diff */
3348     -     49 +  --syntax-important: #fb7185; /* For !important */
3349     -     50 +
3350     -     51 +  /* Core hue-6: Orange (29¬∞) - Class names, constants, numbers */
3351     -     52 +  --syntax-class-name: #fb923c; /* Bright sunset orange for class names (Rectangle, Shape) */
3352     -     53 +  --syntax-number: #fbbf24; /* Golden yellow for numbers */
3353     -     54 +  --syntax-constant: #f97316; /* Burnt orange for constants */
3354     -     55 +  --syntax-boolean: #fbbf24; /* Same as numbers */
3355     -     56 +  --syntax-atrule: #fb923c; /* CSS @ rules */
3356     -     57 +
3357     -     58 +  /* Neutral colors */
3358     -     59 +  --syntax-comment: #a8a29e; /* Muted for comments */
3359     -     60 +  --syntax-punctuation: #d4d4d8; /* Light gray for punctuation */
3360     -     61 +  --syntax-operator: #fdba74; /* Light sunset for operators */
3361     -     62 +
3362     -     63 +  /* Markup specific */
3363     -     64 +  --syntax-attr-name: #fb923c; /* Orange like class-name */
3364     -     65 +  --syntax-attr-value: #a3e635; /* Green like strings */
3365     -     66 +  --syntax-namespace: #c084fc; /* Purple like keywords */
3366     -     67 +  --syntax-entity: #d4d4d8; /* Neutral */
3367     -     68 +  --syntax-selector: #fb7185; /* Red like properties */
3368     - 40  69  
3369     - 41  70    --blockquote-border: #f97316;
3370     - 42  71    --blockquote-bg: #2d1b0e;
3371     -@@ -44,4 +73,87 @@
3372     - 44  73    --italic-color: #fb923c;
3373     - 45  74    --table-header-bg: #3d2417;
3374     - 46  75    --table-border: #7c2d12;
3375     -     76 +
3376     -     77 +  /* === MERMAID COMPREHENSIVE CONFIGURATION === */
3377     -     78 +
3378     -     79 +  /* Core Global */
3379     -     80 +  --mermaid-background: #1c0a00;
3380     -     81 +  --mermaid-text-color: #fed7aa;
3381     -     82 +  --mermaid-line-color: #f97316;
3382     -     83 +  --mermaid-main-bkg: #3d2417;
3383     -     84 +
3384     -     85 +  /* Primary Set */
3385     -     86 +  --mermaid-primary-color: #3d2417;
3386     -     87 +  --mermaid-primary-text-color: #fed7aa;
3387     -     88 +  --mermaid-primary-border-color: #fb923c;
3388     -     89 +
3389     -     90 +  /* Secondary Set */
3390     -     91 +  --mermaid-secondary-color: #2d1b0e;
3391     -     92 +  --mermaid-secondary-text-color: #fed7aa;
3392     -     93 +  --mermaid-secondary-border-color: #f97316;
3393     -     94 +
3394     -     95 +  /* Tertiary Set */
3395     -     96 +  --mermaid-tertiary-color: #1c0a00;
3396     -     97 +  --mermaid-tertiary-text-color: #fed7aa;
3397     -     98 +  --mermaid-tertiary-border-color: #ea580c;
3398     -     99 +
3399     -    100 +  /* Flowchart */
3400     -    101 +  --mermaid-node-border: #fb923c;
3401     -    102 +  --mermaid-cluster-bkg: #2d1b0e;
3402     -    103 +  --mermaid-cluster-border: #f97316;
3403     -    104 +  --mermaid-default-link-color: #f97316;
3404     -    105 +  --mermaid-title-color: #fed7aa;
3405     -    106 +  --mermaid-edge-label-background: #1c0a00;
3406     -    107 +  --mermaid-node-text-color: #fed7aa;
3407     -    108 +
3408     -    109 +  /* Sequence Diagram */
3409     -    110 +  --mermaid-actor-bkg: #3d2417;
3410     -    111 +  --mermaid-actor-border: #fb923c;
3411     -    112 +  --mermaid-actor-text-color: #fed7aa;
3412     -    113 +  --mermaid-actor-line-color: #fb923c;
3413     -    114 +  --mermaid-signal-color: #f97316;
3414     -    115 +  --mermaid-signal-text-color: #fed7aa;
3415     -    116 +  --mermaid-label-box-bkg-color: #3d2417;
3416     -    117 +  --mermaid-label-box-border-color: #fb923c;
3417     -    118 +  --mermaid-label-text-color: #fed7aa;
3418     -    119 +  --mermaid-loop-text-color: #fed7aa;
3419     -    120 +  --mermaid-activation-border-color: #f97316;
3420     -    121 +  --mermaid-activation-bkg-color: #2d1b0e;
3421     -    122 +  --mermaid-sequence-number-color: #fed7aa;
3422     -    123 +
3423     -    124 +  /* Pie Chart */
3424     -    125 +  --mermaid-pie1: #fb923c;
3425     -    126 +  --mermaid-pie2: #f97316;
3426     -    127 +  --mermaid-pie3: #ea580c;
3427     -    128 +  --mermaid-pie4: #f87171;
3428     -    129 +  --mermaid-pie5: #fb7185;
3429     -    130 +  --mermaid-pie6: #f472b6;
3430     -    131 +  --mermaid-pie7: #fdba74;
3431     -    132 +  --mermaid-pie8: #5eead4;
3432     -    133 +  --mermaid-pie9: #60a5fa;
3433     -    134 +  --mermaid-pie10: #c084fc;
3434     -    135 +  --mermaid-pie11: #a3e635;
3435     -    136 +  --mermaid-pie12: #fbbf24;
3436     -    137 +  --mermaid-pie-title-text-color: #fed7aa;
3437     -    138 +  --mermaid-pie-section-text-color: #1c0a00; /* Dark on vibrant slices */
3438     -    139 +  --mermaid-pie-legend-text-color: #fed7aa;
3439     -    140 +  --mermaid-pie-stroke-color: #fb923c;
3440     -    141 +  --mermaid-pie-outer-stroke-color: #fb923c;
3441     -    142 +
3442     -    143 +  /* State Diagram */
3443     -    144 +  --mermaid-label-color: #fed7aa;
3444     -    145 +  --mermaid-alt-background: #2d1b0e;
3445     -    146 +
3446     -    147 +  /* Class Diagram */
3447     -    148 +  --mermaid-class-text: #fed7aa;
3448     -    149 +
3449     -    150 +  /* User Journey */
3450     -    151 +  --mermaid-fill-type0: #fb923c;
3451     -    152 +  --mermaid-fill-type1: #f97316;
3452     -    153 +  --mermaid-fill-type2: #ea580c;
3453     -    154 +  --mermaid-fill-type3: #f87171;
3454     -    155 +  --mermaid-fill-type4: #fb7185;
3455     -    156 +  --mermaid-fill-type5: #f472b6;
3456     -    157 +  --mermaid-fill-type6: #fdba74;
3457     -    158 +  --mermaid-fill-type7: #5eead4;
3458     - 47 159  }
3459     - 48 160  
    4619 +     35 +### 4. Standardize Dependency Management
    4620 +     36 +- **Severity:** Medium
    4621 +     37 +- **Location:** `index.html`
    4622 +     38 +- **Issue:** Runtime dependencies (Marked, Prism, Mermaid, KaTeX) are loaded via CDNs, while dev tools are in `package.json`. This creates a fragility where internet access is required for the "local" app to run.
    4623 +     39 +- **Action Plan:**
    4624 +     40 +  1. Install runtime deps: `npm install marked prismjs mermaid katex html2pdf.js`
    4625 +     41 +  2. Update `vite.config.js` to bundle these assets.
    4626 +     42 +  3. Remove CDN links from `index.html`.
    4627 +     43 +
    4628 +     44 +---
    4629 +     45 +
    4630 +     46 +## üßπ Medium Priority (Cleanup)
    4631 +     47 +
    4632 +     48 +### 5. Update Documentation
    4633 +     49 +- **Severity:** Low
    4634 +     50 +- **Location:** `README.md`
    4635 +     51 +- **Issue:** Documentation mentions Java/Python support, implying backend code, but the repo is purely static frontend.
    4636 +     52 +- **Action Plan:**
    4637 +     53 +  1. Clarify "Client-Side Only" architecture in README.
    4638 +     54 +  2. Update "Tech Stack" section to reflect actual discovered files.
    4639 +     55 +
    4640 +     56 +### 6. Centralize Configuration
    4641 +     57 +- **Severity:** Low
    4642 +     58 +- **Issue:** Some magic numbers (sidebar widths, zoom limits) are still hardcoded in `script.js`.
    4643 +     59 +- **Action Plan:**
    4644 +     60 +  1. Move all remaining constants to `src/js/config/constants.js`.
    4645 +     61 +
    4646 +     62 +---
    4647 +     63 +
    4648 +     64 +## üìÖ Roadmap
    4649 +     65 +
    4650 +     66 +| Phase | Task | Est. Effort |
    4651 +     67 +|-------|------|-------------|
    4652 +     68 +| **Week 1** | Security Fixes (XSS) + `setTimeout` Removal | 1 Day |
    4653 +     69 +| **Week 2** | Split `script.js` -> `UIManager`, `AppController` | 3 Days |
    4654 +     70 +| **Week 3** | Dependency Migration (CDN -> NPM) | 2 Days |
    4655 +     71 +| **Week 4** | Documentation & Final Polish | 1 Day |
    4656 +     72  
3460 4657  
3461 4658  ```
3462 4659  
3463 4660  
3464     -### üìÑ `themes/sunset-light.css`
    4661 +### ‚ú® `codebase_audit/phase5_recommendations.md` **[ADDED]**
3465 4662  
3466     -**Type:** Stylesheet üé®
    4663 +**Status:** ‚úÖ **NEW FILE** - This file has been newly created
    4664 +
    4665 +**Type:** Documentation üìñ
3467 4666  
3468 4667  ```diff
3469     -@@ -23,20 +23,49 @@
3470     - 23  23    --code-block-bg: #ffedd5; /* Light orange background */
3471     - 24  24    --code-border: #fdba74;
3472     - 25  25  
3473     - 26     -  /* Syntax Highlighting - Comprehensive Token Colors */
3474     - 27     -  --syntax-keyword: #ea580c;
3475     - 28     -  --syntax-string: #16a34a;
3476     - 29     -  --syntax-number: #f59e0b;
3477     - 30     -  --syntax-function: #dc2626;
3478     - 31     -  --syntax-comment: #78716c;
3479     - 32     -  --syntax-operator: #c2410c;
3480     - 33     -  --syntax-punctuation: #57534e;
3481     -     26 +  /* Syntax Highlighting - Production-Grade Token Colors (Based on One Dark Architecture) */
3482     - 34  27  
3483     - 35     -  /* Additional Token Types for Full Customization */
3484     - 36     -  --syntax-variable: #ea580c; /* Variables - sunset orange */
3485     - 37     -  --syntax-property: #dc2626; /* Properties - red */
3486     - 38     -  --syntax-namespace: #f97316; /* Namespaces - bright orange */
3487     - 39     -  --syntax-builtin: #dc2626; /* Builtins - red */
3488     -     28 +  /* Core hue-1: Cyan (187¬∞) - URLs, special strings */
3489     -     29 +  --syntax-url: #14b8a6; /* Teal/cyan for URLs */
3490     -     30 +
3491     -     31 +  /* Core hue-2: Blue (207¬∞) - Functions, variables, operators */
3492     -     32 +  --syntax-function: #3b82f6; /* Bright blue for functions */
3493     -     33 +  --syntax-variable: #0ea5e9; /* Sky blue for variables */
3494     -     34 +
3495     -     35 +  /* Core hue-3: Purple (286¬∞) - Keywords */
3496     -     36 +  --syntax-keyword: #a855f7; /* Vibrant purple for keywords (if, final, sealed) */
    4668 +@@ -0,0 +1,41 @@
    4669 +      1 +# üí° Phase 5: Recommendations & Roadmap
    4670 +      2 +
    4671 +      3 +Based on the consolidated findings, here are the strategic recommendations for the `markdown-viewer-app`.
    4672 +      4 +
    4673 +      5 +## üß† Strategic Recommendations
    4674 +      6 +
    4675 +      7 +### 1. Security Hardening (Immediate)
    4676 +      8 +*   **Mitigate XSS:** The application **must** integrate a sanitization library (e.g., `DOMPurify`) before rendering any Markdown content. This is non-negotiable for a viewer app.
    4677 +      9 +*   **Content Security Policy (CSP):** Implement a strict CSP in `index.html` to prevent unauthorized script execution, especially since we rely on CDNs.
    4678 +     10 +
    4679 +     11 +### 2. Architectural Refactoring (Short Term)
    4680 +     12 +*   **Adopt MVC/MVVM:** Move away from the "Giant Script" pattern.
    4681 +     13 +    *   **Model:** `StorageManager.js` (Already exists, good).
    4682 +     14 +    *   **View:** Create `UIManager.js` to handle all DOM updates.
    4683 +     15 +    *   **Controller:** Slim down `script.js` to only handle event orchestration.
    4684 +     16 +*   **Event-Driven Architecture:** Expand the `ThemeManager`'s observer pattern to a global `EventManager` to decouple components.
    4685 +     17 +
    4686 +     18 +### 3. Modernization (Medium Term)
    4687 +     19 +*   **Migrate to TypeScript:** The project checks for TS in `package.json` but uses JS. Migrating to TypeScript will eliminate type-related bugs and self-document the code.
    4688 +     20 +*   **Bundle Management:** Move from CDN links in `index.html` to a built bundle (Vite). This ensures the app works offline (a key value prop) and stabilizes dependency versions.
    4689 +     21 +
    4690 +     22 +### 4. Quality Assurance (Long Term)
    4691 +     23 +*   **Automated E2E Testing:** Implement Playwright or Cypress tests to verify the "Sync Scroll" and "Theme Switching" features automatically, reducing manual testing burden.
    4692 +     24 +
    4693 +     25 +## üó∫Ô∏è Proposed Roadmap
    4694 +     26 +
    4695 +     27 +### Phase A: Stability & Security (Week 1)
    4696 +     28 +- [ ] Install `dompurify`
    4697 +     29 +- [ ] Implement input sanitization
    4698 +     30 +- [ ] Replace `setTimeout` with `Promise` chains
    4699 +     31 +- [ ] Fix race conditions in Theme/Mermaid loading
    4700 +     32 +
    4701 +     33 +### Phase B: decoupling (Week 2)
    4702 +     34 +- [ ] Extract `FolderBrowser` logic to `src/js/components/FileTree.js`
    4703 +     35 +- [ ] Extract global event listeners to `src/js/core/EventManager.js`
    4704 +     36 +- [ ] Refactor `script.js` to use these new modules
3497 4705       37 +
3498     -     38 +  /* Core hue-4: Green (95¬∞) - Strings, builtins, inserted */
3499     -     39 +  --syntax-string: #10b981; /* Emerald green for strings */
3500     -     40 +  --syntax-builtin: #059669; /* Darker green for builtins (String, List, Array) */
3501     -     41 +  --syntax-char: #10b981; /* Same as strings */
3502     -     42 +  --syntax-regex: #10b981; /* Same as strings */
3503     -     43 +  --syntax-inserted: #10b981; /* For diff highlights */
3504     -     44 +
3505     -     45 +  /* Core hue-5: Red (355¬∞) - Properties, tags, deleted, important */
3506     -     46 +  --syntax-property: #ef4444; /* Red for properties */
3507     -     47 +  --syntax-tag: #ef4444; /* Red for HTML tags */
3508     -     48 +  --syntax-deleted: #ef4444; /* For diff highlights */
3509     -     49 +  --syntax-important: #ef4444; /* For !important */
3510     -     50 +
3511     -     51 +  /* Core hue-6: Orange (29¬∞) - Class names, constants, numbers, atrules */
3512     -     52 +  --syntax-class-name: #f97316; /* Orange for class/type names (Rectangle, Shape) */
3513     -     53 +  --syntax-number: #fb923c; /* Bright orange for numbers */
3514     -     54 +  --syntax-constant: #ea580c; /* Burnt orange for constants */
3515     -     55 +  --syntax-boolean: #fb923c; /* Same as numbers */
3516     -     56 +  --syntax-atrule: #fb923c; /* CSS @ rules */
3517     -     57 +
3518     -     58 +  /* Neutral colors */
3519     -     59 +  --syntax-comment: #a8a29e; /* Muted stone for comments */
3520     -     60 +  --syntax-punctuation: #64748b; /* Slate for punctuation */
3521     -     61 +  --syntax-operator: #fb7185; /* Coral rose for operators */
3522     -     62 +
3523     -     63 +  /* Markup specific */
3524     -     64 +  --syntax-attr-name: #f97316; /* Orange like class-name */
3525     -     65 +  --syntax-attr-value: #10b981; /* Green like strings */
3526     -     66 +  --syntax-namespace: #a855f7; /* Purple like keywords */
3527     -     67 +  --syntax-entity: #64748b; /* Neutral */
3528     -     68 +  --syntax-selector: #ef4444; /* Red like properties */
3529     - 40  69  
3530     - 41  70    --blockquote-border: #f97316;
3531     - 42  71    --blockquote-bg: #ffedd5;
3532     -@@ -44,4 +73,87 @@
3533     - 44  73    --italic-color: #e11d48;
3534     - 45  74    --table-header-bg: #fed7aa;
3535     - 46  75    --table-border: #fdba74;
3536     -     76 +
3537     -     77 +  /* === MERMAID COMPREHENSIVE CONFIGURATION === */
3538     -     78 +
3539     -     79 +  /* Core Global */
3540     -     80 +  --mermaid-background: #fff7ed;
3541     -     81 +  --mermaid-text-color: #431407;
3542     -     82 +  --mermaid-line-color: #f97316;
3543     -     83 +  --mermaid-main-bkg: #fed7aa;
3544     -     84 +
3545     -     85 +  /* Primary Set */
3546     -     86 +  --mermaid-primary-color: #fed7aa;
3547     -     87 +  --mermaid-primary-text-color: #431407;
3548     -     88 +  --mermaid-primary-border-color: #ea580c;
3549     -     89 +
3550     -     90 +  /* Secondary Set */
3551     -     91 +  --mermaid-secondary-color: #ffedd5;
3552     -     92 +  --mermaid-secondary-text-color: #431407;
3553     -     93 +  --mermaid-secondary-border-color: #f97316;
3554     -     94 +
3555     -     95 +  /* Tertiary Set */
3556     -     96 +  --mermaid-tertiary-color: #fff7ed;
3557     -     97 +  --mermaid-tertiary-text-color: #431407;
3558     -     98 +  --mermaid-tertiary-border-color: #fb923c;
3559     -     99 +
3560     -    100 +  /* Flowchart */
3561     -    101 +  --mermaid-node-border: #ea580c;
3562     -    102 +  --mermaid-cluster-bkg: #ffedd5;
3563     -    103 +  --mermaid-cluster-border: #f97316;
3564     -    104 +  --mermaid-default-link-color: #f97316;
3565     -    105 +  --mermaid-title-color: #431407;
3566     -    106 +  --mermaid-edge-label-background: #fff7ed;
3567     -    107 +  --mermaid-node-text-color: #431407;
3568     -    108 +
3569     -    109 +  /* Sequence Diagram */
3570     -    110 +  --mermaid-actor-bkg: #fed7aa;
3571     -    111 +  --mermaid-actor-border: #ea580c;
3572     -    112 +  --mermaid-actor-text-color: #431407;
3573     -    113 +  --mermaid-actor-line-color: #ea580c;
3574     -    114 +  --mermaid-signal-color: #f97316;
3575     -    115 +  --mermaid-signal-text-color: #431407;
3576     -    116 +  --mermaid-label-box-bkg-color: #fed7aa;
3577     -    117 +  --mermaid-label-box-border-color: #ea580c;
3578     -    118 +  --mermaid-label-text-color: #431407;
3579     -    119 +  --mermaid-loop-text-color: #431407;
3580     -    120 +  --mermaid-activation-border-color: #f97316;
3581     -    121 +  --mermaid-activation-bkg-color: #ffedd5;
3582     -    122 +  --mermaid-sequence-number-color: #431407;
3583     -    123 +
3584     -    124 +  /* Pie Chart */
3585     -    125 +  --mermaid-pie1: #ea580c;
3586     -    126 +  --mermaid-pie2: #f97316;
3587     -    127 +  --mermaid-pie3: #fb923c;
3588     -    128 +  --mermaid-pie4: #dc2626;
3589     -    129 +  --mermaid-pie5: #e11d48;
3590     -    130 +  --mermaid-pie6: #db2777;
3591     -    131 +  --mermaid-pie7: #c2410c;
3592     -    132 +  --mermaid-pie8: #14b8a6;
3593     -    133 +  --mermaid-pie9: #3b82f6;
3594     -    134 +  --mermaid-pie10: #a855f7;
3595     -    135 +  --mermaid-pie11: #ef4444;
3596     -    136 +  --mermaid-pie12: #10b981;
3597     -    137 +  --mermaid-pie-title-text-color: #431407;
3598     -    138 +  --mermaid-pie-section-text-color: #fff7ed; /* Light on vibrant slices */
3599     -    139 +  --mermaid-pie-legend-text-color: #431407;
3600     -    140 +  --mermaid-pie-stroke-color: #ea580c;
3601     -    141 +  --mermaid-pie-outer-stroke-color: #ea580c;
3602     -    142 +
3603     -    143 +  /* State Diagram */
3604     -    144 +  --mermaid-label-color: #431407;
3605     -    145 +  --mermaid-alt-background: #ffedd5;
3606     -    146 +
3607     -    147 +  /* Class Diagram */
3608     -    148 +  --mermaid-class-text: #431407;
3609     -    149 +
3610     -    150 +  /* User Journey */
3611     -    151 +  --mermaid-fill-type0: #ea580c;
3612     -    152 +  --mermaid-fill-type1: #f97316;
3613     -    153 +  --mermaid-fill-type2: #fb923c;
3614     -    154 +  --mermaid-fill-type3: #dc2626;
3615     -    155 +  --mermaid-fill-type4: #e11d48;
3616     -    156 +  --mermaid-fill-type5: #db2777;
3617     -    157 +  --mermaid-fill-type6: #c2410c;
3618     -    158 +  --mermaid-fill-type7: #14b8a6;
3619     - 47 159  }
3620     - 48 160  
    4706 +     38 +### Phase C: Infrastructure (Week 3)
    4707 +     39 +- [ ] Migrate runtime deps (Marked, Mermaid) to `npm`
    4708 +     40 +- [ ] Configure Vite for production bundling
    4709 +     41 +- [ ] Set up basic E2E tests for critical paths (Render, Export)
    4710 +     42  
    4711 +
    4712 +```
    4713 +
    4714 +
    4715 +### ‚ú® `codebase_audit/phase6_final_deliverables.md` **[ADDED]**
    4716 +
    4717 +**Status:** ‚úÖ **NEW FILE** - This file has been newly created
    4718 +
    4719 +**Type:** Documentation üìñ
    4720 +
    4721 +```diff
    4722 +@@ -0,0 +1,44 @@
    4723 +      1 +# üì¶ Phase 6: Final Deliverables
    4724 +      2 +
    4725 +      3 +## 1. Audit Summary
    4726 +      4 +The `markdown-viewer-app` is a capable, feature-rich static web application. It delivers on its core promise of "no set-up" markdown viewing. However, it carries significant **Technical Debt** in its control structure (`script.js`) and a **Critical Security Vulnerability** that makes it unsafe for handling untrusted files.
    4727 +      5 +
    4728 +      6 +## 2. Test Strategy Outline
    4729 +      7 +To ensure quality during the proposed refactoring, we recommend the following test strategy:
    4730 +      8 +
    4731 +      9 +*   **Unit Tests (Vitest):**
    4732 +     10 +    *   Cover `StorageManager` (Data persistence).
    4733 +     11 +    *   Cover `ThemeManager` (Logic correctness).
    4734 +     12 +    *   Cover `Sanitization` (Verify malicious inputs are stripped).
    4735 +     13 +*   **Integration Tests:**
    4736 +     14 +    *   Verify `MermaidService` correctly loads config from `ThemeManager`.
    4737 +     15 +*   **Manual Acceptance Tests:**
    4738 +     16 +    *   "The Scroll Sync Test": Verify proportional scrolling in split view.
    4739 +     17 +    *   "The Theme Switch Test": Verify no "flash of white" or broken diagrams on switch.
    4740 +     18 +
    4741 +     19 +## 3. Stakeholder Slide-Deck Outline
    4742 +     20 +
    4743 +     21 +**Slide 1: Title**
    4744 +     22 +*   **audit Report: Markdown Viewer Pro**
    4745 +     23 +*   *Status: Critical Issues Found*
    4746 +     24 +
    4747 +     25 +**Slide 2: The Good**
    4748 +     26 +*   Zero-config, runs everywhere.
    4749 +     27 +*   Modular Service layer (Mermaid, Prism, PDF) is well-designed.
    4750 +     28 +*   Excellent Documentation.
    4751 +     29 +
    4752 +     30 +**Slide 3: The Bad (Critical Findings)**
    4753 +     31 +*   **Security:** XSS Vulnerability (Malicious MD files can hack users).
    4754 +     32 +*   **Stability:** Race conditions cause occasional rendering glitches.
    4755 +     33 +
    4756 +     34 +**Slide 4: The Ugly (Tech Debt)**
    4757 +     35 +*   `script.js` is a "God Object" (1300+ lines).
    4758 +     36 +*   Hard to maintain or extend without accidental breakage.
    4759 +     37 +
    4760 +     38 +**Slide 5: The Plan**
    4761 +     39 +*   **Immediate:** Fix Security.
    4762 +     40 +*   **Next:** Refactor Controller.
    4763 +     41 +*   **Future:** TypeScript & Bundling.
    4764 +     42 +
    4765 +     43 +**Slide 6: Approval Request**
    4766 +     44 +*   Requesting approval to proceed with Phase A (Security Fixes).
    4767 +     45  
    4768 +
    4769 +```
    4770 +
    4771 +
    4772 +### ‚ú® `codebase_audit/repo_manifest.json` **[ADDED]**
    4773 +
    4774 +**Status:** ‚úÖ **NEW FILE** - This file has been newly created
    4775 +
    4776 +**Type:** Configuration/Data File üìã
    4777 +
    4778 +```diff
    4779 +@@ -0,0 +1,74 @@
    4780 +      1 +{
    4781 +      2 +  "documentation": [
    4782 +      3 +    "AI_REVIEW.md",
    4783 +      4 +    "MARKDOWN_TEST.md",
    4784 +      5 +    "QUICK-REFERENCE.md",
    4785 +      6 +    "README.md",
    4786 +      7 +    "docs/01-requirements/folder-browser-feature-plan.md",
    4787 +      8 +    "docs/01-requirements/math-rendering-feature-plan.md",
    4788 +      9 +    "docs/01-requirements/pdf-export-plan.md",
    4789 +     10 +    "docs/01-requirements/pdf-viewer-feature-plan.md",
    4790 +     11 +    "docs/02-architecture/architecture-review.md",
    4791 +     12 +    "docs/02-architecture/architecture.md",
    4792 +     13 +    "docs/02-architecture/mermaid-theme-architecture.md",
    4793 +     14 +    "docs/02-architecture/phase6-improvements.md",
    4794 +     15 +    "docs/02-architecture/prism-token-architecture.md",
    4795 +     16 +    "docs/02-architecture/syntax-highlighting-architecture.md",
    4796 +     17 +    "docs/05-implementation/implementation-plan.md",
    4797 +     18 +    "docs/05-implementation/refactoring-guide.md",
    4798 +     19 +    "docs/05-implementation/refactoring-strategy.md",
    4799 +     20 +    "docs/05-implementation/week6-final-integration.md",
    4800 +     21 +    "docs/08-deployment/deployment.md",
    4801 +     22 +    "docs/08-deployment/github-pages-deployment.md",
    4802 +     23 +    "memory-bank/activeContext.md",
    4803 +     24 +    "memory-bank/productContext.md",
    4804 +     25 +    "memory-bank/progress.md",
    4805 +     26 +    "memory-bank/projectbrief.md",
    4806 +     27 +    "memory-bank/systemPatterns.md",
    4807 +     28 +    "memory-bank/techContext.md"
    4808 +     29 +  ],
    4809 +     30 +  "source_code": {
    4810 +     31 +    "javascript": [
    4811 +     32 +      "script.js",
    4812 +     33 +      "src/js/services/MermaidService.js",
    4813 +     34 +      "src/js/services/FolderBrowserService.js",
    4814 +     35 +      "src/js/services/PDFService.js",
    4815 +     36 +      "src/js/services/PrismService.js",
    4816 +     37 +      "src/js/utils/htmlHelpers.js",
    4817 +     38 +      "src/js/utils/colorHelpers.js",
    4818 +     39 +      "src/js/utils/validators.js",
    4819 +     40 +      "src/js/config/featureFlags.js",
    4820 +     41 +      "src/js/config/constants.js",
    4821 +     42 +      "src/js/core/ThemeManager.js",
    4822 +     43 +      "src/js/core/StorageManager.js"
    4823 +     44 +    ],
    4824 +     45 +    "css": [
    4825 +     46 +      "style.css",
    4826 +     47 +      "themes/obsidian-light.css",
    4827 +     48 +      "themes/ocean-light.css",
    4828 +     49 +      "themes/sunset-light.css",
    4829 +     50 +      "themes/default-light.css",
    4830 +     51 +      "themes/obsidian-dark.css",
    4831 +     52 +      "themes/sunset-dark.css",
    4832 +     53 +      "themes/neon-light.css",
    4833 +     54 +      "themes/forest-light.css",
    4834 +     55 +      "themes/forest-dark.css",
    4835 +     56 +      "themes/ocean-dark.css",
    4836 +     57 +      "themes/neon-dark.css",
    4837 +     58 +      "themes/default-dark.css"
    4838 +     59 +    ],
    4839 +     60 +    "html": [
    4840 +     61 +      "index.html"
    4841 +     62 +    ]
    4842 +     63 +  },
    4843 +     64 +  "config": [
    4844 +     65 +    ".clinerules",
    4845 +     66 +    ".eslintrc.js",
    4846 +     67 +    ".gitignore",
    4847 +     68 +    ".prettierrc",
    4848 +     69 +    "package.json",
    4849 +     70 +    "vite.config.js",
    4850 +     71 +    "vitest.config.js",
    4851 +     72 +    "tests/setup.js"
    4852 +     73 +  ]
    4853 +     74 +}
    4854 +     75  
3621 4855  
3622 4856  ```
3623 4857  
@@ -3663,4 +4897,4 @@ Please provide specific feedback on:
3663 4897  
3664 4898  ---
3665 4899  *Generated by AI Visual Code Review v2.0 - Unified Export Script*
3666     -*Files processed: 18/18 | Errors: 0 | Generated: 2025-12-07T04:29:24.609Z*
    4900 +*Files processed: 13/13 | Errors: 0 | Generated: 2025-12-09T01:32:01.029Z*
3667 4901  

```


### üìÑ `package-lock.json`

**Type:** Configuration/Data File üìã

```diff
@@ -9,6 +9,7 @@
  9   9        "version": "0.1.0",
 10  10        "license": "MIT",
 11  11        "dependencies": {
     12 +        "dompurify": "3.3.1",
 12  13          "marked-footnote": "1.4.0"
 13  14        },
 14  15        "devDependencies": {
@@ -1280,6 +1281,13 @@
1280 1281        "dev": true,
1281 1282        "license": "MIT"
1282 1283      },
    1284 +    "node_modules/@types/trusted-types": {
    1285 +      "version": "2.0.7",
    1286 +      "resolved": "https://registry.npmjs.org/@types/trusted-types/-/trusted-types-2.0.7.tgz",
    1287 +      "integrity": "sha512-ScaPdn1dQczgbl0QFTeTOmVHFULt394XJgOQNoyVhZ6r2vLnMLJfBPd53SB52T/3G36VI1/g2MZaX0cwDuXsfw==",
    1288 +      "license": "MIT",
    1289 +      "optional": true
    1290 +    },
1283 1291      "node_modules/@vitest/coverage-v8": {
1284 1292        "version": "4.0.8",
1285 1293        "resolved": "https://registry.npmjs.org/@vitest/coverage-v8/-/coverage-v8-4.0.8.tgz",
@@ -1932,6 +1940,15 @@
1932 1940          "npm": "1.2.8000 || >= 1.4.16"
1933 1941        }
1934 1942      },
    1943 +    "node_modules/dompurify": {
    1944 +      "version": "3.3.1",
    1945 +      "resolved": "https://registry.npmjs.org/dompurify/-/dompurify-3.3.1.tgz",
    1946 +      "integrity": "sha512-qkdCKzLNtrgPFP1Vo+98FRzJnBRGe4ffyCea9IwHB1fyxPOeNTHpLKYGd4Uk9xvNoH0ZoOjwZxNptyMwqrId1Q==",
    1947 +      "license": "(MPL-2.0 OR Apache-2.0)",
    1948 +      "optionalDependencies": {
    1949 +        "@types/trusted-types": "^2.0.7"
    1950 +      }
    1951 +    },
1935 1952      "node_modules/dunder-proto": {
1936 1953        "version": "1.0.1",
1937 1954        "resolved": "https://registry.npmjs.org/dunder-proto/-/dunder-proto-1.0.1.tgz",
1938 1955  

```


### üìÑ `package.json`

**Type:** Configuration/Data File üìã

```diff
@@ -41,6 +41,7 @@
 41  41      "vitest": "4.0.8"
 42  42    },
 43  43    "dependencies": {
     44 +    "dompurify": "3.3.1",
 44  45      "marked-footnote": "1.4.0"
 45  46    }
 46  47  }
 47  48  

```


### üìÑ `script.js`

**Type:** JavaScript Source File üü®

```diff
@@ -7,6 +7,7 @@ import { FolderBrowserService } from './src/js/services/FolderBrowserService.js'
  7   7  import { MermaidService } from './src/js/services/MermaidService.js';
  8   8  import { PDFService } from './src/js/services/PDFService.js';
  9   9  import { PrismService } from './src/js/services/PrismService.js';
     10 +import DOMPurify from 'dompurify';
 10  11  
 11  12  // Initialize services and managers
 12  13  const storageManager = new StorageManager();
@@ -94,6 +95,23 @@ function initializeApp() {
 94  95    setupEditor();
 95  96  }
 96  97  
     98 +/**
     99 + * Debounce utility function
    100 + * @param {Function} func - Function to debounce
    101 + * @param {number} wait - Wait time in milliseconds
    102 + * @returns {Function} Debounced function
    103 + */
    104 +function debounce(func, wait) {
    105 +  let timeout;
    106 +  return function truncated(...args) {
    107 +    const context = this;
    108 +    clearTimeout(timeout);
    109 +    timeout = setTimeout(() => {
    110 +      func.apply(context, args);
    111 +    }, wait);
    112 +  };
    113 +}
    114 +
 97 115  // Configure marked.js extensions (math + footnotes + admonitions)
 98 116  function configureMarkedExtensions() {
 99 117    // Enable footnote support
@@ -507,98 +525,107 @@ graph TD
507 525            }, 100);
508 526            return `<div class="mermaid" id="${id}">${code}</div>`;
509 527          }
    528 +        }
510 529        );
511 530  
512     -      preview.innerHTML = html;
513     -
514     -      // Apply Prism syntax highlighting using PrismService
515     -      prismService.highlightAll(preview);
516     -
517     -      // NOTE: KaTeX auto-render is DISABLED
518     -      // We handle all math via marked.js extensions ($...$ and $$...$$)
519     -      // KaTeX auto-render was causing issues with unsupported LaTeX environments
520     -
521     -      // Save content using StorageManager
522     -      storageManager.set('markdownContent', markdownText);
523     -    } catch (error) {
524     -      console.error('Render error:', error);
525     -      preview.innerHTML =
526     -        '<p style="color: red;">Error rendering markdown: ' + error.message + '</p>';
527     -    }
528     -  }
529     -
530     -  // Change theme using ThemeManager
531     -  async function changeTheme(themeName) {
532     -    await themeManager.loadTheme(themeName);
533     -
534     -    // Wait for theme to load, then reinitialize Mermaid and force re-render
535     -    setTimeout(() => {
536     -      // Clear existing Mermaid diagrams to force fresh render with new colors
537     -      const mermaidElements = preview.querySelectorAll('.mermaid');
538     -      mermaidElements.forEach(el => {
539     -        // Reset to original code to force re-render
540     -        el.innerHTML = el.dataset.originalCode || '';
541     -      });
542     -
543     -      // Re-render markdown with new theme
544     -      renderMarkdown();
545     -    }, 100);
546     -  }
547     -
548     -  // Initialize color inputs
549     -  function initColorInputs() {
550     -    document.querySelectorAll('.color-control input[type="color"]').forEach(input => {
551     -      const varName = input.dataset.var;
552     -      const textInput = document.getElementById(input.id + '-text');
553     -      const currentValue = getComputedStyle(document.documentElement)
554     -        .getPropertyValue(varName)
555     -        .trim();
556     -
557     -      input.value = currentValue;
558     -      textInput.value = currentValue;
559     -
560     -      input.addEventListener('input', e => {
561     -        const color = e.target.value;
562     -        document.documentElement.style.setProperty(varName, color);
563     -        textInput.value = color;
564     -      });
    531 +    // Sanitize HTML using DOMPurify
    532 +    // Allow SVG for Mermaid diagrams and math classes
    533 +    const cleanHtml = DOMPurify.sanitize(html, {
    534 +      ADD_TAGS: ['iframe'], // Allow iframes for PDF preview if needed
    535 +      ADD_ATTR: ['allow', 'allowfullscreen', 'frameborder', 'scrolling', 'target'],
    536 +      USE_PROFILES: { html: true, svg: true, mathml: true },
565 537      });
    538 +
    539 +    preview.innerHTML = cleanHtml;
    540 +
    541 +    // Apply Prism syntax highlighting using PrismService
    542 +    prismService.highlightAll(preview);
    543 +
    544 +    // NOTE: KaTeX auto-render is DISABLED
    545 +    // We handle all math via marked.js extensions ($...$ and $$...$$)
    546 +    // KaTeX auto-render was causing issues with unsupported LaTeX environments
    547 +
    548 +    // Save content using StorageManager
    549 +    storageManager.set('markdownContent', markdownText);
    550 +  } catch (error) {
    551 +    console.error('Render error:', error);
    552 +    preview.innerHTML =
    553 +      '<p style="color: red;">Error rendering markdown: ' + error.message + '</p>';
    554 +  }
    555 +}
    556 +
    557 +// Change theme using ThemeManager
    558 +async function changeTheme(themeName) {
    559 +  await themeManager.loadTheme(themeName);
    560 +
    561 +  // Wait for theme to load, then reinitialize Mermaid and force re-render
    562 +  setTimeout(() => {
    563 +    // Clear existing Mermaid diagrams to force fresh render with new colors
    564 +    const mermaidElements = preview.querySelectorAll('.mermaid');
    565 +    mermaidElements.forEach(el => {
    566 +      // Reset to original code to force re-render
    567 +      el.innerHTML = el.dataset.originalCode || '';
    568 +    });
    569 +
    570 +    // Re-render markdown with new theme
    571 +    renderMarkdown();
    572 +  }, 100);
    573 +}
    574 +
    575 +// Initialize color inputs
    576 +function initColorInputs() {
    577 +  document.querySelectorAll('.color-control input[type="color"]').forEach(input => {
    578 +    const varName = input.dataset.var;
    579 +    const textInput = document.getElementById(input.id + '-text');
    580 +    const currentValue = getComputedStyle(document.documentElement)
    581 +      .getPropertyValue(varName)
    582 +      .trim();
    583 +
    584 +    input.value = currentValue;
    585 +    textInput.value = currentValue;
    586 +
    587 +    input.addEventListener('input', e => {
    588 +      const color = e.target.value;
    589 +      document.documentElement.style.setProperty(varName, color);
    590 +      textInput.value = color;
    591 +    });
    592 +  });
    593 +}
    594 +
    595 +// Export to HTML
    596 +function exportHTML() {
    597 +  const currentTheme = themeSelector.value;
    598 +  let themeCSS = '';
    599 +
    600 +  if (currentTheme === 'custom') {
    601 +    const customTheme = storageManager.getJSON('customTheme');
    602 +    if (customTheme) {
    603 +      const theme = customTheme;
    604 +      themeCSS = ':root {\n';
    605 +      Object.entries(theme).forEach(([property, value]) => {
    606 +        themeCSS += `    ${property}: ${value};\n`;
    607 +      });
    608 +      themeCSS += '}';
    609 +    }
    610 +  } else {
    611 +    // Fetch theme CSS
    612 +    fetch(`themes/${currentTheme}.css`)
    613 +      .then(response => response.text())
    614 +      .then(css => {
    615 +        themeCSS = css;
    616 +        generateHTML();
    617 +      })
    618 +      .catch(err => {
    619 +        console.error('Error loading theme:', err);
    620 +        generateHTML();
    621 +      });
    622 +    return;
566 623    }
567 624  
568     -  // Export to HTML
569     -  function exportHTML() {
570     -    const currentTheme = themeSelector.value;
571     -    let themeCSS = '';
    625 +  generateHTML();
572 626  
573     -    if (currentTheme === 'custom') {
574     -      const customTheme = storageManager.getJSON('customTheme');
575     -      if (customTheme) {
576     -        const theme = customTheme;
577     -        themeCSS = ':root {\n';
578     -        Object.entries(theme).forEach(([property, value]) => {
579     -          themeCSS += `    ${property}: ${value};\n`;
580     -        });
581     -        themeCSS += '}';
582     -      }
583     -    } else {
584     -      // Fetch theme CSS
585     -      fetch(`themes/${currentTheme}.css`)
586     -        .then(response => response.text())
587     -        .then(css => {
588     -          themeCSS = css;
589     -          generateHTML();
590     -        })
591     -        .catch(err => {
592     -          console.error('Error loading theme:', err);
593     -          generateHTML();
594     -        });
595     -      return;
596     -    }
597     -
598     -    generateHTML();
599     -
600     -    function generateHTML() {
601     -      const html = `<!DOCTYPE html>
    627 +  function generateHTML() {
    628 +    const html = `<!DOCTYPE html>
602 629  <html>
603 630  <head>
604 631      <meta charset="UTF-8">
@@ -648,723 +675,724 @@ graph TD
648 675      </style>
649 676  </head>
650 677  <body>
651     -    ${preview.innerHTML}
    678 +    ${DOMPurify.sanitize(preview.innerHTML)}
652 679  </body>
653 680  </html>`;
654 681  
655     -      const blob = new Blob([html], { type: 'text/html' });
656     -      const url = URL.createObjectURL(blob);
657     -      const a = document.createElement('a');
658     -      a.href = url;
659     -      a.download = 'markdown-export.html';
660     -      a.click();
661     -      URL.revokeObjectURL(url);
662     -    }
    682 +    const blob = new Blob([html], { type: 'text/html' });
    683 +    const url = URL.createObjectURL(blob);
    684 +    const a = document.createElement('a');
    685 +    a.href = url;
    686 +    a.download = 'markdown-export.html';
    687 +    a.click();
    688 +    URL.revokeObjectURL(url);
663 689    }
    690 +}
664 691  
665     -  // Event Listeners
666     -  editor.addEventListener('input', renderMarkdown);
    692 +// Event Listeners
    693 +const debouncedRender = debounce(renderMarkdown, 300);
    694 +editor.addEventListener('input', debouncedRender);
667 695  
668     -  themeSelector.addEventListener('change', async e => {
669     -    await changeTheme(e.target.value);
670     -  });
    696 +themeSelector.addEventListener('change', async e => {
    697 +  await changeTheme(e.target.value);
    698 +});
671 699  
672     -  customizeBtn.addEventListener('click', () => {
673     -    modal.classList.add('active');
674     -    initColorInputs();
675     -  });
    700 +customizeBtn.addEventListener('click', () => {
    701 +  modal.classList.add('active');
    702 +  initColorInputs();
    703 +});
676 704  
677     -  closeModal.addEventListener('click', () => {
    705 +closeModal.addEventListener('click', () => {
    706 +  modal.classList.remove('active');
    707 +});
    708 +
    709 +modal.addEventListener('click', e => {
    710 +  if (e.target === modal) {
678 711      modal.classList.remove('active');
    712 +  }
    713 +});
    714 +
    715 +resetBtn.addEventListener('click', async () => {
    716 +  const currentTheme = themeSelector.value === 'custom' ? 'default-light' : themeSelector.value;
    717 +  await changeTheme(currentTheme);
    718 +  initColorInputs();
    719 +});
    720 +
    721 +saveThemeBtn.addEventListener('click', async () => {
    722 +  const customTheme = {};
    723 +  document.querySelectorAll('.color-control input[type="color"]').forEach(input => {
    724 +    const varName = input.dataset.var;
    725 +    customTheme[varName] = input.value;
679 726    });
680 727  
681     -  modal.addEventListener('click', e => {
682     -    if (e.target === modal) {
683     -      modal.classList.remove('active');
    728 +  // Save and load custom theme using ThemeManager
    729 +  themeManager.saveCustomTheme(customTheme);
    730 +  await themeManager.loadTheme('custom');
    731 +  themeSelector.value = 'custom';
    732 +
    733 +  alert('Custom theme saved and applied!');
    734 +  modal.classList.remove('active');
    735 +});
    736 +
    737 +// PDF Modal and Controls
    738 +const pdfModal = document.getElementById('pdf-modal');
    739 +const closePdfModal = document.getElementById('close-pdf-modal');
    740 +const pdfPreviewFrame = document.getElementById('pdf-preview-frame');
    741 +const pdfPageSize = document.getElementById('pdf-page-size');
    742 +const pdfOrientation = document.getElementById('pdf-orientation');
    743 +const pdfMarginTop = document.getElementById('pdf-margin-top');
    744 +const pdfMarginRight = document.getElementById('pdf-margin-right');
    745 +const pdfMarginBottom = document.getElementById('pdf-margin-bottom');
    746 +const pdfMarginLeft = document.getElementById('pdf-margin-left');
    747 +const pdfFontDecrease = document.getElementById('pdf-font-decrease');
    748 +const pdfFontIncrease = document.getElementById('pdf-font-increase');
    749 +const pdfFontSizeDisplay = document.getElementById('pdf-font-size-display');
    750 +const pdfPreviewBtn = document.getElementById('pdf-preview-btn');
    751 +const pdfDownloadBtn = document.getElementById('pdf-download-btn');
    752 +
    753 +let currentFontSize = 12;
    754 +
    755 +// Open PDF modal
    756 +function openPDFModal() {
    757 +  if (!pdfService.isReady()) {
    758 +    alert('PDF library is still loading. Please try again in a moment.');
    759 +    return;
    760 +  }
    761 +  pdfModal.classList.add('active');
    762 +  updatePDFPreview();
    763 +}
    764 +
    765 +// Close PDF modal
    766 +closePdfModal.addEventListener('click', () => {
    767 +  pdfModal.classList.remove('active');
    768 +  // Clean up iframe
    769 +  pdfPreviewFrame.src = '';
    770 +});
    771 +
    772 +pdfModal.addEventListener('click', e => {
    773 +  if (e.target === pdfModal) {
    774 +    pdfModal.classList.remove('active');
    775 +    pdfPreviewFrame.src = '';
    776 +  }
    777 +});
    778 +
    779 +// Get current PDF configuration from UI
    780 +function getPDFConfig() {
    781 +  return {
    782 +    pageSize: pdfPageSize.value,
    783 +    orientation: pdfOrientation.value,
    784 +    margins: [
    785 +      parseFloat(pdfMarginTop.value),
    786 +      parseFloat(pdfMarginRight.value),
    787 +      parseFloat(pdfMarginBottom.value),
    788 +      parseFloat(pdfMarginLeft.value),
    789 +    ],
    790 +    fontSize: currentFontSize,
    791 +  };
    792 +}
    793 +
    794 +// Update PDF preview
    795 +async function updatePDFPreview() {
    796 +  try {
    797 +    pdfPreviewBtn.textContent = '‚è≥ Generating Preview...';
    798 +    pdfPreviewBtn.disabled = true;
    799 +
    800 +    const config = getPDFConfig();
    801 +    const previewUrl = await pdfService.previewPDF(preview, config);
    802 +    pdfPreviewFrame.src = previewUrl;
    803 +
    804 +    pdfPreviewBtn.textContent = 'üëÅÔ∏è Update Preview';
    805 +    pdfPreviewBtn.disabled = false;
    806 +  } catch (error) {
    807 +    console.error('PDF preview error:', error);
    808 +    alert('Error generating preview: ' + error.message);
    809 +    pdfPreviewBtn.textContent = 'üëÅÔ∏è Update Preview';
    810 +    pdfPreviewBtn.disabled = false;
    811 +  }
    812 +}
    813 +
    814 +// Download PDF
    815 +async function downloadPDF() {
    816 +  try {
    817 +    pdfDownloadBtn.textContent = '‚è≥ Downloading...';
    818 +    pdfDownloadBtn.disabled = true;
    819 +
    820 +    const success = pdfService.downloadPDF();
    821 +    if (success) {
    822 +      setTimeout(() => {
    823 +        pdfModal.classList.remove('active');
    824 +        pdfPreviewFrame.src = '';
    825 +      }, 500);
684 826      }
685     -  });
686 827  
687     -  resetBtn.addEventListener('click', async () => {
688     -    const currentTheme = themeSelector.value === 'custom' ? 'default-light' : themeSelector.value;
689     -    await changeTheme(currentTheme);
690     -    initColorInputs();
691     -  });
    828 +    pdfDownloadBtn.textContent = 'üíæ Download PDF';
    829 +    pdfDownloadBtn.disabled = false;
    830 +  } catch (error) {
    831 +    console.error('PDF download error:', error);
    832 +    alert('Error downloading PDF: ' + error.message);
    833 +    pdfDownloadBtn.textContent = 'üíæ Download PDF';
    834 +    pdfDownloadBtn.disabled = false;
    835 +  }
    836 +}
692 837  
693     -  saveThemeBtn.addEventListener('click', async () => {
694     -    const customTheme = {};
695     -    document.querySelectorAll('.color-control input[type="color"]').forEach(input => {
696     -      const varName = input.dataset.var;
697     -      customTheme[varName] = input.value;
698     -    });
699     -
700     -    // Save and load custom theme using ThemeManager
701     -    themeManager.saveCustomTheme(customTheme);
702     -    await themeManager.loadTheme('custom');
703     -    themeSelector.value = 'custom';
704     -
705     -    alert('Custom theme saved and applied!');
706     -    modal.classList.remove('active');
707     -  });
708     -
709     -  // PDF Modal and Controls
710     -  const pdfModal = document.getElementById('pdf-modal');
711     -  const closePdfModal = document.getElementById('close-pdf-modal');
712     -  const pdfPreviewFrame = document.getElementById('pdf-preview-frame');
713     -  const pdfPageSize = document.getElementById('pdf-page-size');
714     -  const pdfOrientation = document.getElementById('pdf-orientation');
715     -  const pdfMarginTop = document.getElementById('pdf-margin-top');
716     -  const pdfMarginRight = document.getElementById('pdf-margin-right');
717     -  const pdfMarginBottom = document.getElementById('pdf-margin-bottom');
718     -  const pdfMarginLeft = document.getElementById('pdf-margin-left');
719     -  const pdfFontDecrease = document.getElementById('pdf-font-decrease');
720     -  const pdfFontIncrease = document.getElementById('pdf-font-increase');
721     -  const pdfFontSizeDisplay = document.getElementById('pdf-font-size-display');
722     -  const pdfPreviewBtn = document.getElementById('pdf-preview-btn');
723     -  const pdfDownloadBtn = document.getElementById('pdf-download-btn');
724     -
725     -  let currentFontSize = 12;
726     -
727     -  // Open PDF modal
728     -  function openPDFModal() {
729     -    if (!pdfService.isReady()) {
730     -      alert('PDF library is still loading. Please try again in a moment.');
731     -      return;
732     -    }
733     -    pdfModal.classList.add('active');
    838 +// Font size controls with auto-update
    839 +pdfFontDecrease.addEventListener('click', () => {
    840 +  if (currentFontSize > 8) {
    841 +    currentFontSize -= 1;
    842 +    pdfFontSizeDisplay.textContent = `${currentFontSize}pt`;
734 843      updatePDFPreview();
735 844    }
    845 +});
736 846  
737     -  // Close PDF modal
738     -  closePdfModal.addEventListener('click', () => {
739     -    pdfModal.classList.remove('active');
740     -    // Clean up iframe
741     -    pdfPreviewFrame.src = '';
742     -  });
    847 +pdfFontIncrease.addEventListener('click', () => {
    848 +  if (currentFontSize < 24) {
    849 +    currentFontSize += 1;
    850 +    pdfFontSizeDisplay.textContent = `${currentFontSize}pt`;
    851 +    updatePDFPreview();
    852 +  }
    853 +});
743 854  
744     -  pdfModal.addEventListener('click', e => {
745     -    if (e.target === pdfModal) {
746     -      pdfModal.classList.remove('active');
747     -      pdfPreviewFrame.src = '';
748     -    }
749     -  });
    855 +// Auto-update preview when settings change
    856 +pdfPageSize.addEventListener('change', updatePDFPreview);
    857 +pdfOrientation.addEventListener('change', updatePDFPreview);
    858 +pdfMarginTop.addEventListener('input', updatePDFPreview);
    859 +pdfMarginRight.addEventListener('input', updatePDFPreview);
    860 +pdfMarginBottom.addEventListener('input', updatePDFPreview);
    861 +pdfMarginLeft.addEventListener('input', updatePDFPreview);
750 862  
751     -  // Get current PDF configuration from UI
752     -  function getPDFConfig() {
753     -    return {
754     -      pageSize: pdfPageSize.value,
755     -      orientation: pdfOrientation.value,
756     -      margins: [
757     -        parseFloat(pdfMarginTop.value),
758     -        parseFloat(pdfMarginRight.value),
759     -        parseFloat(pdfMarginBottom.value),
760     -        parseFloat(pdfMarginLeft.value),
761     -      ],
762     -      fontSize: currentFontSize,
763     -    };
    863 +// PDF Event Listeners
    864 +pdfPreviewBtn.addEventListener('click', updatePDFPreview);
    865 +pdfDownloadBtn.addEventListener('click', downloadPDF);
    866 +
    867 +// Event listeners for export buttons
    868 +exportHtmlBtn.addEventListener('click', exportHTML);
    869 +exportPdfBtn.addEventListener('click', () => {
    870 +  console.log('Export PDF button clicked');
    871 +  openPDFModal();
    872 +});
    873 +
    874 +// Debug: Verify elements are found
    875 +console.log('Export PDF Button:', exportPdfBtn);
    876 +console.log('PDF Modal:', pdfModal);
    877 +console.log('PDF Service Ready:', pdfService.isReady());
    878 +
    879 +// View mode switching
    880 +function setViewMode(mode) {
    881 +  // Remove active class from all buttons
    882 +  editorOnlyBtn.classList.remove('active');
    883 +  splitViewBtn.classList.remove('active');
    884 +  previewOnlyBtn.classList.remove('active');
    885 +
    886 +  // Apply view mode
    887 +  switch (mode) {
    888 +    case 'editor-only':
    889 +      editorOnlyBtn.classList.add('active');
    890 +      editorContainer.style.display = 'flex';
    891 +      previewContainer.style.display = 'none';
    892 +      break;
    893 +    case 'split-view':
    894 +      splitViewBtn.classList.add('active');
    895 +      editorContainer.style.display = 'flex';
    896 +      previewContainer.style.display = 'flex';
    897 +      break;
    898 +    case 'preview-only':
    899 +      previewOnlyBtn.classList.add('active');
    900 +      editorContainer.style.display = 'none';
    901 +      previewContainer.style.display = 'flex';
    902 +      break;
764 903    }
765 904  
766     -  // Update PDF preview
767     -  async function updatePDFPreview() {
768     -    try {
769     -      pdfPreviewBtn.textContent = '‚è≥ Generating Preview...';
770     -      pdfPreviewBtn.disabled = true;
    905 +  // Save view mode preference
    906 +  storageManager.set('viewMode', mode);
    907 +}
771 908  
772     -      const config = getPDFConfig();
773     -      const previewUrl = await pdfService.previewPDF(preview, config);
774     -      pdfPreviewFrame.src = previewUrl;
    909 +// ==================== SYNC SCROLL FUNCTIONALITY ====================
775 910  
776     -      pdfPreviewBtn.textContent = 'üëÅÔ∏è Update Preview';
777     -      pdfPreviewBtn.disabled = false;
778     -    } catch (error) {
779     -      console.error('PDF preview error:', error);
780     -      alert('Error generating preview: ' + error.message);
781     -      pdfPreviewBtn.textContent = 'üëÅÔ∏è Update Preview';
782     -      pdfPreviewBtn.disabled = false;
783     -    }
    911 +// Sync scroll state (using var to avoid formatter issues)
    912 +var syncScrollEnabled = storageManager.get('syncScrollEnabled') === 'true';
    913 +var syncScrolling = false;
    914 +
    915 +// Load saved state and update button
    916 +if (syncScrollEnabled) {
    917 +  syncScrollBtn.classList.add('active');
    918 +}
    919 +
    920 +// Show sync scroll button only in split view
    921 +function updateSyncScrollVisibility() {
    922 +  const currentView = storageManager.get('viewMode') || 'split-view';
    923 +  if (currentView === 'split-view') {
    924 +    syncScrollBtn.style.display = 'inline-block';
    925 +  } else {
    926 +    syncScrollBtn.style.display = 'none';
784 927    }
    928 +}
785 929  
786     -  // Download PDF
787     -  async function downloadPDF() {
788     -    try {
789     -      pdfDownloadBtn.textContent = '‚è≥ Downloading...';
790     -      pdfDownloadBtn.disabled = true;
    930 +// Sync scroll toggle
    931 +syncScrollBtn.addEventListener('click', () => {
    932 +  syncScrollEnabled = !syncScrollEnabled;
    933 +  storageManager.set('syncScrollEnabled', syncScrollEnabled.toString());
791 934  
792     -      const success = pdfService.downloadPDF();
793     -      if (success) {
794     -        setTimeout(() => {
795     -          pdfModal.classList.remove('active');
796     -          pdfPreviewFrame.src = '';
797     -        }, 500);
798     -      }
799     -
800     -      pdfDownloadBtn.textContent = 'üíæ Download PDF';
801     -      pdfDownloadBtn.disabled = false;
802     -    } catch (error) {
803     -      console.error('PDF download error:', error);
804     -      alert('Error downloading PDF: ' + error.message);
805     -      pdfDownloadBtn.textContent = 'üíæ Download PDF';
806     -      pdfDownloadBtn.disabled = false;
807     -    }
808     -  }
809     -
810     -  // Font size controls with auto-update
811     -  pdfFontDecrease.addEventListener('click', () => {
812     -    if (currentFontSize > 8) {
813     -      currentFontSize -= 1;
814     -      pdfFontSizeDisplay.textContent = `${currentFontSize}pt`;
815     -      updatePDFPreview();
816     -    }
817     -  });
818     -
819     -  pdfFontIncrease.addEventListener('click', () => {
820     -    if (currentFontSize < 24) {
821     -      currentFontSize += 1;
822     -      pdfFontSizeDisplay.textContent = `${currentFontSize}pt`;
823     -      updatePDFPreview();
824     -    }
825     -  });
826     -
827     -  // Auto-update preview when settings change
828     -  pdfPageSize.addEventListener('change', updatePDFPreview);
829     -  pdfOrientation.addEventListener('change', updatePDFPreview);
830     -  pdfMarginTop.addEventListener('input', updatePDFPreview);
831     -  pdfMarginRight.addEventListener('input', updatePDFPreview);
832     -  pdfMarginBottom.addEventListener('input', updatePDFPreview);
833     -  pdfMarginLeft.addEventListener('input', updatePDFPreview);
834     -
835     -  // PDF Event Listeners
836     -  pdfPreviewBtn.addEventListener('click', updatePDFPreview);
837     -  pdfDownloadBtn.addEventListener('click', downloadPDF);
838     -
839     -  // Event listeners for export buttons
840     -  exportHtmlBtn.addEventListener('click', exportHTML);
841     -  exportPdfBtn.addEventListener('click', () => {
842     -    console.log('Export PDF button clicked');
843     -    openPDFModal();
844     -  });
845     -
846     -  // Debug: Verify elements are found
847     -  console.log('Export PDF Button:', exportPdfBtn);
848     -  console.log('PDF Modal:', pdfModal);
849     -  console.log('PDF Service Ready:', pdfService.isReady());
850     -
851     -  // View mode switching
852     -  function setViewMode(mode) {
853     -    // Remove active class from all buttons
854     -    editorOnlyBtn.classList.remove('active');
855     -    splitViewBtn.classList.remove('active');
856     -    previewOnlyBtn.classList.remove('active');
857     -
858     -    // Apply view mode
859     -    switch (mode) {
860     -      case 'editor-only':
861     -        editorOnlyBtn.classList.add('active');
862     -        editorContainer.style.display = 'flex';
863     -        previewContainer.style.display = 'none';
864     -        break;
865     -      case 'split-view':
866     -        splitViewBtn.classList.add('active');
867     -        editorContainer.style.display = 'flex';
868     -        previewContainer.style.display = 'flex';
869     -        break;
870     -      case 'preview-only':
871     -        previewOnlyBtn.classList.add('active');
872     -        editorContainer.style.display = 'none';
873     -        previewContainer.style.display = 'flex';
874     -        break;
875     -    }
876     -
877     -    // Save view mode preference
878     -    storageManager.set('viewMode', mode);
879     -  }
880     -
881     -  // ==================== SYNC SCROLL FUNCTIONALITY ====================
882     -
883     -  // Sync scroll state (using var to avoid formatter issues)
884     -  var syncScrollEnabled = storageManager.get('syncScrollEnabled') === 'true';
885     -  var syncScrolling = false;
886     -
887     -  // Load saved state and update button
888 935    if (syncScrollEnabled) {
889 936      syncScrollBtn.classList.add('active');
890     -  }
891     -
892     -  // Show sync scroll button only in split view
893     -  function updateSyncScrollVisibility() {
894     -    const currentView = storageManager.get('viewMode') || 'split-view';
895     -    if (currentView === 'split-view') {
896     -      syncScrollBtn.style.display = 'inline-block';
897     -    } else {
898     -      syncScrollBtn.style.display = 'none';
899     -    }
900     -  }
901     -
902     -  // Sync scroll toggle
903     -  syncScrollBtn.addEventListener('click', () => {
904     -    syncScrollEnabled = !syncScrollEnabled;
905     -    storageManager.set('syncScrollEnabled', syncScrollEnabled.toString());
906     -
907     -    if (syncScrollEnabled) {
908     -      syncScrollBtn.classList.add('active');
909     -      console.log('‚úÖ Sync scroll enabled');
910     -    } else {
911     -      syncScrollBtn.classList.remove('active');
912     -      console.log('‚ùå Sync scroll disabled');
913     -    }
914     -  });
915     -
916     -  // Editor scroll handler with smooth sync
917     -  editor.addEventListener('scroll', () => {
918     -    if (!syncScrollEnabled || syncScrolling) return;
919     -
920     -    syncScrolling = true;
921     -
922     -    requestAnimationFrame(() => {
923     -      const editorHeight = editor.scrollHeight - editor.clientHeight;
924     -      const previewHeight = previewContainer.scrollHeight - previewContainer.clientHeight;
925     -
926     -      // Handle edge cases for perfect alignment
927     -      if (editor.scrollTop <= 0) {
928     -        // At top
929     -        previewContainer.scrollTop = 0;
930     -      } else if (editor.scrollTop >= editorHeight) {
931     -        // At bottom
932     -        previewContainer.scrollTop = previewHeight;
933     -      } else {
934     -        // Middle - proportional scroll
935     -        const scrollPercent = editor.scrollTop / editorHeight;
936     -        previewContainer.scrollTop = scrollPercent * previewHeight;
937     -      }
938     -
939     -      setTimeout(() => {
940     -        syncScrolling = false;
941     -      }, 10); // Reduced from 50ms for more responsive feel
942     -    });
943     -  });
944     -
945     -  // Preview container scroll handler with smooth sync
946     -  previewContainer.addEventListener('scroll', () => {
947     -    if (!syncScrollEnabled || syncScrolling) return;
948     -
949     -    syncScrolling = true;
950     -
951     -    requestAnimationFrame(() => {
952     -      const editorHeight = editor.scrollHeight - editor.clientHeight;
953     -      const previewHeight = previewContainer.scrollHeight - previewContainer.clientHeight;
954     -
955     -      // Handle edge cases for perfect alignment
956     -      if (previewContainer.scrollTop <= 0) {
957     -        // At top
958     -        editor.scrollTop = 0;
959     -      } else if (previewContainer.scrollTop >= previewHeight) {
960     -        // At bottom
961     -        editor.scrollTop = editorHeight;
962     -      } else {
963     -        // Middle - proportional scroll
964     -        const scrollPercent = previewContainer.scrollTop / previewHeight;
965     -        editor.scrollTop = scrollPercent * editorHeight;
966     -      }
967     -
968     -      setTimeout(() => {
969     -        syncScrolling = false;
970     -      }, 10); // Reduced from 50ms for more responsive feel
971     -    });
972     -  });
973     -
974     -  // View mode button event listeners with sync button update
975     -  editorOnlyBtn.addEventListener('click', () => {
976     -    setViewMode('editor-only');
977     -    updateSyncScrollVisibility();
978     -  });
979     -  splitViewBtn.addEventListener('click', () => {
980     -    setViewMode('split-view');
981     -    updateSyncScrollVisibility();
982     -  });
983     -  previewOnlyBtn.addEventListener('click', () => {
984     -    setViewMode('preview-only');
985     -    updateSyncScrollVisibility();
986     -  });
987     -
988     -  // Initialize visibility
989     -  updateSyncScrollVisibility();
990     -
991     -  // Load saved theme FIRST, then initialize Mermaid with correct colors
992     -  const savedTheme = storageManager.get('selectedTheme');
993     -  if (savedTheme) {
994     -    // Load theme first, then sync dropdown and reinit Mermaid
995     -    themeManager
996     -      .loadTheme(savedTheme)
997     -      .then(() => {
998     -        // Theme loaded successfully - sync dropdown
999     -        themeSelector.value = savedTheme;
1000     -        console.log(`‚úÖ Theme restored: ${savedTheme}`);
1001     -
1002     -        // NOW initialize Mermaid with correct theme colors
1003     -        mermaidService.initialize();
1004     -
1005     -        // Re-render to apply theme
1006     -        renderMarkdown();
1007     -      })
1008     -      .catch(err => {
1009     -        console.error('Failed to load saved theme:', err);
1010     -        // Fallback to default-light on error
1011     -        themeManager.loadTheme('default-light').then(() => {
1012     -          themeSelector.value = 'default-light';
1013     -          mermaidService.initialize();
1014     -          renderMarkdown();
1015     -        });
1016     -      });
    937 +    console.log('‚úÖ Sync scroll enabled');
1017 938    } else {
1018     -    // No saved theme - initialize with default-light
1019     -    mermaidService.initialize();
1020     -    renderMarkdown();
    939 +    syncScrollBtn.classList.remove('active');
    940 +    console.log('‚ùå Sync scroll disabled');
1021 941    }
    942 +});
1022 943  
1023     -  // Zoom functionality
1024     -  function setZoom(zoomLevel) {
1025     -    // Constrain zoom level between 50% and 200%
1026     -    currentZoom = Math.max(50, Math.min(200, zoomLevel));
    944 +// Editor scroll handler with smooth sync
    945 +editor.addEventListener('scroll', () => {
    946 +  if (!syncScrollEnabled || syncScrolling) return;
1027 947  
1028     -    // Apply zoom using CSS transform with proper container sizing
1029     -    preview.style.transform = `scale(${currentZoom / 100})`;
1030     -    preview.style.transformOrigin = 'top left';
1031     -    preview.style.width = `${10000 / currentZoom}%`;
1032     -    preview.style.height = `${10000 / currentZoom}%`;
    948 +  syncScrolling = true;
1033 949  
1034     -    // Ensure scrollbar remains visible and functional
1035     -    const previewContainer = preview.parentElement;
1036     -    if (previewContainer) {
1037     -      previewContainer.style.overflow = 'auto';
    950 +  requestAnimationFrame(() => {
    951 +    const editorHeight = editor.scrollHeight - editor.clientHeight;
    952 +    const previewHeight = previewContainer.scrollHeight - previewContainer.clientHeight;
    953 +
    954 +    // Handle edge cases for perfect alignment
    955 +    if (editor.scrollTop <= 0) {
    956 +      // At top
    957 +      previewContainer.scrollTop = 0;
    958 +    } else if (editor.scrollTop >= editorHeight) {
    959 +      // At bottom
    960 +      previewContainer.scrollTop = previewHeight;
    961 +    } else {
    962 +      // Middle - proportional scroll
    963 +      const scrollPercent = editor.scrollTop / editorHeight;
    964 +      previewContainer.scrollTop = scrollPercent * previewHeight;
1038 965      }
1039 966  
1040     -    // Update display
1041     -    zoomLevelDisplay.textContent = `${currentZoom}%`;
1042     -
1043     -    // Save to localStorage
1044     -    storageManager.set('previewZoom', currentZoom.toString());
1045     -  }
1046     -
1047     -  function zoomIn() {
1048     -    setZoom(currentZoom + 10);
1049     -  }
1050     -
1051     -  function zoomOut() {
1052     -    setZoom(currentZoom - 10);
1053     -  }
1054     -
1055     -  function resetZoom() {
1056     -    setZoom(100);
1057     -  }
1058     -
1059     -  // Zoom event listeners
1060     -  zoomInBtn.addEventListener('click', zoomIn);
1061     -  zoomOutBtn.addEventListener('click', zoomOut);
1062     -  zoomResetBtn.addEventListener('click', resetZoom);
1063     -
1064     -  // Keyboard shortcuts for zoom (Ctrl/Cmd + Plus/Minus/0)
1065     -  preview.addEventListener('wheel', e => {
1066     -    if (e.ctrlKey || e.metaKey) {
1067     -      e.preventDefault();
1068     -      if (e.deltaY < 0) {
1069     -        zoomIn();
1070     -      } else {
1071     -        zoomOut();
1072     -      }
1073     -    }
    967 +    setTimeout(() => {
    968 +      syncScrolling = false;
    969 +    }, 10); // Reduced from 50ms for more responsive feel
1074 970    });
    971 +});
1075 972  
1076     -  document.addEventListener('keydown', e => {
1077     -    if ((e.ctrlKey || e.metaKey) && e.target.tagName !== 'TEXTAREA') {
1078     -      if (e.key === '=' || e.key === '+') {
1079     -        e.preventDefault();
1080     -        zoomIn();
1081     -      } else if (e.key === '-') {
1082     -        e.preventDefault();
1083     -        zoomOut();
1084     -      } else if (e.key === '0') {
1085     -        e.preventDefault();
1086     -        resetZoom();
1087     -      }
    973 +// Preview container scroll handler with smooth sync
    974 +previewContainer.addEventListener('scroll', () => {
    975 +  if (!syncScrollEnabled || syncScrolling) return;
    976 +
    977 +  syncScrolling = true;
    978 +
    979 +  requestAnimationFrame(() => {
    980 +    const editorHeight = editor.scrollHeight - editor.clientHeight;
    981 +    const previewHeight = previewContainer.scrollHeight - previewContainer.clientHeight;
    982 +
    983 +    // Handle edge cases for perfect alignment
    984 +    if (previewContainer.scrollTop <= 0) {
    985 +      // At top
    986 +      editor.scrollTop = 0;
    987 +    } else if (previewContainer.scrollTop >= previewHeight) {
    988 +      // At bottom
    989 +      editor.scrollTop = editorHeight;
    990 +    } else {
    991 +      // Middle - proportional scroll
    992 +      const scrollPercent = previewContainer.scrollTop / previewHeight;
    993 +      editor.scrollTop = scrollPercent * editorHeight;
1088 994      }
    995 +
    996 +    setTimeout(() => {
    997 +      syncScrolling = false;
    998 +    }, 10); // Reduced from 50ms for more responsive feel
1089 999    });
    1000 +});
1090 1001  
1091     -  // Load saved zoom level
1092     -  const savedZoom = storageManager.get('previewZoom');
1093     -  if (savedZoom) {
1094     -    currentZoom = parseInt(savedZoom, 10);
1095     -    setZoom(currentZoom);
    1002 +// View mode button event listeners with sync button update
    1003 +editorOnlyBtn.addEventListener('click', () => {
    1004 +  setViewMode('editor-only');
    1005 +  updateSyncScrollVisibility();
    1006 +});
    1007 +splitViewBtn.addEventListener('click', () => {
    1008 +  setViewMode('split-view');
    1009 +  updateSyncScrollVisibility();
    1010 +});
    1011 +previewOnlyBtn.addEventListener('click', () => {
    1012 +  setViewMode('preview-only');
    1013 +  updateSyncScrollVisibility();
    1014 +});
    1015 +
    1016 +// Initialize visibility
    1017 +updateSyncScrollVisibility();
    1018 +
    1019 +// Load saved theme FIRST, then initialize Mermaid with correct colors
    1020 +const savedTheme = storageManager.get('selectedTheme');
    1021 +if (savedTheme) {
    1022 +  // Load theme first, then sync dropdown and reinit Mermaid
    1023 +  themeManager
    1024 +    .loadTheme(savedTheme)
    1025 +    .then(() => {
    1026 +      // Theme loaded successfully - sync dropdown
    1027 +      themeSelector.value = savedTheme;
    1028 +      console.log(`‚úÖ Theme restored: ${savedTheme}`);
    1029 +
    1030 +      // NOW initialize Mermaid with correct theme colors
    1031 +      mermaidService.initialize();
    1032 +
    1033 +      // Re-render to apply theme
    1034 +      renderMarkdown();
    1035 +    })
    1036 +    .catch(err => {
    1037 +      console.error('Failed to load saved theme:', err);
    1038 +      // Fallback to default-light on error
    1039 +      themeManager.loadTheme('default-light').then(() => {
    1040 +        themeSelector.value = 'default-light';
    1041 +        mermaidService.initialize();
    1042 +        renderMarkdown();
    1043 +      });
    1044 +    });
    1045 +} else {
    1046 +  // No saved theme - initialize with default-light
    1047 +  mermaidService.initialize();
    1048 +  renderMarkdown();
    1049 +}
    1050 +
    1051 +// Zoom functionality
    1052 +function setZoom(zoomLevel) {
    1053 +  // Constrain zoom level between 50% and 200%
    1054 +  currentZoom = Math.max(50, Math.min(200, zoomLevel));
    1055 +
    1056 +  // Apply zoom using CSS transform with proper container sizing
    1057 +  preview.style.transform = `scale(${currentZoom / 100})`;
    1058 +  preview.style.transformOrigin = 'top left';
    1059 +  preview.style.width = `${10000 / currentZoom}%`;
    1060 +  preview.style.height = `${10000 / currentZoom}%`;
    1061 +
    1062 +  // Ensure scrollbar remains visible and functional
    1063 +  const previewContainer = preview.parentElement;
    1064 +  if (previewContainer) {
    1065 +    previewContainer.style.overflow = 'auto';
1096 1066    }
1097 1067  
1098     -  // Load saved view mode
1099     -  const savedViewMode = storageManager.get('viewMode') || 'split-view';
1100     -  setViewMode(savedViewMode);
    1068 +  // Update display
    1069 +  zoomLevelDisplay.textContent = `${currentZoom}%`;
1101 1070  
1102     -  // ==================== FOLDER BROWSER FUNCTIONALITY ====================
    1071 +  // Save to localStorage
    1072 +  storageManager.set('previewZoom', currentZoom.toString());
    1073 +}
1103 1074  
1104     -  // Folder browser DOM elements
1105     -  const fileBrowser = document.getElementById('file-browser');
1106     -  const openFolderBtn = document.getElementById('open-folder-btn');
1107     -  const toggleSidebarBtn = document.getElementById('toggle-sidebar-btn');
1108     -  const closeBrowserBtn = document.getElementById('close-browser-btn');
1109     -  const floatingShowBtn = document.getElementById('floating-show-btn');
1110     -  const resizeHandle = document.getElementById('resize-handle');
1111     -  const fileTree = document.getElementById('file-tree');
1112     -  const currentFolderNameEl = document.getElementById('current-folder-name');
1113     -  const fileCountEl = document.getElementById('file-count');
    1075 +function zoomIn() {
    1076 +  setZoom(currentZoom + 10);
    1077 +}
1114 1078  
1115     -  // Folder browser state (using let to allow reassignment)
1116     -  let folderFiles = [];
1117     -  let activeFileHandle = null;
1118     -  let isResizing = false;
1119     -  let sidebarWidth = 280; // Default width
1120     -  const minWidth = 100; // Allow squeezing to very narrow
1121     -  const maxWidth = 600;
1122     -  const collapseThreshold = 80; // Auto-collapse at very left edge only
    1079 +function zoomOut() {
    1080 +  setZoom(currentZoom - 10);
    1081 +}
1123 1082  
1124     -  // Load saved sidebar width
1125     -  const savedWidth = storageManager.get('sidebarWidth');
1126     -  if (savedWidth) {
1127     -    sidebarWidth = parseInt(savedWidth, 10);
1128     -  }
    1083 +function resetZoom() {
    1084 +  setZoom(100);
    1085 +}
1129 1086  
1130     -  // Resize functionality
1131     -  resizeHandle.addEventListener('mousedown', e => {
1132     -    isResizing = true;
1133     -    fileBrowser.classList.add('resizing');
1134     -    resizeHandle.classList.add('dragging');
1135     -    document.body.style.cursor = 'col-resize';
1136     -    document.body.style.userSelect = 'none';
    1087 +// Zoom event listeners
    1088 +zoomInBtn.addEventListener('click', zoomIn);
    1089 +zoomOutBtn.addEventListener('click', zoomOut);
    1090 +zoomResetBtn.addEventListener('click', resetZoom);
    1091 +
    1092 +// Keyboard shortcuts for zoom (Ctrl/Cmd + Plus/Minus/0)
    1093 +preview.addEventListener('wheel', e => {
    1094 +  if (e.ctrlKey || e.metaKey) {
1137 1095      e.preventDefault();
1138     -  });
1139     -
1140     -  document.addEventListener('mousemove', e => {
1141     -    if (!isResizing) return;
1142     -
1143     -    const newWidth = e.clientX;
1144     -
1145     -    // Check if dragged to leftmost (auto-collapse)
1146     -    if (newWidth < collapseThreshold) {
1147     -      // Auto-collapse with smooth animation
1148     -      fileBrowser.classList.remove('resizing');
1149     -      fileBrowser.style.display = 'none';
1150     -      floatingShowBtn.style.display = 'block';
1151     -      isResizing = false;
1152     -      resizeHandle.classList.remove('dragging');
1153     -      document.body.style.cursor = '';
1154     -      document.body.style.userSelect = '';
1155     -      return;
    1096 +    if (e.deltaY < 0) {
    1097 +      zoomIn();
    1098 +    } else {
    1099 +      zoomOut();
1156 1100      }
    1101 +  }
    1102 +});
1157 1103  
1158     -    // Constrain width
1159     -    if (newWidth >= minWidth && newWidth <= maxWidth) {
1160     -      sidebarWidth = newWidth;
1161     -      fileBrowser.style.width = `${sidebarWidth}px`;
    1104 +document.addEventListener('keydown', e => {
    1105 +  if ((e.ctrlKey || e.metaKey) && e.target.tagName !== 'TEXTAREA') {
    1106 +    if (e.key === '=' || e.key === '+') {
    1107 +      e.preventDefault();
    1108 +      zoomIn();
    1109 +    } else if (e.key === '-') {
    1110 +      e.preventDefault();
    1111 +      zoomOut();
    1112 +    } else if (e.key === '0') {
    1113 +      e.preventDefault();
    1114 +      resetZoom();
1162 1115      }
1163     -  });
    1116 +  }
    1117 +});
1164 1118  
1165     -  document.addEventListener('mouseup', () => {
1166     -    if (isResizing) {
1167     -      isResizing = false;
1168     -      fileBrowser.classList.remove('resizing');
1169     -      resizeHandle.classList.remove('dragging');
1170     -      document.body.style.cursor = '';
1171     -      document.body.style.userSelect = '';
    1119 +// Load saved zoom level
    1120 +const savedZoom = storageManager.get('previewZoom');
    1121 +if (savedZoom) {
    1122 +  currentZoom = parseInt(savedZoom, 10);
    1123 +  setZoom(currentZoom);
    1124 +}
1172 1125  
1173     -      // Save width
1174     -      storageManager.set('sidebarWidth', sidebarWidth.toString());
1175     -    }
1176     -  });
    1126 +// Load saved view mode
    1127 +const savedViewMode = storageManager.get('viewMode') || 'split-view';
    1128 +setViewMode(savedViewMode);
1177 1129  
1178     -  // Open folder handler
1179     -  openFolderBtn.addEventListener('click', async () => {
1180     -    if (!folderBrowserService.isSupported()) {
1181     -      alert(
1182     -        'Folder browsing requires File System Access API.\n\n' +
1183     -          'Please use Chrome 86+ or Edge 86+.\n\n' +
1184     -          'Firefox and Safari are not currently supported.'
1185     -      );
1186     -      return;
1187     -    }
    1130 +// ==================== FOLDER BROWSER FUNCTIONALITY ====================
1188 1131  
1189     -    const result = await folderBrowserService.openFolder();
    1132 +// Folder browser DOM elements
    1133 +const fileBrowser = document.getElementById('file-browser');
    1134 +const openFolderBtn = document.getElementById('open-folder-btn');
    1135 +const toggleSidebarBtn = document.getElementById('toggle-sidebar-btn');
    1136 +const closeBrowserBtn = document.getElementById('close-browser-btn');
    1137 +const floatingShowBtn = document.getElementById('floating-show-btn');
    1138 +const resizeHandle = document.getElementById('resize-handle');
    1139 +const fileTree = document.getElementById('file-tree');
    1140 +const currentFolderNameEl = document.getElementById('current-folder-name');
    1141 +const fileCountEl = document.getElementById('file-count');
1190 1142  
1191     -    if (result.cancelled) {
1192     -      return; // User cancelled
1193     -    }
    1143 +// Folder browser state (using let to allow reassignment)
    1144 +let folderFiles = [];
    1145 +let activeFileHandle = null;
    1146 +let isResizing = false;
    1147 +let sidebarWidth = 280; // Default width
    1148 +const minWidth = 100; // Allow squeezing to very narrow
    1149 +const maxWidth = 600;
    1150 +const collapseThreshold = 80; // Auto-collapse at very left edge only
1194 1151  
1195     -    if (!result.success) {
1196     -      alert('Error opening folder: ' + result.error);
1197     -      return;
1198     -    }
    1152 +// Load saved sidebar width
    1153 +const savedWidth = storageManager.get('sidebarWidth');
    1154 +if (savedWidth) {
    1155 +  sidebarWidth = parseInt(savedWidth, 10);
    1156 +}
1199 1157  
1200     -    // Store files
1201     -    folderFiles = result.files;
    1158 +// Resize functionality
    1159 +resizeHandle.addEventListener('mousedown', e => {
    1160 +  isResizing = true;
    1161 +  fileBrowser.classList.add('resizing');
    1162 +  resizeHandle.classList.add('dragging');
    1163 +  document.body.style.cursor = 'col-resize';
    1164 +  document.body.style.userSelect = 'none';
    1165 +  e.preventDefault();
    1166 +});
1202 1167  
1203     -    // Show browser sidebar, hide floating button
1204     -    fileBrowser.style.display = 'flex';
1205     -    floatingShowBtn.style.display = 'none';
    1168 +document.addEventListener('mousemove', e => {
    1169 +  if (!isResizing) return;
1206 1170  
1207     -    // Update UI
1208     -    currentFolderNameEl.textContent = result.folderName;
1209     -    fileCountEl.textContent = `${result.totalFiles} file${result.totalFiles !== 1 ? 's' : ''}`;
    1171 +  const newWidth = e.clientX;
1210 1172  
1211     -    // Render tree
1212     -    renderFileTree(result.files);
1213     -
1214     -    console.log(`‚úÖ Loaded ${result.totalFiles} markdown files from ${result.folderName}`);
1215     -  });
1216     -
1217     -  // Toggle sidebar collapse/expand (keeps folder data)
1218     -  toggleSidebarBtn.addEventListener('click', () => {
1219     -    // Hide sidebar, show floating button
    1173 +  // Check if dragged to leftmost (auto-collapse)
    1174 +  if (newWidth < collapseThreshold) {
    1175 +    // Auto-collapse with smooth animation
    1176 +    fileBrowser.classList.remove('resizing');
1220 1177      fileBrowser.style.display = 'none';
1221 1178      floatingShowBtn.style.display = 'block';
1222     -  });
    1179 +    isResizing = false;
    1180 +    resizeHandle.classList.remove('dragging');
    1181 +    document.body.style.cursor = '';
    1182 +    document.body.style.userSelect = '';
    1183 +    return;
    1184 +  }
1223 1185  
1224     -  // Floating button - show sidebar
1225     -  floatingShowBtn.addEventListener('click', () => {
1226     -    // Show sidebar, hide floating button
1227     -    fileBrowser.style.display = 'flex';
1228     -    floatingShowBtn.style.display = 'none';
1229     -  });
    1186 +  // Constrain width
    1187 +  if (newWidth >= minWidth && newWidth <= maxWidth) {
    1188 +    sidebarWidth = newWidth;
    1189 +    fileBrowser.style.width = `${sidebarWidth}px`;
    1190 +  }
    1191 +});
1230 1192  
1231     -  // Close browser handler (clears all folder data)
1232     -  closeBrowserBtn.addEventListener('click', () => {
1233     -    // Hide everything AND clear data
1234     -    fileBrowser.style.display = 'none';
1235     -    floatingShowBtn.style.display = 'none';
1236     -    folderFiles = [];
1237     -    activeFileHandle = null;
1238     -  });
    1193 +document.addEventListener('mouseup', () => {
    1194 +  if (isResizing) {
    1195 +    isResizing = false;
    1196 +    fileBrowser.classList.remove('resizing');
    1197 +    resizeHandle.classList.remove('dragging');
    1198 +    document.body.style.cursor = '';
    1199 +    document.body.style.userSelect = '';
1239 1200  
1240     -  // Render file tree
1241     -  function renderFileTree(items, container = fileTree, indent = 0) {
1242     -    // Clear container on first render
1243     -    if (indent === 0) {
1244     -      container.innerHTML = '';
1245     -    }
    1201 +    // Save width
    1202 +    storageManager.set('sidebarWidth', sidebarWidth.toString());
    1203 +  }
    1204 +});
1246 1205  
1247     -    if (items.length === 0 && indent === 0) {
1248     -      container.innerHTML = `
    1206 +// Open folder handler
    1207 +openFolderBtn.addEventListener('click', async () => {
    1208 +  if (!folderBrowserService.isSupported()) {
    1209 +    alert(
    1210 +      'Folder browsing requires File System Access API.\n\n' +
    1211 +      'Please use Chrome 86+ or Edge 86+.\n\n' +
    1212 +      'Firefox and Safari are not currently supported.'
    1213 +    );
    1214 +    return;
    1215 +  }
    1216 +
    1217 +  const result = await folderBrowserService.openFolder();
    1218 +
    1219 +  if (result.cancelled) {
    1220 +    return; // User cancelled
    1221 +  }
    1222 +
    1223 +  if (!result.success) {
    1224 +    alert('Error opening folder: ' + result.error);
    1225 +    return;
    1226 +  }
    1227 +
    1228 +  // Store files
    1229 +  folderFiles = result.files;
    1230 +
    1231 +  // Show browser sidebar, hide floating button
    1232 +  fileBrowser.style.display = 'flex';
    1233 +  floatingShowBtn.style.display = 'none';
    1234 +
    1235 +  // Update UI
    1236 +  currentFolderNameEl.textContent = result.folderName;
    1237 +  fileCountEl.textContent = `${result.totalFiles} file${result.totalFiles !== 1 ? 's' : ''}`;
    1238 +
    1239 +  // Render tree
    1240 +  renderFileTree(result.files);
    1241 +
    1242 +  console.log(`‚úÖ Loaded ${result.totalFiles} markdown files from ${result.folderName}`);
    1243 +});
    1244 +
    1245 +// Toggle sidebar collapse/expand (keeps folder data)
    1246 +toggleSidebarBtn.addEventListener('click', () => {
    1247 +  // Hide sidebar, show floating button
    1248 +  fileBrowser.style.display = 'none';
    1249 +  floatingShowBtn.style.display = 'block';
    1250 +});
    1251 +
    1252 +// Floating button - show sidebar
    1253 +floatingShowBtn.addEventListener('click', () => {
    1254 +  // Show sidebar, hide floating button
    1255 +  fileBrowser.style.display = 'flex';
    1256 +  floatingShowBtn.style.display = 'none';
    1257 +});
    1258 +
    1259 +// Close browser handler (clears all folder data)
    1260 +closeBrowserBtn.addEventListener('click', () => {
    1261 +  // Hide everything AND clear data
    1262 +  fileBrowser.style.display = 'none';
    1263 +  floatingShowBtn.style.display = 'none';
    1264 +  folderFiles = [];
    1265 +  activeFileHandle = null;
    1266 +});
    1267 +
    1268 +// Render file tree
    1269 +function renderFileTree(items, container = fileTree, indent = 0) {
    1270 +  // Clear container on first render
    1271 +  if (indent === 0) {
    1272 +    container.innerHTML = '';
    1273 +  }
    1274 +
    1275 +  if (items.length === 0 && indent === 0) {
    1276 +    container.innerHTML = `
1249 1277          <div class="empty-state">
1250 1278            <p>üìÇ No markdown files found</p>
1251 1279            <p class="hint">This folder doesn't contain any .md files</p>
1252 1280          </div>
1253 1281        `;
1254     -      return;
1255     -    }
    1282 +    return;
    1283 +  }
1256 1284  
1257     -    items.forEach(item => {
1258     -      if (item.type === 'directory') {
1259     -        const folderDiv = createFolderElement(item, indent);
1260     -        container.appendChild(folderDiv);
    1285 +  items.forEach(item => {
    1286 +    if (item.type === 'directory') {
    1287 +      const folderDiv = createFolderElement(item, indent);
    1288 +      container.appendChild(folderDiv);
1261 1289  
1262     -        if (item.expanded && item.children) {
1263     -          const childContainer = document.createElement('div');
1264     -          childContainer.className = 'tree-children';
1265     -          renderFileTree(item.children, childContainer, indent + 1);
1266     -          container.appendChild(childContainer);
1267     -        }
1268     -      } else if (item.type === 'file') {
1269     -        const fileDiv = createFileElement(item, indent);
1270     -        container.appendChild(fileDiv);
    1290 +      if (item.expanded && item.children) {
    1291 +        const childContainer = document.createElement('div');
    1292 +        childContainer.className = 'tree-children';
    1293 +        renderFileTree(item.children, childContainer, indent + 1);
    1294 +        container.appendChild(childContainer);
1271 1295        }
1272     -    });
1273     -  }
1274     -
1275     -  // Create folder element
1276     -  function createFolderElement(item, indent) {
1277     -    const div = document.createElement('div');
1278     -    div.className = 'tree-item folder';
1279     -    div.style.paddingLeft = indent * 20 + 12 + 'px';
1280     -
1281     -    const icon = item.expanded ? 'üìÇ' : 'üìÅ';
1282     -    const folderIcon = document.createElement('span');
1283     -    folderIcon.className = 'folder-icon';
1284     -    folderIcon.textContent = icon;
1285     -
1286     -    const folderName = document.createElement('span');
1287     -    folderName.className = 'folder-name';
1288     -    folderName.textContent = item.name;
1289     -
1290     -    const fileCount = document.createElement('span');
1291     -    fileCount.className = 'file-count';
1292     -    fileCount.textContent = item.fileCount;
1293     -
1294     -    div.appendChild(folderIcon);
1295     -    div.appendChild(folderName);
1296     -    div.appendChild(fileCount);
1297     -
1298     -    div.addEventListener('click', e => {
1299     -      e.stopPropagation();
1300     -      toggleFolder(item);
1301     -    });
1302     -
1303     -    return div;
1304     -  }
1305     -
1306     -  // Create file element
1307     -  function createFileElement(item, indent) {
1308     -    const div = document.createElement('div');
1309     -    div.className = 'tree-item file';
1310     -    div.style.paddingLeft = indent * 20 + 12 + 'px';
1311     -
1312     -    // Mark as active if this is the current file
1313     -    if (activeFileHandle === item.handle) {
1314     -      div.classList.add('active');
    1296 +    } else if (item.type === 'file') {
    1297 +      const fileDiv = createFileElement(item, indent);
    1298 +      container.appendChild(fileDiv);
1315 1299      }
    1300 +  });
    1301 +}
1316 1302  
1317     -    const fileIcon = document.createElement('span');
1318     -    fileIcon.className = 'file-icon';
1319     -    fileIcon.textContent = 'üìÑ';
    1303 +// Create folder element
    1304 +function createFolderElement(item, indent) {
    1305 +  const div = document.createElement('div');
    1306 +  div.className = 'tree-item folder';
    1307 +  div.style.paddingLeft = indent * 20 + 12 + 'px';
1320 1308  
1321     -    const fileName = document.createElement('span');
1322     -    fileName.className = 'file-name';
1323     -    fileName.textContent = item.name;
    1309 +  const icon = item.expanded ? 'üìÇ' : 'üìÅ';
    1310 +  const folderIcon = document.createElement('span');
    1311 +  folderIcon.className = 'folder-icon';
    1312 +  folderIcon.textContent = icon;
1324 1313  
1325     -    div.appendChild(fileIcon);
1326     -    div.appendChild(fileName);
    1314 +  const folderName = document.createElement('span');
    1315 +  folderName.className = 'folder-name';
    1316 +  folderName.textContent = item.name;
1327 1317  
1328     -    div.addEventListener('click', async e => {
1329     -      e.stopPropagation();
1330     -      await loadFileFromBrowser(item);
1331     -    });
    1318 +  const fileCount = document.createElement('span');
    1319 +  fileCount.className = 'file-count';
    1320 +  fileCount.textContent = item.fileCount;
1332 1321  
1333     -    return div;
    1322 +  div.appendChild(folderIcon);
    1323 +  div.appendChild(folderName);
    1324 +  div.appendChild(fileCount);
    1325 +
    1326 +  div.addEventListener('click', e => {
    1327 +    e.stopPropagation();
    1328 +    toggleFolder(item);
    1329 +  });
    1330 +
    1331 +  return div;
    1332 +}
    1333 +
    1334 +// Create file element
    1335 +function createFileElement(item, indent) {
    1336 +  const div = document.createElement('div');
    1337 +  div.className = 'tree-item file';
    1338 +  div.style.paddingLeft = indent * 20 + 12 + 'px';
    1339 +
    1340 +  // Mark as active if this is the current file
    1341 +  if (activeFileHandle === item.handle) {
    1342 +    div.classList.add('active');
1334 1343    }
1335 1344  
1336     -  // Toggle folder expand/collapse
1337     -  function toggleFolder(folder) {
1338     -    folder.expanded = !folder.expanded;
1339     -    renderFileTree(folderFiles);
    1345 +  const fileIcon = document.createElement('span');
    1346 +  fileIcon.className = 'file-icon';
    1347 +  fileIcon.textContent = 'üìÑ';
    1348 +
    1349 +  const fileName = document.createElement('span');
    1350 +  fileName.className = 'file-name';
    1351 +  fileName.textContent = item.name;
    1352 +
    1353 +  div.appendChild(fileIcon);
    1354 +  div.appendChild(fileName);
    1355 +
    1356 +  div.addEventListener('click', async e => {
    1357 +    e.stopPropagation();
    1358 +    await loadFileFromBrowser(item);
    1359 +  });
    1360 +
    1361 +  return div;
    1362 +}
    1363 +
    1364 +// Toggle folder expand/collapse
    1365 +function toggleFolder(folder) {
    1366 +  folder.expanded = !folder.expanded;
    1367 +  renderFileTree(folderFiles);
    1368 +}
    1369 +
    1370 +// Load file from browser
    1371 +async function loadFileFromBrowser(fileItem) {
    1372 +  const result = await folderBrowserService.readFile(fileItem.handle);
    1373 +
    1374 +  if (!result.success) {
    1375 +    alert('Error loading file: ' + result.error);
    1376 +    return;
1340 1377    }
1341 1378  
1342     -  // Load file from browser
1343     -  async function loadFileFromBrowser(fileItem) {
1344     -    const result = await folderBrowserService.readFile(fileItem.handle);
    1379 +  // Load content into editor
    1380 +  editor.value = result.content;
1345 1381  
1346     -    if (!result.success) {
1347     -      alert('Error loading file: ' + result.error);
1348     -      return;
1349     -    }
    1382 +  // Mark as active file
    1383 +  activeFileHandle = fileItem.handle;
1350 1384  
1351     -    // Load content into editor
1352     -    editor.value = result.content;
    1385 +  // Re-render tree to update active state
    1386 +  renderFileTree(folderFiles);
1353 1387  
1354     -    // Mark as active file
1355     -    activeFileHandle = fileItem.handle;
    1388 +  // Render markdown
    1389 +  renderMarkdown();
1356 1390  
1357     -    // Re-render tree to update active state
1358     -    renderFileTree(folderFiles);
    1391 +  console.log(`‚úÖ Loaded file: ${fileItem.name} (${result.size} bytes)`);
    1392 +}
1359 1393  
1360     -    // Render markdown
1361     -    renderMarkdown();
1362     -
1363     -    console.log(`‚úÖ Loaded file: ${fileItem.name} (${result.size} bytes)`);
1364     -  }
1365     -
1366     -  // Expose renderMarkdown globally for theme changes
1367     -  globalRenderMarkdown = renderMarkdown;
    1394 +// Expose renderMarkdown globally for theme changes
    1395 +globalRenderMarkdown = renderMarkdown;
1368 1396  
1369 1397    // DON'T render immediately - wait for theme to load
1370 1398    // renderMarkdown will be called after theme loads above
1371 1399  

```

---

## ü§ñ AI Review Checklist

Please review these changes for:

### üîç Code Quality
- [ ] **Linting Compliance**: No unused imports/variables, proper formatting
- [ ] **Type Safety**: Proper typing throughout (TypeScript/Python type hints)
- [ ] **Best Practices**: Framework-specific conventions and patterns
- [ ] **Performance**: Efficient algorithms, proper memoization
- [ ] **Documentation**: Clear comments and function descriptions

### üêõ Potential Issues
- [ ] **Runtime Errors**: Type mismatches, null/undefined handling
- [ ] **Logic Bugs**: Incorrect calculations, edge cases
- [ ] **Memory Leaks**: Cleanup in lifecycle methods, event listeners
- [ ] **Error Handling**: Proper try-catch blocks, user feedback
- [ ] **Accessibility**: ARIA labels, keyboard navigation, screen readers

### üîí Security & Data
- [ ] **Input Validation**: Sanitization, XSS prevention, SQL injection
- [ ] **Authentication**: Proper access controls and permissions
- [ ] **Privacy**: No sensitive data exposure in logs/client
- [ ] **Dependencies**: Updated packages, vulnerability checks

### üì± UX/UI
- [ ] **Responsive Design**: Mobile/desktop/tablet compatibility
- [ ] **Loading States**: Proper feedback during async operations
- [ ] **Error Messages**: User-friendly error handling and recovery
- [ ] **Performance**: Fast loading, smooth animations

### üí° Suggestions & Improvements
Please provide specific feedback on:
1. Code organization and structure improvements
2. Performance optimization opportunities
3. Security considerations and hardening
4. Testing coverage and strategies
5. Documentation and maintainability

---
*Generated by AI Visual Code Review v2.0 - Unified Export Script*
*Files processed: 5/5 | Errors: 0 | Generated: 2025-12-09T01:34:12.899Z*
