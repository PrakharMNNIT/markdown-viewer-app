# üîç Code Review - 12/19/2025, 7:43:35 PM

**Project:** AI Visual Code Review
**Generated by:** AI Visual Code Review v2.0

## üìä Change Summary

```
AI_REVIEW.md                                  | 5746 ++++++++++++++++---------
 docs/01-requirements/donation-feature-plan.md |   68 +-
 index.html                                    |   36 +
 script.js                                     |   75 +
 style.css                                     |  122 +
 5 files changed, 4093 insertions(+), 1954 deletions(-)
```

## üìù Files Changed (5/5 selected)


### üìÑ `AI_REVIEW.md`

**Type:** Documentation üìñ

```diff
@@ -1,4 +1,4 @@
  1     -# üîç Code Review - 12/19/2025, 4:19:18 PM
      1 +# üîç Code Review - 12/19/2025, 7:30:46 PM
  2   2  
  3   3  **Project:** AI Visual Code Review
  4   4  **Generated by:** AI Visual Code Review v2.0
@@ -6,1956 +6,3814 @@
  6   6  ## üìä Change Summary
  7   7  
  8   8  ```
  9     -.../toc-anchor-navigation-design-v5.md             | 900 +++++++++++++++++++++
 10     - docs/competitive_programming_constraints.md        | 621 ++++++++++++++
 11     - script.js                                          | 255 ++++++
 12     - style.css                                          |  41 +
 13     - variables.css                                      |  19 +-
 14     - 5 files changed, 1831 insertions(+), 5 deletions(-)
      9 +AI_REVIEW.md | 3728 +++++++++++++++++++++++++++++-----------------------------
     10 + 1 file changed, 1832 insertions(+), 1896 deletions(-)
 15  11  ```
 16  12  
 17     -## üìù Files Changed (5/5 selected)
     13 +## üìù Files Changed (1/1 selected)
 18  14  
 19  15  
 20     -### ‚ú® `docs/01-requirements/toc-anchor-navigation-design-v5.md` **[ADDED]**
 21     -
 22     -**Status:** ‚úÖ **NEW FILE** - This file has been newly created
     16 +### üìÑ `AI_REVIEW.md`
 23  17  
 24  18  **Type:** Documentation üìñ
 25  19  
 26  20  ```diff
 27     -@@ -0,0 +1,900 @@
 28     -      1 +# Design Document: Table of Contents Anchor Navigation
 29     -      2 +
 30     -      3 +## Version 5.0 (Production Ready - Final)
 31     -      4 +
 32     -      5 +---
 33     -      6 +
 34     -      7 +**Document ID:** DD-2025-002-TOC-NAV
 35     -      8 +**Author:** Principal SDE
 36     -      9 +**Created:** December 19, 2025
 37     -     10 +**Last Updated:** December 19, 2025
 38     -     11 +**Status:** ‚úÖ **APPROVED FOR IMPLEMENTATION**
 39     -     12 +**Review Cycles:** 8 (v1.0 ‚Üí v2.0 ‚Üí v3.0 ‚Üí v4.0 ‚Üí v4.1 ‚Üí v4.2 ‚Üí v4.3 ‚Üí v5.0)
 40     -     13 +
 41     -     14 +---
 42     -     15 +
 43     -     16 +## Table of Contents
 44     -     17 +
 45     -     18 +1. [Executive Summary](#1-executive-summary)
 46     -     19 +2. [Problem Statement](#2-problem-statement)
 47     -     20 +3. [Requirements](#3-requirements)
 48     -     21 +4. [Technical Design](#4-technical-design)
 49     -     22 +5. [Implementation Details](#5-implementation-details)
 50     -     23 +6. [Browser Compatibility](#6-browser-compatibility)
 51     -     24 +7. [Testing Strategy](#7-testing-strategy)
 52     -     25 +8. [Performance Budget](#8-performance-budget)
 53     -     26 +9. [Security Considerations](#9-security-considerations)
 54     -     27 +10. [Rollback Plan](#10-rollback-plan)
 55     -     28 +11. [FAQ](#11-faq)
 56     -     29 +12. [Approval](#12-approval)
 57     -     30 +13. [Change Log](#13-change-log)
 58     -     31 +
 59     -     32 +---
 60     -     33 +
 61     -     34 +## 1. Executive Summary
 62     -     35 +
 63     -     36 +This document specifies the implementation of in-document anchor navigation for Markdown Viewer Pro. The feature enables clicking Table of Contents links to scroll the preview container to the target heading, with full accessibility support and legacy link compatibility.
 64     -     37 +
 65     -     38 +**Key Features:**
 66     -     39 +- Smooth scroll to headings on TOC link click
 67     -     40 +- Support for emoji and special character headings
 68     -     41 +- Legacy link compatibility (non-standard ID formats)
 69     -     42 +- Accessibility-compliant focus management
 70     -     43 +- Deep linking (URL hash on page load)
 71     -     44 +- Browser history support (back/forward)
 72     -     45 +
 73     -     46 +---
 74     -     47 +
 75     -     48 +## 2. Problem Statement
 76     -     49 +
 77     -     50 +### 2.1 Root Cause
 78     -     51 +
 79     -     52 +The application uses a **non-scrollable document body** (`overflow: hidden`) with content rendered inside a scrollable child container (`.preview-container`). When users click anchor links (`href="#section"`), the browser's native scroll algorithm targets the document viewport‚Äîwhich is non-scrollable‚Äîresulting in **silent failure**.
 80     -     53 +
 81     -     54 +### 2.2 Sticky Toolbar Occlusion
 82     -     55 +
 83     -     56 +The application has a fixed toolbar (height: `60px`). A naive scroll-to-element positions content at `top: 0`, causing it to be **obscured by the toolbar**.
 84     -     57 +
 85     -     58 +### 2.3 Legacy Link Compatibility
 86     -     59 +
 87     -     60 +Existing markdown documents contain manually-created links using non-standard ID formats (e.g., `#üìã-table-of-contents` or `#-standard-assumptions`). These must resolve correctly.
 88     -     61 +
 89     -     62 +### 2.4 App Shell ID Collision
 90     -     63 +
 91     -     64 +The application shell has elements with IDs like `sidebar`, `preview`, `editor`. User-authored headings with the same names must NOT collide with app shell elements.
 92     -     65 +
 93     -     66 +### 2.5 marked.js Singleton Constraint
 94     -     67 +
 95     -     68 +`marked` is imported as a global singleton. Calling `marked.use()` inside `renderMarkdown()` (which runs on every keystroke) would stack infinite extensions, causing:
 96     -     69 +- **Memory leak:** `marked.defaults.extensions` grows infinitely
 97     -     70 +- **Performance degradation:** After 100 keystrokes, marked runs 100 identical renderers
 98     -     71 +
 99     -     72 +---
100     -     73 +
101     -     74 +## 3. Requirements
102     -     75 +
103     -     76 +### 3.1 Functional Requirements
104     -     77 +
105     -     78 +| ID | Requirement | Priority | Acceptance Criteria |
106     -     79 +|----|-------------|----------|---------------------|
107     -     80 +| FR-1 | Internal anchor clicks scroll preview to target | P0 | Target heading visible within 800ms |
108     -     81 +| FR-2 | Scrolled content not occluded by toolbar | P0 | 20px gap between toolbar and heading |
109     -     82 +| FR-3 | URL hash updates on navigation | P0 | URL reflects current section |
110     -     83 +| FR-4 | Deep linking works on page load | P0 | `URL#section` scrolls on load |
111     -     84 +| FR-5 | Browser back/forward navigates history | P1 | Hash changes scroll correctly |
112     -     85 +| FR-6 | Legacy links work (emoji, special chars) | P0 | See compatibility matrix |
113     -     86 +| FR-7 | Focus moves to target for screen readers | P0 | Screen reader announces heading |
114     -     87 +| FR-8 | Empty hash (`#`) scrolls to top | P1 | Container scrollTop = 0 |
115     -     88 +| FR-9 | No collision with app shell IDs | P0 | User `## Sidebar` != app `#sidebar` |
116     -     89 +| FR-10 | Duplicate headings get unique IDs | P0 | `header`, `header-1`, `header-2` |
117     -     90 +
118     -     91 +### 3.2 Non-Functional Requirements
119     -     92 +
120     -     93 +| ID | Requirement | Target |
121     -     94 +|----|-------------|--------|
122     -     95 +| NFR-1 | Click-to-scroll latency | < 16ms (1 frame) |
123     -     96 +| NFR-2 | Scroll animation duration | 300-800ms (distance-based) |
124     -     97 +| NFR-3 | No layout thrashing | 0 forced reflows |
125     -     98 +| NFR-4 | Memory overhead | < 1KB per session |
126     -     99 +| NFR-5 | No memory leaks | Zero extension stacking |
127     -    100 +| NFR-6 | Stateless rendering | Module-level map with reset |
128     -    101 +
129     -    102 +### 3.3 Edge Cases
130     -    103 +
131     -    104 +| Case | Input | Expected Behavior |
132     -    105 +|------|-------|-------------------|
133     -    106 +| Empty hash | `href="#"` | Scroll to top (scrollTop = 0) |
134     -    107 +| Non-existent target | `href="#nonexistent"` | Console warning, no action |
135     -    108 +| External link | `href="https://..."` | Browser default behavior |
136     -    109 +| Duplicate headers | Two `## Header` | IDs: `header`, `header-1` |
137     -    110 +| App shell collision | `## Sidebar` | Resolves to user content, not `#sidebar` |
138     -    111 +| Special chars | `## C++` | ID: `cpp` |
139     -    112 +| Emoji | `## üéØ Goal` | ID: `goal` |
140     -    113 +| Concurrent clicks | Click A, then B rapidly | Cancel A, execute B |
141     -    114 +| Already visible | Target in viewport | Smooth scroll anyway |
142     -    115 +
143     -    116 +---
144     -    117 +
145     -    118 +## 4. Technical Design
146     -    119 +
147     -    120 +### 4.1 Architecture Overview
148     -    121 +
149     -    122 +```
150     -    123 +‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
151     -    124 +‚îÇ                     User Interaction                          ‚îÇ
152     -    125 +‚îÇ  [Click] ‚îÄ‚îÄ‚ñ∫ [hashchange] ‚îÄ‚îÄ‚ñ∫ [Page Load with Hash]          ‚îÇ
153     -    126 +‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
154     -    127 +                       ‚îÇ
155     -    128 +                       ‚ñº
156     -    129 +‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
157     -    130 +‚îÇ                 AnchorNavigation Module                       ‚îÇ
158     -    131 +‚îÇ  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê  ‚îÇ
159     -    132 +‚îÇ  ‚îÇ handleClick()  ‚îÇ  ‚îÇhandleHashChange‚îÇ  ‚îÇhandleInitLoad()‚îÇ  ‚îÇ
160     -    133 +‚îÇ  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò  ‚îÇ
161     -    134 +‚îÇ          ‚îÇ                   ‚îÇ                   ‚îÇ            ‚îÇ
162     -    135 +‚îÇ          ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò            ‚îÇ
163     -    136 +‚îÇ                              ‚ñº                                ‚îÇ
164     -    137 +‚îÇ                   ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê                     ‚îÇ
165     -    138 +‚îÇ                   ‚îÇ  scrollToTarget()   ‚îÇ                     ‚îÇ
166     -    139 +‚îÇ                   ‚îÇ  ‚îî‚îÄ resolveTarget() ‚îÇ  ‚óÑ‚îÄ‚îÄ SCOPED to      ‚îÇ
167     -    140 +‚îÇ                   ‚îÇ  ‚îî‚îÄ scrollIntoView  ‚îÇ      container      ‚îÇ
168     -    141 +‚îÇ                   ‚îÇ  ‚îî‚îÄ manageFocus()   ‚îÇ                     ‚îÇ
169     -    142 +‚îÇ                   ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò                     ‚îÇ
170     -    143 +‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
171     -    144 +```
172     -    145 +
173     -    146 +### 4.2 Slug Generation Algorithm
174     -    147 +
175     -    148 +**Purpose:** Generate consistent, collision-free IDs for headings.
176     -    149 +
177     -    150 +**Algorithm (GitHub-compatible with programming term support):**
178     -    151 +
179     -    152 +```javascript
180     -    153 +// Pre-compiled regex patterns (module level - zero GC pressure)
181     -    154 +const SLUG_REPLACEMENTS = [
182     -    155 +  [/c\+\+/gi, 'cpp'],
183     -    156 +  [/c#/gi, 'csharp'],
184     -    157 +  [/f#/gi, 'fsharp'],
185     -    158 +  [/\.net/gi, 'dotnet'],
186     -    159 +];
187     -    160 +
188     -    161 +/**
189     -    162 + * Generate URL-safe slug from heading text
190     -    163 + * @param {string} text - Raw heading text (may include HTML)
191     -    164 + * @param {Map<string, number>} seen - Duplicate tracking map
192     -    165 + * @returns {string} URL-safe slug
193     -    166 + */
194     -    167 +function generateSlug(text, seen = new Map()) {
195     -    168 +  // Step 0: Strip HTML tags
196     -    169 +  let slug = text.replace(/<[^>]*>/g, '');
197     -    170 +
198     -    171 +  // Step 1: Normalize Unicode (handle caf√© vs caf√©)
199     -    172 +  slug = slug.normalize('NFC');
200     -    173 +
201     -    174 +  // Step 2: Lowercase
202     -    175 +  slug = slug.toLowerCase();
203     -    176 +
204     -    177 +  // Step 3: Replace programming terms (pre-compiled patterns)
205     -    178 +  for (const [pattern, replacement] of SLUG_REPLACEMENTS) {
206     -    179 +    slug = slug.replace(pattern, replacement);
207     -    180 +  }
208     -    181 +
209     -    182 +  // Step 4: Remove non-word chars (keep spaces, hyphens, underscores)
210     -    183 +  slug = slug.replace(/[^\w\s-]/g, '');
211     -    184 +
212     -    185 +  // Step 5: Spaces to hyphens
213     -    186 +  slug = slug.replace(/\s+/g, '-');
214     -    187 +
215     -    188 +  // Step 6: Collapse multiple hyphens
216     -    189 +  slug = slug.replace(/-+/g, '-');
217     -    190 +
218     -    191 +  // Step 7: Trim hyphens
219     -    192 +  slug = slug.replace(/^-+|-+$/g, '');
220     -    193 +
221     -    194 +  // Step 8: Fallback for empty result
222     -    195 +  if (!slug) slug = 'section';
223     -    196 +
224     -    197 +  // Step 9: Handle duplicates (header, header-1, header-2)
225     -    198 +  const baseSlug = slug;
226     -    199 +  const count = seen.get(baseSlug) || 0;
227     -    200 +  if (count > 0) {
228     -    201 +    slug = `${baseSlug}-${count}`;
229     -    202 +  }
230     -    203 +  seen.set(baseSlug, count + 1);
231     -    204 +
232     -    205 +  return slug;
233     -    206 +}
234     -    207 +```
235     -    208 +
236     -    209 +**Transformation Examples:**
237     -    210 +
238     -    211 +| Input | Output | Reason |
239     -    212 +|-------|--------|--------|
240     -    213 +| `Hello World` | `hello-world` | Standard |
241     -    214 +| `üéØ Standard Assumptions` | `standard-assumptions` | Emoji stripped |
242     -    215 +| `C++` | `cpp` | Special replacement |
243     -    216 +| `C#` | `csharp` | Special replacement |
244     -    217 +| `.NET Framework` | `dotnet-framework` | Special replacement |
245     -    218 +| `F#` | `fsharp` | Special replacement |
246     -    219 +| `API v2.0` | `api-v20` | Period stripped |
247     -    220 +| `1. Introduction` | `1-introduction` | Numbers preserved |
248     -    221 +| `hello_world` | `hello_world` | Underscores preserved |
249     -    222 +| `Header` (1st) | `header` | First occurrence |
250     -    223 +| `Header` (2nd) | `header-1` | Duplicate handling |
251     -    224 +| `Header` (3rd) | `header-2` | Duplicate handling |
252     -    225 +| `üòÄüòÄüòÄ` | `section` | Fallback for empty |
253     -    226 +| `--test--` | `test` | Trimmed |
254     -    227 +
255     -    228 +### 4.3 State Management (Singleton-Safe)
256     -    229 +
257     -    230 +**Critical:** `marked` is a global singleton. Extension registration happens ONCE at startup.
258     -    231 +
259     -    232 +```javascript
260     -    233 +// Module level (script.js, near top)
261     -    234 +const headingSlugMap = new Map();
262     -    235 +
263     -    236 +function resetSlugMap() {
264     -    237 +  headingSlugMap.clear();
265     -    238 +}
266     -    239 +
267     -    240 +// In configureMarkedExtensions() - called ONCE at app init
268     -    241 +marked.use({
269     -    242 +  renderer: {
270     -    243 +    heading(token) {
271     -    244 +      const text = this.parser.parseInline(token.tokens);
272     -    245 +      const level = token.depth;
273     -    246 +      const slug = generateSlug(text, headingSlugMap);
274     -    247 +      return `<h${level} id="${slug}">${text}</h${level}>\n`;
275     -    248 +    }
276     -    249 +  }
277     -    250 +});
278     -    251 +
279     -    252 +// In renderMarkdown() - called on every keystroke
280     -    253 +function renderMarkdown() {
281     -    254 +  resetSlugMap();  // Clear state, NOT re-register extension
282     -    255 +  const html = marked.parse(text);
283     -    256 +  // ...
284     -    257 +}
285     -    258 +```
286     -    259 +
287     -    260 +### 4.4 Link Resolution (Scoped Selection)
288     -    261 +
289     -    262 +**Purpose:** Match clicked links to generated IDs, preventing app shell collision.
290     -    263 +
291     -    264 +```javascript
292     -    265 +/**
293     -    266 + * Resolve target element from hash - SCOPED to container
294     -    267 + * @param {string} hash - URL hash (without #)
295     -    268 + * @param {HTMLElement} container - Scrollable container
296     -    269 + * @returns {Element|null} Target element or null
297     -    270 + */
298     -    271 +function resolveTarget(hash, container) {
299     -    272 +  if (!hash) return null;
300     -    273 +
301     -    274 +  // Decode URI components
302     -    275 +  let decodedHash;
303     -    276 +  try {
304     -    277 +    decodedHash = decodeURIComponent(hash);
305     -    278 +  } catch {
306     -    279 +    decodedHash = hash;
307     -    280 +  }
308     -    281 +
309     -    282 +  // Priority 1: Exact ID (SCOPED to container - prevents app shell collision)
310     -    283 +  let target = container.querySelector(`#${CSS.escape(decodedHash)}`);
311     -    284 +  if (target) return target;
312     -    285 +
313     -    286 +  // Priority 2: Normalized ID (handles legacy links)
314     -    287 +  const normalizedHash = normalizeHash(decodedHash);
315     -    288 +  target = container.querySelector(`#${CSS.escape(normalizedHash)}`);
316     -    289 +  if (target) return target;
317     -    290 +
318     -    291 +  console.warn(`[AnchorNav] Target not found: "${hash}"`);
319     -    292 +  return null;
320     -    293 +}
321     -    294 +
322     -    295 +/**
323     -    296 + * Normalize hash for legacy link matching
324     -    297 + */
325     -    298 +function normalizeHash(hash) {
326     -    299 +  let slug = hash.normalize('NFC').toLowerCase();
327     -    300 +
328     -    301 +  for (const [pattern, replacement] of SLUG_REPLACEMENTS) {
329     -    302 +    slug = slug.replace(pattern, replacement);
330     -    303 +  }
331     -    304 +
332     -    305 +  return slug
333     -    306 +    .replace(/[^\w\s-]/g, '')
334     -    307 +    .replace(/\s+/g, '-')
335     -    308 +    .replace(/-+/g, '-')
336     -    309 +    .replace(/^-+|-+$/g, '') || 'section';
337     -    310 +}
338     -    311 +```
339     -    312 +
340     -    313 +---
341     -    314 +
342     -    315 +## 5. Implementation Details
343     -    316 +
344     -    317 +### 5.1 CSS Configuration
345     -    318 +
346     -    319 +**File: `variables.css`** (add to existing `:root`)
347     -    320 +```css
348     -    321 +:root {
349     -    322 +  /* Existing variables... */
350     -    323 +
351     -    324 +  /* Anchor Navigation */
352     -    325 +  --toolbar-height: 60px;
353     -    326 +  --scroll-padding: 20px;
354     -    327 +  --scroll-offset: calc(var(--toolbar-height) + var(--scroll-padding));
355     -    328 +}
356     -    329 +```
357     -    330 +
358     -    331 +**File: `style.css`** (add new section)
359     -    332 +```css
360     -    333 +/* ==================== ANCHOR NAVIGATION ==================== */
361     -    334 +
362     -    335 +/* Scroll padding - SINGLE SOURCE of offset */
363     -    336 +.preview-container {
364     -    337 +  scroll-padding-top: var(--scroll-offset, 80px);
365     -    338 +}
366     -    339 +
367     -    340 +/* Target highlight animation */
368     -    341 +.preview-container :target {
369     -    342 +  animation: anchor-highlight 2s ease-out;
370     -    343 +}
371     -    344 +
372     -    345 +@keyframes anchor-highlight {
373     -    346 +  0% { background-color: rgba(255, 255, 0, 0.3); }
374     -    347 +  100% { background-color: transparent; }
375     -    348 +}
376     -    349 +
377     -    350 +/* Focus management - conditional outline */
378     -    351 +.preview-container h1[id]:focus:not(:focus-visible),
379     -    352 +.preview-container h2[id]:focus:not(:focus-visible),
380     -    353 +.preview-container h3[id]:focus:not(:focus-visible),
381     -    354 +.preview-container h4[id]:focus:not(:focus-visible),
382     -    355 +.preview-container h5[id]:focus:not(:focus-visible),
383     -    356 +.preview-container h6[id]:focus:not(:focus-visible) {
384     -    357 +  outline: none;
385     -    358 +}
386     -    359 +
387     -    360 +/* Keyboard focus gets visible indicator */
388     -    361 +.preview-container h1[id]:focus-visible,
389     -    362 +.preview-container h2[id]:focus-visible,
390     -    363 +.preview-container h3[id]:focus-visible,
391     -    364 +.preview-container h4[id]:focus-visible,
392     -    365 +.preview-container h5[id]:focus-visible,
393     -    366 +.preview-container h6[id]:focus-visible {
394     -    367 +  outline: 2px solid var(--primary-color, #007bff);
395     -    368 +  outline-offset: 4px;
396     -    369 +  border-radius: 2px;
397     -    370 +}
398     -    371 +```
399     -    372 +
400     -    373 +### 5.2 JavaScript Implementation
401     -    374 +
402     -    375 +**File: `script.js`** (modifications)
403     -    376 +
404     -    377 +```javascript
405     -    378 +// ==================== ANCHOR NAVIGATION ====================
406     -    379 +// Add near top of file, after imports
407     -    380 +
408     -    381 +// Heading slug tracking (module-level singleton)
409     -    382 +const headingSlugMap = new Map();
410     -    383 +
411     -    384 +// Pre-compiled slug replacements (zero GC pressure)
412     -    385 +const SLUG_REPLACEMENTS = [
413     -    386 +  [/c\+\+/gi, 'cpp'],
414     -    387 +  [/c#/gi, 'csharp'],
415     -    388 +  [/f#/gi, 'fsharp'],
416     -    389 +  [/\.net/gi, 'dotnet'],
417     -    390 +];
418     -    391 +
419     -    392 +/**
420     -    393 + * Reset slug map (call before each parse)
421     -    394 + */
422     -    395 +function resetSlugMap() {
423     -    396 +  headingSlugMap.clear();
424     -    397 +}
425     -    398 +
426     -    399 +/**
427     -    400 + * Generate URL-safe slug from heading text
428     -    401 + */
429     -    402 +function generateSlug(text, seen = headingSlugMap) {
430     -    403 +  // Strip HTML tags
431     -    404 +  let slug = text.replace(/<[^>]*>/g, '');
432     -    405 +
433     -    406 +  // Normalize Unicode
434     -    407 +  slug = slug.normalize('NFC').toLowerCase();
435     -    408 +
436     -    409 +  // Replace programming terms
437     -    410 +  for (const [pattern, replacement] of SLUG_REPLACEMENTS) {
438     -    411 +    slug = slug.replace(pattern, replacement);
439     -    412 +  }
440     -    413 +
441     -    414 +  // Clean up
442     -    415 +  slug = slug
443     -    416 +    .replace(/[^\w\s-]/g, '')
444     -    417 +    .replace(/\s+/g, '-')
445     -    418 +    .replace(/-+/g, '-')
446     -    419 +    .replace(/^-+|-+$/g, '');
447     -    420 +
448     -    421 +  if (!slug) slug = 'section';
449     -    422 +
450     -    423 +  // Handle duplicates
451     -    424 +  const baseSlug = slug;
452     -    425 +  const count = seen.get(baseSlug) || 0;
453     -    426 +  if (count > 0) slug = `${baseSlug}-${count}`;
454     -    427 +  seen.set(baseSlug, count + 1);
455     -    428 +
456     -    429 +  return slug;
457     -    430 +}
458     -    431 +
459     -    432 +/**
460     -    433 + * Anchor Navigation Module
461     -    434 + */
462     -    435 +const AnchorNavigation = {
463     -    436 +  container: null,
464     -    437 +  pendingScroll: null,
465     -    438 +
466     -    439 +  /**
467     -    440 +   * Initialize anchor navigation
468     -    441 +   */
469     -    442 +  init(previewContainer) {
470     -    443 +    this.container = previewContainer;
471     -    444 +
472     -    445 +    // Event delegation for clicks
473     -    446 +    this.container.addEventListener('click', this.handleClick.bind(this));
474     -    447 +
475     -    448 +    // Browser back/forward
476     -    449 +    window.addEventListener('hashchange', this.handleHashChange.bind(this));
477     -    450 +
478     -    451 +    // Initial page load with hash
479     -    452 +    if (window.location.hash) {
480     -    453 +      requestAnimationFrame(() => {
481     -    454 +        this.scrollToHash(window.location.hash.slice(1), false);
482     -    455 +      });
483     -    456 +    }
484     -    457 +  },
485     -    458 +
486     -    459 +  /**
487     -    460 +   * Handle click events (delegated)
488     -    461 +   */
489     -    462 +  handleClick(event) {
490     -    463 +    const link = event.target.closest('a[href^="#"]');
491     -    464 +    if (!link) return;
492     -    465 +
493     -    466 +    // Ignore external links
494     -    467 +    if (link.hostname && link.hostname !== window.location.hostname) return;
495     -    468 +
496     -    469 +    event.preventDefault();
497     -    470 +
498     -    471 +    const hash = link.getAttribute('href').slice(1);
499     -    472 +    this.scrollToHash(hash, true);
500     -    473 +
501     -    474 +    // Update URL
502     -    475 +    history.pushState(null, '', `#${hash}`);
503     -    476 +  },
504     -    477 +
505     -    478 +  /**
506     -    479 +   * Handle hashchange (back/forward)
507     -    480 +   */
508     -    481 +  handleHashChange() {
509     -    482 +    const hash = window.location.hash.slice(1);
510     -    483 +    if (hash) {
511     -    484 +      this.scrollToHash(hash, true);
512     -    485 +    } else {
513     -    486 +      this.scrollToTop(true);
514     -    487 +    }
515     -    488 +  },
516     -    489 +
517     -    490 +  /**
518     -    491 +   * Scroll to element by hash
519     -    492 +   */
520     -    493 +  scrollToHash(hash, smooth = true) {
521     -    494 +    // Cancel pending scroll (handle concurrent clicks)
522     -    495 +    if (this.pendingScroll) {
523     -    496 +      clearTimeout(this.pendingScroll);
524     -    497 +      this.pendingScroll = null;
525     -    498 +    }
526     -    499 +
527     -    500 +    if (!hash) {
528     -    501 +      this.scrollToTop(smooth);
529     -    502 +      return;
530     -    503 +    }
531     -    504 +
532     -    505 +    const target = this.resolveTarget(hash);
533     -    506 +    if (!target) return;
534     -    507 +
535     -    508 +    target.scrollIntoView({
536     -    509 +      behavior: smooth ? 'smooth' : 'instant',
537     -    510 +      block: 'start',
538     -    511 +    });
539     -    512 +
540     -    513 +    this.manageFocus(target, smooth);
541     -    514 +  },
542     -    515 +
543     -    516 +  /**
544     -    517 +   * Scroll to top
545     -    518 +   */
546     -    519 +  scrollToTop(smooth = true) {
547     -    520 +    this.container.scrollTo({
548     -    521 +      top: 0,
549     -    522 +      behavior: smooth ? 'smooth' : 'instant',
550     -    523 +    });
551     -    524 +  },
552     -    525 +
553     -    526 +  /**
554     -    527 +   * Resolve target - SCOPED to container
555     -    528 +   */
556     -    529 +  resolveTarget(hash) {
557     -    530 +    if (!hash) return null;
558     -    531 +
559     -    532 +    let decodedHash;
560     -    533 +    try {
561     -    534 +      decodedHash = decodeURIComponent(hash);
562     -    535 +    } catch {
563     -    536 +      decodedHash = hash;
564     -    537 +    }
565     -    538 +
566     -    539 +    // Priority 1: Exact ID (scoped)
567     -    540 +    let target = this.container.querySelector(`#${CSS.escape(decodedHash)}`);
568     -    541 +    if (target) return target;
569     -    542 +
570     -    543 +    // Priority 2: Normalized ID (scoped)
571     -    544 +    const normalized = this.normalizeHash(decodedHash);
572     -    545 +    target = this.container.querySelector(`#${CSS.escape(normalized)}`);
573     -    546 +    if (target) return target;
574     -    547 +
575     -    548 +    console.warn(`[AnchorNav] Target not found: "${hash}"`);
576     -    549 +    return null;
577     -    550 +  },
578     -    551 +
579     -    552 +  /**
580     -    553 +   * Normalize hash for legacy link matching
581     -    554 +   */
582     -    555 +  normalizeHash(hash) {
583     -    556 +    let slug = hash.normalize('NFC').toLowerCase();
584     -    557 +
585     -    558 +    for (const [pattern, replacement] of SLUG_REPLACEMENTS) {
586     -    559 +      slug = slug.replace(pattern, replacement);
587     -    560 +    }
588     -    561 +
589     -    562 +    return slug
590     -    563 +      .replace(/[^\w\s-]/g, '')
591     -    564 +      .replace(/\s+/g, '-')
592     -    565 +      .replace(/-+/g, '-')
593     -    566 +      .replace(/^-+|-+$/g, '') || 'section';
594     -    567 +  },
595     -    568 +
596     -    569 +  /**
597     -    570 +   * Manage focus after scroll
598     -    571 +   */
599     -    572 +  manageFocus(target, smooth) {
600     -    573 +    const focusTarget = () => {
601     -    574 +      if (!target.hasAttribute('tabindex')) {
602     -    575 +        target.setAttribute('tabindex', '-1');
603     -    576 +      }
604     -    577 +      target.focus({ preventScroll: true });
605     -    578 +    };
606     -    579 +
607     -    580 +    if (!smooth) {
608     -    581 +      focusTarget();
609     -    582 +      return;
610     -    583 +    }
611     -    584 +
612     -    585 +    // Modern: scrollend event
613     -    586 +    if ('onscrollend' in this.container) {
614     -    587 +      this.container.addEventListener('scrollend', focusTarget, { once: true });
615     -    588 +    } else {
616     -    589 +      // Fallback: estimate duration (max 1000ms for safety)
617     -    590 +      const distance = Math.abs(target.getBoundingClientRect().top);
618     -    591 +      const duration = Math.min(Math.max(distance / 2, 300), 1000);
619     -    592 +      this.pendingScroll = setTimeout(focusTarget, duration + 50);
620     -    593 +    }
621     -    594 +  },
622     -    595 +};
623     -    596 +```
624     -    597 +
625     -    598 +### 5.3 Integration Points
626     -    599 +
627     -    600 +**In `configureMarkedExtensions()`:**
628     -    601 +```javascript
629     -    602 +function configureMarkedExtensions() {
630     -    603 +  // ... existing extensions ...
631     -    604 +
632     -    605 +  // Custom heading renderer with ID generation
633     -    606 +  marked.use({
634     -    607 +    renderer: {
635     -    608 +      heading(token) {
636     -    609 +        const text = this.parser.parseInline(token.tokens);
637     -    610 +        const level = token.depth;
638     -    611 +        const slug = generateSlug(text, headingSlugMap);
639     -    612 +        return `<h${level} id="${slug}">${text}</h${level}>\n`;
640     -    613 +      }
641     -    614 +    }
642     -    615 +  });
643     -    616 +  console.log('‚úÖ Custom heading renderer enabled (ID generation)');
644     -    617 +}
645     -    618 +```
646     -    619 +
647     -    620 +**In `renderMarkdown()`:**
648     -    621 +```javascript
649     -    622 +function renderMarkdown() {
650     -    623 +  try {
651     -    624 +    resetSlugMap();  // Clear slug tracking before parse
652     -    625 +
653     -    626 +    const markdownText = editor.value;
654     -    627 +    let html = marked.parse(markdownText);
655     -    628 +    // ... rest of existing logic ...
656     -    629 +  }
657     -    630 +}
658     -    631 +```
659     -    632 +
660     -    633 +**In `setupEditor()` (at end):**
661     -    634 +```javascript
662     -    635 +// Initialize anchor navigation
663     -    636 +AnchorNavigation.init(previewContainer);
664     -    637 +```
665     -    638 +
666     -    639 +---
667     -    640 +
668     -    641 +## 6. Browser Compatibility
669     -    642 +
670     -    643 +| Feature | Chrome | Firefox | Safari | Edge | Fallback |
671     -    644 +|---------|--------|---------|--------|------|----------|
672     -    645 +| `scrollIntoView({ behavior })` | 61+ | 36+ | 15.4+ | 79+ | Instant scroll |
673     -    646 +| `scrollend` event | 114+ | 109+ | 17+ | 114+ | setTimeout (1000ms max) |
674     -    647 +| `scroll-padding-top` | 69+ | 68+ | 14.1+ | 79+ | None needed |
675     -    648 +| `CSS.escape()` | 46+ | 31+ | 10+ | 79+ | None needed |
676     -    649 +| `:focus-visible` | 86+ | 85+ | 15.4+ | 86+ | Always show outline |
677     -    650 +
678     -    651 +**Minimum Supported:** Chrome 86, Firefox 85, Safari 15.4, Edge 86
679     -    652 +
680     -    653 +---
681     -    654 +
682     -    655 +## 7. Testing Strategy
683     -    656 +
684     -    657 +### 7.1 Unit Tests
685     -    658 +
686     -    659 +**File: `tests/unit/utils/anchorNavigation.test.js`**
687     -    660 +
688     -    661 +```javascript
689     -    662 +import { describe, it, expect, beforeEach } from 'vitest';
690     -    663 +
691     -    664 +describe('generateSlug', () => {
692     -    665 +  let seen;
693     -    666 +
694     -    667 +  beforeEach(() => {
695     -    668 +    seen = new Map();
696     -    669 +  });
697     -    670 +
698     -    671 +  describe('basic transformations', () => {
699     -    672 +    it('converts to lowercase', () => {
700     -    673 +      expect(generateSlug('HELLO', seen)).toBe('hello');
701     -    674 +    });
702     -    675 +
703     -    676 +    it('replaces spaces with hyphens', () => {
704     -    677 +      expect(generateSlug('hello world', seen)).toBe('hello-world');
705     -    678 +    });
706     -    679 +
707     -    680 +    it('preserves numbers', () => {
708     -    681 +      expect(generateSlug('Section 1', seen)).toBe('section-1');
709     -    682 +    });
710     -    683 +
711     -    684 +    it('preserves underscores', () => {
712     -    685 +      expect(generateSlug('hello_world', seen)).toBe('hello_world');
713     -    686 +    });
714     -    687 +  });
715     -    688 +
716     -    689 +  describe('special characters', () => {
717     -    690 +    it('removes emoji', () => {
718     -    691 +      expect(generateSlug('üéØ Goal', seen)).toBe('goal');
719     -    692 +    });
720     -    693 +
721     -    694 +    it('handles C++', () => {
722     -    695 +      expect(generateSlug('C++', seen)).toBe('cpp');
723     -    696 +    });
724     -    697 +
725     -    698 +    it('handles C#', () => {
726     -    699 +      expect(generateSlug('C#', seen)).toBe('csharp');
727     -    700 +    });
728     -    701 +
729     -    702 +    it('handles F#', () => {
730     -    703 +      expect(generateSlug('F#', seen)).toBe('fsharp');
731     -    704 +    });
732     -    705 +
733     -    706 +    it('handles .NET', () => {
734     -    707 +      expect(generateSlug('.NET Framework', seen)).toBe('dotnet-framework');
735     -    708 +    });
736     -    709 +
737     -    710 +    it('strips periods', () => {
738     -    711 +      expect(generateSlug('API v2.0', seen)).toBe('api-v20');
739     -    712 +    });
740     -    713 +  });
741     -    714 +
742     -    715 +  describe('edge cases', () => {
743     -    716 +    it('collapses multiple hyphens', () => {
744     -    717 +      expect(generateSlug('hello--world', seen)).toBe('hello-world');
745     -    718 +    });
746     -    719 +
747     -    720 +    it('trims leading hyphens', () => {
748     -    721 +      expect(generateSlug('--hello', seen)).toBe('hello');
749     -    722 +    });
750     -    723 +
751     -    724 +    it('trims trailing hyphens', () => {
752     -    725 +      expect(generateSlug('hello--', seen)).toBe('hello');
753     -    726 +    });
754     -    727 +
755     -    728 +    it('returns "section" for empty result', () => {
756     -    729 +      expect(generateSlug('!!!', seen)).toBe('section');
757     -    730 +      expect(generateSlug('üòÄüòÄüòÄ', seen)).toBe('section');
758     -    731 +    });
759     -    732 +
760     -    733 +    it('handles unicode normalization', () => {
761     -    734 +      expect(generateSlug('caf√©', seen)).toBe('caf');
762     -    735 +    });
763     -    736 +
764     -    737 +    it('strips HTML tags', () => {
765     -    738 +      expect(generateSlug('<strong>Bold</strong> text', seen)).toBe('bold-text');
766     -    739 +    });
767     -    740 +  });
768     -    741 +
769     -    742 +  describe('duplicate handling', () => {
770     -    743 +    it('adds suffix for duplicates', () => {
771     -    744 +      expect(generateSlug('Header', seen)).toBe('header');
772     -    745 +      expect(generateSlug('Header', seen)).toBe('header-1');
773     -    746 +      expect(generateSlug('Header', seen)).toBe('header-2');
774     -    747 +    });
775     -    748 +
776     -    749 +    it('tracks different bases separately', () => {
777     -    750 +      expect(generateSlug('Header', seen)).toBe('header');
778     -    751 +      expect(generateSlug('Footer', seen)).toBe('footer');
779     -    752 +      expect(generateSlug('Header', seen)).toBe('header-1');
780     -    753 +    });
781     -    754 +  });
782     -    755 +});
783     -    756 +
784     -    757 +describe('normalizeHash', () => {
785     -    758 +  it('normalizes legacy emoji links', () => {
786     -    759 +    expect(normalizeHash('üéØ-standard-assumptions')).toBe('standard-assumptions');
787     -    760 +  });
788     -    761 +
789     -    762 +  it('normalizes leading hyphens', () => {
790     -    763 +    expect(normalizeHash('-hello-world-')).toBe('hello-world');
791     -    764 +  });
792     -    765 +
793     -    766 +  it('handles programming terms', () => {
794     -    767 +    expect(normalizeHash('c++')).toBe('cpp');
795     -    768 +  });
796     -    769 +});
797     -    770 +```
798     -    771 +
799     -    772 +### 7.2 Manual Test Cases
800     -    773 +
801     -    774 +| # | Scenario | Steps | Expected Result |
802     -    775 +|---|----------|-------|-----------------|
803     -    776 +| 1 | Standard TOC click | Click TOC link `#introduction` | Scrolls to heading, visible below toolbar |
804     -    777 +| 2 | Emoji header | Click `#üéØ-goal` | Resolves to `#goal`, scrolls correctly |
805     -    778 +| 3 | C++ header | Click `#c++` | Resolves to `#cpp`, scrolls correctly |
806     -    779 +| 4 | Deep link | Load `URL#section-1` | Page scrolls to section on load |
807     -    780 +| 5 | Browser back | Click link, then browser back | Returns to previous scroll position |
808     -    781 +| 6 | Empty hash | Click `href="#"` | Scrolls to top of container |
809     -    782 +| 7 | Invalid target | Click `#nonexistent` | Console warning, no crash |
810     -    783 +| 8 | Duplicate headers | Two `## Header` | First is `#header`, second is `#header-1` |
811     -    784 +| 9 | App shell collision | `## Sidebar` heading | Scrolls to user heading, not app `#sidebar` |
812     -    785 +| 10 | Accessibility | Tab to link, press Enter | Focus moves to heading, screen reader announces |
813     -    786 +| 11 | Concurrent clicks | Click A, immediately click B | Only B executes |
814     -    787 +
815     -    788 +---
816     -    789 +
817     -    790 +## 8. Performance Budget
818     -    791 +
819     -    792 +| Metric | Budget | Measurement Method |
820     -    793 +|--------|--------|-------------------|
821     -    794 +| Click-to-scroll latency | < 16ms | `performance.now()` delta |
822     -    795 +| Slug generation per heading | < 1ms | Profile in DevTools |
823     -    796 +| DOM queries per click | ‚â§ 2 | Code review |
824     -    797 +| Memory per session | < 1KB | DevTools heap snapshot |
825     -    798 +| Extension stack size | 1 (no growth) | `marked.defaults.extensions.length` |
826     -    799 +
827     -    800 +---
828     -    801 +
829     -    802 +## 9. Security Considerations
830     -    803 +
831     -    804 +| Concern | Risk | Mitigation |
832     -    805 +|---------|------|------------|
833     -    806 +| XSS via hash | Low | Hash is never inserted into innerHTML |
834     -    807 +| Open redirect | Low | Only same-origin hashes processed |
835     -    808 +| DoS (rapid clicks) | Low | Pending scroll cancellation |
836     -    809 +| Invalid ID injection | Low | `CSS.escape()` for selectors |
837     -    810 +| HTML in headings | Medium | Tags stripped before slug generation |
838     -    811 +
839     -    812 +---
840     -    813 +
841     -    814 +## 10. Rollback Plan
842     -    815 +
843     -    816 +### 10.1 Affected Files
844     -    817 +
845     -    818 +| File | Changes |
846     -    819 +|------|---------|
847     -    820 +| `script.js` | Add AnchorNavigation module, generateSlug, heading renderer |
848     -    821 +| `style.css` | Add scroll-padding, focus-visible styles |
849     -    822 +| `variables.css` | Add --scroll-offset variable |
850     -    823 +
851     -    824 +### 10.2 Rollback Command
852     -    825 +
853     -    826 +```bash
854     -    827 +git checkout HEAD~1 -- script.js style.css variables.css
855     -    828 +```
856     -    829 +
857     -    830 +### 10.3 Rollback Criteria
858     -    831 +
859     -    832 +- Any markdown rendering regression
860     -    833 +- JavaScript console errors
861     -    834 +- Theme switching broken
862     -    835 +- Memory leak detected (extension stacking)
863     -    836 +
864     -    837 +### 10.4 Verification Steps
865     -    838 +
866     -    839 +1. Reload application
867     -    840 +2. Verify no console errors
868     -    841 +3. Type in editor, verify preview updates
869     -    842 +4. Switch themes, verify no errors
870     -    843 +5. Check `marked.defaults` has stable extension count
871     -    844 +
872     -    845 +---
873     -    846 +
874     -    847 +## 11. FAQ
875     -    848 +
876     -    849 +**Q1: Will this break existing functionality?**
877     -    850 +> No. This is an additive feature. Existing markdown rendering is unchanged.
878     -    851 +
879     -    852 +**Q2: What if a heading contains only emoji?**
880     -    853 +> The slug becomes `section` (fallback for empty result).
881     -    854 +
882     -    855 +**Q3: Will this affect HTML export?**
883     -    856 +> Exported HTML will include the generated IDs. Navigation will work if opened in a browser.
884     -    857 +
885     -    858 +**Q4: What about very long headings?**
886     -    859 +> No length limit. The full heading becomes the slug (performance tested up to 1000 chars).
887     -    860 +
888     -    861 +**Q5: Can users manually specify IDs?**
889     -    862 +> Not currently. This would require parsing `{#custom-id}` syntax, which is a future enhancement.
890     -    863 +
891     -    864 +**Q6: What if `marked.use()` is accidentally called in `renderMarkdown()`?**
892     -    865 +> This would cause extension stacking (memory leak). The design explicitly prevents this by registering ONCE in `configureMarkedExtensions()` and only calling `resetSlugMap()` per render.
893     -    866 +
894     -    867 +**Q7: Why use `CSS.escape()` instead of simple string matching?**
895     -    868 +> IDs can contain special CSS selector characters (`.`, `#`, `:`). `CSS.escape()` ensures the querySelector doesn't break.
896     -    869 +
897     -    870 +**Q8: What's the maximum scroll duration?**
898     -    871 +> Capped at 1000ms for the `scrollend` fallback timeout. Smooth scroll itself is browser-controlled.
899     -    872 +
900     -    873 +---
901     -    874 +
902     -    875 +## 12. Approval
903     -    876 +
904     -    877 +| Role | Name | Date | Status |
905     -    878 +|------|------|------|--------|
906     -    879 +| Author | Principal SDE | 2025-12-19 | ‚úÖ Complete |
907     -    880 +| Reviewer | Gemini | 2025-12-19 | ‚úÖ Approved |
908     -    881 +| Implementation | Pending | - | ‚è≥ Ready |
909     -    882 +
910     -    883 +---
911     -    884 +
912     -    885 +## 13. Change Log
913     -    886 +
914     -    887 +| Version | Date | Author | Changes |
915     -    888 +|---------|------|--------|---------|
916     -    889 +| 1.0 | 2025-12-19 | Principal SDE | Initial draft |
917     -    890 +| 2.0 | 2025-12-19 | Principal SDE | Added requirements, edge cases |
918     -    891 +| 3.0 | 2025-12-19 | Gemini | Strict compliance version |
919     -    892 +| 4.0 | 2025-12-19 | Principal SDE | Production-ready with full implementation |
920     -    893 +| 4.1 | 2025-12-19 | Principal SDE | Fixed double offset, pre-compiled regex |
921     -    894 +| 4.2 | 2025-12-19 | Principal SDE | Scoped selection, focus-visible |
922     -    895 +| 4.3 | 2025-12-19 | Gemini | Identified singleton bug |
923     -    896 +| 5.0 | 2025-12-19 | Principal SDE | **FINAL** - Module-level map, reset pattern, singleton-safe |
924     -    897 +
925     -    898 +---
926     -    899 +
927     -    900 +**End of Document**
928     -    901  
929     -
930     -```
931     -
932     -
933     -### ‚ú® `docs/competitive_programming_constraints.md` **[ADDED]**
934     -
935     -**Status:** ‚úÖ **NEW FILE** - This file has been newly created
936     -
937     -**Type:** Documentation üìñ
938     -
939     -```diff
940     -@@ -0,0 +1,621 @@
941     -      1 +# üéØ Coding Interview & Competitive Programming Constraints Guide
942     -      2 +
943     -      3 +### üìù 2025-12-19
944     -      4 +**Category**: `interview prep` | **Level**: `Essential` | **Time**: `15 min read`
945     -      5 +
946     -      6 +> **Master the numbers** that every competitive programmer and interviewee should know by heart!
947     -      7 +
948     -      8 +---
949     -      9 +
950     -     10 +## üìã Table of Contents
951     -     11 +
952     -     12 +1. [Standard Assumptions](#-standard-assumptions)
953     -     13 +2. [Integer Limits & Data Types](#-integer-limits--data-types)
954     -     14 +3. [Array & Container Constraints](#-array--container-constraints)
955     -     15 +4. [String Constraints](#-string-constraints)
956     -     16 +5. [Time Complexity Limits](#-time-complexity-limits)
957     -     17 +6. [Space Complexity Limits](#-space-complexity-limits)
958     -     18 +7. [Common Primes & Mathematical Constants](#-common-primes--mathematical-constants)
959     -     19 +8. [Edge Cases Checklist](#-edge-cases-checklist)
960     -     20 +9. [Platform-Specific Constraints](#-platform-specific-constraints)
961     -     21 +10. [Quick Reference Cheatsheet](#-quick-reference-cheatsheet)
962     -     22 +
963     -     23 +---
964     -     24 +
965     -     25 +## üéØ Standard Assumptions
966     -     26 +
967     -     27 +### The Golden Rules
968     -     28 +
969     -     29 +| Assumption | Typical Value | Reasoning |
970     -     30 +|------------|---------------|-----------|
971     -     31 +| **Time Limit** | 1-2 seconds | ~10‚Å∏ simple operations/second |
972     -     32 +| **Memory Limit** | 256 MB | Standard competitive programming |
973     -     33 +| **Max Input Size (n)** | 10‚Åµ to 10‚Å∂ | Fits in memory, allows O(n log n) |
974     -     34 +| **Max Integer Value** | 10‚Åπ | Fits in `int` |
975     -     35 +| **Large Integer Value** | 10¬π‚Å∏ | Requires `long long` |
976     -     36 +
977     -     37 +### What to Ask in Interviews
978     -     38 +
979     -     39 +1. **Input size constraints?** (n ‚â§ ?)
980     -     40 +2. **Value range?** (values ‚â§ ?)
981     -     41 +3. **Can values be negative?**
982     -     42 +4. **Are there duplicates?**
983     -     43 +5. **Is input sorted?**
984     -     44 +6. **Can input be empty?**
985     -     45 +
986     -     46 +---
987     -     47 +
988     -     48 +## üî¢ Integer Limits & Data Types
989     -     49 +
990     -     50 +### Standard Integer Ranges
991     -     51 +
992     -     52 +| Type | Bytes | Range | Max (~) | Use When |
993     -     53 +|------|-------|-------|---------|----------|
994     -     54 +| `int` | 4 | -2¬≥¬π to 2¬≥¬π-1 | ¬±2.1√ó10‚Åπ | Default choice |
995     -     55 +| `unsigned int` | 4 | 0 to 2¬≥¬≤-1 | 4.3√ó10‚Åπ | Non-negative only |
996     -     56 +| `long long` | 8 | -2‚Å∂¬≥ to 2‚Å∂¬≥-1 | ¬±9.2√ó10¬π‚Å∏ | Large values |
997     -     57 +| `unsigned long long` | 8 | 0 to 2‚Å∂‚Å¥-1 | 1.8√ó10¬π‚Åπ | Very large non-negative |
998     -     58 +
999     -     59 +### Critical Constants (MEMORIZE!)
1000     -     60 +
1001     -     61 +```cpp
1002     -     62 +#include <climits>
1003     -     63 +
1004     -     64 +INT_MAX    =  2,147,483,647      // ‚âà 2.1 √ó 10‚Åπ
1005     -     65 +INT_MIN    = -2,147,483,648      // ‚âà -2.1 √ó 10‚Åπ
1006     -     66 +LLONG_MAX  =  9,223,372,036,854,775,807  // ‚âà 9.2 √ó 10¬π‚Å∏
1007     -     67 +LLONG_MIN  = -9,223,372,036,854,775,808  // ‚âà -9.2 √ó 10¬π‚Å∏
1008     -     68 +
1009     -     69 +// Quick mental math
1010     -     70 +INT_MAX   ‚âà 2 √ó 10‚Åπ    (2 billion)
1011     -     71 +LLONG_MAX ‚âà 9 √ó 10¬π‚Å∏   (9 quintillion)
1012     -     72 +```
1013     -     73 +
1014     -     74 +### When to Use Which Type
1015     -     75 +
1016     -     76 +| Problem Constraint | Type to Use | Example |
1017     -     77 +|-------------------|-------------|---------|
1018     -     78 +| n ‚â§ 10‚Åµ, values ‚â§ 10‚Åπ | `int` | Most problems |
1019     -     79 +| Values > 2√ó10‚Åπ | `long long` | Large sums, products |
1020     -     80 +| Sum of n elements, n ‚â§ 10‚Åµ | `long long` | 10‚Åµ √ó 10‚Åπ = 10¬π‚Å¥ |
1021     -     81 +| Product of elements | `long long` or modulo | Overflow danger! |
1022     -     82 +| n √ó n where n ‚â§ 10‚Åµ | `long long` | 10¬π‚Å∞ > INT_MAX |
1023     -     83 +
1024     -     84 +### ‚ö†Ô∏è Overflow Danger Zones
1025     -     85 +
1026     -     86 +```cpp
1027     -     87 +// ‚ùå OVERFLOW! (10‚Åµ √ó 10‚Åµ = 10¬π‚Å∞ > INT_MAX)
1028     -     88 +int n = 100000;
1029     -     89 +int result = n * n;  // WRONG!
1030     -     90 +
1031     -     91 +// ‚úÖ SAFE
1032     -     92 +long long result = (long long)n * n;
1033     -     93 +long long result = 1LL * n * n;
1034     -     94 +
1035     -     95 +// ‚ùå OVERFLOW! (sum of 10‚Åµ elements each up to 10‚Åπ)
1036     -     96 +int sum = 0;
1037     -     97 +for (int x : arr) sum += x;  // WRONG if arr is large!
1038     -     98 +
1039     -     99 +// ‚úÖ SAFE
1040     -    100 +long long sum = 0;
1041     -    101 +for (int x : arr) sum += x;
1042     -    102 +```
1043     -    103 +
1044     -    104 +### Modular Arithmetic
1045     -    105 +
1046     -    106 +When problem says "answer modulo 10‚Åπ+7":
1047     -    107 +
1048     -    108 +```cpp
1049     -    109 +const int MOD = 1e9 + 7;  // 1,000,000,007 (prime)
1050     -    110 +
1051     -    111 +// Addition
1052     -    112 +(a + b) % MOD
1053     -    113 +
1054     -    114 +// Subtraction (add MOD to avoid negative)
1055     -    115 +((a - b) % MOD + MOD) % MOD
1056     -    116 +
1057     -    117 +// Multiplication
1058     -    118 +(1LL * a * b) % MOD  // Cast to long long first!
1059     -    119 +
1060     -    120 +// Common modulo values
1061     -    121 +10‚Åπ + 7  = 1,000,000,007  // Most common (prime)
1062     -    122 +10‚Åπ + 9  = 1,000,000,009  // Also prime
1063     -    123 +998244353                  // FFT-friendly prime (2¬≤¬≥ √ó 7 √ó 17 + 1)
1064     -    124 +```
1065     -    125 +
1066     -    126 +---
1067     -    127 +
1068     -    128 +## üìä Array & Container Constraints
1069     -    129 +
1070     -    130 +### Maximum Array Sizes
1071     -    131 +
1072     -    132 +| Memory | Max Elements (`int`) | Max Elements (`long long`) |
1073     -    133 +|--------|---------------------|---------------------------|
1074     -    134 +| 256 MB | ~64 million | ~32 million |
1075     -    135 +| 512 MB | ~128 million | ~64 million |
1076     -    136 +| 1 GB | ~256 million | ~128 million |
1077     -    137 +
1078     -    138 +**Formula:** Max elements = Memory / sizeof(type)
1079     -    139 +- 256 MB = 256 √ó 10‚Å∂ bytes
1080     -    140 +- int array: 256 √ó 10‚Å∂ / 4 = 64 √ó 10‚Å∂
1081     -    141 +
1082     -    142 +### Typical Constraints by Problem Type
1083     -    143 +
1084     -    144 +| Problem Type | Typical n | Expected Complexity |
1085     -    145 +|--------------|-----------|-------------------|
1086     -    146 +| Easy | ‚â§ 10¬≥ | O(n¬≤) acceptable |
1087     -    147 +| Medium | ‚â§ 10‚Åµ | O(n log n) expected |
1088     -    148 +| Hard | ‚â§ 10‚Å∂ | O(n) or O(n log n) |
1089     -    149 +| Very Hard | ‚â§ 10‚Å∑ | O(n) only |
1090     -    150 +
1091     -    151 +### 2D Array Limits
1092     -    152 +
1093     -    153 +```cpp
1094     -    154 +// Max 2D array with 256MB memory
1095     -    155 +// n √ó m √ó sizeof(int) ‚â§ 256 √ó 10‚Å∂
1096     -    156 +
1097     -    157 +// Safe limits:
1098     -    158 +int arr[1000][1000];     // 4 MB - ‚úÖ Safe
1099     -    159 +int arr[5000][5000];     // 100 MB - ‚úÖ Usually safe
1100     -    160 +int arr[10000][10000];   // 400 MB - ‚ùå Too large!
1101     -    161 +
1102     -    162 +// For larger grids, use vector (dynamic allocation)
1103     -    163 +vector<vector<int>> grid(n, vector<int>(m));
1104     -    164 +```
1105     -    165 +
1106     -    166 +### Container Memory Usage
1107     -    167 +
1108     -    168 +| Container | Memory per Element | Notes |
1109     -    169 +|-----------|-------------------|-------|
1110     -    170 +| `vector<int>` | 4 bytes | Most efficient |
1111     -    171 +| `deque<int>` | 4 bytes + overhead | Block allocation |
1112     -    172 +| `list<int>` | 4 + 16 bytes | Node pointers |
1113     -    173 +| `set<int>` | 4 + 32 bytes | Red-black tree |
1114     -    174 +| `unordered_set<int>` | 4 + ~8 bytes | Hash table |
1115     -    175 +| `map<int,int>` | 8 + 32 bytes | Red-black tree |
1116     -    176 +| `unordered_map<int,int>` | 8 + ~16 bytes | Hash table |
1117     -    177 +
1118     -    178 +---
1119     -    179 +
1120     -    180 +## üìù String Constraints
1121     -    181 +
1122     -    182 +### String Length Limits
1123     -    183 +
1124     -    184 +| Constraint | Typical Value | Common Problems |
1125     -    185 +|------------|---------------|-----------------|
1126     -    186 +| Short strings | ‚â§ 100 | Brute force OK |
1127     -    187 +| Medium strings | ‚â§ 10‚Åµ | O(n) required |
1128     -    188 +| Long strings | ‚â§ 10‚Å∂ | O(n) only |
1129     -    189 +| Multiple strings | Total length ‚â§ 10‚Å∂ | Sum constraint |
1130     -    190 +
1131     -    191 +### Character Set Assumptions
1132     -    192 +
1133     -    193 +```cpp
1134     -    194 +// Lowercase letters only: 'a' to 'z' (26 chars)
1135     -    195 +int freq[26] = {0};
1136     -    196 +freq[ch - 'a']++;
1137     -    197 +
1138     -    198 +// All letters: 'A'-'Z', 'a'-'z' (52 chars)
1139     -    199 +// Usually case-insensitive or convert to one case
1140     -    200 +
1141     -    201 +// Digits: '0' to '9' (10 chars)
1142     -    202 +int digit = ch - '0';
1143     -    203 +
1144     -    204 +// ASCII printable: 32 to 126 (95 chars)
1145     -    205 +int freq[128] = {0};  // Safe for all ASCII
1146     -    206 +
1147     -    207 +// Unicode: Use std::string with UTF-8
1148     -    208 +// Careful: string[i] may not be a full character!
1149     -    209 +```
1150     -    210 +
1151     -    211 +### String Comparison Complexity
1152     -    212 +
1153     -    213 +```cpp
1154     -    214 +// Comparing two strings of length n and m
1155     -    215 +s1 == s2;           // O(min(n, m))
1156     -    216 +s1.compare(s2);     // O(min(n, m))
1157     -    217 +s1 < s2;            // O(min(n, m))
1158     -    218 +
1159     -    219 +// For multiple comparisons, use hashing
1160     -    220 +hash<string> hasher;
1161     -    221 +size_t h = hasher(s);
1162     -    222 +```
1163     -    223 +
1164     -    224 +---
1165     -    225 +
1166     -    226 +## ‚è±Ô∏è Time Complexity Limits
1167     -    227 +
1168     -    228 +### Operations per Second
1169     -    229 +
1170     -    230 +| Operation Type | Operations/Second |
1171     -    231 +|---------------|-------------------|
1172     -    232 +| Simple arithmetic | ~10‚Åπ |
1173     -    233 +| Array access | ~10‚Å∏ - 10‚Åπ |
1174     -    234 +| Vector operations | ~10‚Å∏ |
1175     -    235 +| Set/Map operations | ~10‚Å∑ |
1176     -    236 +| String operations | ~10‚Å∑ |
1177     -    237 +| I/O (cin/cout) | ~10‚Å∂ (without fast I/O) |
1178     -    238 +| I/O (fast I/O) | ~10‚Å∑ |
1179     -    239 +
1180     -    240 +### Maximum n for Time Limits
1181     -    241 +
1182     -    242 +| Time Limit | O(n) | O(n log n) | O(n¬≤) | O(n¬≥) | O(2‚Åø) |
1183     -    243 +|------------|------|------------|-------|-------|-------|
1184     -    244 +| 1 second | 10‚Å∏ | 10‚Å∂-10‚Å∑ | 10‚Å¥ | 500 | 25 |
1185     -    245 +| 2 seconds | 2√ó10‚Å∏ | 2√ó10‚Å∑ | 1.4√ó10‚Å¥ | 600 | 26 |
1186     -    246 +| 5 seconds | 5√ó10‚Å∏ | 5√ó10‚Å∑ | 2√ó10‚Å¥ | 800 | 28 |
1187     -    247 +
1188     -    248 +### Quick Complexity Check
1189     -    249 +
1190     -    250 +```cpp
1191     -    251 +// Given n, what's the max acceptable complexity?
1192     -    252 +n ‚â§ 10     ‚Üí O(n!) or O(2‚Åø) OK
1193     -    253 +n ‚â§ 20     ‚Üí O(2‚Åø) OK, O(n!) too slow
1194     -    254 +n ‚â§ 100    ‚Üí O(n¬≥) OK
1195     -    255 +n ‚â§ 1000   ‚Üí O(n¬≤) OK
1196     -    256 +n ‚â§ 10‚Åµ    ‚Üí O(n log n) or better
1197     -    257 +n ‚â§ 10‚Å∂    ‚Üí O(n log n) risky, O(n) preferred
1198     -    258 +n ‚â§ 10‚Å∏    ‚Üí O(n) only
1199     -    259 +```
1200     -    260 +
1201     -    261 +### Reverse: Given Complexity, Max n
1202     -    262 +
1203     -    263 +| Complexity | Max n (1 sec) |
1204     -    264 +|------------|---------------|
1205     -    265 +| O(n!) | n ‚â§ 10 |
1206     -    266 +| O(2‚Åø) | n ‚â§ 20-25 |
1207     -    267 +| O(n¬≥) | n ‚â§ 500 |
1208     -    268 +| O(n¬≤ log n) | n ‚â§ 1000 |
1209     -    269 +| O(n¬≤) | n ‚â§ 5000-10000 |
1210     -    270 +| O(n‚àön) | n ‚â§ 10‚Åµ |
1211     -    271 +| O(n log n) | n ‚â§ 10‚Å∂-10‚Å∑ |
1212     -    272 +| O(n) | n ‚â§ 10‚Å∏ |
1213     -    273 +| O(log n) | n ‚â§ 10¬π‚Å∏ |
1214     -    274 +| O(1) | n = anything |
1215     -    275 +
1216     -    276 +---
1217     -    277 +
1218     -    278 +## üíæ Space Complexity Limits
1219     -    279 +
1220     -    280 +### Memory Calculation
1221     -    281 +
1222     -    282 +```cpp
1223     -    283 +// Typical memory limits
1224     -    284 +256 MB = 256 √ó 10‚Å∂ bytes = 64 √ó 10‚Å∂ ints
1225     -    285 +512 MB = 512 √ó 10‚Å∂ bytes = 128 √ó 10‚Å∂ ints
1226     -    286 +
1227     -    287 +// Stack vs Heap
1228     -    288 +// Stack: Limited (~1-8 MB) - local variables, recursion
1229     -    289 +// Heap: Limited by problem constraint - new, vector
1230     -    290 +
1231     -    291 +// Recursion depth limit (stack)
1232     -    292 +// ~10‚Å¥ - 10‚Åµ calls typically safe
1233     -    293 +// Deep recursion may cause stack overflow!
1234     -    294 +
1235     -    295 +// Tail recursion or iteration preferred for deep recursion
1236     -    296 +```
1237     -    297 +
1238     -    298 +### Data Structure Space
1239     -    299 +
1240     -    300 +| Structure | Space | Example |
1241     -    301 +|-----------|-------|---------|
1242     -    302 +| Array of n ints | 4n bytes | n = 10‚Å∂ ‚Üí 4 MB |
1243     -    303 +| n √ó n int matrix | 4n¬≤ bytes | n = 5000 ‚Üí 100 MB |
1244     -    304 +| Adjacency list | O(V + E) | |
1245     -    305 +| Adjacency matrix | O(V¬≤) | |
1246     -    306 +| Binary tree (n nodes) | ~32n bytes | Node + 2 pointers |
1247     -    307 +| Graph (V vertices, E edges) | V + E | Adjacency list |
1248     -    308 +
1249     -    309 +---
1250     -    310 +
1251     -    311 +## üî¢ Common Primes & Mathematical Constants
1252     -    312 +
1253     -    313 +### Primes to Know
1254     -    314 +
1255     -    315 +```cpp
1256     -    316 +// For modular arithmetic
1257     -    317 +10‚Åπ + 7 = 1,000,000,007  // Most common modulo (prime)
1258     -    318 +10‚Åπ + 9 = 1,000,000,009  // Alternative (prime)
1259     -    319 +998244353                 // NTT prime (2¬≤¬≥ √ó 7 √ó 17 + 1)
1260     -    320 +
1261     -    321 +// Small primes for hashing
1262     -    322 +31, 37, 53, 97, 131, 1009, 10007
1263     -    323 +
1264     -    324 +// For string hashing (rolling hash)
1265     -    325 +base = 31 or 37 (for lowercase letters)
1266     -    326 +base = 53 (for mixed case)
1267     -    327 +mod = 10‚Åπ + 7 or 10‚Åπ + 9
1268     -    328 +
1269     -    329 +// Largest prime ‚â§ n
1270     -    330 +// Under 100: 97
1271     -    331 +// Under 1000: 997
1272     -    332 +// Under 10000: 9973
1273     -    333 +// Under 10‚Åµ: 99991
1274     -    334 +// Under 10‚Å∂: 999983
1275     -    335 +// Under 10‚Åπ: 999999937
1276     -    336 +```
1277     -    337 +
1278     -    338 +### Mathematical Constants
1279     -    339 +
1280     -    340 +```cpp
1281     -    341 +// For geometry and floating point
1282     -    342 +const double PI = acos(-1);        // 3.14159265358979...
1283     -    343 +const double PI = 3.14159265358979323846;
1284     -    344 +const double E = exp(1);           // 2.71828...
1285     -    345 +
1286     -    346 +// For comparison (floating point tolerance)
1287     -    347 +const double EPS = 1e-9;
1288     -    348 +if (abs(a - b) < EPS) // a == b
1289     -    349 +
1290     -    350 +// For "infinity" in algorithms
1291     -    351 +const int INF = 1e9;           // For int (won't overflow on add)
1292     -    352 +const int INF = INT_MAX / 2;   // Safe for addition
1293     -    353 +const long long INF = 1e18;    // For long long
1294     -    354 +const long long INF = LLONG_MAX / 2;
1295     -    355 +```
1296     -    356 +
1297     -    357 +### Useful Mathematical Facts
1298     -    358 +
1299     -    359 +```cpp
1300     -    360 +// Factorials
1301     -    361 +10! = 3,628,800             // Fits in int
1302     -    362 +12! = 479,001,600           // Last to fit in int
1303     -    363 +13! = 6,227,020,800         // Needs long long
1304     -    364 +20! ‚âà 2.4 √ó 10¬π‚Å∏            // Last to fit in long long
1305     -    365 +21! overflows long long!
1306     -    366 +
1307     -    367 +// Powers of 2
1308     -    368 +2¬π‚Å∞ = 1,024 ‚âà 10¬≥
1309     -    369 +2¬≤‚Å∞ = 1,048,576 ‚âà 10‚Å∂
1310     -    370 +2¬≥‚Å∞ = 1,073,741,824 ‚âà 10‚Åπ
1311     -    371 +2¬≥¬≤ = 4,294,967,296 ‚âà 4 √ó 10‚Åπ (unsigned int max + 1)
1312     -    372 +2‚Å∂‚Å¥ ‚âà 1.8 √ó 10¬π‚Åπ
1313     -    373 +
1314     -    374 +// Fibonacci
1315     -    375 +F(45) = 1,134,903,170       // Last to fit in int
1316     -    376 +F(92) = 7,540,113,804,746,346,429  // Last to fit in long long
1317     -    377 +
1318     -    378 +// Catalan numbers (combinatorics)
1319     -    379 +C(17) = 129,644,790         // Fits in int
1320     -    380 +C(35) = 3,116,285,494,907,301,262  // Fits in long long
1321     -    381 +```
1322     -    382 +
1323     -    383 +---
1324     -    384 +
1325     -    385 +## ‚úÖ Edge Cases Checklist
1326     -    386 +
1327     -    387 +### Array/Vector Edge Cases
1328     -    388 +
1329     -    389 +```cpp
1330     -    390 +// Always test:
1331     -    391 +‚ñ° Empty array (n = 0)
1332     -    392 +‚ñ° Single element (n = 1)
1333     -    393 +‚ñ° Two elements (n = 2)
1334     -    394 +‚ñ° All same elements
1335     -    395 +‚ñ° Already sorted (ascending)
1336     -    396 +‚ñ° Reverse sorted (descending)
1337     -    397 +‚ñ° Maximum size (n = max constraint)
1338     -    398 +‚ñ° Negative numbers
1339     -    399 +‚ñ° Zero values
1340     -    400 +‚ñ° INT_MAX / INT_MIN values
1341     -    401 +‚ñ° Duplicates at boundaries
1342     -    402 +```
1343     -    403 +
1344     -    404 +### String Edge Cases
1345     -    405 +
1346     -    406 +```cpp
1347     -    407 +// Always test:
1348     -    408 +‚ñ° Empty string (s = "")
1349     -    409 +‚ñ° Single character (s = "a")
1350     -    410 +‚ñ° All same character (s = "aaa")
1351     -    411 +‚ñ° Palindrome
1352     -    412 +‚ñ° All unique characters
1353     -    413 +‚ñ° Maximum length
1354     -    414 +‚ñ° Spaces/special characters (if allowed)
1355     -    415 +‚ñ° Case sensitivity (if relevant)
1356     -    416 +```
1357     -    417 +
1358     -    418 +### Graph Edge Cases
1359     -    419 +
1360     -    420 +```cpp
1361     -    421 +// Always test:
1362     -    422 +‚ñ° Empty graph (no edges)
1363     -    423 +‚ñ° Single node
1364     -    424 +‚ñ° Disconnected graph
1365     -    425 +‚ñ° Complete graph
1366     -    426 +‚ñ° Tree (n-1 edges)
1367     -    427 +‚ñ° Cycle
1368     -    428 +‚ñ° Self-loop (if allowed)
1369     -    429 +‚ñ° Multiple edges between same nodes
1370     -    430 +‚ñ° Negative edge weights (if allowed)
1371     -    431 +‚ñ° All edges same weight
1372     -    432 +```
1373     -    433 +
1374     -    434 +### Tree Edge Cases
1375     -    435 +
1376     -    436 +```cpp
1377     -    437 +// Always test:
1378     -    438 +‚ñ° Empty tree (null root)
1379     -    439 +‚ñ° Single node
1380     -    440 +‚ñ° Skewed tree (all left or all right)
1381     -    441 +‚ñ° Perfect/complete binary tree
1382     -    442 +‚ñ° Maximum depth
1383     -    443 +‚ñ° All same values
1384     -    444 +‚ñ° Negative values (if allowed)
1385     -    445 +```
1386     -    446 +
1387     -    447 +### Number Edge Cases
1388     -    448 +
1389     -    449 +```cpp
1390     -    450 +// Always test:
1391     -    451 +‚ñ° Zero (0)
1392     -    452 +‚ñ° Negative zero (-0 for floating point)
1393     -    453 +‚ñ° INT_MAX (2,147,483,647)
1394     -    454 +‚ñ° INT_MIN (-2,147,483,648)
1395     -    455 +‚ñ° Powers of 2
1396     -    456 +‚ñ° One less than power of 2
1397     -    457 +‚ñ° Prime numbers
1398     -    458 +‚ñ° Perfect squares
1399     -    459 +‚ñ° Negative numbers
1400     -    460 +‚ñ° Very small positive (1)
1401     -    461 +‚ñ° Very large (max constraint)
1402     -    462 +```
1403     -    463 +
1404     -    464 +### Binary Search Edge Cases
1405     -    465 +
1406     -    466 +```cpp
1407     -    467 +// Always test:
1408     -    468 +‚ñ° Target at index 0
1409     -    469 +‚ñ° Target at last index
1410     -    470 +‚ñ° Target not in array
1411     -    471 +‚ñ° Target smaller than all elements
1412     -    472 +‚ñ° Target larger than all elements
1413     -    473 +‚ñ° All elements are target
1414     -    474 +‚ñ° Single element equals target
1415     -    475 +‚ñ° Single element doesn't equal target
1416     -    476 +‚ñ° Two elements
1417     -    477 +```
1418     -    478 +
1419     -    479 +---
1420     -    480 +
1421     -    481 +## üñ•Ô∏è Platform-Specific Constraints
1422     -    482 +
1423     -    483 +### LeetCode
1424     -    484 +
1425     -    485 +```cpp
1426     -    486 +// Typical constraints
1427     -    487 +n ‚â§ 10‚Åµ (most problems)
1428     -    488 +n ‚â§ 10¬≥ (allows O(n¬≤))
1429     -    489 +n ‚â§ 10‚Å¥ (O(n¬≤) risky)
1430     -    490 +Values: -10‚Åπ to 10‚Åπ (fits in int)
1431     -    491 +
1432     -    492 +// Time limit: Usually generous
1433     -    493 +// Memory: 256 MB typical
1434     -    494 +
1435     -    495 +// Fast I/O not needed (uses function calls)
1436     -    496 +```
1437     -    497 +
1438     -    498 +### Codeforces
1439     -    499 +
1440     -    500 +```cpp
1441     -    501 +// Typical constraints
1442     -    502 +n ‚â§ 2 √ó 10‚Åµ (common)
1443     -    503 +n ‚â§ 10‚Å∂ (harder problems)
1444     -    504 +Time: 1-2 seconds
1445     -    505 +Memory: 256 MB (standard)
1446     -    506 +
1447     -    507 +// Fast I/O REQUIRED for large input
1448     -    508 +ios::sync_with_stdio(false);
1449     -    509 +cin.tie(nullptr);
1450     -    510 +```
1451     -    511 +
1452     -    512 +### HackerRank
1453     -    513 +
1454     -    514 +```cpp
1455     -    515 +// Varies by problem
1456     -    516 +// Often has multiple test cases
1457     -    517 +// Time limits can be strict
1458     -    518 +// Fast I/O recommended
1459     -    519 +
1460     -    520 +// Multiple test cases pattern
1461     -    521 +int t;
1462     -    522 +cin >> t;
1463     -    523 +while (t--) {
1464     -    524 +    // solve
1465     -    525 +}
1466     -    526 +```
1467     -    527 +
1468     -    528 +### Google/FAANG Interviews
1469     -    529 +
1470     -    530 +```cpp
1471     -    531 +// Focus on:
1472     -    532 +- Optimal time complexity
1473     -    533 +- Clean, readable code
1474     -    534 +- Handle all edge cases
1475     -    535 +- Discuss trade-offs
1476     -    536 +
1477     -    537 +// Typical expectations:
1478     -    538 +n ‚â§ 10‚Åµ to 10‚Å∂
1479     -    539 +Time: O(n) or O(n log n)
1480     -    540 +Space: O(1) to O(n)
1481     -    541 +```
1482     -    542 +
1483     -    543 +---
1484     -    544 +
1485     -    545 +## üìã Quick Reference Cheatsheet
1486     -    546 +
1487     -    547 +### Numbers to Memorize
1488     -    548 +
1489     -    549 +| Value | Meaning | Use Case |
1490     -    550 +|-------|---------|----------|
1491     -    551 +| 10‚Åπ | ~INT_MAX / 2 | Safe int limit |
1492     -    552 +| 2 √ó 10‚Åπ | ~INT_MAX | Max positive int |
1493     -    553 +| 10¬π‚Å∏ | ~LLONG_MAX / 9 | Safe long long |
1494     -    554 +| 10‚Åπ + 7 | Common modulo | Modular arithmetic |
1495     -    555 +| 10‚Åµ | Typical n limit | O(n log n) problems |
1496     -    556 +| 10‚Å¥ | O(n¬≤) threshold | When O(n¬≤) is OK |
1497     -    557 +| 20-25 | 2‚Åø threshold | Bitmask/subset problems |
1498     -    558 +| 10 | n! threshold | Permutation problems |
1499     -    559 +
1500     -    560 +### Quick Type Selection
1501     -    561 +
1502     -    562 +```cpp
1503     -    563 +// Default
1504     -    564 +int x;                  // Values ‚â§ 10‚Åπ
1505     -    565 +
1506     -    566 +// Large values
1507     -    567 +long long x;           // Values > 2√ó10‚Åπ
1508     -    568 +
1509     -    569 +// Large sums
1510     -    570 +long long sum = 0;     // Sum of many ints
1511     -    571 +
1512     -    572 +// Products
1513     -    573 +long long prod = 1LL * a * b;  // Multiply ints
1514     -    574 +
1515     -    575 +// Modular
1516     -    576 +const int MOD = 1e9 + 7;
1517     -    577 +((1LL * a * b) % MOD)
1518     -    578 +```
1519     -    579 +
1520     -    580 +### Fast I/O Template
1521     -    581 +
1522     -    582 +```cpp
1523     -    583 +#include <bits/stdc++.h>
1524     -    584 +using namespace std;
1525     -    585 +
1526     -    586 +int main() {
1527     -    587 +    ios::sync_with_stdio(false);
1528     -    588 +    cin.tie(nullptr);
1529     -    589 +
1530     -    590 +    // Your code here
1531     -    591 +
1532     -    592 +    return 0;
1533     -    593 +}
1534     -    594 +```
1535     -    595 +
1536     -    596 +### Infinity Values
1537     -    597 +
1538     -    598 +```cpp
1539     -    599 +// For shortest path, DP
1540     -    600 +const int INF = 1e9;           // int infinity
1541     -    601 +const long long INF = 1e18;    // long long infinity
1542     -    602 +
1543     -    603 +// For comparisons (safe for addition)
1544     -    604 +const int INF = INT_MAX / 2;
1545     -    605 +const long long INF = LLONG_MAX / 2;
1546     -    606 +```
1547     -    607 +
1548     -    608 +---
1549     -    609 +
1550     -    610 +## üéØ Interview Tips
1551     -    611 +
1552     -    612 +1. **Always ask for constraints first** - Determines algorithm choice
1553     -    613 +2. **State assumptions explicitly** - "I'm assuming n ‚â§ 10‚Åµ"
1554     -    614 +3. **Check for overflow** - Especially with multiplication and sums
1555     -    615 +4. **Use appropriate data types** - `long long` when in doubt
1556     -    616 +5. **Test edge cases mentally** - Before coding, walk through edge cases
1557     -    617 +6. **Know your constants** - INT_MAX, 10‚Åπ+7, complexity thresholds
1558     -    618 +
1559     -    619 +---
1560     -    620 +
1561     -    621 +*Last Updated: December 19, 2025*
1562     -    622  
1563     -
1564     -```
1565     -
1566     -
1567     -### üìÑ `script.js`
1568     -
1569     -**Type:** JavaScript Source File üü®
1570     -
1571     -```diff
1572     -@@ -29,6 +29,242 @@ window.katex = katex;
1573     - 29  29  window.html2pdf = html2pdf;
1574     - 30  30  window.markedFootnote = markedFootnote;
1575     - 31  31  
1576     -     32 +// ==================== ANCHOR NAVIGATION ====================
1577     -     33 +// Heading slug tracking (module-level singleton for marked.js singleton)
1578     -     34 +const headingSlugMap = new Map();
1579     -     35 +
1580     -     36 +// Pre-compiled slug replacements (zero GC pressure per render)
1581     -     37 +const SLUG_REPLACEMENTS = [
1582     -     38 +  [/c\+\+/gi, 'cpp'],
1583     -     39 +  [/c#/gi, 'csharp'],
1584     -     40 +  [/f#/gi, 'fsharp'],
1585     -     41 +  [/\.net/gi, 'dotnet'],
1586     -     42 +];
1587     -     43 +
1588     -     44 +/**
1589     -     45 + * Reset slug map (call before each parse)
1590     -     46 + */
1591     -     47 +function resetSlugMap() {
1592     -     48 +  headingSlugMap.clear();
1593     -     49 +}
1594     -     50 +
1595     -     51 +/**
1596     -     52 + * Generate URL-safe slug from heading text
1597     -     53 + * @param {string} text - Raw heading text (may include HTML)
1598     -     54 + * @param {Map<string, number>} seen - Duplicate tracking map
1599     -     55 + * @returns {string} URL-safe slug
1600     -     56 + */
1601     -     57 +function generateSlug(text, seen = headingSlugMap) {
1602     -     58 +  // Strip HTML tags
1603     -     59 +  let slug = text.replace(/<[^>]*>/g, '');
1604     -     60 +
1605     -     61 +  // Normalize Unicode
1606     -     62 +  slug = slug.normalize('NFC').toLowerCase();
1607     -     63 +
1608     -     64 +  // Replace programming terms (pre-compiled patterns)
1609     -     65 +  for (const [pattern, replacement] of SLUG_REPLACEMENTS) {
1610     -     66 +    slug = slug.replace(pattern, replacement);
1611     -     67 +  }
1612     -     68 +
1613     -     69 +  // Clean up: remove non-word chars, spaces to hyphens, collapse hyphens
1614     -     70 +  slug = slug
1615     -     71 +    .replace(/[^\w\s-]/g, '')
1616     -     72 +    .replace(/\s+/g, '-')
1617     -     73 +    .replace(/-+/g, '-')
1618     -     74 +    .replace(/^-+|-+$/g, '');
1619     -     75 +
1620     -     76 +  // Fallback for empty result
1621     -     77 +  if (!slug) slug = 'section';
1622     -     78 +
1623     -     79 +  // Handle duplicates (header, header-1, header-2)
1624     -     80 +  const baseSlug = slug;
1625     -     81 +  const count = seen.get(baseSlug) || 0;
1626     -     82 +  if (count > 0) slug = `${baseSlug}-${count}`;
1627     -     83 +  seen.set(baseSlug, count + 1);
1628     -     84 +
1629     -     85 +  return slug;
1630     -     86 +}
1631     -     87 +
1632     -     88 +/**
1633     -     89 + * Anchor Navigation Module
1634     -     90 + * Handles in-document anchor navigation with scoped selection
1635     -     91 + */
1636     -     92 +const AnchorNavigation = {
1637     -     93 +  container: null,
1638     -     94 +  pendingScroll: null,
1639     -     95 +
1640     -     96 +  /**
1641     -     97 +   * Initialize anchor navigation
1642     -     98 +   * @param {HTMLElement} previewContainer - Scrollable preview container
1643     -     99 +   */
1644     -    100 +  init(previewContainer) {
1645     -    101 +    this.container = previewContainer;
1646     -    102 +
1647     -    103 +    // Event delegation for anchor clicks
1648     -    104 +    this.container.addEventListener('click', this.handleClick.bind(this));
1649     -    105 +
1650     -    106 +    // Browser back/forward navigation
1651     -    107 +    window.addEventListener('hashchange', this.handleHashChange.bind(this));
1652     -    108 +
1653     -    109 +    // Initial page load with hash
1654     -    110 +    if (window.location.hash) {
1655     -    111 +      requestAnimationFrame(() => {
1656     -    112 +        this.scrollToHash(window.location.hash.slice(1), false);
1657     -    113 +      });
1658     -    114 +    }
1659     -    115 +
1660     -    116 +    console.log('‚úÖ Anchor navigation initialized');
1661     -    117 +  },
1662     -    118 +
1663     -    119 +  /**
1664     -    120 +   * Handle click events (delegated)
1665     -    121 +   */
1666     -    122 +  handleClick(event) {
1667     -    123 +    const link = event.target.closest('a[href^="#"]');
1668     -    124 +    if (!link) return;
1669     -    125 +
1670     -    126 +    // Ignore external links
1671     -    127 +    if (link.hostname && link.hostname !== window.location.hostname) return;
1672     -    128 +
1673     -    129 +    event.preventDefault();
1674     -    130 +
1675     -    131 +    const hash = link.getAttribute('href').slice(1);
1676     -    132 +    this.scrollToHash(hash, true);
1677     -    133 +
1678     -    134 +    // Update URL without triggering hashchange
1679     -    135 +    history.pushState(null, '', `#${hash}`);
1680     -    136 +  },
1681     -    137 +
1682     -    138 +  /**
1683     -    139 +   * Handle hashchange (browser back/forward)
1684     -    140 +   */
1685     -    141 +  handleHashChange() {
1686     -    142 +    const hash = window.location.hash.slice(1);
1687     -    143 +    if (hash) {
1688     -    144 +      this.scrollToHash(hash, true);
1689     -    145 +    } else {
1690     -    146 +      this.scrollToTop(true);
1691     -    147 +    }
1692     -    148 +  },
1693     -    149 +
1694     -    150 +  /**
1695     -    151 +   * Scroll to element by hash
1696     -    152 +   * @param {string} hash - URL hash (without #)
1697     -    153 +   * @param {boolean} smooth - Use smooth scrolling
1698     -    154 +   */
1699     -    155 +  scrollToHash(hash, smooth = true) {
1700     -    156 +    // Cancel pending scroll (handle concurrent clicks)
1701     -    157 +    if (this.pendingScroll) {
1702     -    158 +      clearTimeout(this.pendingScroll);
1703     -    159 +      this.pendingScroll = null;
1704     -    160 +    }
1705     -    161 +
1706     -    162 +    if (!hash) {
1707     -    163 +      this.scrollToTop(smooth);
1708     -    164 +      return;
1709     -    165 +    }
1710     -    166 +
1711     -    167 +    const target = this.resolveTarget(hash);
1712     -    168 +    if (!target) return;
1713     -    169 +
1714     -    170 +    target.scrollIntoView({
1715     -    171 +      behavior: smooth ? 'smooth' : 'instant',
1716     -    172 +      block: 'start',
1717     -    173 +    });
1718     -    174 +
1719     -    175 +    this.manageFocus(target, smooth);
1720     -    176 +  },
1721     -    177 +
1722     -    178 +  /**
1723     -    179 +   * Scroll to top of container
1724     -    180 +   */
1725     -    181 +  scrollToTop(smooth = true) {
1726     -    182 +    this.container.scrollTo({
1727     -    183 +      top: 0,
1728     -    184 +      behavior: smooth ? 'smooth' : 'instant',
1729     -    185 +    });
1730     -    186 +  },
1731     -    187 +
1732     -    188 +  /**
1733     -    189 +   * Resolve target element - SCOPED to container (prevents app shell collision)
1734     -    190 +   * @param {string} hash - URL hash
1735     -    191 +   * @returns {Element|null} Target element or null
1736     -    192 +   */
1737     -    193 +  resolveTarget(hash) {
1738     -    194 +    if (!hash) return null;
1739     -    195 +
1740     -    196 +    // Decode URI components safely
1741     -    197 +    let decodedHash;
1742     -    198 +    try {
1743     -    199 +      decodedHash = decodeURIComponent(hash);
1744     -    200 +    } catch {
1745     -    201 +      decodedHash = hash;
1746     -    202 +    }
1747     -    203 +
1748     -    204 +    // Priority 1: Exact ID (SCOPED to container)
1749     -    205 +    let target = this.container.querySelector(`#${CSS.escape(decodedHash)}`);
1750     -    206 +    if (target) return target;
1751     -    207 +
1752     -    208 +    // Priority 2: Normalized ID (handles legacy links with emoji, special chars)
1753     -    209 +    const normalized = this.normalizeHash(decodedHash);
1754     -    210 +    target = this.container.querySelector(`#${CSS.escape(normalized)}`);
1755     -    211 +    if (target) return target;
1756     -    212 +
1757     -    213 +    console.warn(`[AnchorNav] Target not found: "${hash}"`);
1758     -    214 +    return null;
1759     -    215 +  },
1760     -    216 +
1761     -    217 +  /**
1762     -    218 +   * Normalize hash for legacy link matching
1763     -    219 +   * @param {string} hash - Raw hash string
1764     -    220 +   * @returns {string} Normalized hash
1765     -    221 +   */
1766     -    222 +  normalizeHash(hash) {
1767     -    223 +    let slug = hash.normalize('NFC').toLowerCase();
1768     -    224 +
1769     -    225 +    // Apply same transformations as generateSlug
1770     -    226 +    for (const [pattern, replacement] of SLUG_REPLACEMENTS) {
1771     -    227 +      slug = slug.replace(pattern, replacement);
1772     -    228 +    }
1773     -    229 +
1774     -    230 +    return slug
1775     -    231 +      .replace(/[^\w\s-]/g, '')
1776     -    232 +      .replace(/\s+/g, '-')
1777     -    233 +      .replace(/-+/g, '-')
1778     -    234 +      .replace(/^-+|-+$/g, '') || 'section';
1779     -    235 +  },
1780     -    236 +
1781     -    237 +  /**
1782     -    238 +   * Manage focus after scroll (accessibility)
1783     -    239 +   * @param {Element} target - Target element
1784     -    240 +   * @param {boolean} smooth - Was smooth scroll used
1785     -    241 +   */
1786     -    242 +  manageFocus(target, smooth) {
1787     -    243 +    const focusTarget = () => {
1788     -    244 +      // Make heading focusable if not already
1789     -    245 +      if (!target.hasAttribute('tabindex')) {
1790     -    246 +        target.setAttribute('tabindex', '-1');
1791     -    247 +      }
1792     -    248 +      target.focus({ preventScroll: true });
1793     -    249 +    };
1794     -    250 +
1795     -    251 +    if (!smooth) {
1796     -    252 +      focusTarget();
1797     -    253 +      return;
1798     -    254 +    }
1799     -    255 +
1800     -    256 +    // Modern browsers: use scrollend event
1801     -    257 +    if ('onscrollend' in this.container) {
1802     -    258 +      this.container.addEventListener('scrollend', focusTarget, { once: true });
1803     -    259 +    } else {
1804     -    260 +      // Fallback: estimate scroll duration (max 1000ms for safety)
1805     -    261 +      const distance = Math.abs(target.getBoundingClientRect().top);
1806     -    262 +      const duration = Math.min(Math.max(distance / 2, 300), 1000);
1807     -    263 +      this.pendingScroll = setTimeout(focusTarget, duration + 50);
1808     -    264 +    }
1809     -    265 +  },
1810     -    266 +};
1811     -    267 +
1812     - 32 268  // Initialize services and managers
1813     - 33 269  const storageManager = new StorageManager();
1814     - 34 270  const themeManager = new ThemeManager(storageManager);
1815     -@@ -360,6 +596,19 @@ function configureMarkedExtensions() {
1816     -360 596    });
1817     -361 597  
1818     -362 598    console.log('‚úÖ Marked.js configured with all extensions (LaTeX, subscript, superscript)');
1819     -    599 +
1820     -    600 +  // Custom heading renderer with ID generation for anchor navigation
1821     -    601 +  marked.use({
1822     -    602 +    renderer: {
1823     -    603 +      heading(token) {
1824     -    604 +        const text = this.parser.parseInline(token.tokens);
1825     -    605 +        const level = token.depth;
1826     -    606 +        const slug = generateSlug(text, headingSlugMap);
1827     -    607 +        return `<h${level} id="${slug}">${text}</h${level}>\n`;
1828     -    608 +      }
1829     -    609 +    }
1830     -    610 +  });
1831     -    611 +  console.log('‚úÖ Custom heading renderer enabled (anchor navigation IDs)');
1832     -363 612  }
1833     -364 613  
1834     -365 614  // Initialize Mermaid using MermaidService (prefixed to indicate future use)
1835     -@@ -550,6 +799,9 @@ graph TD
1836     -550 799    // Render markdown (expose globally for theme changes)
1837     -551 800    function renderMarkdown() {
1838     -552 801      try {
1839     -    802 +      // Reset slug map before parsing (singleton-safe pattern)
1840     -    803 +      resetSlugMap();
1841     -    804 +
1842     -553 805        const markdownText = editor.value;
1843     -554 806  
1844     -555 807        // Parse markdown with all extensions
1845     -@@ -2001,6 +2253,9 @@ Wrap up your thoughts and include a call to action.
1846     -2001 2253    // Initialize expand button visibility on load
1847     -2002 2254    updateExpandButtonVisibility();
1848     -2003 2255  
1849     -    2256 +  // Initialize anchor navigation for TOC links
1850     -    2257 +  AnchorNavigation.init(previewContainer);
1851     -    2258 +
1852     -2004 2259    // DON'T render immediately - wait for theme to load
1853     -2005 2260    // renderMarkdown will be called after theme loads above
1854     -2006 2261  }
1855     -2007 2262  
1856     -
1857     -```
1858     -
1859     -
1860     -### üìÑ `style.css`
1861     -
1862     -**Type:** Stylesheet üé®
1863     -
1864     -```diff
1865     -@@ -224,6 +224,47 @@ body {
1866     -224 224    overflow: auto;
1867     -225 225    /* Single scrollbar for preview container */
1868     -226 226    min-width: 200px;
1869     -    227 +  /* Anchor Navigation - scroll offset for fixed toolbar */
1870     -    228 +  scroll-padding-top: var(--scroll-offset, 80px);
1871     -    229 +}
1872     -    230 +
1873     -    231 +/* ==================== ANCHOR NAVIGATION ==================== */
1874     -    232 +
1875     -    233 +/* Target highlight animation */
1876     -    234 +.preview-container :target {
1877     -    235 +  animation: anchor-highlight 2s ease-out;
1878     -    236 +}
1879     -    237 +
1880     -    238 +@keyframes anchor-highlight {
1881     -    239 +  0% {
1882     -    240 +    background-color: rgba(255, 255, 0, 0.3);
1883     -    241 +  }
1884     -    242 +
1885     -    243 +  100% {
1886     -    244 +    background-color: transparent;
1887     -    245 +  }
1888     -    246 +}
1889     -    247 +
1890     -    248 +/* Focus management - hide outline for mouse clicks */
1891     -    249 +.preview-container h1[id]:focus:not(:focus-visible),
1892     -    250 +.preview-container h2[id]:focus:not(:focus-visible),
1893     -    251 +.preview-container h3[id]:focus:not(:focus-visible),
1894     -    252 +.preview-container h4[id]:focus:not(:focus-visible),
1895     -    253 +.preview-container h5[id]:focus:not(:focus-visible),
1896     -    254 +.preview-container h6[id]:focus:not(:focus-visible) {
1897     -    255 +  outline: none;
1898     -    256 +}
1899     -    257 +
1900     -    258 +/* Keyboard focus gets visible indicator */
1901     -    259 +.preview-container h1[id]:focus-visible,
1902     -    260 +.preview-container h2[id]:focus-visible,
1903     -    261 +.preview-container h3[id]:focus-visible,
1904     -    262 +.preview-container h4[id]:focus-visible,
1905     -    263 +.preview-container h5[id]:focus-visible,
1906     -    264 +.preview-container h6[id]:focus-visible {
1907     -    265 +  outline: 2px solid var(--h1-color, #007bff);
1908     -    266 +  outline-offset: 4px;
1909     -    267 +  border-radius: 2px;
1910     -227 268  }
1911     -228 269  
1912     -229 270  .preview-header {
1913     -230 271  
1914     -
1915     -```
1916     -
1917     -
1918     -### üìÑ `variables.css`
1919     -
1920     -**Type:** Stylesheet üé®
1921     -
1922     -```diff
1923     -@@ -11,13 +11,18 @@
1924     - 11  11    /* ==================== NEBULA DARK (Default) ==================== */
1925     - 12  12  
1926     - 13  13    /* Core Backgrounds */
1927     - 14     -  --bg-universe: #050508;     /* The void */
1928     - 15     -  --bg-element: #0f1123;      /* Solid panels if needed */
1929     -     14 +  --bg-universe: #050508;
1930     -     15 +  /* The void */
1931     -     16 +  --bg-element: #0f1123;
1932     -     17 +  /* Solid panels if needed */
1933     - 16  18  
1934     - 17  19    /* Glass System */
1935     - 18     -  --bg-glass: rgba(15, 17, 35, 0.6);        /* Main panels */
1936     - 19     -  --bg-glass-heavy: rgba(10, 12, 25, 0.85); /* Sidebar/Modals */
1937     - 20     -  --bg-glass-light: rgba(255, 255, 255, 0.05); /* Hover states */
1938     -     20 +  --bg-glass: rgba(15, 17, 35, 0.6);
1939     -     21 +  /* Main panels */
1940     -     22 +  --bg-glass-heavy: rgba(10, 12, 25, 0.85);
1941     -     23 +  /* Sidebar/Modals */
1942     -     24 +  --bg-glass-light: rgba(255, 255, 255, 0.05);
1943     -     25 +  /* Hover states */
1944     - 21  26  
1945     - 22  27    /* Borders */
1946     - 23  28    --border-glass: rgba(255, 255, 255, 0.08);
1947     -@@ -44,6 +49,10 @@
1948     - 44  49    --radius-lg: 16px;
1949     - 45  50    --radius-md: 12px;
1950     - 46  51    --radius-sm: 8px;
1951     -     52 +
1952     -     53 +  /* Anchor Navigation */
1953     -     54 +  --scroll-padding: 20px;
1954     -     55 +  --scroll-offset: calc(var(--header-height) + var(--scroll-padding));
1955     - 47  56  }
1956     - 48  57  
1957     - 49  58  /* ==================== NEBULA LIGHT ==================== */
1958     - 50  59  
     21 +@@ -1,4 +1,4 @@
     22 +  1     -# üîç Code Review - 12/19/2025, 4:19:18 PM
     23 +      1 +# üîç Code Review - 12/19/2025, 7:26:20 PM
     24 +  2   2  
     25 +  3   3  **Project:** AI Visual Code Review
     26 +  4   4  **Generated by:** AI Visual Code Review v2.0
     27 +@@ -6,1560 +6,1618 @@
     28 +  6   6  ## üìä Change Summary
     29 +  7   7  
     30 +  8   8  ```
     31 +  9     -.../toc-anchor-navigation-design-v5.md             | 900 +++++++++++++++++++++
     32 + 10     - docs/competitive_programming_constraints.md        | 621 ++++++++++++++
     33 + 11     - script.js                                          | 255 ++++++
     34 + 12     - style.css                                          |  41 +
     35 + 13     - variables.css                                      |  19 +-
     36 + 14     - 5 files changed, 1831 insertions(+), 5 deletions(-)
     37 +      9 +README.md                                          |   27 +
     38 +     10 + docs/01-requirements/donation-feature-plan.md      | 1063 ++++++++++++++++++++
     39 +     11 + .../donation_final_readiness_review.md             |   91 ++
     40 +     12 + docs/01-requirements/donation_strategy_review.md   |   64 ++
     41 +     13 + docs/01-requirements/donation_system_design.md     |  141 +++
     42 +     14 + .../donation_technical_feasibility_review.md       |   87 ++
     43 +     15 + index.html                                         |   22 +-
     44 +     16 + script.js                                          |  114 +++
     45 +     17 + style.css                                          |  119 +++
     46 +     18 + 9 files changed, 1722 insertions(+), 6 deletions(-)
     47 + 15  19  ```
     48 + 16  20  
     49 + 17     -## üìù Files Changed (5/5 selected)
     50 +     21 +## üìù Files Changed (9/9 selected)
     51 + 18  22  
     52 + 19  23  
     53 + 20     -### ‚ú® `docs/01-requirements/toc-anchor-navigation-design-v5.md` **[ADDED]**
     54 + 21     -
     55 + 22     -**Status:** ‚úÖ **NEW FILE** - This file has been newly created
     56 +     24 +### üìÑ `README.md`
     57 + 23  25  
     58 + 24  26  **Type:** Documentation üìñ
     59 + 25  27  
     60 + 26  28  ```diff
     61 + 27     -@@ -0,0 +1,900 @@
     62 + 28     -      1 +# Design Document: Table of Contents Anchor Navigation
     63 + 29     -      2 +
     64 + 30     -      3 +## Version 5.0 (Production Ready - Final)
     65 + 31     -      4 +
     66 + 32     -      5 +---
     67 + 33     -      6 +
     68 + 34     -      7 +**Document ID:** DD-2025-002-TOC-NAV
     69 + 35     -      8 +**Author:** Principal SDE
     70 + 36     -      9 +**Created:** December 19, 2025
     71 + 37     -     10 +**Last Updated:** December 19, 2025
     72 + 38     -     11 +**Status:** ‚úÖ **APPROVED FOR IMPLEMENTATION**
     73 + 39     -     12 +**Review Cycles:** 8 (v1.0 ‚Üí v2.0 ‚Üí v3.0 ‚Üí v4.0 ‚Üí v4.1 ‚Üí v4.2 ‚Üí v4.3 ‚Üí v5.0)
     74 +     29 +@@ -7,6 +7,10 @@
     75 +     30 +  7   7  [![Code Quality](https://img.shields.io/badge/code%20quality-A+-brightgreen)]()
     76 +     31 +  8   8  [![Zero Technical Debt](https://img.shields.io/badge/technical%20debt-zero-brightgreen)]()
     77 +     32 +  9   9  
     78 +     33 +     10 +[![GitHub Sponsors](https://img.shields.io/badge/Sponsor-%E2%9D%A4-pink?logo=github)](https://github.com/sponsors/PrakharMNNIT)
     79 +     34 +     11 +[![Ko-fi](https://img.shields.io/badge/Ko--fi-Support-blue?logo=ko-fi)](https://ko-fi.com/praxlannister)
     80 +     35 +     12 +[![Razorpay](https://img.shields.io/badge/Razorpay-‚Çπ_Support-brightgreen)](https://razorpay.me/@prakharshekharparthasarthi)
     81 + 40  36       13 +
     82 + 41     -     14 +---
     83 + 42     -     15 +
     84 + 43     -     16 +## Table of Contents
     85 + 44     -     17 +
     86 + 45     -     18 +1. [Executive Summary](#1-executive-summary)
     87 + 46     -     19 +2. [Problem Statement](#2-problem-statement)
     88 + 47     -     20 +3. [Requirements](#3-requirements)
     89 + 48     -     21 +4. [Technical Design](#4-technical-design)
     90 + 49     -     22 +5. [Implementation Details](#5-implementation-details)
     91 + 50     -     23 +6. [Browser Compatibility](#6-browser-compatibility)
     92 + 51     -     24 +7. [Testing Strategy](#7-testing-strategy)
     93 + 52     -     25 +8. [Performance Budget](#8-performance-budget)
     94 + 53     -     26 +9. [Security Considerations](#9-security-considerations)
     95 + 54     -     27 +10. [Rollback Plan](#10-rollback-plan)
     96 + 55     -     28 +11. [FAQ](#11-faq)
     97 + 56     -     29 +12. [Approval](#12-approval)
     98 + 57     -     30 +13. [Change Log](#13-change-log)
     99 + 58     -     31 +
    100 + 59     -     32 +---
    101 + 60     -     33 +
    102 + 61     -     34 +## 1. Executive Summary
    103 + 62     -     35 +
    104 + 63     -     36 +This document specifies the implementation of in-document anchor navigation for Markdown Viewer Pro. The feature enables clicking Table of Contents links to scroll the preview container to the target heading, with full accessibility support and legacy link compatibility.
    105 + 64     -     37 +
    106 + 65     -     38 +**Key Features:**
    107 + 66     -     39 +- Smooth scroll to headings on TOC link click
    108 + 67     -     40 +- Support for emoji and special character headings
    109 + 68     -     41 +- Legacy link compatibility (non-standard ID formats)
    110 + 69     -     42 +- Accessibility-compliant focus management
    111 + 70     -     43 +- Deep linking (URL hash on page load)
    112 + 71     -     44 +- Browser history support (back/forward)
    113 + 72     -     45 +
    114 + 73     -     46 +---
    115 + 74     -     47 +
    116 + 75     -     48 +## 2. Problem Statement
    117 + 76     -     49 +
    118 + 77     -     50 +### 2.1 Root Cause
    119 + 78     -     51 +
    120 + 79     -     52 +The application uses a **non-scrollable document body** (`overflow: hidden`) with content rendered inside a scrollable child container (`.preview-container`). When users click anchor links (`href="#section"`), the browser's native scroll algorithm targets the document viewport‚Äîwhich is non-scrollable‚Äîresulting in **silent failure**.
    121 + 80     -     53 +
    122 + 81     -     54 +### 2.2 Sticky Toolbar Occlusion
    123 + 82     -     55 +
    124 + 83     -     56 +The application has a fixed toolbar (height: `60px`). A naive scroll-to-element positions content at `top: 0`, causing it to be **obscured by the toolbar**.
    125 + 84     -     57 +
    126 + 85     -     58 +### 2.3 Legacy Link Compatibility
    127 + 86     -     59 +
    128 + 87     -     60 +Existing markdown documents contain manually-created links using non-standard ID formats (e.g., `#üìã-table-of-contents` or `#-standard-assumptions`). These must resolve correctly.
    129 + 88     -     61 +
    130 + 89     -     62 +### 2.4 App Shell ID Collision
    131 + 90     -     63 +
    132 + 91     -     64 +The application shell has elements with IDs like `sidebar`, `preview`, `editor`. User-authored headings with the same names must NOT collide with app shell elements.
    133 + 92     -     65 +
    134 + 93     -     66 +### 2.5 marked.js Singleton Constraint
    135 + 94     -     67 +
    136 + 95     -     68 +`marked` is imported as a global singleton. Calling `marked.use()` inside `renderMarkdown()` (which runs on every keystroke) would stack infinite extensions, causing:
    137 + 96     -     69 +- **Memory leak:** `marked.defaults.extensions` grows infinitely
    138 + 97     -     70 +- **Performance degradation:** After 100 keystrokes, marked runs 100 identical renderers
    139 + 98     -     71 +
    140 + 99     -     72 +---
    141 +100     -     73 +
    142 +101     -     74 +## 3. Requirements
    143 +102     -     75 +
    144 +103     -     76 +### 3.1 Functional Requirements
    145 +104     -     77 +
    146 +105     -     78 +| ID | Requirement | Priority | Acceptance Criteria |
    147 +106     -     79 +|----|-------------|----------|---------------------|
    148 +107     -     80 +| FR-1 | Internal anchor clicks scroll preview to target | P0 | Target heading visible within 800ms |
    149 +108     -     81 +| FR-2 | Scrolled content not occluded by toolbar | P0 | 20px gap between toolbar and heading |
    150 +109     -     82 +| FR-3 | URL hash updates on navigation | P0 | URL reflects current section |
    151 +110     -     83 +| FR-4 | Deep linking works on page load | P0 | `URL#section` scrolls on load |
    152 +111     -     84 +| FR-5 | Browser back/forward navigates history | P1 | Hash changes scroll correctly |
    153 +112     -     85 +| FR-6 | Legacy links work (emoji, special chars) | P0 | See compatibility matrix |
    154 +113     -     86 +| FR-7 | Focus moves to target for screen readers | P0 | Screen reader announces heading |
    155 +114     -     87 +| FR-8 | Empty hash (`#`) scrolls to top | P1 | Container scrollTop = 0 |
    156 +115     -     88 +| FR-9 | No collision with app shell IDs | P0 | User `## Sidebar` != app `#sidebar` |
    157 +116     -     89 +| FR-10 | Duplicate headings get unique IDs | P0 | `header`, `header-1`, `header-2` |
    158 +117     -     90 +
    159 +118     -     91 +### 3.2 Non-Functional Requirements
    160 +119     -     92 +
    161 +120     -     93 +| ID | Requirement | Target |
    162 +121     -     94 +|----|-------------|--------|
    163 +122     -     95 +| NFR-1 | Click-to-scroll latency | < 16ms (1 frame) |
    164 +123     -     96 +| NFR-2 | Scroll animation duration | 300-800ms (distance-based) |
    165 +124     -     97 +| NFR-3 | No layout thrashing | 0 forced reflows |
    166 +125     -     98 +| NFR-4 | Memory overhead | < 1KB per session |
    167 +126     -     99 +| NFR-5 | No memory leaks | Zero extension stacking |
    168 +127     -    100 +| NFR-6 | Stateless rendering | Module-level map with reset |
    169 +128     -    101 +
    170 +129     -    102 +### 3.3 Edge Cases
    171 +130     -    103 +
    172 +131     -    104 +| Case | Input | Expected Behavior |
    173 +132     -    105 +|------|-------|-------------------|
    174 +133     -    106 +| Empty hash | `href="#"` | Scroll to top (scrollTop = 0) |
    175 +134     -    107 +| Non-existent target | `href="#nonexistent"` | Console warning, no action |
    176 +135     -    108 +| External link | `href="https://..."` | Browser default behavior |
    177 +136     -    109 +| Duplicate headers | Two `## Header` | IDs: `header`, `header-1` |
    178 +137     -    110 +| App shell collision | `## Sidebar` | Resolves to user content, not `#sidebar` |
    179 +138     -    111 +| Special chars | `## C++` | ID: `cpp` |
    180 +139     -    112 +| Emoji | `## üéØ Goal` | ID: `goal` |
    181 +140     -    113 +| Concurrent clicks | Click A, then B rapidly | Cancel A, execute B |
    182 +141     -    114 +| Already visible | Target in viewport | Smooth scroll anyway |
    183 +142     -    115 +
    184 +143     -    116 +---
    185 +144     -    117 +
    186 +145     -    118 +## 4. Technical Design
    187 +146     -    119 +
    188 +147     -    120 +### 4.1 Architecture Overview
    189 +148     -    121 +
    190 +149     -    122 +```
    191 +150     -    123 +‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
    192 +151     -    124 +‚îÇ                     User Interaction                          ‚îÇ
    193 +152     -    125 +‚îÇ  [Click] ‚îÄ‚îÄ‚ñ∫ [hashchange] ‚îÄ‚îÄ‚ñ∫ [Page Load with Hash]          ‚îÇ
    194 +153     -    126 +‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
    195 +154     -    127 +                       ‚îÇ
    196 +155     -    128 +                       ‚ñº
    197 +156     -    129 +‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
    198 +157     -    130 +‚îÇ                 AnchorNavigation Module                       ‚îÇ
    199 +158     -    131 +‚îÇ  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê  ‚îÇ
    200 +159     -    132 +‚îÇ  ‚îÇ handleClick()  ‚îÇ  ‚îÇhandleHashChange‚îÇ  ‚îÇhandleInitLoad()‚îÇ  ‚îÇ
    201 +160     -    133 +‚îÇ  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò  ‚îÇ
    202 +161     -    134 +‚îÇ          ‚îÇ                   ‚îÇ                   ‚îÇ            ‚îÇ
    203 +162     -    135 +‚îÇ          ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò            ‚îÇ
    204 +163     -    136 +‚îÇ                              ‚ñº                                ‚îÇ
    205 +164     -    137 +‚îÇ                   ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê                     ‚îÇ
    206 +165     -    138 +‚îÇ                   ‚îÇ  scrollToTarget()   ‚îÇ                     ‚îÇ
    207 +166     -    139 +‚îÇ                   ‚îÇ  ‚îî‚îÄ resolveTarget() ‚îÇ  ‚óÑ‚îÄ‚îÄ SCOPED to      ‚îÇ
    208 +167     -    140 +‚îÇ                   ‚îÇ  ‚îî‚îÄ scrollIntoView  ‚îÇ      container      ‚îÇ
    209 +168     -    141 +‚îÇ                   ‚îÇ  ‚îî‚îÄ manageFocus()   ‚îÇ                     ‚îÇ
    210 +169     -    142 +‚îÇ                   ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò                     ‚îÇ
    211 +170     -    143 +‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
    212 +171     -    144 +```
    213 +172     -    145 +
    214 +173     -    146 +### 4.2 Slug Generation Algorithm
    215 +174     -    147 +
    216 +175     -    148 +**Purpose:** Generate consistent, collision-free IDs for headings.
    217 +176     -    149 +
    218 +177     -    150 +**Algorithm (GitHub-compatible with programming term support):**
    219 +178     -    151 +
    220 +179     -    152 +```javascript
    221 +180     -    153 +// Pre-compiled regex patterns (module level - zero GC pressure)
    222 +181     -    154 +const SLUG_REPLACEMENTS = [
    223 +182     -    155 +  [/c\+\+/gi, 'cpp'],
    224 +183     -    156 +  [/c#/gi, 'csharp'],
    225 +184     -    157 +  [/f#/gi, 'fsharp'],
    226 +185     -    158 +  [/\.net/gi, 'dotnet'],
    227 +186     -    159 +];
    228 +187     -    160 +
    229 +188     -    161 +/**
    230 +189     -    162 + * Generate URL-safe slug from heading text
    231 +190     -    163 + * @param {string} text - Raw heading text (may include HTML)
    232 +191     -    164 + * @param {Map<string, number>} seen - Duplicate tracking map
    233 +192     -    165 + * @returns {string} URL-safe slug
    234 +193     -    166 + */
    235 +194     -    167 +function generateSlug(text, seen = new Map()) {
    236 +195     -    168 +  // Step 0: Strip HTML tags
    237 +196     -    169 +  let slug = text.replace(/<[^>]*>/g, '');
    238 +197     -    170 +
    239 +198     -    171 +  // Step 1: Normalize Unicode (handle caf√© vs caf√©)
    240 +199     -    172 +  slug = slug.normalize('NFC');
    241 +200     -    173 +
    242 +201     -    174 +  // Step 2: Lowercase
    243 +202     -    175 +  slug = slug.toLowerCase();
    244 +203     -    176 +
    245 +204     -    177 +  // Step 3: Replace programming terms (pre-compiled patterns)
    246 +205     -    178 +  for (const [pattern, replacement] of SLUG_REPLACEMENTS) {
    247 +206     -    179 +    slug = slug.replace(pattern, replacement);
    248 +207     -    180 +  }
    249 +208     -    181 +
    250 +209     -    182 +  // Step 4: Remove non-word chars (keep spaces, hyphens, underscores)
    251 +210     -    183 +  slug = slug.replace(/[^\w\s-]/g, '');
    252 +211     -    184 +
    253 +212     -    185 +  // Step 5: Spaces to hyphens
    254 +213     -    186 +  slug = slug.replace(/\s+/g, '-');
    255 +214     -    187 +
    256 +215     -    188 +  // Step 6: Collapse multiple hyphens
    257 +216     -    189 +  slug = slug.replace(/-+/g, '-');
    258 +217     -    190 +
    259 +218     -    191 +  // Step 7: Trim hyphens
    260 +219     -    192 +  slug = slug.replace(/^-+|-+$/g, '');
    261 +220     -    193 +
    262 +221     -    194 +  // Step 8: Fallback for empty result
    263 +222     -    195 +  if (!slug) slug = 'section';
    264 +223     -    196 +
    265 +224     -    197 +  // Step 9: Handle duplicates (header, header-1, header-2)
    266 +225     -    198 +  const baseSlug = slug;
    267 +226     -    199 +  const count = seen.get(baseSlug) || 0;
    268 +227     -    200 +  if (count > 0) {
    269 +228     -    201 +    slug = `${baseSlug}-${count}`;
    270 +229     -    202 +  }
    271 +230     -    203 +  seen.set(baseSlug, count + 1);
    272 +231     -    204 +
    273 +232     -    205 +  return slug;
    274 +233     -    206 +}
    275 +234     -    207 +```
    276 +235     -    208 +
    277 +236     -    209 +**Transformation Examples:**
    278 +237     -    210 +
    279 +238     -    211 +| Input | Output | Reason |
    280 +239     -    212 +|-------|--------|--------|
    281 +240     -    213 +| `Hello World` | `hello-world` | Standard |
    282 +241     -    214 +| `üéØ Standard Assumptions` | `standard-assumptions` | Emoji stripped |
    283 +242     -    215 +| `C++` | `cpp` | Special replacement |
    284 +243     -    216 +| `C#` | `csharp` | Special replacement |
    285 +244     -    217 +| `.NET Framework` | `dotnet-framework` | Special replacement |
    286 +245     -    218 +| `F#` | `fsharp` | Special replacement |
    287 +246     -    219 +| `API v2.0` | `api-v20` | Period stripped |
    288 +247     -    220 +| `1. Introduction` | `1-introduction` | Numbers preserved |
    289 +248     -    221 +| `hello_world` | `hello_world` | Underscores preserved |
    290 +249     -    222 +| `Header` (1st) | `header` | First occurrence |
    291 +250     -    223 +| `Header` (2nd) | `header-1` | Duplicate handling |
    292 +251     -    224 +| `Header` (3rd) | `header-2` | Duplicate handling |
    293 +252     -    225 +| `üòÄüòÄüòÄ` | `section` | Fallback for empty |
    294 +253     -    226 +| `--test--` | `test` | Trimmed |
    295 +254     -    227 +
    296 +255     -    228 +### 4.3 State Management (Singleton-Safe)
    297 +256     -    229 +
    298 +257     -    230 +**Critical:** `marked` is a global singleton. Extension registration happens ONCE at startup.
    299 +258     -    231 +
    300 +259     -    232 +```javascript
    301 +260     -    233 +// Module level (script.js, near top)
    302 +261     -    234 +const headingSlugMap = new Map();
    303 +262     -    235 +
    304 +263     -    236 +function resetSlugMap() {
    305 +264     -    237 +  headingSlugMap.clear();
    306 +265     -    238 +}
    307 +266     -    239 +
    308 +267     -    240 +// In configureMarkedExtensions() - called ONCE at app init
    309 +268     -    241 +marked.use({
    310 +269     -    242 +  renderer: {
    311 +270     -    243 +    heading(token) {
    312 +271     -    244 +      const text = this.parser.parseInline(token.tokens);
    313 +272     -    245 +      const level = token.depth;
    314 +273     -    246 +      const slug = generateSlug(text, headingSlugMap);
    315 +274     -    247 +      return `<h${level} id="${slug}">${text}</h${level}>\n`;
    316 +275     -    248 +    }
    317 +276     -    249 +  }
    318 +277     -    250 +});
    319 +278     -    251 +
    320 +279     -    252 +// In renderMarkdown() - called on every keystroke
    321 +280     -    253 +function renderMarkdown() {
    322 +281     -    254 +  resetSlugMap();  // Clear state, NOT re-register extension
    323 +282     -    255 +  const html = marked.parse(text);
    324 +283     -    256 +  // ...
    325 +284     -    257 +}
    326 +285     -    258 +```
    327 +286     -    259 +
    328 +287     -    260 +### 4.4 Link Resolution (Scoped Selection)
    329 +288     -    261 +
    330 +289     -    262 +**Purpose:** Match clicked links to generated IDs, preventing app shell collision.
    331 +290     -    263 +
    332 +291     -    264 +```javascript
    333 +292     -    265 +/**
    334 +293     -    266 + * Resolve target element from hash - SCOPED to container
    335 +294     -    267 + * @param {string} hash - URL hash (without #)
    336 +295     -    268 + * @param {HTMLElement} container - Scrollable container
    337 +296     -    269 + * @returns {Element|null} Target element or null
    338 +297     -    270 + */
    339 +298     -    271 +function resolveTarget(hash, container) {
    340 +299     -    272 +  if (!hash) return null;
    341 +300     -    273 +
    342 +301     -    274 +  // Decode URI components
    343 +302     -    275 +  let decodedHash;
    344 +303     -    276 +  try {
    345 +304     -    277 +    decodedHash = decodeURIComponent(hash);
    346 +305     -    278 +  } catch {
    347 +306     -    279 +    decodedHash = hash;
    348 +307     -    280 +  }
    349 +308     -    281 +
    350 +309     -    282 +  // Priority 1: Exact ID (SCOPED to container - prevents app shell collision)
    351 +310     -    283 +  let target = container.querySelector(`#${CSS.escape(decodedHash)}`);
    352 +311     -    284 +  if (target) return target;
    353 +312     -    285 +
    354 +313     -    286 +  // Priority 2: Normalized ID (handles legacy links)
    355 +314     -    287 +  const normalizedHash = normalizeHash(decodedHash);
    356 +315     -    288 +  target = container.querySelector(`#${CSS.escape(normalizedHash)}`);
    357 +316     -    289 +  if (target) return target;
    358 +317     -    290 +
    359 +318     -    291 +  console.warn(`[AnchorNav] Target not found: "${hash}"`);
    360 +319     -    292 +  return null;
    361 +320     -    293 +}
    362 +321     -    294 +
    363 +322     -    295 +/**
    364 +323     -    296 + * Normalize hash for legacy link matching
    365 +324     -    297 + */
    366 +325     -    298 +function normalizeHash(hash) {
    367 +326     -    299 +  let slug = hash.normalize('NFC').toLowerCase();
    368 +327     -    300 +
    369 +328     -    301 +  for (const [pattern, replacement] of SLUG_REPLACEMENTS) {
    370 +329     -    302 +    slug = slug.replace(pattern, replacement);
    371 +330     -    303 +  }
    372 +331     -    304 +
    373 +332     -    305 +  return slug
    374 +333     -    306 +    .replace(/[^\w\s-]/g, '')
    375 +334     -    307 +    .replace(/\s+/g, '-')
    376 +335     -    308 +    .replace(/-+/g, '-')
    377 +336     -    309 +    .replace(/^-+|-+$/g, '') || 'section';
    378 +337     -    310 +}
    379 +338     -    311 +```
    380 +339     -    312 +
    381 +340     -    313 +---
    382 +341     -    314 +
    383 +342     -    315 +## 5. Implementation Details
    384 +343     -    316 +
    385 +344     -    317 +### 5.1 CSS Configuration
    386 +345     -    318 +
    387 +346     -    319 +**File: `variables.css`** (add to existing `:root`)
    388 +347     -    320 +```css
    389 +348     -    321 +:root {
    390 +349     -    322 +  /* Existing variables... */
    391 +350     -    323 +
    392 +351     -    324 +  /* Anchor Navigation */
    393 +352     -    325 +  --toolbar-height: 60px;
    394 +353     -    326 +  --scroll-padding: 20px;
    395 +354     -    327 +  --scroll-offset: calc(var(--toolbar-height) + var(--scroll-padding));
    396 +355     -    328 +}
    397 +356     -    329 +```
    398 +357     -    330 +
    399 +358     -    331 +**File: `style.css`** (add new section)
    400 +359     -    332 +```css
    401 +360     -    333 +/* ==================== ANCHOR NAVIGATION ==================== */
    402 +361     -    334 +
    403 +362     -    335 +/* Scroll padding - SINGLE SOURCE of offset */
    404 +363     -    336 +.preview-container {
    405 +364     -    337 +  scroll-padding-top: var(--scroll-offset, 80px);
    406 +365     -    338 +}
    407 +366     -    339 +
    408 +367     -    340 +/* Target highlight animation */
    409 +368     -    341 +.preview-container :target {
    410 +369     -    342 +  animation: anchor-highlight 2s ease-out;
    411 +370     -    343 +}
    412 +371     -    344 +
    413 +372     -    345 +@keyframes anchor-highlight {
    414 +373     -    346 +  0% { background-color: rgba(255, 255, 0, 0.3); }
    415 +374     -    347 +  100% { background-color: transparent; }
    416 +375     -    348 +}
    417 +376     -    349 +
    418 +377     -    350 +/* Focus management - conditional outline */
    419 +378     -    351 +.preview-container h1[id]:focus:not(:focus-visible),
    420 +379     -    352 +.preview-container h2[id]:focus:not(:focus-visible),
    421 +380     -    353 +.preview-container h3[id]:focus:not(:focus-visible),
    422 +381     -    354 +.preview-container h4[id]:focus:not(:focus-visible),
    423 +382     -    355 +.preview-container h5[id]:focus:not(:focus-visible),
    424 +383     -    356 +.preview-container h6[id]:focus:not(:focus-visible) {
    425 +384     -    357 +  outline: none;
    426 +385     -    358 +}
    427 +386     -    359 +
    428 +387     -    360 +/* Keyboard focus gets visible indicator */
    429 +388     -    361 +.preview-container h1[id]:focus-visible,
    430 +389     -    362 +.preview-container h2[id]:focus-visible,
    431 +390     -    363 +.preview-container h3[id]:focus-visible,
    432 +391     -    364 +.preview-container h4[id]:focus-visible,
    433 +392     -    365 +.preview-container h5[id]:focus-visible,
    434 +393     -    366 +.preview-container h6[id]:focus-visible {
    435 +394     -    367 +  outline: 2px solid var(--primary-color, #007bff);
    436 +395     -    368 +  outline-offset: 4px;
    437 +396     -    369 +  border-radius: 2px;
    438 +397     -    370 +}
    439 +398     -    371 +```
    440 +399     -    372 +
    441 +400     -    373 +### 5.2 JavaScript Implementation
    442 +401     -    374 +
    443 +402     -    375 +**File: `script.js`** (modifications)
    444 +403     -    376 +
    445 +404     -    377 +```javascript
    446 +405     -    378 +// ==================== ANCHOR NAVIGATION ====================
    447 +406     -    379 +// Add near top of file, after imports
    448 +407     -    380 +
    449 +408     -    381 +// Heading slug tracking (module-level singleton)
    450 +409     -    382 +const headingSlugMap = new Map();
    451 +410     -    383 +
    452 +411     -    384 +// Pre-compiled slug replacements (zero GC pressure)
    453 +412     -    385 +const SLUG_REPLACEMENTS = [
    454 +413     -    386 +  [/c\+\+/gi, 'cpp'],
    455 +414     -    387 +  [/c#/gi, 'csharp'],
    456 +415     -    388 +  [/f#/gi, 'fsharp'],
    457 +416     -    389 +  [/\.net/gi, 'dotnet'],
    458 +417     -    390 +];
    459 +418     -    391 +
    460 +419     -    392 +/**
    461 +420     -    393 + * Reset slug map (call before each parse)
    462 +421     -    394 + */
    463 +422     -    395 +function resetSlugMap() {
    464 +423     -    396 +  headingSlugMap.clear();
    465 +424     -    397 +}
    466 +425     -    398 +
    467 +426     -    399 +/**
    468 +427     -    400 + * Generate URL-safe slug from heading text
    469 +428     -    401 + */
    470 +429     -    402 +function generateSlug(text, seen = headingSlugMap) {
    471 +430     -    403 +  // Strip HTML tags
    472 +431     -    404 +  let slug = text.replace(/<[^>]*>/g, '');
    473 +432     -    405 +
    474 +433     -    406 +  // Normalize Unicode
    475 +434     -    407 +  slug = slug.normalize('NFC').toLowerCase();
    476 +435     -    408 +
    477 +436     -    409 +  // Replace programming terms
    478 +437     -    410 +  for (const [pattern, replacement] of SLUG_REPLACEMENTS) {
    479 +438     -    411 +    slug = slug.replace(pattern, replacement);
    480 +439     -    412 +  }
    481 +440     -    413 +
    482 +441     -    414 +  // Clean up
    483 +442     -    415 +  slug = slug
    484 +443     -    416 +    .replace(/[^\w\s-]/g, '')
    485 +444     -    417 +    .replace(/\s+/g, '-')
    486 +445     -    418 +    .replace(/-+/g, '-')
    487 +446     -    419 +    .replace(/^-+|-+$/g, '');
    488 +447     -    420 +
    489 +448     -    421 +  if (!slug) slug = 'section';
    490 +449     -    422 +
    491 +450     -    423 +  // Handle duplicates
    492 +451     -    424 +  const baseSlug = slug;
    493 +452     -    425 +  const count = seen.get(baseSlug) || 0;
    494 +453     -    426 +  if (count > 0) slug = `${baseSlug}-${count}`;
    495 +454     -    427 +  seen.set(baseSlug, count + 1);
    496 +455     -    428 +
    497 +456     -    429 +  return slug;
    498 +457     -    430 +}
    499 +458     -    431 +
    500 +459     -    432 +/**
    501 +460     -    433 + * Anchor Navigation Module
    502 +461     -    434 + */
    503 +462     -    435 +const AnchorNavigation = {
    504 +463     -    436 +  container: null,
    505 +464     -    437 +  pendingScroll: null,
    506 +465     -    438 +
    507 +466     -    439 +  /**
    508 +467     -    440 +   * Initialize anchor navigation
    509 +468     -    441 +   */
    510 +469     -    442 +  init(previewContainer) {
    511 +470     -    443 +    this.container = previewContainer;
    512 +471     -    444 +
    513 +472     -    445 +    // Event delegation for clicks
    514 +473     -    446 +    this.container.addEventListener('click', this.handleClick.bind(this));
    515 +474     -    447 +
    516 +475     -    448 +    // Browser back/forward
    517 +476     -    449 +    window.addEventListener('hashchange', this.handleHashChange.bind(this));
    518 +477     -    450 +
    519 +478     -    451 +    // Initial page load with hash
    520 +479     -    452 +    if (window.location.hash) {
    521 +480     -    453 +      requestAnimationFrame(() => {
    522 +481     -    454 +        this.scrollToHash(window.location.hash.slice(1), false);
    523 +482     -    455 +      });
    524 +483     -    456 +    }
    525 +484     -    457 +  },
    526 +485     -    458 +
    527 +486     -    459 +  /**
    528 +487     -    460 +   * Handle click events (delegated)
    529 +488     -    461 +   */
    530 +489     -    462 +  handleClick(event) {
    531 +490     -    463 +    const link = event.target.closest('a[href^="#"]');
    532 +491     -    464 +    if (!link) return;
    533 +492     -    465 +
    534 +493     -    466 +    // Ignore external links
    535 +494     -    467 +    if (link.hostname && link.hostname !== window.location.hostname) return;
    536 +495     -    468 +
    537 +496     -    469 +    event.preventDefault();
    538 +497     -    470 +
    539 +498     -    471 +    const hash = link.getAttribute('href').slice(1);
    540 +499     -    472 +    this.scrollToHash(hash, true);
    541 +500     -    473 +
    542 +501     -    474 +    // Update URL
    543 +502     -    475 +    history.pushState(null, '', `#${hash}`);
    544 +503     -    476 +  },
    545 +504     -    477 +
    546 +505     -    478 +  /**
    547 +506     -    479 +   * Handle hashchange (back/forward)
    548 +507     -    480 +   */
    549 +508     -    481 +  handleHashChange() {
    550 +509     -    482 +    const hash = window.location.hash.slice(1);
    551 +510     -    483 +    if (hash) {
    552 +511     -    484 +      this.scrollToHash(hash, true);
    553 +512     -    485 +    } else {
    554 +513     -    486 +      this.scrollToTop(true);
    555 +514     -    487 +    }
    556 +515     -    488 +  },
    557 +516     -    489 +
    558 +517     -    490 +  /**
    559 +518     -    491 +   * Scroll to element by hash
    560 +519     -    492 +   */
    561 +520     -    493 +  scrollToHash(hash, smooth = true) {
    562 +521     -    494 +    // Cancel pending scroll (handle concurrent clicks)
    563 +522     -    495 +    if (this.pendingScroll) {
    564 +523     -    496 +      clearTimeout(this.pendingScroll);
    565 +524     -    497 +      this.pendingScroll = null;
    566 +525     -    498 +    }
    567 +526     -    499 +
    568 +527     -    500 +    if (!hash) {
    569 +528     -    501 +      this.scrollToTop(smooth);
    570 +529     -    502 +      return;
    571 +530     -    503 +    }
    572 +531     -    504 +
    573 +532     -    505 +    const target = this.resolveTarget(hash);
    574 +533     -    506 +    if (!target) return;
    575 +534     -    507 +
    576 +535     -    508 +    target.scrollIntoView({
    577 +536     -    509 +      behavior: smooth ? 'smooth' : 'instant',
    578 +537     -    510 +      block: 'start',
    579 +538     -    511 +    });
    580 +539     -    512 +
    581 +540     -    513 +    this.manageFocus(target, smooth);
    582 +541     -    514 +  },
    583 +542     -    515 +
    584 +543     -    516 +  /**
    585 +544     -    517 +   * Scroll to top
    586 +545     -    518 +   */
    587 +546     -    519 +  scrollToTop(smooth = true) {
    588 +547     -    520 +    this.container.scrollTo({
    589 +548     -    521 +      top: 0,
    590 +549     -    522 +      behavior: smooth ? 'smooth' : 'instant',
    591 +550     -    523 +    });
    592 +551     -    524 +  },
    593 +552     -    525 +
    594 +553     -    526 +  /**
    595 +554     -    527 +   * Resolve target - SCOPED to container
    596 +555     -    528 +   */
    597 +556     -    529 +  resolveTarget(hash) {
    598 +557     -    530 +    if (!hash) return null;
    599 +558     -    531 +
    600 +559     -    532 +    let decodedHash;
    601 +560     -    533 +    try {
    602 +561     -    534 +      decodedHash = decodeURIComponent(hash);
    603 +562     -    535 +    } catch {
    604 +563     -    536 +      decodedHash = hash;
    605 +564     -    537 +    }
    606 +565     -    538 +
    607 +566     -    539 +    // Priority 1: Exact ID (scoped)
    608 +567     -    540 +    let target = this.container.querySelector(`#${CSS.escape(decodedHash)}`);
    609 +568     -    541 +    if (target) return target;
    610 +569     -    542 +
    611 +570     -    543 +    // Priority 2: Normalized ID (scoped)
    612 +571     -    544 +    const normalized = this.normalizeHash(decodedHash);
    613 +572     -    545 +    target = this.container.querySelector(`#${CSS.escape(normalized)}`);
    614 +573     -    546 +    if (target) return target;
    615 +574     -    547 +
    616 +575     -    548 +    console.warn(`[AnchorNav] Target not found: "${hash}"`);
    617 +576     -    549 +    return null;
    618 +577     -    550 +  },
    619 +578     -    551 +
    620 +579     -    552 +  /**
    621 +580     -    553 +   * Normalize hash for legacy link matching
    622 +581     -    554 +   */
    623 +582     -    555 +  normalizeHash(hash) {
    624 +583     -    556 +    let slug = hash.normalize('NFC').toLowerCase();
    625 +584     -    557 +
    626 +585     -    558 +    for (const [pattern, replacement] of SLUG_REPLACEMENTS) {
    627 +586     -    559 +      slug = slug.replace(pattern, replacement);
    628 +587     -    560 +    }
    629 +588     -    561 +
    630 +589     -    562 +    return slug
    631 +590     -    563 +      .replace(/[^\w\s-]/g, '')
    632 +591     -    564 +      .replace(/\s+/g, '-')
    633 +592     -    565 +      .replace(/-+/g, '-')
    634 +593     -    566 +      .replace(/^-+|-+$/g, '') || 'section';
    635 +594     -    567 +  },
    636 +595     -    568 +
    637 +596     -    569 +  /**
    638 +597     -    570 +   * Manage focus after scroll
    639 +598     -    571 +   */
    640 +599     -    572 +  manageFocus(target, smooth) {
    641 +600     -    573 +    const focusTarget = () => {
    642 +601     -    574 +      if (!target.hasAttribute('tabindex')) {
    643 +602     -    575 +        target.setAttribute('tabindex', '-1');
    644 +603     -    576 +      }
    645 +604     -    577 +      target.focus({ preventScroll: true });
    646 +605     -    578 +    };
    647 +606     -    579 +
    648 +607     -    580 +    if (!smooth) {
    649 +608     -    581 +      focusTarget();
    650 +609     -    582 +      return;
    651 +610     -    583 +    }
    652 +611     -    584 +
    653 +612     -    585 +    // Modern: scrollend event
    654 +613     -    586 +    if ('onscrollend' in this.container) {
    655 +614     -    587 +      this.container.addEventListener('scrollend', focusTarget, { once: true });
    656 +615     -    588 +    } else {
    657 +616     -    589 +      // Fallback: estimate duration (max 1000ms for safety)
    658 +617     -    590 +      const distance = Math.abs(target.getBoundingClientRect().top);
    659 +618     -    591 +      const duration = Math.min(Math.max(distance / 2, 300), 1000);
    660 +619     -    592 +      this.pendingScroll = setTimeout(focusTarget, duration + 50);
    661 +620     -    593 +    }
    662 +621     -    594 +  },
    663 +622     -    595 +};
    664 +623     -    596 +```
    665 +624     -    597 +
    666 +625     -    598 +### 5.3 Integration Points
    667 +626     -    599 +
    668 +627     -    600 +**In `configureMarkedExtensions()`:**
    669 +628     -    601 +```javascript
    670 +629     -    602 +function configureMarkedExtensions() {
    671 +630     -    603 +  // ... existing extensions ...
    672 +631     -    604 +
    673 +632     -    605 +  // Custom heading renderer with ID generation
    674 +633     -    606 +  marked.use({
    675 +634     -    607 +    renderer: {
    676 +635     -    608 +      heading(token) {
    677 +636     -    609 +        const text = this.parser.parseInline(token.tokens);
    678 +637     -    610 +        const level = token.depth;
    679 +638     -    611 +        const slug = generateSlug(text, headingSlugMap);
    680 +639     -    612 +        return `<h${level} id="${slug}">${text}</h${level}>\n`;
    681 +640     -    613 +      }
    682 +641     -    614 +    }
    683 +642     -    615 +  });
    684 +643     -    616 +  console.log('‚úÖ Custom heading renderer enabled (ID generation)');
    685 +644     -    617 +}
    686 +645     -    618 +```
    687 +646     -    619 +
    688 +647     -    620 +**In `renderMarkdown()`:**
    689 +648     -    621 +```javascript
    690 +649     -    622 +function renderMarkdown() {
    691 +650     -    623 +  try {
    692 +651     -    624 +    resetSlugMap();  // Clear slug tracking before parse
    693 +652     -    625 +
    694 +653     -    626 +    const markdownText = editor.value;
    695 +654     -    627 +    let html = marked.parse(markdownText);
    696 +655     -    628 +    // ... rest of existing logic ...
    697 +656     -    629 +  }
    698 +657     -    630 +}
    699 +658     -    631 +```
    700 +659     -    632 +
    701 +660     -    633 +**In `setupEditor()` (at end):**
    702 +661     -    634 +```javascript
    703 +662     -    635 +// Initialize anchor navigation
    704 +663     -    636 +AnchorNavigation.init(previewContainer);
    705 +664     -    637 +```
    706 +665     -    638 +
    707 +666     -    639 +---
    708 +667     -    640 +
    709 +668     -    641 +## 6. Browser Compatibility
    710 +669     -    642 +
    711 +670     -    643 +| Feature | Chrome | Firefox | Safari | Edge | Fallback |
    712 +671     -    644 +|---------|--------|---------|--------|------|----------|
    713 +672     -    645 +| `scrollIntoView({ behavior })` | 61+ | 36+ | 15.4+ | 79+ | Instant scroll |
    714 +673     -    646 +| `scrollend` event | 114+ | 109+ | 17+ | 114+ | setTimeout (1000ms max) |
    715 +674     -    647 +| `scroll-padding-top` | 69+ | 68+ | 14.1+ | 79+ | None needed |
    716 +675     -    648 +| `CSS.escape()` | 46+ | 31+ | 10+ | 79+ | None needed |
    717 +676     -    649 +| `:focus-visible` | 86+ | 85+ | 15.4+ | 86+ | Always show outline |
    718 +677     -    650 +
    719 +678     -    651 +**Minimum Supported:** Chrome 86, Firefox 85, Safari 15.4, Edge 86
    720 +679     -    652 +
    721 +680     -    653 +---
    722 +681     -    654 +
    723 +682     -    655 +## 7. Testing Strategy
    724 +683     -    656 +
    725 +684     -    657 +### 7.1 Unit Tests
    726 +685     -    658 +
    727 +686     -    659 +**File: `tests/unit/utils/anchorNavigation.test.js`**
    728 +687     -    660 +
    729 +688     -    661 +```javascript
    730 +689     -    662 +import { describe, it, expect, beforeEach } from 'vitest';
    731 +690     -    663 +
    732 +691     -    664 +describe('generateSlug', () => {
    733 +692     -    665 +  let seen;
    734 +693     -    666 +
    735 +694     -    667 +  beforeEach(() => {
    736 +695     -    668 +    seen = new Map();
    737 +696     -    669 +  });
    738 +697     -    670 +
    739 +698     -    671 +  describe('basic transformations', () => {
    740 +699     -    672 +    it('converts to lowercase', () => {
    741 +700     -    673 +      expect(generateSlug('HELLO', seen)).toBe('hello');
    742 +701     -    674 +    });
    743 +702     -    675 +
    744 +703     -    676 +    it('replaces spaces with hyphens', () => {
    745 +704     -    677 +      expect(generateSlug('hello world', seen)).toBe('hello-world');
    746 +705     -    678 +    });
    747 +706     -    679 +
    748 +707     -    680 +    it('preserves numbers', () => {
    749 +708     -    681 +      expect(generateSlug('Section 1', seen)).toBe('section-1');
    750 +709     -    682 +    });
    751 +710     -    683 +
    752 +711     -    684 +    it('preserves underscores', () => {
    753 +712     -    685 +      expect(generateSlug('hello_world', seen)).toBe('hello_world');
    754 +713     -    686 +    });
    755 +714     -    687 +  });
    756 +     37 + 10  14  ---
    757 +     38 + 11  15  
    758 +     39 + 12  16  ## ‚ú® Features
    759 +     40 +@@ -680,6 +684,29 @@ MIT License - See LICENSE file for details
    760 +     41 +680 684  
    761 +     42 +681 685  ---
    762 +     43 +682 686  
    763 +     44 +    687 +---
    764 +715  45      688 +
    765 +716     -    689 +  describe('special characters', () => {
    766 +717     -    690 +    it('removes emoji', () => {
    767 +718     -    691 +      expect(generateSlug('üéØ Goal', seen)).toBe('goal');
    768 +719     -    692 +    });
    769 +720     -    693 +
    770 +721     -    694 +    it('handles C++', () => {
    771 +722     -    695 +      expect(generateSlug('C++', seen)).toBe('cpp');
    772 +723     -    696 +    });
    773 +724     -    697 +
    774 +725     -    698 +    it('handles C#', () => {
    775 +726     -    699 +      expect(generateSlug('C#', seen)).toBe('csharp');
    776 +727     -    700 +    });
    777 +728     -    701 +
    778 +729     -    702 +    it('handles F#', () => {
    779 +730     -    703 +      expect(generateSlug('F#', seen)).toBe('fsharp');
    780 +731     -    704 +    });
    781 +     46 +    689 +## üíñ Support This Project
    782 +     47 +    690 +
    783 +     48 +    691 +If you find Markdown Viewer Pro useful, consider supporting its development:
    784 +     49 +    692 +
    785 +     50 +    693 +[![GitHub Sponsors](https://img.shields.io/badge/Sponsor-%E2%9D%A4-pink?logo=github&style=for-the-badge)](https://github.com/sponsors/PrakharMNNIT)
    786 +     51 +    694 +[![Ko-fi](https://img.shields.io/badge/Ko--fi-Support-blue?logo=ko-fi&style=for-the-badge)](https://ko-fi.com/praxlannister)
    787 +     52 +    695 +[![Razorpay](https://img.shields.io/badge/Razorpay-‚Çπ_UPI-brightgreen?style=for-the-badge)](https://razorpay.me/@prakharshekharparthasarthi)
    788 +     53 +    696 +
    789 +     54 +    697 +### Support Tiers
    790 +     55 +    698 +
    791 +     56 +    699 +| Tier | Amount (USD) | Amount (INR) | Perks |
    792 +     57 +    700 +|------|--------------|--------------|-------|
    793 +     58 +    701 +| ‚òï Coffee | $1 | ‚Çπ50 | My gratitude! |
    794 +     59 +    702 +| üçï Pizza | $5 | ‚Çπ250 | Name in SUPPORTERS.md |
    795 +     60 +    703 +| üéâ Patron | $20 | ‚Çπ1000 | Name in README |
    796 +     61 +    704 +| üíé Champion | $50+ | ‚Çπ2500+ | Logo in README |
    797 +732  62      705 +
    798 +733     -    706 +    it('handles .NET', () => {
    799 +734     -    707 +      expect(generateSlug('.NET Framework', seen)).toBe('dotnet-framework');
    800 +735     -    708 +    });
    801 +     63 +    706 +Your support helps maintain and improve this project. Every contribution is appreciated! üôè
    802 +     64 +    707 +
    803 +     65 +    708 +---
    804 +736  66      709 +
    805 +737     -    710 +    it('strips periods', () => {
    806 +738     -    711 +      expect(generateSlug('API v2.0', seen)).toBe('api-v20');
    807 +739     -    712 +    });
    808 +740     -    713 +  });
    809 +741     -    714 +
    810 +742     -    715 +  describe('edge cases', () => {
    811 +743     -    716 +    it('collapses multiple hyphens', () => {
    812 +744     -    717 +      expect(generateSlug('hello--world', seen)).toBe('hello-world');
    813 +745     -    718 +    });
    814 +746     -    719 +
    815 +747     -    720 +    it('trims leading hyphens', () => {
    816 +748     -    721 +      expect(generateSlug('--hello', seen)).toBe('hello');
    817 +749     -    722 +    });
    818 +750     -    723 +
    819 +751     -    724 +    it('trims trailing hyphens', () => {
    820 +752     -    725 +      expect(generateSlug('hello--', seen)).toBe('hello');
    821 +753     -    726 +    });
    822 +754     -    727 +
    823 +755     -    728 +    it('returns "section" for empty result', () => {
    824 +756     -    729 +      expect(generateSlug('!!!', seen)).toBe('section');
    825 +757     -    730 +      expect(generateSlug('üòÄüòÄüòÄ', seen)).toBe('section');
    826 +758     -    731 +    });
    827 +759     -    732 +
    828 +760     -    733 +    it('handles unicode normalization', () => {
    829 +761     -    734 +      expect(generateSlug('caf√©', seen)).toBe('caf');
    830 +762     -    735 +    });
    831 +763     -    736 +
    832 +764     -    737 +    it('strips HTML tags', () => {
    833 +765     -    738 +      expect(generateSlug('<strong>Bold</strong> text', seen)).toBe('bold-text');
    834 +766     -    739 +    });
    835 +767     -    740 +  });
    836 +768     -    741 +
    837 +769     -    742 +  describe('duplicate handling', () => {
    838 +770     -    743 +    it('adds suffix for duplicates', () => {
    839 +771     -    744 +      expect(generateSlug('Header', seen)).toBe('header');
    840 +772     -    745 +      expect(generateSlug('Header', seen)).toBe('header-1');
    841 +773     -    746 +      expect(generateSlug('Header', seen)).toBe('header-2');
    842 +774     -    747 +    });
    843 +775     -    748 +
    844 +776     -    749 +    it('tracks different bases separately', () => {
    845 +777     -    750 +      expect(generateSlug('Header', seen)).toBe('header');
    846 +778     -    751 +      expect(generateSlug('Footer', seen)).toBe('footer');
    847 +779     -    752 +      expect(generateSlug('Header', seen)).toBe('header-1');
    848 +780     -    753 +    });
    849 +781     -    754 +  });
    850 +782     -    755 +});
    851 +783     -    756 +
    852 +784     -    757 +describe('normalizeHash', () => {
    853 +785     -    758 +  it('normalizes legacy emoji links', () => {
    854 +786     -    759 +    expect(normalizeHash('üéØ-standard-assumptions')).toBe('standard-assumptions');
    855 +787     -    760 +  });
    856 +788     -    761 +
    857 +789     -    762 +  it('normalizes leading hyphens', () => {
    858 +790     -    763 +    expect(normalizeHash('-hello-world-')).toBe('hello-world');
    859 +791     -    764 +  });
    860 +792     -    765 +
    861 +793     -    766 +  it('handles programming terms', () => {
    862 +794     -    767 +    expect(normalizeHash('c++')).toBe('cpp');
    863 +795     -    768 +  });
    864 +796     -    769 +});
    865 +797     -    770 +```
    866 +798     -    771 +
    867 +799     -    772 +### 7.2 Manual Test Cases
    868 +800     -    773 +
    869 +801     -    774 +| # | Scenario | Steps | Expected Result |
    870 +802     -    775 +|---|----------|-------|-----------------|
    871 +803     -    776 +| 1 | Standard TOC click | Click TOC link `#introduction` | Scrolls to heading, visible below toolbar |
    872 +804     -    777 +| 2 | Emoji header | Click `#üéØ-goal` | Resolves to `#goal`, scrolls correctly |
    873 +805     -    778 +| 3 | C++ header | Click `#c++` | Resolves to `#cpp`, scrolls correctly |
    874 +806     -    779 +| 4 | Deep link | Load `URL#section-1` | Page scrolls to section on load |
    875 +807     -    780 +| 5 | Browser back | Click link, then browser back | Returns to previous scroll position |
    876 +808     -    781 +| 6 | Empty hash | Click `href="#"` | Scrolls to top of container |
    877 +809     -    782 +| 7 | Invalid target | Click `#nonexistent` | Console warning, no crash |
    878 +810     -    783 +| 8 | Duplicate headers | Two `## Header` | First is `#header`, second is `#header-1` |
    879 +811     -    784 +| 9 | App shell collision | `## Sidebar` heading | Scrolls to user heading, not app `#sidebar` |
    880 +812     -    785 +| 10 | Accessibility | Tab to link, press Enter | Focus moves to heading, screen reader announces |
    881 +813     -    786 +| 11 | Concurrent clicks | Click A, immediately click B | Only B executes |
    882 +814     -    787 +
    883 +815     -    788 +---
    884 +816     -    789 +
    885 +817     -    790 +## 8. Performance Budget
    886 +818     -    791 +
    887 +819     -    792 +| Metric | Budget | Measurement Method |
    888 +820     -    793 +|--------|--------|-------------------|
    889 +821     -    794 +| Click-to-scroll latency | < 16ms | `performance.now()` delta |
    890 +822     -    795 +| Slug generation per heading | < 1ms | Profile in DevTools |
    891 +823     -    796 +| DOM queries per click | ‚â§ 2 | Code review |
    892 +824     -    797 +| Memory per session | < 1KB | DevTools heap snapshot |
    893 +825     -    798 +| Extension stack size | 1 (no growth) | `marked.defaults.extensions.length` |
    894 +826     -    799 +
    895 +827     -    800 +---
    896 +828     -    801 +
    897 +829     -    802 +## 9. Security Considerations
    898 +830     -    803 +
    899 +831     -    804 +| Concern | Risk | Mitigation |
    900 +832     -    805 +|---------|------|------------|
    901 +833     -    806 +| XSS via hash | Low | Hash is never inserted into innerHTML |
    902 +834     -    807 +| Open redirect | Low | Only same-origin hashes processed |
    903 +835     -    808 +| DoS (rapid clicks) | Low | Pending scroll cancellation |
    904 +836     -    809 +| Invalid ID injection | Low | `CSS.escape()` for selectors |
    905 +837     -    810 +| HTML in headings | Medium | Tags stripped before slug generation |
    906 +838     -    811 +
    907 +839     -    812 +---
    908 +840     -    813 +
    909 +841     -    814 +## 10. Rollback Plan
    910 +842     -    815 +
    911 +843     -    816 +### 10.1 Affected Files
    912 +844     -    817 +
    913 +845     -    818 +| File | Changes |
    914 +846     -    819 +|------|---------|
    915 +847     -    820 +| `script.js` | Add AnchorNavigation module, generateSlug, heading renderer |
    916 +848     -    821 +| `style.css` | Add scroll-padding, focus-visible styles |
    917 +849     -    822 +| `variables.css` | Add --scroll-offset variable |
    918 +850     -    823 +
    919 +851     -    824 +### 10.2 Rollback Command
    920 +852     -    825 +
    921 +853     -    826 +```bash
    922 +854     -    827 +git checkout HEAD~1 -- script.js style.css variables.css
    923 +855     -    828 +```
    924 +856     -    829 +
    925 +857     -    830 +### 10.3 Rollback Criteria
    926 +858     -    831 +
    927 +859     -    832 +- Any markdown rendering regression
    928 +860     -    833 +- JavaScript console errors
    929 +861     -    834 +- Theme switching broken
    930 +862     -    835 +- Memory leak detected (extension stacking)
    931 +863     -    836 +
    932 +864     -    837 +### 10.4 Verification Steps
    933 +865     -    838 +
    934 +866     -    839 +1. Reload application
    935 +867     -    840 +2. Verify no console errors
    936 +868     -    841 +3. Type in editor, verify preview updates
    937 +869     -    842 +4. Switch themes, verify no errors
    938 +870     -    843 +5. Check `marked.defaults` has stable extension count
    939 +871     -    844 +
    940 +872     -    845 +---
    941 +873     -    846 +
    942 +874     -    847 +## 11. FAQ
    943 +875     -    848 +
    944 +876     -    849 +**Q1: Will this break existing functionality?**
    945 +877     -    850 +> No. This is an additive feature. Existing markdown rendering is unchanged.
    946 +878     -    851 +
    947 +879     -    852 +**Q2: What if a heading contains only emoji?**
    948 +880     -    853 +> The slug becomes `section` (fallback for empty result).
    949 +881     -    854 +
    950 +882     -    855 +**Q3: Will this affect HTML export?**
    951 +883     -    856 +> Exported HTML will include the generated IDs. Navigation will work if opened in a browser.
    952 +884     -    857 +
    953 +885     -    858 +**Q4: What about very long headings?**
    954 +886     -    859 +> No length limit. The full heading becomes the slug (performance tested up to 1000 chars).
    955 +887     -    860 +
    956 +888     -    861 +**Q5: Can users manually specify IDs?**
    957 +889     -    862 +> Not currently. This would require parsing `{#custom-id}` syntax, which is a future enhancement.
    958 +890     -    863 +
    959 +891     -    864 +**Q6: What if `marked.use()` is accidentally called in `renderMarkdown()`?**
    960 +892     -    865 +> This would cause extension stacking (memory leak). The design explicitly prevents this by registering ONCE in `configureMarkedExtensions()` and only calling `resetSlugMap()` per render.
    961 +893     -    866 +
    962 +894     -    867 +**Q7: Why use `CSS.escape()` instead of simple string matching?**
    963 +895     -    868 +> IDs can contain special CSS selector characters (`.`, `#`, `:`). `CSS.escape()` ensures the querySelector doesn't break.
    964 +896     -    869 +
    965 +897     -    870 +**Q8: What's the maximum scroll duration?**
    966 +898     -    871 +> Capped at 1000ms for the `scrollend` fallback timeout. Smooth scroll itself is browser-controlled.
    967 +899     -    872 +
    968 +900     -    873 +---
    969 +901     -    874 +
    970 +902     -    875 +## 12. Approval
    971 +903     -    876 +
    972 +904     -    877 +| Role | Name | Date | Status |
    973 +905     -    878 +|------|------|------|--------|
    974 +906     -    879 +| Author | Principal SDE | 2025-12-19 | ‚úÖ Complete |
    975 +907     -    880 +| Reviewer | Gemini | 2025-12-19 | ‚úÖ Approved |
    976 +908     -    881 +| Implementation | Pending | - | ‚è≥ Ready |
    977 +909     -    882 +
    978 +910     -    883 +---
    979 +911     -    884 +
    980 +912     -    885 +## 13. Change Log
    981 +913     -    886 +
    982 +914     -    887 +| Version | Date | Author | Changes |
    983 +915     -    888 +|---------|------|--------|---------|
    984 +916     -    889 +| 1.0 | 2025-12-19 | Principal SDE | Initial draft |
    985 +917     -    890 +| 2.0 | 2025-12-19 | Principal SDE | Added requirements, edge cases |
    986 +918     -    891 +| 3.0 | 2025-12-19 | Gemini | Strict compliance version |
    987 +919     -    892 +| 4.0 | 2025-12-19 | Principal SDE | Production-ready with full implementation |
    988 +920     -    893 +| 4.1 | 2025-12-19 | Principal SDE | Fixed double offset, pre-compiled regex |
    989 +921     -    894 +| 4.2 | 2025-12-19 | Principal SDE | Scoped selection, focus-visible |
    990 +922     -    895 +| 4.3 | 2025-12-19 | Gemini | Identified singleton bug |
    991 +923     -    896 +| 5.0 | 2025-12-19 | Principal SDE | **FINAL** - Module-level map, reset pattern, singleton-safe |
    992 +924     -    897 +
    993 +925     -    898 +---
    994 +926     -    899 +
    995 +927     -    900 +**End of Document**
    996 +928     -    901  
    997 +     67 +683 710  **Built with ‚ù§Ô∏è using modern JavaScript, comprehensive testing, and scalable architecture.**
    998 +     68 +684 711  
    999 +     69 +685 712  **Status**: Production-ready ‚úÖ | Tests: 155+/155+ passing ‚úÖ | Technical Debt: Zero ‚úÖ
    1000 +     70 +686 713  
    1001 +929  71  
    1002 +930  72  ```
    1003 +931  73  
    1004 +932  74  
    1005 +933     -### ‚ú® `docs/competitive_programming_constraints.md` **[ADDED]**
    1006 +     75 +### ‚ú® `docs/01-requirements/donation-feature-plan.md` **[ADDED]**
    1007 +934  76  
    1008 +935  77  **Status:** ‚úÖ **NEW FILE** - This file has been newly created
    1009 +936  78  
    1010 +937  79  **Type:** Documentation üìñ
    1011 +938  80  
    1012 +939  81  ```diff
    1013 +940     -@@ -0,0 +1,621 @@
    1014 +941     -      1 +# üéØ Coding Interview & Competitive Programming Constraints Guide
    1015 +     82 +@@ -0,0 +1,1063 @@
    1016 +     83 +      1 +# üéÅ Donation Feature - Functional Requirements Document
    1017 +942  84        2 +
    1018 +943     -      3 +### üìù 2025-12-19
    1019 +944     -      4 +**Category**: `interview prep` | **Level**: `Essential` | **Time**: `15 min read`
    1020 +945     -      5 +
    1021 +946     -      6 +> **Master the numbers** that every competitive programmer and interviewee should know by heart!
    1022 +     85 +      3 +## Document Information
    1023 +     86 +      4 +
    1024 +     87 +      5 +| Field | Value |
    1025 +     88 +      6 +|-------|-------|
    1026 +     89 +      7 +| **Author** | Principal SDE Analysis |
    1027 +     90 +      8 +| **Created** | December 19, 2025 |
    1028 +     91 +      9 +| **Status** | **üü¢ APPROVED v2.2 - ZERO DEFECTS** |
    1029 +     92 +     10 +| **Version** | 2.2 |
    1030 +     93 +     11 +| **Reviewed By** | Principal SDE (Cline), Principal SDE (Gemini), Sr. Principal SDE (Feasibility), Enterprise Architecture Board (Final) |
    1031 +     94 +     12 +| **Final Verdict** | üöÄ Ready for Phase 0 (Account Setup) |
    1032 +     95 +     13 +| **Technical Feasibility** | 10/10 |
    1033 +     96 +     14 +| **Compliance Rating** | 10/10 |
    1034 +     97 +     15 +
    1035 +     98 +     16 +---
    1036 +     99 +     17 +
    1037 +    100 +     18 +# PART 1: REQUIREMENTS & STRATEGY
    1038 +    101 +     19 +
    1039 +    102 +     20 +## 1. Problem Statement
    1040 +    103 +     21 +
    1041 +    104 +     22 +### Background
    1042 +    105 +     23 +
    1043 +    106 +     24 +Markdown Viewer Pro is an open-source project that requires sustainable funding to support continued development, maintenance, and feature additions. Currently, there is no mechanism for users who benefit from the project to financially support its development.
    1044 +    107 +     25 +
    1045 +    108 +     26 +### Objective
    1046 +    109 +     27 +
    1047 +    110 +     28 +Implement a donation/support system that:
    1048 +    111 +     29 +
    1049 +    112 +     30 +1. Allows users worldwide to financially support the project
    1050 +    113 +     31 +2. Provides currency-appropriate amounts based on user location
    1051 +    114 +     32 +3. Complies with all relevant laws and regulations
    1052 +    115 +     33 +4. Has zero setup cost for the project maintainer
    1053 +    116 +     34 +5. Integrates seamlessly into README and web application
    1054 +    117 +     35 +
    1055 +    118 +     36 +### Success Metrics
    1056 +    119 +     37 +
    1057 +    120 +     38 +- Donation button visible in README and application
    1058 +    121 +     39 +- At least 3 successful donations within first month
    1059 +    122 +     40 +- Zero legal/compliance issues
    1060 +    123 +     41 +- Under 5% total transaction fees
    1061 +    124 +     42 +
    1062 +    125 +     43 +---
    1063 +    126 +     44 +
    1064 +    127 +     45 +## 2. Functional Requirements
    1065 +    128 +     46 +
    1066 +    129 +     47 +### FR-1: Currency Detection and Localization
    1067 +    130 +     48 +
    1068 +    131 +     49 +| ID | Requirement | Priority |
    1069 +    132 +     50 +|----|-------------|----------|
    1070 +    133 +     51 +| FR-1.1 | System SHALL detect user's country via IP geolocation | P1 |
    1071 +    134 +     52 +| FR-1.2 | System SHALL map country to appropriate currency | P1 |
    1072 +    135 +     53 +| FR-1.3 | System SHALL fallback to USD for unrecognized locations | P1 |
    1073 +    136 +     54 +| FR-1.4 | System MAY cache geolocation result for session | P3 |
    1074 +    137 +     55 +
    1075 +    138 +     56 +### FR-2: Preset Amount Tiers
    1076 +    139 +     57 +
    1077 +    140 +     58 +| Region | Currency | Preset Amounts | Custom |
    1078 +    141 +     59 +|--------|----------|----------------|--------|
    1079 +    142 +     60 +| India | INR ‚Çπ | 50, 100, 250, 500, 1000 | ‚úÖ |
    1080 +    143 +     61 +| USA | USD $ | 1, 5, 10, 20, 50 | ‚úÖ |
    1081 +    144 +     62 +| UK | GBP ¬£ | 1, 5, 10, 20, 50 | ‚úÖ |
    1082 +    145 +     63 +| Eurozone | EUR ‚Ç¨ | 1, 5, 10, 20, 50 | ‚úÖ |
    1083 +    146 +     64 +| Other | USD $ | 1, 5, 10, 20, 50 | ‚úÖ (Fallback) |
    1084 +    147 +     65 +
    1085 +    148 +     66 +### FR-3: Donation Flow
    1086 +    149 +     67 +
    1087 +    150 +     68 +| ID | Requirement | Priority |
    1088 +    151 +     69 +|----|-------------|----------|
    1089 +    152 +     70 +| FR-3.1 | User SHALL see "Support This Project" button | P1 |
    1090 +    153 +     71 +| FR-3.2 | User SHALL see currency-appropriate amount options | P1 |
    1091 +    154 +     72 +| FR-3.3 | System SHALL redirect to payment gateway | P1 |
    1092 +    155 +     73 +| FR-3.4 | System SHALL handle success/failure callbacks | P2 |
    1093 +    156 +     74 +| FR-3.5 | User SHALL receive confirmation message | P2 |
    1094 +    157 +     75 +
    1095 +    158 +     76 +### FR-4: Integration Points
    1096 +    159 +     77 +
    1097 +    160 +     78 +| Location | Type | Priority |
    1098 +    161 +     79 +|----------|------|----------|
    1099 +    162 +     80 +| Web App Footer | "Support" button | **P0 (PRIMARY)** |
    1100 +    163 +     81 +| GitHub Repository | Sponsor button | P1 |
    1101 +    164 +     82 +| README.md | Badge/button with link | P2 (SECONDARY) |
    1102 +    165 +     83 +| RELEASE.md | Acknowledgment section | P3 |
    1103 +    166 +     84 +
    1104 +    167 +     85 +> **Priority Update (Per Sr. Principal SDE Review):** Web App integration is PRIMARY, README is SECONDARY
    1105 +    168 +     86 +
    1106 +    169 +     87 +### FR-5: Multi-Platform Support
    1107 +    170 +     88 +
    1108 +    171 +     89 +| ID | Requirement | Priority |
    1109 +    172 +     90 +|----|-------------|----------|
    1110 +    173 +     91 +| FR-5.1 | GitHub Sponsors SHALL be primary for developers | P1 |
    1111 +    174 +     92 +| FR-5.2 | Ko-fi SHALL be available for non-GitHub users | P1 |
    1112 +    175 +     93 +| FR-5.3 | Razorpay SHALL be available for Indian users | P1 |
    1113 +    176 +     94 +| FR-5.4 | All platforms SHALL link to same project | P1 |
    1114 +    177 +     95 +
    1115 +    178 +     96 +---
    1116 +    179 +     97 +
    1117 +    180 +     98 +## 3. Non-Functional Requirements
    1118 +    181 +     99 +
    1119 +    182 +    100 +### NFR-1: Cost
    1120 +    183 +    101 +
    1121 +    184 +    102 +| ID | Requirement |
    1122 +    185 +    103 +|----|-------------|
    1123 +    186 +    104 +| NFR-1.1 | Platform setup cost SHALL be zero |
    1124 +    187 +    105 +| NFR-1.2 | Transaction fees SHALL be under 5% |
    1125 +    188 +    106 +| NFR-1.3 | No monthly subscription required |
    1126 +    189 +    107 +
    1127 +    190 +    108 +### NFR-2: Legal Compliance
    1128 +    191 +    109 +
    1129 +    192 +    110 +| ID | Requirement |
    1130 +    193 +    111 +|----|-------------|
    1131 +    194 +    112 +| NFR-2.1 | Comply with India's FEMA regulations |
    1132 +    195 +    113 +| NFR-2.2 | Comply with RBI guidelines for foreign remittances |
    1133 +    196 +    114 +| NFR-2.3 | No FCRA registration required (individual, not NGO) |
    1134 +    197 +    115 +| NFR-2.4 | Income reported under "Income from Other Sources" |
    1135 +    198 +    116 +
    1136 +    199 +    117 +### NFR-3: Privacy
    1137 +    200 +    118 +
    1138 +    201 +    119 +| ID | Requirement |
    1139 +    202 +    120 +|----|-------------|
    1140 +    203 +    121 +| NFR-3.1 | No PII stored by application |
    1141 +    204 +    122 +| NFR-3.2 | GDPR compliant (EU users) |
    1142 +    205 +    123 +| NFR-3.3 | IP geolocation for currency only, not tracking |
    1143 +    206 +    124 +
    1144 +    207 +    125 +### NFR-4: Availability
    1145 +    208 +    126 +
    1146 +    209 +    127 +| ID | Requirement |
    1147 +    210 +    128 +|----|-------------|
    1148 +    211 +    129 +| NFR-4.1 | Rely on provider SLA (99.9%+) |
    1149 +    212 +    130 +| NFR-4.2 | Graceful degradation if service unavailable |
    1150 +    213 +    131 +| NFR-4.3 | Static badges work even if API down |
    1151 +    214 +    132 +
    1152 +    215 +    133 +### NFR-5: Performance
    1153 +    216 +    134 +
    1154 +    217 +    135 +| ID | Requirement |
    1155 +    218 +    136 +|----|-------------|
    1156 +    219 +    137 +| NFR-5.1 | Button loads in under 100ms |
    1157 +    220 +    138 +| NFR-5.2 | No impact on application load time |
    1158 +    221 +    139 +| NFR-5.3 | Lazy load donation widgets |
    1159 +    222 +    140 +
    1160 +    223 +    141 +### NFR-6: Tax Documentation
    1161 +    224 +    142 +
    1162 +    225 +    143 +| ID | Requirement |
    1163 +    226 +    144 +|----|-------------|
    1164 +    227 +    145 +| NFR-6.1 | Download transaction history from each platform |
    1165 +    228 +    146 +| NFR-6.2 | Maintain records for ITR filing |
    1166 +    229 +    147 +| NFR-6.3 | GST registration if turnover exceeds ‚Çπ20L/year |
    1167 +    230 +    148 +
    1168 +    231 +    149 +---
    1169 +    232 +    150 +
    1170 +    233 +    151 +## 4. Platform Analysis
    1171 +    234 +    152 +
    1172 +    235 +    153 +### Option A: Buy Me a Coffee (buymeacoffee.com)
    1173 +    236 +    154 +
    1174 +    237 +    155 +| Aspect | Details |
    1175 +    238 +    156 +|--------|---------|
    1176 +    239 +    157 +| **Setup Cost** | FREE |
    1177 +    240 +    158 +| **Transaction Fee** | 5% (0% on paid plans) |
    1178 +    241 +    159 +| **Currencies** | 135+ currencies, auto-conversion |
    1179 +    242 +    160 +| **India Payout** | ‚ùå USD only via PayPal |
    1180 +    243 +    161 +| **Payout Methods** | PayPal, Stripe, Bank Transfer |
    1181 +    244 +    162 +
    1182 +    245 +    163 +**Pros:** Well-known brand, Simple setup, Embeddable widgets
    1183 +    246 +    164 +
    1184 +    247 +    165 +**Cons:** 5% platform fee, Cannot receive in INR, PayPal fees add to cost
    1185 +    248 +    166 +
    1186 +    249 +    167 +### Option B: Ko-fi (ko-fi.com)
    1187 +    250 +    168 +
    1188 +    251 +    169 +| Aspect | Details |
    1189 +    252 +    170 +|--------|---------|
    1190 +    253 +    171 +| **Setup Cost** | FREE |
    1191 +    254 +    172 +| **Transaction Fee** | 0% platform fee |
    1192 +    255 +    173 +| **Currencies** | Multi-currency via PayPal/Stripe |
    1193 +    256 +    174 +| **India Payout** | ‚ö†Ô∏è Via PayPal only |
    1194 +    257 +    175 +| **Payout Methods** | PayPal, Stripe |
    1195 +    258 +    176 +
    1196 +    259 +    177 +**Pros:** Zero platform fee, Simple interface, Good for one-time donations
    1197 +    260 +    178 +
    1198 +    261 +    179 +**Cons:** Less popular than BMAC, PayPal fees (2.9%+) still apply, No direct INR support
    1199 +    262 +    180 +
    1200 +    263 +    181 +### Option C: GitHub Sponsors
    1201 +    264 +    182 +
    1202 +    265 +    183 +| Aspect | Details |
    1203 +    266 +    184 +|--------|---------|
    1204 +    267 +    185 +| **Setup Cost** | FREE |
    1205 +    268 +    186 +| **Transaction Fee** | 0% (GitHub covers all fees) |
    1206 +    269 +    187 +| **Currencies** | USD only |
    1207 +    270 +    188 +| **India Payout** | ‚úÖ Direct to Indian bank via Stripe |
    1208 +    271 +    189 +| **Payout Methods** | Stripe ‚Üí Bank Account |
    1209 +    272 +    190 +
    1210 +    273 +    191 +**Pros:** Zero fees, Most trusted by developers, Official badge, Direct bank payout in India
    1211 +    274 +    192 +
    1212 +    275 +    193 +**Cons:** Requires approval process, USD only, Monthly recurring focus
    1213 +    276 +    194 +
    1214 +    277 +    195 +### Option D: Razorpay Payment Button
    1215 +    278 +    196 +
    1216 +    279 +    197 +| Aspect | Details |
    1217 +    280 +    198 +|--------|---------|
    1218 +    281 +    199 +| **Setup Cost** | FREE |
    1219 +    282 +    200 +| **Transaction Fee** | 2% per transaction |
    1220 +    283 +    201 +| **Currencies** | INR (international cards accepted) |
    1221 +    284 +    202 +| **India Payout** | ‚úÖ Native INR support |
    1222 +    285 +    203 +| **Payout Methods** | Direct to Indian bank |
    1223 +    286 +    204 +
    1224 +    287 +    205 +**Pros:** Best for Indian donors, UPI/Paytm/Cards, Native INR amounts, Lowest fees
    1225 +    288 +    206 +
    1226 +    289 +    207 +**Cons:** KYC required (PAN, Aadhaar), GST registration for high volume
    1227 +    290 +    208 +
    1228 +    291 +    209 +### Option E: Stripe Payment Links
    1229 +    292 +    210 +
    1230 +    293 +    211 +| Aspect | Details |
    1231 +    294 +    212 +|--------|---------|
    1232 +    295 +    213 +| **Setup Cost** | FREE |
    1233 +    296 +    214 +| **Transaction Fee** | 2.9% + $0.30 |
    1234 +    297 +    215 +| **Currencies** | 135+ currencies |
    1235 +    298 +    216 +| **India Payout** | ‚úÖ With Indian Stripe account |
    1236 +    299 +    217 +
    1237 +    300 +    218 +**Pros:** Professional, Multi-currency, Good API
    1238 +    301 +    219 +
    1239 +    302 +    220 +**Cons:** Higher fees, More complex setup
    1240 +    303 +    221 +
    1241 +    304 +    222 +---
    1242 +    305 +    223 +
    1243 +    306 +    224 +## 5. Comparison Matrix
    1244 +    307 +    225 +
    1245 +    308 +    226 +| Feature | Buy Me Coffee | Ko-fi | GitHub Sponsors | Razorpay | Stripe |
    1246 +    309 +    227 +|---------|---------------|-------|-----------------|----------|--------|
    1247 +    310 +    228 +| Setup Cost | Free | Free | Free | Free | Free |
    1248 +    311 +    229 +| Platform Fee | 5% | 0% | 0% | 2% | 2.9%+ |
    1249 +    312 +    230 +| INR Payout | ‚ùå | ‚ùå | ‚úÖ | ‚úÖ | ‚úÖ |
    1250 +    313 +    231 +| UPI Support | ‚ùå | ‚ùå | ‚ùå | ‚úÖ | ‚ùå |
    1251 +    314 +    232 +| README Badge | ‚úÖ | ‚úÖ | ‚úÖ | ‚ùå | ‚ùå |
    1252 +    315 +    233 +| Developer Trust | Medium | Low | **High** | Medium | High |
    1253 +    316 +    234 +
    1254 +    317 +    235 +---
    1255 +    318 +    236 +
    1256 +    319 +    237 +## 6. Legal Considerations
    1257 +    320 +    238 +
    1258 +    321 +    239 +### 6.1 India - FEMA & RBI Guidelines
    1259 +    322 +    240 +
    1260 +    323 +    241 +| Aspect | Requirement |
    1261 +    324 +    242 +|--------|-------------|
    1262 +    325 +    243 +| **Foreign Donations** | Allowed for individuals up to $250,000/year |
    1263 +    326 +    244 +| **GST Registration** | Required if turnover exceeds ‚Çπ20 Lakhs/year |
    1264 +    327 +    245 +| **FCRA Registration** | NOT required (individual, not NGO) |
    1265 +    328 +    246 +| **Income Tax** | Report under "Income from Other Sources" |
    1266 +    329 +    247 +
    1267 +    330 +    248 +### 6.2 The "Two-Pocket" Strategy
    1268 +    331 +    249 +
    1269 +    332 +    250 +> **Critical Concept** (from `donation_system_design.md`):
    1270 +    333 +    251 +>
    1271 +    334 +    252 +> **Pocket A (India):** Use Razorpay for domestic INR payments
    1272 +    335 +    253 +> - Treated as Domestic Income
    1273 +    336 +    254 +>
    1274 +    337 +    255 +> **Pocket B (International):** Use PayPal/Ko-fi/GitHub Sponsors
    1275 +    338 +    256 +> - Treated as Foreign Inward Remittance (FIRC provided)
    1276 +    339 +    257 +
    1277 +    340 +    258 +### 6.3 Terminology Recommendation
    1278 +    341 +    259 +
    1279 +    342 +    260 +> **Important**: Use "Support" or "Sponsorship" exclusively. Stop using "Donation" anywhere visible unless 80G registered Non-Profit. This is a legal safeguard against "Misleading Claims" (Consumer Protection Act).
    1280 +    343 +    261 +
    1281 +    344 +    262 +---
    1282 +    345 +    263 +
    1283 +    346 +    264 +## 7. Recommended Solution
    1284 +    347 +    265 +
    1285 +    348 +    266 +### Static Badge Approach (APPROVED ‚úÖ)
    1286 +    349 +    267 +
    1287 +    350 +    268 +```
    1288 +    351 +    269 +‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
    1289 +    352 +    270 +‚îÇ                    DONATION ARCHITECTURE                     ‚îÇ
    1290 +    353 +    271 +‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§
    1291 +    354 +    272 +‚îÇ                                                              ‚îÇ
    1292 +    355 +    273 +‚îÇ  README.md (Static Badges - NO JavaScript)                   ‚îÇ
    1293 +    356 +    274 +‚îÇ  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê    ‚îÇ
    1294 +    357 +    275 +‚îÇ  ‚îÇ  [GitHub Sponsors]  [Ko-fi]  [Razorpay]             ‚îÇ    ‚îÇ
    1295 +    358 +    276 +‚îÇ  ‚îÇ       (Primary)    (Global)  (India INR)            ‚îÇ    ‚îÇ
    1296 +    359 +    277 +‚îÇ  ‚îÇ        0% fee      0% fee      2% fee               ‚îÇ    ‚îÇ
    1297 +    360 +    278 +‚îÇ  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò    ‚îÇ
    1298 +    361 +    279 +‚îÇ                                                              ‚îÇ
    1299 +    362 +    280 +‚îÇ  Web App Footer (Optional: IP-based smart routing)           ‚îÇ
    1300 +    363 +    281 +‚îÇ  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê    ‚îÇ
    1301 +    364 +    282 +‚îÇ  ‚îÇ  India IP ‚Üí Show "üáÆüá≥ Support via UPI"              ‚îÇ    ‚îÇ
    1302 +    365 +    283 +‚îÇ  ‚îÇ  Other IP ‚Üí Show "üåè Support via PayPal"            ‚îÇ    ‚îÇ
    1303 +    366 +    284 +‚îÇ  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò    ‚îÇ
    1304 +    367 +    285 +‚îÇ                                                              ‚îÇ
    1305 +    368 +    286 +‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
    1306 +    369 +    287 +```
    1307 +    370 +    288 +
    1308 +    371 +    289 +---
    1309 +    372 +    290 +
    1310 +    373 +    291 +## 8. Implementation Plan
    1311 +    374 +    292 +
    1312 +    375 +    293 +### Phase 1: Account Setup (Day 1)
    1313 +    376 +    294 +
    1314 +    377 +    295 +| Task | Platform | Requirements |
    1315 +    378 +    296 +|------|----------|--------------|
    1316 +    379 +    297 +| 1.1 | Apply for GitHub Sponsors | 2FA enabled, profile complete |
    1317 +    380 +    298 +| 1.2 | Create Ko-fi account | Email, PayPal/Stripe |
    1318 +    381 +    299 +| 1.3 | Create Razorpay account | PAN, Aadhaar, Bank details |
    1319 +    382 +    300 +
    1320 +    383 +    301 +### Phase 2: README Integration (Day 2)
    1321 +    384 +    302 +
    1322 +    385 +    303 +| Task | Action |
    1323 +    386 +    304 +|------|--------|
    1324 +    387 +    305 +| 2.1 | Add GitHub Sponsors badge |
    1325 +    388 +    306 +| 2.2 | Add Ko-fi button |
    1326 +    389 +    307 +| 2.3 | Add Razorpay link (for INR) |
    1327 +    390 +    308 +| 2.4 | Enable GitHub repo Sponsors button |
    1328 +    391 +    309 +
    1329 +    392 +    310 +### Phase 3: Web App Integration (Day 3 - Optional)
    1330 +    393 +    311 +
    1331 +    394 +    312 +| Task | Action |
    1332 +    395 +    313 +|------|--------|
    1333 +    396 +    314 +| 3.1 | Add "Support" button in footer |
    1334 +    397 +    315 +| 3.2 | (Optional) IP-based smart routing |
    1335 +    398 +    316 +| 3.3 | Thank you message after redirect |
    1336 +    399 +    317 +
    1337 +    400 +    318 +---
    1338 +    401 +    319 +
    1339 +    402 +    320 +## 9. README Integration
    1340 +    403 +    321 +
    1341 +    404 +    322 +### Proposed Badge Section
    1342 +    405 +    323 +
    1343 +    406 +    324 +```markdown
    1344 +    407 +    325 +## üíñ Support This Project
    1345 +    408 +    326 +
    1346 +    409 +    327 +If you find Markdown Viewer Pro useful, consider supporting its development:
    1347 +    410 +    328 +
    1348 +    411 +    329 +[![GitHub Sponsors](https://img.shields.io/badge/Sponsor-%E2%9D%A4-pink?logo=github)](https://github.com/sponsors/PrakharMNNIT)
    1349 +    412 +    330 +[![Ko-fi](https://img.shields.io/badge/Ko--fi-Support-blue?logo=ko-fi)](https://ko-fi.com/markdownviewerpro)
    1350 +    413 +    331 +[![Razorpay](https://img.shields.io/badge/Razorpay-‚Çπ_Support-brightgreen?logo=razorpay)](https://razorpay.me/@markdownviewer)
    1351 +    414 +    332 +
    1352 +    415 +    333 +### Support Tiers
    1353 +    416 +    334 +
    1354 +    417 +    335 +| Tier | Amount (USD) | Amount (INR) | Perks |
    1355 +    418 +    336 +|------|--------------|--------------|-------|
    1356 +    419 +    337 +| ‚òï Coffee | $1 | ‚Çπ50 | My gratitude |
    1357 +    420 +    338 +| üçï Pizza | $5 | ‚Çπ250 | Name in SUPPORTERS.md |
    1358 +    421 +    339 +| üéâ Patron | $20 | ‚Çπ1000 | Name in README |
    1359 +    422 +    340 +| üíé Champion | $50+ | ‚Çπ2500+ | Logo in README |
    1360 +    423 +    341 +```
    1361 +    424 +    342 +
    1362 +    425 +    343 +---
    1363 +    426 +    344 +
    1364 +    427 +    345 +## 10. Risk Assessment
    1365 +    428 +    346 +
    1366 +    429 +    347 +| Risk | Probability | Impact | Mitigation |
    1367 +    430 +    348 +|------|-------------|--------|------------|
    1368 +    431 +    349 +| Low adoption | Medium | Low | Multiple payment options |
    1369 +    432 +    350 +| Platform downtime | Low | Low | Multiple platforms as backup |
    1370 +    433 +    351 +| Legal issues | Low | High | Proper tax reporting, "support" terminology |
    1371 +    434 +    352 +| Currency conversion loss | Medium | Low | Accept INR directly via Razorpay |
    1372 +    435 +    353 +| GitHub Sponsors rejection | Medium | Medium | Use Ko-fi as fallback primary |
    1373 +    436 +    354 +
    1374 +    437 +    355 +---
    1375 +    438 +    356 +
    1376 +    439 +    357 +## 11. Success Criteria
    1377 +    440 +    358 +
    1378 +    441 +    359 +| Metric | Target | Measurement |
    1379 +    442 +    360 +|--------|--------|-------------|
    1380 +    443 +    361 +| Setup complete | 100% | All 3 platforms active |
    1381 +    444 +    362 +| First donation | Within 30 days | Platform dashboard |
    1382 +    445 +    363 +| Monthly supporters | 5+ | Platform dashboard |
    1383 +    446 +    364 +| Total fees | < 5% | Transaction records |
    1384 +    447 +    365 +| Legal compliance | 100% | No violations |
    1385 +    448 +    366 +
    1386 +    449 +    367 +---
    1387 +    450 +    368 +
    1388 +    451 +    369 +# PART 2: INDEPENDENT REVIEWS
    1389 +    452 +    370 +
    1390 +    453 +    371 +---
    1391 +    454 +    372 +
    1392 +    455 +    373 +## Review A: Principal SDE (Cline AI)
    1393 +    456 +    374 +
    1394 +    457 +    375 +### Side-by-Side Comparison
    1395 +    458 +    376 +
    1396 +    459 +    377 +| Aspect | `donation_system_design.md` | `donation-feature-plan.md` |
    1397 +    460 +    378 +|--------|----------------------------|---------------------------|
    1398 +    461 +    379 +| **Document ID** | DD-2025-003-DONATION | None |
    1399 +    462 +    380 +| **Scope** | Geo-Adaptive Routing Focus | Comprehensive Full-Stack |
    1400 +    463 +    381 +| **Length** | ~150 lines (focused) | ~400 lines (exhaustive) |
    1401 +    464 +    382 +| **Code Sample** | Yes (JS snippet) ‚úÖ | No ‚ùå |
    1402 +    465 +    383 +
    1403 +    466 +    384 +### Feature Coverage Matrix
    1404 +    467 +    385 +
    1405 +    468 +    386 +| Feature | Design Doc | Feature Plan |
    1406 +    469 +    387 +|---------|------------|--------------|
    1407 +    470 +    388 +| Problem Statement | ‚úÖ Clear | ‚úÖ Detailed |
    1408 +    471 +    389 +| Functional Requirements | ‚úÖ 5 FRs | ‚úÖ 18+ FRs |
    1409 +    472 +    390 +| Non-Functional Requirements | ‚úÖ 4 NFRs | ‚úÖ 16 NFRs |
    1410 +    473 +    391 +| Platform Analysis | ‚ö†Ô∏è 2 options | ‚úÖ 5 options |
    1411 +    474 +    392 +| Comparison Matrix | ‚ùå None | ‚úÖ Full matrix |
    1412 +    475 +    393 +| Legal Compliance | ‚ö†Ô∏è Brief | ‚úÖ Comprehensive |
    1413 +    476 +    394 +| Risk Assessment | ‚ùå None | ‚úÖ Full risk table |
    1414 +    477 +    395 +
    1415 +    478 +    396 +### Recommendation
    1416 +    479 +    397 +
    1417 +    480 +    398 +**Use `donation-feature-plan.md` as canonical reference**, but adopt "Two-Pocket Strategy" concept from `donation_system_design.md`.
    1418 +    481 +    399 +
    1419 +    482 +    400 +---
    1420 +    483 +    401 +
    1421 +    484 +    402 +## Review B: Principal SDE (Gemini)
    1422 +    485 +    403 +
    1423 +    486 +    404 +### Executive Summary
    1424 +    487 +    405 +
    1425 +    488 +    406 +| Proposal | Focus | Verdict |
    1426 +    489 +    407 +|----------|-------|---------|
    1427 +    490 +    408 +| **A (Smart Router)** | Automated IP-based routing | ‚ùå REJECTED for README |
    1428 +    491 +    409 +| **B (Feature Plan)** | Transparent static badges | ‚úÖ APPROVED |
    1429 +    492 +    410 +
    1430 +    493 +    411 +### Detailed Comparative Analysis
    1431 +    494 +    412 +
    1432 +    495 +    413 +#### 1. User Trust & Conversion
    1433 +    496 +    414 +
    1434 +    497 +    415 +| Proposal | Analysis | Winner |
    1435 +    498 +    416 +|----------|----------|--------|
    1436 +    499 +    417 +| **A (Router)** | Risks "Link Anxiety" - custom domain redirect feels phishy | ‚ùå |
    1437 +    500 +    418 +| **B (Manual)** | High Trust - users see exactly where they're going | üèÜ |
    1438 +    501 +    419 +
    1439 +    502 +    420 +#### 2. Reliability & Maintenance
    1440 +    503 +    421 +
    1441 +    504 +    422 +| Proposal | Analysis | Winner |
    1442 +    505 +    423 +|----------|----------|--------|
    1443 +    506 +    424 +| **A (Router)** | Requires hosting, Geo API, introduces Point of Failure | ‚ùå |
    1444 +    507 +    425 +| **B (Manual)** | Static Markdown, 100% Uptime, Zero maintenance | üèÜ |
    1445 +    508 +    426 +
    1446 +    509 +    427 +#### 3. Legal & Compliance (Two-Pocket Test)
    1447 +    510 +    428 +
    1448 +    511 +    429 +| Proposal | Analysis | Winner |
    1449 +    512 +    430 +|----------|----------|--------|
    1450 +    513 +    431 +| **A (Router)** | VPN users might get wrong bucket (NRI with India VPN) | ‚ùå |
    1451 +    514 +    432 +| **B (Manual)** | User self-selects - clearer mental model | üèÜ |
    1452 +    515 +    433 +
    1453 +    516 +    434 +#### 4. Implementation Effort
    1454 +    517 +    435 +
    1455 +    518 +    436 +| Proposal | Effort | Winner |
    1456 +    519 +    437 +|----------|--------|--------|
    1457 +    520 +    438 +| **A (Router)** | ~4-8 hours (hosting, JS, testing) | ‚ùå |
    1458 +    521 +    439 +| **B (Manual)** | ~1 hour (signup + paste links) | üèÜ |
    1459 +    522 +    440 +
    1460 +    523 +    441 +### Critical Feedback on Feature Plan
    1461 +    524 +    442 +
    1462 +    525 +    443 +1. **Banner Design** - Ensure badges are aesthetically aligned (use Shields.io consistently)
    1463 +    526 +    444 +2. **Razorpay Link** - Verify if `razorpay.me/@username` allows custom amounts (Payment Pages may be better)
    1464 +    527 +    445 +3. **GitHub Sponsors Eligibility** - May require approval time. **Fallback:** Ko-fi as primary until approved
    1465 +    528 +    446 +
    1466 +    529 +    447 +### Final Verdict
    1467 +    530 +    448 +
    1468 +    531 +    449 +> **Discard Smart Router architecture for README.**
    1469 +    532 +    450 +> Use Feature Plan as master plan.
    1470 +    533 +    451 +> **Optional:** Use IP routing logic ONLY in Web App footer.
    1471 +    534 +    452 +
    1472 +    535 +    453 +**Approved for Implementation.** üöÄ
    1473 +    536 +    454 +
    1474 +    537 +    455 +---
    1475 +    538 +    456 +
    1476 +    539 +    457 +## Review C: Sr. Principal SDE (Technical Feasibility)
    1477 +    540 +    458 +
    1478 +    541 +    459 +### Executive Summary
    1479 +    542 +    460 +
    1480 +    543 +    461 +| Component | Verdict | Rating |
    1481 +    544 +    462 +|-----------|---------|--------|
    1482 +    545 +    463 +| **Static Badges (README)** | ‚úÖ APPROVED | Low Risk, High Value |
    1483 +    546 +    464 +| **Smart Routing (Web App)** | ‚ö†Ô∏è CONDITIONAL | Medium Risk, Maintenance Burden |
    1484 +    547 +    465 +
    1485 +    548 +    466 +### Critical Technical Concerns
    1486 +    549 +    467 +
    1487 +    550 +    468 +#### 1. The "Free API" Trap (Scalability Risk)
    1488 +    551 +    469 +
    1489 +    552 +    470 +| Concern | Risk | Failure Mode |
    1490 +    553 +    471 +|---------|------|--------------|
    1491 +    554 +    472 +| Using `ipapi.co` Free Tier | Rate limits (1000 req/day) | `429 Too Many Requests` |
    1492 +    555 +    473 +| Viral traffic or bot crawls | API exhaustion | Button renders nothing/broken spinner |
    1493 +    556 +    474 +
    1494 +    557 +    475 +**Required Mitigation: Fail-Open Strategy**
    1495 +    558 +    476 +```javascript
    1496 +    559 +    477 +// DEFAULT: Global (Fail-Safe Pattern)
    1497 +    560 +    478 +let showInd = false;
    1498 +    561 +    479 +try {
    1499 +    562 +    480 +   // Race condition: Timeout after 300ms
    1500 +    563 +    481 +   const data = await Promise.race([fetchIP(), timeout(300)]);
    1501 +    564 +    482 +   if (data.country === 'IN') showInd = true;
    1502 +    565 +    483 +} catch (e) {
    1503 +    566 +    484 +   // Silently fail to Global
    1504 +    567 +    485 +}
    1505 +    568 +    486 +```
    1506 +    569 +    487 +
    1507 +    570 +    488 +#### 2. Razorpay International Friction (UX Bug)
    1508 +    571 +    489 +
    1509 +    572 +    490 +| Scenario | Issue |
    1510 +    573 +    491 +|----------|-------|
    1511 +    574 +    492 +| NRI with India VPN | Sees UPI, has US card, Razorpay declines |
    1512 +    575 +    493 +| Corporate VPN via Bangalore | International card fails on personal Razorpay |
    1513 +    576 +    494 +
    1514 +    577 +    495 +**Impact:** User willing to pay $50 via Amex bounces.
    1515 +    578 +    496 +
    1516 +    579 +    497 +#### 3. The "VPN Paradox" (Edge Case)
    1517 +    580 +    498 +
    1518 +    581 +    499 +| Scenario | Result | Fix Required |
    1519 +    582 +    500 +|----------|--------|--------------|
    1520 +    583 +    501 +| US user with India VPN (Hotstar) | Sees "UPI/‚Çπ" | No UPI, leaves |
    1521 +    584 +    502 +
    1522 +    585 +    503 +**Mandatory UI Element:** "Not in India?" toggle or "Show International Options" link.
    1523 +    586 +    504 +
    1524 +    587 +    505 +### Maintenance & Long-term Viability
    1525 +    588 +    506 +
    1526 +    589 +    507 +#### 1. Link Rot & Platform Decay
    1527 +    590 +    508 +
    1528 +    591 +    509 +**Problem:** Startups change terms or get acquired.
    1529 +    592 +    510 +
    1530 +    593 +    511 +**Solution:** Use redirect service instead of hardcoding:
    1531 +    594 +    512 +```
    1532 +    595 +    513 +yoursite.com/go/donate-inr ‚Üí razorpay.me/...
    1533 +    596 +    514 +yoursite.com/go/donate-usd ‚Üí ko-fi.com/...
    1534 +    597 +    515 +```
    1535 +    598 +    516 +Allows platform switch without PR.
    1536 +    599 +    517 +
    1537 +    600 +    518 +#### 2. GitHub Sponsors Approval Latency
    1538 +    601 +    519 +
    1539 +    602 +    520 +| Reality | Blocker |
    1540 +    603 +    521 +|---------|---------|
    1541 +    604 +    522 +| 2-4 weeks approval time | Badge shows 404 before approval |
    1542 +    605 +    523 +
    1543 +    606 +    524 +**Correction:** Deploy badge ONLY after approval email received.
    1544 +    607 +    525 +
    1545 +    608 +    526 +### Enterprise-Grade Recommendations
    1546 +    609 +    527 +
    1547 +    610 +    528 +1. **Enforce "Fail-Safe" Default** - 300ms timeout, silent fail to Global
    1548 +    611 +    529 +2. **Taxonomy Cleanup** - Use "Sponsorship" or "Support" exclusively (Consumer Protection Act compliance)
    1549 +    612 +    530 +3. **Data Minimization** - Client-side IP lookup only (avoid GDPR/CCPA backend logging)
    1550 +    613 +    531 +
    1551 +    614 +    532 +### Revised Implementation Roadmap
    1552 +    615 +    533 +
    1553 +    616 +    534 +| Step | Action | Notes |
    1554 +    617 +    535 +|------|--------|-------|
    1555 +    618 +    536 +| **1 (Immediate)** | Add Static Badges (Ko-fi & Razorpay) to README | No GitHub Sponsors until approved |
    1556 +    619 +    537 +| **2 (Wait)** | Apply for GitHub Sponsors | 2-4 week wait |
    1557 +    620 +    538 +| **3 (Low Priority)** | Smart Routing in Web App | Only if <300ms latency + fail-safe |
    1558 +    621 +    539 +
    1559 +    622 +    540 +**Signed-off with Conditions.**
    1560 +    623 +    541 +
    1561 +    624 +    542 +---
    1562 +    625 +    543 +
    1563 +    626 +    544 +## Review D: Enterprise Architecture Board (Final Readiness)
    1564 +    627 +    545 +
    1565 +    628 +    546 +### Executive Summary
    1566 +    629 +    547 +
    1567 +    630 +    548 +| Category | Status |
    1568 +    631 +    549 +|----------|--------|
    1569 +    632 +    550 +| **Functional** | ‚úÖ Approved |
    1570 +    633 +    551 +| **Technical** | ‚úÖ Approved |
    1571 +    634 +    552 +| **Legal** | ‚úÖ Approved |
    1572 +    635 +    553 +| **UX** | ‚úÖ Approved (with CLS mitigation) |
    1573 +    636 +    554 +
    1574 +    637 +    555 +**Verdict:** ‚úÖ **GREEN LIGHT** for Engineering
    1575 +    638 +    556 +
    1576 +    639 +    557 +### 3 Final Enterprise Refinements (Non-Blocking)
    1577 +    640 +    558 +
    1578 +    641 +    559 +#### 1. Cumulative Layout Shift (CLS) Risk
    1579 +    642 +    560 +
    1580 +    643 +    561 +| Issue | Risk | Impact |
    1581 +    644 +    562 +|-------|------|--------|
    1582 +    645 +    563 +| 300ms async fetch | Button "pops in" after page load | Hurts SEO (Core Web Vitals) |
    1583 +    646 +    564 +
    1584 +    647 +    565 +**Required Mitigation:**
    1585 +    648 +    566 +```css
    1586 +    649 +    567 +/* Reserve fixed space BEFORE JS runs */
    1587 +    650 +    568 +.support-widget-container {
    1588 +    651 +    569 +  min-height: 60px;
    1589 +    652 +    570 +}
    1590 +    653 +    571 +
    1591 +    654 +    572 +/* Loading State - Grey ghost button */
    1592 +    655 +    573 +.support-button--loading {
    1593 +    656 +    574 +  background: #e0e0e0;
    1594 +    657 +    575 +  color: transparent;
    1595 +    658 +    576 +}
    1596 +    659 +    577 +
    1597 +    660 +    578 +/* Hydrated State - Swap after promise resolves */
    1598 +    661 +    579 +.support-button--india { background: #FF9933; }
    1599 +    662 +    580 +.support-button--global { background: #29ABE0; }
    1600 +    663 +    581 +```
    1601 +    664 +    582 +
    1602 +    665 +    583 +#### 2. Analytics Attribution (Blind Spot Fix)
    1603 +    666 +    584 +
    1604 +    667 +    585 +| Problem | Cannot distinguish traffic source (README vs App vs Search) |
    1605 +    668 +    586 +|---------|-------------------------------------------------------------|
    1606 +    669 +    587 +
    1607 +    670 +    588 +**Required: UTM Parameters on ALL links**
    1608 +    671 +    589 +
    1609 +    672 +    590 +| ‚ùå Bad | ‚úÖ Good |
    1610 +    673 +    591 +|--------|---------|
    1611 +    674 +    592 +| `razorpay.me/@markdownviewer` | `razorpay.me/@markdownviewer?notes[source]=webapp_footer` |
    1612 +    675 +    593 +| `ko-fi.com/markdownviewerpro` | `ko-fi.com/markdownviewerpro?ref=readme_badge` |
    1613 +    676 +    594 +
    1614 +    677 +    595 +#### 3. Security Best Practice (`noopener`)
    1615 +    678 +    596 +
    1616 +    679 +    597 +| Issue | External links open in new tabs (`target="_blank"`) |
    1617 +    680 +    598 +|-------|-----------------------------------------------------|
    1618 +    681 +    599 +| Risk | Reverse Tabnapping (theoretical, but compliance flags it) |
    1619 +    682 +    600 +
    1620 +    683 +    601 +**Required:** All external payment links MUST include:
    1621 +    684 +    602 +```html
    1622 +    685 +    603 +<a href="..." target="_blank" rel="noopener noreferrer">
    1623 +    686 +    604 +```
    1624 +    687 +    605 +
    1625 +    688 +    606 +### Optimized Code Snippet (Session Caching)
    1626 +    689 +    607 +
    1627 +    690 +    608 +```javascript
    1628 +    691 +    609 +// ENTERPRISE-GRADE IMPLEMENTATION PATTERN v2.2
    1629 +    692 +    610 +const TIMEOUT_MS = 300;
    1630 +    693 +    611 +const FALLBACK_REGION = 'global';
    1631 +    694 +    612 +const CACHE_KEY = 'user_region';
    1632 +    695 +    613 +
    1633 +    696 +    614 +async function getDonationConfig() {
    1634 +    697 +    615 +  // 1. Check Session Cache (FR-1.4) - Avoids API hit on page navigation
    1635 +    698 +    616 +  const cached = sessionStorage.getItem(CACHE_KEY);
    1636 +    699 +    617 +  if (cached) return cached;
    1637 +    700 +    618 +
    1638 +    701 +    619 +  try {
    1639 +    702 +    620 +    // 2. Race Network vs Timer
    1640 +    703 +    621 +    const fetchPromise = fetch('https://ipapi.co/json/').then(r => r.json());
    1641 +    704 +    622 +    const timeoutPromise = new Promise((_, reject) =>
    1642 +    705 +    623 +      setTimeout(() => reject(new Error('Timeout')), TIMEOUT_MS)
    1643 +    706 +    624 +    );
    1644 +    707 +    625 +
    1645 +    708 +    626 +    const data = await Promise.race([fetchPromise, timeoutPromise]);
    1646 +    709 +    627 +    const region = data.country_code === 'IN' ? 'india' : 'global';
    1647 +    710 +    628 +
    1648 +    711 +    629 +    // 3. Set Cache
    1649 +    712 +    630 +    sessionStorage.setItem(CACHE_KEY, region);
    1650 +    713 +    631 +    return region;
    1651 +    714 +    632 +  } catch (e) {
    1652 +    715 +    633 +    // 4. Fail Open - Silent fail to Global
    1653 +    716 +    634 +    console.warn('[DonationRouter] Geo-lookup failed/timed-out, defaulting to Global.');
    1654 +    717 +    635 +    return FALLBACK_REGION;
    1655 +    718 +    636 +  }
    1656 +    719 +    637 +}
    1657 +    720 +    638 +
    1658 +    721 +    639 +// 5. Render with Skeleton Loader (CLS Mitigation)
    1659 +    722 +    640 +async function renderSupportButton(container) {
    1660 +    723 +    641 +  // Show skeleton immediately
    1661 +    724 +    642 +  container.innerHTML = '<button class="support-button support-button--loading">‚òï Support</button>';
    1662 +    725 +    643 +
    1663 +    726 +    644 +  const region = await getDonationConfig();
    1664 +    727 +    645 +  const config = region === 'india'
    1665 +    728 +    646 +    ? { text: 'üáÆüá≥ Support via UPI', url: 'razorpay.me/@markdownviewer?notes[source]=webapp_footer', class: 'support-button--india' }
    1666 +    729 +    647 +    : { text: 'üåè Support via PayPal', url: 'ko-fi.com/markdownviewerpro?ref=webapp_footer', class: 'support-button--global' };
    1667 +    730 +    648 +
    1668 +    731 +    649 +  // Hydrate with real button
    1669 +    732 +    650 +  container.innerHTML = `
    1670 +    733 +    651 +    <a href="https://${config.url}" target="_blank" rel="noopener noreferrer" class="support-button ${config.class}">
    1671 +    734 +    652 +      ${config.text}
    1672 +    735 +    653 +    </a>
    1673 +    736 +    654 +    <button class="support-toggle" onclick="toggleRegion()">Not in ${region === 'india' ? 'India' : 'your country'}?</button>
    1674 +    737 +    655 +  `;
    1675 +    738 +    656 +}
    1676 +    739 +    657 +```
    1677 +    740 +    658 +
    1678 +    741 +    659 +### Final Sign-off
    1679 +    742 +    660 +
    1680 +    743 +    661 +| Requirement | Status |
    1681 +    744 +    662 +|-------------|--------|
    1682 +    745 +    663 +| Fail-Safe Pattern | ‚úÖ Implemented |
    1683 +    746 +    664 +| Session Caching | ‚úÖ Added (FR-1.4) |
    1684 +    747 +    665 +| CLS Mitigation | ‚úÖ Skeleton Loader |
    1685 +    748 +    666 +| UTM Analytics | ‚úÖ Attribution params |
    1686 +    749 +    667 +| Security (`noopener`) | ‚úÖ Required |
    1687 +    750 +    668 +| Region Toggle | ‚úÖ Mandatory |
    1688 +    751 +    669 +
    1689 +    752 +    670 +**Enterprise Architecture Board: APPROVED** üöÄ
    1690 +    753 +    671 +
    1691 +    754 +    672 +---
    1692 +    755 +    673 +
    1693 +    756 +    674 +# PART 3: CONSOLIDATED DECISION
    1694 +    757 +    675 +
    1695 +    758 +    676 +## Final Architecture (v2.0)
    1696 +    759 +    677 +
    1697 +    760 +    678 +```
    1698 +    761 +    679 +‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
    1699 +    762 +    680 +‚îÇ              APPROVED DONATION ARCHITECTURE v2.0                 ‚îÇ
    1700 +    763 +    681 +‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§
    1701 +    764 +    682 +‚îÇ                                                                  ‚îÇ
    1702 +    765 +    683 +‚îÇ  README.md (STATIC - No JavaScript)                              ‚îÇ
    1703 +    766 +    684 +‚îÇ  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê  ‚îÇ
    1704 +    767 +    685 +‚îÇ  ‚îÇ  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê   ‚îÇ  ‚îÇ
    1705 +    768 +    686 +‚îÇ  ‚îÇ  ‚îÇ GitHub       ‚îÇ ‚îÇ Ko-fi        ‚îÇ ‚îÇ Razorpay         ‚îÇ   ‚îÇ  ‚îÇ
    1706 +    769 +    687 +‚îÇ  ‚îÇ  ‚îÇ Sponsors     ‚îÇ ‚îÇ (Global)     ‚îÇ ‚îÇ (India INR)      ‚îÇ   ‚îÇ  ‚îÇ
    1707 +    770 +    688 +‚îÇ  ‚îÇ  ‚îÇ (Primary)    ‚îÇ ‚îÇ 0% fee       ‚îÇ ‚îÇ 2% fee           ‚îÇ   ‚îÇ  ‚îÇ
    1708 +    771 +    689 +‚îÇ  ‚îÇ  ‚îÇ 0% fee       ‚îÇ ‚îÇ PayPal       ‚îÇ ‚îÇ UPI/Paytm/Cards  ‚îÇ   ‚îÇ  ‚îÇ
    1709 +    772 +    690 +‚îÇ  ‚îÇ  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò   ‚îÇ  ‚îÇ
    1710 +    773 +    691 +‚îÇ  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò  ‚îÇ
    1711 +    774 +    692 +‚îÇ                                                                  ‚îÇ
    1712 +    775 +    693 +‚îÇ  Web App Footer (OPTIONAL - Smart Routing)                       ‚îÇ
    1713 +    776 +    694 +‚îÇ  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê  ‚îÇ
    1714 +    777 +    695 +‚îÇ  ‚îÇ  if (country === 'IN') show "üáÆüá≥ Support via UPI"         ‚îÇ  ‚îÇ
    1715 +    778 +    696 +‚îÇ  ‚îÇ  else                  show "üåè Support via PayPal"        ‚îÇ  ‚îÇ
    1716 +    779 +    697 +‚îÇ  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò  ‚îÇ
    1717 +    780 +    698 +‚îÇ                                                                  ‚îÇ
    1718 +    781 +    699 +‚îÇ  Financial "Two-Pocket" Strategy:                                ‚îÇ
    1719 +    782 +    700 +‚îÇ  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê    ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê             ‚îÇ
    1720 +    783 +    701 +‚îÇ  ‚îÇ Pocket A: Razorpay  ‚îÇ    ‚îÇ Pocket B: PayPal    ‚îÇ             ‚îÇ
    1721 +    784 +    702 +‚îÇ  ‚îÇ (Domestic INR)      ‚îÇ    ‚îÇ (Foreign USD)       ‚îÇ             ‚îÇ
    1722 +    785 +    703 +‚îÇ  ‚îÇ Domestic Income     ‚îÇ    ‚îÇ FIRC Remittance     ‚îÇ             ‚îÇ
    1723 +    786 +    704 +‚îÇ  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò    ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò             ‚îÇ
    1724 +    787 +    705 +‚îÇ                                                                  ‚îÇ
    1725 +    788 +    706 +‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
    1726 +    789 +    707 +```
    1727 +    790 +    708 +
    1728 +    791 +    709 +## Action Items (REVISED per Sr. Principal SDE)
    1729 +    792 +    710 +
    1730 +    793 +    711 +| Priority | Action | Status | Notes |
    1731 +    794 +    712 +|----------|--------|--------|-------|
    1732 +    795 +    713 +| **P0** | Create Ko-fi account | ‚è≥ Pending | Immediate |
    1733 +    796 +    714 +| **P0** | Create Razorpay account (KYC) | ‚è≥ Pending | PAN/Aadhaar required |
    1734 +    797 +    715 +| **P0** | Add support button to Web App footer | ‚è≥ Pending | **PRIMARY** |
    1735 +    798 +    716 +| **P1** | Apply for GitHub Sponsors | ‚è≥ Pending | 2-4 week wait |
    1736 +    799 +    717 +| **P2** | Add static badges to README.md | ‚è≥ Pending | **SECONDARY** (after GH approval) |
    1737 +    800 +    718 +| **P3** | IP-based smart routing in web app | ‚è≥ Future | Only with fail-safe pattern |
    1738 +    801 +    719 +
    1739 +    802 +    720 +### Technical Requirements for Smart Routing
    1740 +    803 +    721 +
    1741 +    804 +    722 +| Requirement | Specification |
    1742 +    805 +    723 +|-------------|---------------|
    1743 +    806 +    724 +| IP API Timeout | ‚â§300ms |
    1744 +    807 +    725 +| Fail-Safe Default | Global (USD/PayPal) |
    1745 +    808 +    726 +| "Not in India?" Toggle | **MANDATORY** |
    1746 +    809 +    727 +| Client-side Only | No backend IP logging |
    1747 +    810 +    728 +| Redirect Service | `yoursite.com/go/donate-*` pattern |
    1748 +    811 +    729 +
    1749 +    812 +    730 +---
    1750 +    813 +    731 +
    1751 +    814 +    732 +## Document History
    1752 +    815 +    733 +
    1753 +    816 +    734 +| Version | Date | Author | Changes |
    1754 +    817 +    735 +|---------|------|--------|---------|
    1755 +    818 +    736 +| 1.0 | 2025-12-19 | Principal SDE | Initial document |
    1756 +    819 +    737 +| 2.0 | 2025-12-19 | Principal SDE | Added independent reviews, consolidated decision |
    1757 +    820 +    738 +
    1758 +    821 +    739 +---
    1759 +    822 +    740 +
    1760 +    823 +    741 +---
    1761 +    824 +    742 +
    1762 +    825 +    743 +# PART 4: FINAL RECOMMENDATION
    1763 +    826 +    744 +
    1764 +    827 +    745 +## Synthesized Analysis from All Reviewers
    1765 +    828 +    746 +
    1766 +    829 +    747 +| Reviewer | Key Insight | Agreement |
    1767 +    830 +    748 +|----------|-------------|-----------|
    1768 +    831 +    749 +| **Cline AI** | Feature Plan is comprehensive, adopt Two-Pocket Strategy | ‚úÖ |
    1769 +    832 +    750 +| **Gemini** | Static badges trusted, Smart Router risky for README | ‚úÖ |
    1770 +    833 +    751 +| **Sr. Principal** | Web App PRIMARY, fail-safe mandatory, 300ms timeout | ‚úÖ |
    1771 +    834 +    752 +
    1772 +    835 +    753 +## üéØ FINAL RECOMMENDATION
    1773 +    836 +    754 +
    1774 +    837 +    755 +### Approved Architecture
    1775 +    838 +    756 +
    1776 +    839 +    757 +```
    1777 +    840 +    758 +‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
    1778 +    841 +    759 +‚îÇ           FINAL APPROVED ARCHITECTURE v2.1                       ‚îÇ
    1779 +    842 +    760 +‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§
    1780 +    843 +    761 +‚îÇ                                                                  ‚îÇ
    1781 +    844 +    762 +‚îÇ  PHASE 1: WEB APP (PRIMARY) - Immediate                          ‚îÇ
    1782 +    845 +    763 +‚îÇ  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê  ‚îÇ
    1783 +    846 +    764 +‚îÇ  ‚îÇ  Footer Button: "‚òï Support This Project"                  ‚îÇ  ‚îÇ
    1784 +    847 +    765 +‚îÇ  ‚îÇ                                                            ‚îÇ  ‚îÇ
    1785 +    848 +    766 +‚îÇ  ‚îÇ  IP Detection (Fail-Safe):                                 ‚îÇ  ‚îÇ
    1786 +    849 +    767 +‚îÇ  ‚îÇ  ‚îú‚îÄ India ‚Üí "üáÆüá≥ Support via UPI" ‚Üí Razorpay              ‚îÇ  ‚îÇ
    1787 +    850 +    768 +‚îÇ  ‚îÇ  ‚îú‚îÄ Others ‚Üí "üåè Support via PayPal" ‚Üí Ko-fi              ‚îÇ  ‚îÇ
    1788 +    851 +    769 +‚îÇ  ‚îÇ  ‚îî‚îÄ Fallback (API fail/timeout) ‚Üí Ko-fi (Global)          ‚îÇ  ‚îÇ
    1789 +    852 +    770 +‚îÇ  ‚îÇ                                                            ‚îÇ  ‚îÇ
    1790 +    853 +    771 +‚îÇ  ‚îÇ  MANDATORY: "Not in India? Click here" toggle              ‚îÇ  ‚îÇ
    1791 +    854 +    772 +‚îÇ  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò  ‚îÇ
    1792 +    855 +    773 +‚îÇ                                                                  ‚îÇ
    1793 +    856 +    774 +‚îÇ  PHASE 2: README (SECONDARY) - After GH Sponsors Approval        ‚îÇ
    1794 +    857 +    775 +‚îÇ  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê  ‚îÇ
    1795 +    858 +    776 +‚îÇ  ‚îÇ  Static Badges (NO JavaScript):                            ‚îÇ  ‚îÇ
    1796 +    859 +    777 +‚îÇ  ‚îÇ  [Ko-fi] [Razorpay ‚Çπ] [GitHub Sponsors*]                  ‚îÇ  ‚îÇ
    1797 +    860 +    778 +‚îÇ  ‚îÇ  * Add only after approval received                        ‚îÇ  ‚îÇ
    1798 +    861 +    779 +‚îÇ  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò  ‚îÇ
    1799 +    862 +    780 +‚îÇ                                                                  ‚îÇ
    1800 +    863 +    781 +‚îÇ  FINANCIAL STRATEGY: Two-Pocket                                  ‚îÇ
    1801 +    864 +    782 +‚îÇ  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê    ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê             ‚îÇ
    1802 +    865 +    783 +‚îÇ  ‚îÇ üáÆüá≥ Pocket A        ‚îÇ    ‚îÇ üåè Pocket B         ‚îÇ             ‚îÇ
    1803 +    866 +    784 +‚îÇ  ‚îÇ Razorpay (INR)      ‚îÇ    ‚îÇ Ko-fi/PayPal (USD)  ‚îÇ             ‚îÇ
    1804 +    867 +    785 +‚îÇ  ‚îÇ Domestic Income     ‚îÇ    ‚îÇ FIRC Remittance     ‚îÇ             ‚îÇ
    1805 +    868 +    786 +‚îÇ  ‚îÇ UPI/Paytm/Cards     ‚îÇ    ‚îÇ Cards/PayPal        ‚îÇ             ‚îÇ
    1806 +    869 +    787 +‚îÇ  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò    ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò             ‚îÇ
    1807 +    870 +    788 +‚îÇ                                                                  ‚îÇ
    1808 +    871 +    789 +‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
    1809 +    872 +    790 +```
    1810 +    873 +    791 +
    1811 +    874 +    792 +### Platform Selection Decision
    1812 +    875 +    793 +
    1813 +    876 +    794 +| Platform | Role | When to Deploy | Fee |
    1814 +    877 +    795 +|----------|------|----------------|-----|
    1815 +    878 +    796 +| **Ko-fi** | Global Primary | Day 1 | 0% + PayPal 2.9% |
    1816 +    879 +    797 +| **Razorpay** | India Primary | Day 1 (after KYC) | 2% |
    1817 +    880 +    798 +| **GitHub Sponsors** | Developer Primary | After approval (2-4 weeks) | 0% |
    1818 +    881 +    799 +
    1819 +    882 +    800 +### Implementation Order
    1820 +    883 +    801 +
    1821 +    884 +    802 +| Phase | Action | Timeline | Blocker |
    1822 +    885 +    803 +|-------|--------|----------|---------|
    1823 +    886 +    804 +| **0** | Create Ko-fi account | Now | None |
    1824 +    887 +    805 +| **0** | Create Razorpay account | Now | KYC (PAN/Aadhaar) |
    1825 +    888 +    806 +| **1** | Add Web App footer button | Day 1-2 | None |
    1826 +    889 +    807 +| **2** | Apply for GitHub Sponsors | Day 1 | None |
    1827 +    890 +    808 +| **3** | Add README badges (Ko-fi + Razorpay) | Day 3 | None |
    1828 +    891 +    809 +| **4** | Add GitHub Sponsors badge | Week 3-4 | Approval email |
    1829 +    892 +    810 +| **5** | IP-based smart routing | Optional | Fail-safe code ready |
    1830 +    893 +    811 +
    1831 +    894 +    812 +### Technical Specifications (MANDATORY)
    1832 +    895 +    813 +
    1833 +    896 +    814 +```javascript
    1834 +    897 +    815 +// REQUIRED: Fail-Safe Smart Routing Pattern
    1835 +    898 +    816 +const TIMEOUT_MS = 300;
    1836 +    899 +    817 +const DEFAULT_REGION = 'global'; // Ko-fi
    1837 +    900 +    818 +
    1838 +    901 +    819 +async function detectRegion() {
    1839 +    902 +    820 +  try {
    1840 +    903 +    821 +    const controller = new AbortController();
    1841 +    904 +    822 +    const timeoutId = setTimeout(() => controller.abort(), TIMEOUT_MS);
    1842 +    905 +    823 +
    1843 +    906 +    824 +    const response = await fetch('https://ipapi.co/json/', {
    1844 +    907 +    825 +      signal: controller.signal
    1845 +    908 +    826 +    });
    1846 +    909 +    827 +    clearTimeout(timeoutId);
    1847 +    910 +    828 +
    1848 +    911 +    829 +    const data = await response.json();
    1849 +    912 +    830 +    return data.country_code === 'IN' ? 'india' : 'global';
    1850 +    913 +    831 +  } catch (error) {
    1851 +    914 +    832 +    // Silent fail to global
    1852 +    915 +    833 +    return DEFAULT_REGION;
    1853 +    916 +    834 +  }
    1854 +    917 +    835 +}
    1855 +    918 +    836 +
    1856 +    919 +    837 +// REQUIRED: Manual Override
    1857 +    920 +    838 +function showRegionToggle() {
    1858 +    921 +    839 +  // "Not in India? Click for international options"
    1859 +    922 +    840 +  // "In India? Click for UPI options"
    1860 +    923 +    841 +}
    1861 +    924 +    842 +```
    1862 +    925 +    843 +
    1863 +    926 +    844 +### Terminology (LEGAL REQUIREMENT)
    1864 +    927 +    845 +
    1865 +    928 +    846 +| ‚ùå DON'T USE | ‚úÖ USE INSTEAD |
    1866 +    929 +    847 +|-------------|----------------|
    1867 +    930 +    848 +| Donation | Support |
    1868 +    931 +    849 +| Donate | Sponsor |
    1869 +    932 +    850 +| Charity | Tip |
    1870 +    933 +    851 +| Contribute | Buy me a coffee |
    1871 +    934 +    852 +
    1872 +    935 +    853 +### Success Criteria
    1873 +    936 +    854 +
    1874 +    937 +    855 +| Metric | Target | Measurement |
    1875 +    938 +    856 +|--------|--------|-------------|
    1876 +    939 +    857 +| Web App button live | Day 3 | Deployed |
    1877 +    940 +    858 +| README badges live | Day 7 | Deployed |
    1878 +    941 +    859 +| First support received | Week 4 | Platform dashboard |
    1879 +    942 +    860 +| Zero legal issues | Ongoing | No complaints |
    1880 +    943 +    861 +
    1881 +    944 +    862 +---
    1882 +    945 +    863 +
    1883 +    946 +    864 +## ‚úÖ VERDICT: GREEN LIGHT FOR ENGINEERING
    1884 +    947 +    865 +
    1885 +    948 +    866 +**Core Conditions (MANDATORY):**
    1886 +    949 +    867 +1. Web App footer button is PRIMARY (not README)
    1887 +    950 +    868 +2. Fail-safe pattern with 300ms timeout is MANDATORY
    1888 +    951 +    869 +3. "Not in India?" toggle is MANDATORY
    1889 +    952 +    870 +4. Use "Support" terminology exclusively
    1890 +    953 +    871 +5. Deploy GitHub Sponsors badge ONLY after approval email
    1891 +    954 +    872 +
    1892 +    955 +    873 +**Enterprise Refinements (REQUIRED):**
    1893 +    956 +    874 +6. Skeleton Loader for CLS mitigation (min-height: 60px)
    1894 +    957 +    875 +7. UTM parameters on ALL payment links for attribution
    1895 +    958 +    876 +8. `rel="noopener noreferrer"` on ALL external links
    1896 +    959 +    877 +9. Session caching to avoid repeated API calls
    1897 +    960 +    878 +
    1898 +    961 +    879 +---
    1899 +    962 +    880 +
    1900 +    963 +    881 +## Document History
    1901 +    964 +    882 +
    1902 +    965 +    883 +| Version | Date | Author | Changes |
    1903 +    966 +    884 +|---------|------|--------|---------|
    1904 +    967 +    885 +| 1.0 | 2025-12-19 | Principal SDE | Initial document |
    1905 +    968 +    886 +| 2.0 | 2025-12-19 | Principal SDE | Added Reviews A, B, C + consolidated decision |
    1906 +    969 +    887 +| 2.1 | 2025-12-19 | Principal SDE | Added PART 4 Final Recommendation |
    1907 +    970 +    888 +| 2.2 | 2025-12-19 | Enterprise Board | Added Review D + Enterprise Refinements + GREEN LIGHT |
    1908 +    971 +    889 +
    1909 +    972 +    890 +---
    1910 +    973 +    891 +
    1911 +    974 +    892 +**Status**: üü¢ APPROVED - ZERO DEFECTS
    1912 +    975 +    893 +**Reviewed By**: 4 Reviewers (3 Principal SDEs + Enterprise Architecture Board)
    1913 +    976 +    894 +**Technical Feasibility**: 10/10
    1914 +    977 +    895 +**Compliance Rating**: 10/10
    1915 +    978 +    896 +**Final Decision**: Web App Primary + Static Badges Secondary + Fail-Safe Smart Routing
    1916 +    979 +    897 +**Ready for**: Phase 0 (Account Setup)
    1917 +    980 +    898 +
    1918 +    981 +    899 +üöÄ **GO FOR LAUNCH**
    1919 +    982 +    900 +
    1920 +    983 +    901 +---
    1921 +    984 +    902 +
    1922 +    985 +    903 +> **Next Step:** Proceed to Phase 0 (Account Creation) below.
    1923 +    986 +    904 +
    1924 +    987 +    905 +---
    1925 +    988 +    906 +
    1926 +    989 +    907 +# APPENDIX A: Phase 0 - Account Creation Guide
    1927 +    990 +    908 +
    1928 +    991 +    909 +## Step-by-Step Setup Instructions
    1929 +    992 +    910 +
    1930 +    993 +    911 +### A.1 Ko-fi Account Setup (Global - Day 1)
    1931 +    994 +    912 +
    1932 +    995 +    913 +**URL:** https://ko-fi.com/
    1933 +    996 +    914 +
    1934 +    997 +    915 +| Step | Action | Notes |
    1935 +    998 +    916 +|------|--------|-------|
    1936 +    999 +    917 +| 1 | Go to https://ko-fi.com/ | Click "Start a Page" |
    1937 +    1000 +    918 +| 2 | Sign up with email or Google | Use project email if available |
    1938 +    1001 +    919 +| 3 | Choose username | e.g., `markdownviewerpro` |
    1939 +    1002 +    920 +| 4 | Set up profile | Add project logo, description |
    1940 +    1003 +    921 +| 5 | Connect PayPal or Stripe | **Required for payouts** |
    1941 +    1004 +    922 +| 6 | Set donation amounts | $1, $5, $10, $20, $50 |
    1942 +    1005 +    923 +| 7 | Enable "Support" button | Not "Donate" (legal) |
    1943 +    1006 +    924 +| 8 | Get page URL | `ko-fi.com/markdownviewerpro` |
    1944 +    1007 +    925 +
    1945 +    1008 +    926 +**Time Required:** ~10 minutes
    1946 +    1009 +    927 +**Verification:** Make a $1 test donation to yourself
    1947 +    1010 +    928 +
    1948 +    1011 +    929 +---
    1949 +    1012 +    930 +
    1950 +    1013 +    931 +### A.2 Razorpay Account Setup (India - Day 1)
    1951 +    1014 +    932 +
    1952 +    1015 +    933 +**URL:** https://dashboard.razorpay.com/signup
    1953 +    1016 +    934 +
    1954 +    1017 +    935 +| Step | Action | Notes |
    1955 +    1018 +    936 +|------|--------|-------|
    1956 +    1019 +    937 +| 1 | Go to Razorpay Dashboard | Click "Sign Up" |
    1957 +    1020 +    938 +| 2 | Enter mobile number | Indian number required |
    1958 +    1021 +    939 +| 3 | Verify OTP | |
    1959 +    1022 +    940 +| 4 | Select "Individual" account type | Not "Business" |
    1960 +    1023 +    941 +| 5 | Complete KYC | **Required documents below** |
    1961 +    1024 +    942 +| 6 | Create Payment Page | "Support Markdown Viewer Pro" |
    1962 +    1025 +    943 +| 7 | Set preset amounts | ‚Çπ50, ‚Çπ100, ‚Çπ250, ‚Çπ500, ‚Çπ1000 |
    1963 +    1026 +    944 +| 8 | Enable UPI, Cards, Netbanking | |
    1964 +    1027 +    945 +| 9 | Get Payment Link | `razorpay.me/@markdownviewer` |
    1965 +    1028 +    946 +
    1966 +    1029 +    947 +**KYC Documents Required:**
    1967 +    1030 +    948 +- PAN Card (Individual)
    1968 +    1031 +    949 +- Aadhaar Card
    1969 +    1032 +    950 +- Bank Account Details (Account number, IFSC)
    1970 +    1033 +    951 +- Cancelled Cheque (optional)
    1971 +    1034 +    952 +
    1972 +    1035 +    953 +**Time Required:** ~30 minutes (KYC may take 24-48 hours for verification)
    1973 +    1036 +    954 +**Verification:** Make a ‚Çπ10 test payment
    1974 +    1037 +    955 +
    1975 +    1038 +    956 +---
    1976 +    1039 +    957 +
    1977 +    1040 +    958 +### A.3 GitHub Sponsors Setup (Developers - Week 1)
    1978 +    1041 +    959 +
    1979 +    1042 +    960 +**URL:** https://github.com/sponsors
    1980 +    1043 +    961 +
    1981 +    1044 +    962 +| Step | Action | Notes |
    1982 +    1045 +    963 +|------|--------|-------|
    1983 +    1046 +    964 +| 1 | Ensure 2FA is enabled | **Mandatory** |
    1984 +    1047 +    965 +| 2 | Complete GitHub profile | Bio, location, profile picture |
    1985 +    1048 +    966 +| 3 | Go to https://github.com/sponsors | Click "Join the waitlist" |
    1986 +    1049 +    967 +| 4 | Select "Individual" | Not Organization |
    1987 +    1050 +    968 +| 5 | Choose payout country | India |
    1988 +    1051 +    969 +| 6 | Connect Stripe Express | For payouts to Indian bank |
    1989 +    1052 +    970 +| 7 | Fill tax information | W-8BEN form (non-US) |
    1990 +    1053 +    971 +| 8 | Set sponsorship tiers | $1, $5, $10, $20, $50/month |
    1991 +    1054 +    972 +| 9 | Write sponsor introduction | Why support this project |
    1992 +    1055 +    973 +| 10 | Submit for review | **Wait 2-4 weeks** |
    1993 +    1056 +    974 +
    1994 +    1057 +    975 +**Prerequisites:**
    1995 +    1058 +    976 +- GitHub account with 2FA enabled
    1996 +    1059 +    977 +- Profile with photo and bio
    1997 +    1060 +    978 +- At least one public repository
    1998 +    1061 +    979 +- Active contribution history (recommended)
    1999 +    1062 +    980 +
    2000 +    1063 +    981 +**Time Required:** ~20 minutes to apply
    2001 +    1064 +    982 +**Approval Time:** 2-4 weeks
    2002 +    1065 +    983 +**Verification:** Check email for approval notification
    2003 +    1066 +    984 +
    2004 +    1067 +    985 +---
    2005 +    1068 +    986 +
    2006 +    1069 +    987 +## Phase 0 Checklist
    2007 +    1070 +    988 +
    2008 +    1071 +    989 +```markdown
    2009 +    1072 +    990 +## Account Creation Checklist
    2010 +    1073 +    991 +
    2011 +    1074 +    992 +### Day 1
    2012 +    1075 +    993 +- [ ] Create Ko-fi account
    2013 +    1076 +    994 +  - [ ] Sign up at ko-fi.com
    2014 +    1077 +    995 +  - [ ] Set username: _______________
    2015 +    1078 +    996 +  - [ ] Connect PayPal/Stripe
    2016 +    1079 +    997 +  - [ ] Set amounts: $1, $5, $10, $20, $50
    2017 +    1080 +    998 +  - [ ] Test with $1 donation
    2018 +    1081 +    999 +  - [ ] Copy link: ko-fi.com/_______________
    2019 +    1082 +    1000 +
    2020 +    1083 +    1001 +- [ ] Create Razorpay account
    2021 +    1084 +    1002 +  - [ ] Sign up at razorpay.com
    2022 +    1085 +    1003 +  - [ ] Complete KYC (PAN, Aadhaar)
    2023 +    1086 +    1004 +  - [ ] Wait for verification (24-48h)
    2024 +    1087 +    1005 +  - [ ] Create Payment Page
    2025 +    1088 +    1006 +  - [ ] Set amounts: ‚Çπ50, ‚Çπ100, ‚Çπ250, ‚Çπ500, ‚Çπ1000
    2026 +    1089 +    1007 +  - [ ] Test with ‚Çπ10 payment
    2027 +    1090 +    1008 +  - [ ] Copy link: razorpay.me/@_______________
    2028 +    1091 +    1009 +
    2029 +    1092 +    1010 +### Day 1 (Submit, wait 2-4 weeks)
    2030 +    1093 +    1011 +- [ ] Apply for GitHub Sponsors
    2031 +    1094 +    1012 +  - [ ] Enable 2FA on GitHub
    2032 +    1095 +    1013 +  - [ ] Complete profile
    2033 +    1096 +    1014 +  - [ ] Submit application
    2034 +    1097 +    1015 +  - [ ] Fill W-8BEN tax form
    2035 +    1098 +    1016 +  - [ ] Connect Stripe Express
    2036 +    1099 +    1017 +  - [ ] Wait for approval email
    2037 +    1100 +    1018 +
    2038 +    1101 +    1019 +### After Approval
    2039 +    1102 +    1020 +- [ ] GitHub Sponsors approved
    2040 +    1103 +    1021 +  - [ ] Set up tiers
    2041 +    1104 +    1022 +  - [ ] Enable on repository
    2042 +    1105 +    1023 +  - [ ] Add badge to README
    2043 +    1106 +    1024 +```
    2044 +    1107 +    1025 +
    2045 +    1108 +    1026 +---
    2046 +    1109 +    1027 +
    2047 +    1110 +    1028 +## Quick Reference: Account URLs After Setup
    2048 +    1111 +    1029 +
    2049 +    1112 +    1030 +| Platform | Your URL | Status |
    2050 +    1113 +    1031 +|----------|----------|--------|
    2051 +    1114 +    1032 +| Ko-fi | `https://ko-fi.com/markdownviewerpro` | ‚è≥ Pending |
    2052 +    1115 +    1033 +| Razorpay | `https://razorpay.me/@markdownviewer` | ‚è≥ Pending |
    2053 +    1116 +    1034 +| GitHub Sponsors | `https://github.com/sponsors/PrakharMNNIT` | ‚è≥ Pending Approval |
    2054 +    1117 +    1035 +
    2055 +    1118 +    1036 +---
    2056 +    1119 +    1037 +
    2057 +    1120 +    1038 +## Troubleshooting
    2058 +    1121 +    1039 +
    2059 +    1122 +    1040 +### Ko-fi Issues
    2060 +    1123 +    1041 +| Problem | Solution |
    2061 +    1124 +    1042 +|---------|----------|
    2062 +    1125 +    1043 +| PayPal not connecting | Use Stripe instead |
    2063 +    1126 +    1044 +| Payout delayed | Check PayPal verification status |
    2064 +    1127 +    1045 +| Page not visible | Check privacy settings |
    2065 +    1128 +    1046 +
    2066 +    1129 +    1047 +### Razorpay Issues
    2067 +    1130 +    1048 +| Problem | Solution |
    2068 +    1131 +    1049 +|---------|----------|
    2069 +    1132 +    1050 +| KYC rejected | Re-upload clearer documents |
    2070 +    1133 +    1051 +| Payout delayed | Verify bank details |
    2071 +    1134 +    1052 +| International cards failing | Enable "International Payments" in dashboard |
    2072 +    1135 +    1053 +
    2073 +    1136 +    1054 +### GitHub Sponsors Issues
    2074 +    1137 +    1055 +| Problem | Solution |
    2075 +    1138 +    1056 +|---------|----------|
    2076 +    1139 +    1057 +| Application rejected | Improve profile, add more repos |
    2077 +    1140 +    1058 +| Stripe not available | Use alternative payout method |
    2078 +    1141 +    1059 +| Long wait time | Normal - allow up to 4 weeks |
    2079 +    1142 +    1060 +
    2080 +    1143 +    1061 +---
    2081 +    1144 +    1062 +
    2082 +    1145 +    1063 +**End of Appendix A**
    2083 +    1146 +    1064  
    2084 +    1147 +
    2085 +    1148 +```
    2086 +    1149 +
    2087 +    1150 +
    2088 +    1151 +### ‚ú® `docs/01-requirements/donation_final_readiness_review.md` **[ADDED]**
    2089 +    1152 +
    2090 +    1153 +**Status:** ‚úÖ **NEW FILE** - This file has been newly created
    2091 +    1154 +
    2092 +    1155 +**Type:** Documentation üìñ
    2093 +    1156 +
    2094 +    1157 +```diff
    2095 +    1158 +@@ -0,0 +1,91 @@
    2096 +    1159 +      1 +# Sr. Principal SDE Final Readiness Review
    2097 +    1160 +      2 +
    2098 +    1161 +      3 +**Reviewer:** Enterprise Architecture Board
    2099 +    1162 +      4 +**Date:** 2025-12-19
    2100 +    1163 +      5 +**Target:** `donation-feature-plan.md` (v2.1 Consolidated)
    2101 +    1164 +      6 +**Status:** ‚úÖ **GREEN LIGHT** (with 3 Non-Blocking Observability Recommendations)
    2102 +947 1165        7 +
    2103 +948 1166        8 +---
    2104 +949 1167        9 +
    2105 +950     -     10 +## üìã Table of Contents
    2106 +    1168 +     10 +## 1. Executive Summary
    2107 +951 1169       11 +
    2108 +952     -     12 +1. [Standard Assumptions](#-standard-assumptions)
    2109 +953     -     13 +2. [Integer Limits & Data Types](#-integer-limits--data-types)
    2110 +954     -     14 +3. [Array & Container Constraints](#-array--container-constraints)
    2111 +955     -     15 +4. [String Constraints](#-string-constraints)
    2112 +956     -     16 +5. [Time Complexity Limits](#-time-complexity-limits)
    2113 +957     -     17 +6. [Space Complexity Limits](#-space-complexity-limits)
    2114 +958     -     18 +7. [Common Primes & Mathematical Constants](#-common-primes--mathematical-constants)
    2115 +959     -     19 +8. [Edge Cases Checklist](#-edge-cases-checklist)
    2116 +960     -     20 +9. [Platform-Specific Constraints](#-platform-specific-constraints)
    2117 +961     -     21 +10. [Quick Reference Cheatsheet](#-quick-reference-cheatsheet)
    2118 +962     -     22 +
    2119 +963     -     23 +---
    2120 +964     -     24 +
    2121 +965     -     25 +## üéØ Standard Assumptions
    2122 +966     -     26 +
    2123 +967     -     27 +### The Golden Rules
    2124 +    1170 +     12 +The consolidated plan (v2.1) has successfully resolved the critical architectural conflicts identified in previous reviews. The "Web App Primary + Fail-Safe Router" approach combined with the "Two-Pocket" financial strategy represents a high-maturity solution that balances **User Experience**, **Legal Compliance**, and **Technical Risk**.
    2125 +    1171 +     13 +
    2126 +    1172 +     14 +**Verdict:** The plan is **Ready for Engineering**.
    2127 +    1173 +     15 +
    2128 +    1174 +     16 +---
    2129 +    1175 +     17 +
    2130 +    1176 +     18 +## 2. Residual Efficiency & Observability Risks
    2131 +    1177 +     19 +
    2132 +    1178 +     20 +While the core functionality is sound, a "Strict" review identifies minor gaps in **UX Stability** and **Business Observability** that should be addressed during implementation.
    2133 +    1179 +     21 +
    2134 +    1180 +     22 +### 2.1 Cumulative Layout Shift (CLS) Risk
    2135 +    1181 +     23 +*   **Issue:** The "Smart Router" relies on an asynchronous `fetch` with a 300ms race condition.
    2136 +    1182 +     24 +*   **Risk:** If the footer renders *without* the button, and then the button "pops in" 200ms later, it causes a layout shift. This hurts SEO (Core Web Vitals) and visual polish.
    2137 +    1183 +     25 +*   **Requirement:** The footer implementation **MUST** reserve fixed vertical space (e.g., `min-height: 60px`) for the support widget *before* the JS runs.
    2138 +    1184 +     26 +    *   *Loading State:* Show a generic "‚òï Support" grey ghost button immediately.
    2139 +    1185 +     27 +    *   *Hydration:* Swap it for the colorful "üáÆüá≥ UPI" or "üåè PayPal" button once the promise resolves.
    2140 +968 1186       28 +
    2141 +969     -     29 +| Assumption | Typical Value | Reasoning |
    2142 +970     -     30 +|------------|---------------|-----------|
    2143 +971     -     31 +| **Time Limit** | 1-2 seconds | ~10‚Å∏ simple operations/second |
    2144 +972     -     32 +| **Memory Limit** | 256 MB | Standard competitive programming |
    2145 +973     -     33 +| **Max Input Size (n)** | 10‚Åµ to 10‚Å∂ | Fits in memory, allows O(n log n) |
    2146 +974     -     34 +| **Max Integer Value** | 10‚Åπ | Fits in `int` |
    2147 +975     -     35 +| **Large Integer Value** | 10¬π‚Å∏ | Requires `long long` |
    2148 +    1187 +     29 +### 2.2 Blind spots in Success Metrics
    2149 +    1188 +     30 +*   **Issue:** The stated *Success Metrics* include "At least 3 valid donations".
    2150 +    1189 +     31 +*   **Risk:** With direct links to Ko-fi/Razorpay, you cannot distinguish traffic sources (README vs App Footer vs Direct Search). You will see money, but not *attribution*.
    2151 +    1190 +     32 +*   **Requirement:** Use UTM parameters or `ref` tags on all generated links.
    2152 +    1191 +     33 +    *   **Bad:** `razorpay.me/@markdownviewer`
    2153 +    1192 +     34 +    *   **Good:** `razorpay.me/@markdownviewer?notes[source]=webapp_footer`
    2154 +    1193 +     35 +    *   **Good:** `ko-fi.com/markdownviewerpro?ref=readme_badge`
    2155 +976 1194       36 +
    2156 +977     -     37 +### What to Ask in Interviews
    2157 +978     -     38 +
    2158 +979     -     39 +1. **Input size constraints?** (n ‚â§ ?)
    2159 +980     -     40 +2. **Value range?** (values ‚â§ ?)
    2160 +981     -     41 +3. **Can values be negative?**
    2161 +982     -     42 +4. **Are there duplicates?**
    2162 +983     -     43 +5. **Is input sorted?**
    2163 +984     -     44 +6. **Can input be empty?**
    2164 +    1195 +     37 +### 2.3 Security Best Practice (`noopener`)
    2165 +    1196 +     38 +*   **Issue:** External links to payment processors open in new tabs (`target="_blank"`).
    2166 +    1197 +     39 +*   **Risk:** Reverse Tabnapping (theoretical risk on older browsers, but enterprise compliance usually flags it).
    2167 +    1198 +     40 +*   **Requirement:** All external payment links **MUST** include `rel="noopener noreferrer"`.
    2168 +    1199 +     41 +
    2169 +    1200 +     42 +---
    2170 +    1201 +     43 +
    2171 +    1202 +     44 +## 3. Final Architecture Code Sign-off
    2172 +985 1203       45 +
    2173 +986     -     46 +---
    2174 +    1204 +     46 +The proposed JS snippet is robust. I am validating the `Promise.race` pattern as **Enterprise-Grade**.
    2175 +987 1205       47 +
    2176 +988     -     48 +## üî¢ Integer Limits & Data Types
    2177 +989     -     49 +
    2178 +990     -     50 +### Standard Integer Ranges
    2179 +991     -     51 +
    2180 +992     -     52 +| Type | Bytes | Range | Max (~) | Use When |
    2181 +993     -     53 +|------|-------|-------|---------|----------|
    2182 +994     -     54 +| `int` | 4 | -2¬≥¬π to 2¬≥¬π-1 | ¬±2.1√ó10‚Åπ | Default choice |
    2183 +995     -     55 +| `unsigned int` | 4 | 0 to 2¬≥¬≤-1 | 4.3√ó10‚Åπ | Non-negative only |
    2184 +996     -     56 +| `long long` | 8 | -2‚Å∂¬≥ to 2‚Å∂¬≥-1 | ¬±9.2√ó10¬π‚Å∏ | Large values |
    2185 +997     -     57 +| `unsigned long long` | 8 | 0 to 2‚Å∂‚Å¥-1 | 1.8√ó10¬π‚Åπ | Very large non-negative |
    2186 +    1206 +     48 +**Refined Snippet (Optimization for Reliability):**
    2187 +    1207 +     49 +```javascript
    2188 +    1208 +     50 +// RECOMMENDED IMPLEMENTATION PATTERN
    2189 +    1209 +     51 +const TIMEOUT_MS = 300;
    2190 +    1210 +     52 +const FALLBACK_REGION = 'global';
    2191 +    1211 +     53 +
    2192 +    1212 +     54 +async function getDonationConfig() {
    2193 +    1213 +     55 +  // 1. Check Session Cache (FR-1.4) - Avoids API hit on page navigation
    2194 +    1214 +     56 +  const cached = sessionStorage.getItem('user_region');
    2195 +    1215 +     57 +  if (cached) return cached;
    2196 +998 1216       58 +
    2197 +999     -     59 +### Critical Constants (MEMORIZE!)
    2198 +1000     -     60 +
    2199 +1001     -     61 +```cpp
    2200 +1002     -     62 +#include <climits>
    2201 +1003     -     63 +
    2202 +1004     -     64 +INT_MAX    =  2,147,483,647      // ‚âà 2.1 √ó 10‚Åπ
    2203 +1005     -     65 +INT_MIN    = -2,147,483,648      // ‚âà -2.1 √ó 10‚Åπ
    2204 +1006     -     66 +LLONG_MAX  =  9,223,372,036,854,775,807  // ‚âà 9.2 √ó 10¬π‚Å∏
    2205 +1007     -     67 +LLONG_MIN  = -9,223,372,036,854,775,808  // ‚âà -9.2 √ó 10¬π‚Å∏
    2206 +    1217 +     59 +  try {
    2207 +    1218 +     60 +    // 2. Race Network vs Timer
    2208 +    1219 +     61 +    const fetchPromise = fetch('https://ipapi.co/json/').then(r => r.json());
    2209 +    1220 +     62 +    const timeoutPromise = new Promise((_, reject) =>
    2210 +    1221 +     63 +      setTimeout(() => reject(new Error('Timeout')), TIMEOUT_MS)
    2211 +    1222 +     64 +    );
    2212 +    1223 +     65 +
    2213 +    1224 +     66 +    const data = await Promise.race([fetchPromise, timeoutPromise]);
    2214 +    1225 +     67 +    const region = data.country_code === 'IN' ? 'india' : 'global';
    2215 +1008 1226       68 +
    2216 +1009     -     69 +// Quick mental math
    2217 +1010     -     70 +INT_MAX   ‚âà 2 √ó 10‚Åπ    (2 billion)
    2218 +1011     -     71 +LLONG_MAX ‚âà 9 √ó 10¬π‚Å∏   (9 quintillion)
    2219 +1012     -     72 +```
    2220 +1013     -     73 +
    2221 +1014     -     74 +### When to Use Which Type
    2222 +1015     -     75 +
    2223 +1016     -     76 +| Problem Constraint | Type to Use | Example |
    2224 +1017     -     77 +|-------------------|-------------|---------|
    2225 +1018     -     78 +| n ‚â§ 10‚Åµ, values ‚â§ 10‚Åπ | `int` | Most problems |
    2226 +1019     -     79 +| Values > 2√ó10‚Åπ | `long long` | Large sums, products |
    2227 +1020     -     80 +| Sum of n elements, n ‚â§ 10‚Åµ | `long long` | 10‚Åµ √ó 10‚Åπ = 10¬π‚Å¥ |
    2228 +1021     -     81 +| Product of elements | `long long` or modulo | Overflow danger! |
    2229 +1022     -     82 +| n √ó n where n ‚â§ 10‚Åµ | `long long` | 10¬π‚Å∞ > INT_MAX |
    2230 +    1227 +     69 +    // 3. Set Cache
    2231 +    1228 +     70 +    sessionStorage.setItem('user_region', region);
    2232 +    1229 +     71 +    return region;
    2233 +    1230 +     72 +  } catch (e) {
    2234 +    1231 +     73 +    // 4. Fail Open
    2235 +    1232 +     74 +    console.warn('[DonationRouter] Geo-lookup failed/timed-out, defaulting to Global.');
    2236 +    1233 +     75 +    return FALLBACK_REGION;
    2237 +    1234 +     76 +  }
    2238 +    1235 +     77 +}
    2239 +    1236 +     78 +```
    2240 +    1237 +     79 +
    2241 +    1238 +     80 +---
    2242 +    1239 +     81 +
    2243 +    1240 +     82 +## 4. Final Approvals
    2244 +1023 1241       83 +
    2245 +1024     -     84 +### ‚ö†Ô∏è Overflow Danger Zones
    2246 +1025     -     85 +
    2247 +1026     -     86 +```cpp
    2248 +1027     -     87 +// ‚ùå OVERFLOW! (10‚Åµ √ó 10‚Åµ = 10¬π‚Å∞ > INT_MAX)
    2249 +1028     -     88 +int n = 100000;
    2250 +1029     -     89 +int result = n * n;  // WRONG!
    2251 +    1242 +     84 +| Category | Status | Notes |
    2252 +    1243 +     85 +|----------|--------|-------|
    2253 +    1244 +     86 +| **Functional** | ‚úÖ Approved | Requirements are clear and testable. |
    2254 +    1245 +     87 +| **Technical** | ‚úÖ Approved | Fail-safe pattern mitigates API risk. |
    2255 +    1246 +     88 +| **Legal** | ‚úÖ Approved | "Two-Pocket" strategy satisfies FEMA/IRS separation. |
    2256 +    1247 +     89 +| **UX** | ‚úÖ Approved | CLS mitigation (Skeleton Loader) added as requirement. |
    2257 +1030 1248       90 +
    2258 +1031     -     91 +// ‚úÖ SAFE
    2259 +1032     -     92 +long long result = (long long)n * n;
    2260 +1033     -     93 +long long result = 1LL * n * n;
    2261 +    1249 +     91 +**Next Step:** Proceed to Phase 1 (Account Creation) as defined in the Roadmap.
    2262 +    1250 +     92  
    2263 +    1251 +
    2264 +    1252 +```
    2265 +    1253 +
    2266 +    1254 +
    2267 +    1255 +### ‚ú® `docs/01-requirements/donation_strategy_review.md` **[ADDED]**
    2268 +    1256 +
    2269 +    1257 +**Status:** ‚úÖ **NEW FILE** - This file has been newly created
    2270 +    1258 +
    2271 +    1259 +**Type:** Documentation üìñ
    2272 +    1260 +
    2273 +    1261 +```diff
    2274 +    1262 +@@ -0,0 +1,64 @@
    2275 +    1263 +      1 +# Principal SDE Review: Donation System Strategy
    2276 +    1264 +      2 +
    2277 +    1265 +      3 +**Reviewer:** Principal Software Engineer, Payments & Growth
    2278 +    1266 +      4 +**Date:** 2025-12-19
    2279 +    1267 +      5 +**Subject:** Comparative Analysis of `donation_system_design.md` (Proposal A) vs `donation-feature-plan.md` (Proposal B)
    2280 +    1268 +      6 +
    2281 +    1269 +      7 +---
    2282 +    1270 +      8 +
    2283 +    1271 +      9 +## Executive Summary
    2284 +    1272 +     10 +
    2285 +    1273 +     11 +I have reviewed both proposals side-by-side.
    2286 +    1274 +     12 +*   **Proposal A (Smart Router)** focuses on an "automated" user experience via IP-based routing.
    2287 +    1275 +     13 +*   **Proposal B (Feature Plan)** focuses on a "transparent" user choice via static badges (GitHub/Ko-fi/Razorpay).
    2288 +    1276 +     14 +
    2289 +    1277 +     15 +**Recommendation:** ‚úÖ **PROCEED WITH PROPOSAL B (Feature Plan)**
    2290 +    1278 +     16 +*   **Why?** It offers superior **Trust**, **Reliability**, and **Zero-Maintenance**.
    2291 +    1279 +     17 +*   **Caveat:** Proposal A's "Smart Router" logic should be adopted *only* as an enhancement for the Web App's footer button, but NOT for the `README.md`.
    2292 +    1280 +     18 +
    2293 +    1281 +     19 +---
    2294 +    1282 +     20 +
    2295 +    1283 +     21 +## Detailed Comparative Analysis
    2296 +    1284 +     22 +
    2297 +    1285 +     23 +### 1. User Trust & Conversion
    2298 +    1286 +     24 +*   **Proposal A (Router):** Risks "Link Anxiety". A user clicking "Donate" and being redirected through a custom domain (`your-site.app/donate`) before landing on a payment page can feel phishy. Users prefer to see exactly where they are going (e.g., hovering and seeing `github.com/sponsors` or `razorpay.me`).
    2299 +    1287 +     25 +*   **Proposal B (Manual):** High Trust. The "Sponsor" badge on GitHub is a native, trusted signal. Users know exactly what they are clicking.
    2300 +    1288 +     26 +*   **Winner:** üèÜ **Proposal B**
    2301 +    1289 +     27 +
    2302 +    1290 +     28 +### 2. Reliability & Maintenance
    2303 +    1291 +     29 +*   **Proposal A:** Requires hosting a bridge page. Requires an external Geolocation API (which has rate limits or costs). If the API fails, the buttons might not render. This introduces a **Point of Failure**.
    2304 +    1292 +     30 +*   **Proposal B:** Relies on static Markdown and Platform URLs. 100% Uptime (unless GitHub itself is down). Zero maintenance.
    2305 +    1293 +     31 +*   **Winner:** üèÜ **Proposal B** (Engineers hate maintenance debt).
    2306 +    1294 +     32 +
    2307 +    1295 +     33 +### 3. Legal & Compliance (The "Two-Pocket" Test)
    2308 +    1296 +     34 +Both proposals correctly identify the need to separate Domestic (INR) and International (USD) funds.
    2309 +    1297 +     35 +*   **Proposal B** creates a clearer mental model for the user ("I am Indian -> I choose Razorpay").
    2310 +    1298 +     36 +*   **Proposal A** tries to be "smart" but might accidentally route a VPN user to the wrong bucket (e.g., an NRI using an India VPN seeing UPI but wanting to pay via US Card). Proposal B allows the user to self-correct.
    2311 +    1299 +     37 +*   **Winner:** üèÜ **Proposal B** (User choice is better than inference for payments).
    2312 +    1300 +     38 +
    2313 +    1301 +     39 +### 4. Implementation Effort
    2314 +    1302 +     40 +*   **Proposal A:** ~4-8 hours. Setup hosting, write JS, test IP API, handle edge cases, CORS issues.
    2315 +    1303 +     41 +*   **Proposal B:** ~1 hour. Sign up -> Get Links -> Paste in README.
    2316 +    1304 +     42 +*   **Winner:** üèÜ **Proposal B**
    2317 +    1305 +     43 +
    2318 +    1306 +     44 +---
    2319 +    1307 +     45 +
    2320 +    1308 +     46 +## Critical Feeback on Proposal B (User's Plan)
    2321 +    1309 +     47 +
    2322 +    1310 +     48 +While Proposal B is the winner, here are specific improvements required before execution:
    2323 +    1311 +     49 +
    2324 +    1312 +     50 +1.  **Banner Design:** Ensure the badges in the `README.md` are aesthetically aligned. A mismatched row of buttons looks unprofessional. Use `Shields.io` consistently as you proposed.
    2325 +    1313 +     51 +2.  **Razorpay Link:** Verify if `razorpay.me/@username` allows *custom* amounts easily for the user. Sometimes "Payment Pages" are better than "Payment Links" for this specific use case.
    2326 +    1314 +     52 +3.  **GitHub Sponsors Eligibility:** You must verify eligibility. If your account is new/inactive, approval might take time. **Fallback:** Use Ko-fi as the primary until GitHub approves.
    2327 +    1315 +     53 +
    2328 +    1316 +     54 +---
    2329 +    1317 +     55 +
    2330 +    1318 +     56 +## Final Verdict & Next Steps
    2331 +    1319 +     57 +
    2332 +    1320 +     58 +**Discard Proposal A's architecture for the README.** Use Proposal B as the master plan.
    2333 +    1321 +     59 +
    2334 +    1322 +     60 +**Action Items:**
    2335 +    1323 +     61 +1.  **Execute Phase 1 & 2 of Proposal B immediately.** (Setup Accounts & specific Badges).
    2336 +    1324 +     62 +2.  **Enhancement (Optional):** In the *Application Footer* (index.html), you may effectively use the logic from Proposal A to highlight the "best" option (e.g., "üáÆüá≥ Support via UPI" vs "üåè Support via PayPal"), but keep the static `README.md` simple.
    2337 +    1325 +     63 +
    2338 +    1326 +     64 +**Approved for Implementation.** üöÄ
    2339 +    1327 +     65  
    2340 +    1328 +
    2341 +    1329 +```
    2342 +    1330 +
    2343 +    1331 +
    2344 +    1332 +### ‚ú® `docs/01-requirements/donation_system_design.md` **[ADDED]**
    2345 +    1333 +
    2346 +    1334 +**Status:** ‚úÖ **NEW FILE** - This file has been newly created
    2347 +    1335 +
    2348 +    1336 +**Type:** Documentation üìñ
    2349 +    1337 +
    2350 +    1338 +```diff
    2351 +    1339 +@@ -0,0 +1,141 @@
    2352 +    1340 +      1 +# Design Document: Geo-Adaptive Donation System
    2353 +    1341 +      2 +## Functional Requirements & Strategy
    2354 +    1342 +      3 +
    2355 +    1343 +      4 +**Document ID:** DD-2025-003-DONATION
    2356 +    1344 +      5 +**Author:** Sr. Principal SDE
    2357 +    1345 +      6 +**Status:** Draft
    2358 +    1346 +      7 +**Date:** 2025-12-19
    2359 +    1347 +      8 +
    2360 +    1348 +      9 +---
    2361 +    1349 +     10 +
    2362 +    1350 +     11 +## 1. Problem Statement
    2363 +    1351 +     12 +
    2364 +    1352 +     13 +The goal is to enable a simplified donation ("Buy Me a Coffee") flow that maximizes conversion rates by offering **local payment methods** and **native pricing** based on the user's location, specifically targeting:
    2365 +    1353 +     14 +*   **India:** Needs UPI support (GooglePay, PhonePe) and INR pricing (e.g., ‚Çπ50, ‚Çπ100). International cards often fail here due to RBI mandates.
    2366 +    1354 +     15 +*   **Global (ROW):** Needs PayPal/Stripe support and USD pricing (e.g., $1, $5).
    2367 +    1355 +     16 +*   **Contexts:** Must be accessible from the Web Application and static contexts like GitHub `README.md`.
    2368 +    1356 +     17 +
    2369 +    1357 +     18 +---
    2370 +    1358 +     19 +
    2371 +    1359 +     20 +## 2. Requirements
    2372 +    1360 +     21 +
    2373 +    1361 +     22 +### 2.1 Functional Requirements (FR)
    2374 +    1362 +     23 +
    2375 +    1363 +     24 +| ID | Requirement | Description |
    2376 +    1364 +     25 +|---|---|---|
    2377 +    1365 +     26 +| **FR-1** | **IP Geolocation** | System must detect if the user is in India (IN) or Rest of World (ROW). |
    2378 +    1366 +     27 +| **FR-2** | **Dynamic Currency** | Display INR (‚Çπ) presets for IN users and USD ($) presets for ROW users. |
    2379 +    1367 +     28 +| **FR-3** | **Preset Tiers** | **INR:** ‚Çπ50, ‚Çπ100, ‚Çπ250, ‚Çπ500, Custom.<br>**USD:** $1, $5, $10, $20, Custom. |
    2380 +    1368 +     29 +| **FR-4** | **Payment Method** | **IN:** Redirect to UPI/Razorpay.<br>**ROW:** Redirect to PayPal/Stripe/BMAC. |
    2381 +    1369 +     30 +| **FR-5** | **Readme Compatibility** | Since `README.md` cannot run JS, it must link to a hosted "Donation Routing Page" that handles the logic. |
    2382 +    1370 +     31 +
    2383 +    1371 +     32 +### 2.2 Non-Functional Requirements (NFR)
    2384 +    1372 +     33 +
    2385 +    1373 +     34 +| ID | Requirement | Description |
    2386 +    1374 +     35 +|---|---|---|
    2387 +    1375 +     36 +| **NFR-1** | **Zero Setup Cost** | Solution must not incur monthly fees (Transaction fees only). |
    2388 +    1376 +     37 +| **NFR-2** | **Legal Compliance** | **India:** Must comply with Tax laws (Income classification).<br>**Global:** Must avoid FCRA triggers (if applicable to individuals, usually treated as "Export of Services" or "Gift"). |
    2389 +    1377 +     38 +| **NFR-3** | **Performance** | Geo-lookup must add < 500ms latency to the donation page load. |
    2390 +    1378 +     39 +| **NFR-4** | **Privacy** | Do not store PII during the routing phase. |
    2391 +    1379 +     40 +
    2392 +    1380 +     41 +---
    2393 +    1381 +     42 +
    2394 +    1382 +     43 +## 3. Compliance & Financial Viability
    2395 +    1383 +     44 +
    2396 +    1384 +     45 +### 3.1 The "Two-Pocket" Strategy
    2397 +    1385 +     46 +To follow online donation laws strictly without complex business registration:
    2398 +    1386 +     47 +1.  **Pocket A (India):** Use **Razorpay** or **UPI Payment Link**.
    2399 +    1387 +     48 +    *   *Why:* Indian Payment Gateways require KYC and Indian Bank Accounts. They handle domestic UPI/Netbanking perfectly.
    2400 +    1388 +     49 +    *   *Compliance:* Treated as Domestic Income.
    2401 +    1389 +     50 +2.  **Pocket B (International):** Use **PayPal** or **Buy Me a Coffee (Stripe)**.
    2402 +    1390 +     51 +    *   *Why:* PayPal is the standard for cross-border small payments. Razorpay International often has high failure rates for personal accounts.
    2403 +    1391 +     52 +    *   *Compliance:* Treated as Foreign Inward Remittance (FIRC provided by PayPal/Bank).
    2404 +    1392 +     53 +
    2405 +    1393 +     54 +---
    2406 +    1394 +     55 +
    2407 +    1395 +     56 +## 4. Solution Options & Trade-offs
    2408 +    1396 +     57 +
    2409 +    1397 +     58 +### Option A: dedicated "Buy Me a Coffee" (Single Platform)
    2410 +    1398 +     59 +Use a single platform like *Buy Me a Coffee* (BMAC) or *Ko-fi*.
    2411 +    1399 +     60 +*   **Pros:** Zero dev effort, hosted page, handles currency conversion automatically (shows local currency to user usually).
    2412 +    1400 +     61 +*   **Cons:**
    2413 +    1401 +     62 +    *   **High Fees:** BMAC takes ~5% cut + Stripe fees.
    2414 +    1402 +     63 +    *   **UPI Failure:** Often fails to present a native UPI intent flow for Indians, leading to drop-offs.
    2415 +    1403 +     64 +    *   **Conversion:** Indian users seeing $5 (approx ‚Çπ400) might hesitate compared to seeing a native ‚Çπ100 tier.
    2416 +    1404 +     65 +
    2417 +    1405 +     66 +### Option B: The "Smart Router" (Recommended)
    2418 +    1406 +     67 +Create a simple custom landing page (e.g., `markdown-viewer.com/donate`) that detects IP and shows the right button.
    2419 +    1407 +     68 +
    2420 +    1408 +     69 +*   **Pros:**
    2421 +    1409 +     70 +    *   **Perfect UX:** Indians see UPI + ‚Çπ50. Global users see PayPal + $3.
    2422 +    1410 +     71 +    *   **Lower Fees:** Razorpay (Domestic) is ~2%, PayPal is ~4-5%. No extra platform reliability fee.
    2423 +    1411 +     72 +    *   **Control:** Full control over presets.
    2424 +    1412 +     73 +*   **Cons:** Requires hosting a simple HTML page (Free via GitHub Pages/Vercel).
    2425 +    1413 +     74 +
    2426 +    1414 +     75 +---
    2427 +    1415 +     76 +
    2428 +    1416 +     77 +## 5. Implementation Plan (The "Smart Router")
    2429 +    1417 +     78 +
    2430 +    1418 +     79 +### 5.1 Architecture
    2431 +    1419 +     80 +1.  **Static Badge (README/Footer):**
    2432 +    1420 +     81 +    *   Image: `Donate ‚òï`
    2433 +    1421 +     82 +    *   Link: `https://your-site.vercel.app/donate`
    2434 +    1422 +     83 +2.  **Routing Page (`/donate`):**
    2435 +    1423 +     84 +    *   **Tech:** Static HTML + Client-side JS.
    2436 +    1424 +     85 +    *   **Geo-Service:** Use `https://ipapi.co/json/` (Free tier: 1000 requests/day) or Cloudflare Traces (Unlimited).
    2437 +    1425 +     86 +
    2438 +    1426 +     87 +### 5.2 Flow Logic
    2439 +    1427 +     88 +```mermaid
    2440 +    1428 +     89 +graph TD
    2441 +    1429 +     90 +    A[User Clicks 'Donate'] --> B{Check IP via API}
    2442 +    1430 +     91 +    B -- Country = IN --> C[Render Razorpay Button]
    2443 +    1431 +     92 +    C --> C1[Show: ‚Çπ50, ‚Çπ100, ‚Çπ500]
    2444 +    1432 +     93 +    C --> C2[Method: UPI / Paytm / GPay]
    2445 +1034 1433       94 +
    2446 +1035     -     95 +// ‚ùå OVERFLOW! (sum of 10‚Åµ elements each up to 10‚Åπ)
    2447 +1036     -     96 +int sum = 0;
    2448 +1037     -     97 +for (int x : arr) sum += x;  // WRONG if arr is large!
    2449 +1038     -     98 +
    2450 +1039     -     99 +// ‚úÖ SAFE
    2451 +1040     -    100 +long long sum = 0;
    2452 +1041     -    101 +for (int x : arr) sum += x;
    2453 +1042     -    102 +```
    2454 +1043     -    103 +
    2455 +1044     -    104 +### Modular Arithmetic
    2456 +1045     -    105 +
    2457 +1046     -    106 +When problem says "answer modulo 10‚Åπ+7":
    2458 +1047     -    107 +
    2459 +1048     -    108 +```cpp
    2460 +1049     -    109 +const int MOD = 1e9 + 7;  // 1,000,000,007 (prime)
    2461 +    1434 +     95 +    B -- Country != IN --> D[Render PayPal/BMAC Button]
    2462 +    1435 +     96 +    D --> D1[Show: $1, $5, $10]
    2463 +    1436 +     97 +    D --> D2[Method: PayPal / Card]
    2464 +    1437 +     98 +```
    2465 +    1438 +     99 +
    2466 +    1439 +    100 +### 5.3 Financial Setup (Free)
    2467 +    1440 +    101 +1.  **For India (INR):**
    2468 +    1441 +    102 +    *   Sign up for **Razorpay Payment Pages** (No coding needed).
    2469 +    1442 +    103 +    *   Create a page "Buy me a Coffee".
    2470 +    1443 +    104 +    *   Set Fixed Amounts: ‚Çπ50, ‚Çπ100 (or "Decide yourself" field).
    2471 +    1444 +    105 +    *   *Cost:* 0 setup, ~2% per transaction.
    2472 +    1445 +    106 +2.  **For Global (USD):**
    2473 +    1446 +    107 +    *   Sign up for **PayPal.Me** or **Ko-fi** (connects to PayPal).
    2474 +    1447 +    108 +    *   Ko-fi is better (0% platform fee on donations, only PayPal fees).
    2475 +    1448 +    109 +    *   *Cost:* 0 setup, ~4-5% per transaction.
    2476 +1050 1449      110 +
    2477 +1051     -    111 +// Addition
    2478 +1052     -    112 +(a + b) % MOD
    2479 +1053     -    113 +
    2480 +1054     -    114 +// Subtraction (add MOD to avoid negative)
    2481 +1055     -    115 +((a - b) % MOD + MOD) % MOD
    2482 +    1450 +    111 +---
    2483 +    1451 +    112 +
    2484 +    1452 +    113 +## 6. Final Recommendation
    2485 +    1453 +    114 +
    2486 +    1454 +    115 +**Go with Option B (Smart Router) hosted on GitHub Pages.**
    2487 +1056 1455      116 +
    2488 +1057     -    117 +// Multiplication
    2489 +1058     -    118 +(1LL * a * b) % MOD  // Cast to long long first!
    2490 +1059     -    119 +
    2491 +1060     -    120 +// Common modulo values
    2492 +1061     -    121 +10‚Åπ + 7  = 1,000,000,007  // Most common (prime)
    2493 +1062     -    122 +10‚Åπ + 9  = 1,000,000,009  // Also prime
    2494 +1063     -    123 +998244353                  // FFT-friendly prime (2¬≤¬≥ √ó 7 √ó 17 + 1)
    2495 +1064     -    124 +```
    2496 +1065     -    125 +
    2497 +1066     -    126 +---
    2498 +1067     -    127 +
    2499 +1068     -    128 +## üìä Array & Container Constraints
    2500 +1069     -    129 +
    2501 +1070     -    130 +### Maximum Array Sizes
    2502 +1071     -    131 +
    2503 +1072     -    132 +| Memory | Max Elements (`int`) | Max Elements (`long long`) |
    2504 +1073     -    133 +|--------|---------------------|---------------------------|
    2505 +1074     -    134 +| 256 MB | ~64 million | ~32 million |
    2506 +1075     -    135 +| 512 MB | ~128 million | ~64 million |
    2507 +1076     -    136 +| 1 GB | ~256 million | ~128 million |
    2508 +1077     -    137 +
    2509 +1078     -    138 +**Formula:** Max elements = Memory / sizeof(type)
    2510 +1079     -    139 +- 256 MB = 256 √ó 10‚Å∂ bytes
    2511 +1080     -    140 +- int array: 256 √ó 10‚Å∂ / 4 = 64 √ó 10‚Å∂
    2512 +1081     -    141 +
    2513 +1082     -    142 +### Typical Constraints by Problem Type
    2514 +1083     -    143 +
    2515 +1084     -    144 +| Problem Type | Typical n | Expected Complexity |
    2516 +1085     -    145 +|--------------|-----------|-------------------|
    2517 +1086     -    146 +| Easy | ‚â§ 10¬≥ | O(n¬≤) acceptable |
    2518 +1087     -    147 +| Medium | ‚â§ 10‚Åµ | O(n log n) expected |
    2519 +1088     -    148 +| Hard | ‚â§ 10‚Å∂ | O(n) or O(n log n) |
    2520 +1089     -    149 +| Very Hard | ‚â§ 10‚Å∑ | O(n) only |
    2521 +1090     -    150 +
    2522 +1091     -    151 +### 2D Array Limits
    2523 +1092     -    152 +
    2524 +1093     -    153 +```cpp
    2525 +1094     -    154 +// Max 2D array with 256MB memory
    2526 +1095     -    155 +// n √ó m √ó sizeof(int) ‚â§ 256 √ó 10‚Å∂
    2527 +1096     -    156 +
    2528 +1097     -    157 +// Safe limits:
    2529 +1098     -    158 +int arr[1000][1000];     // 4 MB - ‚úÖ Safe
    2530 +1099     -    159 +int arr[5000][5000];     // 100 MB - ‚úÖ Usually safe
    2531 +1100     -    160 +int arr[10000][10000];   // 400 MB - ‚ùå Too large!
    2532 +1101     -    161 +
    2533 +1102     -    162 +// For larger grids, use vector (dynamic allocation)
    2534 +1103     -    163 +vector<vector<int>> grid(n, vector<int>(m));
    2535 +1104     -    164 +```
    2536 +1105     -    165 +
    2537 +1106     -    166 +### Container Memory Usage
    2538 +1107     -    167 +
    2539 +1108     -    168 +| Container | Memory per Element | Notes |
    2540 +1109     -    169 +|-----------|-------------------|-------|
    2541 +1110     -    170 +| `vector<int>` | 4 bytes | Most efficient |
    2542 +1111     -    171 +| `deque<int>` | 4 bytes + overhead | Block allocation |
    2543 +1112     -    172 +| `list<int>` | 4 + 16 bytes | Node pointers |
    2544 +1113     -    173 +| `set<int>` | 4 + 32 bytes | Red-black tree |
    2545 +1114     -    174 +| `unordered_set<int>` | 4 + ~8 bytes | Hash table |
    2546 +1115     -    175 +| `map<int,int>` | 8 + 32 bytes | Red-black tree |
    2547 +1116     -    176 +| `unordered_map<int,int>` | 8 + ~16 bytes | Hash table |
    2548 +1117     -    177 +
    2549 +1118     -    178 +---
    2550 +1119     -    179 +
    2551 +1120     -    180 +## üìù String Constraints
    2552 +1121     -    181 +
    2553 +1122     -    182 +### String Length Limits
    2554 +1123     -    183 +
    2555 +1124     -    184 +| Constraint | Typical Value | Common Problems |
    2556 +1125     -    185 +|------------|---------------|-----------------|
    2557 +1126     -    186 +| Short strings | ‚â§ 100 | Brute force OK |
    2558 +1127     -    187 +| Medium strings | ‚â§ 10‚Åµ | O(n) required |
    2559 +1128     -    188 +| Long strings | ‚â§ 10‚Å∂ | O(n) only |
    2560 +1129     -    189 +| Multiple strings | Total length ‚â§ 10‚Å∂ | Sum constraint |
    2561 +1130     -    190 +
    2562 +1131     -    191 +### Character Set Assumptions
    2563 +1132     -    192 +
    2564 +1133     -    193 +```cpp
    2565 +1134     -    194 +// Lowercase letters only: 'a' to 'z' (26 chars)
    2566 +1135     -    195 +int freq[26] = {0};
    2567 +1136     -    196 +freq[ch - 'a']++;
    2568 +1137     -    197 +
    2569 +1138     -    198 +// All letters: 'A'-'Z', 'a'-'z' (52 chars)
    2570 +1139     -    199 +// Usually case-insensitive or convert to one case
    2571 +1140     -    200 +
    2572 +1141     -    201 +// Digits: '0' to '9' (10 chars)
    2573 +1142     -    202 +int digit = ch - '0';
    2574 +1143     -    203 +
    2575 +1144     -    204 +// ASCII printable: 32 to 126 (95 chars)
    2576 +1145     -    205 +int freq[128] = {0};  // Safe for all ASCII
    2577 +1146     -    206 +
    2578 +1147     -    207 +// Unicode: Use std::string with UTF-8
    2579 +1148     -    208 +// Careful: string[i] may not be a full character!
    2580 +1149     -    209 +```
    2581 +1150     -    210 +
    2582 +1151     -    211 +### String Comparison Complexity
    2583 +1152     -    212 +
    2584 +1153     -    213 +```cpp
    2585 +1154     -    214 +// Comparing two strings of length n and m
    2586 +1155     -    215 +s1 == s2;           // O(min(n, m))
    2587 +1156     -    216 +s1.compare(s2);     // O(min(n, m))
    2588 +1157     -    217 +s1 < s2;            // O(min(n, m))
    2589 +1158     -    218 +
    2590 +1159     -    219 +// For multiple comparisons, use hashing
    2591 +1160     -    220 +hash<string> hasher;
    2592 +1161     -    221 +size_t h = hasher(s);
    2593 +1162     -    222 +```
    2594 +1163     -    223 +
    2595 +1164     -    224 +---
    2596 +1165     -    225 +
    2597 +1166     -    226 +## ‚è±Ô∏è Time Complexity Limits
    2598 +1167     -    227 +
    2599 +1168     -    228 +### Operations per Second
    2600 +1169     -    229 +
    2601 +1170     -    230 +| Operation Type | Operations/Second |
    2602 +1171     -    231 +|---------------|-------------------|
    2603 +1172     -    232 +| Simple arithmetic | ~10‚Åπ |
    2604 +1173     -    233 +| Array access | ~10‚Å∏ - 10‚Åπ |
    2605 +1174     -    234 +| Vector operations | ~10‚Å∏ |
    2606 +1175     -    235 +| Set/Map operations | ~10‚Å∑ |
    2607 +1176     -    236 +| String operations | ~10‚Å∑ |
    2608 +1177     -    237 +| I/O (cin/cout) | ~10‚Å∂ (without fast I/O) |
    2609 +1178     -    238 +| I/O (fast I/O) | ~10‚Å∑ |
    2610 +1179     -    239 +
    2611 +1180     -    240 +### Maximum n for Time Limits
    2612 +1181     -    241 +
    2613 +1182     -    242 +| Time Limit | O(n) | O(n log n) | O(n¬≤) | O(n¬≥) | O(2‚Åø) |
    2614 +1183     -    243 +|------------|------|------------|-------|-------|-------|
    2615 +1184     -    244 +| 1 second | 10‚Å∏ | 10‚Å∂-10‚Å∑ | 10‚Å¥ | 500 | 25 |
    2616 +1185     -    245 +| 2 seconds | 2√ó10‚Å∏ | 2√ó10‚Å∑ | 1.4√ó10‚Å¥ | 600 | 26 |
    2617 +1186     -    246 +| 5 seconds | 5√ó10‚Å∏ | 5√ó10‚Å∑ | 2√ó10‚Å¥ | 800 | 28 |
    2618 +1187     -    247 +
    2619 +1188     -    248 +### Quick Complexity Check
    2620 +1189     -    249 +
    2621 +1190     -    250 +```cpp
    2622 +1191     -    251 +// Given n, what's the max acceptable complexity?
    2623 +1192     -    252 +n ‚â§ 10     ‚Üí O(n!) or O(2‚Åø) OK
    2624 +1193     -    253 +n ‚â§ 20     ‚Üí O(2‚Åø) OK, O(n!) too slow
    2625 +1194     -    254 +n ‚â§ 100    ‚Üí O(n¬≥) OK
    2626 +1195     -    255 +n ‚â§ 1000   ‚Üí O(n¬≤) OK
    2627 +1196     -    256 +n ‚â§ 10‚Åµ    ‚Üí O(n log n) or better
    2628 +1197     -    257 +n ‚â§ 10‚Å∂    ‚Üí O(n log n) risky, O(n) preferred
    2629 +1198     -    258 +n ‚â§ 10‚Å∏    ‚Üí O(n) only
    2630 +1199     -    259 +```
    2631 +1200     -    260 +
    2632 +1201     -    261 +### Reverse: Given Complexity, Max n
    2633 +1202     -    262 +
    2634 +1203     -    263 +| Complexity | Max n (1 sec) |
    2635 +1204     -    264 +|------------|---------------|
    2636 +1205     -    265 +| O(n!) | n ‚â§ 10 |
    2637 +1206     -    266 +| O(2‚Åø) | n ‚â§ 20-25 |
    2638 +1207     -    267 +| O(n¬≥) | n ‚â§ 500 |
    2639 +1208     -    268 +| O(n¬≤ log n) | n ‚â§ 1000 |
    2640 +1209     -    269 +| O(n¬≤) | n ‚â§ 5000-10000 |
    2641 +1210     -    270 +| O(n‚àön) | n ‚â§ 10‚Åµ |
    2642 +1211     -    271 +| O(n log n) | n ‚â§ 10‚Å∂-10‚Å∑ |
    2643 +1212     -    272 +| O(n) | n ‚â§ 10‚Å∏ |
    2644 +1213     -    273 +| O(log n) | n ‚â§ 10¬π‚Å∏ |
    2645 +1214     -    274 +| O(1) | n = anything |
    2646 +1215     -    275 +
    2647 +1216     -    276 +---
    2648 +1217     -    277 +
    2649 +1218     -    278 +## üíæ Space Complexity Limits
    2650 +1219     -    279 +
    2651 +1220     -    280 +### Memory Calculation
    2652 +1221     -    281 +
    2653 +1222     -    282 +```cpp
    2654 +1223     -    283 +// Typical memory limits
    2655 +1224     -    284 +256 MB = 256 √ó 10‚Å∂ bytes = 64 √ó 10‚Å∂ ints
    2656 +1225     -    285 +512 MB = 512 √ó 10‚Å∂ bytes = 128 √ó 10‚Å∂ ints
    2657 +1226     -    286 +
    2658 +1227     -    287 +// Stack vs Heap
    2659 +1228     -    288 +// Stack: Limited (~1-8 MB) - local variables, recursion
    2660 +1229     -    289 +// Heap: Limited by problem constraint - new, vector
    2661 +1230     -    290 +
    2662 +1231     -    291 +// Recursion depth limit (stack)
    2663 +1232     -    292 +// ~10‚Å¥ - 10‚Åµ calls typically safe
    2664 +1233     -    293 +// Deep recursion may cause stack overflow!
    2665 +1234     -    294 +
    2666 +1235     -    295 +// Tail recursion or iteration preferred for deep recursion
    2667 +1236     -    296 +```
    2668 +1237     -    297 +
    2669 +1238     -    298 +### Data Structure Space
    2670 +1239     -    299 +
    2671 +1240     -    300 +| Structure | Space | Example |
    2672 +1241     -    301 +|-----------|-------|---------|
    2673 +1242     -    302 +| Array of n ints | 4n bytes | n = 10‚Å∂ ‚Üí 4 MB |
    2674 +1243     -    303 +| n √ó n int matrix | 4n¬≤ bytes | n = 5000 ‚Üí 100 MB |
    2675 +1244     -    304 +| Adjacency list | O(V + E) | |
    2676 +1245     -    305 +| Adjacency matrix | O(V¬≤) | |
    2677 +1246     -    306 +| Binary tree (n nodes) | ~32n bytes | Node + 2 pointers |
    2678 +1247     -    307 +| Graph (V vertices, E edges) | V + E | Adjacency list |
    2679 +1248     -    308 +
    2680 +1249     -    309 +---
    2681 +1250     -    310 +
    2682 +1251     -    311 +## üî¢ Common Primes & Mathematical Constants
    2683 +1252     -    312 +
    2684 +1253     -    313 +### Primes to Know
    2685 +1254     -    314 +
    2686 +1255     -    315 +```cpp
    2687 +1256     -    316 +// For modular arithmetic
    2688 +1257     -    317 +10‚Åπ + 7 = 1,000,000,007  // Most common modulo (prime)
    2689 +1258     -    318 +10‚Åπ + 9 = 1,000,000,009  // Alternative (prime)
    2690 +1259     -    319 +998244353                 // NTT prime (2¬≤¬≥ √ó 7 √ó 17 + 1)
    2691 +1260     -    320 +
    2692 +1261     -    321 +// Small primes for hashing
    2693 +1262     -    322 +31, 37, 53, 97, 131, 1009, 10007
    2694 +1263     -    323 +
    2695 +1264     -    324 +// For string hashing (rolling hash)
    2696 +1265     -    325 +base = 31 or 37 (for lowercase letters)
    2697 +1266     -    326 +base = 53 (for mixed case)
    2698 +1267     -    327 +mod = 10‚Åπ + 7 or 10‚Åπ + 9
    2699 +1268     -    328 +
    2700 +1269     -    329 +// Largest prime ‚â§ n
    2701 +1270     -    330 +// Under 100: 97
    2702 +1271     -    331 +// Under 1000: 997
    2703 +1272     -    332 +// Under 10000: 9973
    2704 +1273     -    333 +// Under 10‚Åµ: 99991
    2705 +1274     -    334 +// Under 10‚Å∂: 999983
    2706 +1275     -    335 +// Under 10‚Åπ: 999999937
    2707 +1276     -    336 +```
    2708 +1277     -    337 +
    2709 +1278     -    338 +### Mathematical Constants
    2710 +1279     -    339 +
    2711 +1280     -    340 +```cpp
    2712 +1281     -    341 +// For geometry and floating point
    2713 +1282     -    342 +const double PI = acos(-1);        // 3.14159265358979...
    2714 +1283     -    343 +const double PI = 3.14159265358979323846;
    2715 +1284     -    344 +const double E = exp(1);           // 2.71828...
    2716 +1285     -    345 +
    2717 +1286     -    346 +// For comparison (floating point tolerance)
    2718 +1287     -    347 +const double EPS = 1e-9;
    2719 +1288     -    348 +if (abs(a - b) < EPS) // a == b
    2720 +1289     -    349 +
    2721 +1290     -    350 +// For "infinity" in algorithms
    2722 +1291     -    351 +const int INF = 1e9;           // For int (won't overflow on add)
    2723 +1292     -    352 +const int INF = INT_MAX / 2;   // Safe for addition
    2724 +1293     -    353 +const long long INF = 1e18;    // For long long
    2725 +1294     -    354 +const long long INF = LLONG_MAX / 2;
    2726 +1295     -    355 +```
    2727 +1296     -    356 +
    2728 +1297     -    357 +### Useful Mathematical Facts
    2729 +1298     -    358 +
    2730 +1299     -    359 +```cpp
    2731 +1300     -    360 +// Factorials
    2732 +1301     -    361 +10! = 3,628,800             // Fits in int
    2733 +1302     -    362 +12! = 479,001,600           // Last to fit in int
    2734 +1303     -    363 +13! = 6,227,020,800         // Needs long long
    2735 +1304     -    364 +20! ‚âà 2.4 √ó 10¬π‚Å∏            // Last to fit in long long
    2736 +1305     -    365 +21! overflows long long!
    2737 +1306     -    366 +
    2738 +1307     -    367 +// Powers of 2
    2739 +1308     -    368 +2¬π‚Å∞ = 1,024 ‚âà 10¬≥
    2740 +1309     -    369 +2¬≤‚Å∞ = 1,048,576 ‚âà 10‚Å∂
    2741 +1310     -    370 +2¬≥‚Å∞ = 1,073,741,824 ‚âà 10‚Åπ
    2742 +1311     -    371 +2¬≥¬≤ = 4,294,967,296 ‚âà 4 √ó 10‚Åπ (unsigned int max + 1)
    2743 +1312     -    372 +2‚Å∂‚Å¥ ‚âà 1.8 √ó 10¬π‚Åπ
    2744 +1313     -    373 +
    2745 +1314     -    374 +// Fibonacci
    2746 +1315     -    375 +F(45) = 1,134,903,170       // Last to fit in int
    2747 +1316     -    376 +F(92) = 7,540,113,804,746,346,429  // Last to fit in long long
    2748 +1317     -    377 +
    2749 +1318     -    378 +// Catalan numbers (combinatorics)
    2750 +1319     -    379 +C(17) = 129,644,790         // Fits in int
    2751 +1320     -    380 +C(35) = 3,116,285,494,907,301,262  // Fits in long long
    2752 +1321     -    381 +```
    2753 +1322     -    382 +
    2754 +1323     -    383 +---
    2755 +1324     -    384 +
    2756 +1325     -    385 +## ‚úÖ Edge Cases Checklist
    2757 +1326     -    386 +
    2758 +1327     -    387 +### Array/Vector Edge Cases
    2759 +1328     -    388 +
    2760 +1329     -    389 +```cpp
    2761 +1330     -    390 +// Always test:
    2762 +1331     -    391 +‚ñ° Empty array (n = 0)
    2763 +1332     -    392 +‚ñ° Single element (n = 1)
    2764 +1333     -    393 +‚ñ° Two elements (n = 2)
    2765 +1334     -    394 +‚ñ° All same elements
    2766 +1335     -    395 +‚ñ° Already sorted (ascending)
    2767 +1336     -    396 +‚ñ° Reverse sorted (descending)
    2768 +1337     -    397 +‚ñ° Maximum size (n = max constraint)
    2769 +1338     -    398 +‚ñ° Negative numbers
    2770 +1339     -    399 +‚ñ° Zero values
    2771 +1340     -    400 +‚ñ° INT_MAX / INT_MIN values
    2772 +1341     -    401 +‚ñ° Duplicates at boundaries
    2773 +1342     -    402 +```
    2774 +1343     -    403 +
    2775 +1344     -    404 +### String Edge Cases
    2776 +1345     -    405 +
    2777 +1346     -    406 +```cpp
    2778 +1347     -    407 +// Always test:
    2779 +1348     -    408 +‚ñ° Empty string (s = "")
    2780 +1349     -    409 +‚ñ° Single character (s = "a")
    2781 +1350     -    410 +‚ñ° All same character (s = "aaa")
    2782 +1351     -    411 +‚ñ° Palindrome
    2783 +1352     -    412 +‚ñ° All unique characters
    2784 +1353     -    413 +‚ñ° Maximum length
    2785 +1354     -    414 +‚ñ° Spaces/special characters (if allowed)
    2786 +1355     -    415 +‚ñ° Case sensitivity (if relevant)
    2787 +1356     -    416 +```
    2788 +1357     -    417 +
    2789 +1358     -    418 +### Graph Edge Cases
    2790 +1359     -    419 +
    2791 +1360     -    420 +```cpp
    2792 +1361     -    421 +// Always test:
    2793 +1362     -    422 +‚ñ° Empty graph (no edges)
    2794 +1363     -    423 +‚ñ° Single node
    2795 +1364     -    424 +‚ñ° Disconnected graph
    2796 +1365     -    425 +‚ñ° Complete graph
    2797 +1366     -    426 +‚ñ° Tree (n-1 edges)
    2798 +1367     -    427 +‚ñ° Cycle
    2799 +1368     -    428 +‚ñ° Self-loop (if allowed)
    2800 +1369     -    429 +‚ñ° Multiple edges between same nodes
    2801 +1370     -    430 +‚ñ° Negative edge weights (if allowed)
    2802 +1371     -    431 +‚ñ° All edges same weight
    2803 +1372     -    432 +```
    2804 +1373     -    433 +
    2805 +1374     -    434 +### Tree Edge Cases
    2806 +1375     -    435 +
    2807 +1376     -    436 +```cpp
    2808 +1377     -    437 +// Always test:
    2809 +1378     -    438 +‚ñ° Empty tree (null root)
    2810 +1379     -    439 +‚ñ° Single node
    2811 +1380     -    440 +‚ñ° Skewed tree (all left or all right)
    2812 +1381     -    441 +‚ñ° Perfect/complete binary tree
    2813 +1382     -    442 +‚ñ° Maximum depth
    2814 +1383     -    443 +‚ñ° All same values
    2815 +1384     -    444 +‚ñ° Negative values (if allowed)
    2816 +1385     -    445 +```
    2817 +1386     -    446 +
    2818 +1387     -    447 +### Number Edge Cases
    2819 +1388     -    448 +
    2820 +1389     -    449 +```cpp
    2821 +1390     -    450 +// Always test:
    2822 +1391     -    451 +‚ñ° Zero (0)
    2823 +1392     -    452 +‚ñ° Negative zero (-0 for floating point)
    2824 +1393     -    453 +‚ñ° INT_MAX (2,147,483,647)
    2825 +1394     -    454 +‚ñ° INT_MIN (-2,147,483,648)
    2826 +1395     -    455 +‚ñ° Powers of 2
    2827 +1396     -    456 +‚ñ° One less than power of 2
    2828 +1397     -    457 +‚ñ° Prime numbers
    2829 +1398     -    458 +‚ñ° Perfect squares
    2830 +1399     -    459 +‚ñ° Negative numbers
    2831 +1400     -    460 +‚ñ° Very small positive (1)
    2832 +1401     -    461 +‚ñ° Very large (max constraint)
    2833 +1402     -    462 +```
    2834 +1403     -    463 +
    2835 +1404     -    464 +### Binary Search Edge Cases
    2836 +1405     -    465 +
    2837 +1406     -    466 +```cpp
    2838 +1407     -    467 +// Always test:
    2839 +1408     -    468 +‚ñ° Target at index 0
    2840 +1409     -    469 +‚ñ° Target at last index
    2841 +1410     -    470 +‚ñ° Target not in array
    2842 +1411     -    471 +‚ñ° Target smaller than all elements
    2843 +1412     -    472 +‚ñ° Target larger than all elements
    2844 +1413     -    473 +‚ñ° All elements are target
    2845 +1414     -    474 +‚ñ° Single element equals target
    2846 +1415     -    475 +‚ñ° Single element doesn't equal target
    2847 +1416     -    476 +‚ñ° Two elements
    2848 +1417     -    477 +```
    2849 +1418     -    478 +
    2850 +1419     -    479 +---
    2851 +1420     -    480 +
    2852 +1421     -    481 +## üñ•Ô∏è Platform-Specific Constraints
    2853 +1422     -    482 +
    2854 +1423     -    483 +### LeetCode
    2855 +1424     -    484 +
    2856 +1425     -    485 +```cpp
    2857 +1426     -    486 +// Typical constraints
    2858 +1427     -    487 +n ‚â§ 10‚Åµ (most problems)
    2859 +1428     -    488 +n ‚â§ 10¬≥ (allows O(n¬≤))
    2860 +1429     -    489 +n ‚â§ 10‚Å¥ (O(n¬≤) risky)
    2861 +1430     -    490 +Values: -10‚Åπ to 10‚Åπ (fits in int)
    2862 +1431     -    491 +
    2863 +1432     -    492 +// Time limit: Usually generous
    2864 +1433     -    493 +// Memory: 256 MB typical
    2865 +1434     -    494 +
    2866 +1435     -    495 +// Fast I/O not needed (uses function calls)
    2867 +1436     -    496 +```
    2868 +1437     -    497 +
    2869 +1438     -    498 +### Codeforces
    2870 +1439     -    499 +
    2871 +1440     -    500 +```cpp
    2872 +1441     -    501 +// Typical constraints
    2873 +1442     -    502 +n ‚â§ 2 √ó 10‚Åµ (common)
    2874 +1443     -    503 +n ‚â§ 10‚Å∂ (harder problems)
    2875 +1444     -    504 +Time: 1-2 seconds
    2876 +1445     -    505 +Memory: 256 MB (standard)
    2877 +1446     -    506 +
    2878 +1447     -    507 +// Fast I/O REQUIRED for large input
    2879 +1448     -    508 +ios::sync_with_stdio(false);
    2880 +1449     -    509 +cin.tie(nullptr);
    2881 +1450     -    510 +```
    2882 +1451     -    511 +
    2883 +1452     -    512 +### HackerRank
    2884 +1453     -    513 +
    2885 +1454     -    514 +```cpp
    2886 +1455     -    515 +// Varies by problem
    2887 +1456     -    516 +// Often has multiple test cases
    2888 +1457     -    517 +// Time limits can be strict
    2889 +1458     -    518 +// Fast I/O recommended
    2890 +1459     -    519 +
    2891 +1460     -    520 +// Multiple test cases pattern
    2892 +1461     -    521 +int t;
    2893 +1462     -    522 +cin >> t;
    2894 +1463     -    523 +while (t--) {
    2895 +1464     -    524 +    // solve
    2896 +1465     -    525 +}
    2897 +1466     -    526 +```
    2898 +1467     -    527 +
    2899 +1468     -    528 +### Google/FAANG Interviews
    2900 +1469     -    529 +
    2901 +1470     -    530 +```cpp
    2902 +1471     -    531 +// Focus on:
    2903 +1472     -    532 +- Optimal time complexity
    2904 +1473     -    533 +- Clean, readable code
    2905 +1474     -    534 +- Handle all edge cases
    2906 +1475     -    535 +- Discuss trade-offs
    2907 +1476     -    536 +
    2908 +1477     -    537 +// Typical expectations:
    2909 +1478     -    538 +n ‚â§ 10‚Åµ to 10‚Å∂
    2910 +1479     -    539 +Time: O(n) or O(n log n)
    2911 +1480     -    540 +Space: O(1) to O(n)
    2912 +1481     -    541 +```
    2913 +1482     -    542 +
    2914 +1483     -    543 +---
    2915 +1484     -    544 +
    2916 +1485     -    545 +## üìã Quick Reference Cheatsheet
    2917 +1486     -    546 +
    2918 +1487     -    547 +### Numbers to Memorize
    2919 +1488     -    548 +
    2920 +1489     -    549 +| Value | Meaning | Use Case |
    2921 +1490     -    550 +|-------|---------|----------|
    2922 +1491     -    551 +| 10‚Åπ | ~INT_MAX / 2 | Safe int limit |
    2923 +1492     -    552 +| 2 √ó 10‚Åπ | ~INT_MAX | Max positive int |
    2924 +1493     -    553 +| 10¬π‚Å∏ | ~LLONG_MAX / 9 | Safe long long |
    2925 +1494     -    554 +| 10‚Åπ + 7 | Common modulo | Modular arithmetic |
    2926 +1495     -    555 +| 10‚Åµ | Typical n limit | O(n log n) problems |
    2927 +1496     -    556 +| 10‚Å¥ | O(n¬≤) threshold | When O(n¬≤) is OK |
    2928 +1497     -    557 +| 20-25 | 2‚Åø threshold | Bitmask/subset problems |
    2929 +1498     -    558 +| 10 | n! threshold | Permutation problems |
    2930 +1499     -    559 +
    2931 +1500     -    560 +### Quick Type Selection
    2932 +1501     -    561 +
    2933 +1502     -    562 +```cpp
    2934 +1503     -    563 +// Default
    2935 +1504     -    564 +int x;                  // Values ‚â§ 10‚Åπ
    2936 +1505     -    565 +
    2937 +1506     -    566 +// Large values
    2938 +1507     -    567 +long long x;           // Values > 2√ó10‚Åπ
    2939 +1508     -    568 +
    2940 +1509     -    569 +// Large sums
    2941 +1510     -    570 +long long sum = 0;     // Sum of many ints
    2942 +1511     -    571 +
    2943 +1512     -    572 +// Products
    2944 +1513     -    573 +long long prod = 1LL * a * b;  // Multiply ints
    2945 +1514     -    574 +
    2946 +1515     -    575 +// Modular
    2947 +1516     -    576 +const int MOD = 1e9 + 7;
    2948 +1517     -    577 +((1LL * a * b) % MOD)
    2949 +1518     -    578 +```
    2950 +1519     -    579 +
    2951 +1520     -    580 +### Fast I/O Template
    2952 +1521     -    581 +
    2953 +1522     -    582 +```cpp
    2954 +1523     -    583 +#include <bits/stdc++.h>
    2955 +1524     -    584 +using namespace std;
    2956 +1525     -    585 +
    2957 +1526     -    586 +int main() {
    2958 +1527     -    587 +    ios::sync_with_stdio(false);
    2959 +1528     -    588 +    cin.tie(nullptr);
    2960 +1529     -    589 +
    2961 +1530     -    590 +    // Your code here
    2962 +1531     -    591 +
    2963 +1532     -    592 +    return 0;
    2964 +1533     -    593 +}
    2965 +1534     -    594 +```
    2966 +1535     -    595 +
    2967 +1536     -    596 +### Infinity Values
    2968 +1537     -    597 +
    2969 +1538     -    598 +```cpp
    2970 +1539     -    599 +// For shortest path, DP
    2971 +1540     -    600 +const int INF = 1e9;           // int infinity
    2972 +1541     -    601 +const long long INF = 1e18;    // long long infinity
    2973 +1542     -    602 +
    2974 +1543     -    603 +// For comparisons (safe for addition)
    2975 +1544     -    604 +const int INF = INT_MAX / 2;
    2976 +1545     -    605 +const long long INF = LLONG_MAX / 2;
    2977 +1546     -    606 +```
    2978 +1547     -    607 +
    2979 +1548     -    608 +---
    2980 +1549     -    609 +
    2981 +1550     -    610 +## üéØ Interview Tips
    2982 +1551     -    611 +
    2983 +1552     -    612 +1. **Always ask for constraints first** - Determines algorithm choice
    2984 +1553     -    613 +2. **State assumptions explicitly** - "I'm assuming n ‚â§ 10‚Åµ"
    2985 +1554     -    614 +3. **Check for overflow** - Especially with multiplication and sums
    2986 +1555     -    615 +4. **Use appropriate data types** - `long long` when in doubt
    2987 +1556     -    616 +5. **Test edge cases mentally** - Before coding, walk through edge cases
    2988 +1557     -    617 +6. **Know your constants** - INT_MAX, 10‚Åπ+7, complexity thresholds
    2989 +1558     -    618 +
    2990 +1559     -    619 +---
    2991 +1560     -    620 +
    2992 +1561     -    621 +*Last Updated: December 19, 2025*
    2993 +1562     -    622  
    2994 +    1456 +    117 +*   **Why?** It is technically robust, legally safest (clean separation of domestic vs international funds), and offers the best user experience.
    2995 +    1457 +    118 +*   **Cost:** $0.
    2996 +    1458 +    119 +*   **Effort:** ~1 hour to write the HTML/JS for the landing page.
    2997 +    1459 +    120 +
    2998 +    1460 +    121 +### Sample Code Snippet (Concept)
    2999 +    1461 +    122 +```javascript
    3000 +    1462 +    123 +async function renderDonationOptions() {
    3001 +    1463 +    124 +  const response = await fetch('https://ipapi.co/json/');
    3002 +    1464 +    125 +  const data = await response.json();
    3003 +    1465 +    126 +
    3004 +    1466 +    127 +  if (data.country_code === 'IN') {
    3005 +    1467 +    128 +    // Show Razorpay UI
    3006 +    1468 +    129 +    document.getElementById('currency').innerText = 'INR';
    3007 +    1469 +    130 +    document.getElementById('presets').innerHTML =
    3008 +    1470 +    131 +      '<button>‚Çπ50</button><button>‚Çπ100</button>';
    3009 +    1471 +    132 +    document.getElementById('payment-link').href = 'https://rzp.io/l/your-link';
    3010 +    1472 +    133 +  } else {
    3011 +    1473 +    134 +    // Show PayPal/Ko-fi UI
    3012 +    1474 +    135 +    document.getElementById('currency').innerText = 'USD';
    3013 +    1475 +    136 +    document.getElementById('presets').innerHTML =
    3014 +    1476 +    137 +      '<button>$1</button><button>$5</button>';
    3015 +    1477 +    138 +    document.getElementById('payment-link').href = 'https://ko-fi.com/your-id';
    3016 +    1478 +    139 +  }
    3017 +    1479 +    140 +}
    3018 +    1480 +    141 +```
    3019 +    1481 +    142  
    3020 +    1482 +
    3021 +    1483 +```
    3022 +    1484 +
    3023 +    1485 +
    3024 +    1486 +### ‚ú® `docs/01-requirements/donation_technical_feasibility_review.md` **[ADDED]**
    3025 +    1487 +
    3026 +    1488 +**Status:** ‚úÖ **NEW FILE** - This file has been newly created
    3027 +    1489 +
    3028 +    1490 +**Type:** Documentation üìñ
    3029 +    1491 +
    3030 +    1492 +```diff
    3031 +    1493 +@@ -0,0 +1,87 @@
    3032 +    1494 +      1 +# Technical & Feasibility Review: Donation Feature Plan v2.0
    3033 +    1495 +      2 +
    3034 +    1496 +      3 +**Reviewer:** Senior Principal SDE, Platform Engineering
    3035 +    1497 +      4 +**Date:** 2025-12-19
    3036 +    1498 +      5 +**Scope:** Strict Technical, Scalability, and Feasibility Audit
    3037 +    1499 +      6 +**Target Document:** `docs/01-requirements/donation-feature-plan.md`
    3038 +    1500 +      7 +
    3039 +    1501 +      8 +---
    3040 +    1502 +      9 +
    3041 +    1503 +     10 +## 1. Executive Summary
    3042 +    1504 +     11 +
    3043 +    1505 +     12 +The proposed "Static Badge Approach" (Phase 2) is **Technically Sound** and **Highly Scalable**. However, the optional "IP-based Smart Routing" (Phase 3) introduces significant **Hidden Technical Debt** and **Failure Modes** that are not adequately addressed in the current plan.
    3044 +    1506 +     13 +
    3045 +    1507 +     14 +**Verdict:**
    3046 +    1508 +     15 +*   **Static Badges (README):** ‚úÖ **APPROVED**. (Rating: Low Risk, High Value)
    3047 +    1509 +     16 +*   **Smart Routing (Web App):** ‚ö†Ô∏è **CONDITIONAL APPROVAL**. (Rating: Medium Risk, Maintenance Burden)
    3048 +    1510 +     17 +
    3049 +    1511 +     18 +---
    3050 +    1512 +     19 +
    3051 +    1513 +     20 +## 2. Critical Technical Concerns (Bugs & Scalability)
    3052 +    1514 +     21 +
    3053 +    1515 +     22 +### 2.1 The "Free API" Trap (Scalability Risk)
    3054 +    1516 +     23 +*   **Concern:** The design suggests using `ipapi.co` (Free Tier).
    3055 +    1517 +     24 +*   **Risk:** Free tiers have rate limits (e.g., 1000 requests/day). If the app (or even the GitHub page if JS is used) goes viral or gets crawled by bots, the API will return `429 Too Many Requests`.
    3056 +    1518 +     25 +*   **Failure Mode:** The "Donate" button logic fails; users might see *nothing* or a broken spinner.
    3057 +    1519 +     26 +*   **Mitigation:** Must implement a **Fail-Open Strategy**. If the API fails/timeouts, DEFAULT to the Global (USD/PayPal) view immediately. Do not block rendering.
    3058 +    1520 +     27 +
    3059 +    1521 +     28 +### 2.2 Razorpay International Friction (UX Bug)
    3060 +    1522 +     29 +*   **Concern:** Routing *all* Indian IPs to Razorpay assumes Razorpay accepts *all* payments smoothly.
    3061 +    1523 +     30 +*   **Bug:** While Razorpay handles domestic UPI perfectly, international cards (e.g., an NRI relative visiting India, or a user on a corporate VPN routing through Bangalore) often face high failure rates on Razorpay unless "International Payments" is explicitly enabled and KYC'd (which is harder for individuals).
    3062 +    1524 +     31 +*   **Impact:** A user willing to pay $50 via Amex might bounce because Razorpay declines non-Indian issued cards on personal accounts.
    3063 +    1525 +     32 +
    3064 +    1526 +     33 +### 2.3 The "VPN Paradox" (Edge Case)
    3065 +    1527 +     34 +*   **Scenario:** A user in the US uses a VPN to India (to watch Hotstar, etc.) and visits your repo.
    3066 +    1528 +     35 +*   **Result:** They see "UPI/‚Çπ". They don't have UPI. They leave.
    3067 +    1529 +     36 +*   **Fix:** The UI **MUST** provide a "Not in India?" toggle or "Show International Options" link even if IP detection says India. **Never soft-lock a user into a geographically assumed payment method.**
    3068 +    1530 +     37 +
    3069 +    1531 +     38 +---
    3070 +    1532 +     39 +
    3071 +    1533 +     40 +## 3. Maintenance & Long-term Viability Analysis
    3072 +    1534 +     41 +
    3073 +    1535 +     42 +### 3.1 Link Rot & Platform Decay
    3074 +    1536 +     43 +*   **Observation:** Startups (like Ko-fi or BMAC) change terms or get acquired.
    3075 +    1537 +     44 +*   **Recommendation:** Use a **Redirect Service** or reliable URL shortener (e.g., `yoursite.com/go/donate-inr`) instead of hardcoding `razorpay.me/...` directly in 100 source files. This allows you to switch from Razorpay to LemonSqueezy tomorrow without a PR.
    3076 +    1538 +     45 +
    3077 +    1539 +     46 +### 3.2 GitHub Sponsors Approval Latency
    3078 +    1540 +     47 +*   **Reality Check:** GitHub Sponsors is not instant. It can take 2-4 weeks for approval.
    3079 +    1541 +     48 +*   **Blocker:** If you deploy the badge before approval, users see a "404" or "Not Enabled" page.
    3080 +    1542 +     49 +*   **Correction:** Phase 2 must explicitly state: "Deploy GitHub Sponsors badge *only after* approval email is received."
    3081 +    1543 +     50 +
    3082 +    1544 +     51 +---
    3083 +    1545 +     52 +
    3084 +    1546 +     53 +## 4. Strict "Principle SDE" Recommendations
    3085 +    1547 +     54 +
    3086 +    1548 +     55 +To elevate this plan to Enterprise Grade:
    3087 +    1549 +     56 +
    3088 +    1550 +     57 +1.  **Enforce "Fail-Safe" Default:**
    3089 +    1551 +     58 +    - The code structure for Phase 3 must be:
    3090 +    1552 +     59 +      ```javascript
    3091 +    1553 +     60 +      // DEFAULT: Global
    3092 +    1554 +     61 +      let showInd = false;
    3093 +    1555 +     62 +      try {
    3094 +    1556 +     63 +         // Race condition: Timeout after 300ms. Don't let a slow IP API slow down the footer.
    3095 +    1557 +     64 +         const data = await Promise.race([fetchIP(), timeout(300)]);
    3096 +    1558 +     65 +         if (data.country === 'IN') showInd = true;
    3097 +    1559 +     66 +      } catch (e) {
    3098 +    1560 +     67 +         // Silently fail to Global
    3099 +    1561 +     68 +      }
    3100 +    1562 +     69 +      ```
    3101 +    1563 +     70 +
    3102 +    1564 +     71 +2.  **Taxonomy cleanup:**
    3103 +    1565 +     72 +    - Stop using the word "Donation" anywhere visible if you are not an 80G registered Non-Profit.
    3104 +    1566 +     73 +    - Use **"Sponsorship"** or **"Support"** exclusively. This is a legal safeguards against "Misleading Claims" (Consumer Protection Act).
    3105 +    1567 +     74 +
    3106 +    1568 +     75 +3.  **Data Minimization:**
    3107 +    1569 +     76 +    - Ensure the IP Geo-lookup is *client-side only* (browser calls API directly). Do not proxy this through your own backend unless you want to deal with GDPR/CCPA compliance for logging user IPs.
    3108 +    1570 +     77 +
    3109 +    1571 +     78 +---
    3110 +    1572 +     79 +
    3111 +    1573 +     80 +## 5. Revised Implementation Roadmap
    3112 +    1574 +     81 +
    3113 +    1575 +     82 +**Step 1:** Add **Static Badges** (Ko-fi & Razorpay) to `README.md` immediately.
    3114 +    1576 +     83 +**Step 2:** Apply for GitHub Sponsors (Wait list).
    3115 +    1577 +     84 +**Step 3:** (Low Priority) Add Smart Routing to Web App **only if** you can guarantee <300ms latency and fail-safe defaults.
    3116 +    1578 +     85 +
    3117 +    1579 +     86 +**Signed-off with Conditions.**
    3118 +    1580 +     87 +*Sr. Principal SDE, Infrastructure*
    3119 +    1581 +     88  
    3120 +    1582 +
    3121 +    1583 +```
    3122 +    1584 +
    3123 +    1585 +
    3124 +    1586 +### üìÑ `index.html`
    3125 +    1587 +
    3126 +    1588 +**Type:** HTML Template üåê
    3127 +    1589 +
    3128 +    1590 +```diff
    3129 +    1591 +@@ -337,12 +337,22 @@
    3130 +    1592 +337 337  
    3131 +    1593 +338 338      <!-- Footer -->
    3132 +    1594 +339 339      <footer class="app-footer">
    3133 +    1595 +340     -      Made with ‚ù§Ô∏è by Prax Lannister | Follow me on
    3134 +    1596 +341     -      <a href="https://github.com/PrakharMNNIT" target="_blank" rel="noopener noreferrer">GitHub</a>
    3135 +    1597 +342     -      &
    3136 +    1598 +343     -      <a href="https://x.com/ByteByByteSrSDE" target="_blank" rel="noopener noreferrer"
    3137 +    1599 +344     -        >X (Twitter)</a
    3138 +    1600 +345     -      >
    3139 +    1601 +    340 +      <div class="footer-content">
    3140 +    1602 +    341 +        <span>Made with ‚ù§Ô∏è by Prax Lannister</span>
    3141 +    1603 +    342 +        <span class="footer-separator">|</span>
    3142 +    1604 +    343 +        <span>Follow me on
    3143 +    1605 +    344 +          <a href="https://github.com/PrakharMNNIT" target="_blank" rel="noopener noreferrer">GitHub</a>
    3144 +    1606 +    345 +          &amp;
    3145 +    1607 +    346 +          <a href="https://x.com/ByteByByteSrSDE" target="_blank" rel="noopener noreferrer">X (Twitter)</a>
    3146 +    1608 +    347 +        </span>
    3147 +    1609 +    348 +        <span class="footer-separator">|</span>
    3148 +    1610 +    349 +        <div class="support-widget-container" id="support-widget">
    3149 +    1611 +    350 +          <!-- Skeleton loader - will be replaced by JS -->
    3150 +    1612 +    351 +          <a href="https://ko-fi.com/praxlannister?ref=webapp_footer" target="_blank" rel="noopener noreferrer" class="support-button support-button--loading">
    3151 +    1613 +    352 +            ‚òï Support
    3152 +    1614 +    353 +          </a>
    3153 +    1615 +    354 +        </div>
    3154 +    1616 +    355 +      </div>
    3155 +    1617 +346 356      </footer>
    3156 +    1618 +347 357  
    3157 +    1619 +348 358      <!-- PDF Preview Modal -->
    3158 +    1620 +349 359  
    3159 +1563 1621  
    3160 +1564 1622  ```
    3161 +1565 1623  
    3162 +@@ -1569,290 +1627,128 @@
    3163 +1569 1627  **Type:** JavaScript Source File üü®
    3164 +1570 1628  
    3165 +1571 1629  ```diff
    3166 +1572     -@@ -29,6 +29,242 @@ window.katex = katex;
    3167 +1573     - 29  29  window.html2pdf = html2pdf;
    3168 +1574     - 30  30  window.markedFootnote = markedFootnote;
    3169 +1575     - 31  31  
    3170 +1576     -     32 +// ==================== ANCHOR NAVIGATION ====================
    3171 +1577     -     33 +// Heading slug tracking (module-level singleton for marked.js singleton)
    3172 +1578     -     34 +const headingSlugMap = new Map();
    3173 +1579     -     35 +
    3174 +1580     -     36 +// Pre-compiled slug replacements (zero GC pressure per render)
    3175 +1581     -     37 +const SLUG_REPLACEMENTS = [
    3176 +1582     -     38 +  [/c\+\+/gi, 'cpp'],
    3177 +1583     -     39 +  [/c#/gi, 'csharp'],
    3178 +1584     -     40 +  [/f#/gi, 'fsharp'],
    3179 +1585     -     41 +  [/\.net/gi, 'dotnet'],
    3180 +1586     -     42 +];
    3181 +1587     -     43 +
    3182 +1588     -     44 +/**
    3183 +1589     -     45 + * Reset slug map (call before each parse)
    3184 +1590     -     46 + */
    3185 +1591     -     47 +function resetSlugMap() {
    3186 +1592     -     48 +  headingSlugMap.clear();
    3187 +1593     -     49 +}
    3188 +1594     -     50 +
    3189 +1595     -     51 +/**
    3190 +1596     -     52 + * Generate URL-safe slug from heading text
    3191 +1597     -     53 + * @param {string} text - Raw heading text (may include HTML)
    3192 +1598     -     54 + * @param {Map<string, number>} seen - Duplicate tracking map
    3193 +1599     -     55 + * @returns {string} URL-safe slug
    3194 +1600     -     56 + */
    3195 +1601     -     57 +function generateSlug(text, seen = headingSlugMap) {
    3196 +1602     -     58 +  // Strip HTML tags
    3197 +1603     -     59 +  let slug = text.replace(/<[^>]*>/g, '');
    3198 +1604     -     60 +
    3199 +1605     -     61 +  // Normalize Unicode
    3200 +1606     -     62 +  slug = slug.normalize('NFC').toLowerCase();
    3201 +1607     -     63 +
    3202 +1608     -     64 +  // Replace programming terms (pre-compiled patterns)
    3203 +1609     -     65 +  for (const [pattern, replacement] of SLUG_REPLACEMENTS) {
    3204 +1610     -     66 +    slug = slug.replace(pattern, replacement);
    3205 +1611     -     67 +  }
    3206 +1612     -     68 +
    3207 +1613     -     69 +  // Clean up: remove non-word chars, spaces to hyphens, collapse hyphens
    3208 +1614     -     70 +  slug = slug
    3209 +1615     -     71 +    .replace(/[^\w\s-]/g, '')
    3210 +1616     -     72 +    .replace(/\s+/g, '-')
    3211 +1617     -     73 +    .replace(/-+/g, '-')
    3212 +1618     -     74 +    .replace(/^-+|-+$/g, '');
    3213 +1619     -     75 +
    3214 +1620     -     76 +  // Fallback for empty result
    3215 +1621     -     77 +  if (!slug) slug = 'section';
    3216 +1622     -     78 +
    3217 +1623     -     79 +  // Handle duplicates (header, header-1, header-2)
    3218 +1624     -     80 +  const baseSlug = slug;
    3219 +1625     -     81 +  const count = seen.get(baseSlug) || 0;
    3220 +1626     -     82 +  if (count > 0) slug = `${baseSlug}-${count}`;
    3221 +1627     -     83 +  seen.set(baseSlug, count + 1);
    3222 +1628     -     84 +
    3223 +1629     -     85 +  return slug;
    3224 +1630     -     86 +}
    3225 +1631     -     87 +
    3226 +1632     -     88 +/**
    3227 +1633     -     89 + * Anchor Navigation Module
    3228 +1634     -     90 + * Handles in-document anchor navigation with scoped selection
    3229 +1635     -     91 + */
    3230 +1636     -     92 +const AnchorNavigation = {
    3231 +1637     -     93 +  container: null,
    3232 +1638     -     94 +  pendingScroll: null,
    3233 +1639     -     95 +
    3234 +1640     -     96 +  /**
    3235 +1641     -     97 +   * Initialize anchor navigation
    3236 +1642     -     98 +   * @param {HTMLElement} previewContainer - Scrollable preview container
    3237 +1643     -     99 +   */
    3238 +1644     -    100 +  init(previewContainer) {
    3239 +1645     -    101 +    this.container = previewContainer;
    3240 +1646     -    102 +
    3241 +1647     -    103 +    // Event delegation for anchor clicks
    3242 +1648     -    104 +    this.container.addEventListener('click', this.handleClick.bind(this));
    3243 +1649     -    105 +
    3244 +1650     -    106 +    // Browser back/forward navigation
    3245 +1651     -    107 +    window.addEventListener('hashchange', this.handleHashChange.bind(this));
    3246 +1652     -    108 +
    3247 +1653     -    109 +    // Initial page load with hash
    3248 +1654     -    110 +    if (window.location.hash) {
    3249 +1655     -    111 +      requestAnimationFrame(() => {
    3250 +1656     -    112 +        this.scrollToHash(window.location.hash.slice(1), false);
    3251 +1657     -    113 +      });
    3252 +1658     -    114 +    }
    3253 +1659     -    115 +
    3254 +1660     -    116 +    console.log('‚úÖ Anchor navigation initialized');
    3255 +1661     -    117 +  },
    3256 +1662     -    118 +
    3257 +1663     -    119 +  /**
    3258 +1664     -    120 +   * Handle click events (delegated)
    3259 +1665     -    121 +   */
    3260 +1666     -    122 +  handleClick(event) {
    3261 +1667     -    123 +    const link = event.target.closest('a[href^="#"]');
    3262 +1668     -    124 +    if (!link) return;
    3263 +1669     -    125 +
    3264 +1670     -    126 +    // Ignore external links
    3265 +1671     -    127 +    if (link.hostname && link.hostname !== window.location.hostname) return;
    3266 +1672     -    128 +
    3267 +1673     -    129 +    event.preventDefault();
    3268 +1674     -    130 +
    3269 +1675     -    131 +    const hash = link.getAttribute('href').slice(1);
    3270 +1676     -    132 +    this.scrollToHash(hash, true);
    3271 +1677     -    133 +
    3272 +1678     -    134 +    // Update URL without triggering hashchange
    3273 +1679     -    135 +    history.pushState(null, '', `#${hash}`);
    3274 +1680     -    136 +  },
    3275 +1681     -    137 +
    3276 +1682     -    138 +  /**
    3277 +1683     -    139 +   * Handle hashchange (browser back/forward)
    3278 +1684     -    140 +   */
    3279 +1685     -    141 +  handleHashChange() {
    3280 +1686     -    142 +    const hash = window.location.hash.slice(1);
    3281 +1687     -    143 +    if (hash) {
    3282 +1688     -    144 +      this.scrollToHash(hash, true);
    3283 +1689     -    145 +    } else {
    3284 +1690     -    146 +      this.scrollToTop(true);
    3285 +1691     -    147 +    }
    3286 +1692     -    148 +  },
    3287 +1693     -    149 +
    3288 +1694     -    150 +  /**
    3289 +1695     -    151 +   * Scroll to element by hash
    3290 +1696     -    152 +   * @param {string} hash - URL hash (without #)
    3291 +1697     -    153 +   * @param {boolean} smooth - Use smooth scrolling
    3292 +1698     -    154 +   */
    3293 +1699     -    155 +  scrollToHash(hash, smooth = true) {
    3294 +1700     -    156 +    // Cancel pending scroll (handle concurrent clicks)
    3295 +1701     -    157 +    if (this.pendingScroll) {
    3296 +1702     -    158 +      clearTimeout(this.pendingScroll);
    3297 +1703     -    159 +      this.pendingScroll = null;
    3298 +1704     -    160 +    }
    3299 +1705     -    161 +
    3300 +1706     -    162 +    if (!hash) {
    3301 +1707     -    163 +      this.scrollToTop(smooth);
    3302 +1708     -    164 +      return;
    3303 +1709     -    165 +    }
    3304 +1710     -    166 +
    3305 +1711     -    167 +    const target = this.resolveTarget(hash);
    3306 +1712     -    168 +    if (!target) return;
    3307 +1713     -    169 +
    3308 +1714     -    170 +    target.scrollIntoView({
    3309 +1715     -    171 +      behavior: smooth ? 'smooth' : 'instant',
    3310 +1716     -    172 +      block: 'start',
    3311 +1717     -    173 +    });
    3312 +1718     -    174 +
    3313 +1719     -    175 +    this.manageFocus(target, smooth);
    3314 +1720     -    176 +  },
    3315 +1721     -    177 +
    3316 +1722     -    178 +  /**
    3317 +1723     -    179 +   * Scroll to top of container
    3318 +1724     -    180 +   */
    3319 +1725     -    181 +  scrollToTop(smooth = true) {
    3320 +1726     -    182 +    this.container.scrollTo({
    3321 +1727     -    183 +      top: 0,
    3322 +1728     -    184 +      behavior: smooth ? 'smooth' : 'instant',
    3323 +1729     -    185 +    });
    3324 +1730     -    186 +  },
    3325 +1731     -    187 +
    3326 +1732     -    188 +  /**
    3327 +1733     -    189 +   * Resolve target element - SCOPED to container (prevents app shell collision)
    3328 +1734     -    190 +   * @param {string} hash - URL hash
    3329 +1735     -    191 +   * @returns {Element|null} Target element or null
    3330 +1736     -    192 +   */
    3331 +1737     -    193 +  resolveTarget(hash) {
    3332 +1738     -    194 +    if (!hash) return null;
    3333 +1739     -    195 +
    3334 +1740     -    196 +    // Decode URI components safely
    3335 +1741     -    197 +    let decodedHash;
    3336 +1742     -    198 +    try {
    3337 +1743     -    199 +      decodedHash = decodeURIComponent(hash);
    3338 +1744     -    200 +    } catch {
    3339 +1745     -    201 +      decodedHash = hash;
    3340 +1746     -    202 +    }
    3341 +1747     -    203 +
    3342 +1748     -    204 +    // Priority 1: Exact ID (SCOPED to container)
    3343 +1749     -    205 +    let target = this.container.querySelector(`#${CSS.escape(decodedHash)}`);
    3344 +1750     -    206 +    if (target) return target;
    3345 +1751     -    207 +
    3346 +1752     -    208 +    // Priority 2: Normalized ID (handles legacy links with emoji, special chars)
    3347 +1753     -    209 +    const normalized = this.normalizeHash(decodedHash);
    3348 +1754     -    210 +    target = this.container.querySelector(`#${CSS.escape(normalized)}`);
    3349 +1755     -    211 +    if (target) return target;
    3350 +1756     -    212 +
    3351 +1757     -    213 +    console.warn(`[AnchorNav] Target not found: "${hash}"`);
    3352 +1758     -    214 +    return null;
    3353 +1759     -    215 +  },
    3354 +1760     -    216 +
    3355 +1761     -    217 +  /**
    3356 +1762     -    218 +   * Normalize hash for legacy link matching
    3357 +1763     -    219 +   * @param {string} hash - Raw hash string
    3358 +1764     -    220 +   * @returns {string} Normalized hash
    3359 +1765     -    221 +   */
    3360 +1766     -    222 +  normalizeHash(hash) {
    3361 +1767     -    223 +    let slug = hash.normalize('NFC').toLowerCase();
    3362 +1768     -    224 +
    3363 +1769     -    225 +    // Apply same transformations as generateSlug
    3364 +1770     -    226 +    for (const [pattern, replacement] of SLUG_REPLACEMENTS) {
    3365 +1771     -    227 +      slug = slug.replace(pattern, replacement);
    3366 +1772     -    228 +    }
    3367 +1773     -    229 +
    3368 +1774     -    230 +    return slug
    3369 +1775     -    231 +      .replace(/[^\w\s-]/g, '')
    3370 +1776     -    232 +      .replace(/\s+/g, '-')
    3371 +1777     -    233 +      .replace(/-+/g, '-')
    3372 +1778     -    234 +      .replace(/^-+|-+$/g, '') || 'section';
    3373 +1779     -    235 +  },
    3374 +1780     -    236 +
    3375 +1781     -    237 +  /**
    3376 +1782     -    238 +   * Manage focus after scroll (accessibility)
    3377 +1783     -    239 +   * @param {Element} target - Target element
    3378 +1784     -    240 +   * @param {boolean} smooth - Was smooth scroll used
    3379 +1785     -    241 +   */
    3380 +1786     -    242 +  manageFocus(target, smooth) {
    3381 +1787     -    243 +    const focusTarget = () => {
    3382 +1788     -    244 +      // Make heading focusable if not already
    3383 +1789     -    245 +      if (!target.hasAttribute('tabindex')) {
    3384 +1790     -    246 +        target.setAttribute('tabindex', '-1');
    3385 +1791     -    247 +      }
    3386 +1792     -    248 +      target.focus({ preventScroll: true });
    3387 +1793     -    249 +    };
    3388 +1794     -    250 +
    3389 +1795     -    251 +    if (!smooth) {
    3390 +1796     -    252 +      focusTarget();
    3391 +1797     -    253 +      return;
    3392 +1798     -    254 +    }
    3393 +1799     -    255 +
    3394 +1800     -    256 +    // Modern browsers: use scrollend event
    3395 +1801     -    257 +    if ('onscrollend' in this.container) {
    3396 +1802     -    258 +      this.container.addEventListener('scrollend', focusTarget, { once: true });
    3397 +1803     -    259 +    } else {
    3398 +1804     -    260 +      // Fallback: estimate scroll duration (max 1000ms for safety)
    3399 +1805     -    261 +      const distance = Math.abs(target.getBoundingClientRect().top);
    3400 +1806     -    262 +      const duration = Math.min(Math.max(distance / 2, 300), 1000);
    3401 +1807     -    263 +      this.pendingScroll = setTimeout(focusTarget, duration + 50);
    3402 +1808     -    264 +    }
    3403 +1809     -    265 +  },
    3404 +1810     -    266 +};
    3405 +1811     -    267 +
    3406 +1812     - 32 268  // Initialize services and managers
    3407 +1813     - 33 269  const storageManager = new StorageManager();
    3408 +1814     - 34 270  const themeManager = new ThemeManager(storageManager);
    3409 +1815     -@@ -360,6 +596,19 @@ function configureMarkedExtensions() {
    3410 +1816     -360 596    });
    3411 +1817     -361 597  
    3412 +1818     -362 598    console.log('‚úÖ Marked.js configured with all extensions (LaTeX, subscript, superscript)');
    3413 +1819     -    599 +
    3414 +1820     -    600 +  // Custom heading renderer with ID generation for anchor navigation
    3415 +1821     -    601 +  marked.use({
    3416 +1822     -    602 +    renderer: {
    3417 +1823     -    603 +      heading(token) {
    3418 +1824     -    604 +        const text = this.parser.parseInline(token.tokens);
    3419 +1825     -    605 +        const level = token.depth;
    3420 +1826     -    606 +        const slug = generateSlug(text, headingSlugMap);
    3421 +1827     -    607 +        return `<h${level} id="${slug}">${text}</h${level}>\n`;
    3422 +1828     -    608 +      }
    3423 +1829     -    609 +    }
    3424 +1830     -    610 +  });
    3425 +1831     -    611 +  console.log('‚úÖ Custom heading renderer enabled (anchor navigation IDs)');
    3426 +1832     -363 612  }
    3427 +1833     -364 613  
    3428 +1834     -365 614  // Initialize Mermaid using MermaidService (prefixed to indicate future use)
    3429 +1835     -@@ -550,6 +799,9 @@ graph TD
    3430 +1836     -550 799    // Render markdown (expose globally for theme changes)
    3431 +1837     -551 800    function renderMarkdown() {
    3432 +1838     -552 801      try {
    3433 +1839     -    802 +      // Reset slug map before parsing (singleton-safe pattern)
    3434 +1840     -    803 +      resetSlugMap();
    3435 +1841     -    804 +
    3436 +1842     -553 805        const markdownText = editor.value;
    3437 +1843     -554 806  
    3438 +1844     -555 807        // Parse markdown with all extensions
    3439 +1845     -@@ -2001,6 +2253,9 @@ Wrap up your thoughts and include a call to action.
    3440 +1846     -2001 2253    // Initialize expand button visibility on load
    3441 +1847     -2002 2254    updateExpandButtonVisibility();
    3442 +1848     -2003 2255  
    3443 +1849     -    2256 +  // Initialize anchor navigation for TOC links
    3444 +1850     -    2257 +  AnchorNavigation.init(previewContainer);
    3445 +1851     -    2258 +
    3446 +1852     -2004 2259    // DON'T render immediately - wait for theme to load
    3447 +1853     -2005 2260    // renderMarkdown will be called after theme loads above
    3448 +1854     -2006 2261  }
    3449 +1855     -2007 2262  
    3450 +    1630 +@@ -351,6 +351,120 @@ function initializeApp() {
    3451 +    1631 +351 351  
    3452 +    1632 +352 352    // Setup the editor
    3453 +    1633 +353 353    setupEditor();
    3454 +    1634 +    354 +
    3455 +    1635 +    355 +  // Initialize support widget (donation button in footer)
    3456 +    1636 +    356 +  initSupportWidget();
    3457 +    1637 +    357 +}
    3458 +    1638 +    358 +
    3459 +    1639 +    359 +// ==================== SUPPORT WIDGET (DONATION ROUTER) ====================
    3460 +    1640 +    360 +/**
    3461 +    1641 +    361 + * Enterprise-grade geo-based donation routing
    3462 +    1642 +    362 + * - 300ms timeout with fail-safe to global
    3463 +    1643 +    363 + * - Session caching to avoid repeated API calls
    3464 +    1644 +    364 + * - CLS mitigation via skeleton loader
    3465 +    1645 +    365 + */
    3466 +    1646 +    366 +const SUPPORT_TIMEOUT_MS = 300;
    3467 +    1647 +    367 +const SUPPORT_FALLBACK_REGION = 'global';
    3468 +    1648 +    368 +const SUPPORT_CACHE_KEY = 'support_user_region';
    3469 +    1649 +    369 +
    3470 +    1650 +    370 +/**
    3471 +    1651 +    371 + * Detect user region with fail-safe pattern
    3472 +    1652 +    372 + * @returns {Promise<string>} 'india' or 'global'
    3473 +    1653 +    373 + */
    3474 +    1654 +    374 +async function detectSupportRegion() {
    3475 +    1655 +    375 +  // 1. Check session cache first (FR-1.4)
    3476 +    1656 +    376 +  const cached = sessionStorage.getItem(SUPPORT_CACHE_KEY);
    3477 +    1657 +    377 +  if (cached) {
    3478 +    1658 +    378 +    console.log(`[SupportWidget] Using cached region: ${cached}`);
    3479 +    1659 +    379 +    return cached;
    3480 +    1660 +    380 +  }
    3481 +    1661 +    381 +
    3482 +    1662 +    382 +  try {
    3483 +    1663 +    383 +    // 2. Race: Network vs Timeout (300ms)
    3484 +    1664 +    384 +    const controller = new AbortController();
    3485 +    1665 +    385 +    const timeoutId = setTimeout(() => controller.abort(), SUPPORT_TIMEOUT_MS);
    3486 +    1666 +    386 +
    3487 +    1667 +    387 +    const response = await fetch('https://ipapi.co/json/', {
    3488 +    1668 +    388 +      signal: controller.signal,
    3489 +    1669 +    389 +    });
    3490 +    1670 +    390 +    clearTimeout(timeoutId);
    3491 +    1671 +    391 +
    3492 +    1672 +    392 +    const data = await response.json();
    3493 +    1673 +    393 +    const region = data.country_code === 'IN' ? 'india' : 'global';
    3494 +    1674 +    394 +
    3495 +    1675 +    395 +    // 3. Cache result for session
    3496 +    1676 +    396 +    sessionStorage.setItem(SUPPORT_CACHE_KEY, region);
    3497 +    1677 +    397 +    console.log(`[SupportWidget] Detected region: ${region} (${data.country_code})`);
    3498 +    1678 +    398 +    return region;
    3499 +    1679 +    399 +  } catch (error) {
    3500 +    1680 +    400 +    // 4. Fail open - silent fail to global
    3501 +    1681 +    401 +    console.warn('[SupportWidget] Geo-lookup failed/timed-out, defaulting to Global.', error.message);
    3502 +    1682 +    402 +    return SUPPORT_FALLBACK_REGION;
    3503 +    1683 +    403 +  }
    3504 +    1684 +    404 +}
    3505 +    1685 +    405 +
    3506 +    1686 +    406 +/**
    3507 +    1687 +    407 + * Toggle between India and Global support options
    3508 +    1688 +    408 + */
    3509 +    1689 +    409 +function toggleSupportRegion() {
    3510 +    1690 +    410 +  const currentRegion = sessionStorage.getItem(SUPPORT_CACHE_KEY) || SUPPORT_FALLBACK_REGION;
    3511 +    1691 +    411 +  const newRegion = currentRegion === 'india' ? 'global' : 'india';
    3512 +    1692 +    412 +  sessionStorage.setItem(SUPPORT_CACHE_KEY, newRegion);
    3513 +    1693 +    413 +  renderSupportWidget(newRegion);
    3514 +    1694 +    414 +  console.log(`[SupportWidget] Toggled region: ${currentRegion} ‚Üí ${newRegion}`);
    3515 +    1695 +    415 +}
    3516 +    1696 +    416 +
    3517 +    1697 +    417 +// Make toggle function globally accessible for onclick
    3518 +    1698 +    418 +window.toggleSupportRegion = toggleSupportRegion;
    3519 +    1699 +    419 +
    3520 +    1700 +    420 +/**
    3521 +    1701 +    421 + * Render support widget based on region
    3522 +    1702 +    422 + * @param {string} region - 'india' or 'global'
    3523 +    1703 +    423 + */
    3524 +    1704 +    424 +function renderSupportWidget(region) {
    3525 +    1705 +    425 +  const container = document.getElementById('support-widget');
    3526 +    1706 +    426 +  if (!container) return;
    3527 +    1707 +    427 +
    3528 +    1708 +    428 +  const config = region === 'india'
    3529 +    1709 +    429 +    ? {
    3530 +    1710 +    430 +      text: 'üáÆüá≥ Support via UPI',
    3531 +    1711 +    431 +      url: 'https://razorpay.me/@prakharshekharparthasarthi?notes[source]=webapp_footer',
    3532 +    1712 +    432 +      className: 'support-button--india',
    3533 +    1713 +    433 +      toggleText: 'Not in India?',
    3534 +    1714 +    434 +    }
    3535 +    1715 +    435 +    : {
    3536 +    1716 +    436 +      text: '‚òï Support via Ko-fi',
    3537 +    1717 +    437 +      url: 'https://ko-fi.com/praxlannister?ref=webapp_footer',
    3538 +    1718 +    438 +      className: 'support-button--global',
    3539 +    1719 +    439 +      toggleText: 'In India? Use UPI',
    3540 +    1720 +    440 +    };
    3541 +    1721 +    441 +
    3542 +    1722 +    442 +  container.innerHTML = `
    3543 +    1723 +    443 +    <a href="${config.url}" target="_blank" rel="noopener noreferrer" class="support-button ${config.className}">
    3544 +    1724 +    444 +      ${config.text}
    3545 +    1725 +    445 +    </a>
    3546 +    1726 +    446 +    <button class="support-toggle" onclick="toggleSupportRegion()">${config.toggleText}</button>
    3547 +    1727 +    447 +  `;
    3548 +    1728 +    448 +}
    3549 +    1729 +    449 +
    3550 +    1730 +    450 +/**
    3551 +    1731 +    451 + * Initialize support widget with skeleton loader and geo detection
    3552 +    1732 +    452 + */
    3553 +    1733 +    453 +async function initSupportWidget() {
    3554 +    1734 +    454 +  const container = document.getElementById('support-widget');
    3555 +    1735 +    455 +  if (!container) {
    3556 +    1736 +    456 +    console.warn('[SupportWidget] Container not found, skipping initialization');
    3557 +    1737 +    457 +    return;
    3558 +    1738 +    458 +  }
    3559 +    1739 +    459 +
    3560 +    1740 +    460 +  console.log('[SupportWidget] Initializing...');
    3561 +    1741 +    461 +
    3562 +    1742 +    462 +  // Skeleton is already in HTML (CLS mitigation)
    3563 +    1743 +    463 +  // Now detect region and hydrate
    3564 +    1744 +    464 +  const region = await detectSupportRegion();
    3565 +    1745 +    465 +  renderSupportWidget(region);
    3566 +    1746 +    466 +
    3567 +    1747 +    467 +  console.log(`[SupportWidget] ‚úÖ Initialized with region: ${region}`);
    3568 +    1748 +354 468  }
    3569 +    1749 +355 469  
    3570 +    1750 +356 470  /**
    3571 +    1751 +357 471  
    3572 +1856 1752  
    3573 +1857 1753  ```
    3574 +1858 1754  
    3575 +@@ -1862,100 +1758,140 @@
    3576 +1862 1758  **Type:** Stylesheet üé®
    3577 +1863 1759  
    3578 +1864 1760  ```diff
    3579 +1865     -@@ -224,6 +224,47 @@ body {
    3580 +1866     -224 224    overflow: auto;
    3581 +1867     -225 225    /* Single scrollbar for preview container */
    3582 +1868     -226 226    min-width: 200px;
    3583 +1869     -    227 +  /* Anchor Navigation - scroll offset for fixed toolbar */
    3584 +1870     -    228 +  scroll-padding-top: var(--scroll-offset, 80px);
    3585 +1871     -    229 +}
    3586 +1872     -    230 +
    3587 +1873     -    231 +/* ==================== ANCHOR NAVIGATION ==================== */
    3588 +1874     -    232 +
    3589 +1875     -    233 +/* Target highlight animation */
    3590 +1876     -    234 +.preview-container :target {
    3591 +1877     -    235 +  animation: anchor-highlight 2s ease-out;
    3592 +1878     -    236 +}
    3593 +1879     -    237 +
    3594 +1880     -    238 +@keyframes anchor-highlight {
    3595 +1881     -    239 +  0% {
    3596 +1882     -    240 +    background-color: rgba(255, 255, 0, 0.3);
    3597 +1883     -    241 +  }
    3598 +1884     -    242 +
    3599 +1885     -    243 +  100% {
    3600 +1886     -    244 +    background-color: transparent;
    3601 +1887     -    245 +  }
    3602 +1888     -    246 +}
    3603 +1889     -    247 +
    3604 +1890     -    248 +/* Focus management - hide outline for mouse clicks */
    3605 +1891     -    249 +.preview-container h1[id]:focus:not(:focus-visible),
    3606 +1892     -    250 +.preview-container h2[id]:focus:not(:focus-visible),
    3607 +1893     -    251 +.preview-container h3[id]:focus:not(:focus-visible),
    3608 +1894     -    252 +.preview-container h4[id]:focus:not(:focus-visible),
    3609 +1895     -    253 +.preview-container h5[id]:focus:not(:focus-visible),
    3610 +1896     -    254 +.preview-container h6[id]:focus:not(:focus-visible) {
    3611 +1897     -    255 +  outline: none;
    3612 +1898     -    256 +}
    3613 +1899     -    257 +
    3614 +1900     -    258 +/* Keyboard focus gets visible indicator */
    3615 +1901     -    259 +.preview-container h1[id]:focus-visible,
    3616 +1902     -    260 +.preview-container h2[id]:focus-visible,
    3617 +1903     -    261 +.preview-container h3[id]:focus-visible,
    3618 +1904     -    262 +.preview-container h4[id]:focus-visible,
    3619 +1905     -    263 +.preview-container h5[id]:focus-visible,
    3620 +1906     -    264 +.preview-container h6[id]:focus-visible {
    3621 +1907     -    265 +  outline: 2px solid var(--h1-color, #007bff);
    3622 +1908     -    266 +  outline-offset: 4px;
    3623 +1909     -    267 +  border-radius: 2px;
    3624 +1910     -227 268  }
    3625 +1911     -228 269  
    3626 +1912     -229 270  .preview-header {
    3627 +1913     -230 271  
    3628 +1914     -
    3629 +1915     -```
    3630 +1916     -
    3631 +1917     -
    3632 +1918     -### üìÑ `variables.css`
    3633 +1919     -
    3634 +1920     -**Type:** Stylesheet üé®
    3635 +1921     -
    3636 +1922     -```diff
    3637 +1923     -@@ -11,13 +11,18 @@
    3638 +1924     - 11  11    /* ==================== NEBULA DARK (Default) ==================== */
    3639 +1925     - 12  12  
    3640 +1926     - 13  13    /* Core Backgrounds */
    3641 +1927     - 14     -  --bg-universe: #050508;     /* The void */
    3642 +1928     - 15     -  --bg-element: #0f1123;      /* Solid panels if needed */
    3643 +1929     -     14 +  --bg-universe: #050508;
    3644 +1930     -     15 +  /* The void */
    3645 +1931     -     16 +  --bg-element: #0f1123;
    3646 +1932     -     17 +  /* Solid panels if needed */
    3647 +1933     - 16  18  
    3648 +1934     - 17  19    /* Glass System */
    3649 +1935     - 18     -  --bg-glass: rgba(15, 17, 35, 0.6);        /* Main panels */
    3650 +1936     - 19     -  --bg-glass-heavy: rgba(10, 12, 25, 0.85); /* Sidebar/Modals */
    3651 +1937     - 20     -  --bg-glass-light: rgba(255, 255, 255, 0.05); /* Hover states */
    3652 +1938     -     20 +  --bg-glass: rgba(15, 17, 35, 0.6);
    3653 +1939     -     21 +  /* Main panels */
    3654 +1940     -     22 +  --bg-glass-heavy: rgba(10, 12, 25, 0.85);
    3655 +1941     -     23 +  /* Sidebar/Modals */
    3656 +1942     -     24 +  --bg-glass-light: rgba(255, 255, 255, 0.05);
    3657 +1943     -     25 +  /* Hover states */
    3658 +1944     - 21  26  
    3659 +1945     - 22  27    /* Borders */
    3660 +1946     - 23  28    --border-glass: rgba(255, 255, 255, 0.08);
    3661 +1947     -@@ -44,6 +49,10 @@
    3662 +1948     - 44  49    --radius-lg: 16px;
    3663 +1949     - 45  50    --radius-md: 12px;
    3664 +1950     - 46  51    --radius-sm: 8px;
    3665 +1951     -     52 +
    3666 +1952     -     53 +  /* Anchor Navigation */
    3667 +1953     -     54 +  --scroll-padding: 20px;
    3668 +1954     -     55 +  --scroll-offset: calc(var(--header-height) + var(--scroll-padding));
    3669 +1955     - 47  56  }
    3670 +1956     - 48  57  
    3671 +1957     - 49  58  /* ==================== NEBULA LIGHT ==================== */
    3672 +1958     - 50  59  
    3673 +    1761 +@@ -789,6 +789,19 @@ body {
    3674 +    1762 +789 789    box-shadow: 0 -2px 4px rgba(0, 0, 0, 0.05);
    3675 +    1763 +790 790  }
    3676 +    1764 +791 791  
    3677 +    1765 +    792 +.footer-content {
    3678 +    1766 +    793 +  display: flex;
    3679 +    1767 +    794 +  align-items: center;
    3680 +    1768 +    795 +  justify-content: center;
    3681 +    1769 +    796 +  flex-wrap: wrap;
    3682 +    1770 +    797 +  gap: 8px;
    3683 +    1771 +    798 +}
    3684 +    1772 +    799 +
    3685 +    1773 +    800 +.footer-separator {
    3686 +    1774 +    801 +  color: var(--border-color);
    3687 +    1775 +    802 +  font-weight: 300;
    3688 +    1776 +    803 +}
    3689 +    1777 +    804 +
    3690 +    1778 +792 805  .app-footer a {
    3691 +    1779 +793 806    color: var(--link-color);
    3692 +    1780 +794 807    text-decoration: none;
    3693 +    1781 +@@ -801,6 +814,112 @@ body {
    3694 +    1782 +801 814    text-decoration: underline;
    3695 +    1783 +802 815  }
    3696 +    1784 +803 816  
    3697 +    1785 +    817 +/* ==================== SUPPORT WIDGET ==================== */
    3698 +    1786 +    818 +.support-widget-container {
    3699 +    1787 +    819 +  display: inline-flex;
    3700 +    1788 +    820 +  align-items: center;
    3701 +    1789 +    821 +  gap: 8px;
    3702 +    1790 +    822 +  min-height: 32px;
    3703 +    1791 +    823 +  /* CLS mitigation - reserve space before JS loads */
    3704 +    1792 +    824 +}
    3705 +    1793 +    825 +
    3706 +    1794 +    826 +.support-button {
    3707 +    1795 +    827 +  display: inline-flex;
    3708 +    1796 +    828 +  align-items: center;
    3709 +    1797 +    829 +  gap: 6px;
    3710 +    1798 +    830 +  padding: 6px 14px;
    3711 +    1799 +    831 +  border-radius: 20px;
    3712 +    1800 +    832 +  font-size: 13px;
    3713 +    1801 +    833 +  font-weight: 600;
    3714 +    1802 +    834 +  text-decoration: none;
    3715 +    1803 +    835 +  transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
    3716 +    1804 +    836 +  box-shadow: 0 2px 6px rgba(0, 0, 0, 0.1);
    3717 +    1805 +    837 +}
    3718 +    1806 +    838 +
    3719 +    1807 +    839 +.support-button:hover {
    3720 +    1808 +    840 +  transform: translateY(-2px);
    3721 +    1809 +    841 +  box-shadow: 0 4px 12px rgba(0, 0, 0, 0.2);
    3722 +    1810 +    842 +  text-decoration: none;
    3723 +    1811 +    843 +}
    3724 +    1812 +    844 +
    3725 +    1813 +    845 +/* Skeleton loader state */
    3726 +    1814 +    846 +.support-button--loading {
    3727 +    1815 +    847 +  background: linear-gradient(90deg, #e0e0e0 25%, #f0f0f0 50%, #e0e0e0 75%);
    3728 +    1816 +    848 +  background-size: 200% 100%;
    3729 +    1817 +    849 +  animation: shimmer 1.5s infinite;
    3730 +    1818 +    850 +  color: #888;
    3731 +    1819 +    851 +  border: none;
    3732 +    1820 +    852 +}
    3733 +    1821 +    853 +
    3734 +    1822 +    854 +@keyframes shimmer {
    3735 +    1823 +    855 +  0% {
    3736 +    1824 +    856 +    background-position: 200% 0;
    3737 +    1825 +    857 +  }
    3738 +    1826 +    858 +
    3739 +    1827 +    859 +  100% {
    3740 +    1828 +    860 +    background-position: -200% 0;
    3741 +    1829 +    861 +  }
    3742 +    1830 +    862 +}
    3743 +    1831 +    863 +
    3744 +    1832 +    864 +/* India UPI style - Orange/Saffron theme */
    3745 +    1833 +    865 +.support-button--india {
    3746 +    1834 +    866 +  background: linear-gradient(135deg, #FF9933 0%, #FF6B00 100%);
    3747 +    1835 +    867 +  color: white;
    3748 +    1836 +    868 +  border: none;
    3749 +    1837 +    869 +}
    3750 +    1838 +    870 +
    3751 +    1839 +    871 +.support-button--india:hover {
    3752 +    1840 +    872 +  background: linear-gradient(135deg, #FFB366 0%, #FF8533 100%);
    3753 +    1841 +    873 +  color: white;
    3754 +    1842 +    874 +}
    3755 +    1843 +    875 +
    3756 +    1844 +    876 +/* Global PayPal style - Blue theme */
    3757 +    1845 +    877 +.support-button--global {
    3758 +    1846 +    878 +  background: linear-gradient(135deg, #29ABE0 0%, #1E88E5 100%);
    3759 +    1847 +    879 +  color: white;
    3760 +    1848 +    880 +  border: none;
    3761 +    1849 +    881 +}
    3762 +    1850 +    882 +
    3763 +    1851 +    883 +.support-button--global:hover {
    3764 +    1852 +    884 +  background: linear-gradient(135deg, #4FC3F7 0%, #42A5F5 100%);
    3765 +    1853 +    885 +  color: white;
    3766 +    1854 +    886 +}
    3767 +    1855 +    887 +
    3768 +    1856 +    888 +/* Region toggle button */
    3769 +    1857 +    889 +.support-toggle {
    3770 +    1858 +    890 +  background: none;
    3771 +    1859 +    891 +  border: none;
    3772 +    1860 +    892 +  color: var(--text-secondary);
    3773 +    1861 +    893 +  font-size: 11px;
    3774 +    1862 +    894 +  cursor: pointer;
    3775 +    1863 +    895 +  text-decoration: underline;
    3776 +    1864 +    896 +  opacity: 0.7;
    3777 +    1865 +    897 +  transition: opacity 0.2s;
    3778 +    1866 +    898 +  padding: 0;
    3779 +    1867 +    899 +}
    3780 +    1868 +    900 +
    3781 +    1869 +    901 +.support-toggle:hover {
    3782 +    1870 +    902 +  opacity: 1;
    3783 +    1871 +    903 +  color: var(--link-color);
    3784 +    1872 +    904 +}
    3785 +    1873 +    905 +
    3786 +    1874 +    906 +/* Mobile responsive */
    3787 +    1875 +    907 +@media (max-width: 768px) {
    3788 +    1876 +    908 +  .footer-content {
    3789 +    1877 +    909 +    flex-direction: column;
    3790 +    1878 +    910 +    gap: 6px;
    3791 +    1879 +    911 +  }
    3792 +    1880 +    912 +
    3793 +    1881 +    913 +  .footer-separator {
    3794 +    1882 +    914 +    display: none;
    3795 +    1883 +    915 +  }
    3796 +    1884 +    916 +
    3797 +    1885 +    917 +  .support-widget-container {
    3798 +    1886 +    918 +    flex-direction: column;
    3799 +    1887 +    919 +    gap: 4px;
    3800 +    1888 +    920 +  }
    3801 +    1889 +    921 +}
    3802 +    1890 +    922 +
    3803 +    1891 +804 923  /* ==================== MERMAID DIAGRAMS ==================== */
    3804 +    1892 +805 924  .mermaid-diagram {
    3805 +    1893 +806 925    margin: 2em 0;
    3806 +    1894 +807 926  
    3807 +1959 1895  
    3808 +1960 1896  ```
    3809 +1961 1897  
    3810 +@@ -2001,4 +1937,4 @@ Please provide specific feedback on:
    3811 +2001 1937  
    3812 +2002 1938  ---
    3813 +2003 1939  *Generated by AI Visual Code Review v2.0 - Unified Export Script*
    3814 +2004     -*Files processed: 5/5 | Errors: 0 | Generated: 2025-12-19T10:49:19.648Z*
    3815 +    1940 +*Files processed: 9/9 | Errors: 0 | Generated: 2025-12-19T13:56:21.115Z*
    3816 +2005 1941  
1959 3817  
1960 3818  ```
1961 3819  
@@ -2001,4 +3859,4 @@ Please provide specific feedback on:
2001 3859  
2002 3860  ---
2003 3861  *Generated by AI Visual Code Review v2.0 - Unified Export Script*
2004     -*Files processed: 5/5 | Errors: 0 | Generated: 2025-12-19T10:49:19.648Z*
    3862 +*Files processed: 1/1 | Errors: 0 | Generated: 2025-12-19T14:00:46.783Z*
2005 3863  

```


### üìÑ `docs/01-requirements/donation-feature-plan.md`

**Type:** Documentation üìñ

```diff
@@ -77,12 +77,57 @@ Implement a donation/support system that:
 77  77  
 78  78  | Location | Type | Priority |
 79  79  |----------|------|----------|
 80     -| Web App Footer | "Support" button | **P0 (PRIMARY)** |
     80 +| Web App Footer | "Support" button with smart routing | **P0 (PRIMARY)** |
     81 +| Web App Header | GitHub Sponsors button | **P0 (PRIMARY)** |
 81  82  | GitHub Repository | Sponsor button | P1 |
 82  83  | README.md | Badge/button with link | P2 (SECONDARY) |
 83  84  | RELEASE.md | Acknowledgment section | P3 |
 84  85  
 85     -> **Priority Update (Per Sr. Principal SDE Review):** Web App integration is PRIMARY, README is SECONDARY
     86 +> **Priority Update (Per User Feedback):** Web App integration (Header + Footer) is PRIMARY, README is SECONDARY
     87 +
     88 +### FR-4.1: Web App UI Integration
     89 +
     90 +| Component | Content | Behavior |
     91 +|-----------|---------|----------|
     92 +| **Header** | GitHub Sponsors button | Static link to `github.com/sponsors/PrakharMNNIT` |
     93 +| **Footer** | "‚òï Support via Ko-fi" OR "üáÆüá≥ Support via UPI" | IP-based smart routing with fallback |
     94 +| **Footer** | "In India? Use UPI" toggle | Manual override for VPN users |
     95 +| **Modal Popup** | All 3 options (GitHub Sponsors, Ko-fi, Razorpay) | One-time popup after 5 seconds |
     96 +
     97 +### FR-4.2: Support Modal Popup (NEW)
     98 +
     99 +| Requirement | Specification |
    100 +|-------------|---------------|
    101 +| **Trigger** | 5 seconds after page load |
    102 +| **Frequency** | One-time only (use localStorage flag) |
    103 +| **Content** | All 3 donation options |
    104 +| **Dismissal** | Close button (X) or click outside |
    105 +| **Persistence** | Remember dismissal in localStorage |
    106 +
    107 +**Modal Layout:**
    108 +```
    109 +‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
    110 +‚îÇ  ‚òï Support Markdown Viewer Pro        [X]  ‚îÇ
    111 +‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§
    112 +‚îÇ                                             ‚îÇ
    113 +‚îÇ  If you find this tool useful, consider     ‚îÇ
    114 +‚îÇ  supporting its development:                ‚îÇ
    115 +‚îÇ                                             ‚îÇ
    116 +‚îÇ  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê           ‚îÇ
    117 +‚îÇ  ‚îÇ ‚ù§Ô∏è GitHub   ‚îÇ ‚îÇ ‚òï Ko-fi    ‚îÇ           ‚îÇ
    118 +‚îÇ  ‚îÇ  Sponsors   ‚îÇ ‚îÇ  (Global)   ‚îÇ           ‚îÇ
    119 +‚îÇ  ‚îÇ   (0% fee)  ‚îÇ ‚îÇ  (PayPal)   ‚îÇ           ‚îÇ
    120 +‚îÇ  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò           ‚îÇ
    121 +‚îÇ                                             ‚îÇ
    122 +‚îÇ  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê           ‚îÇ
    123 +‚îÇ  ‚îÇ üáÆüá≥ Razorpay (UPI/Cards)    ‚îÇ           ‚îÇ
    124 +‚îÇ  ‚îÇ    For Indian supporters    ‚îÇ           ‚îÇ
    125 +‚îÇ  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò           ‚îÇ
    126 +‚îÇ                                             ‚îÇ
    127 +‚îÇ  [ ] Don't show this again                  ‚îÇ
    128 +‚îÇ                                             ‚îÇ
    129 +‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
    130 +```
 86 131  
 87 132  ### FR-5: Multi-Platform Support
 88 133  
@@ -712,7 +757,8 @@ async function renderSupportButton(container) {
712 757  |----------|--------|--------|-------|
713 758  | **P0** | Create Ko-fi account | ‚è≥ Pending | Immediate |
714 759  | **P0** | Create Razorpay account (KYC) | ‚è≥ Pending | PAN/Aadhaar required |
715     -| **P0** | Add support button to Web App footer | ‚è≥ Pending | **PRIMARY** |
    760 +| **P0** | Add GitHub Sponsors button to Web App header | ‚úÖ Complete | **PRIMARY** |
    761 +| **P0** | Add support button to Web App footer | ‚úÖ Complete | **PRIMARY** |
716 762  | **P1** | Apply for GitHub Sponsors | ‚è≥ Pending | 2-4 week wait |
717 763  | **P2** | Add static badges to README.md | ‚è≥ Pending | **SECONDARY** (after GH approval) |
718 764  | **P3** | IP-based smart routing in web app | ‚è≥ Future | Only with fail-safe pattern |
@@ -761,14 +807,16 @@ async function renderSupportButton(container) {
761 807  ‚îÇ                                                                  ‚îÇ
762 808  ‚îÇ  PHASE 1: WEB APP (PRIMARY) - Immediate                          ‚îÇ
763 809  ‚îÇ  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê  ‚îÇ
764     -‚îÇ  ‚îÇ  Footer Button: "‚òï Support This Project"                  ‚îÇ  ‚îÇ
    810 +‚îÇ  ‚îÇ  HEADER:                                                   ‚îÇ  ‚îÇ
    811 +‚îÇ  ‚îÇ  ‚îî‚îÄ GitHub Sponsors button (static link)                  ‚îÇ  ‚îÇ
765 812  ‚îÇ  ‚îÇ                                                            ‚îÇ  ‚îÇ
766     -‚îÇ  ‚îÇ  IP Detection (Fail-Safe):                                 ‚îÇ  ‚îÇ
767     -‚îÇ  ‚îÇ  ‚îú‚îÄ India ‚Üí "üáÆüá≥ Support via UPI" ‚Üí Razorpay              ‚îÇ  ‚îÇ
768     -‚îÇ  ‚îÇ  ‚îú‚îÄ Others ‚Üí "üåè Support via PayPal" ‚Üí Ko-fi              ‚îÇ  ‚îÇ
769     -‚îÇ  ‚îÇ  ‚îî‚îÄ Fallback (API fail/timeout) ‚Üí Ko-fi (Global)          ‚îÇ  ‚îÇ
770     -‚îÇ  ‚îÇ                                                            ‚îÇ  ‚îÇ
771     -‚îÇ  ‚îÇ  MANDATORY: "Not in India? Click here" toggle              ‚îÇ  ‚îÇ
    813 +‚îÇ  ‚îÇ  FOOTER:                                                   ‚îÇ  ‚îÇ
    814 +‚îÇ  ‚îÇ  ‚îú‚îÄ Smart Routing Button: "‚òï Support This Project"        ‚îÇ  ‚îÇ
    815 +‚îÇ  ‚îÇ  ‚îÇ  ‚îú‚îÄ India ‚Üí "üáÆüá≥ Support via UPI" ‚Üí Razorpay          ‚îÇ  ‚îÇ
    816 +‚îÇ  ‚îÇ  ‚îÇ  ‚îú‚îÄ Others ‚Üí "üåè Support via Ko-fi" ‚Üí Ko-fi            ‚îÇ  ‚îÇ
    817 +‚îÇ  ‚îÇ  ‚îÇ  ‚îî‚îÄ Fallback (API fail/timeout) ‚Üí Ko-fi (Global)       ‚îÇ  ‚îÇ
    818 +‚îÇ  ‚îÇ  ‚îÇ                                                         ‚îÇ  ‚îÇ
    819 +‚îÇ  ‚îÇ  ‚îî‚îÄ Toggle: "In India? Use UPI" (manual override)         ‚îÇ  ‚îÇ
772 820  ‚îÇ  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò  ‚îÇ
773 821  ‚îÇ                                                                  ‚îÇ
774 822  ‚îÇ  PHASE 2: README (SECONDARY) - After GH Sponsors Approval        ‚îÇ
775 823  

```


### üìÑ `index.html`

**Type:** HTML Template üåê

```diff
@@ -702,6 +702,42 @@
702 702        </div>
703 703      </div>
704 704  
    705 +    <!-- Support Modal (One-time popup with all 3 options) -->
    706 +    <div id="support-modal" class="modal support-modal" role="dialog" aria-modal="true" aria-labelledby="support-modal-title">
    707 +      <div class="modal-content support-modal-content">
    708 +        <button class="close-btn" id="close-support-modal" aria-label="Close">&times;</button>
    709 +        <h2 id="support-modal-title">‚òï Support Markdown Viewer Pro</h2>
    710 +        <p class="support-modal-desc">If you find this tool useful, consider supporting its development:</p>
    711 +
    712 +        <div class="support-options">
    713 +          <a href="https://github.com/sponsors/PrakharMNNIT?ref=webapp_modal" target="_blank" rel="noopener noreferrer" class="support-option support-option--github">
    714 +            <span class="support-option-icon">‚ù§Ô∏è</span>
    715 +            <span class="support-option-title">GitHub Sponsors</span>
    716 +            <span class="support-option-desc">0% fee ‚Ä¢ For developers</span>
    717 +          </a>
    718 +
    719 +          <a href="https://ko-fi.com/praxlannister?ref=webapp_modal" target="_blank" rel="noopener noreferrer" class="support-option support-option--kofi">
    720 +            <span class="support-option-icon">‚òï</span>
    721 +            <span class="support-option-title">Ko-fi</span>
    722 +            <span class="support-option-desc">PayPal ‚Ä¢ Global</span>
    723 +          </a>
    724 +
    725 +          <a href="https://razorpay.me/@prakharshekharparthasarthi?notes[source]=webapp_modal" target="_blank" rel="noopener noreferrer" class="support-option support-option--razorpay">
    726 +            <span class="support-option-icon">üáÆüá≥</span>
    727 +            <span class="support-option-title">Razorpay</span>
    728 +            <span class="support-option-desc">UPI/Cards ‚Ä¢ India</span>
    729 +          </a>
    730 +        </div>
    731 +
    732 +        <div class="support-modal-footer">
    733 +          <label class="dont-show-again">
    734 +            <input type="checkbox" id="support-dont-show-again" />
    735 +            <span>Don't show this again</span>
    736 +          </label>
    737 +        </div>
    738 +      </div>
    739 +    </div>
    740 +
705 741      <!-- Main Script -->
706 742      <script type="module" src="script.js"></script>
707 743    </body>
708 744  

```


### üìÑ `script.js`

**Type:** JavaScript Source File üü®

```diff
@@ -354,6 +354,81 @@ function initializeApp() {
354 354  
355 355    // Initialize support widget (donation button in footer)
356 356    initSupportWidget();
    357 +
    358 +  // Initialize support modal (one-time popup)
    359 +  initSupportModal();
    360 +}
    361 +
    362 +// ==================== SUPPORT MODAL (ONE-TIME POPUP) ====================
    363 +const SUPPORT_MODAL_SHOWN_KEY = 'support_modal_shown';
    364 +const SUPPORT_MODAL_DELAY_MS = 5000; // 5 seconds
    365 +
    366 +/**
    367 + * Initialize support modal - shows once after 5 seconds
    368 + */
    369 +function initSupportModal() {
    370 +  const modal = document.getElementById('support-modal');
    371 +  const closeBtn = document.getElementById('close-support-modal');
    372 +  const dontShowAgainCheckbox = document.getElementById('support-dont-show-again');
    373 +
    374 +  if (!modal || !closeBtn) {
    375 +    console.warn('[SupportModal] Modal elements not found');
    376 +    return;
    377 +  }
    378 +
    379 +  // Check if already shown before
    380 +  const alreadyShown = localStorage.getItem(SUPPORT_MODAL_SHOWN_KEY);
    381 +  if (alreadyShown === 'true') {
    382 +    console.log('[SupportModal] Already shown before, skipping');
    383 +    return;
    384 +  }
    385 +
    386 +  // Show modal after delay
    387 +  setTimeout(() => {
    388 +    modal.classList.add('active');
    389 +    console.log('[SupportModal] Showing support modal');
    390 +  }, SUPPORT_MODAL_DELAY_MS);
    391 +
    392 +  // Close button handler
    393 +  closeBtn.addEventListener('click', () => {
    394 +    closeSupportModal(modal, dontShowAgainCheckbox);
    395 +  });
    396 +
    397 +  // Click outside to close
    398 +  modal.addEventListener('click', (e) => {
    399 +    if (e.target === modal) {
    400 +      closeSupportModal(modal, dontShowAgainCheckbox);
    401 +    }
    402 +  });
    403 +
    404 +  // Escape key to close
    405 +  document.addEventListener('keydown', (e) => {
    406 +    if (e.key === 'Escape' && modal.classList.contains('active')) {
    407 +      closeSupportModal(modal, dontShowAgainCheckbox);
    408 +    }
    409 +  });
    410 +
    411 +  // Track clicks on support options
    412 +  modal.querySelectorAll('.support-option').forEach(option => {
    413 +    option.addEventListener('click', () => {
    414 +      // Mark as shown when user clicks a support option
    415 +      localStorage.setItem(SUPPORT_MODAL_SHOWN_KEY, 'true');
    416 +      console.log('[SupportModal] User clicked support option, marking as shown');
    417 +    });
    418 +  });
    419 +}
    420 +
    421 +/**
    422 + * Close the support modal
    423 + */
    424 +function closeSupportModal(modal, checkbox) {
    425 +  modal.classList.remove('active');
    426 +
    427 +  // If "Don't show again" is checked, remember it
    428 +  if (checkbox && checkbox.checked) {
    429 +    localStorage.setItem(SUPPORT_MODAL_SHOWN_KEY, 'true');
    430 +    console.log('[SupportModal] User opted out of future modals');
    431 +  }
357 432  }
358 433  
359 434  // ==================== SUPPORT WIDGET (DONATION ROUTER) ====================
360 435  

```


### üìÑ `style.css`

**Type:** Stylesheet üé®

```diff
@@ -2045,6 +2045,128 @@ body {
2045 2045    color: white;
2046 2046  }
2047 2047  
    2048 +/* ==================== SUPPORT MODAL ==================== */
    2049 +.support-modal .modal-content {
    2050 +  max-width: 420px;
    2051 +  text-align: center;
    2052 +  padding: 32px 24px;
    2053 +}
    2054 +
    2055 +.support-modal h2 {
    2056 +  margin: 0 0 8px 0;
    2057 +  font-size: 24px;
    2058 +  color: var(--h1-color);
    2059 +}
    2060 +
    2061 +.support-modal-desc {
    2062 +  color: var(--text-secondary);
    2063 +  font-size: 14px;
    2064 +  margin: 0 0 24px 0;
    2065 +  line-height: 1.5;
    2066 +}
    2067 +
    2068 +.support-options {
    2069 +  display: flex;
    2070 +  flex-direction: column;
    2071 +  gap: 12px;
    2072 +  margin-bottom: 20px;
    2073 +}
    2074 +
    2075 +.support-option {
    2076 +  display: flex;
    2077 +  align-items: center;
    2078 +  gap: 12px;
    2079 +  padding: 14px 18px;
    2080 +  border-radius: 12px;
    2081 +  text-decoration: none;
    2082 +  transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
    2083 +  border: 2px solid transparent;
    2084 +}
    2085 +
    2086 +.support-option:hover {
    2087 +  transform: translateY(-2px);
    2088 +  box-shadow: 0 8px 24px rgba(0, 0, 0, 0.15);
    2089 +  text-decoration: none;
    2090 +}
    2091 +
    2092 +.support-option-icon {
    2093 +  font-size: 24px;
    2094 +  flex-shrink: 0;
    2095 +}
    2096 +
    2097 +.support-option-title {
    2098 +  font-weight: 600;
    2099 +  font-size: 15px;
    2100 +  display: block;
    2101 +}
    2102 +
    2103 +.support-option-desc {
    2104 +  font-size: 12px;
    2105 +  opacity: 0.8;
    2106 +  display: block;
    2107 +}
    2108 +
    2109 +/* GitHub Sponsors option */
    2110 +.support-option--github {
    2111 +  background: linear-gradient(135deg, #ea4aaa 0%, #db61a2 100%);
    2112 +  color: white;
    2113 +}
    2114 +
    2115 +.support-option--github:hover {
    2116 +  background: linear-gradient(135deg, #f472b6 0%, #ec4899 100%);
    2117 +  border-color: rgba(255, 255, 255, 0.3);
    2118 +  color: white;
    2119 +}
    2120 +
    2121 +/* Ko-fi option */
    2122 +.support-option--kofi {
    2123 +  background: linear-gradient(135deg, #29ABE0 0%, #1E88E5 100%);
    2124 +  color: white;
    2125 +}
    2126 +
    2127 +.support-option--kofi:hover {
    2128 +  background: linear-gradient(135deg, #4FC3F7 0%, #42A5F5 100%);
    2129 +  border-color: rgba(255, 255, 255, 0.3);
    2130 +  color: white;
    2131 +}
    2132 +
    2133 +/* Razorpay option */
    2134 +.support-option--razorpay {
    2135 +  background: linear-gradient(135deg, #FF9933 0%, #FF6B00 100%);
    2136 +  color: white;
    2137 +}
    2138 +
    2139 +.support-option--razorpay:hover {
    2140 +  background: linear-gradient(135deg, #FFB366 0%, #FF8533 100%);
    2141 +  border-color: rgba(255, 255, 255, 0.3);
    2142 +  color: white;
    2143 +}
    2144 +
    2145 +.support-modal-footer {
    2146 +  padding-top: 16px;
    2147 +  border-top: 1px solid var(--border-color);
    2148 +}
    2149 +
    2150 +.dont-show-again {
    2151 +  display: inline-flex;
    2152 +  align-items: center;
    2153 +  gap: 8px;
    2154 +  cursor: pointer;
    2155 +  font-size: 13px;
    2156 +  color: var(--text-secondary);
    2157 +  user-select: none;
    2158 +}
    2159 +
    2160 +.dont-show-again input[type="checkbox"] {
    2161 +  width: 16px;
    2162 +  height: 16px;
    2163 +  cursor: pointer;
    2164 +}
    2165 +
    2166 +.dont-show-again:hover {
    2167 +  color: var(--text-primary);
    2168 +}
    2169 +
2048 2170  /* ==================== ZEN MODE ==================== */
2049 2171  /* Zen Mode: Focused reading mode showing ONLY the preview */
2050 2172  body.zen-mode {
2051 2173  

```

---

## ü§ñ AI Review Checklist

Please review these changes for:

### üîç Code Quality
- [ ] **Linting Compliance**: No unused imports/variables, proper formatting
- [ ] **Type Safety**: Proper typing throughout (TypeScript/Python type hints)
- [ ] **Best Practices**: Framework-specific conventions and patterns
- [ ] **Performance**: Efficient algorithms, proper memoization
- [ ] **Documentation**: Clear comments and function descriptions

### üêõ Potential Issues
- [ ] **Runtime Errors**: Type mismatches, null/undefined handling
- [ ] **Logic Bugs**: Incorrect calculations, edge cases
- [ ] **Memory Leaks**: Cleanup in lifecycle methods, event listeners
- [ ] **Error Handling**: Proper try-catch blocks, user feedback
- [ ] **Accessibility**: ARIA labels, keyboard navigation, screen readers

### üîí Security & Data
- [ ] **Input Validation**: Sanitization, XSS prevention, SQL injection
- [ ] **Authentication**: Proper access controls and permissions
- [ ] **Privacy**: No sensitive data exposure in logs/client
- [ ] **Dependencies**: Updated packages, vulnerability checks

### üì± UX/UI
- [ ] **Responsive Design**: Mobile/desktop/tablet compatibility
- [ ] **Loading States**: Proper feedback during async operations
- [ ] **Error Messages**: User-friendly error handling and recovery
- [ ] **Performance**: Fast loading, smooth animations

### üí° Suggestions & Improvements
Please provide specific feedback on:
1. Code organization and structure improvements
2. Performance optimization opportunities
3. Security considerations and hardening
4. Testing coverage and strategies
5. Documentation and maintainability

---
*Generated by AI Visual Code Review v2.0 - Unified Export Script*
*Files processed: 5/5 | Errors: 0 | Generated: 2025-12-19T14:13:35.832Z*
