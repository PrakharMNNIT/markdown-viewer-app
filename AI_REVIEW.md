# üîç Code Review - 12/9/2025, 7:26:34 AM

**Project:** AI Visual Code Review
**Generated by:** AI Visual Code Review v2.0

## üìä Change Summary

```
AI_REVIEW.md | 15809 ++++++++-------------------------------------------------
 script.js    |    40 +
 2 files changed, 2109 insertions(+), 13740 deletions(-)
```

## üìù Files Changed (2/2 selected)


### üìÑ `AI_REVIEW.md`

**Type:** Documentation üìñ

```diff
@@ -1,4 +1,4 @@
  1     -# üîç Code Review - 12/9/2025, 7:11:21 AM
      1 +# üîç Code Review - 12/9/2025, 7:20:28 AM
  2   2  
  3   3  **Project:** AI Visual Code Review
  4   4  **Generated by:** AI Visual Code Review v2.0
@@ -6,13764 +6,2093 @@
  6   6  ## üìä Change Summary
  7   7  
  8   8  ```
  9     -AI_REVIEW.md                         | 11664 +++++----------------------------
 10     - codebase_audit/migration_analysis.md |    21 +
 11     - index.html                           |    35 -
 12     - package-lock.json                    |  1416 +++-
 13     - package.json                         |     7 +-
 14     - script.js                            |    89 +-
 15     - 6 files changed, 3073 insertions(+), 10159 deletions(-)
      9 +AI_REVIEW.md                   | 15363 +++++++++++++++++++++++++++++++++++----
     10 + codebase_audit/ui_ux_review.md |    55 +
     11 + tests/comprehensive_test.md    |  1998 +++++
     12 + 3 files changed, 15801 insertions(+), 1615 deletions(-)
 16  13  ```
 17  14  
 18     -## üìù Files Changed (6/6 selected)
     15 +## üìù Files Changed (2/3 selected)
     16 +
     17 +### üì¶ Large Files Skipped
     18 +The following files were skipped due to size (use --no-size-limit to include):
     19 +- `AI_REVIEW.md`
 19  20  
 20  21  
 21     -### üìÑ `AI_REVIEW.md`
 22     -
 23     -**Type:** Documentation üìñ
 24     -
 25     -```diff
 26     -@@ -1,4 +1,4 @@
 27     -  1     -# üîç Code Review - 12/9/2025, 7:04:12 AM
 28     -      1 +# üîç Code Review - 12/9/2025, 7:05:49 AM
 29     -  2   2  
 30     -  3   3  **Project:** AI Visual Code Review
 31     -  4   4  **Generated by:** AI Visual Code Review v2.0
 32     -@@ -6,8503 +6,16 @@
 33     -  6   6  ## üìä Change Summary
 34     -  7   7  
 35     -  8   8  ```
 36     -  9     -.agent/workflows/code-change-workflow.md |   13 +
 37     - 10     - AI_REVIEW.md                             | 8282 +++++++++++++++++-------------
 38     - 11     - package-lock.json                        |   17 +
 39     - 12     - package.json                             |    1 +
 40     - 13     - script.js                                | 1454 +++---
 41     - 14     - 5 files changed, 5530 insertions(+), 4237 deletions(-)
 42     -      9 +AI_REVIEW.md | 14895 ++++++++++++++++++++++++++++++++++++++-------------------
 43     -     10 + script.js    |  1463 +++---
 44     -     11 + 2 files changed, 10790 insertions(+), 5568 deletions(-)
 45     - 15  12  ```
 46     - 16  13  
 47     - 17     -## üìù Files Changed (5/5 selected)
 48     -     14 +## üìù Files Changed (1/2 selected)
 49     - 18  15  
 50     - 19     -
 51     - 20     -### ‚ú® `.agent/workflows/code-change-workflow.md` **[ADDED]**
 52     - 21     -
 53     - 22     -**Status:** ‚úÖ **NEW FILE** - This file has been newly created
 54     - 23     -
 55     - 24     -**Type:** Documentation üìñ
 56     - 25     -
 57     - 26     -```diff
 58     - 27     -@@ -0,0 +1,13 @@
 59     - 28     -      1 +---
 60     - 29     -      2 +description: Standard process for making code changes with AI review validation
 61     - 30     -      3 +---
 62     - 31     -      4 +
 63     - 32     -      5 +# Code Change Process
 64     - 33     -      6 +
 65     - 34     -      7 +1. **Make Code Changes**: Apply fixes or new features.
 66     - 35     -      8 +2. **Stage Changes**: `git add .`
 67     - 36     -      9 +3. **AI Validation**: `npx ai-review quick`
 68     - 37     -     10 +4. **Self/User Review**: Read `AI_REVIEW.md` and verify changes.
 69     - 38     -     11 +5. **Fix Issues**: If review finds issues, repeat steps 1-4.
 70     - 39     -     12 +6. **Commit**: Only commit after a passing review.
 71     - 40     -     13 +   `git commit -m "feat: description"`
 72     - 41     -     14  
 73     - 42     -
 74     - 43     -```
 75     - 44     -
 76     - 45     -
 77     - 46     -### üìÑ `AI_REVIEW.md`
 78     - 47     -
 79     - 48     -**Type:** Documentation üìñ
 80     - 49     -
 81     - 50     -```diff
 82     - 51     -@@ -1,4 +1,4 @@
 83     - 52     -  1     -# üîç Code Review - 12/7/2025, 9:59:24 AM
 84     - 53     -      1 +# üîç Code Review - 12/9/2025, 7:02:00 AM
 85     - 54     -  2   2  
 86     - 55     -  3   3  **Project:** AI Visual Code Review
 87     - 56     -  4   4  **Generated by:** AI Visual Code Review v2.0
 88     - 57     -@@ -6,28 +6,23 @@
 89     - 58     -  6   6  ## üìä Change Summary
 90     - 59     -  7   7  
 91     - 60     -  8   8  ```
 92     - 61     -  9     -AI_REVIEW.md                                       | 428 +++++++++++++++++----
 93     - 62     - 10     - docs/02-architecture/mermaid-theme-architecture.md | 208 ++++++++++
 94     - 63     - 11     - docs/02-architecture/prism-token-architecture.md   | 226 +++++++++++
 95     - 64     - 12     - script.js                                          |  52 ++-
 96     - 65     - 13     - src/js/services/MermaidService.js                  | 230 +++++++++--
 97     - 66     - 14     - style.css                                          | 147 ++++---
 98     - 67     - 15     - themes/default-dark.css                            | 186 ++++++++-
 99     - 68     - 16     - themes/default-light.css                           | 186 ++++++++-
100     - 69     - 17     - themes/forest-dark.css                             | 167 ++++++--
101     - 70     - 18     - themes/forest-light.css                            | 138 ++++++-
102     - 71     - 19     - themes/neon-dark.css                               | 166 ++++++--
103     - 72     - 20     - themes/neon-light.css                              | 138 ++++++-
104     - 73     - 21     - themes/obsidian-dark.css                           | 138 ++++++-
105     - 74     - 22     - themes/obsidian-light.css                          | 138 ++++++-
106     - 75     - 23     - themes/ocean-dark.css                              | 138 ++++++-
107     - 76     - 24     - themes/ocean-light.css                             | 138 ++++++-
108     - 77     - 25     - themes/sunset-dark.css                             | 138 ++++++-
109     - 78     - 26     - themes/sunset-light.css                            | 138 ++++++-
110     - 79     - 27     - 18 files changed, 2762 insertions(+), 338 deletions(-)
111     - 80     -      9 +AI_REVIEW.md                                       | 3926 ++++++++++++++++++--
112     - 81     -     10 + codebase_audit/audit_summary.md                    |   49 +
113     - 82     -     11 + .../deep_dive_reviews/mermaid_service_review.md    |   47 +
114     - 83     -     12 + .../deep_dive_reviews/script_js_review.md          |  121 +
115     - 84     -     13 + .../deep_dive_reviews/theme_manager_review.md      |   53 +
116     - 85     -     14 + codebase_audit/docs_summary.json                   |   12 +
117     - 86     -     15 + codebase_audit/future_enhancements_roadmap.md      |   87 +
118     - 87     -     16 + codebase_audit/phase3_codebase_review.json         |   68 +
119     - 88     -     17 + codebase_audit/phase4_consolidated_findings.md     |   31 +
120     - 89     -     18 + codebase_audit/phase4_implementation_plan.md       |   71 +
121     - 90     -     19 + codebase_audit/phase5_recommendations.md           |   41 +
122     - 91     -     20 + codebase_audit/phase6_final_deliverables.md        |   44 +
123     - 92     -     21 + codebase_audit/repo_manifest.json                  |   74 +
124     - 93     -     22 + 13 files changed, 4282 insertions(+), 342 deletions(-)
125     - 94     - 28  23  ```
126     - 95     - 29  24  
127     - 96     - 30     -## üìù Files Changed (18/18 selected)
128     - 97     -     25 +## üìù Files Changed (13/13 selected)
129     - 98     - 31  26  
130     - 99     - 32  27  
131     -100     - 33  28  ### üìÑ `AI_REVIEW.md`
132     -101     -@@ -36,3588 +31,4827 @@ AI_REVIEW.md                                       | 428 +++++++++++++++++----
133     -102     - 36  31  
134     -103     - 37  32  ```diff
135     -104     - 38  33  @@ -1,4 +1,4 @@
136     -105     - 39     -  1     -# üîç Code Review - 12/7/2025, 4:25:31 AM
137     -106     - 40     -      1 +# üîç Code Review - 12/7/2025, 8:27:20 AM
138     -107     -     34 +  1     -# üîç Code Review - 12/7/2025, 8:27:20 AM
139     -108     -     35 +      1 +# üîç Code Review - 12/7/2025, 9:59:24 AM
140     -109     - 41  36    2   2  
141     -110     - 42  37    3   3  **Project:** AI Visual Code Review
142     -111     - 43  38    4   4  **Generated by:** AI Visual Code Review v2.0
143     -112     - 44     -@@ -6,38 +6,80 @@
144     -113     -     39 +@@ -6,80 +6,953 @@
145     -114     - 45  40    6   6  ## üìä Change Summary
146     -115     - 46  41    7   7  
147     -116     - 47  42    8   8  ```
148     -117     - 48     -  9     -index.html | 11 +++++++++++
149     -118     - 49     - 10     - script.js  | 21 ++++++++++++++++++++-
150     -119     - 50     - 11     - 2 files changed, 31 insertions(+), 1 deletion(-)
151     -120     - 51     -      9 +memory-bank/activeContext.md |  52 +++++++++-
152     -121     - 52     -     10 + script.js                    | 231 +++++--------------------------------------
153     -122     - 53     -     11 + themes/sunset-dark.css       |   2 +-
154     -123     - 54     -     12 + 3 files changed, 75 insertions(+), 210 deletions(-)
155     -124     - 55     - 12  13  ```
156     -125     - 56     - 13  14  
157     -126     - 57     - 14     -## üìù Files Changed (2/2 selected)
158     -127     - 58     -     15 +## üìù Files Changed (3/3 selected)
159     -128     - 59     - 15  16  
160     -129     - 60     - 16  17  
161     -130     - 61     - 17     -### üìÑ `index.html`
162     -131     - 62     -     18 +### üìÑ `memory-bank/activeContext.md`
163     -132     - 63     - 18  19  
164     -133     - 64     - 19     -**Type:** HTML Template üåê
165     -134     - 65     -     20 +**Type:** Documentation üìñ
166     -135     - 66     - 20  21  
167     -136     - 67     - 21  22  ```diff
168     -137     - 68     - 22     -@@ -55,6 +55,17 @@
169     -138     - 69     - 23     - 55  55              üìÅ Open Folder
170     -139     - 70     - 24     - 56  56            </button>
171     -140     - 71     - 25     - 57  57  
172     -141     - 72     - 26     -     58 +          <!-- Collapse/Expand Sidebar -->
173     -142     - 73     - 27     -     59 +          <button
174     -143     - 74     - 28     -     60 +            class="btn"
175     -144     - 75     - 29     -     61 +            id="toggle-sidebar-btn"
176     -145     - 76     - 30     -     62 +            title="Toggle File Browser"
177     -146     - 77     - 31     -     63 +            aria-label="Toggle File Browser Sidebar"
178     -147     - 78     - 32     -     64 +            style="display: none"
179     -148     - 79     - 33     -     65 +          >
180     -149     - 80     - 34     -     66 +            ‚óÄ Hide Files
181     -150     - 81     - 35     -     67 +          </button>
182     -151     - 82     - 36     -     68 +
183     -152     - 83     - 37     - 58  69            <!-- View Mode Buttons -->
184     -153     - 84     - 38     - 59  70            <div class="view-mode-buttons">
185     -154     - 85     - 39     - 60  71              <button
186     -155     - 86     - 40     - 61  72  
187     -156     - 87     -     23 +@@ -202,7 +202,57 @@ html = restoreLatexEnvironments(html);
188     -157     - 88     -     24 +202 202  
189     -158     - 89     -     25 +203 203  ## Open Questions
190     -159     - 90     -     26 +204 204  
191     -160     - 91     -     27 +205     -None - All LaTeX rendering issues resolved
192     -161     - 92     -     28 +    205 +None - All issues resolved
193     -162     - 93     -     29 +    206 +
194     -163     - 94     -     30 +    207 +## Recent Fixes (Latest Session)
195     -164     - 95     -     31 +    208 +
196     -165     - 96     -     32 +    209 +### Theme Dropdown Sync Fix ‚úÖ
197     -166     - 97     -     33 +    210 +
198     -167     - 98     -     34 +    211 +**Problem:** Theme dropdown showing "Default Light" even when sunset-dark theme was loaded from LocalStorage.
199     -168     - 99     -     35 +    212 +
200     -169     -100     -     36 +    213 +**Root Cause:** Race condition in theme loading - dropdown was being set BEFORE async theme load completed.
201     -170     -101     -     37 +    214 +
202     -171     -102     -     38 +    215 +**Solution:**
203     -172     -103     -     39 +    216 +
204     -173     -104     -     40 +    217 +```javascript
205     -174     -105     -     41 +    218 +// OLD (buggy):
206     -175     -106     -     42 +    219 +if (savedTheme) {
207     -176     -107     -     43 +    220 +  themeSelector.value = savedTheme; // Sets immediately
208     -177     -108     -     44 +    221 +  themeManager.loadTheme(savedTheme); // Async, not awaited
209     -178     -109     -     45 +    222 +}
210     -179     -110     -     46 +    223 +
211     -180     -111     -     47 +    224 +// NEW (fixed):
212     -181     -112     -     48 +    225 +if (savedTheme) {
213     -182     -113     -     49 +    226 +  themeManager
214     -183     -114     -     50 +    227 +    .loadTheme(savedTheme)
215     -184     -115     -     51 +    228 +    .then(() => {
216     -185     -116     -     52 +    229 +      themeSelector.value = savedTheme; // Only after successful load
217     -186     -117     -     53 +    230 +      console.log(`‚úÖ Theme restored: ${savedTheme}`);
218     -187     -118     -     54 +    231 +    })
219     -188     -119     -     55 +    232 +    .catch(err => {
220     -189     -120     -     56 +    233 +      // Fallback with proper sync
221     -190     -121     -     57 +    234 +      themeManager.loadTheme('default-light').then(() => {
222     -191     -122     -     58 +    235 +        themeSelector.value = 'default-light';
223     -192     -123     -     59 +    236 +      });
224     -193     -124     -     60 +    237 +    });
225     -194     -125     -     61 +    238 +}
226     -195     -126     -     62 +    239 +```
227     -196     -127     -     63 +    240 +
228     -197     -128     -     64 +    241 +**Key Changes:**
229     -198     -129     -     65 +    242 +
230     -199     -130     -     66 +    243 +1. Await theme load completion before syncing dropdown
231     -200     -131     -     67 +    244 +2. Added success callback for dropdown update
232     -201     -132     -     68 +    245 +3. Added error handling with fallback
233     -202     -133     -     69 +    246 +4. Added console logging for debugging
234     -203     -134     -     70 +    247 +
235     -204     -135     -     71 +    248 +**Results:**
236     -205     -136     -     72 +    249 +
237     -206     -137     -     73 +    250 +- ‚úÖ Dropdown now syncs correctly with all themes
238     -207     -138     -     74 +    251 +- ‚úÖ No more race conditions
239     -208     -139     -     75 +    252 +- ‚úÖ Proper error handling
240     -209     -140     -     76 +    253 +- ‚úÖ Works for all 12 themes (6 theme families √ó 2 variants)
241     -210     -141     -     77 +    254 +
242     -211     -142     -     78 +    255 +**Files Modified:** `script.js` (lines 1167-1183)
243     -212     -143     -     79 +206 256  
244     -213     -144     -     80 +207 257  ## Performance Observations
245     -214     -145     -     81 +208 258  
246     -215     -146     -     82 +209 259  
247     -216     -147     - 41  83  
248     -217     -148     - 42  84  ```
249     -218     -149     - 43  85  
250     -219     -150     -@@ -47,51 +89,293 @@ index.html | 11 +++++++++++
251     -220     -151     - 47  89  **Type:** JavaScript Source File üü®
252     -221     -152     - 48  90  
253     -222     -153     - 49  91  ```diff
254     -223     -154     - 50     -@@ -796,6 +796,7 @@ graph TD
255     -224     -155     - 51     -796 796    // Folder browser DOM elements
256     -225     -156     - 52     -797 797    const fileBrowser = document.getElementById('file-browser');
257     -226     -157     - 53     -798 798    const openFolderBtn = document.getElementById('open-folder-btn');
258     -227     -158     - 54     -    799 +  const toggleSidebarBtn = document.getElementById('toggle-sidebar-btn');
259     -228     -159     - 55     -799 800    const closeBrowserBtn = document.getElementById('close-browser-btn');
260     -229     -160     - 56     -800 801    const fileTree = document.getElementById('file-tree');
261     -230     -161     - 57     -801 802    const currentFolderNameEl = document.getElementById('current-folder-name');
262     -231     -162     - 58     -@@ -804,6 +805,7 @@ graph TD
263     -232     -163     - 59     -804 805    // Folder browser state (using let to allow reassignment)
264     -233     -164     - 60     -805 806    let folderFiles = [];
265     -234     -165     - 61     -806 807    let activeFileHandle = null;
266     -235     -166     - 62     -    808 +  const sidebarCollapsed = false;
267     -236     -167     - 63     -807 809  
268     -237     -168     - 64     -808 810    // Open folder handler
269     -238     -169     - 65     -809 811    openFolderBtn.addEventListener('click', async () => {
270     -239     -170     - 66     -@@ -843,9 +845,26 @@ graph TD
271     -240     -171     - 67     -843 845      console.log(`‚úÖ Loaded ${result.totalFiles} markdown files from ${result.folderName}`);
272     -241     -172     - 68     -844 846    });
273     -242     -173     - 69     -845 847  
274     -243     -174     - 70     -846     -  // Close browser handler
275     -244     -175     - 71     -    848 +  // Toggle sidebar collapse/expand
276     -245     -176     - 72     -    849 +  toggleSidebarBtn.addEventListener('click', () => {
277     -246     -177     - 73     -    850 +    if (fileBrowser.style.display === 'none') {
278     -247     -178     - 74     -    851 +      // Expand sidebar
279     -248     -179     - 75     -    852 +      fileBrowser.style.display = 'flex';
280     -249     -180     - 76     -    853 +      toggleSidebarBtn.textContent = '‚óÄ Hide Files';
281     -250     -181     - 77     -    854 +      toggleSidebarBtn.title = 'Hide File Browser';
282     -251     -182     - 78     -    855 +    } else {
283     -252     -183     - 79     -    856 +      // Collapse sidebar (keep data)
284     -253     -184     - 80     -    857 +      fileBrowser.style.display = 'none';
285     -254     -185     - 81     -    858 +      toggleSidebarBtn.textContent = '‚ñ∂ Show Files';
286     -255     -186     - 82     -    859 +      toggleSidebarBtn.title = 'Show File Browser';
287     -256     -187     - 83     -    860 +    }
288     -257     -188     - 84     -    861 +  });
289     -258     -189     - 85     -    862 +
290     -259     -190     - 86     -    863 +  // Close browser handler (clears data)
291     -260     -191     - 87     -847 864    closeBrowserBtn.addEventListener('click', () => {
292     -261     -192     - 88     -848 865      fileBrowser.style.display = 'none';
293     -262     -193     - 89     -    866 +    toggleSidebarBtn.style.display = 'none';
294     -263     -194     - 90     -    867 +    openFolderBtn.style.display = 'inline-block';
295     -264     -195     - 91     -849 868      folderFiles = [];
296     -265     -196     - 92     -850 869      activeFileHandle = null;
297     -266     -197     - 93     -851 870    });
298     -267     -198     - 94     -852 871  
299     -268     -199     -     92 +@@ -145,101 +145,10 @@ function configureMarkedExtensions() {
300     -269     -200     -     93 +145 145      return;
301     -270     -201     -     94 +146 146    }
302     -271     -202     -     95 +147 147  
303     -272     -203     -     96 +148     -  // Add LaTeX environment extensions
304     -273     -204     -     97 +    148 +  // Add inline math and text formatting extensions only
305     -274     -205     -     98 +    149 +  // LaTeX environments (align, gather, etc.) are not supported by KaTeX
306     -275     -206     -     99 +149 150    marked.use({
307     -276     -207     -    100 +150 151      extensions: [
308     -277     -208     -    101 +151     -      {
309     -278     -209     -    102 +152     -        name: 'latexEnvironment',
310     -279     -210     -    103 +153     -        level: 'block',
311     -280     -211     -    104 +154     -        start(src) {
312     -281     -212     -    105 +155     -          return src.match(/^\\begin\{/)?.index;
313     -282     -213     -    106 +156     -        },
314     -283     -214     -    107 +157     -        tokenizer(src) {
315     -284     -215     -    108 +158     -          const match = src.match(/^\\begin\{([^}]+)\}([\s\S]*?)\\end\{\1\}/);
316     -285     -216     -    109 +159     -          if (match) {
317     -286     -217     -    110 +160     -            return {
318     -287     -218     -    111 +161     -              type: 'latexEnvironment',
319     -288     -219     -    112 +162     -              raw: match[0],
320     -289     -220     -    113 +163     -              text: match[0],
321     -290     -221     -    114 +164     -            };
322     -291     -222     -    115 +165     -          }
323     -292     -223     -    116 +166     -        },
324     -293     -224     -    117 +167     -        renderer(token) {
325     -294     -225     -    118 +168     -          try {
326     -295     -226     -    119 +169     -            const rendered = katex.renderToString(token.text, {
327     -296     -227     -    120 +170     -              displayMode: true,
328     -297     -228     -    121 +171     -              throwOnError: false,
329     -298     -229     -    122 +172     -              trust: true,
330     -299     -230     -    123 +173     -              strict: false,
331     -300     -231     -    124 +174     -            });
332     -301     -232     -    125 +175     -            return `<div class="katex-display">${rendered}</div>`;
333     -302     -233     -    126 +176     -          } catch (e) {
334     -303     -234     -    127 +177     -            console.warn('KaTeX environment render error:', e);
335     -304     -235     -    128 +178     -            return `<div style="color: red; padding: 10px;">LaTeX Error: ${e.message}</div>`;
336     -305     -236     -    129 +179     -          }
337     -306     -237     -    130 +180     -        },
338     -307     -238     -    131 +181     -      },
339     -308     -239     -    132 +182     -      {
340     -309     -240     -    133 +183     -        name: 'latexDisplayBracket',
341     -310     -241     -    134 +184     -        level: 'block',
342     -311     -242     -    135 +185     -        start(src) {
343     -312     -243     -    136 +186     -          return src.match(/^\\\[/)?.index;
344     -313     -244     -    137 +187     -        },
345     -314     -245     -    138 +188     -        tokenizer(src) {
346     -315     -246     -    139 +189     -          const match = src.match(/^\\\[([\s\S]*?)\\\]/);
347     -316     -247     -    140 +190     -          if (match) {
348     -317     -248     -    141 +191     -            return {
349     -318     -249     -    142 +192     -              type: 'latexDisplayBracket',
350     -319     -250     -    143 +193     -              raw: match[0],
351     -320     -251     -    144 +194     -              text: match[1].trim(),
352     -321     -252     -    145 +195     -            };
353     -322     -253     -    146 +196     -          }
354     -323     -254     -    147 +197     -        },
355     -324     -255     -    148 +198     -        renderer(token) {
356     -325     -256     -    149 +199     -          try {
357     -326     -257     -    150 +200     -            const rendered = katex.renderToString(token.text, {
358     -327     -258     -    151 +201     -              displayMode: true,
359     -328     -259     -    152 +202     -              throwOnError: false,
360     -329     -260     -    153 +203     -              trust: true,
361     -330     -261     -    154 +204     -              strict: false,
362     -331     -262     -    155 +205     -            });
363     -332     -263     -    156 +206     -            return `<div class="katex-display">${rendered}</div>`;
364     -333     -264     -    157 +207     -          } catch (e) {
365     -334     -265     -    158 +208     -            console.warn('KaTeX bracket render error:', e);
366     -335     -266     -    159 +209     -            return `<div style="color: red; padding: 10px;">LaTeX Error: ${e.message}</div>`;
367     -336     -267     -    160 +210     -          }
368     -337     -268     -    161 +211     -        },
369     -338     -269     -    162 +212     -      },
370     -339     -270     -    163 +213     -      {
371     -340     -271     -    164 +214     -        name: 'latexInlineParen',
372     -341     -272     -    165 +215     -        level: 'inline',
373     -342     -273     -    166 +216     -        start(src) {
374     -343     -274     -    167 +217     -          return src.match(/\\\(/)?.index;
375     -344     -275     -    168 +218     -        },
376     -345     -276     -    169 +219     -        tokenizer(src) {
377     -346     -277     -    170 +220     -          const match = src.match(/^\\\(([\s\S]*?)\\\)/);
378     -347     -278     -    171 +221     -          if (match) {
379     -348     -279     -    172 +222     -            return {
380     -349     -280     -    173 +223     -              type: 'latexInlineParen',
381     -350     -281     -    174 +224     -              raw: match[0],
382     -351     -282     -    175 +225     -              text: match[1].trim(),
383     -352     -283     -    176 +226     -            };
384     -353     -284     -    177 +227     -          }
385     -354     -285     -    178 +228     -        },
386     -355     -286     -    179 +229     -        renderer(token) {
387     -356     -287     -    180 +230     -          try {
388     -357     -288     -    181 +231     -            return katex.renderToString(token.text, {
389     -358     -289     -    182 +232     -              displayMode: false,
390     -359     -290     -    183 +233     -              throwOnError: false,
391     -360     -291     -    184 +234     -              trust: true,
392     -361     -292     -    185 +235     -              strict: false,
393     -362     -293     -    186 +236     -            });
394     -363     -294     -    187 +237     -          } catch (e) {
395     -364     -295     -    188 +238     -            console.warn('KaTeX paren render error:', e);
396     -365     -296     -    189 +239     -            return `<span style="color: red;">LaTeX Error</span>`;
397     -366     -297     -    190 +240     -          }
398     -367     -298     -    191 +241     -        },
399     -368     -299     -    192 +242     -      },
400     -369     -300     -    193 +243 152        {
401     -370     -301     -    194 +244 153          name: 'mathBlock',
402     -371     -302     -    195 +245 154          level: 'block',
403     -372     -303     -    196 +@@ -503,101 +412,10 @@ graph TD
404     -373     -304     -    197 +503 412      return textarea.value;
405     -374     -305     -    198 +504 413    }
406     -375     -306     -    199 +505 414  
407     -376     -307     -    200 +506     -  // Add LaTeX environment extensions that render directly with KaTeX
408     -377     -308     -    201 +    415 +  // Keep only subscript and superscript extensions
409     -378     -309     -    202 +    416 +  // Remove LaTeX environment extensions that don't work with KaTeX
410     -379     -310     -    203 +507 417    marked.use({
411     -380     -311     -    204 +508 418      extensions: [
412     -381     -312     -    205 +509     -      {
413     -382     -313     -    206 +510     -        name: 'latexEnvironment',
414     -383     -314     -    207 +511     -        level: 'block',
415     -384     -315     -    208 +512     -        start(src) {
416     -385     -316     -    209 +513     -          return src.match(/^\\begin\{/)?.index;
417     -386     -317     -    210 +514     -        },
418     -387     -318     -    211 +515     -        tokenizer(src) {
419     -388     -319     -    212 +516     -          const match = src.match(/^\\begin\{([^}]+)\}([\s\S]*?)\\end\{\1\}/);
420     -389     -320     -    213 +517     -          if (match) {
421     -390     -321     -    214 +518     -            return {
422     -391     -322     -    215 +519     -              type: 'latexEnvironment',
423     -392     -323     -    216 +520     -              raw: match[0],
424     -393     -324     -    217 +521     -              text: match[0],
425     -394     -325     -    218 +522     -            };
426     -395     -326     -    219 +523     -          }
427     -396     -327     -    220 +524     -        },
428     -397     -328     -    221 +525     -        renderer(token) {
429     -398     -329     -    222 +526     -          try {
430     -399     -330     -    223 +527     -            const rendered = katex.renderToString(token.text, {
431     -400     -331     -    224 +528     -              displayMode: true,
432     -401     -332     -    225 +529     -              throwOnError: false,
433     -402     -333     -    226 +530     -              trust: true,
434     -403     -334     -    227 +531     -              strict: false,
435     -404     -335     -    228 +532     -            });
436     -405     -336     -    229 +533     -            return `<div class="katex-display">${rendered}</div>`;
437     -406     -337     -    230 +534     -          } catch (e) {
438     -407     -338     -    231 +535     -            console.warn('KaTeX environment render error:', e);
439     -408     -339     -    232 +536     -            return `<div style="color: red; padding: 10px;">LaTeX Error: ${e.message}</div>`;
440     -409     -340     -    233 +537     -          }
441     -410     -341     -    234 +538     -        },
442     -411     -342     -    235 +539     -      },
443     -412     -343     -    236 +540     -      {
444     -413     -344     -    237 +541     -        name: 'latexDisplayBracket',
445     -414     -345     -    238 +542     -        level: 'block',
446     -415     -346     -    239 +543     -        start(src) {
447     -416     -347     -    240 +544     -          return src.match(/^\\\[/)?.index;
448     -417     -348     -    241 +545     -        },
449     -418     -349     -    242 +546     -        tokenizer(src) {
450     -419     -350     -    243 +547     -          const match = src.match(/^\\\[([\s\S]*?)\\\]/);
451     -420     -351     -    244 +548     -          if (match) {
452     -421     -352     -    245 +549     -            return {
453     -422     -353     -    246 +550     -              type: 'latexDisplayBracket',
454     -423     -354     -    247 +551     -              raw: match[0],
455     -424     -355     -    248 +552     -              text: match[1].trim(),
456     -425     -356     -    249 +553     -            };
457     -426     -357     -    250 +554     -          }
458     -427     -358     -    251 +555     -        },
459     -428     -359     -    252 +556     -        renderer(token) {
460     -429     -360     -    253 +557     -          try {
461     -430     -361     -    254 +558     -            const rendered = katex.renderToString(token.text, {
462     -431     -362     -    255 +559     -              displayMode: true,
463     -432     -363     -    256 +560     -              throwOnError: false,
464     -433     -364     -    257 +561     -              trust: true,
465     -434     -365     -    258 +562     -              strict: false,
466     -435     -366     -    259 +563     -            });
467     -436     -367     -    260 +564     -            return `<div class="katex-display">${rendered}</div>`;
468     -437     -368     -    261 +565     -          } catch (e) {
469     -438     -369     -    262 +566     -            console.warn('KaTeX bracket render error:', e);
470     -439     -370     -    263 +567     -            return `<div style="color: red; padding: 10px;">LaTeX Error: ${e.message}</div>`;
471     -440     -371     -    264 +568     -          }
472     -441     -372     -    265 +569     -        },
473     -442     -373     -    266 +570     -      },
474     -443     -374     -    267 +571     -      {
475     -444     -375     -    268 +572     -        name: 'latexInlineParen',
476     -445     -376     -    269 +573     -        level: 'inline',
477     -446     -377     -    270 +574     -        start(src) {
478     -447     -378     -    271 +575     -          return src.match(/\\\(/)?.index;
479     -448     -379     -    272 +576     -        },
480     -449     -380     -    273 +577     -        tokenizer(src) {
481     -450     -381     -    274 +578     -          const match = src.match(/^\\\(([\s\S]*?)\\\)/);
482     -451     -382     -    275 +579     -          if (match) {
483     -452     -383     -    276 +580     -            return {
484     -453     -384     -    277 +581     -              type: 'latexInlineParen',
485     -454     -385     -    278 +582     -              raw: match[0],
486     -455     -386     -    279 +583     -              text: match[1].trim(),
487     -456     -387     -    280 +584     -            };
488     -457     -388     -    281 +585     -          }
489     -458     -389     -    282 +586     -        },
490     -459     -390     -    283 +587     -        renderer(token) {
491     -460     -391     -    284 +588     -          try {
492     -461     -392     -    285 +589     -            return katex.renderToString(token.text, {
493     -462     -393     -    286 +590     -              displayMode: false,
494     -463     -394     -    287 +591     -              throwOnError: false,
495     -464     -395     -    288 +592     -              trust: true,
496     -465     -396     -    289 +593     -              strict: false,
497     -466     -397     -    290 +594     -            });
498     -467     -398     -    291 +595     -          } catch (e) {
499     -468     -399     -    292 +596     -            console.warn('KaTeX paren render error:', e);
500     -469     -400     -    293 +597     -            return `<span style="color: red;">LaTeX Error</span>`;
501     -470     -401     -    294 +598     -          }
502     -471     -402     -    295 +599     -        },
503     -472     -403     -    296 +600     -      },
504     -473     -404     -    297 +601 419        {
505     -474     -405     -    298 +602 420          name: 'subscript',
506     -475     -406     -    299 +603 421          level: 'inline',
507     -476     -407     -    300 +@@ -641,7 +459,7 @@ graph TD
508     -477     -408     -    301 +641 459      ],
509     -478     -409     -    302 +642 460    });
510     -479     -410     -    303 +643 461  
511     -480     -411     -    304 +644     -  console.log('‚úÖ LaTeX environments, subscript, and superscript enabled');
512     -481     -412     -    305 +    462 +  console.log('‚úÖ Subscript and superscript enabled (LaTeX environments display as-is)');
513     -482     -413     -    306 +645 463  
514     -483     -414     -    307 +646 464    // Render markdown
515     -484     -415     -    308 +647 465    function renderMarkdown() {
516     -485     -416     -    309 +@@ -685,22 +503,9 @@ graph TD
517     -486     -417     -    310 +685 503        // Apply Prism syntax highlighting using PrismService
518     -487     -418     -    311 +686 504        prismService.highlightAll(preview);
519     -488     -419     -    312 +687 505  
520     -489     -420     -    313 +688     -      // Apply KaTeX auto-render only for any remaining $...$ syntax
521     -490     -421     -    314 +689     -      if (typeof renderMathInElement !== 'undefined') {
522     -491     -422     -    315 +690     -        try {
523     -492     -423     -    316 +691     -          renderMathInElement(preview, {
524     -493     -424     -    317 +692     -            delimiters: [
525     -494     -425     -    318 +693     -              { left: '$$', right: '$$', display: true },
526     -495     -426     -    319 +694     -              { left: '$', right: '$', display: false },
527     -496     -427     -    320 +695     -            ],
528     -497     -428     -    321 +696     -            throwOnError: false,
529     -498     -429     -    322 +697     -            trust: true,
530     -499     -430     -    323 +698     -            strict: false,
531     -500     -431     -    324 +699     -          });
532     -501     -432     -    325 +700     -        } catch (e) {
533     -502     -433     -    326 +701     -          console.warn('KaTeX auto-render error:', e);
534     -503     -434     -    327 +702     -        }
535     -504     -435     -    328 +703     -      }
536     -505     -436     -    329 +    506 +      // NOTE: KaTeX auto-render is DISABLED
537     -506     -437     -    330 +    507 +      // We handle all math via marked.js extensions ($...$ and $$...$$)
538     -507     -438     -    331 +    508 +      // KaTeX auto-render was causing issues with unsupported LaTeX environments
539     -508     -439     -    332 +704 509  
540     -509     -440     -    333 +705 510        // Save content using StorageManager
541     -510     -441     -    334 +706 511        storageManager.set('markdownContent', markdownText);
542     -511     -442     -    335 +@@ -1167,11 +972,21 @@ graph TD
543     -512     -443     -    336 +1167 972    // Load saved theme using ThemeManager
544     -513     -444     -    337 +1168 973    const savedTheme = storageManager.get('selectedTheme');
545     -514     -445     -    338 +1169 974    if (savedTheme) {
546     -515     -446     -    339 +1170     -    themeSelector.value = savedTheme;
547     -516     -447     -    340 +1171     -    themeManager.loadTheme(savedTheme).catch(err => {
548     -517     -448     -    341 +1172     -      console.error('Failed to load saved theme:', err);
549     -518     -449     -    342 +1173     -      themeManager.loadTheme('default-light');
550     -519     -450     -    343 +1174     -    });
551     -520     -451     -    344 +    975 +    // Load theme first, then sync dropdown only on success
552     -521     -452     -    345 +    976 +    themeManager
553     -522     -453     -    346 +    977 +      .loadTheme(savedTheme)
554     -523     -454     -    347 +    978 +      .then(() => {
555     -524     -455     -    348 +    979 +        // Theme loaded successfully - sync dropdown
556     -525     -456     -    349 +    980 +        themeSelector.value = savedTheme;
557     -526     -457     -    350 +    981 +        console.log(`‚úÖ Theme restored: ${savedTheme}`);
558     -527     -458     -    351 +    982 +      })
559     -528     -459     -    352 +    983 +      .catch(err => {
560     -529     -460     -    353 +    984 +        console.error('Failed to load saved theme:', err);
561     -530     -461     -    354 +    985 +        // Fallback to default-light on error
562     -531     -462     -    355 +    986 +        themeManager.loadTheme('default-light').then(() => {
563     -532     -463     -    356 +    987 +          themeSelector.value = 'default-light';
564     -533     -464     -    357 +    988 +        });
565     -534     -465     -    358 +    989 +      });
566     -535     -466     -    359 +1175 990    }
567     -536     -467     -    360 +1176 991  
568     -537     -468     -    361 +1177 992    // Zoom functionality
569     -538     -469     -    362 +1178 993  
570     -539     -470     -    363 +
571     -540     -471     -    364 +```
572     -541     -472     -    365 +
573     -542     -473     -    366 +
574     -543     -474     -    367 +### üìÑ `themes/sunset-dark.css`
575     -544     -475     -    368 +
576     -545     -476     -    369 +**Type:** Stylesheet üé®
577     -546     -477     -    370 +
578     -547     -478     -    371 +```diff
579     -548     -479     -    372 +@@ -1,4 +1,4 @@
580     -549     -480     -    373 +  1     -r/* Sunset Dark Theme */
581     -550     -481     -    374 +      1 +/* Sunset Dark Theme */
582     -551     -482     -    375 +  2   2  :root {
583     -552     -483     -    376 +  3   3    --bg-primary: #1c0a00;
584     -553     -484     -    377 +  4   4    --bg-secondary: #2d1b0e;
585     -554     -485     -    378 +  5   5  
586     -555     -486     - 95 379  
587     -556     -487     - 96 380  ```
588     -557     -488     - 97 381  
589     -558     -489     -@@ -137,4 +421,4 @@ Please provide specific feedback on:
590     -559     -490     -137 421  
591     -560     -491     -138 422  ---
592     -561     -492     -139 423  *Generated by AI Visual Code Review v2.0 - Unified Export Script*
593     -562     -493     -140     -*Files processed: 2/2 | Errors: 0 | Generated: 2025-12-06T22:55:31.083Z*
594     -563     -494     -    424 +*Files processed: 3/3 | Errors: 0 | Generated: 2025-12-07T02:57:20.361Z*
595     -564     -495     -141 425  
596     -565     -     43 +  9     -memory-bank/activeContext.md |  52 +++++++++-
597     -566     -     44 + 10     - script.js                    | 231 +++++--------------------------------------
598     -567     -     45 + 11     - themes/sunset-dark.css       |   2 +-
599     -568     -     46 + 12     - 3 files changed, 75 insertions(+), 210 deletions(-)
600     -569     -     47 +      9 +AI_REVIEW.md                                       | 428 +++++++++++++++++----
601     -570     -     48 +     10 + docs/02-architecture/mermaid-theme-architecture.md | 208 ++++++++++
602     -571     -     49 +     11 + docs/02-architecture/prism-token-architecture.md   | 226 +++++++++++
603     -572     -     50 +     12 + script.js                                          |  52 ++-
604     -573     -     51 +     13 + src/js/services/MermaidService.js                  | 230 +++++++++--
605     -574     -     52 +     14 + style.css                                          | 147 ++++---
606     -575     -     53 +     15 + themes/default-dark.css                            | 186 ++++++++-
607     -576     -     54 +     16 + themes/default-light.css                           | 186 ++++++++-
608     -577     -     55 +     17 + themes/forest-dark.css                             | 167 ++++++--
609     -578     -     56 +     18 + themes/forest-light.css                            | 138 ++++++-
610     -579     -     57 +     19 + themes/neon-dark.css                               | 166 ++++++--
611     -580     -     58 +     20 + themes/neon-light.css                              | 138 ++++++-
612     -581     -     59 +     21 + themes/obsidian-dark.css                           | 138 ++++++-
613     -582     -     60 +     22 + themes/obsidian-light.css                          | 138 ++++++-
614     -583     -     61 +     23 + themes/ocean-dark.css                              | 138 ++++++-
615     -584     -     62 +     24 + themes/ocean-light.css                             | 138 ++++++-
616     -585     -     63 +     25 + themes/sunset-dark.css                             | 138 ++++++-
617     -586     -     64 +     26 + themes/sunset-light.css                            | 138 ++++++-
618     -587     -     65 +     27 + 18 files changed, 2762 insertions(+), 338 deletions(-)
619     -588     -     66 + 13  28  ```
620     -589     -     67 + 14  29  
621     -590     -     68 + 15     -## üìù Files Changed (3/3 selected)
622     -591     -     69 +     30 +## üìù Files Changed (18/18 selected)
623     -592     -     70 + 16  31  
624     -593     -     71 + 17  32  
625     -594     -     72 + 18     -### üìÑ `memory-bank/activeContext.md`
626     -595     -     73 +     33 +### üìÑ `AI_REVIEW.md`
627     -596     -     74 + 19  34  
628     -597     -     75 + 20  35  **Type:** Documentation üìñ
629     -598     -     76 + 21  36  
630     -599     -     77 + 22  37  ```diff
631     -600     -     78 + 23     -@@ -202,7 +202,57 @@ html = restoreLatexEnvironments(html);
632     -601     -     79 + 24     -202 202  
633     -602     -     80 + 25     -203 203  ## Open Questions
634     -603     -     81 + 26     -204 204  
635     -604     -     82 + 27     -205     -None - All LaTeX rendering issues resolved
636     -605     -     83 + 28     -    205 +None - All issues resolved
637     -606     -     84 +     38 +@@ -1,4 +1,4 @@
638     -607     -     85 +     39 +  1     -# üîç Code Review - 12/7/2025, 4:25:31 AM
639     -608     -     86 +     40 +      1 +# üîç Code Review - 12/7/2025, 8:27:20 AM
640     -609     -     87 +     41 +  2   2  
641     -610     -     88 +     42 +  3   3  **Project:** AI Visual Code Review
642     -611     -     89 +     43 +  4   4  **Generated by:** AI Visual Code Review v2.0
643     -612     -     90 +     44 +@@ -6,38 +6,80 @@
644     -613     -     91 +     45 +  6   6  ## üìä Change Summary
645     -614     -     92 +     46 +  7   7  
646     -615     -     93 +     47 +  8   8  ```
647     -616     -     94 +     48 +  9     -index.html | 11 +++++++++++
648     -617     -     95 +     49 + 10     - script.js  | 21 ++++++++++++++++++++-
649     -618     -     96 +     50 + 11     - 2 files changed, 31 insertions(+), 1 deletion(-)
650     -619     -     97 +     51 +      9 +memory-bank/activeContext.md |  52 +++++++++-
651     -620     -     98 +     52 +     10 + script.js                    | 231 +++++--------------------------------------
652     -621     -     99 +     53 +     11 + themes/sunset-dark.css       |   2 +-
653     -622     -    100 +     54 +     12 + 3 files changed, 75 insertions(+), 210 deletions(-)
654     -623     -    101 +     55 + 12  13  ```
655     -624     -    102 +     56 + 13  14  
656     -625     -    103 +     57 + 14     -## üìù Files Changed (2/2 selected)
657     -626     -    104 +     58 +     15 +## üìù Files Changed (3/3 selected)
658     -627     -    105 +     59 + 15  16  
659     -628     -    106 +     60 + 16  17  
660     -629     -    107 +     61 + 17     -### üìÑ `index.html`
661     -630     -    108 +     62 +     18 +### üìÑ `memory-bank/activeContext.md`
662     -631     -    109 +     63 + 18  19  
663     -632     -    110 +     64 + 19     -**Type:** HTML Template üåê
664     -633     -    111 +     65 +     20 +**Type:** Documentation üìñ
665     -634     -    112 +     66 + 20  21  
666     -635     -    113 +     67 + 21  22  ```diff
667     -636     -    114 +     68 + 22     -@@ -55,6 +55,17 @@
668     -637     -    115 +     69 + 23     - 55  55              üìÅ Open Folder
669     -638     -    116 +     70 + 24     - 56  56            </button>
670     -639     -    117 +     71 + 25     - 57  57  
671     -640     -    118 +     72 + 26     -     58 +          <!-- Collapse/Expand Sidebar -->
672     -641     -    119 +     73 + 27     -     59 +          <button
673     -642     -    120 +     74 + 28     -     60 +            class="btn"
674     -643     -    121 +     75 + 29     -     61 +            id="toggle-sidebar-btn"
675     -644     -    122 +     76 + 30     -     62 +            title="Toggle File Browser"
676     -645     -    123 +     77 + 31     -     63 +            aria-label="Toggle File Browser Sidebar"
677     -646     -    124 +     78 + 32     -     64 +            style="display: none"
678     -647     -    125 +     79 + 33     -     65 +          >
679     -648     -    126 +     80 + 34     -     66 +            ‚óÄ Hide Files
680     -649     -    127 +     81 + 35     -     67 +          </button>
681     -650     -    128 +     82 + 36     -     68 +
682     -651     -    129 +     83 + 37     - 58  69            <!-- View Mode Buttons -->
683     -652     -    130 +     84 + 38     - 59  70            <div class="view-mode-buttons">
684     -653     -    131 +     85 + 39     - 60  71              <button
685     -654     -    132 +     86 + 40     - 61  72  
686     -655     -    133 +     87 +     23 +@@ -202,7 +202,57 @@ html = restoreLatexEnvironments(html);
687     -656     -    134 +     88 +     24 +202 202  
688     -657     -    135 +     89 +     25 +203 203  ## Open Questions
689     -658     -    136 +     90 +     26 +204 204  
690     -659     -    137 +     91 +     27 +205     -None - All LaTeX rendering issues resolved
691     -660     -    138 +     92 +     28 +    205 +None - All issues resolved
692     -661     -    139 +     93 +     29 +    206 +
693     -662     -    140 +     94 +     30 +    207 +## Recent Fixes (Latest Session)
694     -663     -    141 +     95 +     31 +    208 +
695     -664     -    142 +     96 +     32 +    209 +### Theme Dropdown Sync Fix ‚úÖ
696     -665     -    143 +     97 +     33 +    210 +
697     -666     -    144 +     98 +     34 +    211 +**Problem:** Theme dropdown showing "Default Light" even when sunset-dark theme was loaded from LocalStorage.
698     -667     -    145 +     99 +     35 +    212 +
699     -668     -    146 +    100 +     36 +    213 +**Root Cause:** Race condition in theme loading - dropdown was being set BEFORE async theme load completed.
700     -669     -    147 +    101 +     37 +    214 +
701     -670     -    148 +    102 +     38 +    215 +**Solution:**
702     -671     -    149 +    103 +     39 +    216 +
703     -672     -    150 +    104 +     40 +    217 +```javascript
704     -673     -    151 +    105 +     41 +    218 +// OLD (buggy):
705     -674     -    152 +    106 +     42 +    219 +if (savedTheme) {
706     -675     -    153 +    107 +     43 +    220 +  themeSelector.value = savedTheme; // Sets immediately
707     -676     -    154 +    108 +     44 +    221 +  themeManager.loadTheme(savedTheme); // Async, not awaited
708     -677     -    155 +    109 +     45 +    222 +}
709     -678     -    156 +    110 +     46 +    223 +
710     -679     -    157 +    111 +     47 +    224 +// NEW (fixed):
711     -680     -    158 +    112 +     48 +    225 +if (savedTheme) {
712     -681     -    159 +    113 +     49 +    226 +  themeManager
713     -682     -    160 +    114 +     50 +    227 +    .loadTheme(savedTheme)
714     -683     -    161 +    115 +     51 +    228 +    .then(() => {
715     -684     -    162 +    116 +     52 +    229 +      themeSelector.value = savedTheme; // Only after successful load
716     -685     -    163 +    117 +     53 +    230 +      console.log(`‚úÖ Theme restored: ${savedTheme}`);
717     -686     -    164 +    118 +     54 +    231 +    })
718     -687     -    165 +    119 +     55 +    232 +    .catch(err => {
719     -688     -    166 +    120 +     56 +    233 +      // Fallback with proper sync
720     -689     -    167 +    121 +     57 +    234 +      themeManager.loadTheme('default-light').then(() => {
721     -690     -    168 +    122 +     58 +    235 +        themeSelector.value = 'default-light';
722     -691     -    169 +    123 +     59 +    236 +      });
723     -692     -    170 +    124 +     60 +    237 +    });
724     -693     -    171 +    125 +     61 +    238 +}
725     -694     -    172 +    126 +     62 +    239 +```
726     -695     -    173 +    127 +     63 +    240 +
727     -696     -    174 +    128 +     64 +    241 +**Key Changes:**
728     -697     -    175 +    129 +     65 +    242 +
729     -698     -    176 +    130 +     66 +    243 +1. Await theme load completion before syncing dropdown
730     -699     -    177 +    131 +     67 +    244 +2. Added success callback for dropdown update
731     -700     -    178 +    132 +     68 +    245 +3. Added error handling with fallback
732     -701     -    179 +    133 +     69 +    246 +4. Added console logging for debugging
733     -702     -    180 +    134 +     70 +    247 +
734     -703     -    181 +    135 +     71 +    248 +**Results:**
735     -704     -    182 +    136 +     72 +    249 +
736     -705     -    183 +    137 +     73 +    250 +- ‚úÖ Dropdown now syncs correctly with all themes
737     -706     -    184 +    138 +     74 +    251 +- ‚úÖ No more race conditions
738     -707     -    185 +    139 +     75 +    252 +- ‚úÖ Proper error handling
739     -708     -    186 +    140 +     76 +    253 +- ‚úÖ Works for all 12 themes (6 theme families √ó 2 variants)
740     -709     -    187 +    141 +     77 +    254 +
741     -710     -    188 +    142 +     78 +    255 +**Files Modified:** `script.js` (lines 1167-1183)
742     -711     -    189 +    143 +     79 +206 256  
743     -712     -    190 +    144 +     80 +207 257  ## Performance Observations
744     -713     -    191 +    145 +     81 +208 258  
745     -714     -    192 +    146 +     82 +209 259  
746     -715     -    193 +    147 + 41  83  
747     -716     -    194 +    148 + 42  84  ```
748     -717     -    195 +    149 + 43  85  
749     -718     -    196 +    150 +@@ -47,51 +89,293 @@ index.html | 11 +++++++++++
750     -719     -    197 +    151 + 47  89  **Type:** JavaScript Source File üü®
751     -720     -    198 +    152 + 48  90  
752     -721     -    199 +    153 + 49  91  ```diff
753     -722     -    200 +    154 + 50     -@@ -796,6 +796,7 @@ graph TD
754     -723     -    201 +    155 + 51     -796 796    // Folder browser DOM elements
755     -724     -    202 +    156 + 52     -797 797    const fileBrowser = document.getElementById('file-browser');
756     -725     -    203 +    157 + 53     -798 798    const openFolderBtn = document.getElementById('open-folder-btn');
757     -726     -    204 +    158 + 54     -    799 +  const toggleSidebarBtn = document.getElementById('toggle-sidebar-btn');
758     -727     -    205 +    159 + 55     -799 800    const closeBrowserBtn = document.getElementById('close-browser-btn');
759     -728     -    206 +    160 + 56     -800 801    const fileTree = document.getElementById('file-tree');
760     -729     -    207 +    161 + 57     -801 802    const currentFolderNameEl = document.getElementById('current-folder-name');
761     -730     -    208 +    162 + 58     -@@ -804,6 +805,7 @@ graph TD
762     -731     -    209 +    163 + 59     -804 805    // Folder browser state (using let to allow reassignment)
763     -732     -    210 +    164 + 60     -805 806    let folderFiles = [];
764     -733     -    211 +    165 + 61     -806 807    let activeFileHandle = null;
765     -734     -    212 +    166 + 62     -    808 +  const sidebarCollapsed = false;
766     -735     -    213 +    167 + 63     -807 809  
767     -736     -    214 +    168 + 64     -808 810    // Open folder handler
768     -737     -    215 +    169 + 65     -809 811    openFolderBtn.addEventListener('click', async () => {
769     -738     -    216 +    170 + 66     -@@ -843,9 +845,26 @@ graph TD
770     -739     -    217 +    171 + 67     -843 845      console.log(`‚úÖ Loaded ${result.totalFiles} markdown files from ${result.folderName}`);
771     -740     -    218 +    172 + 68     -844 846    });
772     -741     -    219 +    173 + 69     -845 847  
773     -742     -    220 +    174 + 70     -846     -  // Close browser handler
774     -743     -    221 +    175 + 71     -    848 +  // Toggle sidebar collapse/expand
775     -744     -    222 +    176 + 72     -    849 +  toggleSidebarBtn.addEventListener('click', () => {
776     -745     -    223 +    177 + 73     -    850 +    if (fileBrowser.style.display === 'none') {
777     -746     -    224 +    178 + 74     -    851 +      // Expand sidebar
778     -747     -    225 +    179 + 75     -    852 +      fileBrowser.style.display = 'flex';
779     -748     -    226 +    180 + 76     -    853 +      toggleSidebarBtn.textContent = '‚óÄ Hide Files';
780     -749     -    227 +    181 + 77     -    854 +      toggleSidebarBtn.title = 'Hide File Browser';
781     -750     -    228 +    182 + 78     -    855 +    } else {
782     -751     -    229 +    183 + 79     -    856 +      // Collapse sidebar (keep data)
783     -752     -    230 +    184 + 80     -    857 +      fileBrowser.style.display = 'none';
784     -753     -    231 +    185 + 81     -    858 +      toggleSidebarBtn.textContent = '‚ñ∂ Show Files';
785     -754     -    232 +    186 + 82     -    859 +      toggleSidebarBtn.title = 'Show File Browser';
786     -755     -    233 +    187 + 83     -    860 +    }
787     -756     -    234 +    188 + 84     -    861 +  });
788     -757     -    235 +    189 + 85     -    862 +
789     -758     -    236 +    190 + 86     -    863 +  // Close browser handler (clears data)
790     -759     -    237 +    191 + 87     -847 864    closeBrowserBtn.addEventListener('click', () => {
791     -760     -    238 +    192 + 88     -848 865      fileBrowser.style.display = 'none';
792     -761     -    239 +    193 + 89     -    866 +    toggleSidebarBtn.style.display = 'none';
793     -762     -    240 +    194 + 90     -    867 +    openFolderBtn.style.display = 'inline-block';
794     -763     -    241 +    195 + 91     -849 868      folderFiles = [];
795     -764     -    242 +    196 + 92     -850 869      activeFileHandle = null;
796     -765     -    243 +    197 + 93     -851 870    });
797     -766     -    244 +    198 + 94     -852 871  
798     -767     -    245 +    199 +     92 +@@ -145,101 +145,10 @@ function configureMarkedExtensions() {
799     -768     -    246 +    200 +     93 +145 145      return;
800     -769     -    247 +    201 +     94 +146 146    }
801     -770     -    248 +    202 +     95 +147 147  
802     -771     -    249 +    203 +     96 +148     -  // Add LaTeX environment extensions
803     -772     -    250 +    204 +     97 +    148 +  // Add inline math and text formatting extensions only
804     -773     -    251 +    205 +     98 +    149 +  // LaTeX environments (align, gather, etc.) are not supported by KaTeX
805     -774     -    252 +    206 +     99 +149 150    marked.use({
806     -775     -    253 +    207 +    100 +150 151      extensions: [
807     -776     -    254 +    208 +    101 +151     -      {
808     -777     -    255 +    209 +    102 +152     -        name: 'latexEnvironment',
809     -778     -    256 +    210 +    103 +153     -        level: 'block',
810     -779     -    257 +    211 +    104 +154     -        start(src) {
811     -780     -    258 +    212 +    105 +155     -          return src.match(/^\\begin\{/)?.index;
812     -781     -    259 +    213 +    106 +156     -        },
813     -782     -    260 +    214 +    107 +157     -        tokenizer(src) {
814     -783     -    261 +    215 +    108 +158     -          const match = src.match(/^\\begin\{([^}]+)\}([\s\S]*?)\\end\{\1\}/);
815     -784     -    262 +    216 +    109 +159     -          if (match) {
816     -785     -    263 +    217 +    110 +160     -            return {
817     -786     -    264 +    218 +    111 +161     -              type: 'latexEnvironment',
818     -787     -    265 +    219 +    112 +162     -              raw: match[0],
819     -788     -    266 +    220 +    113 +163     -              text: match[0],
820     -789     -    267 +    221 +    114 +164     -            };
821     -790     -    268 +    222 +    115 +165     -          }
822     -791     -    269 +    223 +    116 +166     -        },
823     -792     -    270 +    224 +    117 +167     -        renderer(token) {
824     -793     -    271 +    225 +    118 +168     -          try {
825     -794     -    272 +    226 +    119 +169     -            const rendered = katex.renderToString(token.text, {
826     -795     -    273 +    227 +    120 +170     -              displayMode: true,
827     -796     -    274 +    228 +    121 +171     -              throwOnError: false,
828     -797     -    275 +    229 +    122 +172     -              trust: true,
829     -798     -    276 +    230 +    123 +173     -              strict: false,
830     -799     -    277 +    231 +    124 +174     -            });
831     -800     -    278 +    232 +    125 +175     -            return `<div class="katex-display">${rendered}</div>`;
832     -801     -    279 +    233 +    126 +176     -          } catch (e) {
833     -802     -    280 +    234 +    127 +177     -            console.warn('KaTeX environment render error:', e);
834     -803     -    281 +    235 +    128 +178     -            return `<div style="color: red; padding: 10px;">LaTeX Error: ${e.message}</div>`;
835     -804     -    282 +    236 +    129 +179     -          }
836     -805     -    283 +    237 +    130 +180     -        },
837     -806     -    284 +    238 +    131 +181     -      },
838     -807     -    285 +    239 +    132 +182     -      {
839     -808     -    286 +    240 +    133 +183     -        name: 'latexDisplayBracket',
840     -809     -    287 +    241 +    134 +184     -        level: 'block',
841     -810     -    288 +    242 +    135 +185     -        start(src) {
842     -811     -    289 +    243 +    136 +186     -          return src.match(/^\\\[/)?.index;
843     -812     -    290 +    244 +    137 +187     -        },
844     -813     -    291 +    245 +    138 +188     -        tokenizer(src) {
845     -814     -    292 +    246 +    139 +189     -          const match = src.match(/^\\\[([\s\S]*?)\\\]/);
846     -815     -    293 +    247 +    140 +190     -          if (match) {
847     -816     -    294 +    248 +    141 +191     -            return {
848     -817     -    295 +    249 +    142 +192     -              type: 'latexDisplayBracket',
849     -818     -    296 +    250 +    143 +193     -              raw: match[0],
850     -819     -    297 +    251 +    144 +194     -              text: match[1].trim(),
851     -820     -    298 +    252 +    145 +195     -            };
852     -821     -    299 +    253 +    146 +196     -          }
853     -822     -    300 +    254 +    147 +197     -        },
854     -823     -    301 +    255 +    148 +198     -        renderer(token) {
855     -824     -    302 +    256 +    149 +199     -          try {
856     -825     -    303 +    257 +    150 +200     -            const rendered = katex.renderToString(token.text, {
857     -826     -    304 +    258 +    151 +201     -              displayMode: true,
858     -827     -    305 +    259 +    152 +202     -              throwOnError: false,
859     -828     -    306 +    260 +    153 +203     -              trust: true,
860     -829     -    307 +    261 +    154 +204     -              strict: false,
861     -830     -    308 +    262 +    155 +205     -            });
862     -831     -    309 +    263 +    156 +206     -            return `<div class="katex-display">${rendered}</div>`;
863     -832     -    310 +    264 +    157 +207     -          } catch (e) {
864     -833     -    311 +    265 +    158 +208     -            console.warn('KaTeX bracket render error:', e);
865     -834     -    312 +    266 +    159 +209     -            return `<div style="color: red; padding: 10px;">LaTeX Error: ${e.message}</div>`;
866     -835     -    313 +    267 +    160 +210     -          }
867     -836     -    314 +    268 +    161 +211     -        },
868     -837     -    315 +    269 +    162 +212     -      },
869     -838     -    316 +    270 +    163 +213     -      {
870     -839     -    317 +    271 +    164 +214     -        name: 'latexInlineParen',
871     -840     -    318 +    272 +    165 +215     -        level: 'inline',
872     -841     -    319 +    273 +    166 +216     -        start(src) {
873     -842     -    320 +    274 +    167 +217     -          return src.match(/\\\(/)?.index;
874     -843     -    321 +    275 +    168 +218     -        },
875     -844     -    322 +    276 +    169 +219     -        tokenizer(src) {
876     -845     -    323 +    277 +    170 +220     -          const match = src.match(/^\\\(([\s\S]*?)\\\)/);
877     -846     -    324 +    278 +    171 +221     -          if (match) {
878     -847     -    325 +    279 +    172 +222     -            return {
879     -848     -    326 +    280 +    173 +223     -              type: 'latexInlineParen',
880     -849     -    327 +    281 +    174 +224     -              raw: match[0],
881     -850     -    328 +    282 +    175 +225     -              text: match[1].trim(),
882     -851     -    329 +    283 +    176 +226     -            };
883     -852     -    330 +    284 +    177 +227     -          }
884     -853     -    331 +    285 +    178 +228     -        },
885     -854     -    332 +    286 +    179 +229     -        renderer(token) {
886     -855     -    333 +    287 +    180 +230     -          try {
887     -856     -    334 +    288 +    181 +231     -            return katex.renderToString(token.text, {
888     -857     -    335 +    289 +    182 +232     -              displayMode: false,
889     -858     -    336 +    290 +    183 +233     -              throwOnError: false,
890     -859     -    337 +    291 +    184 +234     -              trust: true,
891     -860     -    338 +    292 +    185 +235     -              strict: false,
892     -861     -    339 +    293 +    186 +236     -            });
893     -862     -    340 +    294 +    187 +237     -          } catch (e) {
894     -863     -    341 +    295 +    188 +238     -            console.warn('KaTeX paren render error:', e);
895     -864     -    342 +    296 +    189 +239     -            return `<span style="color: red;">LaTeX Error</span>`;
896     -865     -    343 +    297 +    190 +240     -          }
897     -866     -    344 +    298 +    191 +241     -        },
898     -867     -    345 +    299 +    192 +242     -      },
899     -868     -    346 +    300 +    193 +243 152        {
900     -869     -    347 +    301 +    194 +244 153          name: 'mathBlock',
901     -870     -    348 +    302 +    195 +245 154          level: 'block',
902     -871     -    349 +    303 +    196 +@@ -503,101 +412,10 @@ graph TD
903     -872     -    350 +    304 +    197 +503 412      return textarea.value;
904     -873     -    351 +    305 +    198 +504 413    }
905     -874     -    352 +    306 +    199 +505 414  
906     -875     -    353 +    307 +    200 +506     -  // Add LaTeX environment extensions that render directly with KaTeX
907     -876     -    354 +    308 +    201 +    415 +  // Keep only subscript and superscript extensions
908     -877     -    355 +    309 +    202 +    416 +  // Remove LaTeX environment extensions that don't work with KaTeX
909     -878     -    356 +    310 +    203 +507 417    marked.use({
910     -879     -    357 +    311 +    204 +508 418      extensions: [
911     -880     -    358 +    312 +    205 +509     -      {
912     -881     -    359 +    313 +    206 +510     -        name: 'latexEnvironment',
913     -882     -    360 +    314 +    207 +511     -        level: 'block',
914     -883     -    361 +    315 +    208 +512     -        start(src) {
915     -884     -    362 +    316 +    209 +513     -          return src.match(/^\\begin\{/)?.index;
916     -885     -    363 +    317 +    210 +514     -        },
917     -886     -    364 +    318 +    211 +515     -        tokenizer(src) {
918     -887     -    365 +    319 +    212 +516     -          const match = src.match(/^\\begin\{([^}]+)\}([\s\S]*?)\\end\{\1\}/);
919     -888     -    366 +    320 +    213 +517     -          if (match) {
920     -889     -    367 +    321 +    214 +518     -            return {
921     -890     -    368 +    322 +    215 +519     -              type: 'latexEnvironment',
922     -891     -    369 +    323 +    216 +520     -              raw: match[0],
923     -892     -    370 +    324 +    217 +521     -              text: match[0],
924     -893     -    371 +    325 +    218 +522     -            };
925     -894     -    372 +    326 +    219 +523     -          }
926     -895     -    373 +    327 +    220 +524     -        },
927     -896     -    374 +    328 +    221 +525     -        renderer(token) {
928     -897     -    375 +    329 +    222 +526     -          try {
929     -898     -    376 +    330 +    223 +527     -            const rendered = katex.renderToString(token.text, {
930     -899     -    377 +    331 +    224 +528     -              displayMode: true,
931     -900     -    378 +    332 +    225 +529     -              throwOnError: false,
932     -901     -    379 +    333 +    226 +530     -              trust: true,
933     -902     -    380 +    334 +    227 +531     -              strict: false,
934     -903     -    381 +    335 +    228 +532     -            });
935     -904     -    382 +    336 +    229 +533     -            return `<div class="katex-display">${rendered}</div>`;
936     -905     -    383 +    337 +    230 +534     -          } catch (e) {
937     -906     -    384 +    338 +    231 +535     -            console.warn('KaTeX environment render error:', e);
938     -907     -    385 +    339 +    232 +536     -            return `<div style="color: red; padding: 10px;">LaTeX Error: ${e.message}</div>`;
939     -908     -    386 +    340 +    233 +537     -          }
940     -909     -    387 +    341 +    234 +538     -        },
941     -910     -    388 +    342 +    235 +539     -      },
942     -911     -    389 +    343 +    236 +540     -      {
943     -912     -    390 +    344 +    237 +541     -        name: 'latexDisplayBracket',
944     -913     -    391 +    345 +    238 +542     -        level: 'block',
945     -914     -    392 +    346 +    239 +543     -        start(src) {
946     -915     -    393 +    347 +    240 +544     -          return src.match(/^\\\[/)?.index;
947     -916     -    394 +    348 +    241 +545     -        },
948     -917     -    395 +    349 +    242 +546     -        tokenizer(src) {
949     -918     -    396 +    350 +    243 +547     -          const match = src.match(/^\\\[([\s\S]*?)\\\]/);
950     -919     -    397 +    351 +    244 +548     -          if (match) {
951     -920     -    398 +    352 +    245 +549     -            return {
952     -921     -    399 +    353 +    246 +550     -              type: 'latexDisplayBracket',
953     -922     -    400 +    354 +    247 +551     -              raw: match[0],
954     -923     -    401 +    355 +    248 +552     -              text: match[1].trim(),
955     -924     -    402 +    356 +    249 +553     -            };
956     -925     -    403 +    357 +    250 +554     -          }
957     -926     -    404 +    358 +    251 +555     -        },
958     -927     -    405 +    359 +    252 +556     -        renderer(token) {
959     -928     -    406 +    360 +    253 +557     -          try {
960     -929     -    407 +    361 +    254 +558     -            const rendered = katex.renderToString(token.text, {
961     -930     -    408 +    362 +    255 +559     -              displayMode: true,
962     -931     -    409 +    363 +    256 +560     -              throwOnError: false,
963     -932     -    410 +    364 +    257 +561     -              trust: true,
964     -933     -    411 +    365 +    258 +562     -              strict: false,
965     -934     -    412 +    366 +    259 +563     -            });
966     -935     -    413 +    367 +    260 +564     -            return `<div class="katex-display">${rendered}</div>`;
967     -936     -    414 +    368 +    261 +565     -          } catch (e) {
968     -937     -    415 +    369 +    262 +566     -            console.warn('KaTeX bracket render error:', e);
969     -938     -    416 +    370 +    263 +567     -            return `<div style="color: red; padding: 10px;">LaTeX Error: ${e.message}</div>`;
970     -939     -    417 +    371 +    264 +568     -          }
971     -940     -    418 +    372 +    265 +569     -        },
972     -941     -    419 +    373 +    266 +570     -      },
973     -942     -    420 +    374 +    267 +571     -      {
974     -943     -    421 +    375 +    268 +572     -        name: 'latexInlineParen',
975     -944     -    422 +    376 +    269 +573     -        level: 'inline',
976     -945     -    423 +    377 +    270 +574     -        start(src) {
977     -946     -    424 +    378 +    271 +575     -          return src.match(/\\\(/)?.index;
978     -947     -    425 +    379 +    272 +576     -        },
979     -948     -    426 +    380 +    273 +577     -        tokenizer(src) {
980     -949     -    427 +    381 +    274 +578     -          const match = src.match(/^\\\(([\s\S]*?)\\\)/);
981     -950     -    428 +    382 +    275 +579     -          if (match) {
982     -951     -    429 +    383 +    276 +580     -            return {
983     -952     -    430 +    384 +    277 +581     -              type: 'latexInlineParen',
984     -953     -    431 +    385 +    278 +582     -              raw: match[0],
985     -954     -    432 +    386 +    279 +583     -              text: match[1].trim(),
986     -955     -    433 +    387 +    280 +584     -            };
987     -956     -    434 +    388 +    281 +585     -          }
988     -957     -    435 +    389 +    282 +586     -        },
989     -958     -    436 +    390 +    283 +587     -        renderer(token) {
990     -959     -    437 +    391 +    284 +588     -          try {
991     -960     -    438 +    392 +    285 +589     -            return katex.renderToString(token.text, {
992     -961     -    439 +    393 +    286 +590     -              displayMode: false,
993     -962     -    440 +    394 +    287 +591     -              throwOnError: false,
994     -963     -    441 +    395 +    288 +592     -              trust: true,
995     -964     -    442 +    396 +    289 +593     -              strict: false,
996     -965     -    443 +    397 +    290 +594     -            });
997     -966     -    444 +    398 +    291 +595     -          } catch (e) {
998     -967     -    445 +    399 +    292 +596     -            console.warn('KaTeX paren render error:', e);
999     -968     -    446 +    400 +    293 +597     -            return `<span style="color: red;">LaTeX Error</span>`;
1000     -969     -    447 +    401 +    294 +598     -          }
1001     -970     -    448 +    402 +    295 +599     -        },
1002     -971     -    449 +    403 +    296 +600     -      },
1003     -972     -    450 +    404 +    297 +601 419        {
1004     -973     -    451 +    405 +    298 +602 420          name: 'subscript',
1005     -974     -    452 +    406 +    299 +603 421          level: 'inline',
1006     -975     -    453 +    407 +    300 +@@ -641,7 +459,7 @@ graph TD
1007     -976     -    454 +    408 +    301 +641 459      ],
1008     -977     -    455 +    409 +    302 +642 460    });
1009     -978     -    456 +    410 +    303 +643 461  
1010     -979     -    457 +    411 +    304 +644     -  console.log('‚úÖ LaTeX environments, subscript, and superscript enabled');
1011     -980     -    458 +    412 +    305 +    462 +  console.log('‚úÖ Subscript and superscript enabled (LaTeX environments display as-is)');
1012     -981     -    459 +    413 +    306 +645 463  
1013     -982     -    460 +    414 +    307 +646 464    // Render markdown
1014     -983     -    461 +    415 +    308 +647 465    function renderMarkdown() {
1015     -984     -    462 +    416 +    309 +@@ -685,22 +503,9 @@ graph TD
1016     -985     -    463 +    417 +    310 +685 503        // Apply Prism syntax highlighting using PrismService
1017     -986     -    464 +    418 +    311 +686 504        prismService.highlightAll(preview);
1018     -987     -    465 +    419 +    312 +687 505  
1019     -988     -    466 +    420 +    313 +688     -      // Apply KaTeX auto-render only for any remaining $...$ syntax
1020     -989     -    467 +    421 +    314 +689     -      if (typeof renderMathInElement !== 'undefined') {
1021     -990     -    468 +    422 +    315 +690     -        try {
1022     -991     -    469 +    423 +    316 +691     -          renderMathInElement(preview, {
1023     -992     -    470 +    424 +    317 +692     -            delimiters: [
1024     -993     -    471 +    425 +    318 +693     -              { left: '$$', right: '$$', display: true },
1025     -994     -    472 +    426 +    319 +694     -              { left: '$', right: '$', display: false },
1026     -995     -    473 +    427 +    320 +695     -            ],
1027     -996     -    474 +    428 +    321 +696     -            throwOnError: false,
1028     -997     -    475 +    429 +    322 +697     -            trust: true,
1029     -998     -    476 +    430 +    323 +698     -            strict: false,
1030     -999     -    477 +    431 +    324 +699     -          });
1031     -1000     -    478 +    432 +    325 +700     -        } catch (e) {
1032     -1001     -    479 +    433 +    326 +701     -          console.warn('KaTeX auto-render error:', e);
1033     -1002     -    480 +    434 +    327 +702     -        }
1034     -1003     -    481 +    435 +    328 +703     -      }
1035     -1004     -    482 +    436 +    329 +    506 +      // NOTE: KaTeX auto-render is DISABLED
1036     -1005     -    483 +    437 +    330 +    507 +      // We handle all math via marked.js extensions ($...$ and $$...$$)
1037     -1006     -    484 +    438 +    331 +    508 +      // KaTeX auto-render was causing issues with unsupported LaTeX environments
1038     -1007     -    485 +    439 +    332 +704 509  
1039     -1008     -    486 +    440 +    333 +705 510        // Save content using StorageManager
1040     -1009     -    487 +    441 +    334 +706 511        storageManager.set('markdownContent', markdownText);
1041     -1010     -    488 +    442 +    335 +@@ -1167,11 +972,21 @@ graph TD
1042     -1011     -    489 +    443 +    336 +1167 972    // Load saved theme using ThemeManager
1043     -1012     -    490 +    444 +    337 +1168 973    const savedTheme = storageManager.get('selectedTheme');
1044     -1013     -    491 +    445 +    338 +1169 974    if (savedTheme) {
1045     -1014     -    492 +    446 +    339 +1170     -    themeSelector.value = savedTheme;
1046     -1015     -    493 +    447 +    340 +1171     -    themeManager.loadTheme(savedTheme).catch(err => {
1047     -1016     -    494 +    448 +    341 +1172     -      console.error('Failed to load saved theme:', err);
1048     -1017     -    495 +    449 +    342 +1173     -      themeManager.loadTheme('default-light');
1049     -1018     -    496 +    450 +    343 +1174     -    });
1050     -1019     -    497 +    451 +    344 +    975 +    // Load theme first, then sync dropdown only on success
1051     -1020     -    498 +    452 +    345 +    976 +    themeManager
1052     -1021     -    499 +    453 +    346 +    977 +      .loadTheme(savedTheme)
1053     -1022     -    500 +    454 +    347 +    978 +      .then(() => {
1054     -1023     -    501 +    455 +    348 +    979 +        // Theme loaded successfully - sync dropdown
1055     -1024     -    502 +    456 +    349 +    980 +        themeSelector.value = savedTheme;
1056     -1025     -    503 +    457 +    350 +    981 +        console.log(`‚úÖ Theme restored: ${savedTheme}`);
1057     -1026     -    504 +    458 +    351 +    982 +      })
1058     -1027     -    505 +    459 +    352 +    983 +      .catch(err => {
1059     -1028     -    506 +    460 +    353 +    984 +        console.error('Failed to load saved theme:', err);
1060     -1029     -    507 +    461 +    354 +    985 +        // Fallback to default-light on error
1061     -1030     -    508 +    462 +    355 +    986 +        themeManager.loadTheme('default-light').then(() => {
1062     -1031     -    509 +    463 +    356 +    987 +          themeSelector.value = 'default-light';
1063     -1032     -    510 +    464 +    357 +    988 +        });
1064     -1033     -    511 +    465 +    358 +    989 +      });
1065     -1034     -    512 +    466 +    359 +1175 990    }
1066     -1035     -    513 +    467 +    360 +1176 991  
1067     -1036     -    514 +    468 +    361 +1177 992    // Zoom functionality
1068     -1037     -    515 +    469 +    362 +1178 993  
1069     -1038     -    516 +    470 +    363 +
1070     -1039     -    517 +    471 +    364 +```
1071     -1040     -    518 +    472 +    365 +
1072     -1041     -    519 +    473 +    366 +
1073     -1042     -    520 +    474 +    367 +### üìÑ `themes/sunset-dark.css`
1074     -1043     -    521 +    475 +    368 +
1075     -1044     -    522 +    476 +    369 +**Type:** Stylesheet üé®
1076     -1045     -    523 +    477 +    370 +
1077     -1046     -    524 +    478 +    371 +```diff
1078     -1047     -    525 +    479 +    372 +@@ -1,4 +1,4 @@
1079     -1048     -    526 +    480 +    373 +  1     -r/* Sunset Dark Theme */
1080     -1049     -    527 +    481 +    374 +      1 +/* Sunset Dark Theme */
1081     -1050     -    528 +    482 +    375 +  2   2  :root {
1082     -1051     -    529 +    483 +    376 +  3   3    --bg-primary: #1c0a00;
1083     -1052     -    530 +    484 +    377 +  4   4    --bg-secondary: #2d1b0e;
1084     -1053     -    531 +    485 +    378 +  5   5  
1085     -1054     -    532 +    486 + 95 379  
1086     -1055     -    533 +    487 + 96 380  ```
1087     -1056     -    534 +    488 + 97 381  
1088     -1057     -    535 +    489 +@@ -137,4 +421,4 @@ Please provide specific feedback on:
1089     -1058     -    536 +    490 +137 421  
1090     -1059     -    537 +    491 +138 422  ---
1091     -1060     -    538 +    492 +139 423  *Generated by AI Visual Code Review v2.0 - Unified Export Script*
1092     -1061     -    539 +    493 +140     -*Files processed: 2/2 | Errors: 0 | Generated: 2025-12-06T22:55:31.083Z*
1093     -1062     -    540 +    494 +    424 +*Files processed: 3/3 | Errors: 0 | Generated: 2025-12-07T02:57:20.361Z*
1094     -1063     -    541 +    495 +141 425  
1095     -1064     -    542 +    496 +
1096     -1065     -    543 +    497 +```
1097     -1066     -    544 +    498 +
1098     -1067     -    545 +    499 +
1099     -1068     -    546 +    500 +### ‚ú® `docs/02-architecture/mermaid-theme-architecture.md` **[ADDED]**
1100     -1069     -    547 +    501 +
1101     -1070     -    548 +    502 +**Status:** ‚úÖ **NEW FILE** - This file has been newly created
1102     -1071     -    549 +    503 +
1103     -1072     -    550 +    504 +**Type:** Documentation üìñ
1104     -1073     -    551 +    505 +
1105     -1074     -    552 +    506 +```diff
1106     -1075     -    553 +    507 +@@ -0,0 +1,208 @@
1107     -1076     -    554 +    508 +      1 +# Mermaid Theme Architecture - Comprehensive Reference
1108     -1077     -    555 +    509 +      2 +
1109     -1078     -    556 +    510 +      3 +**Last Updated:** 12/7/2025
1110     -1079     -    557 +    511 +      4 +**Source:** Official Mermaid.js theming documentation
1111     -1080     -    558 +    512 +      5 +
1112     -1081     -    559 +    513 +      6 +## Complete Mermaid Theme Variables
1113     -1082     -    560 +    514 +      7 +
1114     -1083     -    561 +    515 +      8 +### Core Global Variables
1115     -1084     -    562 +    516 +      9 +
1116     -1085     -    563 +    517 +     10 +| Variable     | Type       | Description                  | Default                        |
1117     -1086     -    564 +    518 +     11 +| ------------ | ---------- | ---------------------------- | ------------------------------ |
1118     -1087     -    565 +    519 +     12 +| `background` | Background | Page background              | `#f4f4f4`                      |
1119     -1088     -    566 +    520 +     13 +| `fontFamily` | Text       | Font family                  | `trebuchet ms, verdana, arial` |
1120     -1089     -    567 +    521 +     14 +| `fontSize`   | Text       | Font size                    | `16px`                         |
1121     -1090     -    568 +    522 +     15 +| `darkMode`   | Boolean    | Affects color calculations   | `false`                        |
1122     -1091     -    569 +    523 +     16 +| `textColor`  | Text       | General text over background | calculated                     |
1123     -1092     -    570 +    524 +     17 +| `lineColor`  | Line       | Lines and connections        | calculated                     |
1124     -1093     -    571 +    525 +     18 +| `mainBkg`    | Background | Main background for objects  | calculated                     |
1125     -1094     -    572 +    526 +     19 +
1126     -1095     -    573 +    527 +     20 +### Primary/Secondary/Tertiary Color Sets
1127     -1096     -    574 +    528 +     21 +
1128     -1097     -    575 +    529 +     22 +Each set has 3 variables (background, text, border):
1129     -1098     -    576 +    530 +     23 +
1130     -1099     -    577 +    531 +     24 +| Variable               | Type       | Description                |
1131     -1100     -    578 +    532 +     25 +| ---------------------- | ---------- | -------------------------- |
1132     -1101     -    579 +    533 +     26 +| `primaryColor`         | Background | Primary node background    |
1133     -1102     -    580 +    534 +     27 +| `primaryTextColor`     | Text       | Text in primary nodes      |
1134     -1103     -    581 +    535 +     28 +| `primaryBorderColor`   | Border     | Border for primary nodes   |
1135     -1104     -    582 +    536 +     29 +| `secondaryColor`       | Background | Secondary node background  |
1136     -1105     -    583 +    537 +     30 +| `secondaryTextColor`   | Text       | Text in secondary nodes    |
1137     -1106     -    584 +    538 +     31 +| `secondaryBorderColor` | Border     | Border for secondary nodes |
1138     -1107     -    585 +    539 +     32 +| `tertiaryColor`        | Background | Tertiary node background   |
1139     -1108     -    586 +    540 +     33 +| `tertiaryTextColor`    | Text       | Text in tertiary nodes     |
1140     -1109     -    587 +    541 +     34 +| `tertiaryBorderColor`  | Border     | Border for tertiary nodes  |
1141     -1110     -    588 +    542 +     35 +
1142     -1111     -    589 +    543 +     36 +### Flowchart-Specific Variables
1143     -1112     -    590 +    544 +     37 +
1144     -1113     -    591 +    545 +     38 +| Variable              | Type       | Description           |
1145     -1114     -    592 +    546 +     39 +| --------------------- | ---------- | --------------------- |
1146     -1115     -    593 +    547 +     40 +| `nodeBorder`          | Border     | Node border color     |
1147     -1116     -    594 +    548 +     41 +| `clusterBkg`          | Background | Subgraph background   |
1148     -1117     -    595 +    549 +     42 +| `clusterBorder`       | Border     | Subgraph border       |
1149     -1118     -    596 +    550 +     43 +| `defaultLinkColor`    | Line       | Link/edge color       |
1150     -1119     -    597 +    551 +     44 +| `titleColor`          | Text       | Title text color      |
1151     -1120     -    598 +    552 +     45 +| `edgeLabelBackground` | Background | Edge label background |
1152     -1121     -    599 +    553 +     46 +| `nodeTextColor`       | Text       | Text inside nodes     |
1153     -1122     -    600 +    554 +     47 +
1154     -1123     -    601 +    555 +     48 +### Sequence Diagram Variables
1155     -1124     -    602 +    556 +     49 +
1156     -1125     -    603 +    557 +     50 +| Variable                | Type       | Description           |
1157     -1126     -    604 +    558 +     51 +| ----------------------- | ---------- | --------------------- |
1158     -1127     -    605 +    559 +     52 +| `actorBkg`              | Background | Actor box background  |
1159     -1128     -    606 +    560 +     53 +| `actorBorder`           | Border     | Actor box border      |
1160     -1129     -    607 +    561 +     54 +| `actorTextColor`        | Text       | Actor text            |
1161     -1130     -    608 +    562 +     55 +| `actorLineColor`        | Line       | Actor lifeline        |
1162     -1131     -    609 +    563 +     56 +| `signalColor`           | Line       | Signal arrows         |
1163     -1132     -    610 +    564 +     57 +| `signalTextColor`       | Text       | Signal labels         |
1164     -1133     -    611 +    565 +     58 +| `labelBoxBkgColor`      | Background | Label box background  |
1165     -1134     -    612 +    566 +     59 +| `labelBoxBorderColor`   | Border     | Label box border      |
1166     -1135     -    613 +    567 +     60 +| `labelTextColor`        | Text       | Label text            |
1167     -1136     -    614 +    568 +     61 +| `loopTextColor`         | Text       | Loop text             |
1168     -1137     -    615 +    569 +     62 +| `activationBorderColor` | Border     | Activation border     |
1169     -1138     -    616 +    570 +     63 +| `activationBkgColor`    | Background | Activation background |
1170     -1139     -    617 +    571 +     64 +| `sequenceNumberColor`   | Text       | Sequence numbers      |
1171     -1140     -    618 +    572 +     65 +
1172     -1141     -    619 +    573 +     66 +### Pie Chart Variables
1173     -1142     -    620 +    574 +     67 +
1174     -1143     -    621 +    575 +     68 +| Variable              | Type       | Description                           |
1175     -1144     -    622 +    576 +     69 +| --------------------- | ---------- | ------------------------------------- |
1176     -1145     -    623 +    577 +     70 +| `pie1` - `pie12`      | Background | Fill colors for sections              |
1177     -1146     -    624 +    578 +     71 +| `pieTitleTextSize`    | Text       | Title font size (default: `25px`)     |
1178     -1147     -    625 +    579 +     72 +| `pieTitleTextColor`   | Text       | Title text color                      |
1179     -1148     -    626 +    580 +     73 +| `pieSectionTextSize`  | Text       | Section label size (default: `17px`)  |
1180     -1149     -    627 +    581 +     74 +| `pieSectionTextColor` | Text       | **Section label color (ON SLICES!)**  |
1181     -1150     -    628 +    582 +     75 +| `pieLegendTextSize`   | Text       | Legend font size (default: `17px`)    |
1182     -1151     -    629 +    583 +     76 +| `pieLegendTextColor`  | Text       | Legend text color                     |
1183     -1152     -    630 +    584 +     77 +| `pieStrokeColor`      | Border     | Slice borders (default: `black`)      |
1184     -1153     -    631 +    585 +     78 +| `pieStrokeWidth`      | Border     | Slice border width (default: `2px`)   |
1185     -1154     -    632 +    586 +     79 +| `pieOuterStrokeWidth` | Border     | Outer circle width (default: `2px`)   |
1186     -1155     -    633 +    587 +     80 +| `pieOuterStrokeColor` | Border     | Outer circle color (default: `black`) |
1187     -1156     -    634 +    588 +     81 +| `pieOpacity`          | Visual     | Slice opacity (default: `0.7`)        |
1188     -1157     -    635 +    589 +     82 +
1189     -1158     -    636 +    590 +     83 +### State Diagram Variables
1190     -1159     -    637 +    591 +     84 +
1191     -1160     -    638 +    592 +     85 +| Variable        | Type       | Description                |
1192     -1161     -    639 +    593 +     86 +| --------------- | ---------- | -------------------------- |
1193     -1162     -    640 +    594 +     87 +| `labelColor`    | Text       | State label color          |
1194     -1163     -    641 +    595 +     88 +| `altBackground` | Background | Composite state background |
1195     -1164     -    642 +    596 +     89 +
1196     -1165     -    643 +    597 +     90 +### Class Diagram Variables
1197     -1166     -    644 +    598 +     91 +
1198     -1167     -    645 +    599 +     92 +| Variable    | Type | Description      |
1199     -1168     -    646 +    600 +     93 +| ----------- | ---- | ---------------- |
1200     -1169     -    647 +    601 +     94 +| `classText` | Text | Class text color |
1201     -1170     -    648 +    602 +     95 +
1202     -1171     -    649 +    603 +     96 +### User Journey Variables
1203     -1172     -    650 +    604 +     97 +
1204     -1173     -    651 +    605 +     98 +| Variable                  | Type       | Description   |
1205     -1174     -    652 +    606 +     99 +| ------------------------- | ---------- | ------------- |
1206     -1175     -    653 +    607 +    100 +| `fillType0` - `fillType7` | Background | Section fills |
1207     -1176     -    654 +    608 +    101 +
1208     -1177     -    655 +    609 +    102 +## Critical Insights
1209     -1178     -    656 +    610 +    103 +
1210     -1179     -    657 +    611 +    104 +### 1. Pie Section Text Contrast Issue
1211     -1180     -    658 +    612 +    105 +
1212     -1181     -    659 +    613 +    106 +**Problem:** `pieSectionTextColor` is text **ON** the colored pie slices!
1213     -1182     -    660 +    614 +    107 +
1214     -1183     -    661 +    615 +    108 +- If slices are dark and text is dark ‚Üí **UNREADABLE**
1215     -1184     -    662 +    616 +    109 +- If slices are light and text is light ‚Üí **UNREADABLE**
1216     -1185     -    663 +    617 +    110 +
1217     -1186     -    664 +    618 +    111 +**Solution:** `pieSectionTextColor` must contrast with `pie1-pie12` colors!
1218     -1187     -    665 +    619 +    112 +
1219     -1188     -    666 +    620 +    113 +### 2. Background vs Text Variables
1220     -1189     -    667 +    621 +    114 +
1221     -1190     -    668 +    622 +    115 +- **Background variables** (end with `Bkg`, `Color`, or are named `pie1-12`)
1222     -1191     -    669 +    623 +    116 +- **Text variables** (contain `Text` or `textColor`)
1223     -1192     -    670 +    624 +    117 +- **Border variables** (contain `Border` or `Stroke`)
1224     -1193     -    671 +    625 +    118 +- **Line variables** (contain `Line` or `lineColor`)
1225     -1194     -    672 +    626 +    119 +
1226     -1195     -    673 +    627 +    120 +### 3. Calculated vs Explicit
1227     -1196     -    674 +    628 +    121 +
1228     -1197     -    675 +    629 +    122 +- Mermaid **calculates** many colors if not provided
1229     -1198     -    676 +    630 +    123 +- But calculation may not match our theme aesthetics
1230     -1199     -    677 +    631 +    124 +- **We should set ALL critical variables explicitly**
1231     -1200     -    678 +    632 +    125 +
1232     -1201     -    679 +    633 +    126 +## Implementation Strategy
1233     -1202     -    680 +    634 +    127 +
1234     -1203     -    681 +    635 +    128 +### For Each Theme, Define
1235     -1204     -    682 +    636 +    129 +
1236     -1205     -    683 +    637 +    130 +1. **Core Backgrounds** (3 levels for hierarchy)
1237     -1206     -    684 +    638 +    131 +   - `primaryColor`, `secondaryColor`, `tertiaryColor`
1238     -1207     -    685 +    639 +    132 +
1239     -1208     -    686 +    640 +    133 +2. **All Text Colors** (must contrast with their backgrounds!)
1240     -1209     -    687 +    641 +    134 +   - `primaryTextColor`, `secondaryTextColor`, `tertiaryTextColor`
1241     -1210     -    688 +    642 +    135 +   - `nodeTextColor`, `actorTextColor`, `signalTextColor`
1242     -1211     -    689 +    643 +    136 +   - `pieTitleTextColor`, `pieSectionTextColor`, `pieLegendTextColor`
1243     -1212     -    690 +    644 +    137 +
1244     -1213     -    691 +    645 +    138 +3. **All Border Colors** (visible against backgrounds)
1245     -1214     -    692 +    646 +    139 +   - `primaryBorderColor`, `secondaryBorderColor`, `tertiaryBorderColor`
1246     -1215     -    693 +    647 +    140 +   - `nodeBorder`, `actorBorder`, `clusterBorder`
1247     -1216     -    694 +    648 +    141 +   - `pieStrokeColor`, `pieOuterStrokeColor`
1248     -1217     -    695 +    649 +    142 +
1249     -1218     -    696 +    650 +    143 +4. **Line/Connection Colors**
1250     -1219     -    697 +    651 +    144 +   - `lineColor`, `defaultLinkColor`
1251     -1220     -    698 +    652 +    145 +   - `signalColor`, `actorLineColor`
1252     -1221     -    699 +    653 +    146 +
1253     -1222     -    700 +    654 +    147 +5. **Pie Slice Backgrounds** (12 distinct colors)
1254     -1223     -    701 +    655 +    148 +   - `pie1` through `pie12` - must be DISTINCT from text color!
1255     -1224     -    702 +    656 +    149 +
1256     -1225     -    703 +    657 +    150 +## Architecture Pattern
1257     -1226     -    704 +    658 +    151 +
1258     -1227     -    705 +    659 +    152 +```javascript
1259     -1228     -    706 +    660 +    153 +mermaid.initialize({
1260     -1229     -    707 +    661 +    154 +  theme: 'base',
1261     -1230     -    708 +    662 +    155 +  themeVariables: {
1262     -1231     -    709 +    663 +    156 +    // Core (affects ALL diagrams)
1263     -1232     -    710 +    664 +    157 +    background: bgPrimary,
1264     -1233     -    711 +    665 +    158 +    fontFamily: '...',
1265     -1234     -    712 +    666 +    159 +    fontSize: '16px',
1266     -1235     -    713 +    667 +    160 +
1267     -1236     -    714 +    668 +    161 +    // Primary set (most nodes)
1268     -1237     -    715 +    669 +    162 +    primaryColor: [BACKGROUND],
1269     -1238     -    716 +    670 +    163 +    primaryTextColor: [TEXT - must contrast!],
1270     -1239     -    717 +    671 +    164 +    primaryBorderColor: [BORDER - visible],
1271     -1240     -    718 +    672 +    165 +
1272     -1241     -    719 +    673 +    166 +    // Secondary set (clusters, special nodes)
1273     -1242     -    720 +    674 +    167 +    secondaryColor: [BACKGROUND],
1274     -1243     -    721 +    675 +    168 +    secondaryTextColor: [TEXT - must contrast!],
1275     -1244     -    722 +    676 +    169 +    secondaryBorderColor: [BORDER - visible],
1276     -1245     -    723 +    677 +    170 +
1277     -1246     -    724 +    678 +    171 +    // Tertiary set (nested elements)
1278     -1247     -    725 +    679 +    172 +    tertiaryColor: [BACKGROUND],
1279     -1248     -    726 +    680 +    173 +    tertiaryTextColor: [TEXT - must contrast!],
1280     -1249     -    727 +    681 +    174 +    tertiaryBorderColor: [BORDER - visible],
1281     -1250     -    728 +    682 +    175 +
1282     -1251     -    729 +    683 +    176 +    // Flowchart specific
1283     -1252     -    730 +    684 +    177 +    nodeBorder: [VISIBLE],
1284     -1253     -    731 +    685 +    178 +    nodeTextColor: [CONTRASTING],
1285     -1254     -    732 +    686 +    179 +    edgeLabelBackground: [BACKGROUND],
1286     -1255     -    733 +    687 +    180 +
1287     -1256     -    734 +    688 +    181 +    // Sequence diagram specific
1288     -1257     -    735 +    689 +    182 +    actorBkg: [BACKGROUND],
1289     -1258     -    736 +    690 +    183 +    actorTextColor: [CONTRASTING],
1290     -1259     -    737 +    691 +    184 +
1291     -1260     -    738 +    692 +    185 +    // Pie chart specific
1292     -1261     -    739 +    693 +    186 +    pie1-12: [12 DISTINCT COLORS],
1293     -1262     -    740 +    694 +    187 +    pieSectionTextColor: [CONTRASTS WITH pie1-12!],
1294     -1263     -    741 +    695 +    188 +
1295     -1264     -    742 +    696 +    189 +    // Lines
1296     -1265     -    743 +    697 +    190 +    lineColor: [VISIBLE],
1297     -1266     -    744 +    698 +    191 +    signalColor: [VISIBLE],
1298     -1267     -    745 +    699 +    192 +  }
1299     -1268     -    746 +    700 +    193 +});
1300     -1269     -    747 +    701 +    194 +```
1301     -1270     -    748 +    702 +    195 +
1302     -1271     -    749 +    703 +    196 +## Testing Checklist
1303     -1272     -    750 +    704 +    197 +
1304     -1273     -    751 +    705 +    198 +- [ ] Flowchart - nodes, clusters, edges readable
1305     -1274     -    752 +    706 +    199 +- [ ] Sequence diagram - actors, signals, loops readable
1306     -1275     -    753 +    707 +    200 +- [ ] Pie chart - slices, percentages, legend readable
1307     -1276     -    754 +    708 +    201 +- [ ] State diagram - states, transitions readable
1308     -1277     -    755 +    709 +    202 +- [ ] Class diagram - classes, methods readable
1309     -1278     -    756 +    710 +    203 +- [ ] User journey - tasks, emotions readable
1310     -1279     -    757 +    711 +    204 +
1311     -1280     -    758 +    712 +    205 +## References
1312     -1281     -    759 + 29 713      206 +
1313     -1282     -    760 + 30     -    207 +## Recent Fixes (Latest Session)
1314     -1283     -    761 + 31     -    208 +
1315     -1284     -    762 + 32     -    209 +### Theme Dropdown Sync Fix ‚úÖ
1316     -1285     -    763 +    714 +    207 +- [Mermaid Theming Documentation](https://mermaid.js.org/config/theming.html)
1317     -1286     -    764 +    715 +    208 +- [Base Theme Source](https://github.com/mermaid-js/mermaid/blob/develop/packages/mermaid/src/themes/theme-base.js)
1318     -1287     -    765 +    716 +    209  
1319     -1288     -    766 +    717 +
1320     -1289     -    767 +    718 +```
1321     -1290     -    768 +    719 +
1322     -1291     -    769 +    720 +
1323     -1292     -    770 +    721 +### ‚ú® `docs/02-architecture/prism-token-architecture.md` **[ADDED]**
1324     -1293     -    771 +    722 +
1325     -1294     -    772 +    723 +**Status:** ‚úÖ **NEW FILE** - This file has been newly created
1326     -1295     -    773 +    724 +
1327     -1296     -    774 +    725 +**Type:** Documentation üìñ
1328     -1297     -    775 +    726 +
1329     -1298     -    776 +    727 +```diff
1330     -1299     -    777 +    728 +@@ -0,0 +1,226 @@
1331     -1300     -    778 +    729 +      1 +# Prism Token Architecture - Comprehensive Reference
1332     -1301     -    779 +    730 +      2 +
1333     -1302     -    780 +    731 +      3 +**Last Updated:** 12/7/2025
1334     -1303     -    781 +    732 +      4 +**Source:** Official Prism.js documentation + One Dark theme analysis
1335     -1304     -    782 +    733 +      5 +
1336     -1305     -    783 +    734 +      6 +## Standard Token Classes
1337     -1306     -    784 +    735 +      7 +
1338     -1307     -    785 +    736 +      8 +### Core Language Constructs
1339     -1308     -    786 +    737 +      9 +
1340     -1309     -    787 +    738 +     10 +| Token Class   | Purpose                    | Example                                  | Recommended Color Hue             |
1341     -1310     -    788 +    739 +     11 +| ------------- | -------------------------- | ---------------------------------------- | --------------------------------- |
1342     -1311     -    789 +    740 +     12 +| `keyword`     | Reserved words             | `if`, `else`, `class`, `final`, `sealed` | Purple/Magenta (286¬∞)             |
1343     -1312     -    790 +    741 +     13 +| `builtin`     | Built-in functions/types   | `String`, `Array`, `Console`             | Green (95¬∞)                       |
1344     -1313     -    791 +    742 +     14 +| `class-name`  | Class/Interface/Type names | `Rectangle`, `Shape`, `Person`           | Orange (29¬∞)                      |
1345     -1314     -    792 +    743 +     15 +| `function`    | Function/method names      | `main`, `println`, `forEach`             | Blue (207¬∞)                       |
1346     -1315     -    793 +    744 +     16 +| `boolean`     | True/false values          | `true`, `false`                          | Orange (29¬∞)                      |
1347     -1316     -    794 +    745 +     17 +| `number`      | Numeric literals           | `42`, `3.14`, `0xDEADBEEF`               | Orange (29¬∞)                      |
1348     -1317     -    795 +    746 +     18 +| `string`      | String literals            | `"Hello"`, `'World'`                     | Green (95¬∞)                       |
1349     -1318     -    796 +    747 +     19 +| `char`        | Character literals         | `'A'`, `'\n'`                            | Green (95¬∞)                       |
1350     -1319     -    797 +    748 +     20 +| `symbol`      | Symbols (Smalltalk, Ruby)  | `:mySymbol`                              | Green (95¬∞)                       |
1351     -1320     -    798 +    749 +     21 +| `regex`       | Regular expressions        | `/[a-z]+/i`                              | Green (95¬∞)                       |
1352     -1321     -    799 +    750 +     22 +| `operator`    | Operators                  | `+`, `-`, `*`, `/`, `=`, `==`            | Purple (286¬∞)                     |
1353     -1322     -    800 +    751 +     23 +| `variable`    | Variable names (special)   | Less/Bash variables                      | Blue (207¬∞)                       |
1354     -1323     -    801 +    752 +     24 +| `constant`    | Constants                  | `PI`, `MAX_SIZE`, `stdout`               | Orange (29¬∞)                      |
1355     -1324     -    802 +    753 +     25 +| `property`    | Object properties          | CSS properties, JSON keys                | Red (355¬∞)                        |
1356     -1325     -    803 +    754 +     26 +| `punctuation` | Delimiters                 | `{`, `}`, `;`, `,`                       | Gray/White                        |
1357     -1326     -    804 +    755 +     27 +| `comment`     | Code comments              | `// comment`, `/* block */`              | Muted gray (220¬∞, low saturation) |
1358     -1327     -    805 +    756 +     28 +
1359     -1328     -    806 +    757 +     29 +### Markup-Specific Tokens
1360     -1329     -    807 +    758 +     30 +
1361     -1330     -    808 +    759 +     31 +| Token Class  | Purpose             | Example                     |
1362     -1331     -    809 +    760 +     32 +| ------------ | ------------------- | --------------------------- |
1363     -1332     -    810 +    761 +     33 +| `tag`        | HTML/XML tags       | `<div>`, `<p>`              |
1364     -1333     -    811 +    762 +     34 +| `attr-name`  | Attribute names     | `id`, `class`, `href`       |
1365     -1334     -    812 +    763 +     35 +| `attr-value` | Attribute values    | `"header"`, `"https://..."` |
1366     -1335     -    813 +    764 +     36 +| `namespace`  | XML namespaces      | `html:p`, `foo:bar`         |
1367     -1336     -    814 +    765 +     37 +| `prolog`     | XML prolog          | `<?xml version="1.0"?>`     |
1368     -1337     -    815 +    766 +     38 +| `doctype`    | DOCTYPE declaration | `<!DOCTYPE html>`           |
1369     -1338     -    816 +    767 +     39 +| `cdata`      | CDATA sections      | `<![CDATA[...]]>`           |
1370     -1339     -    817 +    768 +     40 +| `entity`     | HTML entities       | `&amp;`, `&#x2665;`         |
1371     -1340     -    818 +    769 +     41 +
1372     -1341     -    819 +    770 +     42 +### Document Markup Tokens
1373     -1342     -    820 +    771 +     43 +
1374     -1343     -    821 +    772 +     44 +| Token Class | Purpose         | Example      |
1375     -1344     -    822 +    773 +     45 +| ----------- | --------------- | ------------ |
1376     -1345     -    823 +    774 +     46 +| `bold`      | Bold text       | `**bold**`   |
1377     -1346     -    824 +    775 +     47 +| `italic`    | Italic text     | `*italic*`   |
1378     -1347     -    825 +    776 +     48 +| `important` | Important (CSS) | `!important` |
1379     -1348     -    826 +    777 +     49 +
1380     -1349     -    827 +    778 +     50 +### Stylesheet Tokens
1381     -1350     -    828 +    779 +     51 +
1382     -1351     -    829 +    780 +     52 +| Token Class | Purpose       | Example                  |
1383     -1352     -    830 +    781 +     53 +| ----------- | ------------- | ------------------------ |
1384     -1353     -    831 +    782 +     54 +| `atrule`    | CSS @ rules   | `@media`, `@import`      |
1385     -1354     -    832 +    783 +     55 +| `selector`  | CSS selectors | `.class`, `#id`, `div p` |
1386     -1355     -    833 +    784 +     56 +| `url`       | URLs          | `url(image.png)`         |
1387     -1356     -    834 +    785 +     57 +
1388     -1357     -    835 +    786 +     58 +### Diff Tokens
1389     -1358     -    836 +    787 +     59 +
1390     -1359     -    837 +    788 +     60 +| Token Class | Purpose       |
1391     -1360     -    838 +    789 +     61 +| ----------- | ------------- |
1392     -1361     -    839 +    790 +     62 +| `inserted`  | Added lines   |
1393     -1362     -    840 +    791 +     63 +| `deleted`   | Removed lines |
1394     -1363     -    841 +    792 +     64 +
1395     -1364     -    842 +    793 +     65 +## Professional Theme Analysis (One Dark)
1396     -1365     -    843 +    794 +     66 +
1397     -1366     -    844 +    795 +     67 +### Color Grouping Strategy
1398     -1367     -    845 +    796 +     68 +
1399     -1368     -    846 +    797 +     69 +One Dark uses **7 core hues** systematically:
1400     -1369     -    847 +    798 +     70 +
1401     -1370     -    848 +    799 +     71 +1. **mono-1** (220¬∞, 14%, 71%) - Default text
1402     -1371     -    849 +    800 +     72 +2. **mono-2** (220¬∞, 9%, 55%) - Secondary text
1403     -1372     -    850 +    801 +     73 +3. **mono-3** (220¬∞, 10%, 40%) - Comments
1404     -1373     -    851 +    802 +     74 +4. **hue-1** (187¬∞, 47%, 55%) - Cyan - URLs
1405     -1374     -    852 +    803 +     75 +5. **hue-2** (207¬∞, 82%, 66%) - Blue - Variables, operators, functions
1406     -1375     -    853 +    804 +     76 +6. **hue-3** (286¬∞, 60%, 67%) - Purple - Keywords
1407     -1376     -    854 +    805 +     77 +7. **hue-4** (95¬∞, 38%, 62%) - Green - Strings
1408     -1377     -    855 +    806 +     78 +8. **hue-5** (355¬∞, 65%, 65%) - Red - Properties, tags, symbols
1409     -1378     -    856 +    807 +     79 +9. **hue-6** (29¬∞, 54%, 61%) - Orange - Class names, constants, numbers
1410     -1379     -    857 +    808 +     80 +
1411     -1380     -    858 +    809 +     81 +### Token Grouping
1412     -1381     -    859 +    810 +     82 +
1413     -1382     -    860 +    811 +     83 +```css
1414     -1383     -    861 +    812 +     84 +/* Group 1: Comments */
1415     -1384     -    862 +    813 +     85 +.token.comment, .token.prolog, .token.cdata
1416     -1385     -    863 +    814 +     86 +
1417     -1386     -    864 +    815 +     87 +/* Group 2: Neutral (inherit default color) */
1418     -1387     -    865 +    816 +     88 +.token.doctype, .token.punctuation, .token.entity
1419     -1388     -    866 +    817 +     89 +
1420     -1389     -    867 +    818 +     90 +/* Group 3: Orange - Class names, constants, numbers */
1421     -1390     -    868 +    819 +     91 +.token.attr-name, .token.class-name, .token.boolean,
1422     -1391     -    869 +    820 +     92 +.token.constant, .token.number, .token.atrule
1423     -1392     -    870 +    821 +     93 +
1424     -1393     -    871 +    822 +     94 +/* Group 4: Purple - Keywords */
1425     -1394     -    872 +    823 +     95 +.token.keyword
1426     -1395     -    873 +    824 +     96 +
1427     -1396     -    874 +    825 +     97 +/* Group 5: Red - Properties, tags */
1428     -1397     -    875 +    826 +     98 +.token.property, .token.tag, .token.symbol,
1429     -1398     -    876 +    827 +     99 +.token.deleted, .token.important
1430     -1399     -    877 +    828 +    100 +
1431     -1400     -    878 +    829 +    101 +/* Group 6: Green - Strings, builtins */
1432     -1401     -    879 +    830 +    102 +.token.selector, .token.string, .token.char,
1433     -1402     -    880 +    831 +    103 +.token.builtin, .token.inserted, .token.regex,
1434     -1403     -    881 +    832 +    104 +.token.attr-value
1435     -1404     -    882 +    833 +    105 +
1436     -1405     -    883 +    834 +    106 +/* Group 7: Blue - Variables, operators, functions */
1437     -1406     -    884 +    835 +    107 +.token.variable, .token.operator, .token.function
1438     -1407     -    885 +    836 +    108 +
1439     -1408     -    886 +    837 +    109 +/* Group 8: Cyan - URLs */
1440     -1409     -    887 +    838 +    110 +.token.url
1441     -1410     -    888 +    839 +    111 +```
1442     -1411     -    889 +    840 +    112 +
1443     -1412     -    890 +    841 +    113 +### Language-Specific Overrides
1444     -1413     -    891 +    842 +    114 +
1445     -1414     -    892 +    843 +    115 +Professional themes use **cascading specificity** for language-specific rules:
1446     -1415     -    893 +    844 +    116 +
1447     -1416     -    894 +    845 +    117 +```css
1448     -1417     -    895 +    846 +    118 +/* JavaScript overrides */
1449     -1418     -    896 +    847 +    119 +.language-javascript .token.operator { color: purple; }
1450     -1419     -    897 +    848 +    120 +.language-javascript .token.template-string > .token.interpolation { ... }
1451     -1420     -    898 +    849 +    121 +
1452     -1421     -    899 +    850 +    122 +/* CSS overrides */
1453     -1422     -    900 +    851 +    123 +.language-css .token.selector { color: red; }
1454     -1423     -    901 +    852 +    124 +.language-css .token.property { color: gray; }
1455     -1424     -    902 +    853 +    125 +
1456     -1425     -    903 +    854 +    126 +/* JSON overrides */
1457     -1426     -    904 +    855 +    127 +.language-json .token.null.keyword { color: orange; }
1458     -1427     -    905 +    856 +    128 +
1459     -1428     -    906 +    857 +    129 +/* Markdown overrides */
1460     -1429     -    907 +    858 +    130 +.language-markdown .token.url { ... }
1461     -1430     -    908 +    859 +    131 +```
1462     -1431     -    909 +    860 +    132 +
1463     -1432     -    910 +    861 +    133 +## Implementation Architecture
1464     -1433     -    911 +    862 +    134 +
1465     -1434     -    912 +    863 +    135 +### CSS Specificity Levels
1466     -1435     -    913 +    864 +    136 +
1467     -1436     -    914 +    865 +    137 +1. **Base tokens** - All languages
1468     -1437     -    915 +    866 +    138 +2. **Language-specific overrides** - `.language-xxx .token.yyy`
1469     -1438     -    916 +    867 +    139 +3. **Nested tokens** - `.token.xxx > .token.yyy`
1470     -1439     -    917 +    868 +    140 +4. **Plugin overrides** - `.rainbow-braces`, `.diff-highlight`, etc.
1471     -1440     -    918 +    869 +    141 +
1472     -1441     -    919 +    870 +    142 +### Variable Mapping Strategy
1473     -1442     -    920 +    871 +    143 +
1474     -1443     -    921 +    872 +    144 +```css
1475     -1444     -    922 +    873 +    145 +/* Map standard Prism tokens to theme CSS variables */
1476     -1445     -    923 +    874 +    146 +.token.keyword {
1477     -1446     -    924 +    875 +    147 +  color: var(--syntax-keyword);
1478     -1447     -    925 +    876 +    148 +}
1479     -1448     -    926 +    877 +    149 +.token.string {
1480     -1449     -    927 +    878 +    150 +  color: var(--syntax-string);
1481     -1450     -    928 +    879 +    151 +}
1482     -1451     -    929 +    880 +    152 +.token.class-name {
1483     -1452     -    930 +    881 +    153 +  color: var(--syntax-class-name); /* Distinct variable! */
1484     -1453     -    931 +    882 +    154 +}
1485     -1454     -    932 +    883 +    155 +```
1486     -1455     -    933 +    884 +    156 +
1487     -1456     -    934 +    885 +    157 +### Token Aliases
1488     -1457     -    935 +    886 +    158 +
1489     -1458     -    936 +    887 +    159 +Prism uses aliases to group similar tokens:
1490     -1459     -    937 +    888 +    160 +
1491     -1460     -    938 +    889 +    161 +- `attr-value` can contain nested `punctuation` tokens
1492     -1461     -    939 +    890 +    162 +- `template-string` can contain `interpolation` with nested tokens
1493     -1462     -    940 +    891 +    163 +- Language definitions use `alias` property to inherit styles
1494     -1463     -    941 +    892 +    164 +
1495     -1464     -    942 +    893 +    165 +## Best Practices
1496     -1465     -    943 +    894 +    166 +
1497     -1466     -    944 +    895 +    167 +1. **Use Distinct Variables** - Don't reuse variables across semantically different tokens
1498     -1467     -    945 +    896 +    168 +2. **Follow Standards** - Match Prism's standard token names
1499     -1468     -    946 +    897 +    169 +3. **Language Overrides** - Use when default grouping doesn't fit
1500     -1469     -    947 +    898 +    170 +4. **Test Comprehensively** - Verify with multiple languages (Java, Python, JS, CSS, etc.)
1501     -1470     -    948 +    899 +    171 +5. **Font Weight** - Use bold/normal strategically for visual hierarchy
1502     -1471     -    949 +    900 +    172 +6. **Color Contrast** - Ensure WCAG AA compliance (4.5:1 for text)
1503     -1472     -    950 +    901 +    173 +
1504     -1473     -    951 +    902 +    174 +## Token Coverage Checklist
1505     -1474     -    952 +    903 +    175 +
1506     -1475     -    953 +    904 +    176 +### Must Cover (Core)
1507     -1476     -    954 +    905 +    177 +
1508     -1477     -    955 +    906 +    178 +- [ ] keyword
1509     -1478     -    956 +    907 +    179 +- [ ] builtin
1510     -1479     -    957 +    908 +    180 +- [ ] class-name (distinct from keyword!)
1511     -1480     -    958 +    909 +    181 +- [ ] function
1512     -1481     -    959 +    910 +    182 +- [ ] string
1513     -1482     -    960 +    911 +    183 +- [ ] number
1514     -1483     -    961 +    912 +    184 +- [ ] boolean
1515     -1484     -    962 +    913 +    185 +- [ ] comment
1516     -1485     -    963 +    914 +    186 +- [ ] operator
1517     -1486     -    964 +    915 +    187 +- [ ] punctuation
1518     -1487     -    965 +    916 +    188 +- [ ] variable
1519     -1488     -    966 +    917 +    189 +- [ ] property
1520     -1489     -    967 +    918 +    190 +- [ ] constant
1521     -1490     -    968 +    919 +    191 +- [ ] regex
1522     -1491     -    969 +    920 +    192 +
1523     -1492     -    970 +    921 +    193 +### Markup Languages
1524     -1493     -    971 +    922 +    194 +
1525     -1494     -    972 +    923 +    195 +- [ ] tag
1526     -1495     -    973 +    924 +    196 +- [ ] attr-name
1527     -1496     -    974 +    925 +    197 +- [ ] attr-value
1528     -1497     -    975 +    926 +    198 +- [ ] namespace
1529     -1498     -    976 +    927 +    199 +- [ ] doctype
1530     -1499     -    977 +    928 +    200 +- [ ] entity
1531     -1500     -    978 +    929 +    201 +
1532     -1501     -    979 +    930 +    202 +### Advanced
1533     -1502     -    980 +    931 +    203 +
1534     -1503     -    981 +    932 +    204 +- [ ] atrule (CSS)
1535     -1504     -    982 +    933 +    205 +- [ ] selector (CSS)
1536     -1505     -    983 +    934 +    206 +- [ ] url
1537     -1506     -    984 +    935 +    207 +- [ ] inserted/deleted (Diff)
1538     -1507     -    985 +    936 +    208 +- [ ] bold/italic (Markdown)
1539     -1508     -    986 +    937 +    209 +- [ ] important (CSS)
1540     -1509     -    987 + 33 938      210 +
1541     -1510     -    988 + 34     -    211 +**Problem:** Theme dropdown showing "Default Light" even when sunset-dark theme was loaded from LocalStorage.
1542     -1511     -    989 +    939 +    211 +## Implementation Checklist
1543     -1512     -    990 + 35 940      212 +
1544     -1513     -    991 + 36     -    213 +**Root Cause:** Race condition in theme loading - dropdown was being set BEFORE async theme load completed.
1545     -1514     -    992 + 37     -    214 +
1546     -1515     -    993 + 38     -    215 +**Solution:**
1547     -1516     -    994 + 39     -    216 +
1548     -1517     -    995 + 40     -    217 +```javascript
1549     -1518     -    996 + 41     -    218 +// OLD (buggy):
1550     -1519     -    997 + 42     -    219 +if (savedTheme) {
1551     -1520     -    998 + 43     -    220 +  themeSelector.value = savedTheme; // Sets immediately
1552     -1521     -    999 + 44     -    221 +  themeManager.loadTheme(savedTheme); // Async, not awaited
1553     -1522     -    1000 + 45     -    222 +}
1554     -1523     -    1001 +    941 +    213 +- [ ] Define comprehensive CSS variable palette (8-10 distinct hues)
1555     -1524     -    1002 +    942 +    214 +- [ ] Map ALL standard tokens to variables
1556     -1525     -    1003 +    943 +    215 +- [ ] Add language-specific overrides where needed
1557     -1526     -    1004 +    944 +    216 +- [ ] Test with Java (most complex token usage)
1558     -1527     -    1005 +    945 +    217 +- [ ] Test with Python, JavaScript, CSS
1559     -1528     -    1006 +    946 +    218 +- [ ] Verify font-weight hierarchy
1560     -1529     -    1007 +    947 +    219 +- [ ] Check color contrast ratios
1561     -1530     -    1008 +    948 +    220 +- [ ] Document color semantics
1562     -1531     -    1009 +    949 +    221 +
1563     -1532     -    1010 +    950 +    222 +## References
1564     -1533     -    1011 + 46 951      223 +
1565     -1534     -    1012 + 47     -    224 +// NEW (fixed):
1566     -1535     -    1013 + 48     -    225 +if (savedTheme) {
1567     -1536     -    1014 + 49     -    226 +  themeManager
1568     -1537     -    1015 + 50     -    227 +    .loadTheme(savedTheme)
1569     -1538     -    1016 + 51     -    228 +    .then(() => {
1570     -1539     -    1017 + 52     -    229 +      themeSelector.value = savedTheme; // Only after successful load
1571     -1540     -    1018 + 53     -    230 +      console.log(`‚úÖ Theme restored: ${savedTheme}`);
1572     -1541     -    1019 + 54     -    231 +    })
1573     -1542     -    1020 + 55     -    232 +    .catch(err => {
1574     -1543     -    1021 + 56     -    233 +      // Fallback with proper sync
1575     -1544     -    1022 + 57     -    234 +      themeManager.loadTheme('default-light').then(() => {
1576     -1545     -    1023 + 58     -    235 +        themeSelector.value = 'default-light';
1577     -1546     -    1024 + 59     -    236 +      });
1578     -1547     -    1025 + 60     -    237 +    });
1579     -1548     -    1026 + 61     -    238 +}
1580     -1549     -    1027 + 62     -    239 +```
1581     -1550     -    1028 + 63     -    240 +
1582     -1551     -    1029 + 64     -    241 +**Key Changes:**
1583     -1552     -    1030 + 65     -    242 +
1584     -1553     -    1031 + 66     -    243 +1. Await theme load completion before syncing dropdown
1585     -1554     -    1032 + 67     -    244 +2. Added success callback for dropdown update
1586     -1555     -    1033 + 68     -    245 +3. Added error handling with fallback
1587     -1556     -    1034 + 69     -    246 +4. Added console logging for debugging
1588     -1557     -    1035 + 70     -    247 +
1589     -1558     -    1036 + 71     -    248 +**Results:**
1590     -1559     -    1037 + 72     -    249 +
1591     -1560     -    1038 + 73     -    250 +- ‚úÖ Dropdown now syncs correctly with all themes
1592     -1561     -    1039 + 74     -    251 +- ‚úÖ No more race conditions
1593     -1562     -    1040 + 75     -    252 +- ‚úÖ Proper error handling
1594     -1563     -    1041 + 76     -    253 +- ‚úÖ Works for all 12 themes (6 theme families √ó 2 variants)
1595     -1564     -    1042 + 77     -    254 +
1596     -1565     -    1043 + 78     -    255 +**Files Modified:** `script.js` (lines 1167-1183)
1597     -1566     -    1044 + 79     -206 256  
1598     -1567     -    1045 + 80     -207 257  ## Performance Observations
1599     -1568     -    1046 + 81     -208 258  
1600     -1569     -    1047 + 82     -209 259  
1601     -1570     -    1048 +    952 +    224 +- [Prism Standard Tokens](https://prismjs.com/tokens.html)
1602     -1571     -    1049 +    953 +    225 +- [Prism Theme: One Dark](https://github.com/PrismJS/prism-themes/blob/master/themes/prism-one-dark.css)
1603     -1572     -    1050 +    954 +    226 +- [Atom One Dark Colors](https://github.com/atom/atom/tree/master/packages/one-dark-syntax)
1604     -1573     -    1051 +    955 +    227  
1605     -1574     -    1052 + 83 956  
1606     -1575     -    1053 + 84 957  ```
1607     -1576     -    1054 + 85 958  
1608     -1577     -    1055 +@@ -89,277 +962,2340 @@ memory-bank/activeContext.md |  52 +++++++++-
1609     -1578     -    1056 + 89 962  **Type:** JavaScript Source File üü®
1610     -1579     -    1057 + 90 963  
1611     -1580     -    1058 + 91 964  ```diff
1612     -1581     -    1059 + 92     -@@ -145,101 +145,10 @@ function configureMarkedExtensions() {
1613     -1582     -    1060 + 93     -145 145      return;
1614     -1583     -    1061 + 94     -146 146    }
1615     -1584     -    1062 + 95     -147 147  
1616     -1585     -    1063 + 96     -148     -  // Add LaTeX environment extensions
1617     -1586     -    1064 + 97     -    148 +  // Add inline math and text formatting extensions only
1618     -1587     -    1065 + 98     -    149 +  // LaTeX environments (align, gather, etc.) are not supported by KaTeX
1619     -1588     -    1066 + 99     -149 150    marked.use({
1620     -1589     -    1067 +100     -150 151      extensions: [
1621     -1590     -    1068 +101     -151     -      {
1622     -1591     -    1069 +102     -152     -        name: 'latexEnvironment',
1623     -1592     -    1070 +103     -153     -        level: 'block',
1624     -1593     -    1071 +104     -154     -        start(src) {
1625     -1594     -    1072 +105     -155     -          return src.match(/^\\begin\{/)?.index;
1626     -1595     -    1073 +106     -156     -        },
1627     -1596     -    1074 +107     -157     -        tokenizer(src) {
1628     -1597     -    1075 +108     -158     -          const match = src.match(/^\\begin\{([^}]+)\}([\s\S]*?)\\end\{\1\}/);
1629     -1598     -    1076 +109     -159     -          if (match) {
1630     -1599     -    1077 +110     -160     -            return {
1631     -1600     -    1078 +111     -161     -              type: 'latexEnvironment',
1632     -1601     -    1079 +112     -162     -              raw: match[0],
1633     -1602     -    1080 +113     -163     -              text: match[0],
1634     -1603     -    1081 +114     -164     -            };
1635     -1604     -    1082 +115     -165     -          }
1636     -1605     -    1083 +116     -166     -        },
1637     -1606     -    1084 +117     -167     -        renderer(token) {
1638     -1607     -    1085 +118     -168     -          try {
1639     -1608     -    1086 +119     -169     -            const rendered = katex.renderToString(token.text, {
1640     -1609     -    1087 +120     -170     -              displayMode: true,
1641     -1610     -    1088 +121     -171     -              throwOnError: false,
1642     -1611     -    1089 +122     -172     -              trust: true,
1643     -1612     -    1090 +123     -173     -              strict: false,
1644     -1613     -    1091 +124     -174     -            });
1645     -1614     -    1092 +125     -175     -            return `<div class="katex-display">${rendered}</div>`;
1646     -1615     -    1093 +126     -176     -          } catch (e) {
1647     -1616     -    1094 +127     -177     -            console.warn('KaTeX environment render error:', e);
1648     -1617     -    1095 +128     -178     -            return `<div style="color: red; padding: 10px;">LaTeX Error: ${e.message}</div>`;
1649     -1618     -    1096 +129     -179     -          }
1650     -1619     -    1097 +130     -180     -        },
1651     -1620     -    1098 +131     -181     -      },
1652     -1621     -    1099 +132     -182     -      {
1653     -1622     -    1100 +133     -183     -        name: 'latexDisplayBracket',
1654     -1623     -    1101 +134     -184     -        level: 'block',
1655     -1624     -    1102 +135     -185     -        start(src) {
1656     -1625     -    1103 +136     -186     -          return src.match(/^\\\[/)?.index;
1657     -1626     -    1104 +137     -187     -        },
1658     -1627     -    1105 +138     -188     -        tokenizer(src) {
1659     -1628     -    1106 +139     -189     -          const match = src.match(/^\\\[([\s\S]*?)\\\]/);
1660     -1629     -    1107 +140     -190     -          if (match) {
1661     -1630     -    1108 +141     -191     -            return {
1662     -1631     -    1109 +142     -192     -              type: 'latexDisplayBracket',
1663     -1632     -    1110 +143     -193     -              raw: match[0],
1664     -1633     -    1111 +144     -194     -              text: match[1].trim(),
1665     -1634     -    1112 +145     -195     -            };
1666     -1635     -    1113 +146     -196     -          }
1667     -1636     -    1114 +147     -197     -        },
1668     -1637     -    1115 +148     -198     -        renderer(token) {
1669     -1638     -    1116 +149     -199     -          try {
1670     -1639     -    1117 +150     -200     -            const rendered = katex.renderToString(token.text, {
1671     -1640     -    1118 +151     -201     -              displayMode: true,
1672     -1641     -    1119 +152     -202     -              throwOnError: false,
1673     -1642     -    1120 +153     -203     -              trust: true,
1674     -1643     -    1121 +154     -204     -              strict: false,
1675     -1644     -    1122 +155     -205     -            });
1676     -1645     -    1123 +156     -206     -            return `<div class="katex-display">${rendered}</div>`;
1677     -1646     -    1124 +157     -207     -          } catch (e) {
1678     -1647     -    1125 +158     -208     -            console.warn('KaTeX bracket render error:', e);
1679     -1648     -    1126 +159     -209     -            return `<div style="color: red; padding: 10px;">LaTeX Error: ${e.message}</div>`;
1680     -1649     -    1127 +160     -210     -          }
1681     -1650     -    1128 +161     -211     -        },
1682     -1651     -    1129 +162     -212     -      },
1683     -1652     -    1130 +163     -213     -      {
1684     -1653     -    1131 +164     -214     -        name: 'latexInlineParen',
1685     -1654     -    1132 +165     -215     -        level: 'inline',
1686     -1655     -    1133 +166     -216     -        start(src) {
1687     -1656     -    1134 +167     -217     -          return src.match(/\\\(/)?.index;
1688     -1657     -    1135 +168     -218     -        },
1689     -1658     -    1136 +169     -219     -        tokenizer(src) {
1690     -1659     -    1137 +170     -220     -          const match = src.match(/^\\\(([\s\S]*?)\\\)/);
1691     -1660     -    1138 +171     -221     -          if (match) {
1692     -1661     -    1139 +172     -222     -            return {
1693     -1662     -    1140 +173     -223     -              type: 'latexInlineParen',
1694     -1663     -    1141 +174     -224     -              raw: match[0],
1695     -1664     -    1142 +175     -225     -              text: match[1].trim(),
1696     -1665     -    1143 +176     -226     -            };
1697     -1666     -    1144 +177     -227     -          }
1698     -1667     -    1145 +178     -228     -        },
1699     -1668     -    1146 +179     -229     -        renderer(token) {
1700     -1669     -    1147 +180     -230     -          try {
1701     -1670     -    1148 +181     -231     -            return katex.renderToString(token.text, {
1702     -1671     -    1149 +182     -232     -              displayMode: false,
1703     -1672     -    1150 +183     -233     -              throwOnError: false,
1704     -1673     -    1151 +184     -234     -              trust: true,
1705     -1674     -    1152 +185     -235     -              strict: false,
1706     -1675     -    1153 +186     -236     -            });
1707     -1676     -    1154 +187     -237     -          } catch (e) {
1708     -1677     -    1155 +188     -238     -            console.warn('KaTeX paren render error:', e);
1709     -1678     -    1156 +189     -239     -            return `<span style="color: red;">LaTeX Error</span>`;
1710     -1679     -    1157 +190     -240     -          }
1711     -1680     -    1158 +191     -241     -        },
1712     -1681     -    1159 +192     -242     -      },
1713     -1682     -    1160 +193     -243 152        {
1714     -1683     -    1161 +194     -244 153          name: 'mathBlock',
1715     -1684     -    1162 +195     -245 154          level: 'block',
1716     -1685     -    1163 +196     -@@ -503,101 +412,10 @@ graph TD
1717     -1686     -    1164 +197     -503 412      return textarea.value;
1718     -1687     -    1165 +198     -504 413    }
1719     -1688     -    1166 +199     -505 414  
1720     -1689     -    1167 +200     -506     -  // Add LaTeX environment extensions that render directly with KaTeX
1721     -1690     -    1168 +201     -    415 +  // Keep only subscript and superscript extensions
1722     -1691     -    1169 +202     -    416 +  // Remove LaTeX environment extensions that don't work with KaTeX
1723     -1692     -    1170 +203     -507 417    marked.use({
1724     -1693     -    1171 +204     -508 418      extensions: [
1725     -1694     -    1172 +205     -509     -      {
1726     -1695     -    1173 +206     -510     -        name: 'latexEnvironment',
1727     -1696     -    1174 +207     -511     -        level: 'block',
1728     -1697     -    1175 +208     -512     -        start(src) {
1729     -1698     -    1176 +209     -513     -          return src.match(/^\\begin\{/)?.index;
1730     -1699     -    1177 +210     -514     -        },
1731     -1700     -    1178 +211     -515     -        tokenizer(src) {
1732     -1701     -    1179 +212     -516     -          const match = src.match(/^\\begin\{([^}]+)\}([\s\S]*?)\\end\{\1\}/);
1733     -1702     -    1180 +213     -517     -          if (match) {
1734     -1703     -    1181 +214     -518     -            return {
1735     -1704     -    1182 +215     -519     -              type: 'latexEnvironment',
1736     -1705     -    1183 +216     -520     -              raw: match[0],
1737     -1706     -    1184 +217     -521     -              text: match[0],
1738     -1707     -    1185 +218     -522     -            };
1739     -1708     -    1186 +219     -523     -          }
1740     -1709     -    1187 +220     -524     -        },
1741     -1710     -    1188 +221     -525     -        renderer(token) {
1742     -1711     -    1189 +222     -526     -          try {
1743     -1712     -    1190 +223     -527     -            const rendered = katex.renderToString(token.text, {
1744     -1713     -    1191 +224     -528     -              displayMode: true,
1745     -1714     -    1192 +225     -529     -              throwOnError: false,
1746     -1715     -    1193 +226     -530     -              trust: true,
1747     -1716     -    1194 +227     -531     -              strict: false,
1748     -1717     -    1195 +228     -532     -            });
1749     -1718     -    1196 +229     -533     -            return `<div class="katex-display">${rendered}</div>`;
1750     -1719     -    1197 +230     -534     -          } catch (e) {
1751     -1720     -    1198 +231     -535     -            console.warn('KaTeX environment render error:', e);
1752     -1721     -    1199 +232     -536     -            return `<div style="color: red; padding: 10px;">LaTeX Error: ${e.message}</div>`;
1753     -1722     -    1200 +233     -537     -          }
1754     -1723     -    1201 +234     -538     -        },
1755     -1724     -    1202 +235     -539     -      },
1756     -1725     -    1203 +236     -540     -      {
1757     -1726     -    1204 +237     -541     -        name: 'latexDisplayBracket',
1758     -1727     -    1205 +238     -542     -        level: 'block',
1759     -1728     -    1206 +239     -543     -        start(src) {
1760     -1729     -    1207 +240     -544     -          return src.match(/^\\\[/)?.index;
1761     -1730     -    1208 +241     -545     -        },
1762     -1731     -    1209 +242     -546     -        tokenizer(src) {
1763     -1732     -    1210 +243     -547     -          const match = src.match(/^\\\[([\s\S]*?)\\\]/);
1764     -1733     -    1211 +244     -548     -          if (match) {
1765     -1734     -    1212 +245     -549     -            return {
1766     -1735     -    1213 +246     -550     -              type: 'latexDisplayBracket',
1767     -1736     -    1214 +247     -551     -              raw: match[0],
1768     -1737     -    1215 +248     -552     -              text: match[1].trim(),
1769     -1738     -    1216 +249     -553     -            };
1770     -1739     -    1217 +250     -554     -          }
1771     -1740     -    1218 +251     -555     -        },
1772     -1741     -    1219 +252     -556     -        renderer(token) {
1773     -1742     -    1220 +253     -557     -          try {
1774     -1743     -    1221 +254     -558     -            const rendered = katex.renderToString(token.text, {
1775     -1744     -    1222 +255     -559     -              displayMode: true,
1776     -1745     -    1223 +256     -560     -              throwOnError: false,
1777     -1746     -    1224 +257     -561     -              trust: true,
1778     -1747     -    1225 +258     -562     -              strict: false,
1779     -1748     -    1226 +259     -563     -            });
1780     -1749     -    1227 +260     -564     -            return `<div class="katex-display">${rendered}</div>`;
1781     -1750     -    1228 +261     -565     -          } catch (e) {
1782     -1751     -    1229 +262     -566     -            console.warn('KaTeX bracket render error:', e);
1783     -1752     -    1230 +263     -567     -            return `<div style="color: red; padding: 10px;">LaTeX Error: ${e.message}</div>`;
1784     -1753     -    1231 +264     -568     -          }
1785     -1754     -    1232 +265     -569     -        },
1786     -1755     -    1233 +266     -570     -      },
1787     -1756     -    1234 +267     -571     -      {
1788     -1757     -    1235 +268     -572     -        name: 'latexInlineParen',
1789     -1758     -    1236 +269     -573     -        level: 'inline',
1790     -1759     -    1237 +270     -574     -        start(src) {
1791     -1760     -    1238 +271     -575     -          return src.match(/\\\(/)?.index;
1792     -1761     -    1239 +272     -576     -        },
1793     -1762     -    1240 +273     -577     -        tokenizer(src) {
1794     -1763     -    1241 +274     -578     -          const match = src.match(/^\\\(([\s\S]*?)\\\)/);
1795     -1764     -    1242 +275     -579     -          if (match) {
1796     -1765     -    1243 +276     -580     -            return {
1797     -1766     -    1244 +277     -581     -              type: 'latexInlineParen',
1798     -1767     -    1245 +278     -582     -              raw: match[0],
1799     -1768     -    1246 +279     -583     -              text: match[1].trim(),
1800     -1769     -    1247 +280     -584     -            };
1801     -1770     -    1248 +281     -585     -          }
1802     -1771     -    1249 +282     -586     -        },
1803     -1772     -    1250 +283     -587     -        renderer(token) {
1804     -1773     -    1251 +284     -588     -          try {
1805     -1774     -    1252 +285     -589     -            return katex.renderToString(token.text, {
1806     -1775     -    1253 +286     -590     -              displayMode: false,
1807     -1776     -    1254 +287     -591     -              throwOnError: false,
1808     -1777     -    1255 +288     -592     -              trust: true,
1809     -1778     -    1256 +289     -593     -              strict: false,
1810     -1779     -    1257 +290     -594     -            });
1811     -1780     -    1258 +291     -595     -          } catch (e) {
1812     -1781     -    1259 +292     -596     -            console.warn('KaTeX paren render error:', e);
1813     -1782     -    1260 +293     -597     -            return `<span style="color: red;">LaTeX Error</span>`;
1814     -1783     -    1261 +294     -598     -          }
1815     -1784     -    1262 +295     -599     -        },
1816     -1785     -    1263 +296     -600     -      },
1817     -1786     -    1264 +297     -601 419        {
1818     -1787     -    1265 +298     -602 420          name: 'subscript',
1819     -1788     -    1266 +299     -603 421          level: 'inline',
1820     -1789     -    1267 +300     -@@ -641,7 +459,7 @@ graph TD
1821     -1790     -    1268 +301     -641 459      ],
1822     -1791     -    1269 +302     -642 460    });
1823     -1792     -    1270 +303     -643 461  
1824     -1793     -    1271 +304     -644     -  console.log('‚úÖ LaTeX environments, subscript, and superscript enabled');
1825     -1794     -    1272 +305     -    462 +  console.log('‚úÖ Subscript and superscript enabled (LaTeX environments display as-is)');
1826     -1795     -    1273 +306     -645 463  
1827     -1796     -    1274 +307     -646 464    // Render markdown
1828     -1797     -    1275 +308     -647 465    function renderMarkdown() {
1829     -1798     -    1276 +309     -@@ -685,22 +503,9 @@ graph TD
1830     -1799     -    1277 +310     -685 503        // Apply Prism syntax highlighting using PrismService
1831     -1800     -    1278 +311     -686 504        prismService.highlightAll(preview);
1832     -1801     -    1279 +312     -687 505  
1833     -1802     -    1280 +313     -688     -      // Apply KaTeX auto-render only for any remaining $...$ syntax
1834     -1803     -    1281 +314     -689     -      if (typeof renderMathInElement !== 'undefined') {
1835     -1804     -    1282 +315     -690     -        try {
1836     -1805     -    1283 +316     -691     -          renderMathInElement(preview, {
1837     -1806     -    1284 +317     -692     -            delimiters: [
1838     -1807     -    1285 +318     -693     -              { left: '$$', right: '$$', display: true },
1839     -1808     -    1286 +319     -694     -              { left: '$', right: '$', display: false },
1840     -1809     -    1287 +320     -695     -            ],
1841     -1810     -    1288 +321     -696     -            throwOnError: false,
1842     -1811     -    1289 +322     -697     -            trust: true,
1843     -1812     -    1290 +323     -698     -            strict: false,
1844     -1813     -    1291 +324     -699     -          });
1845     -1814     -    1292 +325     -700     -        } catch (e) {
1846     -1815     -    1293 +326     -701     -          console.warn('KaTeX auto-render error:', e);
1847     -1816     -    1294 +327     -702     -        }
1848     -1817     -    1295 +328     -703     -      }
1849     -1818     -    1296 +329     -    506 +      // NOTE: KaTeX auto-render is DISABLED
1850     -1819     -    1297 +330     -    507 +      // We handle all math via marked.js extensions ($...$ and $$...$$)
1851     -1820     -    1298 +331     -    508 +      // KaTeX auto-render was causing issues with unsupported LaTeX environments
1852     -1821     -    1299 +332     -704 509  
1853     -1822     -    1300 +333     -705 510        // Save content using StorageManager
1854     -1823     -    1301 +334     -706 511        storageManager.set('markdownContent', markdownText);
1855     -1824     -    1302 +335     -@@ -1167,11 +972,21 @@ graph TD
1856     -1825     -    1303 +336     -1167 972    // Load saved theme using ThemeManager
1857     -1826     -    1304 +337     -1168 973    const savedTheme = storageManager.get('selectedTheme');
1858     -1827     -    1305 +338     -1169 974    if (savedTheme) {
1859     -1828     -    1306 +339     -1170     -    themeSelector.value = savedTheme;
1860     -1829     -    1307 +340     -1171     -    themeManager.loadTheme(savedTheme).catch(err => {
1861     -1830     -    1308 +341     -1172     -      console.error('Failed to load saved theme:', err);
1862     -1831     -    1309 +342     -1173     -      themeManager.loadTheme('default-light');
1863     -1832     -    1310 +343     -1174     -    });
1864     -1833     -    1311 +344     -    975 +    // Load theme first, then sync dropdown only on success
1865     -1834     -    1312 +345     -    976 +    themeManager
1866     -1835     -    1313 +346     -    977 +      .loadTheme(savedTheme)
1867     -1836     -    1314 +347     -    978 +      .then(() => {
1868     -1837     -    1315 +348     -    979 +        // Theme loaded successfully - sync dropdown
1869     -1838     -    1316 +349     -    980 +        themeSelector.value = savedTheme;
1870     -1839     -    1317 +350     -    981 +        console.log(`‚úÖ Theme restored: ${savedTheme}`);
1871     -1840     -    1318 +351     -    982 +      })
1872     -1841     -    1319 +352     -    983 +      .catch(err => {
1873     -1842     -    1320 +353     -    984 +        console.error('Failed to load saved theme:', err);
1874     -1843     -    1321 +354     -    985 +        // Fallback to default-light on error
1875     -1844     -    1322 +355     -    986 +        themeManager.loadTheme('default-light').then(() => {
1876     -1845     -    1323 +356     -    987 +          themeSelector.value = 'default-light';
1877     -1846     -    1324 +357     -    988 +        });
1878     -1847     -    1325 +358     -    989 +      });
1879     -1848     -    1326 +359     -1175 990    }
1880     -1849     -    1327 +360     -1176 991  
1881     -1850     -    1328 +361     -1177 992    // Zoom functionality
1882     -1851     -    1329 +362     -1178 993  
1883     -1852     -    1330 +    965 +@@ -20,9 +20,20 @@ const folderBrowserService = new FolderBrowserService(storageManager);
1884     -1853     -    1331 +    966 + 20  20  const currentFolderFiles = [];
1885     -1854     -    1332 +    967 + 21  21  const currentFileHandle = null;
1886     -1855     -    1333 +    968 + 22  22  
1887     -1856     -    1334 +    969 + 23     -// Configure theme change listener to update Mermaid
1888     -1857     -    1335 +    970 +     23 +// Global render function reference (will be set in setupEditor)
1889     -1858     -    1336 +    971 +     24 +let globalRenderMarkdown = null;
1890     -1859     -    1337 +    972 +     25 +
1891     -1860     -    1338 +    973 +     26 +// Configure theme change listener to update Mermaid and force re-render
1892     -1861     -    1339 +    974 + 24  27  themeManager.setThemeChangeListener(() => {
1893     -1862     -    1340 +    975 + 25  28    mermaidService.reinitialize();
1894     -1863     -    1341 +    976 +     29 +
1895     -1864     -    1342 +    977 +     30 +  // Force re-render of markdown to apply new Mermaid colors
1896     -1865     -    1343 +    978 +     31 +  setTimeout(() => {
1897     -1866     -    1344 +    979 +     32 +    if (globalRenderMarkdown) {
1898     -1867     -    1345 +    980 +     33 +      console.log('üîÑ Re-rendering diagrams with new theme colors');
1899     -1868     -    1346 +    981 +     34 +      globalRenderMarkdown();
1900     -1869     -    1347 +    982 +     35 +    }
1901     -1870     -    1348 +    983 +     36 +  }, 200);
1902     -1871     -    1349 +    984 + 26  37  });
1903     -1872     -    1350 +    985 + 27  38  
1904     -1873     -    1351 +    986 + 28  39  // Wait for all scripts to load
1905     -1874     -    1352 +    987 +@@ -77,8 +88,8 @@ function initializeApp() {
1906     -1875     -    1353 +    988 + 77  88    // Configure marked.js extensions
1907     -1876     -    1354 +    989 + 78  89    configureMarkedExtensions();
1908     -1877     -    1355 +    990 + 79  90  
1909     -1878     -    1356 +    991 + 80     -  // Initialize Mermaid with theme-aware configuration
1910     -1879     -    1357 +    992 + 81     -  initMermaidTheme();
1911     -1880     -    1358 +    993 +     91 +  // DON'T initialize Mermaid here - let saved theme load first
1912     -1881     -    1359 +    994 +     92 +  // Mermaid will initialize after theme loads in setupEditor()
1913     -1882     -    1360 +    995 + 82  93  
1914     -1883     -    1361 +    996 + 83  94    setupEditor();
1915     -1884     -    1362 +    997 + 84  95  }
1916     -1885     -    1363 +    998 +@@ -461,7 +472,7 @@ graph TD
1917     -1886     -    1364 +    999 +461 472  
1918     -1887     -    1365 +    1000 +462 473    console.log('‚úÖ Subscript and superscript enabled (LaTeX environments display as-is)');
1919     -1888     -    1366 +    1001 +463 474  
1920     -1889     -    1367 +    1002 +464     -  // Render markdown
1921     -1890     -    1368 +    1003 +    475 +  // Render markdown (expose globally for theme changes)
1922     -1891     -    1369 +    1004 +465 476    function renderMarkdown() {
1923     -1892     -    1370 +    1005 +466 477      try {
1924     -1893     -    1371 +    1006 +467 478        const markdownText = editor.value;
1925     -1894     -    1372 +    1007 +@@ -520,8 +531,16 @@ graph TD
1926     -1895     -    1373 +    1008 +520 531    async function changeTheme(themeName) {
1927     -1896     -    1374 +    1009 +521 532      await themeManager.loadTheme(themeName);
1928     -1897     -    1375 +    1010 +522 533  
1929     -1898     -    1376 +    1011 +523     -    // Re-render to apply new Mermaid theme (observer already handles reinit)
1930     -1899     -    1377 +    1012 +    534 +    // Wait for theme to load, then reinitialize Mermaid and force re-render
1931     -1900     -    1378 +    1013 +524 535      setTimeout(() => {
1932     -1901     -    1379 +    1014 +    536 +      // Clear existing Mermaid diagrams to force fresh render with new colors
1933     -1902     -    1380 +    1015 +    537 +      const mermaidElements = preview.querySelectorAll('.mermaid');
1934     -1903     -    1381 +    1016 +    538 +      mermaidElements.forEach(el => {
1935     -1904     -    1382 +    1017 +    539 +        // Reset to original code to force re-render
1936     -1905     -    1383 +    1018 +    540 +        el.innerHTML = el.dataset.originalCode || '';
1937     -1906     -    1384 +    1019 +    541 +      });
1938     -1907     -    1385 +    1020 +    542 +
1939     -1908     -    1386 +    1021 +    543 +      // Re-render markdown with new theme
1940     -1909     -    1387 +    1022 +525 544        renderMarkdown();
1941     -1910     -    1388 +    1023 +526 545      }, 100);
1942     -1911     -    1389 +    1024 +527 546    }
1943     -1912     -    1390 +    1025 +@@ -969,24 +988,36 @@ graph TD
1944     -1913     -    1391 +    1026 +969 988    // Initialize visibility
1945     -1914     -    1392 +    1027 +970 989    updateSyncScrollVisibility();
1946     -1915     -    1393 +    1028 +971 990  
1947     -1916     -    1394 +    1029 +972     -  // Load saved theme using ThemeManager
1948     -1917     -    1395 +    1030 +    991 +  // Load saved theme FIRST, then initialize Mermaid with correct colors
1949     -1918     -    1396 +    1031 +973 992    const savedTheme = storageManager.get('selectedTheme');
1950     -1919     -    1397 +    1032 +974 993    if (savedTheme) {
1951     -1920     -    1398 +    1033 +975     -    // Load theme first, then sync dropdown only on success
1952     -1921     -    1399 +    1034 +    994 +    // Load theme first, then sync dropdown and reinit Mermaid
1953     -1922     -    1400 +    1035 +976 995      themeManager
1954     -1923     -    1401 +    1036 +977 996        .loadTheme(savedTheme)
1955     -1924     -    1402 +    1037 +978 997        .then(() => {
1956     -1925     -    1403 +    1038 +979 998          // Theme loaded successfully - sync dropdown
1957     -1926     -    1404 +    1039 +980 999          themeSelector.value = savedTheme;
1958     -1927     -    1405 +    1040 +981 1000          console.log(`‚úÖ Theme restored: ${savedTheme}`);
1959     -1928     -    1406 +    1041 +    1001 +
1960     -1929     -    1407 +    1042 +    1002 +        // NOW initialize Mermaid with correct theme colors
1961     -1930     -    1408 +    1043 +    1003 +        mermaidService.initialize();
1962     -1931     -    1409 +    1044 +    1004 +
1963     -1932     -    1410 +    1045 +    1005 +        // Re-render to apply theme
1964     -1933     -    1411 +    1046 +    1006 +        renderMarkdown();
1965     -1934     -    1412 +    1047 +982 1007        })
1966     -1935     -    1413 +    1048 +983 1008        .catch(err => {
1967     -1936     -    1414 +    1049 +984 1009          console.error('Failed to load saved theme:', err);
1968     -1937     -    1415 +    1050 +985 1010          // Fallback to default-light on error
1969     -1938     -    1416 +    1051 +986 1011          themeManager.loadTheme('default-light').then(() => {
1970     -1939     -    1417 +    1052 +987 1012            themeSelector.value = 'default-light';
1971     -1940     -    1418 +    1053 +    1013 +          mermaidService.initialize();
1972     -1941     -    1419 +    1054 +    1014 +          renderMarkdown();
1973     -1942     -    1420 +    1055 +988 1015          });
1974     -1943     -    1421 +    1056 +989 1016        });
1975     -1944     -    1422 +    1057 +    1017 +  } else {
1976     -1945     -    1423 +    1058 +    1018 +    // No saved theme - initialize with default-light
1977     -1946     -    1424 +    1059 +    1019 +    mermaidService.initialize();
1978     -1947     -    1425 +    1060 +    1020 +    renderMarkdown();
1979     -1948     -    1426 +    1061 +990 1021    }
1980     -1949     -    1427 +    1062 +991 1022  
1981     -1950     -    1428 +    1063 +992 1023    // Zoom functionality
1982     -1951     -    1429 +    1064 +@@ -1332,6 +1363,9 @@ graph TD
1983     -1952     -    1430 +    1065 +1332 1363      console.log(`‚úÖ Loaded file: ${fileItem.name} (${result.size} bytes)`);
1984     -1953     -    1431 +    1066 +1333 1364    }
1985     -1954     -    1432 +    1067 +1334 1365  
1986     -1955     -    1433 +    1068 +1335     -  // Initial render
1987     -1956     -    1434 +    1069 +1336     -  renderMarkdown();
1988     -1957     -    1435 +    1070 +    1366 +  // Expose renderMarkdown globally for theme changes
1989     -1958     -    1436 +    1071 +    1367 +  globalRenderMarkdown = renderMarkdown;
1990     -1959     -    1437 +    1072 +    1368 +
1991     -1960     -    1438 +    1073 +    1369 +  // DON'T render immediately - wait for theme to load
1992     -1961     -    1439 +    1074 +    1370 +  // renderMarkdown will be called after theme loads above
1993     -1962     -    1440 +    1075 +1337 1371  }
1994     -1963     -    1441 +    1076 +1338 1372  
1995     -1964     -    1442 +    1077 +
1996     -1965     -    1443 +    1078 +```
1997     -1966     -    1444 +    1079 +
1998     -1967     -    1445 +    1080 +
1999     -1968     -    1446 +    1081 +### üìÑ `src/js/services/MermaidService.js`
2000     -1969     -    1447 +    1082 +
2001     -1970     -    1448 +    1083 +**Type:** JavaScript Source File üü®
2002     -1971     -    1449 +    1084 +
2003     -1972     -    1450 +    1085 +```diff
2004     -1973     -    1451 +    1086 +@@ -2,12 +2,51 @@
2005     -1974     -    1452 +    1087 +  2   2   * MermaidService - Mermaid Diagram Rendering Service
2006     -1975     -    1453 +    1088 +  3   3   *
2007     -1976     -    1454 +    1089 +  4   4   * Handles all Mermaid diagram rendering with theme-aware configuration.
2008     -1977     -    1455 +    1090 +      5 + * Automatically detects light/dark themes and adjusts for optimal readability.
2009     -1978     -    1456 +    1091 +  5   6   * Isolated service for better testability and maintainability.
2010     -1979     -    1457 +    1092 +  6   7   */
2011     -1980     -    1458 +    1093 +  7   8  
2012     -1981     -    1459 +    1094 +  8   9  import { MERMAID_CONFIG } from '../config/constants.js';
2013     -1982     -    1460 +    1095 +  9  10  import { getCssVariable } from '../utils/colorHelpers.js';
2014     -1983     -    1461 +    1096 + 10  11  
2015     -1984     -    1462 +    1097 +     12 +/**
2016     -1985     -    1463 +    1098 +     13 + * Calculate relative luminance of a color
2017     -1986     -    1464 +    1099 +     14 + * Used to detect if theme is light or dark
2018     -1987     -    1465 +    1100 +     15 + *
2019     -1988     -    1466 +    1101 +     16 + * @param {string} color - Hex color (#rrggbb)
2020     -1989     -    1467 +    1102 +     17 + * @returns {number} Luminance value (0-1)
2021     -1990     -    1468 +    1103 +     18 + * @private
2022     -1991     -    1469 +    1104 +     19 + */
2023     -1992     -    1470 +    1105 +     20 +function getRelativeLuminance(color) {
2024     -1993     -    1471 +    1106 +     21 +  // Remove # if present
2025     -1994     -    1472 +    1107 +     22 +  const hex = color.replace('#', '');
2026     -1995     -    1473 +    1108 +     23 +
2027     -1996     -    1474 +    1109 +     24 +  // Convert to RGB
2028     -1997     -    1475 +    1110 +     25 +  const r = parseInt(hex.substr(0, 2), 16) / 255;
2029     -1998     -    1476 +    1111 +     26 +  const g = parseInt(hex.substr(2, 2), 16) / 255;
2030     -1999     -    1477 +    1112 +     27 +  const b = parseInt(hex.substr(4, 2), 16) / 255;
2031     -2000     -    1478 +    1113 +     28 +
2032     -2001     -    1479 +    1114 +     29 +  // Apply sRGB gamma correction
2033     -2002     -    1480 +    1115 +     30 +  const rsRGB = r <= 0.03928 ? r / 12.92 : ((r + 0.055) / 1.055) ** 2.4;
2034     -2003     -    1481 +    1116 +     31 +  const gsRGB = g <= 0.03928 ? g / 12.92 : ((g + 0.055) / 1.055) ** 2.4;
2035     -2004     -    1482 +    1117 +     32 +  const bsRGB = b <= 0.03928 ? b / 12.92 : ((b + 0.055) / 1.055) ** 2.4;
2036     -2005     -    1483 +    1118 +     33 +
2037     -2006     -    1484 +    1119 +     34 +  // Calculate relative luminance
2038     -2007     -    1485 +    1120 +     35 +  return 0.2126 * rsRGB + 0.7152 * gsRGB + 0.0722 * bsRGB;
2039     -2008     -    1486 +    1121 +     36 +}
2040     -2009     -    1487 +    1122 +     37 +
2041     -2010     -    1488 +    1123 +     38 +/**
2042     -2011     -    1489 +    1124 +     39 + * Detect if current theme is light or dark
2043     -2012     -    1490 +    1125 +     40 + *
2044     -2013     -    1491 +    1126 +     41 + * @param {string} bgColor - Background color
2045     -2014     -    1492 +    1127 +     42 + * @returns {boolean} True if light theme
2046     -2015     -    1493 +    1128 +     43 + * @private
2047     -2016     -    1494 +    1129 +     44 + */
2048     -2017     -    1495 +    1130 +     45 +function isLightTheme(bgColor) {
2049     -2018     -    1496 +    1131 +     46 +  const luminance = getRelativeLuminance(bgColor);
2050     -2019     -    1497 +    1132 +     47 +  return luminance > 0.5; // Threshold for light/dark
2051     -2020     -    1498 +    1133 +     48 +}
2052     -2021     -    1499 +    1134 +     49 +
2053     -2022     -    1500 +    1135 + 11  50  /**
2054     -2023     -    1501 +    1136 + 12  51   * @class MermaidService
2055     -2024     -    1502 +    1137 + 13  52   * @description Service for rendering Mermaid diagrams with theme integration
2056     -2025     -    1503 +    1138 +@@ -23,46 +62,187 @@ export class MermaidService {
2057     -2026     -    1504 +    1139 + 23  62    }
2058     -2027     -    1505 +    1140 + 24  63  
2059     -2028     -    1506 +    1141 + 25  64    /**
2060     -2029     -    1507 +    1142 + 26     -   * Initialize Mermaid with current theme colors
2061     -2030     -    1508 +    1143 + 27     -   * Extracts theme colors from CSS variables and configures Mermaid
2062     -2031     -    1509 +    1144 +     65 +   * Initialize Mermaid with COMPREHENSIVE theme configuration
2063     -2032     -    1510 +    1145 +     66 +   * Reads ALL 60+ variables from theme CSS with smart fallbacks
2064     -2033     -    1511 +    1146 +     67 +   * Based on official Mermaid.js theming documentation
2065     -2034     -    1512 +    1147 + 28  68     *
2066     -2035     -    1513 +    1148 + 29  69     * @returns {void}
2067     -2036     -    1514 +    1149 + 30  70     */
2068     -2037     -    1515 +    1150 + 31  71    initialize() {
2069     -2038     -    1516 +    1151 + 32     -    // Extract theme colors from CSS variables
2070     -2039     -    1517 +    1152 + 33     -    const h1Color = getCssVariable('--h1-color');
2071     -2040     -    1518 +    1153 + 34     -    const h2Color = getCssVariable('--h2-color');
2072     -2041     -    1519 +    1154 + 35     -    const h3Color = getCssVariable('--h3-color');
2073     -2042     -    1520 +    1155 + 36     -    const bgSecondary = getCssVariable('--bg-secondary');
2074     -2043     -    1521 +    1156 + 37     -    const textPrimary = getCssVariable('--text-primary');
2075     -2044     -    1522 +    1157 +     72 +    // Helper to get variable with fallback
2076     -2045     -    1523 +    1158 +     73 +    const get = (varName, fallback) => {
2077     -2046     -    1524 +    1159 +     74 +      const value = getCssVariable(varName);
2078     -2047     -    1525 +    1160 +     75 +      return value && value.trim() !== '' ? value : fallback;
2079     -2048     -    1526 +    1161 +     76 +    };
2080     -2049     -    1527 +    1162 +     77 +
2081     -2050     -    1528 +    1163 +     78 +    // Extract core theme colors for fallbacks
2082     -2051     -    1529 +    1164 +     79 +    const bgPri = getCssVariable('--bg-primary');
2083     -2052     -    1530 +    1165 +     80 +    const bgSec = getCssVariable('--bg-secondary');
2084     -2053     -    1531 +    1166 +     81 +    const bgTer = getCssVariable('--bg-tertiary');
2085     -2054     -    1532 +    1167 +     82 +    const txtPri = getCssVariable('--text-primary');
2086     -2055     -    1533 +    1168 +     83 +    const txtSec = getCssVariable('--text-secondary');
2087     -2056     -    1534 +    1169 +     84 +    const h1 = getCssVariable('--h1-color');
2088     -2057     -    1535 +    1170 +     85 +    const h2 = getCssVariable('--h2-color');
2089     -2058     -    1536 +    1171 +     86 +    const h3 = getCssVariable('--h3-color');
2090     -2059     -    1537 +    1172 +     87 +
2091     -2060     -    1538 +    1173 +     88 +    const isLight = isLightTheme(bgPri);
2092     -2061     -    1539 +    1174 +     89 +    const nodeBkg = isLight ? bgTer : bgSec;
2093     -2062     -    1540 +    1175 +     90 +    const clusterBkg = isLight ? bgSec : bgTer;
2094     -2063     -    1541 +    1176 + 38  91  
2095     -2064     -    1542 +    1177 + 39     -    // Configure Mermaid with theme colors
2096     -2065     -    1543 +    1178 + 40  92      if (typeof mermaid !== 'undefined') {
2097     -2066     -    1544 +    1179 + 41  93        mermaid.initialize({
2098     -2067     -    1545 +    1180 + 42  94          startOnLoad: MERMAID_CONFIG.START_ON_LOAD,
2099     -2068     -    1546 +    1181 + 43  95          theme: MERMAID_CONFIG.THEME,
2100     -2069     -    1547 +    1182 + 44  96          themeVariables: {
2101     -2070     -    1548 +    1183 + 45     -          primaryColor: bgSecondary,
2102     -2071     -    1549 +    1184 + 46     -          primaryTextColor: textPrimary,
2103     -2072     -    1550 +    1185 + 47     -          primaryBorderColor: h1Color,
2104     -2073     -    1551 +    1186 + 48     -          lineColor: h2Color,
2105     -2074     -    1552 +    1187 + 49     -          secondaryColor: bgSecondary,
2106     -2075     -    1553 +    1188 + 50     -          tertiaryColor: bgSecondary,
2107     -2076     -    1554 +    1189 + 51     -          background: bgSecondary,
2108     -2077     -    1555 +    1190 + 52     -          mainBkg: bgSecondary,
2109     -2078     -    1556 +    1191 + 53     -          secondBkg: bgSecondary,
2110     -2079     -    1557 +    1192 + 54     -          tertiaryBkg: bgSecondary,
2111     -2080     -    1558 +    1193 + 55     -          nodeBorder: h1Color,
2112     -2081     -    1559 +    1194 + 56     -          clusterBkg: bgSecondary,
2113     -2082     -    1560 +    1195 + 57     -          clusterBorder: h3Color,
2114     -2083     -    1561 +    1196 + 58     -          titleColor: textPrimary,
2115     -2084     -    1562 +    1197 + 59     -          edgeLabelBackground: bgSecondary,
2116     -2085     -    1563 +    1198 + 60     -          nodeTextColor: textPrimary,
2117     -2086     -    1564 +    1199 +     97 +          // Core Global
2118     -2087     -    1565 +    1200 +     98 +          background: get('--mermaid-background', bgPri),
2119     -2088     -    1566 +    1201 + 61  99            fontFamily: '-apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif',
2120     -2089     -    1567 +    1202 +    100 +          fontSize: '16px',
2121     -2090     -    1568 +    1203 +    101 +          darkMode: !isLight,
2122     -2091     -    1569 +    1204 +    102 +          textColor: get('--mermaid-text-color', txtPri),
2123     -2092     -    1570 +    1205 +    103 +          lineColor: get('--mermaid-line-color', h2),
2124     -2093     -    1571 +    1206 +    104 +          mainBkg: get('--mermaid-main-bkg', nodeBkg),
2125     -2094     -    1572 +    1207 +    105 +
2126     -2095     -    1573 +    1208 +    106 +          // Primary Set
2127     -2096     -    1574 +    1209 +    107 +          primaryColor: get('--mermaid-primary-color', nodeBkg),
2128     -2097     -    1575 +    1210 +    108 +          primaryTextColor: get('--mermaid-primary-text-color', txtPri),
2129     -2098     -    1576 +    1211 +    109 +          primaryBorderColor: get('--mermaid-primary-border-color', h1),
2130     -2099     -    1577 +    1212 +    110 +
2131     -2100     -    1578 +    1213 +    111 +          // Secondary Set
2132     -2101     -    1579 +    1214 +    112 +          secondaryColor: get('--mermaid-secondary-color', clusterBkg),
2133     -2102     -    1580 +    1215 +    113 +          secondaryTextColor: get('--mermaid-secondary-text-color', txtPri),
2134     -2103     -    1581 +    1216 +    114 +          secondaryBorderColor: get('--mermaid-secondary-border-color', h2),
2135     -2104     -    1582 +    1217 +    115 +
2136     -2105     -    1583 +    1218 +    116 +          // Tertiary Set
2137     -2106     -    1584 +    1219 +    117 +          tertiaryColor: get('--mermaid-tertiary-color', bgPri),
2138     -2107     -    1585 +    1220 +    118 +          tertiaryTextColor: get('--mermaid-tertiary-text-color', txtPri),
2139     -2108     -    1586 +    1221 +    119 +          tertiaryBorderColor: get('--mermaid-tertiary-border-color', h3),
2140     -2109     -    1587 +    1222 +    120 +
2141     -2110     -    1588 +    1223 +    121 +          // Flowchart
2142     -2111     -    1589 +    1224 +    122 +          nodeBorder: get('--mermaid-node-border', h1),
2143     -2112     -    1590 +    1225 +    123 +          clusterBkg: get('--mermaid-cluster-bkg', clusterBkg),
2144     -2113     -    1591 +    1226 +    124 +          clusterBorder: get('--mermaid-cluster-border', h2),
2145     -2114     -    1592 +    1227 +    125 +          defaultLinkColor: get('--mermaid-default-link-color', h2),
2146     -2115     -    1593 +    1228 +    126 +          titleColor: get('--mermaid-title-color', txtPri),
2147     -2116     -    1594 +    1229 +    127 +          edgeLabelBackground: get('--mermaid-edge-label-background', bgPri),
2148     -2117     -    1595 +    1230 +    128 +          nodeTextColor: get('--mermaid-node-text-color', txtPri),
2149     -2118     -    1596 +    1231 +    129 +
2150     -2119     -    1597 +    1232 +    130 +          // Sequence Diagram
2151     -2120     -    1598 +    1233 +    131 +          actorBkg: get('--mermaid-actor-bkg', nodeBkg),
2152     -2121     -    1599 +    1234 +    132 +          actorBorder: get('--mermaid-actor-border', h1),
2153     -2122     -    1600 +    1235 +    133 +          actorTextColor: get('--mermaid-actor-text-color', txtPri),
2154     -2123     -    1601 +    1236 +    134 +          actorLineColor: get('--mermaid-actor-line-color', h1),
2155     -2124     -    1602 +    1237 +    135 +          signalColor: get('--mermaid-signal-color', h2),
2156     -2125     -    1603 +    1238 +    136 +          signalTextColor: get('--mermaid-signal-text-color', txtPri),
2157     -2126     -    1604 +    1239 +    137 +          labelBoxBkgColor: get('--mermaid-label-box-bkg-color', nodeBkg),
2158     -2127     -    1605 +    1240 +    138 +          labelBoxBorderColor: get('--mermaid-label-box-border-color', h1),
2159     -2128     -    1606 +    1241 +    139 +          labelTextColor: get('--mermaid-label-text-color', txtPri),
2160     -2129     -    1607 +    1242 +    140 +          loopTextColor: get('--mermaid-loop-text-color', txtPri),
2161     -2130     -    1608 +    1243 +    141 +          activationBorderColor: get('--mermaid-activation-border-color', h2),
2162     -2131     -    1609 +    1244 +    142 +          activationBkgColor: get('--mermaid-activation-bkg-color', clusterBkg),
2163     -2132     -    1610 +    1245 +    143 +          sequenceNumberColor: get('--mermaid-sequence-number-color', txtPri),
2164     -2133     -    1611 +    1246 +    144 +
2165     -2134     -    1612 +    1247 +    145 +          // Pie Chart
2166     -2135     -    1613 +    1248 +    146 +          pie1: get('--mermaid-pie1', h1),
2167     -2136     -    1614 +    1249 +    147 +          pie2: get('--mermaid-pie2', h2),
2168     -2137     -    1615 +    1250 +    148 +          pie3: get('--mermaid-pie3', h3),
2169     -2138     -    1616 +    1251 +    149 +          pie4: get('--mermaid-pie4', txtSec),
2170     -2139     -    1617 +    1252 +    150 +          pie5: get('--mermaid-pie5', h1),
2171     -2140     -    1618 +    1253 +    151 +          pie6: get('--mermaid-pie6', h2),
2172     -2141     -    1619 +    1254 +    152 +          pie7: get('--mermaid-pie7', h3),
2173     -2142     -    1620 +    1255 +    153 +          pie8: get('--mermaid-pie8', txtSec),
2174     -2143     -    1621 +    1256 +    154 +          pie9: get('--mermaid-pie9', h1),
2175     -2144     -    1622 +    1257 +    155 +          pie10: get('--mermaid-pie10', h2),
2176     -2145     -    1623 +    1258 +    156 +          pie11: get('--mermaid-pie11', h3),
2177     -2146     -    1624 +    1259 +    157 +          pie12: get('--mermaid-pie12', txtSec),
2178     -2147     -    1625 +    1260 +    158 +          pieTitleTextSize: '25px',
2179     -2148     -    1626 +    1261 +    159 +          pieTitleTextColor: get('--mermaid-pie-title-text-color', txtPri),
2180     -2149     -    1627 +    1262 +    160 +          pieSectionTextSize: '17px',
2181     -2150     -    1628 +    1263 +    161 +          pieSectionTextColor: get('--mermaid-pie-section-text-color', bgPri),
2182     -2151     -    1629 +    1264 +    162 +          pieLegendTextSize: '17px',
2183     -2152     -    1630 +    1265 +    163 +          pieLegendTextColor: get('--mermaid-pie-legend-text-color', txtPri),
2184     -2153     -    1631 +    1266 +    164 +          pieStrokeColor: get('--mermaid-pie-stroke-color', h1),
2185     -2154     -    1632 +    1267 +    165 +          pieStrokeWidth: '2px',
2186     -2155     -    1633 +    1268 +    166 +          pieOuterStrokeWidth: '2px',
2187     -2156     -    1634 +    1269 +    167 +          pieOuterStrokeColor: get('--mermaid-pie-outer-stroke-color', h1),
2188     -2157     -    1635 +    1270 +    168 +          pieOpacity: '0.9',
2189     -2158     -    1636 +    1271 +    169 +
2190     -2159     -    1637 +    1272 +    170 +          // State Diagram
2191     -2160     -    1638 +    1273 +    171 +          labelColor: get('--mermaid-label-color', txtPri),
2192     -2161     -    1639 +    1274 +    172 +          altBackground: get('--mermaid-alt-background', clusterBkg),
2193     -2162     -    1640 +    1275 +    173 +
2194     -2163     -    1641 +    1276 +    174 +          // Class Diagram
2195     -2164     -    1642 +    1277 +    175 +          classText: get('--mermaid-class-text', txtPri),
2196     -2165     -    1643 +    1278 +    176 +
2197     -2166     -    1644 +    1279 +    177 +          // User Journey
2198     -2167     -    1645 +    1280 +    178 +          fillType0: get('--mermaid-fill-type0', h1),
2199     -2168     -    1646 +    1281 +    179 +          fillType1: get('--mermaid-fill-type1', h2),
2200     -2169     -    1647 +    1282 +    180 +          fillType2: get('--mermaid-fill-type2', h3),
2201     -2170     -    1648 +    1283 +    181 +          fillType3: get('--mermaid-fill-type3', txtSec),
2202     -2171     -    1649 +    1284 +    182 +          fillType4: get('--mermaid-fill-type4', h1),
2203     -2172     -    1650 +    1285 +    183 +          fillType5: get('--mermaid-fill-type5', h2),
2204     -2173     -    1651 +    1286 +    184 +          fillType6: get('--mermaid-fill-type6', h3),
2205     -2174     -    1652 +    1287 +    185 +          fillType7: get('--mermaid-fill-type7', txtSec),
2206     -2175     -    1653 +    1288 +    186 +
2207     -2176     -    1654 +    1289 +    187 +          // Gantt Chart
2208     -2177     -    1655 +    1290 +    188 +          sectionBkgColor: get('--mermaid-section-bkg-color', bgSec),
2209     -2178     -    1656 +    1291 +    189 +          altSectionBkgColor: get('--mermaid-alt-section-bkg-color', bgTer),
2210     -2179     -    1657 +    1292 +    190 +          sectionBkgColor2: get('--mermaid-section-bkg-color2', bgSec),
2211     -2180     -    1658 +    1293 +    191 +          taskTextColor: get('--mermaid-task-text-color', txtPri),
2212     -2181     -    1659 +    1294 +    192 +          taskTextLightColor: get('--mermaid-task-text-light-color', txtPri),
2213     -2182     -    1660 +    1295 +    193 +          taskTextOutsideColor: get('--mermaid-task-text-outside-color', txtPri),
2214     -2183     -    1661 +    1296 +    194 +          taskTextClickableColor: get('--mermaid-task-text-clickable-color', h1),
2215     -2184     -    1662 +    1297 +    195 +          activeTaskBkgColor: get('--mermaid-active-task-bkg-color', h1),
2216     -2185     -    1663 +    1298 +    196 +          activeTaskBorderColor: get('--mermaid-active-task-border-color', h1),
2217     -2186     -    1664 +    1299 +    197 +          doneTaskBkgColor: get('--mermaid-done-task-bkg-color', h3),
2218     -2187     -    1665 +    1300 +    198 +          doneTaskBorderColor: get('--mermaid-done-task-border-color', h3),
2219     -2188     -    1666 +    1301 +    199 +          critBorderColor: get('--mermaid-crit-border-color', h2),
2220     -2189     -    1667 +    1302 +    200 +          critBkgColor: get('--mermaid-crit-bkg-color', h2),
2221     -2190     -    1668 +    1303 +    201 +          todayLineColor: get('--mermaid-today-line-color', h2),
2222     -2191     -    1669 +    1304 +    202 +          gridColor: get('--mermaid-grid-color', bgTer),
2223     -2192     -    1670 +    1305 +    203 +          sectionTextColor: get('--mermaid-section-text-color', txtPri),
2224     -2193     -    1671 +    1306 +    204 +          taskBorderColor: get('--mermaid-task-border-color', h1),
2225     -2194     -    1672 +    1307 +    205 +
2226     -2195     -    1673 +    1308 +    206 +          // ER Diagram
2227     -2196     -    1674 +    1309 +    207 +          attributeBackgroundColorOdd: get('--mermaid-attribute-background-color-odd', bgSec),
2228     -2197     -    1675 +    1310 +    208 +          attributeBackgroundColorEven: get('--mermaid-attribute-background-color-even', bgPri),
2229     -2198     -    1676 +    1311 +    209 +          relationshipLabelBackground: get('--mermaid-relationship-label-background', bgPri),
2230     -2199     -    1677 +    1312 +    210 +          relationshipLabelColor: get('--mermaid-relationship-label-color', txtPri),
2231     -2200     -    1678 +    1313 +    211 +          entityBackground: get('--mermaid-entity-background', nodeBkg),
2232     -2201     -    1679 +    1314 +    212 +          entityBorderColor: get('--mermaid-entity-border-color', h1),
2233     -2202     -    1680 +    1315 +    213 +
2234     -2203     -    1681 +    1316 +    214 +          // Git Graph
2235     -2204     -    1682 +    1317 +    215 +          git0: get('--mermaid-git0', h1),
2236     -2205     -    1683 +    1318 +    216 +          git1: get('--mermaid-git1', h2),
2237     -2206     -    1684 +    1319 +    217 +          git2: get('--mermaid-git2', h3),
2238     -2207     -    1685 +    1320 +    218 +          git3: get('--mermaid-git3', txtSec),
2239     -2208     -    1686 +    1321 +    219 +          git4: get('--mermaid-git4', h1),
2240     -2209     -    1687 +    1322 +    220 +          git5: get('--mermaid-git5', h2),
2241     -2210     -    1688 +    1323 +    221 +          git6: get('--mermaid-git6', h3),
2242     -2211     -    1689 +    1324 +    222 +          git7: get('--mermaid-git7', txtSec),
2243     -2212     -    1690 +    1325 +    223 +          gitInv0: get('--mermaid-git-inv0', bgPri),
2244     -2213     -    1691 +    1326 +    224 +          gitBranchLabel0: get('--mermaid-git-branch-label0', txtPri),
2245     -2214     -    1692 +    1327 +    225 +          gitBranchLabel1: get('--mermaid-git-branch-label1', txtPri),
2246     -2215     -    1693 +    1328 +    226 +          gitBranchLabel2: get('--mermaid-git-branch-label2', txtPri),
2247     -2216     -    1694 +    1329 +    227 +          gitBranchLabel3: get('--mermaid-git-branch-label3', txtPri),
2248     -2217     -    1695 +    1330 +    228 +          gitBranchLabel4: get('--mermaid-git-branch-label4', txtPri),
2249     -2218     -    1696 +    1331 +    229 +          commitLabelColor: get('--mermaid-commit-label-color', txtPri),
2250     -2219     -    1697 +    1332 +    230 +          commitLabelBackground: get('--mermaid-commit-label-background', bgPri),
2251     -2220     -    1698 +    1333 +    231 +          tagLabelColor: get('--mermaid-tag-label-color', txtPri),
2252     -2221     -    1699 +    1334 +    232 +          tagLabelBackground: get('--mermaid-tag-label-background', nodeBkg),
2253     -2222     -    1700 +    1335 +    233 +          tagLabelBorder: get('--mermaid-tag-label-border', h1),
2254     -2223     -    1701 +    1336 + 62 234          },
2255     -2224     -    1702 +    1337 + 63 235        });
2256     -2225     -    1703 +    1338 + 64 236  
2257     -2226     -    1704 +    1339 + 65 237        this.initialized = true;
2258     -2227     -    1705 +    1340 +    238 +
2259     -2228     -    1706 +    1341 +    239 +      // Debug: Log sample of loaded variables
2260     -2229     -    1707 +    1342 +    240 +      console.log(`‚úÖ Mermaid initialized`);
2261     -2230     -    1708 +    1343 +    241 +      console.log(`  - Background: ${get('--mermaid-background', bgPri)}`);
2262     -2231     -    1709 +    1344 +    242 +      console.log(`  - Text: ${get('--mermaid-text-color', txtPri)}`);
2263     -2232     -    1710 +    1345 +    243 +      console.log(`  - Line: ${get('--mermaid-line-color', h2)}`);
2264     -2233     -    1711 +    1346 +    244 +      console.log(`  - Primary: ${get('--mermaid-primary-color', nodeBkg)}`);
2265     -2234     -    1712 +    1347 +    245 +      console.log(`  - Pie1: ${get('--mermaid-pie1', h1)}`);
2266     -2235     -    1713 +    1348 + 66 246      } else {
2267     -2236     -    1714 +    1349 + 67 247        console.warn('Mermaid library not loaded');
2268     -2237     -    1715 +    1350 + 68 248      }
2269     -2238     -    1716 +    1351 + 69 249  
2270     -2239     -    1717 +    1352 +
2271     -2240     -    1718 +    1353 +```
2272     -2241     -    1719 +    1354 +
2273     -2242     -    1720 +    1355 +
2274     -2243     -    1721 +    1356 +### üìÑ `style.css`
2275     -2244     -    1722 +    1357 +
2276     -2245     -    1723 +    1358 +**Type:** Stylesheet üé®
2277     -2246     -    1724 +    1359 +
2278     -2247     -    1725 +    1360 +```diff
2279     -2248     -    1726 +    1361 +@@ -297,68 +297,119 @@ body {
2280     -2249     -    1727 +    1362 +297 297    padding: 0;
2281     -2250     -    1728 +    1363 +298 298  }
2282     -2251     -    1729 +    1364 +299 299  
2283     -2252     -    1730 +    1365 +300     -/* Syntax Highlighting with Custom Variables - Comprehensive Token Coverage */
2284     -2253     -    1731 +    1366 +301     -#markdown-preview .token.keyword {
2285     -2254     -    1732 +    1367 +302     -  color: var(--syntax-keyword, #c792ea) !important;
2286     -2255     -    1733 +    1368 +    300 +/* ==================== PRISM SYNTAX HIGHLIGHTING - PRODUCTION GRADE ==================== */
2287     -2256     -    1734 +    1369 +    301 +/* Based on One Dark theme architecture - comprehensive token coverage */
2288     -2257     -    1735 +    1370 +    302 +
2289     -2258     -    1736 +    1371 +    303 +/* Group 1: Comments and documentation */
2290     -2259     -    1737 +    1372 +    304 +#markdown-preview .token.comment,
2291     -2260     -    1738 +    1373 +    305 +#markdown-preview .token.prolog,
2292     -2261     -    1739 +    1374 +    306 +#markdown-preview .token.cdata {
2293     -2262     -    1740 +    1375 +    307 +  color: var(--syntax-comment, #7f85a3);
2294     -2263     -    1741 +    1376 +    308 +  font-style: italic;
2295     -2264     -    1742 +    1377 +303 309  }
2296     -2265     -    1743 +    1378 +304 310  
2297     -2266     -    1744 +    1379 +305     -#markdown-preview .token.string {
2298     -2267     -    1745 +    1380 +306     -  color: var(--syntax-string, #a5e844) !important;
2299     -2268     -    1746 +    1381 +307     -}
2300     -2269     -    1747 +    1382 +308     -
2301     -2270     -    1748 +    1383 +309     -#markdown-preview .token.number,
2302     -2271     -    1749 +    1384 +310     -#markdown-preview .token.boolean {
2303     -2272     -    1750 +    1385 +311     -  color: var(--syntax-number, #ffcb6b) !important;
2304     -2273     -    1751 +    1386 +312     -}
2305     -2274     -    1752 +    1387 +313     -
2306     -2275     -    1753 +    1388 +314     -#markdown-preview .token.function,
2307     -2276     -    1754 +    1389 +315     -#markdown-preview .token.function-variable,
2308     -2277     -    1755 +    1390 +316     -#markdown-preview .token.method,
2309     -2278     -    1756 +    1391 +317     -#markdown-preview .token.method-variable {
2310     -2279     -    1757 +    1392 +318     -  color: var(--syntax-function, #82aaff) !important;
2311     -2280     -    1758 +    1393 +319     -  font-weight: 600;
2312     -2281     -    1759 +    1394 +320     -}
2313     -2282     -    1760 +    1395 +321     -
2314     -2283     -    1761 +    1396 +322     -#markdown-preview .token.comment {
2315     -2284     -    1762 +    1397 +323     -  color: var(--syntax-comment, #7f85a3) !important;
2316     -2285     -    1763 +    1398 +324     -}
2317     -2286     -    1764 +    1399 +325     -
2318     -2287     -    1765 +    1400 +326     -#markdown-preview .token.operator {
2319     -2288     -    1766 +    1401 +327     -  color: var(--syntax-operator, #89ddff) !important;
2320     -2289     -    1767 +    1402 +328     -}
2321     -2290     -    1768 +    1403 +329     -
2322     -2291     -    1769 +    1404 +330     -#markdown-preview .token.punctuation {
2323     -2292     -    1770 +    1405 +331     -  color: var(--syntax-punctuation, #89ddff) !important;
2324     -2293     -    1771 +    1406 +    311 +/* Group 2: Neutral tokens (inherit or subtle) */
2325     -2294     -    1772 +    1407 +    312 +#markdown-preview .token.doctype,
2326     -2295     -    1773 +    1408 +    313 +#markdown-preview .token.punctuation,
2327     -2296     -    1774 +    1409 +    314 +#markdown-preview .token.entity {
2328     -2297     -    1775 +    1410 +    315 +  color: var(--syntax-punctuation, #64748b);
2329     -2298     -    1776 +    1411 +332 316  }
2330     -2299     -    1777 +    1412 +333 317  
2331     -2300     -    1778 +    1413 +    318 +/* Group 3: Orange hue - Class names, constants, numbers, booleans, atrules */
2332     -2301     -    1779 +    1414 +    319 +#markdown-preview .token.attr-name,
2333     -2302     -    1780 +    1415 +334 320  #markdown-preview .token.class-name,
2334     -2303     -    1781 +    1416 +335     -#markdown-preview .token.type-class-name {
2335     -2304     -    1782 +    1417 +336     -  color: var(--syntax-keyword, #ffcb6b) !important;
2336     -2305     -    1783 +    1418 +    321 +#markdown-preview .token.boolean,
2337     -2306     -    1784 +    1419 +    322 +#markdown-preview .token.constant,
2338     -2307     -    1785 +    1420 +    323 +#markdown-preview .token.number,
2339     -2308     -    1786 +    1421 +    324 +#markdown-preview .token.atrule {
2340     -2309     -    1787 +    1422 +    325 +  color: var(--syntax-class-name, #f97316);
2341     -2310     -    1788 +    1423 +337 326    font-weight: 600;
2342     -2311     -    1789 +    1424 +338 327  }
2343     -2312     -    1790 +    1425 +339 328  
2344     -2313     -    1791 +    1426 +340     -/* Variables and Parameters - NEW */
2345     -2314     -    1792 +    1427 +341     -#markdown-preview .token.parameter,
2346     -2315     -    1793 +    1428 +342     -#markdown-preview .token.variable,
2347     -2316     -    1794 +    1429 +343     -#markdown-preview .token.plain {
2348     -2317     -    1795 +    1430 +344     -  color: var(--syntax-variable, var(--text-primary)) !important;
2349     -2318     -    1796 +    1431 +345     -  font-weight: 500;
2350     -2319     -    1797 +    1432 +    329 +/* Group 4: Purple hue - Keywords (distinct from class names!) */
2351     -2320     -    1798 +    1433 +    330 +#markdown-preview .token.keyword {
2352     -2321     -    1799 +    1434 +    331 +  color: var(--syntax-keyword, #a855f7);
2353     -2322     -    1800 +    1435 +    332 +  font-weight: 700;
2354     -2323     -    1801 +    1436 +346 333  }
2355     -2324     -    1802 +    1437 +347 334  
2356     -2325     -    1803 +    1438 +348     -/* Properties and Namespaces - NEW */
2357     -2326     -    1804 +    1439 +    335 +/* Group 5: Red hue - Properties, tags, symbols, deleted, important */
2358     -2327     -    1805 +    1440 +349 336  #markdown-preview .token.property,
2359     -2328     -    1806 +    1441 +350     -#markdown-preview .token.property-access {
2360     -2329     -    1807 +    1442 +351     -  color: var(--syntax-property, var(--syntax-function)) !important;
2361     -2330     -    1808 +    1443 +    337 +#markdown-preview .token.tag,
2362     -2331     -    1809 +    1444 +    338 +#markdown-preview .token.symbol,
2363     -2332     -    1810 +    1445 +    339 +#markdown-preview .token.deleted,
2364     -2333     -    1811 +    1446 +    340 +#markdown-preview .token.important {
2365     -2334     -    1812 +    1447 +    341 +  color: var(--syntax-property, #ef4444);
2366     -2335     -    1813 +    1448 +    342 +  font-weight: 600;
2367     -2336     -    1814 +    1449 +352 343  }
2368     -2337     -    1815 +    1450 +353 344  
2369     -2338     -    1816 +    1451 +    345 +/* Group 6: Green hue - Strings, chars, builtins, inserted, regex, selectors */
2370     -2339     -    1817 +    1452 +    346 +#markdown-preview .token.selector,
2371     -2340     -    1818 +    1453 +    347 +#markdown-preview .token.string,
2372     -2341     -    1819 +    1454 +    348 +#markdown-preview .token.char,
2373     -2342     -    1820 +    1455 +    349 +#markdown-preview .token.builtin,
2374     -2343     -    1821 +    1456 +    350 +#markdown-preview .token.inserted,
2375     -2344     -    1822 +    1457 +    351 +#markdown-preview .token.regex,
2376     -2345     -    1823 +    1458 +    352 +#markdown-preview .token.attr-value {
2377     -2346     -    1824 +    1459 +    353 +  color: var(--syntax-string, #10b981);
2378     -2347     -    1825 +    1460 +    354 +}
2379     -2348     -    1826 +    1461 +    355 +
2380     -2349     -    1827 +    1462 +    356 +/* Nested attr-value punctuation (quotes) */
2381     -2350     -    1828 +    1463 +    357 +#markdown-preview .token.attr-value > .token.punctuation {
2382     -2351     -    1829 +    1464 +    358 +  color: var(--syntax-string, #10b981);
2383     -2352     -    1830 +    1465 +    359 +}
2384     -2353     -    1831 +    1466 +    360 +
2385     -2354     -    1832 +    1467 +    361 +/* Group 7: Blue hue - Variables, operators, functions */
2386     -2355     -    1833 +    1468 +    362 +#markdown-preview .token.variable,
2387     -2356     -    1834 +    1469 +    363 +#markdown-preview .token.operator,
2388     -2357     -    1835 +    1470 +    364 +#markdown-preview .token.function {
2389     -2358     -    1836 +    1471 +    365 +  color: var(--syntax-function, #3b82f6);
2390     -2359     -    1837 +    1472 +    366 +  font-weight: 600;
2391     -2360     -    1838 +    1473 +    367 +}
2392     -2361     -    1839 +    1474 +    368 +
2393     -2362     -    1840 +    1475 +    369 +/* Group 8: Cyan hue - URLs */
2394     -2363     -    1841 +    1476 +    370 +#markdown-preview .token.url {
2395     -2364     -    1842 +    1477 +    371 +  color: var(--syntax-url, #14b8a6);
2396     -2365     -    1843 +    1478 +    372 +}
2397     -2366     -    1844 +    1479 +    373 +
2398     -2367     -    1845 +    1480 +    374 +/* ==================== LANGUAGE-SPECIFIC OVERRIDES ==================== */
2399     -2368     -    1846 +    1481 +    375 +
2400     -2369     -    1847 +    1482 +    376 +/* JavaScript overrides */
2401     -2370     -    1848 +    1483 +    377 +#markdown-preview .language-javascript .token.operator {
2402     -2371     -    1849 +    1484 +    378 +  color: var(--syntax-keyword, #a855f7);
2403     -2372     -    1850 +    1485 +    379 +}
2404     -2373     -    1851 +    1486 +    380 +
2405     -2374     -    1852 +    1487 +    381 +/* CSS overrides */
2406     -2375     -    1853 +    1488 +    382 +#markdown-preview .language-css .token.selector {
2407     -2376     -    1854 +    1489 +    383 +  color: var(--syntax-property, #ef4444);
2408     -2377     -    1855 +    1490 +    384 +}
2409     -2378     -    1856 +    1491 +    385 +
2410     -2379     -    1857 +    1492 +    386 +#markdown-preview .language-css .token.property {
2411     -2380     -    1858 +    1493 +    387 +  color: var(--text-primary);
2412     -2381     -    1859 +    1494 +    388 +}
2413     -2382     -    1860 +    1495 +    389 +
2414     -2383     -    1861 +    1496 +    390 +/* JSON overrides */
2415     -2384     -    1862 +    1497 +    391 +#markdown-preview .language-json .token.operator {
2416     -2385     -    1863 +    1498 +    392 +  color: var(--syntax-punctuation, #64748b);
2417     -2386     -    1864 +    1499 +    393 +}
2418     -2387     -    1865 +    1500 +    394 +
2419     -2388     -    1866 +    1501 +    395 +#markdown-preview .language-json .token.null.keyword {
2420     -2389     -    1867 +    1502 +    396 +  color: var(--syntax-number, #fb923c);
2421     -2390     -    1868 +    1503 +    397 +}
2422     -2391     -    1869 +    1504 +    398 +
2423     -2392     -    1870 +    1505 +    399 +/* ==================== VISUAL ENHANCEMENTS ==================== */
2424     -2393     -    1871 +    1506 +    400 +
2425     -2394     -    1872 +    1507 +    401 +/* Bold/italic styling */
2426     -2395     -    1873 +    1508 +    402 +#markdown-preview .token.bold {
2427     -2396     -    1874 +    1509 +    403 +  font-weight: bold;
2428     -2397     -    1875 +    1510 +    404 +}
2429     -2398     -    1876 +    1511 +    405 +
2430     -2399     -    1877 +    1512 +    406 +#markdown-preview .token.italic {
2431     -2400     -    1878 +    1513 +    407 +  font-style: italic;
2432     -2401     -    1879 +    1514 +    408 +}
2433     -2402     -    1880 +    1515 +    409 +
2434     -2403     -    1881 +    1516 +    410 +/* Namespace opacity */
2435     -2404     -    1882 +    1517 +354 411  #markdown-preview .token.namespace {
2436     -2405     -    1883 +    1518 +355     -  color: var(--syntax-namespace, var(--syntax-keyword)) !important;
2437     -2406     -    1884 +    1519 +356     -  font-weight: 500;
2438     -2407     -    1885 +    1520 +357     -}
2439     -2408     -    1886 +    1521 +358     -
2440     -2409     -    1887 +    1522 +359     -#markdown-preview .token.builtin {
2441     -2410     -    1888 +    1523 +360     -  color: var(--syntax-builtin, var(--syntax-function)) !important;
2442     -2411     -    1889 +    1524 +361     -  font-weight: 500;
2443     -2412     -    1890 +    1525 +    412 +  opacity: 0.8;
2444     -2413     -    1891 +    1526 +362 413  }
2445     -2414     -    1892 +    1527 +363 414  
2446     -2415     -    1893 +    1528 +364 415  #markdown-preview blockquote {
2447     -2416     -    1894 +    1529 +365 416  
2448     -2417     -    1895 +    1530 +
2449     -2418     -    1896 +    1531 +```
2450     -2419     -    1897 +    1532 +
2451     -2420     -    1898 +    1533 +
2452     -2421     -    1899 +    1534 +### üìÑ `themes/default-dark.css`
2453     -2422     -    1900 +    1535 +
2454     -2423     -    1901 +    1536 +**Type:** Stylesheet üé®
2455     -2424     -    1902 +    1537 +
2456     -2425     -    1903 +    1538 +```diff
2457     -2426     -    1904 +    1539 +@@ -26,24 +26,184 @@
2458     -2427     -    1905 +    1540 + 26  26    --code-block-bg: #0d1117;
2459     -2428     -    1906 +    1541 + 27  27    --code-border: #30363d;
2460     -2429     -    1907 +    1542 + 28  28  
2461     -2430     -    1908 +    1543 + 29     -  /* Syntax Highlighting */
2462     -2431     -    1909 +    1544 + 30     -  --syntax-keyword: #ff7b72;
2463     -2432     -    1910 +    1545 + 31     -  --syntax-string: #a5e844;
2464     -2433     -    1911 +    1546 + 32     -  --syntax-number: #79c0ff;
2465     -2434     -    1912 +    1547 + 33     -  --syntax-function: #d2a8ff;
2466     -2435     -    1913 +    1548 + 34     -  --syntax-comment: #8b949e;
2467     -2436     -    1914 +    1549 + 35     -  --syntax-operator: #ff7b72;
2468     -2437     -    1915 +    1550 + 36     -  --syntax-punctuation: #7d8590;
2469     -2438     -    1916 +    1551 +     29 +  /* Syntax Highlighting - Production-Grade Token Colors (One Dark Architecture) */
2470     -2439     -    1917 +    1552 + 37  30  
2471     -2440     -    1918 +    1553 + 38     -  /* Additional Token Types */
2472     -2441     -    1919 +    1554 + 39     -  --syntax-variable: #79c0ff; /* Variables - blue (distinct from text #e6edf3) */
2473     -2442     -    1920 +    1555 + 40     -  --syntax-property: #d2a8ff; /* Properties - purple */
2474     -2443     -    1921 +    1556 + 41     -  --syntax-namespace: #ff7b72; /* Namespaces - red */
2475     -2444     -    1922 +    1557 + 42     -  --syntax-builtin: #d2a8ff; /* Builtins - purple */
2476     -2445     -    1923 +    1558 +     31 +  /* Core hue-1: Cyan - URLs */
2477     -2446     -    1924 +    1559 +     32 +  --syntax-url: #56d4dd; /* Cyan for URLs */
2478     -2447     -    1925 +    1560 +     33 +
2479     -2448     -    1926 +    1561 +     34 +  /* Core hue-2: Blue - Functions, variables */
2480     -2449     -    1927 +    1562 +     35 +  --syntax-function: #d2a8ff; /* Purple for functions */
2481     -2450     -    1928 +    1563 +     36 +  --syntax-variable: #79c0ff; /* Bright blue for variables */
2482     -2451     -    1929 +    1564 +     37 +
2483     -2452     -    1930 +    1565 +     38 +  /* Core hue-3: Red - Keywords */
2484     -2453     -    1931 +    1566 +     39 +  --syntax-keyword: #ff7b72; /* Coral red for keywords (final, sealed, class) */
2485     -2454     -    1932 +    1567 +     40 +
2486     -2455     -    1933 +    1568 +     41 +  /* Core hue-4: Green - Strings, builtins */
2487     -2456     -    1934 +    1569 +     42 +  --syntax-string: #a5d6ff; /* Light blue-green for strings */
2488     -2457     -    1935 +    1570 +     43 +  --syntax-builtin: #7ee787; /* Vibrant green for builtins (String, List) */
2489     -2458     -    1936 +    1571 +     44 +  --syntax-char: #a5d6ff; /* Same as strings */
2490     -2459     -    1937 +    1572 +     45 +  --syntax-regex: #a5d6ff; /* Same as strings */
2491     -2460     -    1938 +    1573 +     46 +  --syntax-inserted: #7ee787; /* For diff */
2492     -2461     -    1939 +    1574 +     47 +
2493     -2462     -    1940 +    1575 +     48 +  /* Core hue-5: Orange - Properties, tags */
2494     -2463     -    1941 +    1576 +     49 +  --syntax-property: #ffa657; /* Orange for properties */
2495     -2464     -    1942 +    1577 +     50 +  --syntax-tag: #ff7b72; /* Coral for tags */
2496     -2465     -    1943 +    1578 +     51 +  --syntax-deleted: #ff7b72; /* For diff */
2497     -2466     -    1944 +    1579 +     52 +  --syntax-important: #ffa657; /* For !important */
2498     -2467     -    1945 +    1580 +     53 +
2499     -2468     -    1946 +    1581 +     54 +  /* Core hue-6: Yellow - Class names, constants, numbers */
2500     -2469     -    1947 +    1582 +     55 +  --syntax-class-name: #ffa657; /* Orange for class names (Rectangle, Shape) */
2501     -2470     -    1948 +    1583 +     56 +  --syntax-number: #79c0ff; /* Blue for numbers */
2502     -2471     -    1949 +    1584 +     57 +  --syntax-constant: #79c0ff; /* Blue for constants */
2503     -2472     -    1950 +    1585 +     58 +  --syntax-boolean: #79c0ff; /* Same as numbers */
2504     -2473     -    1951 +    1586 +     59 +  --syntax-atrule: #d2a8ff; /* Purple for CSS @ rules */
2505     -2474     -    1952 +    1587 +     60 +
2506     -2475     -    1953 +    1588 +     61 +  /* Neutral colors */
2507     -2476     -    1954 +    1589 +     62 +  --syntax-comment: #8b949e; /* Gray for comments */
2508     -2477     -    1955 +    1590 +     63 +  --syntax-punctuation: #7d8590; /* Muted gray for punctuation */
2509     -2478     -    1956 +    1591 +     64 +  --syntax-operator: #ff7b72; /* Coral for operators */
2510     -2479     -    1957 +    1592 +     65 +
2511     -2480     -    1958 +    1593 +     66 +  /* Markup specific */
2512     -2481     -    1959 +    1594 +     67 +  --syntax-attr-name: #ffa657; /* Orange like class-name */
2513     -2482     -    1960 +    1595 +     68 +  --syntax-attr-value: #a5d6ff; /* Light blue like strings */
2514     -2483     -    1961 +    1596 +     69 +  --syntax-namespace: #d2a8ff; /* Purple */
2515     -2484     -    1962 +    1597 +     70 +  --syntax-entity: #7d8590; /* Neutral */
2516     -2485     -    1963 +    1598 +     71 +  --syntax-selector: #ffa657; /* Orange like properties */
2517     -2486     -    1964 +    1599 + 43  72  
2518     -2487     -    1965 +    1600 + 44  73    --blockquote-border: #bc8cff;
2519     -2488     -    1966 +    1601 + 45  74    --blockquote-bg: #161b22;
2520     -2489     -    1967 +    1602 + 46  75  
2521     -2490     -    1968 +    1603 + 47  76    --table-header-bg: #21262d;
2522     -2491     -    1969 +    1604 + 48  77    --table-border: #30363d;
2523     -2492     -    1970 +    1605 +     78 +
2524     -2493     -    1971 +    1606 +     79 +  /* === MERMAID COMPREHENSIVE CONFIGURATION === */
2525     -2494     -    1972 +    1607 +     80 +
2526     -2495     -    1973 +    1608 +     81 +  /* Core Global */
2527     -2496     -    1974 +    1609 +     82 +  --mermaid-background: #0d1117;
2528     -2497     -    1975 +    1610 +     83 +  --mermaid-text-color: #e6edf3;
2529     -2498     -    1976 +    1611 +     84 +  --mermaid-line-color: #58a6ff;
2530     -2499     -    1977 +    1612 +     85 +  --mermaid-main-bkg: #1c2128;
2531     -2500     -    1978 +    1613 +     86 +
2532     -2501     -    1979 +    1614 +     87 +  /* Primary Set - Main nodes/boxes */
2533     -2502     -    1980 +    1615 +     88 +  --mermaid-primary-color: #1c2128;
2534     -2503     -    1981 +    1616 +     89 +  --mermaid-primary-text-color: #e6edf3;
2535     -2504     -    1982 +    1617 +     90 +  --mermaid-primary-border-color: #58a6ff;
2536     -2505     -    1983 +    1618 +     91 +
2537     -2506     -    1984 +    1619 +     92 +  /* Secondary Set - Clusters/subgraphs */
2538     -2507     -    1985 +    1620 +     93 +  --mermaid-secondary-color: #161b22;
2539     -2508     -    1986 +    1621 +     94 +  --mermaid-secondary-text-color: #e6edf3;
2540     -2509     -    1987 +    1622 +     95 +  --mermaid-secondary-border-color: #bc8cff;
2541     -2510     -    1988 +    1623 +     96 +
2542     -2511     -    1989 +    1624 +     97 +  /* Tertiary Set - Edge labels */
2543     -2512     -    1990 +    1625 +     98 +  --mermaid-tertiary-color: #0d1117;
2544     -2513     -    1991 +    1626 +     99 +  --mermaid-tertiary-text-color: #e6edf3;
2545     -2514     -    1992 +    1627 +    100 +  --mermaid-tertiary-border-color: #ff7b72;
2546     -2515     -    1993 +    1628 +    101 +
2547     -2516     -    1994 +    1629 +    102 +  /* Flowchart */
2548     -2517     -    1995 +    1630 +    103 +  --mermaid-node-border: #58a6ff;
2549     -2518     -    1996 +    1631 +    104 +  --mermaid-cluster-bkg: #161b22;
2550     -2519     -    1997 +    1632 +    105 +  --mermaid-cluster-border: #bc8cff;
2551     -2520     -    1998 +    1633 +    106 +  --mermaid-default-link-color: #58a6ff;
2552     -2521     -    1999 +    1634 +    107 +  --mermaid-title-color: #e6edf3;
2553     -2522     -    2000 +    1635 +    108 +  --mermaid-edge-label-background: #0d1117;
2554     -2523     -    2001 +    1636 +    109 +  --mermaid-node-text-color: #e6edf3;
2555     -2524     -    2002 +    1637 +    110 +
2556     -2525     -    2003 +    1638 +    111 +  /* Sequence Diagram */
2557     -2526     -    2004 +    1639 +    112 +  --mermaid-actor-bkg: #1c2128;
2558     -2527     -    2005 +    1640 +    113 +  --mermaid-actor-border: #58a6ff;
2559     -2528     -    2006 +    1641 +    114 +  --mermaid-actor-text-color: #e6edf3;
2560     -2529     -    2007 +    1642 +    115 +  --mermaid-actor-line-color: #58a6ff;
2561     -2530     -    2008 +    1643 +    116 +  --mermaid-signal-color: #bc8cff;
2562     -2531     -    2009 +    1644 +    117 +  --mermaid-signal-text-color: #e6edf3;
2563     -2532     -    2010 +    1645 +    118 +  --mermaid-label-box-bkg-color: #1c2128;
2564     -2533     -    2011 +    1646 +    119 +  --mermaid-label-box-border-color: #58a6ff;
2565     -2534     -    2012 +    1647 +    120 +  --mermaid-label-text-color: #e6edf3;
2566     -2535     -    2013 +    1648 +    121 +  --mermaid-loop-text-color: #e6edf3;
2567     -2536     -    2014 +    1649 +    122 +  --mermaid-activation-border-color: #bc8cff;
2568     -2537     -    2015 +    1650 +    123 +  --mermaid-activation-bkg-color: #161b22;
2569     -2538     -    2016 +    1651 +    124 +  --mermaid-sequence-number-color: #e6edf3;
2570     -2539     -    2017 +    1652 +    125 +
2571     -2540     -    2018 +    1653 +    126 +  /* Pie Chart - 12 distinct slice colors + text */
2572     -2541     -    2019 +    1654 +    127 +  --mermaid-pie1: #58a6ff;
2573     -2542     -    2020 +    1655 +    128 +  --mermaid-pie2: #bc8cff;
2574     -2543     -    2021 +    1656 +    129 +  --mermaid-pie3: #ff7b72;
2575     -2544     -    2022 +    1657 +    130 +  --mermaid-pie4: #3fb950;
2576     -2545     -    2023 +    1658 +    131 +  --mermaid-pie5: #ffa657;
2577     -2546     -    2024 +    1659 +    132 +  --mermaid-pie6: #d2a8ff;
2578     -2547     -    2025 +    1660 +    133 +  --mermaid-pie7: #56d4dd;
2579     -2548     -    2026 +    1661 +    134 +  --mermaid-pie8: #7ee787;
2580     -2549     -    2027 +    1662 +    135 +  --mermaid-pie9: #a5d6ff;
2581     -2550     -    2028 +    1663 +    136 +  --mermaid-pie10: #79c0ff;
2582     -2551     -    2029 +    1664 +    137 +  --mermaid-pie11: #d2a8ff;
2583     -2552     -    2030 +    1665 +    138 +  --mermaid-pie12: #ffa657;
2584     -2553     -    2031 +    1666 +    139 +  --mermaid-pie-title-text-color: #e6edf3;
2585     -2554     -    2032 +    1667 +    140 +  --mermaid-pie-section-text-color: #0d1117; /* Dark on vibrant slices */
2586     -2555     -    2033 +    1668 +    141 +  --mermaid-pie-legend-text-color: #e6edf3;
2587     -2556     -    2034 +    1669 +    142 +  --mermaid-pie-stroke-color: #58a6ff;
2588     -2557     -    2035 +    1670 +    143 +  --mermaid-pie-outer-stroke-color: #58a6ff;
2589     -2558     -    2036 +    1671 +    144 +
2590     -2559     -    2037 +    1672 +    145 +  /* State Diagram */
2591     -2560     -    2038 +    1673 +    146 +  --mermaid-label-color: #e6edf3;
2592     -2561     -    2039 +    1674 +    147 +  --mermaid-alt-background: #161b22;
2593     -2562     -    2040 +    1675 +    148 +
2594     -2563     -    2041 +    1676 +    149 +  /* Class Diagram */
2595     -2564     -    2042 +    1677 +    150 +  --mermaid-class-text: #e6edf3;
2596     -2565     -    2043 +    1678 +    151 +
2597     -2566     -    2044 +    1679 +    152 +  /* User Journey - 8 distinct colors */
2598     -2567     -    2045 +    1680 +    153 +  --mermaid-fill-type0: #58a6ff;
2599     -2568     -    2046 +    1681 +    154 +  --mermaid-fill-type1: #bc8cff;
2600     -2569     -    2047 +    1682 +    155 +  --mermaid-fill-type2: #ff7b72;
2601     -2570     -    2048 +    1683 +    156 +  --mermaid-fill-type3: #3fb950;
2602     -2571     -    2049 +    1684 +    157 +  --mermaid-fill-type4: #ffa657;
2603     -2572     -    2050 +    1685 +    158 +  --mermaid-fill-type5: #d2a8ff;
2604     -2573     -    2051 +    1686 +    159 +  --mermaid-fill-type6: #56d4dd;
2605     -2574     -    2052 +    1687 +    160 +  --mermaid-fill-type7: #7ee787;
2606     -2575     -    2053 +    1688 +    161 +
2607     -2576     -    2054 +    1689 +    162 +  /* Gantt Chart */
2608     -2577     -    2055 +    1690 +    163 +  --mermaid-section-bkg-color: #1c2128;
2609     -2578     -    2056 +    1691 +    164 +  --mermaid-alt-section-bkg-color: #161b22;
2610     -2579     -    2057 +    1692 +    165 +  --mermaid-section-bkg-color2: #1c2128;
2611     -2580     -    2058 +    1693 +    166 +  --mermaid-task-text-color: #e6edf3;
2612     -2581     -    2059 +    1694 +    167 +  --mermaid-task-text-light-color: #e6edf3;
2613     -2582     -    2060 +    1695 +    168 +  --mermaid-task-text-outside-color: #e6edf3;
2614     -2583     -    2061 +    1696 +    169 +  --mermaid-task-text-clickable-color: #58a6ff;
2615     -2584     -    2062 +    1697 +    170 +  --mermaid-active-task-bkg-color: #58a6ff;
2616     -2585     -    2063 +    1698 +    171 +  --mermaid-active-task-border-color: #58a6ff;
2617     -2586     -    2064 +    1699 +    172 +  --mermaid-done-task-bkg-color: #3fb950;
2618     -2587     -    2065 +    1700 +    173 +  --mermaid-done-task-border-color: #3fb950;
2619     -2588     -    2066 +    1701 +    174 +  --mermaid-crit-border-color: #ff7b72;
2620     -2589     -    2067 +    1702 +    175 +  --mermaid-crit-bkg-color: #ff7b72;
2621     -2590     -    2068 +    1703 +    176 +  --mermaid-today-line-color: #ff7b72;
2622     -2591     -    2069 +    1704 +    177 +  --mermaid-grid-color: #30363d;
2623     -2592     -    2070 +    1705 +    178 +  --mermaid-section-text-color: #e6edf3;
2624     -2593     -    2071 +    1706 +    179 +  --mermaid-task-border-color: #58a6ff;
2625     -2594     -    2072 +    1707 +    180 +
2626     -2595     -    2073 +    1708 +    181 +  /* ER Diagram */
2627     -2596     -    2074 +    1709 +    182 +  --mermaid-attribute-background-color-odd: #161b22;
2628     -2597     -    2075 +    1710 +    183 +  --mermaid-attribute-background-color-even: #0d1117;
2629     -2598     -    2076 +    1711 +    184 +  --mermaid-relationship-label-background: #0d1117;
2630     -2599     -    2077 +    1712 +    185 +  --mermaid-relationship-label-color: #e6edf3;
2631     -2600     -    2078 +    1713 +    186 +  --mermaid-entity-background: #1c2128;
2632     -2601     -    2079 +    1714 +    187 +  --mermaid-entity-border-color: #58a6ff;
2633     -2602     -    2080 +    1715 +    188 +
2634     -2603     -    2081 +    1716 +    189 +  /* Git Graph */
2635     -2604     -    2082 +    1717 +    190 +  --mermaid-git0: #58a6ff;
2636     -2605     -    2083 +    1718 +    191 +  --mermaid-git1: #bc8cff;
2637     -2606     -    2084 +    1719 +    192 +  --mermaid-git2: #ff7b72;
2638     -2607     -    2085 +    1720 +    193 +  --mermaid-git3: #3fb950;
2639     -2608     -    2086 +    1721 +    194 +  --mermaid-git4: #ffa657;
2640     -2609     -    2087 +    1722 +    195 +  --mermaid-git5: #d2a8ff;
2641     -2610     -    2088 +    1723 +    196 +  --mermaid-git6: #56d4dd;
2642     -2611     -    2089 +    1724 +    197 +  --mermaid-git7: #7ee787;
2643     -2612     -    2090 +    1725 +    198 +  --mermaid-git-inv0: #0d1117;
2644     -2613     -    2091 +    1726 +    199 +  --mermaid-git-branch-label0: #e6edf3;
2645     -2614     -    2092 +    1727 +    200 +  --mermaid-git-branch-label1: #e6edf3;
2646     -2615     -    2093 +    1728 +    201 +  --mermaid-git-branch-label2: #e6edf3;
2647     -2616     -    2094 +    1729 +    202 +  --mermaid-git-branch-label3: #e6edf3;
2648     -2617     -    2095 +    1730 +    203 +  --mermaid-git-branch-label4: #e6edf3;
2649     -2618     -    2096 +    1731 +    204 +  --mermaid-commit-label-color: #e6edf3;
2650     -2619     -    2097 +    1732 +    205 +  --mermaid-commit-label-background: #0d1117;
2651     -2620     -    2098 +    1733 +    206 +  --mermaid-tag-label-color: #e6edf3;
2652     -2621     -    2099 +    1734 +    207 +  --mermaid-tag-label-background: #1c2128;
2653     -2622     -    2100 +    1735 +    208 +  --mermaid-tag-label-border: #58a6ff;
2654     -2623     -    2101 +    1736 + 49 209  }
2655     -2624     -    2102 +    1737 + 50 210  
2656     -2625     -    2103 +    1738 +
2657     -2626     -    2104 +    1739 +```
2658     -2627     -    2105 +    1740 +
2659     -2628     -    2106 +    1741 +
2660     -2629     -    2107 +    1742 +### üìÑ `themes/default-light.css`
2661     -2630     -    2108 +    1743 +
2662     -2631     -    2109 +    1744 +**Type:** Stylesheet üé®
2663     -2632     -    2110 +    1745 +
2664     -2633     -    2111 +    1746 +```diff
2665     -2634     -    2112 +    1747 +@@ -26,24 +26,184 @@
2666     -2635     -    2113 +    1748 + 26  26    --code-block-bg: #f6f8fa;
2667     -2636     -    2114 +    1749 + 27  27    --code-border: #d0d7de;
2668     -2637     -    2115 +    1750 + 28  28  
2669     -2638     -    2116 +    1751 + 29     -  /* Syntax Highlighting - Comprehensive Token Colors */
2670     -2639     -    2117 +    1752 + 30     -  --syntax-keyword: #cf222e;
2671     -2640     -    2118 +    1753 + 31     -  --syntax-string: #1a7f37;
2672     -2641     -    2119 +    1754 + 32     -  --syntax-number: #0550ae;
2673     -2642     -    2120 +    1755 + 33     -  --syntax-function: #8250df;
2674     -2643     -    2121 +    1756 + 34     -  --syntax-comment: #636c76;
2675     -2644     -    2122 +    1757 + 35     -  --syntax-operator: #cf222e;
2676     -2645     -    2123 +    1758 + 36     -  --syntax-punctuation: #636c76;
2677     -2646     -    2124 +    1759 +     29 +  /* Syntax Highlighting - Production-Grade Token Colors (One Dark Architecture) */
2678     -2647     -    2125 +    1760 + 37  30  
2679     -2648     -    2126 +    1761 + 38     -  /* Additional Token Types for Full Customization */
2680     -2649     -    2127 +    1762 + 39     -  --syntax-variable: #0550ae; /* Variables, parameters */
2681     -2650     -    2128 +    1763 + 40     -  --syntax-property: #1a7f37; /* Properties, attributes */
2682     -2651     -    2129 +    1764 + 41     -  --syntax-namespace: #cf222e; /* Namespaces */
2683     -2652     -    2130 +    1765 + 42     -  --syntax-builtin: #8250df; /* Built-in functions */
2684     -2653     -    2131 +    1766 +     31 +  /* Core hue-1: Cyan - URLs */
2685     -2654     -    2132 +    1767 +     32 +  --syntax-url: #0969da; /* GitHub blue for URLs */
2686     -2655     -    2133 +    1768 +     33 +
2687     -2656     -    2134 +    1769 +     34 +  /* Core hue-2: Blue - Functions, variables */
2688     -2657     -    2135 +    1770 +     35 +  --syntax-function: #8250df; /* Purple-blue for functions */
2689     -2658     -    2136 +    1771 +     36 +  --syntax-variable: #0550ae; /* Deep blue for variables */
2690     -2659     -    2137 +    1772 +     37 +
2691     -2660     -    2138 +    1773 +     38 +  /* Core hue-3: Red - Keywords */
2692     -2661     -    2139 +    1774 +     39 +  --syntax-keyword: #cf222e; /* GitHub red for keywords (final, sealed, class) */
2693     -2662     -    2140 +    1775 +     40 +
2694     -2663     -    2141 +    1776 +     41 +  /* Core hue-4: Green - Strings, builtins */
2695     -2664     -    2142 +    1777 +     42 +  --syntax-string: #1a7f37; /* GitHub green for strings */
2696     -2665     -    2143 +    1778 +     43 +  --syntax-builtin: #116329; /* Darker green for builtins (String, List) */
2697     -2666     -    2144 +    1779 +     44 +  --syntax-char: #1a7f37; /* Same as strings */
2698     -2667     -    2145 +    1780 +     45 +  --syntax-regex: #1a7f37; /* Same as strings */
2699     -2668     -    2146 +    1781 +     46 +  --syntax-inserted: #1a7f37; /* For diff */
2700     -2669     -    2147 +    1782 +     47 +
2701     -2670     -    2148 +    1783 +     48 +  /* Core hue-5: Orange/Brown - Properties, tags */
2702     -2671     -    2149 +    1784 +     49 +  --syntax-property: #bc4c00; /* Orange-brown for properties */
2703     -2672     -    2150 +    1785 +     50 +  --syntax-tag: #cf222e; /* Red for tags */
2704     -2673     -    2151 +    1786 +     51 +  --syntax-deleted: #cf222e; /* For diff */
2705     -2674     -    2152 +    1787 +     52 +  --syntax-important: #bc4c00; /* For !important */
2706     -2675     -    2153 +    1788 +     53 +
2707     -2676     -    2154 +    1789 +     54 +  /* Core hue-6: Blue - Class names, constants, numbers */
2708     -2677     -    2155 +    1790 +     55 +  --syntax-class-name: #0969da; /* Bright blue for class names (Rectangle, Shape) */
2709     -2678     -    2156 +    1791 +     56 +  --syntax-number: #0550ae; /* Deep blue for numbers */
2710     -2679     -    2157 +    1792 +     57 +  --syntax-constant: #0969da; /* Bright blue for constants */
2711     -2680     -    2158 +    1793 +     58 +  --syntax-boolean: #0550ae; /* Same as numbers */
2712     -2681     -    2159 +    1794 +     59 +  --syntax-atrule: #8250df; /* Purple for CSS @ rules */
2713     -2682     -    2160 +    1795 +     60 +
2714     -2683     -    2161 +    1796 +     61 +  /* Neutral colors */
2715     -2684     -    2162 +    1797 +     62 +  --syntax-comment: #636c76; /* GitHub gray for comments */
2716     -2685     -    2163 +    1798 +     63 +  --syntax-punctuation: #636c76; /* Gray for punctuation */
2717     -2686     -    2164 +    1799 +     64 +  --syntax-operator: #cf222e; /* Red for operators */
2718     -2687     -    2165 +    1800 +     65 +
2719     -2688     -    2166 +    1801 +     66 +  /* Markup specific */
2720     -2689     -    2167 +    1802 +     67 +  --syntax-attr-name: #0969da; /* Blue like class-name */
2721     -2690     -    2168 +    1803 +     68 +  --syntax-attr-value: #1a7f37; /* Green like strings */
2722     -2691     -    2169 +    1804 +     69 +  --syntax-namespace: #8250df; /* Purple */
2723     -2692     -    2170 +    1805 +     70 +  --syntax-entity: #636c76; /* Neutral */
2724     -2693     -    2171 +    1806 +     71 +  --syntax-selector: #bc4c00; /* Orange like properties */
2725     -2694     -    2172 +    1807 + 43  72  
2726     -2695     -    2173 +    1808 + 44  73    --blockquote-border: #0969da;
2727     -2696     -    2174 +    1809 + 45  74    --blockquote-bg: #ddf4ff;
2728     -2697     -    2175 +    1810 + 46  75  
2729     -2698     -    2176 +    1811 + 47  76    --table-header-bg: #f6f8fa;
2730     -2699     -    2177 +    1812 + 48  77    --table-border: #d0d7de;
2731     -2700     -    2178 +    1813 +     78 +
2732     -2701     -    2179 +    1814 +     79 +  /* === MERMAID COMPREHENSIVE CONFIGURATION === */
2733     -2702     -    2180 +    1815 +     80 +
2734     -2703     -    2181 +    1816 +     81 +  /* Core Global */
2735     -2704     -    2182 +    1817 +     82 +  --mermaid-background: #ffffff;
2736     -2705     -    2183 +    1818 +     83 +  --mermaid-text-color: #1f2328;
2737     -2706     -    2184 +    1819 +     84 +  --mermaid-line-color: #0969da;
2738     -2707     -    2185 +    1820 +     85 +  --mermaid-main-bkg: #eaeef2;
2739     -2708     -    2186 +    1821 +     86 +
2740     -2709     -    2187 +    1822 +     87 +  /* Primary Set */
2741     -2710     -    2188 +    1823 +     88 +  --mermaid-primary-color: #eaeef2;
2742     -2711     -    2189 +    1824 +     89 +  --mermaid-primary-text-color: #1f2328;
2743     -2712     -    2190 +    1825 +     90 +  --mermaid-primary-border-color: #0969da;
2744     -2713     -    2191 +    1826 +     91 +
2745     -2714     -    2192 +    1827 +     92 +  /* Secondary Set */
2746     -2715     -    2193 +    1828 +     93 +  --mermaid-secondary-color: #f6f8fa;
2747     -2716     -    2194 +    1829 +     94 +  --mermaid-secondary-text-color: #1f2328;
2748     -2717     -    2195 +    1830 +     95 +  --mermaid-secondary-border-color: #8250df;
2749     -2718     -    2196 +    1831 +     96 +
2750     -2719     -    2197 +    1832 +     97 +  /* Tertiary Set */
2751     -2720     -    2198 +    1833 +     98 +  --mermaid-tertiary-color: #ffffff;
2752     -2721     -    2199 +    1834 +     99 +  --mermaid-tertiary-text-color: #1f2328;
2753     -2722     -    2200 +    1835 +    100 +  --mermaid-tertiary-border-color: #cf222e;
2754     -2723     -    2201 +    1836 +    101 +
2755     -2724     -    2202 +    1837 +    102 +  /* Flowchart */
2756     -2725     -    2203 +    1838 +    103 +  --mermaid-node-border: #0969da;
2757     -2726     -    2204 +    1839 +    104 +  --mermaid-cluster-bkg: #f6f8fa;
2758     -2727     -    2205 +    1840 +    105 +  --mermaid-cluster-border: #8250df;
2759     -2728     -    2206 +    1841 +    106 +  --mermaid-default-link-color: #0969da;
2760     -2729     -    2207 +    1842 +    107 +  --mermaid-title-color: #1f2328;
2761     -2730     -    2208 +    1843 +    108 +  --mermaid-edge-label-background: #ffffff;
2762     -2731     -    2209 +    1844 +    109 +  --mermaid-node-text-color: #1f2328;
2763     -2732     -    2210 +    1845 +    110 +
2764     -2733     -    2211 +    1846 +    111 +  /* Sequence Diagram */
2765     -2734     -    2212 +    1847 +    112 +  --mermaid-actor-bkg: #eaeef2;
2766     -2735     -    2213 +    1848 +    113 +  --mermaid-actor-border: #0969da;
2767     -2736     -    2214 +    1849 +    114 +  --mermaid-actor-text-color: #1f2328;
2768     -2737     -    2215 +    1850 +    115 +  --mermaid-actor-line-color: #0969da;
2769     -2738     -    2216 +    1851 +    116 +  --mermaid-signal-color: #8250df;
2770     -2739     -    2217 +    1852 +    117 +  --mermaid-signal-text-color: #1f2328;
2771     -2740     -    2218 +    1853 +    118 +  --mermaid-label-box-bkg-color: #eaeef2;
2772     -2741     -    2219 +    1854 +    119 +  --mermaid-label-box-border-color: #0969da;
2773     -2742     -    2220 +    1855 +    120 +  --mermaid-label-text-color: #1f2328;
2774     -2743     -    2221 +    1856 +    121 +  --mermaid-loop-text-color: #1f2328;
2775     -2744     -    2222 +    1857 +    122 +  --mermaid-activation-border-color: #8250df;
2776     -2745     -    2223 +    1858 +    123 +  --mermaid-activation-bkg-color: #f6f8fa;
2777     -2746     -    2224 +    1859 +    124 +  --mermaid-sequence-number-color: #1f2328;
2778     -2747     -    2225 +    1860 +    125 +
2779     -2748     -    2226 +    1861 +    126 +  /* Pie Chart */
2780     -2749     -    2227 +    1862 +    127 +  --mermaid-pie1: #0969da;
2781     -2750     -    2228 +    1863 +    128 +  --mermaid-pie2: #8250df;
2782     -2751     -    2229 +    1864 +    129 +  --mermaid-pie3: #cf222e;
2783     -2752     -    2230 +    1865 +    130 +  --mermaid-pie4: #1a7f37;
2784     -2753     -    2231 +    1866 +    131 +  --mermaid-pie5: #bc4c00;
2785     -2754     -    2232 +    1867 +    132 +  --mermaid-pie6: #0550ae;
2786     -2755     -    2233 +    1868 +    133 +  --mermaid-pie7: #116329;
2787     -2756     -    2234 +    1869 +    134 +  --mermaid-pie8: #0969da;
2788     -2757     -    2235 +    1870 +    135 +  --mermaid-pie9: #8250df;
2789     -2758     -    2236 +    1871 +    136 +  --mermaid-pie10: #cf222e;
2790     -2759     -    2237 +    1872 +    137 +  --mermaid-pie11: #1a7f37;
2791     -2760     -    2238 +    1873 +    138 +  --mermaid-pie12: #bc4c00;
2792     -2761     -    2239 +    1874 +    139 +  --mermaid-pie-title-text-color: #1f2328;
2793     -2762     -    2240 +    1875 +    140 +  --mermaid-pie-section-text-color: #ffffff; /* White on vibrant slices */
2794     -2763     -    2241 +    1876 +    141 +  --mermaid-pie-legend-text-color: #1f2328;
2795     -2764     -    2242 +    1877 +    142 +  --mermaid-pie-stroke-color: #0969da;
2796     -2765     -    2243 +    1878 +    143 +  --mermaid-pie-outer-stroke-color: #0969da;
2797     -2766     -    2244 +    1879 +    144 +
2798     -2767     -    2245 +    1880 +    145 +  /* State Diagram */
2799     -2768     -    2246 +    1881 +    146 +  --mermaid-label-color: #1f2328;
2800     -2769     -    2247 +    1882 +    147 +  --mermaid-alt-background: #f6f8fa;
2801     -2770     -    2248 +    1883 +    148 +
2802     -2771     -    2249 +    1884 +    149 +  /* Class Diagram */
2803     -2772     -    2250 +    1885 +    150 +  --mermaid-class-text: #1f2328;
2804     -2773     -    2251 +    1886 +    151 +
2805     -2774     -    2252 +    1887 +    152 +  /* User Journey */
2806     -2775     -    2253 +    1888 +    153 +  --mermaid-fill-type0: #0969da;
2807     -2776     -    2254 +    1889 +    154 +  --mermaid-fill-type1: #8250df;
2808     -2777     -    2255 +    1890 +    155 +  --mermaid-fill-type2: #cf222e;
2809     -2778     -    2256 +    1891 +    156 +  --mermaid-fill-type3: #1a7f37;
2810     -2779     -    2257 +    1892 +    157 +  --mermaid-fill-type4: #bc4c00;
2811     -2780     -    2258 +    1893 +    158 +  --mermaid-fill-type5: #0550ae;
2812     -2781     -    2259 +    1894 +    159 +  --mermaid-fill-type6: #116329;
2813     -2782     -    2260 +    1895 +    160 +  --mermaid-fill-type7: #0969da;
2814     -2783     -    2261 +    1896 +    161 +
2815     -2784     -    2262 +    1897 +    162 +  /* Gantt Chart */
2816     -2785     -    2263 +    1898 +    163 +  --mermaid-section-bkg-color: #eaeef2;
2817     -2786     -    2264 +    1899 +    164 +  --mermaid-alt-section-bkg-color: #f6f8fa;
2818     -2787     -    2265 +    1900 +    165 +  --mermaid-section-bkg-color2: #eaeef2;
2819     -2788     -    2266 +    1901 +    166 +  --mermaid-task-text-color: #1f2328;
2820     -2789     -    2267 +    1902 +    167 +  --mermaid-task-text-light-color: #1f2328;
2821     -2790     -    2268 +    1903 +    168 +  --mermaid-task-text-outside-color: #1f2328;
2822     -2791     -    2269 +    1904 +    169 +  --mermaid-task-text-clickable-color: #0969da;
2823     -2792     -    2270 +    1905 +    170 +  --mermaid-active-task-bkg-color: #0969da;
2824     -2793     -    2271 +    1906 +    171 +  --mermaid-active-task-border-color: #0969da;
2825     -2794     -    2272 +    1907 +    172 +  --mermaid-done-task-bkg-color: #1a7f37;
2826     -2795     -    2273 +    1908 +    173 +  --mermaid-done-task-border-color: #1a7f37;
2827     -2796     -    2274 +    1909 +    174 +  --mermaid-crit-border-color: #cf222e;
2828     -2797     -    2275 +    1910 +    175 +  --mermaid-crit-bkg-color: #cf222e;
2829     -2798     -    2276 +    1911 +    176 +  --mermaid-today-line-color: #cf222e;
2830     -2799     -    2277 +    1912 +    177 +  --mermaid-grid-color: #d0d7de;
2831     -2800     -    2278 +    1913 +    178 +  --mermaid-section-text-color: #1f2328;
2832     -2801     -    2279 +    1914 +    179 +  --mermaid-task-border-color: #0969da;
2833     -2802     -    2280 +    1915 +    180 +
2834     -2803     -    2281 +    1916 +    181 +  /* ER Diagram */
2835     -2804     -    2282 +    1917 +    182 +  --mermaid-attribute-background-color-odd: #f6f8fa;
2836     -2805     -    2283 +    1918 +    183 +  --mermaid-attribute-background-color-even: #ffffff;
2837     -2806     -    2284 +    1919 +    184 +  --mermaid-relationship-label-background: #ffffff;
2838     -2807     -    2285 +    1920 +    185 +  --mermaid-relationship-label-color: #1f2328;
2839     -2808     -    2286 +    1921 +    186 +  --mermaid-entity-background: #eaeef2;
2840     -2809     -    2287 +    1922 +    187 +  --mermaid-entity-border-color: #0969da;
2841     -2810     -    2288 +    1923 +    188 +
2842     -2811     -    2289 +    1924 +    189 +  /* Git Graph */
2843     -2812     -    2290 +    1925 +    190 +  --mermaid-git0: #0969da;
2844     -2813     -    2291 +    1926 +    191 +  --mermaid-git1: #8250df;
2845     -2814     -    2292 +    1927 +    192 +  --mermaid-git2: #cf222e;
2846     -2815     -    2293 +    1928 +    193 +  --mermaid-git3: #1a7f37;
2847     -2816     -    2294 +    1929 +    194 +  --mermaid-git4: #bc4c00;
2848     -2817     -    2295 +    1930 +    195 +  --mermaid-git5: #0550ae;
2849     -2818     -    2296 +    1931 +    196 +  --mermaid-git6: #116329;
2850     -2819     -    2297 +    1932 +    197 +  --mermaid-git7: #0969da;
2851     -2820     -    2298 +    1933 +    198 +  --mermaid-git-inv0: #ffffff;
2852     -2821     -    2299 +    1934 +    199 +  --mermaid-git-branch-label0: #1f2328;
2853     -2822     -    2300 +    1935 +    200 +  --mermaid-git-branch-label1: #1f2328;
2854     -2823     -    2301 +    1936 +    201 +  --mermaid-git-branch-label2: #1f2328;
2855     -2824     -    2302 +    1937 +    202 +  --mermaid-git-branch-label3: #1f2328;
2856     -2825     -    2303 +    1938 +    203 +  --mermaid-git-branch-label4: #1f2328;
2857     -2826     -    2304 +    1939 +    204 +  --mermaid-commit-label-color: #1f2328;
2858     -2827     -    2305 +    1940 +    205 +  --mermaid-commit-label-background: #ffffff;
2859     -2828     -    2306 +    1941 +    206 +  --mermaid-tag-label-color: #1f2328;
2860     -2829     -    2307 +    1942 +    207 +  --mermaid-tag-label-background: #eaeef2;
2861     -2830     -    2308 +    1943 +    208 +  --mermaid-tag-label-border: #0969da;
2862     -2831     -    2309 +    1944 + 49 209  }
2863     -2832     -    2310 +    1945 + 50 210  
2864     -2833     -    2311 +    1946 +
2865     -2834     -    2312 +    1947 +```
2866     -2835     -    2313 +    1948 +
2867     -2836     -    2314 +    1949 +
2868     -2837     -    2315 +    1950 +### üìÑ `themes/forest-dark.css`
2869     -2838     -    2316 +    1951 +
2870     -2839     -    2317 +    1952 +**Type:** Stylesheet üé®
2871     -2840     -    2318 +    1953 +
2872     -2841     -    2319 +    1954 +```diff
2873     -2842     -    2320 +    1955 +@@ -1,11 +1,11 @@
2874     -2843     -    2321 +    1956 +  1     -/* Forest Dark Theme */
2875     -2844     -    2322 +    1957 +      1 +/* Forest Dark Theme - Deep Jungle Aesthetic */
2876     -2845     -    2323 +    1958 +  2   2  :root {
2877     -2846     -    2324 +    1959 +  3     -  --bg-primary: #0f1c0a;
2878     -2847     -    2325 +    1960 +  4     -  --bg-secondary: #1a2817;
2879     -2848     -    2326 +    1961 +  5     -  --bg-tertiary: #2d4a2b;
2880     -2849     -    2327 +    1962 +  6     -  --text-primary: #d9f99d;
2881     -2850     -    2328 +    1963 +  7     -  --text-secondary: #a3e635;
2882     -2851     -    2329 +    1964 +  8     -  --border-color: #3f6212;
2883     -2852     -    2330 +    1965 +      3 +  --bg-primary: #0a1408; /* Deep forest green with blue undertones */
2884     -2853     -    2331 +    1966 +      4 +  --bg-secondary: #132118; /* Darker moss green */
2885     -2854     -    2332 +    1967 +      5 +  --bg-tertiary: #1e3a29; /* Rich forest green */
2886     -2855     -    2333 +    1968 +      6 +  --text-primary: #d9f99d; /* Bright lime (firefly glow) */
2887     -2856     -    2334 +    1969 +      7 +  --text-secondary: #a3e635; /* Vibrant lime */
2888     -2857     -    2335 +    1970 +      8 +  --border-color: #2d5a3d; /* Forest green border */
2889     -2858     -    2336 +    1971 +  9   9  
2890     -2859     -    2337 +    1972 + 10  10    --h1-color: #84cc16;
2891     -2860     -    2338 +    1973 + 11  11    --h2-color: #a3e635;
2892     -2861     -    2339 +    1974 +@@ -17,31 +17,144 @@
2893     -2862     -    2340 +    1975 + 17  17    --link-color: #84cc16;
2894     -2863     -    2341 +    1976 + 18  18    --link-hover: #a3e635;
2895     -2864     -    2342 +    1977 + 19  19  
2896     -2865     -    2343 +    1978 + 20     -  /* Code Colors */
2897     -2866     -    2344 +    1979 + 21     -  --code-bg: #1a2817;
2898     -2867     -    2345 +    1980 +     20 +  /* Code Colors - Organic forest glow */
2899     -2868     -    2346 +    1981 +     21 +  --code-bg: rgba(132, 204, 22, 0.12); /* Lime-tinted background */
2900     -2869     -    2347 +    1982 + 22  22    --code-text: #a3e635;
2901     -2870     -    2348 +    1983 + 23     -  --code-block-bg: #0f1c0a;
2902     -2871     -    2349 +    1984 + 24     -  --code-border: #3f6212;
2903     -2872     -    2350 +    1985 +     23 +  --code-block-bg: #0d1a11; /* Deep forest with blue-green tint */
2904     -2873     -    2351 +    1986 +     24 +  --code-border: rgba(163, 230, 53, 0.3); /* Lime glow border */
2905     -2874     -    2352 +    1987 + 25  25  
2906     -2875     -    2353 +    1988 + 26     -  /* Syntax Highlighting - Comprehensive Token Colors */
2907     -2876     -    2354 +    1989 + 27     -  --syntax-keyword: #84cc16;
2908     -2877     -    2355 +    1990 + 28     -  --syntax-string: #a3e635;
2909     -2878     -    2356 +    1991 + 29     -  --syntax-number: #bef264;
2910     -2879     -    2357 +    1992 + 30     -  --syntax-function: #4ade80;
2911     -2880     -    2358 +    1993 + 31     -  --syntax-comment: #737373;
2912     -2881     -    2359 +    1994 + 32     -  --syntax-operator: #22c55e;
2913     -2882     -    2360 +    1995 + 33     -  --syntax-punctuation: #a3a3a3;
2914     -2883     -    2361 +    1996 +     26 +  /* Syntax Highlighting - Production-Grade Token Colors (One Dark Architecture) */
2915     -2884     -    2362 +    1997 + 34  27  
2916     -2885     -    2363 +    1998 + 35     -  /* Additional Token Types */
2917     -2886     -    2364 +    1999 + 36     -  --syntax-variable: #bef264; /* Variables - bright lime (distinct from text #d9f99d) */
2918     -2887     -    2365 +    2000 + 37     -  --syntax-property: #4ade80; /* Properties - green */
2919     -2888     -    2366 +    2001 + 38     -  --syntax-namespace: #84cc16; /* Namespaces - lime */
2920     -2889     -    2367 +    2002 + 39     -  --syntax-builtin: #22c55e; /* Builtins - green */
2921     -2890     -    2368 +    2003 +     28 +  /* Core hue-1: Teal - URLs */
2922     -2891     -    2369 +    2004 +     29 +  --syntax-url: #5eead4; /* Bright teal for URLs */
2923     -2892     -    2370 +    2005 +     30 +
2924     -2893     -    2371 +    2006 +     31 +  /* Core hue-2: Green - Functions, variables */
2925     -2894     -    2372 +    2007 +     32 +  --syntax-function: #4ade80; /* Bright green for functions */
2926     -2895     -    2373 +    2008 +     33 +  --syntax-variable: #22c55e; /* Medium green for variables */
2927     -2896     -    2374 +    2009 +     34 +
2928     -2897     -    2375 +    2010 +     35 +  /* Core hue-3: Yellow - Keywords */
2929     -2898     -    2376 +    2011 +     36 +  --syntax-keyword: #fbbf24; /* Golden yellow for keywords (final, sealed, class) */
2930     -2899     -    2377 +    2012 +     37 +
2931     -2900     -    2378 +    2013 +     38 +  /* Core hue-4: Lime - Strings, builtins */
2932     -2901     -    2379 +    2014 +     39 +  --syntax-string: #a3e635; /* Bright lime for strings */
2933     -2902     -    2380 +    2015 +     40 +  --syntax-builtin: #84cc16; /* Lime for builtins (String, List) */
2934     -2903     -    2381 +    2016 +     41 +  --syntax-char: #a3e635; /* Same as strings */
2935     -2904     -    2382 +    2017 +     42 +  --syntax-regex: #a3e635; /* Same as strings */
2936     -2905     -    2383 +    2018 +     43 +  --syntax-inserted: #84cc16; /* For diff */
2937     -2906     -    2384 +    2019 +     44 +
2938     -2907     -    2385 +    2020 +     45 +  /* Core hue-5: Orange/Amber - Properties, tags */
2939     -2908     -    2386 +    2021 +     46 +  --syntax-property: #fb923c; /* Orange for properties */
2940     -2909     -    2387 +    2022 +     47 +  --syntax-tag: #f97316; /* Burnt orange for tags */
2941     -2910     -    2388 +    2023 +     48 +  --syntax-deleted: #f87171; /* Coral for diff */
2942     -2911     -    2389 +    2024 +     49 +  --syntax-important: #fb923c; /* Orange for !important */
2943     -2912     -    2390 +    2025 +     50 +
2944     -2913     -    2391 +    2026 +     51 +  /* Core hue-6: Yellow-green - Class names, constants, numbers */
2945     -2914     -    2392 +    2027 +     52 +  --syntax-class-name: #bef264; /* Bright yellow-green for class names (Rectangle, Shape) */
2946     -2915     -    2393 +    2028 +     53 +  --syntax-number: #fde047; /* Bright yellow for numbers */
2947     -2916     -    2394 +    2029 +     54 +  --syntax-constant: #84cc16; /* Lime for constants */
2948     -2917     -    2395 +    2030 +     55 +  --syntax-boolean: #fde047; /* Same as numbers */
2949     -2918     -    2396 +    2031 +     56 +  --syntax-atrule: #a3e635; /* Lime for CSS @ rules */
2950     -2919     -    2397 +    2032 +     57 +
2951     -2920     -    2398 +    2033 +     58 +  /* Neutral colors */
2952     -2921     -    2399 +    2034 +     59 +  --syntax-comment: #737373; /* Gray for comments */
2953     -2922     -    2400 +    2035 +     60 +  --syntax-punctuation: #a3a3a3; /* Light gray for punctuation */
2954     -2923     -    2401 +    2036 +     61 +  --syntax-operator: #22c55e; /* Green for operators */
2955     -2924     -    2402 +    2037 +     62 +
2956     -2925     -    2403 +    2038 +     63 +  /* Markup specific */
2957     -2926     -    2404 +    2039 +     64 +  --syntax-attr-name: #bef264; /* Yellow-green like class-name */
2958     -2927     -    2405 +    2040 +     65 +  --syntax-attr-value: #a3e635; /* Lime like strings */
2959     -2928     -    2406 +    2041 +     66 +  --syntax-namespace: #fbbf24; /* Yellow like keywords */
2960     -2929     -    2407 +    2042 +     67 +  --syntax-entity: #a3a3a3; /* Neutral */
2961     -2930     -    2408 +    2043 +     68 +  --syntax-selector: #fb923c; /* Orange like properties */
2962     -2931     -    2409 +    2044 + 40  69  
2963     -2932     -    2410 +    2045 + 41  70    --blockquote-border: #84cc16;
2964     -2933     -    2411 +    2046 + 42     -  --blockquote-bg: #1a2817;
2965     -2934     -    2412 +    2047 +     71 +  --blockquote-bg: rgba(132, 204, 22, 0.08); /* Lime-tinted blockquote */
2966     -2935     -    2413 +    2048 + 43  72    --bold-color: #fbbf24;
2967     -2936     -    2414 +    2049 + 44  73    --italic-color: #84cc16;
2968     -2937     -    2415 +    2050 + 45     -  --table-header-bg: #2d4a2b;
2969     -2938     -    2416 +    2051 + 46     -  --table-border: #3f6212;
2970     -2939     -    2417 +    2052 +     74 +  --table-header-bg: rgba(74, 222, 128, 0.12); /* Green-tinted table header */
2971     -2940     -    2418 +    2053 +     75 +  --table-border: rgba(45, 90, 61, 0.4); /* Forest-tinted border */
2972     -2941     -    2419 +    2054 +     76 +
2973     -2942     -    2420 +    2055 +     77 +  /* === MERMAID COMPREHENSIVE CONFIGURATION === */
2974     -2943     -    2421 +    2056 +     78 +  /* Complete control over ALL diagram elements */
2975     -2944     -    2422 +    2057 +     79 +
2976     -2945     -    2423 +    2058 +     80 +  /* Core Global */
2977     -2946     -    2424 +    2059 +     81 +  --mermaid-background: #0a1408;
2978     -2947     -    2425 +    2060 +     82 +  --mermaid-text-color: #d9f99d;
2979     -2948     -    2426 +    2061 +     83 +  --mermaid-line-color: #a3e635;
2980     -2949     -    2427 +    2062 +     84 +  --mermaid-main-bkg: #2d5a3d;
2981     -2950     -    2428 +    2063 +     85 +
2982     -2951     -    2429 +    2064 +     86 +  /* Primary Set - Main nodes/boxes */
2983     -2952     -    2430 +    2065 +     87 +  --mermaid-primary-color: #2d5a3d;
2984     -2953     -    2431 +    2066 +     88 +  --mermaid-primary-text-color: #d9f99d;
2985     -2954     -    2432 +    2067 +     89 +  --mermaid-primary-border-color: #84cc16;
2986     -2955     -    2433 +    2068 +     90 +
2987     -2956     -    2434 +    2069 +     91 +  /* Secondary Set - Clusters/subgraphs */
2988     -2957     -    2435 +    2070 +     92 +  --mermaid-secondary-color: #1e3a29;
2989     -2958     -    2436 +    2071 +     93 +  --mermaid-secondary-text-color: #d9f99d;
2990     -2959     -    2437 +    2072 +     94 +  --mermaid-secondary-border-color: #a3e635;
2991     -2960     -    2438 +    2073 +     95 +
2992     -2961     -    2439 +    2074 +     96 +  /* Tertiary Set - Edge labels */
2993     -2962     -    2440 +    2075 +     97 +  --mermaid-tertiary-color: #0a1408;
2994     -2963     -    2441 +    2076 +     98 +  --mermaid-tertiary-text-color: #d9f99d;
2995     -2964     -    2442 +    2077 +     99 +  --mermaid-tertiary-border-color: #bef264;
2996     -2965     -    2443 +    2078 +    100 +
2997     -2966     -    2444 +    2079 +    101 +  /* Flowchart */
2998     -2967     -    2445 +    2080 +    102 +  --mermaid-node-border: #84cc16;
2999     -2968     -    2446 +    2081 +    103 +  --mermaid-cluster-bkg: #1e3a29;
3000     -2969     -    2447 +    2082 +    104 +  --mermaid-cluster-border: #a3e635;
3001     -2970     -    2448 +    2083 +    105 +  --mermaid-default-link-color: #a3e635;
3002     -2971     -    2449 +    2084 +    106 +  --mermaid-title-color: #d9f99d;
3003     -2972     -    2450 +    2085 +    107 +  --mermaid-edge-label-background: #0a1408;
3004     -2973     -    2451 +    2086 +    108 +  --mermaid-node-text-color: #d9f99d;
3005     -2974     -    2452 +    2087 +    109 +
3006     -2975     -    2453 +    2088 +    110 +  /* Sequence Diagram */
3007     -2976     -    2454 +    2089 +    111 +  --mermaid-actor-bkg: #2d5a3d;
3008     -2977     -    2455 +    2090 +    112 +  --mermaid-actor-border: #84cc16;
3009     -2978     -    2456 +    2091 +    113 +  --mermaid-actor-text-color: #d9f99d;
3010     -2979     -    2457 +    2092 +    114 +  --mermaid-actor-line-color: #84cc16;
3011     -2980     -    2458 +    2093 +    115 +  --mermaid-signal-color: #a3e635;
3012     -2981     -    2459 +    2094 +    116 +  --mermaid-signal-text-color: #d9f99d;
3013     -2982     -    2460 +    2095 +    117 +  --mermaid-label-box-bkg-color: #2d5a3d;
3014     -2983     -    2461 +    2096 +    118 +  --mermaid-label-box-border-color: #84cc16;
3015     -2984     -    2462 +    2097 +    119 +  --mermaid-label-text-color: #d9f99d;
3016     -2985     -    2463 +    2098 +    120 +  --mermaid-loop-text-color: #d9f99d;
3017     -2986     -    2464 +    2099 +    121 +  --mermaid-activation-border-color: #a3e635;
3018     -2987     -    2465 +    2100 +    122 +  --mermaid-activation-bkg-color: #1e3a29;
3019     -2988     -    2466 +    2101 +    123 +  --mermaid-sequence-number-color: #d9f99d;
3020     -2989     -    2467 +    2102 +    124 +
3021     -2990     -    2468 +    2103 +    125 +  /* Pie Chart - 12 distinct slice colors + text colors */
3022     -2991     -    2469 +    2104 +    126 +  --mermaid-pie1: #4ade80;
3023     -2992     -    2470 +    2105 +    127 +  --mermaid-pie2: #fbbf24;
3024     -2993     -    2471 +    2106 +    128 +  --mermaid-pie3: #fb923c;
3025     -2994     -    2472 +    2107 +    129 +  --mermaid-pie4: #5eead4;
3026     -2995     -    2473 +    2108 +    130 +  --mermaid-pie5: #a3e635;
3027     -2996     -    2474 +    2109 +    131 +  --mermaid-pie6: #22c55e;
3028     -2997     -    2475 +    2110 +    132 +  --mermaid-pie7: #84cc16;
3029     -2998     -    2476 +    2111 +    133 +  --mermaid-pie8: #fde047;
3030     -2999     -    2477 +    2112 +    134 +  --mermaid-pie9: #4ade80;
3031     -3000     -    2478 +    2113 +    135 +  --mermaid-pie10: #fbbf24;
3032     -3001     -    2479 +    2114 +    136 +  --mermaid-pie11: #fb923c;
3033     -3002     -    2480 +    2115 +    137 +  --mermaid-pie12: #5eead4;
3034     -3003     -    2481 +    2116 +    138 +  --mermaid-pie-title-text-color: #d9f99d;
3035     -3004     -    2482 +    2117 +    139 +  --mermaid-pie-section-text-color: #0a1408; /* Dark on vibrant slices */
3036     -3005     -    2483 +    2118 +    140 +  --mermaid-pie-legend-text-color: #d9f99d;
3037     -3006     -    2484 +    2119 +    141 +  --mermaid-pie-stroke-color: #84cc16;
3038     -3007     -    2485 +    2120 +    142 +  --mermaid-pie-outer-stroke-color: #84cc16;
3039     -3008     -    2486 +    2121 +    143 +
3040     -3009     -    2487 +    2122 +    144 +  /* State Diagram */
3041     -3010     -    2488 +    2123 +    145 +  --mermaid-label-color: #d9f99d;
3042     -3011     -    2489 +    2124 +    146 +  --mermaid-alt-background: #1e3a29;
3043     -3012     -    2490 +    2125 +    147 +
3044     -3013     -    2491 +    2126 +    148 +  /* Class Diagram */
3045     -3014     -    2492 +    2127 +    149 +  --mermaid-class-text: #d9f99d;
3046     -3015     -    2493 +    2128 +    150 +
3047     -3016     -    2494 +    2129 +    151 +  /* User Journey - 8 distinct colors */
3048     -3017     -    2495 +    2130 +    152 +  --mermaid-fill-type0: #4ade80;
3049     -3018     -    2496 +    2131 +    153 +  --mermaid-fill-type1: #fbbf24;
3050     -3019     -    2497 +    2132 +    154 +  --mermaid-fill-type2: #fb923c;
3051     -3020     -    2498 +    2133 +    155 +  --mermaid-fill-type3: #5eead4;
3052     -3021     -    2499 +    2134 +    156 +  --mermaid-fill-type4: #a3e635;
3053     -3022     -    2500 +    2135 +    157 +  --mermaid-fill-type5: #22c55e;
3054     -3023     -    2501 +    2136 +    158 +  --mermaid-fill-type6: #84cc16;
3055     -3024     -    2502 +    2137 +    159 +  --mermaid-fill-type7: #fde047;
3056     -3025     -    2503 +    2138 + 47 160  }
3057     -3026     -    2504 +    2139 + 48 161  
3058     -3027     -    2505 +    2140 +
3059     -3028     -    2506 +    2141 +```
3060     -3029     -    2507 +    2142 +
3061     -3030     -    2508 +    2143 +
3062     -3031     -    2509 +    2144 +### üìÑ `themes/forest-light.css`
3063     -3032     -    2510 +    2145 +
3064     -3033     -    2511 +    2146 +**Type:** Stylesheet üé®
3065     -3034     -    2512 +    2147 +
3066     -3035     -    2513 +    2148 +```diff
3067     -3036     -    2514 +    2149 +@@ -23,20 +23,49 @@
3068     -3037     -    2515 +    2150 + 23  23    --code-block-bg: #ecfccb; /* Light green background */
3069     -3038     -    2516 +    2151 + 24  24    --code-border: #bef264;
3070     -3039     -    2517 +    2152 + 25  25  
3071     -3040     -    2518 +    2153 + 26     -  /* Syntax Highlighting - Comprehensive Token Colors */
3072     -3041     -    2519 +    2154 + 27     -  --syntax-keyword: #15803d;
3073     -3042     -    2520 +    2155 + 28     -  --syntax-string: #16a34a;
3074     -3043     -    2521 +    2156 + 29     -  --syntax-number: #84cc16;
3075     -3044     -    2522 +    2157 + 30     -  --syntax-function: #22c55e;
3076     -3045     -    2523 +    2158 + 31     -  --syntax-comment: #737373;
3077     -3046     -    2524 +    2159 + 32     -  --syntax-operator: #3f6212;
3078     -3047     -    2525 +    2160 + 33     -  --syntax-punctuation: #525252;
3079     -3048     -    2526 +    2161 +     26 +  /* Syntax Highlighting - Production-Grade Token Colors (One Dark Architecture) */
3080     -3049     -    2527 +    2162 + 34  27  
3081     -3050     -    2528 +    2163 + 35     -  /* Additional Token Types for Full Customization */
3082     -3051     -    2529 +    2164 + 36     -  --syntax-variable: #15803d; /* Variables - forest green */
3083     -3052     -    2530 +    2165 + 37     -  --syntax-property: #16a34a; /* Properties - bright green */
3084     -3053     -    2531 +    2166 + 38     -  --syntax-namespace: #84cc16; /* Namespaces - lime */
3085     -3054     -    2532 +    2167 + 39     -  --syntax-builtin: #22c55e; /* Builtins - bright green */
3086     -3055     -    2533 +    2168 +     28 +  /* Core hue-1: Teal - URLs */
3087     -3056     -    2534 +    2169 +     29 +  --syntax-url: #14b8a6; /* Teal for URLs */
3088     -3057     -    2535 +    2170 +     30 +
3089     -3058     -    2536 +    2171 +     31 +  /* Core hue-2: Green - Functions, variables */
3090     -3059     -    2537 +    2172 +     32 +  --syntax-function: #22c55e; /* Bright green for functions */
3091     -3060     -    2538 +    2173 +     33 +  --syntax-variable: #16a34a; /* Forest green for variables */
3092     -3061     -    2539 +    2174 +     34 +
3093     -3062     -    2540 +    2175 +     35 +  /* Core hue-3: Emerald - Keywords */
3094     -3063     -    2541 +    2176 +     36 +  --syntax-keyword: #059669; /* Deep emerald for keywords (final, sealed, class) */
3095     -3064     -    2542 +    2177 +     37 +
3096     -3065     -    2543 +    2178 +     38 +  /* Core hue-4: Lime - Strings, builtins */
3097     -3066     -    2544 +    2179 +     39 +  --syntax-string: #84cc16; /* Lime green for strings */
3098     -3067     -    2545 +    2180 +     40 +  --syntax-builtin: #65a30d; /* Vibrant lime for builtins (String, List) */
3099     -3068     -    2546 +    2181 +     41 +  --syntax-char: #84cc16; /* Same as strings */
3100     -3069     -    2547 +    2182 +     42 +  --syntax-regex: #84cc16; /* Same as strings */
3101     -3070     -    2548 +    2183 +     43 +  --syntax-inserted: #65a30d; /* For diff */
3102     -3071     -    2549 +    2184 +     44 +
3103     -3072     -    2550 +    2185 +     45 +  /* Core hue-5: Amber/Brown - Properties, tags */
3104     -3073     -    2551 +    2186 +     46 +  --syntax-property: #b45309; /* Amber-brown for properties */
3105     -3074     -    2552 +    2187 +     47 +  --syntax-tag: #854d0e; /* Brown for tags */
3106     -3075     -    2553 +    2188 +     48 +  --syntax-deleted: #dc2626; /* Red for diff */
3107     -3076     -    2554 +    2189 +     49 +  --syntax-important: #b45309; /* Amber for !important */
3108     -3077     -    2555 +    2190 +     50 +
3109     -3078     -    2556 +    2191 +     51 +  /* Core hue-6: Yellow/Green - Class names, constants, numbers */
3110     -3079     -    2557 +    2192 +     52 +  --syntax-class-name: #facc15; /* Bright yellow for class names (Rectangle, Shape) */
3111     -3080     -    2558 +    2193 +     53 +  --syntax-number: #eab308; /* Yellow for numbers */
3112     -3081     -    2559 +    2194 +     54 +  --syntax-constant: #15803d; /* Forest green for constants */
3113     -3082     -    2560 +    2195 +     55 +  --syntax-boolean: #eab308; /* Same as numbers */
3114     -3083     -    2561 +    2196 +     56 +  --syntax-atrule: #84cc16; /* Lime for CSS @ rules */
3115     -3084     -    2562 +    2197 +     57 +
3116     -3085     -    2563 +    2198 +     58 +  /* Neutral colors */
3117     -3086     -    2564 +    2199 +     59 +  --syntax-comment: #737373; /* Gray for comments */
3118     -3087     -    2565 +    2200 +     60 +  --syntax-punctuation: #525252; /* Dark gray for punctuation */
3119     -3088     -    2566 +    2201 +     61 +  --syntax-operator: #3f6212; /* Olive for operators */
3120     -3089     -    2567 +    2202 +     62 +
3121     -3090     -    2568 +    2203 +     63 +  /* Markup specific */
3122     -3091     -    2569 +    2204 +     64 +  --syntax-attr-name: #facc15; /* Yellow like class-name */
3123     -3092     -    2570 +    2205 +     65 +  --syntax-attr-value: #84cc16; /* Lime like strings */
3124     -3093     -    2571 +    2206 +     66 +  --syntax-namespace: #059669; /* Emerald like keywords */
3125     -3094     -    2572 +    2207 +     67 +  --syntax-entity: #525252; /* Neutral */
3126     -3095     -    2573 +    2208 +     68 +  --syntax-selector: #b45309; /* Amber like properties */
3127     -3096     -    2574 +    2209 + 40  69  
3128     -3097     -    2575 +    2210 + 41  70    --blockquote-border: #16a34a;
3129     -3098     -    2576 +    2211 + 42  71    --blockquote-bg: #ecfccb;
3130     -3099     -    2577 +    2212 +@@ -44,4 +73,87 @@
3131     -3100     -    2578 +    2213 + 44  73    --italic-color: #15803d;
3132     -3101     -    2579 +    2214 + 45  74    --table-header-bg: #d9f99d;
3133     -3102     -    2580 +    2215 + 46  75    --table-border: #bef264;
3134     -3103     -    2581 +    2216 +     76 +
3135     -3104     -    2582 +    2217 +     77 +  /* === MERMAID COMPREHENSIVE CONFIGURATION === */
3136     -3105     -    2583 +    2218 +     78 +
3137     -3106     -    2584 +    2219 +     79 +  /* Core Global */
3138     -3107     -    2585 +    2220 +     80 +  --mermaid-background: #f7fee7;
3139     -3108     -    2586 +    2221 +     81 +  --mermaid-text-color: #1a2e05;
3140     -3109     -    2587 +    2222 +     82 +  --mermaid-line-color: #16a34a;
3141     -3110     -    2588 +    2223 +     83 +  --mermaid-main-bkg: #d9f99d;
3142     -3111     -    2589 +    2224 +     84 +
3143     -3112     -    2590 +    2225 +     85 +  /* Primary Set */
3144     -3113     -    2591 +    2226 +     86 +  --mermaid-primary-color: #d9f99d;
3145     -3114     -    2592 +    2227 +     87 +  --mermaid-primary-text-color: #1a2e05;
3146     -3115     -    2593 +    2228 +     88 +  --mermaid-primary-border-color: #15803d;
3147     -3116     -    2594 +    2229 +     89 +
3148     -3117     -    2595 +    2230 +     90 +  /* Secondary Set */
3149     -3118     -    2596 +    2231 +     91 +  --mermaid-secondary-color: #ecfccb;
3150     -3119     -    2597 +    2232 +     92 +  --mermaid-secondary-text-color: #1a2e05;
3151     -3120     -    2598 +    2233 +     93 +  --mermaid-secondary-border-color: #16a34a;
3152     -3121     -    2599 +    2234 +     94 +
3153     -3122     -    2600 +    2235 +     95 +  /* Tertiary Set */
3154     -3123     -    2601 +    2236 +     96 +  --mermaid-tertiary-color: #f7fee7;
3155     -3124     -    2602 +    2237 +     97 +  --mermaid-tertiary-text-color: #1a2e05;
3156     -3125     -    2603 +    2238 +     98 +  --mermaid-tertiary-border-color: #22c55e;
3157     -3126     -    2604 +    2239 +     99 +
3158     -3127     -    2605 +    2240 +    100 +  /* Flowchart */
3159     -3128     -    2606 +    2241 +    101 +  --mermaid-node-border: #15803d;
3160     -3129     -    2607 +    2242 +    102 +  --mermaid-cluster-bkg: #ecfccb;
3161     -3130     -    2608 +    2243 +    103 +  --mermaid-cluster-border: #16a34a;
3162     -3131     -    2609 +    2244 +    104 +  --mermaid-default-link-color: #16a34a;
3163     -3132     -    2610 +    2245 +    105 +  --mermaid-title-color: #1a2e05;
3164     -3133     -    2611 +    2246 +    106 +  --mermaid-edge-label-background: #f7fee7;
3165     -3134     -    2612 +    2247 +    107 +  --mermaid-node-text-color: #1a2e05;
3166     -3135     -    2613 +    2248 +    108 +
3167     -3136     -    2614 +    2249 +    109 +  /* Sequence Diagram */
3168     -3137     -    2615 +    2250 +    110 +  --mermaid-actor-bkg: #d9f99d;
3169     -3138     -    2616 +    2251 +    111 +  --mermaid-actor-border: #15803d;
3170     -3139     -    2617 +    2252 +    112 +  --mermaid-actor-text-color: #1a2e05;
3171     -3140     -    2618 +    2253 +    113 +  --mermaid-actor-line-color: #15803d;
3172     -3141     -    2619 +    2254 +    114 +  --mermaid-signal-color: #16a34a;
3173     -3142     -    2620 +    2255 +    115 +  --mermaid-signal-text-color: #1a2e05;
3174     -3143     -    2621 +    2256 +    116 +  --mermaid-label-box-bkg-color: #d9f99d;
3175     -3144     -    2622 +    2257 +    117 +  --mermaid-label-box-border-color: #15803d;
3176     -3145     -    2623 +    2258 +    118 +  --mermaid-label-text-color: #1a2e05;
3177     -3146     -    2624 +    2259 +    119 +  --mermaid-loop-text-color: #1a2e05;
3178     -3147     -    2625 +    2260 +    120 +  --mermaid-activation-border-color: #16a34a;
3179     -3148     -    2626 +    2261 +    121 +  --mermaid-activation-bkg-color: #ecfccb;
3180     -3149     -    2627 +    2262 +    122 +  --mermaid-sequence-number-color: #1a2e05;
3181     -3150     -    2628 +    2263 +    123 +
3182     -3151     -    2629 +    2264 +    124 +  /* Pie Chart */
3183     -3152     -    2630 +    2265 +    125 +  --mermaid-pie1: #15803d;
3184     -3153     -    2631 +    2266 +    126 +  --mermaid-pie2: #16a34a;
3185     -3154     -    2632 +    2267 +    127 +  --mermaid-pie3: #22c55e;
3186     -3155     -    2633 +    2268 +    128 +  --mermaid-pie4: #4ade80;
3187     -3156     -    2634 +    2269 +    129 +  --mermaid-pie5: #84cc16;
3188     -3157     -    2635 +    2270 +    130 +  --mermaid-pie6: #a3e635;
3189     -3158     -    2636 +    2271 +    131 +  --mermaid-pie7: #14b8a6;
3190     -3159     -    2637 +    2272 +    132 +  --mermaid-pie8: #facc15;
3191     -3160     -    2638 +    2273 +    133 +  --mermaid-pie9: #b45309;
3192     -3161     -    2639 +    2274 +    134 +  --mermaid-pie10: #15803d;
3193     -3162     -    2640 +    2275 +    135 +  --mermaid-pie11: #16a34a;
3194     -3163     -    2641 +    2276 +    136 +  --mermaid-pie12: #22c55e;
3195     -3164     -    2642 +    2277 +    137 +  --mermaid-pie-title-text-color: #1a2e05;
3196     -3165     -    2643 +    2278 +    138 +  --mermaid-pie-section-text-color: #f7fee7; /* Light on vibrant slices */
3197     -3166     -    2644 +    2279 +    139 +  --mermaid-pie-legend-text-color: #1a2e05;
3198     -3167     -    2645 +    2280 +    140 +  --mermaid-pie-stroke-color: #15803d;
3199     -3168     -    2646 +    2281 +    141 +  --mermaid-pie-outer-stroke-color: #15803d;
3200     -3169     -    2647 +    2282 +    142 +
3201     -3170     -    2648 +    2283 +    143 +  /* State Diagram */
3202     -3171     -    2649 +    2284 +    144 +  --mermaid-label-color: #1a2e05;
3203     -3172     -    2650 +    2285 +    145 +  --mermaid-alt-background: #ecfccb;
3204     -3173     -    2651 +    2286 +    146 +
3205     -3174     -    2652 +    2287 +    147 +  /* Class Diagram */
3206     -3175     -    2653 +    2288 +    148 +  --mermaid-class-text: #1a2e05;
3207     -3176     -    2654 +    2289 +    149 +
3208     -3177     -    2655 +    2290 +    150 +  /* User Journey */
3209     -3178     -    2656 +    2291 +    151 +  --mermaid-fill-type0: #15803d;
3210     -3179     -    2657 +    2292 +    152 +  --mermaid-fill-type1: #16a34a;
3211     -3180     -    2658 +    2293 +    153 +  --mermaid-fill-type2: #22c55e;
3212     -3181     -    2659 +    2294 +    154 +  --mermaid-fill-type3: #4ade80;
3213     -3182     -    2660 +    2295 +    155 +  --mermaid-fill-type4: #84cc16;
3214     -3183     -    2661 +    2296 +    156 +  --mermaid-fill-type5: #a3e635;
3215     -3184     -    2662 +    2297 +    157 +  --mermaid-fill-type6: #14b8a6;
3216     -3185     -    2663 +    2298 +    158 +  --mermaid-fill-type7: #facc15;
3217     -3186     -    2664 +    2299 + 47 159  }
3218     -3187     -    2665 +    2300 + 48 160  
3219     -3188     -    2666 +    2301 +
3220     -3189     -    2667 +    2302 +```
3221     -3190     -    2668 +    2303 +
3222     -3191     -    2669 +    2304 +
3223     -3192     -    2670 +    2305 +### üìÑ `themes/neon-dark.css`
3224     -3193     -    2671 +    2306 +
3225     -3194     -    2672 +    2307 +**Type:** Stylesheet üé®
3226     -3195     -    2673 +    2308 +
3227     -3196     -    2674 +    2309 +```diff
3228     -3197     -    2675 +    2310 +@@ -1,11 +1,11 @@
3229     -3198     -    2676 +    2311 +  1     -/* Neon Dark Theme */
3230     -3199     -    2677 +    2312 +      1 +/* Neon Dark Theme - Cyberpunk Aesthetic */
3231     -3200     -    2678 +    2313 +  2   2  :root {
3232     -3201     -    2679 +    2314 +  3     -  --bg-primary: #0d0d0d;
3233     -3202     -    2680 +    2315 +  4     -  --bg-secondary: #1a1a1a;
3234     -3203     -    2681 +    2316 +  5     -  --bg-tertiary: #262626;
3235     -3204     -    2682 +    2317 +  6     -  --text-primary: #ffffff;
3236     -3205     -    2683 +    2318 +  7     -  --text-secondary: #a3a3a3;
3237     -3206     -    2684 +    2319 +  8     -  --border-color: #404040;
3238     -3207     -    2685 +    2320 +      3 +  --bg-primary: #0a0e1a; /* Dark blue-purple, not pure black */
3239     -3208     -    2686 +    2321 +      4 +  --bg-secondary: #141827; /* Dark navy with purple tint */
3240     -3209     -    2687 +    2322 +      5 +  --bg-tertiary: #1e2539; /* Lighter navy */
3241     -3210     -    2688 +    2323 +      6 +  --text-primary: #e0e7ff; /* Slightly blue-tinted white */
3242     -3211     -    2689 +    2324 +      7 +  --text-secondary: #a5b4fc; /* Light indigo */
3243     -3212     -    2690 +    2325 +      8 +  --border-color: #4c1d95; /* Purple border for neon feel */
3244     -3213     -    2691 +    2326 +  9   9  
3245     -3214     -    2692 +    2327 + 10  10    --h1-color: #ff006e;
3246     -3215     -    2693 +    2328 + 11  11    --h2-color: #8338ec;
3247     -3216     -    2694 +    2329 +@@ -17,31 +17,143 @@
3248     -3217     -    2695 +    2330 + 17  17    --link-color: #ff006e;
3249     -3218     -    2696 +    2331 + 18  18    --link-hover: #ff1a8c;
3250     -3219     -    2697 +    2332 + 19  19  
3251     -3220     -    2698 +    2333 + 20     -  /* Code Colors */
3252     -3221     -    2699 +    2334 + 21     -  --code-bg: #1a1a1a;
3253     -3222     -    2700 +    2335 +     20 +  /* Code Colors - Neonic with purple glow */
3254     -3223     -    2701 +    2336 +     21 +  --code-bg: rgba(131, 56, 236, 0.15); /* Purple-tinted background */
3255     -3224     -    2702 +    2337 + 22  22    --code-text: #00f5d4;
3256     -3225     -    2703 +    2338 + 23     -  --code-block-bg: #0d0d0d;
3257     -3226     -    2704 +    2339 + 24     -  --code-border: #404040;
3258     -3227     -    2705 +    2340 +     23 +  --code-block-bg: #0f1419; /* Dark blue-black with hint of purple */
3259     -3228     -    2706 +    2341 +     24 +  --code-border: rgba(255, 0, 110, 0.3); /* Pink glow border */
3260     -3229     -    2707 +    2342 + 25  25  
3261     -3230     -    2708 +    2343 + 26     -  /* Syntax Highlighting - Comprehensive Token Colors */
3262     -3231     -    2709 +    2344 + 27     -  --syntax-keyword: #ff006e;
3263     -3232     -    2710 +    2345 + 28     -  --syntax-string: #00f5d4;
3264     -3233     -    2711 +    2346 + 29     -  --syntax-number: #ffbe0b;
3265     -3234     -    2712 +    2347 + 30     -  --syntax-function: #8338ec;
3266     -3235     -    2713 +    2348 + 31     -  --syntax-comment: #737373;
3267     -3236     -    2714 +    2349 + 32     -  --syntax-operator: #ff1a8c;
3268     -3237     -    2715 +    2350 + 33     -  --syntax-punctuation: #a3a3a3;
3269     -3238     -    2716 +    2351 +     26 +  /* Syntax Highlighting - Production-Grade Token Colors (One Dark Architecture) */
3270     -3239     -    2717 +    2352 + 34  27  
3271     -3240     -    2718 +    2353 + 35     -  /* Additional Token Types */
3272     -3241     -    2719 +    2354 + 36     -  --syntax-variable: #3a86ff; /* Variables - bright blue (distinct from text #ffffff) */
3273     -3242     -    2720 +    2355 + 37     -  --syntax-property: #8338ec; /* Properties - purple */
3274     -3243     -    2721 +    2356 + 38     -  --syntax-namespace: #ff006e; /* Namespaces - neon pink */
3275     -3244     -    2722 +    2357 + 39     -  --syntax-builtin: #00f5d4; /* Builtins - cyan */
3276     -3245     -    2723 +    2358 +     28 +  /* Core hue-1: Cyan - URLs */
3277     -3246     -    2724 +    2359 +     29 +  --syntax-url: #00f5d4; /* Electric cyan for URLs */
3278     -3247     -    2725 +    2360 +     30 +
3279     -3248     -    2726 +    2361 +     31 +  /* Core hue-2: Purple/Blue - Functions, variables */
3280     -3249     -    2727 +    2362 +     32 +  --syntax-function: #8338ec; /* Neon purple for functions */
3281     -3250     -    2728 +    2363 +     33 +  --syntax-variable: #3a86ff; /* Electric blue for variables */
3282     -3251     -    2729 +    2364 +     34 +
3283     -3252     -    2730 +    2365 +     35 +  /* Core hue-3: Pink - Keywords */
3284     -3253     -    2731 +    2366 +     36 +  --syntax-keyword: #ff006e; /* Hot pink for keywords (final, sealed, class) */
3285     -3254     -    2732 +    2367 +     37 +
3286     -3255     -    2733 +    2368 +     38 +  /* Core hue-4: Cyan/Teal - Strings, builtins */
3287     -3256     -    2734 +    2369 +     39 +  --syntax-string: #00f5d4; /* Electric cyan for strings */
3288     -3257     -    2735 +    2370 +     40 +  --syntax-builtin: #00d4aa; /* Bright teal for builtins (String, List) */
3289     -3258     -    2736 +    2371 +     41 +  --syntax-char: #00f5d4; /* Same as strings */
3290     -3259     -    2737 +    2372 +     42 +  --syntax-regex: #00f5d4; /* Same as strings */
3291     -3260     -    2738 +    2373 +     43 +  --syntax-inserted: #00d4aa; /* For diff */
3292     -3261     -    2739 +    2374 +     44 +
3293     -3262     -    2740 +    2375 +     45 +  /* Core hue-5: Orange/Red - Properties, tags */
3294     -3263     -    2741 +    2376 +     46 +  --syntax-property: #fb5607; /* Neon orange for properties */
3295     -3264     -    2742 +    2377 +     47 +  --syntax-tag: #ff006e; /* Hot pink for tags */
3296     -3265     -    2743 +    2378 +     48 +  --syntax-deleted: #ff006e; /* Pink for diff */
3297     -3266     -    2744 +    2379 +     49 +  --syntax-important: #fb5607; /* Orange for !important */
3298     -3267     -    2745 +    2380 +     50 +
3299     -3268     -    2746 +    2381 +     51 +  /* Core hue-6: Yellow/Purple - Class names, constants, numbers */
3300     -3269     -    2747 +    2382 +     52 +  --syntax-class-name: #ffbe0b; /* Electric yellow for class names (Rectangle, Shape) */
3301     -3270     -    2748 +    2383 +     53 +  --syntax-number: #ffbe0b; /* Yellow for numbers */
3302     -3271     -    2749 +    2384 +     54 +  --syntax-constant: #fb5607; /* Orange for constants */
3303     -3272     -    2750 +    2385 +     55 +  --syntax-boolean: #ffbe0b; /* Same as numbers */
3304     -3273     -    2751 +    2386 +     56 +  --syntax-atrule: #8338ec; /* Purple for CSS @ rules */
3305     -3274     -    2752 +    2387 +     57 +
3306     -3275     -    2753 +    2388 +     58 +  /* Neutral colors */
3307     -3276     -    2754 +    2389 +     59 +  --syntax-comment: #737373; /* Gray for comments */
3308     -3277     -    2755 +    2390 +     60 +  --syntax-punctuation: #a3a3a3; /* Light gray for punctuation */
3309     -3278     -    2756 +    2391 +     61 +  --syntax-operator: #ff1a8c; /* Pink for operators */
3310     -3279     -    2757 +    2392 +     62 +
3311     -3280     -    2758 +    2393 +     63 +  /* Markup specific */
3312     -3281     -    2759 +    2394 +     64 +  --syntax-attr-name: #ffbe0b; /* Yellow like class-name */
3313     -3282     -    2760 +    2395 +     65 +  --syntax-attr-value: #00f5d4; /* Cyan like strings */
3314     -3283     -    2761 +    2396 +     66 +  --syntax-namespace: #8338ec; /* Purple */
3315     -3284     -    2762 +    2397 +     67 +  --syntax-entity: #a3a3a3; /* Neutral */
3316     -3285     -    2763 +    2398 +     68 +  --syntax-selector: #fb5607; /* Orange like properties */
3317     -3286     -    2764 +    2399 + 40  69  
3318     -3287     -    2765 +    2400 + 41  70    --blockquote-border: #8338ec;
3319     -3288     -    2766 +    2401 + 42     -  --blockquote-bg: #1a1a1a;
3320     -3289     -    2767 +    2402 +     71 +  --blockquote-bg: rgba(131, 56, 236, 0.1); /* Purple-tinted blockquote */
3321     -3290     -    2768 +    2403 + 43  72    --bold-color: #ffbe0b;
3322     -3291     -    2769 +    2404 + 44  73    --italic-color: #ff006e;
3323     -3292     -    2770 +    2405 + 45     -  --table-header-bg: #262626;
3324     -3293     -    2771 +    2406 + 46     -  --table-border: #404040;
3325     -3294     -    2772 +    2407 +     74 +  --table-header-bg: rgba(58, 134, 255, 0.15); /* Blue-tinted table header */
3326     -3295     -    2773 +    2408 +     75 +  --table-border: rgba(76, 29, 149, 0.3); /* Purple-tinted border */
3327     -3296     -    2774 +    2409 +     76 +
3328     -3297     -    2775 +    2410 +     77 +  /* === MERMAID COMPREHENSIVE CONFIGURATION === */
3329     -3298     -    2776 +    2411 +     78 +
3330     -3299     -    2777 +    2412 +     79 +  /* Core Global */
3331     -3300     -    2778 +    2413 +     80 +  --mermaid-background: #0a0e1a;
3332     -3301     -    2779 +    2414 +     81 +  --mermaid-text-color: #e0e7ff;
3333     -3302     -    2780 +    2415 +     82 +  --mermaid-line-color: #3a86ff;
3334     -3303     -    2781 +    2416 +     83 +  --mermaid-main-bkg: #1e2539;
3335     -3304     -    2782 +    2417 +     84 +
3336     -3305     -    2783 +    2418 +     85 +  /* Primary Set */
3337     -3306     -    2784 +    2419 +     86 +  --mermaid-primary-color: #1e2539;
3338     -3307     -    2785 +    2420 +     87 +  --mermaid-primary-text-color: #e0e7ff;
3339     -3308     -    2786 +    2421 +     88 +  --mermaid-primary-border-color: #8338ec;
3340     -3309     -    2787 +    2422 +     89 +
3341     -3310     -    2788 +    2423 +     90 +  /* Secondary Set */
3342     -3311     -    2789 +    2424 +     91 +  --mermaid-secondary-color: #141827;
3343     -3312     -    2790 +    2425 +     92 +  --mermaid-secondary-text-color: #e0e7ff;
3344     -3313     -    2791 +    2426 +     93 +  --mermaid-secondary-border-color: #3a86ff;
3345     -3314     -    2792 +    2427 +     94 +
3346     -3315     -    2793 +    2428 +     95 +  /* Tertiary Set */
3347     -3316     -    2794 +    2429 +     96 +  --mermaid-tertiary-color: #0a0e1a;
3348     -3317     -    2795 +    2430 +     97 +  --mermaid-tertiary-text-color: #e0e7ff;
3349     -3318     -    2796 +    2431 +     98 +  --mermaid-tertiary-border-color: #ff006e;
3350     -3319     -    2797 +    2432 +     99 +
3351     -3320     -    2798 +    2433 +    100 +  /* Flowchart */
3352     -3321     -    2799 +    2434 +    101 +  --mermaid-node-border: #8338ec;
3353     -3322     -    2800 +    2435 +    102 +  --mermaid-cluster-bkg: #141827;
3354     -3323     -    2801 +    2436 +    103 +  --mermaid-cluster-border: #3a86ff;
3355     -3324     -    2802 +    2437 +    104 +  --mermaid-default-link-color: #3a86ff;
3356     -3325     -    2803 +    2438 +    105 +  --mermaid-title-color: #e0e7ff;
3357     -3326     -    2804 +    2439 +    106 +  --mermaid-edge-label-background: #0a0e1a;
3358     -3327     -    2805 +    2440 +    107 +  --mermaid-node-text-color: #e0e7ff;
3359     -3328     -    2806 +    2441 +    108 +
3360     -3329     -    2807 +    2442 +    109 +  /* Sequence Diagram */
3361     -3330     -    2808 +    2443 +    110 +  --mermaid-actor-bkg: #1e2539;
3362     -3331     -    2809 +    2444 +    111 +  --mermaid-actor-border: #8338ec;
3363     -3332     -    2810 +    2445 +    112 +  --mermaid-actor-text-color: #e0e7ff;
3364     -3333     -    2811 +    2446 +    113 +  --mermaid-actor-line-color: #8338ec;
3365     -3334     -    2812 +    2447 +    114 +  --mermaid-signal-color: #3a86ff;
3366     -3335     -    2813 +    2448 +    115 +  --mermaid-signal-text-color: #e0e7ff;
3367     -3336     -    2814 +    2449 +    116 +  --mermaid-label-box-bkg-color: #1e2539;
3368     -3337     -    2815 +    2450 +    117 +  --mermaid-label-box-border-color: #8338ec;
3369     -3338     -    2816 +    2451 +    118 +  --mermaid-label-text-color: #e0e7ff;
3370     -3339     -    2817 +    2452 +    119 +  --mermaid-loop-text-color: #e0e7ff;
3371     -3340     -    2818 +    2453 +    120 +  --mermaid-activation-border-color: #3a86ff;
3372     -3341     -    2819 +    2454 +    121 +  --mermaid-activation-bkg-color: #141827;
3373     -3342     -    2820 +    2455 +    122 +  --mermaid-sequence-number-color: #e0e7ff;
3374     -3343     -    2821 +    2456 +    123 +
3375     -3344     -    2822 +    2457 +    124 +  /* Pie Chart */
3376     -3345     -    2823 +    2458 +    125 +  --mermaid-pie1: #ff006e;
3377     -3346     -    2824 +    2459 +    126 +  --mermaid-pie2: #8338ec;
3378     -3347     -    2825 +    2460 +    127 +  --mermaid-pie3: #3a86ff;
3379     -3348     -    2826 +    2461 +    128 +  --mermaid-pie4: #00f5d4;
3380     -3349     -    2827 +    2462 +    129 +  --mermaid-pie5: #ffbe0b;
3381     -3350     -    2828 +    2463 +    130 +  --mermaid-pie6: #fb5607;
3382     -3351     -    2829 +    2464 +    131 +  --mermaid-pie7: #ff1a8c;
3383     -3352     -    2830 +    2465 +    132 +  --mermaid-pie8: #00d4aa;
3384     -3353     -    2831 +    2466 +    133 +  --mermaid-pie9: #a5b4fc;
3385     -3354     -    2832 +    2467 +    134 +  --mermaid-pie10: #ff006e;
3386     -3355     -    2833 +    2468 +    135 +  --mermaid-pie11: #8338ec;
3387     -3356     -    2834 +    2469 +    136 +  --mermaid-pie12: #3a86ff;
3388     -3357     -    2835 +    2470 +    137 +  --mermaid-pie-title-text-color: #e0e7ff;
3389     -3358     -    2836 +    2471 +    138 +  --mermaid-pie-section-text-color: #0a0e1a; /* Dark on vibrant slices */
3390     -3359     -    2837 +    2472 +    139 +  --mermaid-pie-legend-text-color: #e0e7ff;
3391     -3360     -    2838 +    2473 +    140 +  --mermaid-pie-stroke-color: #8338ec;
3392     -3361     -    2839 +    2474 +    141 +  --mermaid-pie-outer-stroke-color: #8338ec;
3393     -3362     -    2840 +    2475 +    142 +
3394     -3363     -    2841 +    2476 +    143 +  /* State Diagram */
3395     -3364     -    2842 +    2477 +    144 +  --mermaid-label-color: #e0e7ff;
3396     -3365     -    2843 +    2478 +    145 +  --mermaid-alt-background: #141827;
3397     -3366     -    2844 +    2479 +    146 +
3398     -3367     -    2845 +    2480 +    147 +  /* Class Diagram */
3399     -3368     -    2846 +    2481 +    148 +  --mermaid-class-text: #e0e7ff;
3400     -3369     -    2847 +    2482 +    149 +
3401     -3370     -    2848 +    2483 +    150 +  /* User Journey */
3402     -3371     -    2849 +    2484 +    151 +  --mermaid-fill-type0: #ff006e;
3403     -3372     -    2850 +    2485 +    152 +  --mermaid-fill-type1: #8338ec;
3404     -3373     -    2851 +    2486 +    153 +  --mermaid-fill-type2: #3a86ff;
3405     -3374     -    2852 +    2487 +    154 +  --mermaid-fill-type3: #00f5d4;
3406     -3375     -    2853 +    2488 +    155 +  --mermaid-fill-type4: #ffbe0b;
3407     -3376     -    2854 +    2489 +    156 +  --mermaid-fill-type5: #fb5607;
3408     -3377     -    2855 +    2490 +    157 +  --mermaid-fill-type6: #ff1a8c;
3409     -3378     -    2856 +    2491 +    158 +  --mermaid-fill-type7: #00d4aa;
3410     -3379     -    2857 +    2492 + 47 159  }
3411     -3380     -    2858 +    2493 + 48 160  
3412     -3381     -    2859 +    2494 +
3413     -3382     -    2860 +    2495 +```
3414     -3383     -    2861 +    2496 +
3415     -3384     -    2862 +    2497 +
3416     -3385     -    2863 +    2498 +### üìÑ `themes/neon-light.css`
3417     -3386     -    2864 +    2499 +
3418     -3387     -    2865 +    2500 +**Type:** Stylesheet üé®
3419     -3388     -    2866 +    2501 +
3420     -3389     -    2867 +    2502 +```diff
3421     -3390     -    2868 +    2503 +@@ -23,20 +23,49 @@
3422     -3391     -    2869 +    2504 + 23  23    --code-block-bg: #fef3ff; /* Light purple background */
3423     -3392     -    2870 +    2505 + 24  24    --code-border: #e9d5ff;
3424     -3393     -    2871 +    2506 + 25  25  
3425     -3394     -    2872 +    2507 + 26     -  /* Syntax Highlighting - Comprehensive Token Colors */
3426     -3395     -    2873 +    2508 + 27     -  --syntax-keyword: #c026d3;
3427     -3396     -    2874 +    2509 + 28     -  --syntax-string: #10b981;
3428     -3397     -    2875 +    2510 + 29     -  --syntax-number: #f59e0b;
3429     -3398     -    2876 +    2511 + 30     -  --syntax-function: #7c3aed;
3430     -3399     -    2877 +    2512 + 31     -  --syntax-comment: #9ca3af;
3431     -3400     -    2878 +    2513 + 32     -  --syntax-operator: #a21caf;
3432     -3401     -    2879 +    2514 + 33     -  --syntax-punctuation: #6b7280;
3433     -3402     -    2880 +    2515 +     26 +  /* Syntax Highlighting - Production-Grade Token Colors (One Dark Architecture) */
3434     -3403     -    2881 +    2516 + 34  27  
3435     -3404     -    2882 +    2517 + 35     -  /* Additional Token Types for Full Customization */
3436     -3405     -    2883 +    2518 + 36     -  --syntax-variable: #7c3aed; /* Variables - purple */
3437     -3406     -    2884 +    2519 + 37     -  --syntax-property: #a21caf; /* Properties - magenta */
3438     -3407     -    2885 +    2520 + 38     -  --syntax-namespace: #c026d3; /* Namespaces - pink */
3439     -3408     -    2886 +    2521 + 39     -  --syntax-builtin: #7c3aed; /* Builtins - purple */
3440     -3409     -    2887 +    2522 +     28 +  /* Core hue-1: Cyan - URLs */
3441     -3410     -    2888 +    2523 +     29 +  --syntax-url: #06b6d4; /* Cyan for URLs */
3442     -3411     -    2889 +    2524 +     30 +
3443     -3412     -    2890 +    2525 +     31 +  /* Core hue-2: Purple/Violet - Functions, variables */
3444     -3413     -    2891 +    2526 +     32 +  --syntax-function: #7c3aed; /* Vibrant purple for functions */
3445     -3414     -    2892 +    2527 +     33 +  --syntax-variable: #6366f1; /* Indigo for variables */
3446     -3415     -    2893 +    2528 +     34 +
3447     -3416     -    2894 +    2529 +     35 +  /* Core hue-3: Magenta - Keywords */
3448     -3417     -    2895 +    2530 +     36 +  --syntax-keyword: #c026d3; /* Bright magenta for keywords (final, sealed, class) */
3449     -3418     -    2896 +    2531 +     37 +
3450     -3419     -    2897 +    2532 +     38 +  /* Core hue-4: Green - Strings, builtins */
3451     -3420     -    2898 +    2533 +     39 +  --syntax-string: #10b981; /* Emerald green for strings */
3452     -3421     -    2899 +    2534 +     40 +  --syntax-builtin: #059669; /* Dark emerald for builtins (String, List) */
3453     -3422     -    2900 +    2535 +     41 +  --syntax-char: #10b981; /* Same as strings */
3454     -3423     -    2901 +    2536 +     42 +  --syntax-regex: #10b981; /* Same as strings */
3455     -3424     -    2902 +    2537 +     43 +  --syntax-inserted: #10b981; /* For diff */
3456     -3425     -    2903 +    2538 +     44 +
3457     -3426     -    2904 +    2539 +     45 +  /* Core hue-5: Blue - Properties, tags */
3458     -3427     -    2905 +    2540 +     46 +  --syntax-property: #3b82f6; /* Blue for properties */
3459     -3428     -    2906 +    2541 +     47 +  --syntax-tag: #2563eb; /* Dark blue for tags */
3460     -3429     -    2907 +    2542 +     48 +  --syntax-deleted: #ef4444; /* Red for diff */
3461     -3430     -    2908 +    2543 +     49 +  --syntax-important: #3b82f6; /* Blue for !important */
3462     -3431     -    2909 +    2544 +     50 +
3463     -3432     -    2910 +    2545 +     51 +  /* Core hue-6: Amber/Pink - Class names, constants, numbers */
3464     -3433     -    2911 +    2546 +     52 +  --syntax-class-name: #d946ef; /* Fuchsia for class names (Rectangle, Shape) */
3465     -3434     -    2912 +    2547 +     53 +  --syntax-number: #f59e0b; /* Amber for numbers */
3466     -3435     -    2913 +    2548 +     54 +  --syntax-constant: #c026d3; /* Magenta for constants */
3467     -3436     -    2914 +    2549 +     55 +  --syntax-boolean: #f59e0b; /* Same as numbers */
3468     -3437     -    2915 +    2550 +     56 +  --syntax-atrule: #d946ef; /* Fuchsia for CSS @ rules */
3469     -3438     -    2916 +    2551 +     57 +
3470     -3439     -    2917 +    2552 +     58 +  /* Neutral colors */
3471     -3440     -    2918 +    2553 +     59 +  --syntax-comment: #9ca3af; /* Gray for comments */
3472     -3441     -    2919 +    2554 +     60 +  --syntax-punctuation: #6b7280; /* Dark gray for punctuation */
3473     -3442     -    2920 +    2555 +     61 +  --syntax-operator: #a21caf; /* Magenta-pink for operators */
3474     -3443     -    2921 +    2556 +     62 +
3475     -3444     -    2922 +    2557 +     63 +  /* Markup specific */
3476     -3445     -    2923 +    2558 +     64 +  --syntax-attr-name: #d946ef; /* Fuchsia like class-name */
3477     -3446     -    2924 +    2559 +     65 +  --syntax-attr-value: #10b981; /* Green like strings */
3478     -3447     -    2925 +    2560 +     66 +  --syntax-namespace: #7c3aed; /* Purple like keywords */
3479     -3448     -    2926 +    2561 +     67 +  --syntax-entity: #6b7280; /* Neutral */
3480     -3449     -    2927 +    2562 +     68 +  --syntax-selector: #3b82f6; /* Blue like properties */
3481     -3450     -    2928 +    2563 + 40  69  
3482     -3451     -    2929 +    2564 + 41  70    --blockquote-border: #c026d3;
3483     -3452     -    2930 +    2565 + 42  71    --blockquote-bg: #fef3ff;
3484     -3453     -    2931 +    2566 +@@ -44,4 +73,87 @@
3485     -3454     -    2932 +    2567 + 44  73    --italic-color: #c026d3;
3486     -3455     -    2933 +    2568 + 45  74    --table-header-bg: #fce7f3;
3487     -3456     -    2934 +    2569 + 46  75    --table-border: #e9d5ff;
3488     -3457     -    2935 +    2570 +     76 +
3489     -3458     -    2936 +    2571 +     77 +  /* === MERMAID COMPREHENSIVE CONFIGURATION === */
3490     -3459     -    2937 +    2572 +     78 +
3491     -3460     -    2938 +    2573 +     79 +  /* Core Global */
3492     -3461     -    2939 +    2574 +     80 +  --mermaid-background: #ffffff;
3493     -3462     -    2940 +    2575 +     81 +  --mermaid-text-color: #3b0764;
3494     -3463     -    2941 +    2576 +     82 +  --mermaid-line-color: #7c3aed;
3495     -3464     -    2942 +    2577 +     83 +  --mermaid-main-bkg: #fce7f3;
3496     -3465     -    2943 +    2578 +     84 +
3497     -3466     -    2944 +    2579 +     85 +  /* Primary Set */
3498     -3467     -    2945 +    2580 +     86 +  --mermaid-primary-color: #fce7f3;
3499     -3468     -    2946 +    2581 +     87 +  --mermaid-primary-text-color: #3b0764;
3500     -3469     -    2947 +    2582 +     88 +  --mermaid-primary-border-color: #c026d3;
3501     -3470     -    2948 +    2583 +     89 +
3502     -3471     -    2949 +    2584 +     90 +  /* Secondary Set */
3503     -3472     -    2950 +    2585 +     91 +  --mermaid-secondary-color: #fef3ff;
3504     -3473     -    2951 +    2586 +     92 +  --mermaid-secondary-text-color: #3b0764;
3505     -3474     -    2952 +    2587 +     93 +  --mermaid-secondary-border-color: #7c3aed;
3506     -3475     -    2953 +    2588 +     94 +
3507     -3476     -    2954 +    2589 +     95 +  /* Tertiary Set */
3508     -3477     -    2955 +    2590 +     96 +  --mermaid-tertiary-color: #ffffff;
3509     -3478     -    2956 +    2591 +     97 +  --mermaid-tertiary-text-color: #3b0764;
3510     -3479     -    2957 +    2592 +     98 +  --mermaid-tertiary-border-color: #d946ef;
3511     -3480     -    2958 +    2593 +     99 +
3512     -3481     -    2959 +    2594 +    100 +  /* Flowchart */
3513     -3482     -    2960 +    2595 +    101 +  --mermaid-node-border: #c026d3;
3514     -3483     -    2961 +    2596 +    102 +  --mermaid-cluster-bkg: #fef3ff;
3515     -3484     -    2962 +    2597 +    103 +  --mermaid-cluster-border: #7c3aed;
3516     -3485     -    2963 +    2598 +    104 +  --mermaid-default-link-color: #7c3aed;
3517     -3486     -    2964 +    2599 +    105 +  --mermaid-title-color: #3b0764;
3518     -3487     -    2965 +    2600 +    106 +  --mermaid-edge-label-background: #ffffff;
3519     -3488     -    2966 +    2601 +    107 +  --mermaid-node-text-color: #3b0764;
3520     -3489     -    2967 +    2602 +    108 +
3521     -3490     -    2968 +    2603 +    109 +  /* Sequence Diagram */
3522     -3491     -    2969 +    2604 +    110 +  --mermaid-actor-bkg: #fce7f3;
3523     -3492     -    2970 +    2605 +    111 +  --mermaid-actor-border: #c026d3;
3524     -3493     -    2971 +    2606 +    112 +  --mermaid-actor-text-color: #3b0764;
3525     -3494     -    2972 +    2607 +    113 +  --mermaid-actor-line-color: #c026d3;
3526     -3495     -    2973 +    2608 +    114 +  --mermaid-signal-color: #7c3aed;
3527     -3496     -    2974 +    2609 +    115 +  --mermaid-signal-text-color: #3b0764;
3528     -3497     -    2975 +    2610 +    116 +  --mermaid-label-box-bkg-color: #fce7f3;
3529     -3498     -    2976 +    2611 +    117 +  --mermaid-label-box-border-color: #c026d3;
3530     -3499     -    2977 +    2612 +    118 +  --mermaid-label-text-color: #3b0764;
3531     -3500     -    2978 +    2613 +    119 +  --mermaid-loop-text-color: #3b0764;
3532     -3501     -    2979 +    2614 +    120 +  --mermaid-activation-border-color: #7c3aed;
3533     -3502     -    2980 +    2615 +    121 +  --mermaid-activation-bkg-color: #fef3ff;
3534     -3503     -    2981 +    2616 +    122 +  --mermaid-sequence-number-color: #3b0764;
3535     -3504     -    2982 +    2617 +    123 +
3536     -3505     -    2983 +    2618 +    124 +  /* Pie Chart */
3537     -3506     -    2984 +    2619 +    125 +  --mermaid-pie1: #c026d3;
3538     -3507     -    2985 +    2620 +    126 +  --mermaid-pie2: #7c3aed;
3539     -3508     -    2986 +    2621 +    127 +  --mermaid-pie3: #3b82f6;
3540     -3509     -    2987 +    2622 +    128 +  --mermaid-pie4: #06b6d4;
3541     -3510     -    2988 +    2623 +    129 +  --mermaid-pie5: #f59e0b;
3542     -3511     -    2989 +    2624 +    130 +  --mermaid-pie6: #ef4444;
3543     -3512     -    2990 +    2625 +    131 +  --mermaid-pie7: #d946ef;
3544     -3513     -    2991 +    2626 +    132 +  --mermaid-pie8: #6366f1;
3545     -3514     -    2992 +    2627 +    133 +  --mermaid-pie9: #10b981;
3546     -3515     -    2993 +    2628 +    134 +  --mermaid-pie10: #c026d3;
3547     -3516     -    2994 +    2629 +    135 +  --mermaid-pie11: #7c3aed;
3548     -3517     -    2995 +    2630 +    136 +  --mermaid-pie12: #3b82f6;
3549     -3518     -    2996 +    2631 +    137 +  --mermaid-pie-title-text-color: #3b0764;
3550     -3519     -    2997 +    2632 +    138 +  --mermaid-pie-section-text-color: #ffffff; /* White on vibrant slices */
3551     -3520     -    2998 +    2633 +    139 +  --mermaid-pie-legend-text-color: #3b0764;
3552     -3521     -    2999 +    2634 +    140 +  --mermaid-pie-stroke-color: #c026d3;
3553     -3522     -    3000 +    2635 +    141 +  --mermaid-pie-outer-stroke-color: #c026d3;
3554     -3523     -    3001 +    2636 +    142 +
3555     -3524     -    3002 +    2637 +    143 +  /* State Diagram */
3556     -3525     -    3003 +    2638 +    144 +  --mermaid-label-color: #3b0764;
3557     -3526     -    3004 +    2639 +    145 +  --mermaid-alt-background: #fef3ff;
3558     -3527     -    3005 +    2640 +    146 +
3559     -3528     -    3006 +    2641 +    147 +  /* Class Diagram */
3560     -3529     -    3007 +    2642 +    148 +  --mermaid-class-text: #3b0764;
3561     -3530     -    3008 +    2643 +    149 +
3562     -3531     -    3009 +    2644 +    150 +  /* User Journey */
3563     -3532     -    3010 +    2645 +    151 +  --mermaid-fill-type0: #c026d3;
3564     -3533     -    3011 +    2646 +    152 +  --mermaid-fill-type1: #7c3aed;
3565     -3534     -    3012 +    2647 +    153 +  --mermaid-fill-type2: #3b82f6;
3566     -3535     -    3013 +    2648 +    154 +  --mermaid-fill-type3: #06b6d4;
3567     -3536     -    3014 +    2649 +    155 +  --mermaid-fill-type4: #f59e0b;
3568     -3537     -    3015 +    2650 +    156 +  --mermaid-fill-type5: #ef4444;
3569     -3538     -    3016 +    2651 +    157 +  --mermaid-fill-type6: #d946ef;
3570     -3539     -    3017 +    2652 +    158 +  --mermaid-fill-type7: #6366f1;
3571     -3540     -    3018 +    2653 + 47 159  }
3572     -3541     -    3019 +    2654 + 48 160  
3573     -3542     -    3020 +    2655 +
3574     -3543     -    3021 +    2656 +```
3575     -3544     -    3022 +    2657 +
3576     -3545     -    3023 +    2658 +
3577     -3546     -    3024 +    2659 +### üìÑ `themes/obsidian-dark.css`
3578     -3547     -    3025 +    2660 +
3579     -3548     -    3026 +    2661 +**Type:** Stylesheet üé®
3580     -3549     -    3027 +    2662 +
3581     -3550     -    3028 +    2663 +```diff
3582     -3551     -    3029 +    2664 +@@ -52,20 +52,49 @@
3583     -3552     -    3030 +    2665 + 52  52    --code-block-bg: #232635;
3584     -3553     -    3031 +    2666 + 53  53    --code-border: rgba(78, 205, 196, 0.2);
3585     -3554     -    3032 +    2667 + 54  54  
3586     -3555     -    3033 +    2668 + 55     -  /* Syntax Highlighting */
3587     -3556     -    3034 +    2669 + 56     -  --syntax-keyword: #c792ea;
3588     -3557     -    3035 +    2670 + 57     -  --syntax-string: #6bcf7f;
3589     -3558     -    3036 +    2671 + 58     -  --syntax-number: #ffcb6b;
3590     -3559     -    3037 +    2672 + 59     -  --syntax-function: #82aaff;
3591     -3560     -    3038 +    2673 + 60     -  --syntax-comment: #7f85a3;
3592     -3561     -    3039 +    2674 + 61     -  --syntax-operator: #89ddff;
3593     -3562     -    3040 +    2675 + 62     -  --syntax-punctuation: #b8bcc8;
3594     -3563     -    3041 +    2676 +     55 +  /* Syntax Highlighting - Production-Grade Token Colors (One Dark Architecture) */
3595     -3564     -    3042 +    2677 + 63  56  
3596     -3565     -    3043 +    2678 + 64     -  /* Additional Token Types */
3597     -3566     -    3044 +    2679 + 65     -  --syntax-variable: #82aaff; /* Variables - blue (distinct from text #f5f7ff) */
3598     -3567     -    3045 +    2680 + 66     -  --syntax-property: #4ecdc4; /* Properties - cyan */
3599     -3568     -    3046 +    2681 + 67     -  --syntax-namespace: #ffb86c; /* Namespaces - orange */
3600     -3569     -    3047 +    2682 + 68     -  --syntax-builtin: #c77dff; /* Builtins - purple */
3601     -3570     -    3048 +    2683 +     57 +  /* Core hue-1: Cyan - URLs */
3602     -3571     -    3049 +    2684 +     58 +  --syntax-url: #4ecdc4; /* Bright cyan for URLs */
3603     -3572     -    3050 +    2685 +     59 +
3604     -3573     -    3051 +    2686 +     60 +  /* Core hue-2: Blue - Functions, variables */
3605     -3574     -    3052 +    2687 +     61 +  --syntax-function: #82aaff; /* Bright blue for functions */
3606     -3575     -    3053 +    2688 +     62 +  --syntax-variable: #5da9ff; /* Sky blue for variables */
3607     -3576     -    3054 +    2689 +     63 +
3608     -3577     -    3055 +    2690 +     64 +  /* Core hue-3: Purple - Keywords */
3609     -3578     -    3056 +    2691 +     65 +  --syntax-keyword: #c792ea; /* Lavender purple for keywords (final, sealed, class) */
3610     -3579     -    3057 +    2692 +     66 +
3611     -3580     -    3058 +    2693 +     67 +  /* Core hue-4: Green - Strings, builtins */
3612     -3581     -    3059 +    2694 +     68 +  --syntax-string: #95e1d3; /* Mint green for strings */
3613     -3582     -    3060 +    2695 +     69 +  --syntax-builtin: #6bcf7f; /* Vibrant green for builtins (String, List) */
3614     -3583     -    3061 +    2696 +     70 +  --syntax-char: #95e1d3; /* Same as strings */
3615     -3584     -    3062 +    2697 +     71 +  --syntax-regex: #95e1d3; /* Same as strings */
3616     -3585     -    3063 +    2698 +     72 +  --syntax-inserted: #6bcf7f; /* For diff */
3617     -3586     -    3064 +    2699 +     73 +
3618     -3587     -    3065 +    2700 +     74 +  /* Core hue-5: Pink - Properties, tags */
3619     -3588     -    3066 +    2701 +     75 +  --syntax-property: #ff6b9d; /* Hot pink for properties */
3620     -3589     -    3067 +    2702 +     76 +  --syntax-tag: #ff7eb3; /* Coral pink for tags */
3621     -3590     -    3068 +    2703 +     77 +  --syntax-deleted: #f38ba8; /* Pink-red for diff */
3622     -3591     -    3069 +    2704 +     78 +  --syntax-important: #ff6b9d; /* Hot pink for !important */
3623     -3592     -    3070 +    2705 +     79 +
3624     -3593     -    3071 +    2706 +     80 +  /* Core hue-6: Yellow/Orange - Class names, constants, numbers */
3625     -3594     -    3072 +    2707 +     81 +  --syntax-class-name: #ffb86c; /* Peach orange for class names (Rectangle, Shape) */
3626     -3595     -    3073 +    2708 +     82 +  --syntax-number: #ffd93d; /* Bright yellow for numbers */
3627     -3596     -    3074 +    2709 +     83 +  --syntax-constant: #ffb86c; /* Peach for constants */
3628     -3597     -    3075 +    2710 +     84 +  --syntax-boolean: #ffd93d; /* Same as numbers */
3629     -3598     -    3076 +    2711 +     85 +  --syntax-atrule: #c77dff; /* Purple for CSS @ rules */
3630     -3599     -    3077 +    2712 +     86 +
3631     -3600     -    3078 +    2713 +     87 +  /* Neutral colors */
3632     -3601     -    3079 +    2714 +     88 +  --syntax-comment: #7f85a3; /* Muted blue-gray for comments */
3633     -3602     -    3080 +    2715 +     89 +  --syntax-punctuation: #b8bcc8; /* Light gray for punctuation */
3634     -3603     -    3081 +    2716 +     90 +  --syntax-operator: #89ddff; /* Cyan for operators */
3635     -3604     -    3082 +    2717 +     91 +
3636     -3605     -    3083 +    2718 +     92 +  /* Markup specific */
3637     -3606     -    3084 +    2719 +     93 +  --syntax-attr-name: #ffb86c; /* Peach like class-name */
3638     -3607     -    3085 +    2720 +     94 +  --syntax-attr-value: #95e1d3; /* Mint like strings */
3639     -3608     -    3086 +    2721 +     95 +  --syntax-namespace: #c792ea; /* Purple like keywords */
3640     -3609     -    3087 +    2722 +     96 +  --syntax-entity: #b8bcc8; /* Neutral */
3641     -3610     -    3088 +    2723 +     97 +  --syntax-selector: #ff6b9d; /* Pink like properties */
3642     -3611     -    3089 +    2724 + 69  98  
3643     -3612     -    3090 +    2725 + 70  99    /* Blockquote */
3644     -3613     -    3091 +    2726 + 71 100    --blockquote-border: #ff6b9d;
3645     -3614     -    3092 +    2727 +@@ -77,4 +106,87 @@
3646     -3615     -    3093 +    2728 + 77 106  
3647     -3616     -    3094 +    2729 + 78 107    /* Border */
3648     -3617     -    3095 +    2730 + 79 108    --border-color: rgba(255, 255, 255, 0.1);
3649     -3618     -    3096 +    2731 +    109 +
3650     -3619     -    3097 +    2732 +    110 +  /* === MERMAID COMPREHENSIVE CONFIGURATION === */
3651     -3620     -    3098 +    2733 +    111 +
3652     -3621     -    3099 +    2734 +    112 +  /* Core Global */
3653     -3622     -    3100 +    2735 +    113 +  --mermaid-background: #1e1e2e;
3654     -3623     -    3101 +    2736 +    114 +  --mermaid-text-color: #f5f7ff;
3655     -3624     -    3102 +    2737 +    115 +  --mermaid-line-color: #82aaff;
3656     -3625     -    3103 +    2738 +    116 +  --mermaid-main-bkg: #383a4f;
3657     -3626     -    3104 +    2739 +    117 +
3658     -3627     -    3105 +    2740 +    118 +  /* Primary Set */
3659     -3628     -    3106 +    2741 +    119 +  --mermaid-primary-color: #383a4f;
3660     -3629     -    3107 +    2742 +    120 +  --mermaid-primary-text-color: #f5f7ff;
3661     -3630     -    3108 +    2743 +    121 +  --mermaid-primary-border-color: #ff6b9d;
3662     -3631     -    3109 +    2744 +    122 +
3663     -3632     -    3110 +    2745 +    123 +  /* Secondary Set */
3664     -3633     -    3111 +    2746 +    124 +  --mermaid-secondary-color: #2b2d3e;
3665     -3634     -    3112 +    2747 +    125 +  --mermaid-secondary-text-color: #f5f7ff;
3666     -3635     -    3113 +    2748 +    126 +  --mermaid-secondary-border-color: #82aaff;
3667     -3636     -    3114 +    2749 +    127 +
3668     -3637     -    3115 +    2750 +    128 +  /* Tertiary Set */
3669     -3638     -    3116 +    2751 +    129 +  --mermaid-tertiary-color: #1e1e2e;
3670     -3639     -    3117 +    2752 +    130 +  --mermaid-tertiary-text-color: #f5f7ff;
3671     -3640     -    3118 +    2753 +    131 +  --mermaid-tertiary-border-color: #4ecdc4;
3672     -3641     -    3119 +    2754 +    132 +
3673     -3642     -    3120 +    2755 +    133 +  /* Flowchart */
3674     -3643     -    3121 +    2756 +    134 +  --mermaid-node-border: #ff6b9d;
3675     -3644     -    3122 +    2757 +    135 +  --mermaid-cluster-bkg: #2b2d3e;
3676     -3645     -    3123 +    2758 +    136 +  --mermaid-cluster-border: #82aaff;
3677     -3646     -    3124 +    2759 +    137 +  --mermaid-default-link-color: #82aaff;
3678     -3647     -    3125 +    2760 +    138 +  --mermaid-title-color: #f5f7ff;
3679     -3648     -    3126 +    2761 +    139 +  --mermaid-edge-label-background: #1e1e2e;
3680     -3649     -    3127 +    2762 +    140 +  --mermaid-node-text-color: #f5f7ff;
3681     -3650     -    3128 +    2763 +    141 +
3682     -3651     -    3129 +    2764 +    142 +  /* Sequence Diagram */
3683     -3652     -    3130 +    2765 +    143 +  --mermaid-actor-bkg: #383a4f;
3684     -3653     -    3131 +    2766 +    144 +  --mermaid-actor-border: #ff6b9d;
3685     -3654     -    3132 +    2767 +    145 +  --mermaid-actor-text-color: #f5f7ff;
3686     -3655     -    3133 +    2768 +    146 +  --mermaid-actor-line-color: #ff6b9d;
3687     -3656     -    3134 +    2769 +    147 +  --mermaid-signal-color: #82aaff;
3688     -3657     -    3135 +    2770 +    148 +  --mermaid-signal-text-color: #f5f7ff;
3689     -3658     -    3136 +    2771 +    149 +  --mermaid-label-box-bkg-color: #383a4f;
3690     -3659     -    3137 +    2772 +    150 +  --mermaid-label-box-border-color: #ff6b9d;
3691     -3660     -    3138 +    2773 +    151 +  --mermaid-label-text-color: #f5f7ff;
3692     -3661     -    3139 +    2774 +    152 +  --mermaid-loop-text-color: #f5f7ff;
3693     -3662     -    3140 +    2775 +    153 +  --mermaid-activation-border-color: #82aaff;
3694     -3663     -    3141 +    2776 +    154 +  --mermaid-activation-bkg-color: #2b2d3e;
3695     -3664     -    3142 +    2777 +    155 +  --mermaid-sequence-number-color: #f5f7ff;
3696     -3665     -    3143 +    2778 +    156 +
3697     -3666     -    3144 +    2779 +    157 +  /* Pie Chart */
3698     -3667     -    3145 +    2780 +    158 +  --mermaid-pie1: #ff6b9d;
3699     -3668     -    3146 +    2781 +    159 +  --mermaid-pie2: #ffd93d;
3700     -3669     -    3147 +    2782 +    160 +  --mermaid-pie3: #4ecdc4;
3701     -3670     -    3148 +    2783 +    161 +  --mermaid-pie4: #c77dff;
3702     -3671     -    3149 +    2784 +    162 +  --mermaid-pie5: #ffb86c;
3703     -3672     -    3150 +    2785 +    163 +  --mermaid-pie6: #95e1d3;
3704     -3673     -    3151 +    2786 +    164 +  --mermaid-pie7: #82aaff;
3705     -3674     -    3152 +    2787 +    165 +  --mermaid-pie8: #ff7eb3;
3706     -3675     -    3153 +    2788 +    166 +  --mermaid-pie9: #c8f6c2;
3707     -3676     -    3154 +    2789 +    167 +  --mermaid-pie10: #89dceb;
3708     -3677     -    3155 +    2790 +    168 +  --mermaid-pie11: #ff6b9d;
3709     -3678     -    3156 +    2791 +    169 +  --mermaid-pie12: #ffd93d;
3710     -3679     -    3157 +    2792 +    170 +  --mermaid-pie-title-text-color: #f5f7ff;
3711     -3680     -    3158 +    2793 +    171 +  --mermaid-pie-section-text-color: #1e1e2e; /* Dark on vibrant slices */
3712     -3681     -    3159 +    2794 +    172 +  --mermaid-pie-legend-text-color: #f5f7ff;
3713     -3682     -    3160 +    2795 +    173 +  --mermaid-pie-stroke-color: #ff6b9d;
3714     -3683     -    3161 +    2796 +    174 +  --mermaid-pie-outer-stroke-color: #ff6b9d;
3715     -3684     -    3162 +    2797 +    175 +
3716     -3685     -    3163 +    2798 +    176 +  /* State Diagram */
3717     -3686     -    3164 +    2799 +    177 +  --mermaid-label-color: #f5f7ff;
3718     -3687     -    3165 +    2800 +    178 +  --mermaid-alt-background: #2b2d3e;
3719     -3688     -    3166 +    2801 +    179 +
3720     -3689     -    3167 +    2802 +    180 +  /* Class Diagram */
3721     -3690     -    3168 +    2803 +    181 +  --mermaid-class-text: #f5f7ff;
3722     -3691     -    3169 +    2804 +    182 +
3723     -3692     -    3170 +    2805 +    183 +  /* User Journey */
3724     -3693     -    3171 +    2806 +    184 +  --mermaid-fill-type0: #ff6b9d;
3725     -3694     -    3172 +    2807 +    185 +  --mermaid-fill-type1: #ffd93d;
3726     -3695     -    3173 +    2808 +    186 +  --mermaid-fill-type2: #4ecdc4;
3727     -3696     -    3174 +    2809 +    187 +  --mermaid-fill-type3: #c77dff;
3728     -3697     -    3175 +    2810 +    188 +  --mermaid-fill-type4: #ffb86c;
3729     -3698     -    3176 +    2811 +    189 +  --mermaid-fill-type5: #95e1d3;
3730     -3699     -    3177 +    2812 +    190 +  --mermaid-fill-type6: #82aaff;
3731     -3700     -    3178 +    2813 +    191 +  --mermaid-fill-type7: #ff7eb3;
3732     -3701     -    3179 +    2814 + 80 192  }
3733     -3702     -    3180 +    2815 + 81 193  
3734     -3703     -    3181 +    2816 +
3735     -3704     -    3182 +    2817 +```
3736     -3705     -    3183 +    2818 +
3737     -3706     -    3184 +    2819 +
3738     -3707     -    3185 +    2820 +### üìÑ `themes/obsidian-light.css`
3739     -3708     -    3186 +    2821 +
3740     -3709     -    3187 +    2822 +**Type:** Stylesheet üé®
3741     -3710     -    3188 +    2823 +
3742     -3711     -    3189 +    2824 +```diff
3743     -3712     -    3190 +    2825 +@@ -52,20 +52,49 @@
3744     -3713     -    3191 +    2826 + 52  52    --code-block-bg: #f8f9fc;
3745     -3714     -    3192 +    2827 + 53  53    --code-border: rgba(0, 188, 212, 0.2);
3746     -3715     -    3193 +    2828 + 54  54  
3747     -3716     -    3194 +    2829 + 55     -  /* Syntax Highlighting - Comprehensive Token Colors */
3748     -3717     -    3195 +    2830 + 56     -  --syntax-keyword: #9c27b0;
3749     -3718     -    3196 +    2831 + 57     -  --syntax-string: #4caf50;
3750     -3719     -    3197 +    2832 + 58     -  --syntax-number: #f57c00;
3751     -3720     -    3198 +    2833 + 59     -  --syntax-function: #2196f3;
3752     -3721     -    3199 +    2834 + 60     -  --syntax-comment: #9e9e9e;
3753     -3722     -    3200 +    2835 + 61     -  --syntax-operator: #00bcd4;
3754     -3723     -    3201 +    2836 + 62     -  --syntax-punctuation: #616161;
3755     -3724     -    3202 +    2837 +     55 +  /* Syntax Highlighting - Production-Grade Token Colors (One Dark Architecture) */
3756     -3725     -    3203 +    2838 + 63  56  
3757     -3726     -    3204 +    2839 + 64     -  /* Additional Token Types for Full Customization */
3758     -3727     -    3205 +    2840 + 65     -  --syntax-variable: #2196f3; /* Variables, parameters - bright blue */
3759     -3728     -    3206 +    2841 + 66     -  --syntax-property: #00bcd4; /* Properties - cyan */
3760     -3729     -    3207 +    2842 + 67     -  --syntax-namespace: #f57c00; /* Namespaces - orange */
3761     -3730     -    3208 +    2843 + 68     -  --syntax-builtin: #9c27b0; /* Built-in functions - purple */
3762     -3731     -    3209 +    2844 +     57 +  /* Core hue-1: Cyan - URLs */
3763     -3732     -    3210 +    2845 +     58 +  --syntax-url: #00bcd4; /* Cyan for URLs */
3764     -3733     -    3211 +    2846 +     59 +
3765     -3734     -    3212 +    2847 +     60 +  /* Core hue-2: Blue - Functions, variables */
3766     -3735     -    3213 +    2848 +     61 +  --syntax-function: #2196f3; /* Bright blue for functions */
3767     -3736     -    3214 +    2849 +     62 +  --syntax-variable: #1976d2; /* Deep blue for variables */
3768     -3737     -    3215 +    2850 +     63 +
3769     -3738     -    3216 +    2851 +     64 +  /* Core hue-3: Purple - Keywords */
3770     -3739     -    3217 +    2852 +     65 +  --syntax-keyword: #9c27b0; /* Vibrant purple for keywords (final, sealed, class) */
3771     -3740     -    3218 +    2853 +     66 +
3772     -3741     -    3219 +    2854 +     67 +  /* Core hue-4: Green - Strings, builtins */
3773     -3742     -    3220 +    2855 +     68 +  --syntax-string: #4caf50; /* Green for strings */
3774     -3743     -    3221 +    2856 +     69 +  --syntax-builtin: #388e3c; /* Dark green for builtins (String, List) */
3775     -3744     -    3222 +    2857 +     70 +  --syntax-char: #4caf50; /* Same as strings */
3776     -3745     -    3223 +    2858 +     71 +  --syntax-regex: #4caf50; /* Same as strings */
3777     -3746     -    3224 +    2859 +     72 +  --syntax-inserted: #388e3c; /* For diff */
3778     -3747     -    3225 +    2860 +     73 +
3779     -3748     -    3226 +    2861 +     74 +  /* Core hue-5: Pink/Orange - Properties, tags */
3780     -3749     -    3227 +    2862 +     75 +  --syntax-property: #e91e63; /* Pink for properties */
3781     -3750     -    3228 +    2863 +     76 +  --syntax-tag: #ff4081; /* Coral for tags */
3782     -3751     -    3229 +    2864 +     77 +  --syntax-deleted: #d32f2f; /* Red for diff */
3783     -3752     -    3230 +    2865 +     78 +  --syntax-important: #e91e63; /* Pink for !important */
3784     -3753     -    3231 +    2866 +     79 +
3785     -3754     -    3232 +    2867 +     80 +  /* Core hue-6: Orange/Yellow - Class names, constants, numbers */
3786     -3755     -    3233 +    2868 +     81 +  --syntax-class-name: #ff9800; /* Orange for class names (Rectangle, Shape) */
3787     -3756     -    3234 +    2869 +     82 +  --syntax-number: #f57c00; /* Dark orange for numbers */
3788     -3757     -    3235 +    2870 +     83 +  --syntax-constant: #ff9800; /* Orange for constants */
3789     -3758     -    3236 +    2871 +     84 +  --syntax-boolean: #f57c00; /* Same as numbers */
3790     -3759     -    3237 +    2872 +     85 +  --syntax-atrule: #9c27b0; /* Purple for CSS @ rules */
3791     -3760     -    3238 +    2873 +     86 +
3792     -3761     -    3239 +    2874 +     87 +  /* Neutral colors */
3793     -3762     -    3240 +    2875 +     88 +  --syntax-comment: #9e9e9e; /* Gray for comments */
3794     -3763     -    3241 +    2876 +     89 +  --syntax-punctuation: #616161; /* Dark gray for punctuation */
3795     -3764     -    3242 +    2877 +     90 +  --syntax-operator: #00bcd4; /* Cyan for operators */
3796     -3765     -    3243 +    2878 +     91 +
3797     -3766     -    3244 +    2879 +     92 +  /* Markup specific */
3798     -3767     -    3245 +    2880 +     93 +  --syntax-attr-name: #ff9800; /* Orange like class-name */
3799     -3768     -    3246 +    2881 +     94 +  --syntax-attr-value: #4caf50; /* Green like strings */
3800     -3769     -    3247 +    2882 +     95 +  --syntax-namespace: #9c27b0; /* Purple like keywords */
3801     -3770     -    3248 +    2883 +     96 +  --syntax-entity: #616161; /* Neutral */
3802     -3771     -    3249 +    2884 +     97 +  --syntax-selector: #e91e63; /* Pink like properties */
3803     -3772     -    3250 +    2885 + 69  98  
3804     -3773     -    3251 +    2886 + 70  99    /* Blockquote */
3805     -3774     -    3252 +    2887 + 71 100    --blockquote-border: #e91e63;
3806     -3775     -    3253 +    2888 +@@ -77,4 +106,87 @@
3807     -3776     -    3254 +    2889 + 77 106  
3808     -3777     -    3255 +    2890 + 78 107    /* Border */
3809     -3778     -    3256 +    2891 + 79 108    --border-color: rgba(0, 0, 0, 0.12);
3810     -3779     -    3257 +    2892 +    109 +
3811     -3780     -    3258 +    2893 +    110 +  /* === MERMAID COMPREHENSIVE CONFIGURATION === */
3812     -3781     -    3259 +    2894 +    111 +
3813     -3782     -    3260 +    2895 +    112 +  /* Core Global */
3814     -3783     -    3261 +    2896 +    113 +  --mermaid-background: #ffffff;
3815     -3784     -    3262 +    2897 +    114 +  --mermaid-text-color: #1a1a1a;
3816     -3785     -    3263 +    2898 +    115 +  --mermaid-line-color: #9c27b0;
3817     -3786     -    3264 +    2899 +    116 +  --mermaid-main-bkg: #e8ecf1;
3818     -3787     -    3265 +    2900 +    117 +
3819     -3788     -    3266 +    2901 +    118 +  /* Primary Set */
3820     -3789     -    3267 +    2902 +    119 +  --mermaid-primary-color: #e8ecf1;
3821     -3790     -    3268 +    2903 +    120 +  --mermaid-primary-text-color: #1a1a1a;
3822     -3791     -    3269 +    2904 +    121 +  --mermaid-primary-border-color: #e91e63;
3823     -3792     -    3270 +    2905 +    122 +
3824     -3793     -    3271 +    2906 +    123 +  /* Secondary Set */
3825     -3794     -    3272 +    2907 +    124 +  --mermaid-secondary-color: #f5f7fa;
3826     -3795     -    3273 +    2908 +    125 +  --mermaid-secondary-text-color: #1a1a1a;
3827     -3796     -    3274 +    2909 +    126 +  --mermaid-secondary-border-color: #9c27b0;
3828     -3797     -    3275 +    2910 +    127 +
3829     -3798     -    3276 +    2911 +    128 +  /* Tertiary Set */
3830     -3799     -    3277 +    2912 +    129 +  --mermaid-tertiary-color: #ffffff;
3831     -3800     -    3278 +    2913 +    130 +  --mermaid-tertiary-text-color: #1a1a1a;
3832     -3801     -    3279 +    2914 +    131 +  --mermaid-tertiary-border-color: #00bcd4;
3833     -3802     -    3280 +    2915 +    132 +
3834     -3803     -    3281 +    2916 +    133 +  /* Flowchart */
3835     -3804     -    3282 +    2917 +    134 +  --mermaid-node-border: #e91e63;
3836     -3805     -    3283 +    2918 +    135 +  --mermaid-cluster-bkg: #f5f7fa;
3837     -3806     -    3284 +    2919 +    136 +  --mermaid-cluster-border: #9c27b0;
3838     -3807     -    3285 +    2920 +    137 +  --mermaid-default-link-color: #9c27b0;
3839     -3808     -    3286 +    2921 +    138 +  --mermaid-title-color: #1a1a1a;
3840     -3809     -    3287 +    2922 +    139 +  --mermaid-edge-label-background: #ffffff;
3841     -3810     -    3288 +    2923 +    140 +  --mermaid-node-text-color: #1a1a1a;
3842     -3811     -    3289 +    2924 +    141 +
3843     -3812     -    3290 +    2925 +    142 +  /* Sequence Diagram */
3844     -3813     -    3291 +    2926 +    143 +  --mermaid-actor-bkg: #e8ecf1;
3845     -3814     -    3292 +    2927 +    144 +  --mermaid-actor-border: #e91e63;
3846     -3815     -    3293 +    2928 +    145 +  --mermaid-actor-text-color: #1a1a1a;
3847     -3816     -    3294 +    2929 +    146 +  --mermaid-actor-line-color: #e91e63;
3848     -3817     -    3295 +    2930 +    147 +  --mermaid-signal-color: #9c27b0;
3849     -3818     -    3296 +    2931 +    148 +  --mermaid-signal-text-color: #1a1a1a;
3850     -3819     -    3297 +    2932 +    149 +  --mermaid-label-box-bkg-color: #e8ecf1;
3851     -3820     -    3298 +    2933 +    150 +  --mermaid-label-box-border-color: #e91e63;
3852     -3821     -    3299 +    2934 +    151 +  --mermaid-label-text-color: #1a1a1a;
3853     -3822     -    3300 +    2935 +    152 +  --mermaid-loop-text-color: #1a1a1a;
3854     -3823     -    3301 +    2936 +    153 +  --mermaid-activation-border-color: #9c27b0;
3855     -3824     -    3302 +    2937 +    154 +  --mermaid-activation-bkg-color: #f5f7fa;
3856     -3825     -    3303 +    2938 +    155 +  --mermaid-sequence-number-color: #1a1a1a;
3857     -3826     -    3304 +    2939 +    156 +
3858     -3827     -    3305 +    2940 +    157 +  /* Pie Chart */
3859     -3828     -    3306 +    2941 +    158 +  --mermaid-pie1: #e91e63;
3860     -3829     -    3307 +    2942 +    159 +  --mermaid-pie2: #9c27b0;
3861     -3830     -    3308 +    2943 +    160 +  --mermaid-pie3: #2196f3;
3862     -3831     -    3309 +    2944 +    161 +  --mermaid-pie4: #00bcd4;
3863     -3832     -    3310 +    2945 +    162 +  --mermaid-pie5: #4caf50;
3864     -3833     -    3311 +    2946 +    163 +  --mermaid-pie6: #ff9800;
3865     -3834     -    3312 +    2947 +    164 +  --mermaid-pie7: #f57c00;
3866     -3835     -    3313 +    2948 +    165 +  --mermaid-pie8: #ff4081;
3867     -3836     -    3314 +    2949 +    166 +  --mermaid-pie9: #1976d2;
3868     -3837     -    3315 +    2950 +    167 +  --mermaid-pie10: #388e3c;
3869     -3838     -    3316 +    2951 +    168 +  --mermaid-pie11: #e91e63;
3870     -3839     -    3317 +    2952 +    169 +  --mermaid-pie12: #9c27b0;
3871     -3840     -    3318 +    2953 +    170 +  --mermaid-pie-title-text-color: #1a1a1a;
3872     -3841     -    3319 +    2954 +    171 +  --mermaid-pie-section-text-color: #ffffff; /* White on vibrant slices */
3873     -3842     -    3320 +    2955 +    172 +  --mermaid-pie-legend-text-color: #1a1a1a;
3874     -3843     -    3321 +    2956 +    173 +  --mermaid-pie-stroke-color: #e91e63;
3875     -3844     -    3322 +    2957 +    174 +  --mermaid-pie-outer-stroke-color: #e91e63;
3876     -3845     -    3323 +    2958 +    175 +
3877     -3846     -    3324 +    2959 +    176 +  /* State Diagram */
3878     -3847     -    3325 +    2960 +    177 +  --mermaid-label-color: #1a1a1a;
3879     -3848     -    3326 +    2961 +    178 +  --mermaid-alt-background: #f5f7fa;
3880     -3849     -    3327 +    2962 +    179 +
3881     -3850     -    3328 +    2963 +    180 +  /* Class Diagram */
3882     -3851     -    3329 +    2964 +    181 +  --mermaid-class-text: #1a1a1a;
3883     -3852     -    3330 +    2965 +    182 +
3884     -3853     -    3331 +    2966 +    183 +  /* User Journey */
3885     -3854     -    3332 +    2967 +    184 +  --mermaid-fill-type0: #e91e63;
3886     -3855     -    3333 +    2968 +    185 +  --mermaid-fill-type1: #9c27b0;
3887     -3856     -    3334 +    2969 +    186 +  --mermaid-fill-type2: #2196f3;
3888     -3857     -    3335 +    2970 +    187 +  --mermaid-fill-type3: #00bcd4;
3889     -3858     -    3336 +    2971 +    188 +  --mermaid-fill-type4: #4caf50;
3890     -3859     -    3337 +    2972 +    189 +  --mermaid-fill-type5: #ff9800;
3891     -3860     -    3338 +    2973 +    190 +  --mermaid-fill-type6: #f57c00;
3892     -3861     -    3339 +    2974 +    191 +  --mermaid-fill-type7: #ff4081;
3893     -3862     -    3340 +    2975 + 80 192  }
3894     -3863     -    3341 +    2976 + 81 193  
3895     -3864     -    3342 +    2977 +
3896     -3865     -    3343 +    2978 +```
3897     -3866     -    3344 +    2979 +
3898     -3867     -    3345 +    2980 +
3899     -3868     -    3346 +    2981 +### üìÑ `themes/ocean-dark.css`
3900     -3869     -    3347 +    2982 +
3901     -3870     -    3348 +    2983 +**Type:** Stylesheet üé®
3902     -3871     -    3349 +    2984 +
3903     -3872     -    3350 +    2985 +```diff
3904     -3873     -    3351 +    2986 +@@ -23,20 +23,49 @@
3905     -3874     -    3352 +    2987 + 23  23    --code-block-bg: #0a192f;
3906     -3875     -    3353 +    2988 + 24  24    --code-border: #233554;
3907     -3876     -    3354 +    2989 + 25  25  
3908     -3877     -    3355 +    2990 + 26     -  /* Syntax Highlighting - Comprehensive Token Colors */
3909     -3878     -    3356 +    2991 + 27     -  --syntax-keyword: #64ffda;
3910     -3879     -    3357 +    2992 + 28     -  --syntax-string: #5eead4;
3911     -3880     -    3358 +    2993 + 29     -  --syntax-number: #38bdf8;
3912     -3881     -    3359 +    2994 + 30     -  --syntax-function: #22d3ee;
3913     -3882     -    3360 +    2995 + 31     -  --syntax-comment: #8892b0;
3914     -3883     -    3361 +    2996 + 32     -  --syntax-operator: #06b6d4;
3915     -3884     -    3362 +    2997 + 33     -  --syntax-punctuation: #8892b0;
3916     -3885     -    3363 +    2998 +     26 +  /* Syntax Highlighting - Production-Grade Token Colors (One Dark Architecture) */
3917     -3886     -    3364 +    2999 + 34  27  
3918     -3887     -    3365 +    3000 + 35     -  /* Additional Token Types */
3919     -3888     -    3366 +    3001 + 36     -  --syntax-variable: #38bdf8; /* Variables - cyan (distinct from text #ccd6f6) */
3920     -3889     -    3367 +    3002 + 37     -  --syntax-property: #22d3ee; /* Properties - teal */
3921     -3890     -    3368 +    3003 + 38     -  --syntax-namespace: #64ffda; /* Namespaces - mint */
3922     -3891     -    3369 +    3004 + 39     -  --syntax-builtin: #5eead4; /* Builtins - teal */
3923     -3892     -    3370 +    3005 +     28 +  /* Core hue-1: Bright Cyan - URLs */
3924     -3893     -    3371 +    3006 +     29 +  --syntax-url: #67e8f9; /* Electric cyan for URLs */
3925     -3894     -    3372 +    3007 +     30 +
3926     -3895     -    3373 +    3008 +     31 +  /* Core hue-2: Blue - Functions, variables */
3927     -3896     -    3374 +    3009 +     32 +  --syntax-function: #38bdf8; /* Sky blue for functions */
3928     -3897     -    3375 +    3010 +     33 +  --syntax-variable: #0ea5e9; /* Deep sky for variables */
3929     -3898     -    3376 +    3011 +     34 +
3930     -3899     -    3377 +    3012 +     35 +  /* Core hue-3: Violet/Purple - Keywords */
3931     -3900     -    3378 +    3013 +     36 +  --syntax-keyword: #c084fc; /* Bright violet for keywords (final, sealed, class) */
3932     -3901     -    3379 +    3014 +     37 +
3933     -3902     -    3380 +    3015 +     38 +  /* Core hue-4: Green/Teal - Strings, builtins */
3934     -3903     -    3381 +    3016 +     39 +  --syntax-string: #5eead4; /* Teal for strings */
3935     -3904     -    3382 +    3017 +     40 +  --syntax-builtin: #2dd4bf; /* Vibrant teal for builtins (String, List) */
3936     -3905     -    3383 +    3018 +     41 +  --syntax-char: #5eead4; /* Same as strings */
3937     -3906     -    3384 +    3019 +     42 +  --syntax-regex: #5eead4; /* Same as strings */
3938     -3907     -    3385 +    3020 +     43 +  --syntax-inserted: #2dd4bf; /* For diff */
3939     -3908     -    3386 +    3021 +     44 +
3940     -3909     -    3387 +    3022 +     45 +  /* Core hue-5: Pink/Rose - Properties, tags */
3941     -3910     -    3388 +    3023 +     46 +  --syntax-property: #f472b6; /* Pink for properties */
3942     -3911     -    3389 +    3024 +     47 +  --syntax-tag: #fb7185; /* Rose for tags */
3943     -3912     -    3390 +    3025 +     48 +  --syntax-deleted: #f87171; /* Coral for diff */
3944     -3913     -    3391 +    3026 +     49 +  --syntax-important: #f472b6; /* Pink for !important */
3945     -3914     -    3392 +    3027 +     50 +
3946     -3915     -    3393 +    3028 +     51 +  /* Core hue-6: Mint/Cyan - Class names, constants, numbers */
3947     -3916     -    3394 +    3029 +     52 +  --syntax-class-name: #64ffda; /* Mint green for class names (Rectangle, Shape) */
3948     -3917     -    3395 +    3030 +     53 +  --syntax-number: #22d3ee; /* Bright cyan for numbers */
3949     -3918     -    3396 +    3031 +     54 +  --syntax-constant: #06b6d4; /* Cyan for constants */
3950     -3919     -    3397 +    3032 +     55 +  --syntax-boolean: #22d3ee; /* Same as numbers */
3951     -3920     -    3398 +    3033 +     56 +  --syntax-atrule: #64ffda; /* Mint for CSS @ rules */
3952     -3921     -    3399 +    3034 +     57 +
3953     -3922     -    3400 +    3035 +     58 +  /* Neutral colors */
3954     -3923     -    3401 +    3036 +     59 +  --syntax-comment: #8892b0; /* Muted blue-gray for comments */
3955     -3924     -    3402 +    3037 +     60 +  --syntax-punctuation: #a0aec0; /* Light gray for punctuation */
3956     -3925     -    3403 +    3038 +     61 +  --syntax-operator: #0891b2; /* Teal for operators */
3957     -3926     -    3404 +    3039 +     62 +
3958     -3927     -    3405 +    3040 +     63 +  /* Markup specific */
3959     -3928     -    3406 +    3041 +     64 +  --syntax-attr-name: #64ffda; /* Mint like class-name */
3960     -3929     -    3407 +    3042 +     65 +  --syntax-attr-value: #5eead4; /* Teal like strings */
3961     -3930     -    3408 +    3043 +     66 +  --syntax-namespace: #c084fc; /* Violet like keywords */
3962     -3931     -    3409 +    3044 +     67 +  --syntax-entity: #a0aec0; /* Neutral */
3963     -3932     -    3410 +    3045 +     68 +  --syntax-selector: #f472b6; /* Pink like properties */
3964     -3933     -    3411 +    3046 + 40  69  
3965     -3934     -    3412 +    3047 + 41  70    --blockquote-border: #64ffda;
3966     -3935     -    3413 +    3048 + 42  71    --blockquote-bg: #112240;
3967     -3936     -    3414 +    3049 +@@ -44,4 +73,87 @@
3968     -3937     -    3415 +    3050 + 44  73    --italic-color: #5eead4;
3969     -3938     -    3416 +    3051 + 45  74    --table-header-bg: #1d3461;
3970     -3939     -    3417 +    3052 + 46  75    --table-border: #233554;
3971     -3940     -    3418 +    3053 +     76 +
3972     -3941     -    3419 +    3054 +     77 +  /* === MERMAID COMPREHENSIVE CONFIGURATION === */
3973     -3942     -    3420 +    3055 +     78 +
3974     -3943     -    3421 +    3056 +     79 +  /* Core Global */
3975     -3944     -    3422 +    3057 +     80 +  --mermaid-background: #0a192f;
3976     -3945     -    3423 +    3058 +     81 +  --mermaid-text-color: #ccd6f6;
3977     -3946     -    3424 +    3059 +     82 +  --mermaid-line-color: #5eead4;
3978     -3947     -    3425 +    3060 +     83 +  --mermaid-main-bkg: #1d3461;
3979     -3948     -    3426 +    3061 +     84 +
3980     -3949     -    3427 +    3062 +     85 +  /* Primary Set */
3981     -3950     -    3428 +    3063 +     86 +  --mermaid-primary-color: #1d3461;
3982     -3951     -    3429 +    3064 +     87 +  --mermaid-primary-text-color: #ccd6f6;
3983     -3952     -    3430 +    3065 +     88 +  --mermaid-primary-border-color: #64ffda;
3984     -3953     -    3431 +    3066 +     89 +
3985     -3954     -    3432 +    3067 +     90 +  /* Secondary Set */
3986     -3955     -    3433 +    3068 +     91 +  --mermaid-secondary-color: #112240;
3987     -3956     -    3434 +    3069 +     92 +  --mermaid-secondary-text-color: #ccd6f6;
3988     -3957     -    3435 +    3070 +     93 +  --mermaid-secondary-border-color: #5eead4;
3989     -3958     -    3436 +    3071 +     94 +
3990     -3959     -    3437 +    3072 +     95 +  /* Tertiary Set */
3991     -3960     -    3438 +    3073 +     96 +  --mermaid-tertiary-color: #0a192f;
3992     -3961     -    3439 +    3074 +     97 +  --mermaid-tertiary-text-color: #ccd6f6;
3993     -3962     -    3440 +    3075 +     98 +  --mermaid-tertiary-border-color: #38bdf8;
3994     -3963     -    3441 +    3076 +     99 +
3995     -3964     -    3442 +    3077 +    100 +  /* Flowchart */
3996     -3965     -    3443 +    3078 +    101 +  --mermaid-node-border: #64ffda;
3997     -3966     -    3444 +    3079 +    102 +  --mermaid-cluster-bkg: #112240;
3998     -3967     -    3445 +    3080 +    103 +  --mermaid-cluster-border: #5eead4;
3999     -3968     -    3446 +    3081 +    104 +  --mermaid-default-link-color: #5eead4;
4000     -3969     -    3447 +    3082 +    105 +  --mermaid-title-color: #ccd6f6;
4001     -3970     -    3448 +    3083 +    106 +  --mermaid-edge-label-background: #0a192f;
4002     -3971     -    3449 +    3084 +    107 +  --mermaid-node-text-color: #ccd6f6;
4003     -3972     -    3450 +    3085 +    108 +
4004     -3973     -    3451 +    3086 +    109 +  /* Sequence Diagram */
4005     -3974     -    3452 +    3087 +    110 +  --mermaid-actor-bkg: #1d3461;
4006     -3975     -    3453 +    3088 +    111 +  --mermaid-actor-border: #64ffda;
4007     -3976     -    3454 +    3089 +    112 +  --mermaid-actor-text-color: #ccd6f6;
4008     -3977     -    3455 +    3090 +    113 +  --mermaid-actor-line-color: #64ffda;
4009     -3978     -    3456 +    3091 +    114 +  --mermaid-signal-color: #5eead4;
4010     -3979     -    3457 +    3092 +    115 +  --mermaid-signal-text-color: #ccd6f6;
4011     -3980     -    3458 +    3093 +    116 +  --mermaid-label-box-bkg-color: #1d3461;
4012     -3981     -    3459 +    3094 +    117 +  --mermaid-label-box-border-color: #64ffda;
4013     -3982     -    3460 +    3095 +    118 +  --mermaid-label-text-color: #ccd6f6;
4014     -3983     -    3461 +    3096 +    119 +  --mermaid-loop-text-color: #ccd6f6;
4015     -3984     -    3462 +    3097 +    120 +  --mermaid-activation-border-color: #5eead4;
4016     -3985     -    3463 +    3098 +    121 +  --mermaid-activation-bkg-color: #112240;
4017     -3986     -    3464 +    3099 +    122 +  --mermaid-sequence-number-color: #ccd6f6;
4018     -3987     -    3465 +    3100 +    123 +
4019     -3988     -    3466 +    3101 +    124 +  /* Pie Chart */
4020     -3989     -    3467 +    3102 +    125 +  --mermaid-pie1: #64ffda;
4021     -3990     -    3468 +    3103 +    126 +  --mermaid-pie2: #5eead4;
4022     -3991     -    3469 +    3104 +    127 +  --mermaid-pie3: #38bdf8;
4023     -3992     -    3470 +    3105 +    128 +  --mermaid-pie4: #22d3ee;
4024     -3993     -    3471 +    3106 +    129 +  --mermaid-pie5: #06b6d4;
4025     -3994     -    3472 +    3107 +    130 +  --mermaid-pie6: #0891b2;
4026     -3995     -    3473 +    3108 +    131 +  --mermaid-pie7: #c084fc;
4027     -3996     -    3474 +    3109 +    132 +  --mermaid-pie8: #f472b6;
4028     -3997     -    3475 +    3110 +    133 +  --mermaid-pie9: #0ea5e9;
4029     -3998     -    3476 +    3111 +    134 +  --mermaid-pie10: #64ffda;
4030     -3999     -    3477 +    3112 +    135 +  --mermaid-pie11: #5eead4;
4031     -4000     -    3478 +    3113 +    136 +  --mermaid-pie12: #38bdf8;
4032     -4001     -    3479 +    3114 +    137 +  --mermaid-pie-title-text-color: #ccd6f6;
4033     -4002     -    3480 +    3115 +    138 +  --mermaid-pie-section-text-color: #0a192f; /* Dark on vibrant slices */
4034     -4003     -    3481 +    3116 +    139 +  --mermaid-pie-legend-text-color: #ccd6f6;
4035     -4004     -    3482 +    3117 +    140 +  --mermaid-pie-stroke-color: #64ffda;
4036     -4005     -    3483 +    3118 +    141 +  --mermaid-pie-outer-stroke-color: #64ffda;
4037     -4006     -    3484 +    3119 +    142 +
4038     -4007     -    3485 +    3120 +    143 +  /* State Diagram */
4039     -4008     -    3486 +    3121 +    144 +  --mermaid-label-color: #ccd6f6;
4040     -4009     -    3487 +    3122 +    145 +  --mermaid-alt-background: #112240;
4041     -4010     -    3488 +    3123 +    146 +
4042     -4011     -    3489 +    3124 +    147 +  /* Class Diagram */
4043     -4012     -    3490 +    3125 +    148 +  --mermaid-class-text: #ccd6f6;
4044     -4013     -    3491 +    3126 +    149 +
4045     -4014     -    3492 +    3127 +    150 +  /* User Journey */
4046     -4015     -    3493 +    3128 +    151 +  --mermaid-fill-type0: #64ffda;
4047     -4016     -    3494 +    3129 +    152 +  --mermaid-fill-type1: #5eead4;
4048     -4017     -    3495 +    3130 +    153 +  --mermaid-fill-type2: #38bdf8;
4049     -4018     -    3496 +    3131 +    154 +  --mermaid-fill-type3: #22d3ee;
4050     -4019     -    3497 +    3132 +    155 +  --mermaid-fill-type4: #06b6d4;
4051     -4020     -    3498 +    3133 +    156 +  --mermaid-fill-type5: #0891b2;
4052     -4021     -    3499 +    3134 +    157 +  --mermaid-fill-type6: #c084fc;
4053     -4022     -    3500 +    3135 +    158 +  --mermaid-fill-type7: #f472b6;
4054     -4023     -    3501 +    3136 + 47 159  }
4055     -4024     -    3502 +    3137 + 48 160  
4056     -4025     -    3503 +    3138 +
4057     -4026     -    3504 +    3139 +```
4058     -4027     -    3505 +    3140 +
4059     -4028     -    3506 +    3141 +
4060     -4029     -    3507 +    3142 +### üìÑ `themes/ocean-light.css`
4061     -4030     -    3508 +    3143 +
4062     -4031     -    3509 +    3144 +**Type:** Stylesheet üé®
4063     -4032     -    3510 +    3145 +
4064     -4033     -    3511 +    3146 +```diff
4065     -4034     -    3512 +    3147 +@@ -23,20 +23,49 @@
4066     -4035     -    3513 +    3148 + 23  23    --code-block-bg: #e0f2fe; /* Light cyan background */
4067     -4036     -    3514 +    3149 + 24  24    --code-border: #7dd3fc;
4068     -4037     -    3515 +    3150 + 25  25  
4069     -4038     -    3516 +    3151 + 26     -  /* Syntax Highlighting - Comprehensive Token Colors */
4070     -4039     -    3517 +    3152 + 27     -  --syntax-keyword: #0284c7;
4071     -4040     -    3518 +    3153 + 28     -  --syntax-string: #0891b2;
4072     -4041     -    3519 +    3154 + 29     -  --syntax-number: #06b6d4;
4073     -4042     -    3520 +    3155 + 30     -  --syntax-function: #22d3ee;
4074     -4043     -    3521 +    3156 + 31     -  --syntax-comment: #64748b;
4075     -4044     -    3522 +    3157 + 32     -  --syntax-operator: #0369a1;
4076     -4045     -    3523 +    3158 + 33     -  --syntax-punctuation: #475569;
4077     -4046     -    3524 +    3159 +     26 +  /* Syntax Highlighting - Production-Grade Token Colors (One Dark Architecture) */
4078     -4047     -    3525 +    3160 + 34  27  
4079     -4048     -    3526 +    3161 + 35     -  /* Additional Token Types for Full Customization */
4080     -4049     -    3527 +    3162 + 36     -  --syntax-variable: #0369a1; /* Variables - ocean blue */
4081     -4050     -    3528 +    3163 + 37     -  --syntax-property: #0891b2; /* Properties - teal */
4082     -4051     -    3529 +    3164 + 38     -  --syntax-namespace: #0284c7; /* Namespaces - cyan */
4083     -4052     -    3530 +    3165 + 39     -  --syntax-builtin: #22d3ee; /* Builtins - bright cyan */
4084     -4053     -    3531 +    3166 +     28 +  /* Core hue-1: Cyan - URLs */
4085     -4054     -    3532 +    3167 +     29 +  --syntax-url: #06b6d4; /* Bright cyan for URLs */
4086     -4055     -    3533 +    3168 +     30 +
4087     -4056     -    3534 +    3169 +     31 +  /* Core hue-2: Blue - Functions, variables */
4088     -4057     -    3535 +    3170 +     32 +  --syntax-function: #0284c7; /* Ocean blue for functions */
4089     -4058     -    3536 +    3171 +     33 +  --syntax-variable: #0369a1; /* Deep blue for variables */
4090     -4059     -    3537 +    3172 +     34 +
4091     -4060     -    3538 +    3173 +     35 +  /* Core hue-3: Purple/Violet - Keywords */
4092     -4061     -    3539 +    3174 +     36 +  --syntax-keyword: #7c3aed; /* Vivid purple for keywords (final, sealed, class) */
4093     -4062     -    3540 +    3175 +     37 +
4094     -4063     -    3541 +    3176 +     38 +  /* Core hue-4: Green/Teal - Strings, builtins */
4095     -4064     -    3542 +    3177 +     39 +  --syntax-string: #0891b2; /* Teal for strings */
4096     -4065     -    3543 +    3178 +     40 +  --syntax-builtin: #14b8a6; /* Bright teal for builtins (String, List) */
4097     -4066     -    3544 +    3179 +     41 +  --syntax-char: #0891b2; /* Same as strings */
4098     -4067     -    3545 +    3180 +     42 +  --syntax-regex: #0891b2; /* Same as strings */
4099     -4068     -    3546 +    3181 +     43 +  --syntax-inserted: #14b8a6; /* For diff */
4100     -4069     -    3547 +    3182 +     44 +
4101     -4070     -    3548 +    3183 +     45 +  /* Core hue-5: Orange/Amber - Properties, tags */
4102     -4071     -    3549 +    3184 +     46 +  --syntax-property: #f59e0b; /* Amber for properties */
4103     -4072     -    3550 +    3185 +     47 +  --syntax-tag: #ea580c; /* Orange for tags */
4104     -4073     -    3551 +    3186 +     48 +  --syntax-deleted: #ef4444; /* Red for diff */
4105     -4074     -    3552 +    3187 +     49 +  --syntax-important: #f59e0b; /* Amber for !important */
4106     -4075     -    3553 +    3188 +     50 +
4107     -4076     -    3554 +    3189 +     51 +  /* Core hue-6: Cyan - Class names, constants, numbers */
4108     -4077     -    3555 +    3190 +     52 +  --syntax-class-name: #22d3ee; /* Bright cyan for class names (Rectangle, Shape) */
4109     -4078     -    3556 +    3191 +     53 +  --syntax-number: #06b6d4; /* Cyan for numbers */
4110     -4079     -    3557 +    3192 +     54 +  --syntax-constant: #0891b2; /* Teal for constants */
4111     -4080     -    3558 +    3193 +     55 +  --syntax-boolean: #06b6d4; /* Same as numbers */
4112     -4081     -    3559 +    3194 +     56 +  --syntax-atrule: #22d3ee; /* Bright cyan for CSS @ rules */
4113     -4082     -    3560 +    3195 +     57 +
4114     -4083     -    3561 +    3196 +     58 +  /* Neutral colors */
4115     -4084     -    3562 +    3197 +     59 +  --syntax-comment: #64748b; /* Slate gray for comments */
4116     -4085     -    3563 +    3198 +     60 +  --syntax-punctuation: #475569; /* Dark slate for punctuation */
4117     -4086     -    3564 +    3199 +     61 +  --syntax-operator: #0369a1; /* Deep ocean for operators */
4118     -4087     -    3565 +    3200 +     62 +
4119     -4088     -    3566 +    3201 +     63 +  /* Markup specific */
4120     -4089     -    3567 +    3202 +     64 +  --syntax-attr-name: #22d3ee; /* Cyan like class-name */
4121     -4090     -    3568 +    3203 +     65 +  --syntax-attr-value: #0891b2; /* Teal like strings */
4122     -4091     -    3569 +    3204 +     66 +  --syntax-namespace: #7c3aed; /* Purple like keywords */
4123     -4092     -    3570 +    3205 +     67 +  --syntax-entity: #475569; /* Neutral */
4124     -4093     -    3571 +    3206 +     68 +  --syntax-selector: #f59e0b; /* Amber like properties */
4125     -4094     -    3572 +    3207 + 40  69  
4126     -4095     -    3573 +    3208 + 41  70    --blockquote-border: #0891b2;
4127     -4096     -    3574 +    3209 + 42  71    --blockquote-bg: #e0f2fe;
4128     -4097     -    3575 +    3210 +@@ -44,4 +73,87 @@
4129     -4098     -    3576 +    3211 + 44  73    --italic-color: #0891b2;
4130     -4099     -    3577 +    3212 + 45  74    --table-header-bg: #bae6fd;
4131     -4100     -    3578 +    3213 + 46  75    --table-border: #7dd3fc;
4132     -4101     -    3579 +    3214 +     76 +
4133     -4102     -    3580 +    3215 +     77 +  /* === MERMAID COMPREHENSIVE CONFIGURATION === */
4134     -4103     -    3581 +    3216 +     78 +
4135     -4104     -    3582 +    3217 +     79 +  /* Core Global */
4136     -4105     -    3583 +    3218 +     80 +  --mermaid-background: #f0f9ff;
4137     -4106     -    3584 +    3219 +     81 +  --mermaid-text-color: #0c4a6e;
4138     -4107     -    3585 +    3220 +     82 +  --mermaid-line-color: #0891b2;
4139     -4108     -    3586 +    3221 +     83 +  --mermaid-main-bkg: #bae6fd;
4140     -4109     -    3587 +    3222 +     84 +
4141     -4110     -    3588 +    3223 +     85 +  /* Primary Set */
4142     -4111     -    3589 +    3224 +     86 +  --mermaid-primary-color: #bae6fd;
4143     -4112     -    3590 +    3225 +     87 +  --mermaid-primary-text-color: #0c4a6e;
4144     -4113     -    3591 +    3226 +     88 +  --mermaid-primary-border-color: #0284c7;
4145     -4114     -    3592 +    3227 +     89 +
4146     -4115     -    3593 +    3228 +     90 +  /* Secondary Set */
4147     -4116     -    3594 +    3229 +     91 +  --mermaid-secondary-color: #e0f2fe;
4148     -4117     -    3595 +    3230 +     92 +  --mermaid-secondary-text-color: #0c4a6e;
4149     -4118     -    3596 +    3231 +     93 +  --mermaid-secondary-border-color: #0891b2;
4150     -4119     -    3597 +    3232 +     94 +
4151     -4120     -    3598 +    3233 +     95 +  /* Tertiary Set */
4152     -4121     -    3599 +    3234 +     96 +  --mermaid-tertiary-color: #f0f9ff;
4153     -4122     -    3600 +    3235 +     97 +  --mermaid-tertiary-text-color: #0c4a6e;
4154     -4123     -    3601 +    3236 +     98 +  --mermaid-tertiary-border-color: #06b6d4;
4155     -4124     -    3602 +    3237 +     99 +
4156     -4125     -    3603 +    3238 +    100 +  /* Flowchart */
4157     -4126     -    3604 +    3239 +    101 +  --mermaid-node-border: #0284c7;
4158     -4127     -    3605 +    3240 +    102 +  --mermaid-cluster-bkg: #e0f2fe;
4159     -4128     -    3606 +    3241 +    103 +  --mermaid-cluster-border: #0891b2;
4160     -4129     -    3607 +    3242 +    104 +  --mermaid-default-link-color: #0891b2;
4161     -4130     -    3608 +    3243 +    105 +  --mermaid-title-color: #0c4a6e;
4162     -4131     -    3609 +    3244 +    106 +  --mermaid-edge-label-background: #f0f9ff;
4163     -4132     -    3610 +    3245 +    107 +  --mermaid-node-text-color: #0c4a6e;
4164     -4133     -    3611 +    3246 +    108 +
4165     -4134     -    3612 +    3247 +    109 +  /* Sequence Diagram */
4166     -4135     -    3613 +    3248 +    110 +  --mermaid-actor-bkg: #bae6fd;
4167     -4136     -    3614 +    3249 +    111 +  --mermaid-actor-border: #0284c7;
4168     -4137     -    3615 +    3250 +    112 +  --mermaid-actor-text-color: #0c4a6e;
4169     -4138     -    3616 +    3251 +    113 +  --mermaid-actor-line-color: #0284c7;
4170     -4139     -    3617 +    3252 +    114 +  --mermaid-signal-color: #0891b2;
4171     -4140     -    3618 +    3253 +    115 +  --mermaid-signal-text-color: #0c4a6e;
4172     -4141     -    3619 +    3254 +    116 +  --mermaid-label-box-bkg-color: #bae6fd;
4173     -4142     -    3620 +    3255 +    117 +  --mermaid-label-box-border-color: #0284c7;
4174     -4143     -    3621 +    3256 +    118 +  --mermaid-label-text-color: #0c4a6e;
4175     -4144     -    3622 +    3257 +    119 +  --mermaid-loop-text-color: #0c4a6e;
4176     -4145     -    3623 +    3258 +    120 +  --mermaid-activation-border-color: #0891b2;
4177     -4146     -    3624 +    3259 +    121 +  --mermaid-activation-bkg-color: #e0f2fe;
4178     -4147     -    3625 +    3260 +    122 +  --mermaid-sequence-number-color: #0c4a6e;
4179     -4148     -    3626 +    3261 +    123 +
4180     -4149     -    3627 +    3262 +    124 +  /* Pie Chart */
4181     -4150     -    3628 +    3263 +    125 +  --mermaid-pie1: #0284c7;
4182     -4151     -    3629 +    3264 +    126 +  --mermaid-pie2: #0891b2;
4183     -4152     -    3630 +    3265 +    127 +  --mermaid-pie3: #06b6d4;
4184     -4153     -    3631 +    3266 +    128 +  --mermaid-pie4: #22d3ee;
4185     -4154     -    3632 +    3267 +    129 +  --mermaid-pie5: #7c3aed;
4186     -4155     -    3633 +    3268 +    130 +  --mermaid-pie6: #f59e0b;
4187     -4156     -    3634 +    3269 +    131 +  --mermaid-pie7: #14b8a6;
4188     -4157     -    3635 +    3270 +    132 +  --mermaid-pie8: #0369a1;
4189     -4158     -    3636 +    3271 +    133 +  --mermaid-pie9: #0284c7;
4190     -4159     -    3637 +    3272 +    134 +  --mermaid-pie10: #0891b2;
4191     -4160     -    3638 +    3273 +    135 +  --mermaid-pie11: #06b6d4;
4192     -4161     -    3639 +    3274 +    136 +  --mermaid-pie12: #22d3ee;
4193     -4162     -    3640 +    3275 +    137 +  --mermaid-pie-title-text-color: #0c4a6e;
4194     -4163     -    3641 +    3276 +    138 +  --mermaid-pie-section-text-color: #f0f9ff; /* Light on vibrant slices */
4195     -4164     -    3642 +    3277 +    139 +  --mermaid-pie-legend-text-color: #0c4a6e;
4196     -4165     -    3643 +    3278 +    140 +  --mermaid-pie-stroke-color: #0284c7;
4197     -4166     -    3644 +    3279 +    141 +  --mermaid-pie-outer-stroke-color: #0284c7;
4198     -4167     -    3645 +    3280 +    142 +
4199     -4168     -    3646 +    3281 +    143 +  /* State Diagram */
4200     -4169     -    3647 +    3282 +    144 +  --mermaid-label-color: #0c4a6e;
4201     -4170     -    3648 +    3283 +    145 +  --mermaid-alt-background: #e0f2fe;
4202     -4171     -    3649 +    3284 +    146 +
4203     -4172     -    3650 +    3285 +    147 +  /* Class Diagram */
4204     -4173     -    3651 +    3286 +    148 +  --mermaid-class-text: #0c4a6e;
4205     -4174     -    3652 +    3287 +    149 +
4206     -4175     -    3653 +    3288 +    150 +  /* User Journey */
4207     -4176     -    3654 +    3289 +    151 +  --mermaid-fill-type0: #0284c7;
4208     -4177     -    3655 +    3290 +    152 +  --mermaid-fill-type1: #0891b2;
4209     -4178     -    3656 +    3291 +    153 +  --mermaid-fill-type2: #06b6d4;
4210     -4179     -    3657 +    3292 +    154 +  --mermaid-fill-type3: #22d3ee;
4211     -4180     -    3658 +    3293 +    155 +  --mermaid-fill-type4: #7c3aed;
4212     -4181     -    3659 +    3294 +    156 +  --mermaid-fill-type5: #f59e0b;
4213     -4182     -    3660 +    3295 +    157 +  --mermaid-fill-type6: #14b8a6;
4214     -4183     -    3661 +    3296 +    158 +  --mermaid-fill-type7: #0369a1;
4215     -4184     -    3662 +    3297 + 47 159  }
4216     -4185     -    3663 +    3298 + 48 160  
4217     -4186     -    3664 +363 3299  
4218     -4187     -    3665 +364 3300  ```
4219     -4188     -    3666 +365 3301  
4220     -4189     -    3667 +@@ -369,13 +3305,319 @@ memory-bank/activeContext.md |  52 +++++++++-
4221     -4190     -    3668 +369 3305  **Type:** Stylesheet üé®
4222     -4191     -    3669 +370 3306  
4223     -4192     -    3670 +371 3307  ```diff
4224     -4193     -    3671 +372     -@@ -1,4 +1,4 @@
4225     -4194     -    3672 +373     -  1     -r/* Sunset Dark Theme */
4226     -4195     -    3673 +374     -      1 +/* Sunset Dark Theme */
4227     -4196     -    3674 +375     -  2   2  :root {
4228     -4197     -    3675 +376     -  3   3    --bg-primary: #1c0a00;
4229     -4198     -    3676 +377     -  4   4    --bg-secondary: #2d1b0e;
4230     -4199     -    3677 +378     -  5   5  
4231     -4200     -    3678 +    3308 +@@ -23,20 +23,49 @@
4232     -4201     -    3679 +    3309 + 23  23    --code-block-bg: #1c0a00;
4233     -4202     -    3680 +    3310 + 24  24    --code-border: #7c2d12;
4234     -4203     -    3681 +    3311 + 25  25  
4235     -4204     -    3682 +    3312 + 26     -  /* Syntax Highlighting - Comprehensive Token Colors */
4236     -4205     -    3683 +    3313 + 27     -  --syntax-keyword: #fb923c;
4237     -4206     -    3684 +    3314 + 28     -  --syntax-string: #a3e635;
4238     -4207     -    3685 +    3315 + 29     -  --syntax-number: #fbbf24;
4239     -4208     -    3686 +    3316 + 30     -  --syntax-function: #f87171;
4240     -4209     -    3687 +    3317 + 31     -  --syntax-comment: #78716c;
4241     -4210     -    3688 +    3318 + 32     -  --syntax-operator: #fdba74;
4242     -4211     -    3689 +    3319 + 33     -  --syntax-punctuation: #d4d4d4;
4243     -4212     -    3690 +    3320 +     26 +  /* Syntax Highlighting - Production-Grade Token Colors (One Dark Architecture) */
4244     -4213     -    3691 +    3321 + 34  27  
4245     -4214     -    3692 +    3322 + 35     -  /* Additional Token Types */
4246     -4215     -    3693 +    3323 + 36     -  --syntax-variable: #fcd34d; /* Variables - bright yellow (distinct from text #fed7aa) */
4247     -4216     -    3694 +    3324 + 37     -  --syntax-property: #f87171; /* Properties - coral */
4248     -4217     -    3695 +    3325 + 38     -  --syntax-namespace: #fb923c; /* Namespaces - sunset orange */
4249     -4218     -    3696 +    3326 + 39     -  --syntax-builtin: #f87171; /* Builtins - coral */
4250     -4219     -    3697 +    3327 +     28 +  /* Core hue-1: Cyan (187¬∞) - URLs */
4251     -4220     -    3698 +    3328 +     29 +  --syntax-url: #5eead4; /* Bright teal for URLs */
4252     -4221     -    3699 +    3329 +     30 +
4253     -4222     -    3700 +    3330 +     31 +  /* Core hue-2: Blue (207¬∞) - Functions, variables */
4254     -4223     -    3701 +    3331 +     32 +  --syntax-function: #60a5fa; /* Bright blue for functions */
4255     -4224     -    3702 +    3332 +     33 +  --syntax-variable: #38bdf8; /* Sky blue for variables */
4256     -4225     -    3703 +    3333 +     34 +
4257     -4226     -    3704 +    3334 +     35 +  /* Core hue-3: Purple (286¬∞) - Keywords */
4258     -4227     -    3705 +    3335 +     36 +  --syntax-keyword: #c084fc; /* Bright purple for keywords (final, sealed, class keyword) */
4259     -4228     -    3706 +    3336 +     37 +
4260     -4229     -    3707 +    3337 +     38 +  /* Core hue-4: Green (95¬∞) - Strings, builtins */
4261     -4230     -    3708 +    3338 +     39 +  --syntax-string: #a3e635; /* Lime green for strings */
4262     -4231     -    3709 +    3339 +     40 +  --syntax-builtin: #84cc16; /* Vibrant green for builtins (String, List) */
4263     -4232     -    3710 +    3340 +     41 +  --syntax-char: #a3e635; /* Same as strings */
4264     -4233     -    3711 +    3341 +     42 +  --syntax-regex: #a3e635; /* Same as strings */
4265     -4234     -    3712 +    3342 +     43 +  --syntax-inserted: #a3e635; /* For diff */
4266     -4235     -    3713 +    3343 +     44 +
4267     -4236     -    3714 +    3344 +     45 +  /* Core hue-5: Red (355¬∞) - Properties, tags */
4268     -4237     -    3715 +    3345 +     46 +  --syntax-property: #fb7185; /* Coral rose for properties */
4269     -4238     -    3716 +    3346 +     47 +  --syntax-tag: #f87171; /* Coral for tags */
4270     -4239     -    3717 +    3347 +     48 +  --syntax-deleted: #f87171; /* For diff */
4271     -4240     -    3718 +    3348 +     49 +  --syntax-important: #fb7185; /* For !important */
4272     -4241     -    3719 +    3349 +     50 +
4273     -4242     -    3720 +    3350 +     51 +  /* Core hue-6: Orange (29¬∞) - Class names, constants, numbers */
4274     -4243     -    3721 +    3351 +     52 +  --syntax-class-name: #fb923c; /* Bright sunset orange for class names (Rectangle, Shape) */
4275     -4244     -    3722 +    3352 +     53 +  --syntax-number: #fbbf24; /* Golden yellow for numbers */
4276     -4245     -    3723 +    3353 +     54 +  --syntax-constant: #f97316; /* Burnt orange for constants */
4277     -4246     -    3724 +    3354 +     55 +  --syntax-boolean: #fbbf24; /* Same as numbers */
4278     -4247     -    3725 +    3355 +     56 +  --syntax-atrule: #fb923c; /* CSS @ rules */
4279     -4248     -    3726 +    3356 +     57 +
4280     -4249     -    3727 +    3357 +     58 +  /* Neutral colors */
4281     -4250     -    3728 +    3358 +     59 +  --syntax-comment: #a8a29e; /* Muted for comments */
4282     -4251     -    3729 +    3359 +     60 +  --syntax-punctuation: #d4d4d8; /* Light gray for punctuation */
4283     -4252     -    3730 +    3360 +     61 +  --syntax-operator: #fdba74; /* Light sunset for operators */
4284     -4253     -    3731 +    3361 +     62 +
4285     -4254     -    3732 +    3362 +     63 +  /* Markup specific */
4286     -4255     -    3733 +    3363 +     64 +  --syntax-attr-name: #fb923c; /* Orange like class-name */
4287     -4256     -    3734 +    3364 +     65 +  --syntax-attr-value: #a3e635; /* Green like strings */
4288     -4257     -    3735 +    3365 +     66 +  --syntax-namespace: #c084fc; /* Purple like keywords */
4289     -4258     -    3736 +    3366 +     67 +  --syntax-entity: #d4d4d8; /* Neutral */
4290     -4259     -    3737 +    3367 +     68 +  --syntax-selector: #fb7185; /* Red like properties */
4291     -4260     -    3738 +    3368 + 40  69  
4292     -4261     -    3739 +    3369 + 41  70    --blockquote-border: #f97316;
4293     -4262     -    3740 +    3370 + 42  71    --blockquote-bg: #2d1b0e;
4294     -4263     -    3741 +    3371 +@@ -44,4 +73,87 @@
4295     -4264     -    3742 +    3372 + 44  73    --italic-color: #fb923c;
4296     -4265     -    3743 +    3373 + 45  74    --table-header-bg: #3d2417;
4297     -4266     -    3744 +    3374 + 46  75    --table-border: #7c2d12;
4298     -4267     -    3745 +    3375 +     76 +
4299     -4268     -    3746 +    3376 +     77 +  /* === MERMAID COMPREHENSIVE CONFIGURATION === */
4300     -4269     -    3747 +    3377 +     78 +
4301     -4270     -    3748 +    3378 +     79 +  /* Core Global */
4302     -4271     -    3749 +    3379 +     80 +  --mermaid-background: #1c0a00;
4303     -4272     -    3750 +    3380 +     81 +  --mermaid-text-color: #fed7aa;
4304     -4273     -    3751 +    3381 +     82 +  --mermaid-line-color: #f97316;
4305     -4274     -    3752 +    3382 +     83 +  --mermaid-main-bkg: #3d2417;
4306     -4275     -    3753 +    3383 +     84 +
4307     -4276     -    3754 +    3384 +     85 +  /* Primary Set */
4308     -4277     -    3755 +    3385 +     86 +  --mermaid-primary-color: #3d2417;
4309     -4278     -    3756 +    3386 +     87 +  --mermaid-primary-text-color: #fed7aa;
4310     -4279     -    3757 +    3387 +     88 +  --mermaid-primary-border-color: #fb923c;
4311     -4280     -    3758 +    3388 +     89 +
4312     -4281     -    3759 +    3389 +     90 +  /* Secondary Set */
4313     -4282     -    3760 +    3390 +     91 +  --mermaid-secondary-color: #2d1b0e;
4314     -4283     -    3761 +    3391 +     92 +  --mermaid-secondary-text-color: #fed7aa;
4315     -4284     -    3762 +    3392 +     93 +  --mermaid-secondary-border-color: #f97316;
4316     -4285     -    3763 +    3393 +     94 +
4317     -4286     -    3764 +    3394 +     95 +  /* Tertiary Set */
4318     -4287     -    3765 +    3395 +     96 +  --mermaid-tertiary-color: #1c0a00;
4319     -4288     -    3766 +    3396 +     97 +  --mermaid-tertiary-text-color: #fed7aa;
4320     -4289     -    3767 +    3397 +     98 +  --mermaid-tertiary-border-color: #ea580c;
4321     -4290     -    3768 +    3398 +     99 +
4322     -4291     -    3769 +    3399 +    100 +  /* Flowchart */
4323     -4292     -    3770 +    3400 +    101 +  --mermaid-node-border: #fb923c;
4324     -4293     -    3771 +    3401 +    102 +  --mermaid-cluster-bkg: #2d1b0e;
4325     -4294     -    3772 +    3402 +    103 +  --mermaid-cluster-border: #f97316;
4326     -4295     -    3773 +    3403 +    104 +  --mermaid-default-link-color: #f97316;
4327     -4296     -    3774 +    3404 +    105 +  --mermaid-title-color: #fed7aa;
4328     -4297     -    3775 +    3405 +    106 +  --mermaid-edge-label-background: #1c0a00;
4329     -4298     -    3776 +    3406 +    107 +  --mermaid-node-text-color: #fed7aa;
4330     -4299     -    3777 +    3407 +    108 +
4331     -4300     -    3778 +    3408 +    109 +  /* Sequence Diagram */
4332     -4301     -    3779 +    3409 +    110 +  --mermaid-actor-bkg: #3d2417;
4333     -4302     -    3780 +    3410 +    111 +  --mermaid-actor-border: #fb923c;
4334     -4303     -    3781 +    3411 +    112 +  --mermaid-actor-text-color: #fed7aa;
4335     -4304     -    3782 +    3412 +    113 +  --mermaid-actor-line-color: #fb923c;
4336     -4305     -    3783 +    3413 +    114 +  --mermaid-signal-color: #f97316;
4337     -4306     -    3784 +    3414 +    115 +  --mermaid-signal-text-color: #fed7aa;
4338     -4307     -    3785 +    3415 +    116 +  --mermaid-label-box-bkg-color: #3d2417;
4339     -4308     -    3786 +    3416 +    117 +  --mermaid-label-box-border-color: #fb923c;
4340     -4309     -    3787 +    3417 +    118 +  --mermaid-label-text-color: #fed7aa;
4341     -4310     -    3788 +    3418 +    119 +  --mermaid-loop-text-color: #fed7aa;
4342     -4311     -    3789 +    3419 +    120 +  --mermaid-activation-border-color: #f97316;
4343     -4312     -    3790 +    3420 +    121 +  --mermaid-activation-bkg-color: #2d1b0e;
4344     -4313     -    3791 +    3421 +    122 +  --mermaid-sequence-number-color: #fed7aa;
4345     -4314     -    3792 +    3422 +    123 +
4346     -4315     -    3793 +    3423 +    124 +  /* Pie Chart */
4347     -4316     -    3794 +    3424 +    125 +  --mermaid-pie1: #fb923c;
4348     -4317     -    3795 +    3425 +    126 +  --mermaid-pie2: #f97316;
4349     -4318     -    3796 +    3426 +    127 +  --mermaid-pie3: #ea580c;
4350     -4319     -    3797 +    3427 +    128 +  --mermaid-pie4: #f87171;
4351     -4320     -    3798 +    3428 +    129 +  --mermaid-pie5: #fb7185;
4352     -4321     -    3799 +    3429 +    130 +  --mermaid-pie6: #f472b6;
4353     -4322     -    3800 +    3430 +    131 +  --mermaid-pie7: #fdba74;
4354     -4323     -    3801 +    3431 +    132 +  --mermaid-pie8: #5eead4;
4355     -4324     -    3802 +    3432 +    133 +  --mermaid-pie9: #60a5fa;
4356     -4325     -    3803 +    3433 +    134 +  --mermaid-pie10: #c084fc;
4357     -4326     -    3804 +    3434 +    135 +  --mermaid-pie11: #a3e635;
4358     -4327     -    3805 +    3435 +    136 +  --mermaid-pie12: #fbbf24;
4359     -4328     -    3806 +    3436 +    137 +  --mermaid-pie-title-text-color: #fed7aa;
4360     -4329     -    3807 +    3437 +    138 +  --mermaid-pie-section-text-color: #1c0a00; /* Dark on vibrant slices */
4361     -4330     -    3808 +    3438 +    139 +  --mermaid-pie-legend-text-color: #fed7aa;
4362     -4331     -    3809 +    3439 +    140 +  --mermaid-pie-stroke-color: #fb923c;
4363     -4332     -    3810 +    3440 +    141 +  --mermaid-pie-outer-stroke-color: #fb923c;
4364     -4333     -    3811 +    3441 +    142 +
4365     -4334     -    3812 +    3442 +    143 +  /* State Diagram */
4366     -4335     -    3813 +    3443 +    144 +  --mermaid-label-color: #fed7aa;
4367     -4336     -    3814 +    3444 +    145 +  --mermaid-alt-background: #2d1b0e;
4368     -4337     -    3815 +    3445 +    146 +
4369     -4338     -    3816 +    3446 +    147 +  /* Class Diagram */
4370     -4339     -    3817 +    3447 +    148 +  --mermaid-class-text: #fed7aa;
4371     -4340     -    3818 +    3448 +    149 +
4372     -4341     -    3819 +    3449 +    150 +  /* User Journey */
4373     -4342     -    3820 +    3450 +    151 +  --mermaid-fill-type0: #fb923c;
4374     -4343     -    3821 +    3451 +    152 +  --mermaid-fill-type1: #f97316;
4375     -4344     -    3822 +    3452 +    153 +  --mermaid-fill-type2: #ea580c;
4376     -4345     -    3823 +    3453 +    154 +  --mermaid-fill-type3: #f87171;
4377     -4346     -    3824 +    3454 +    155 +  --mermaid-fill-type4: #fb7185;
4378     -4347     -    3825 +    3455 +    156 +  --mermaid-fill-type5: #f472b6;
4379     -4348     -    3826 +    3456 +    157 +  --mermaid-fill-type6: #fdba74;
4380     -4349     -    3827 +    3457 +    158 +  --mermaid-fill-type7: #5eead4;
4381     -4350     -    3828 +    3458 + 47 159  }
4382     -4351     -    3829 +    3459 + 48 160  
4383     -4352     -    3830 +    3460 +
4384     -4353     -    3831 +    3461 +```
4385     -4354     -    3832 +    3462 +
4386     -4355     -    3833 +    3463 +
4387     -4356     -    3834 +    3464 +### üìÑ `themes/sunset-light.css`
4388     -4357     -    3835 +    3465 +
4389     -4358     -    3836 +    3466 +**Type:** Stylesheet üé®
4390     -4359     -    3837 +    3467 +
4391     -4360     -    3838 +    3468 +```diff
4392     -4361     -    3839 +    3469 +@@ -23,20 +23,49 @@
4393     -4362     -    3840 +    3470 + 23  23    --code-block-bg: #ffedd5; /* Light orange background */
4394     -4363     -    3841 +    3471 + 24  24    --code-border: #fdba74;
4395     -4364     -    3842 +    3472 + 25  25  
4396     -4365     -    3843 +    3473 + 26     -  /* Syntax Highlighting - Comprehensive Token Colors */
4397     -4366     -    3844 +    3474 + 27     -  --syntax-keyword: #ea580c;
4398     -4367     -    3845 +    3475 + 28     -  --syntax-string: #16a34a;
4399     -4368     -    3846 +    3476 + 29     -  --syntax-number: #f59e0b;
4400     -4369     -    3847 +    3477 + 30     -  --syntax-function: #dc2626;
4401     -4370     -    3848 +    3478 + 31     -  --syntax-comment: #78716c;
4402     -4371     -    3849 +    3479 + 32     -  --syntax-operator: #c2410c;
4403     -4372     -    3850 +    3480 + 33     -  --syntax-punctuation: #57534e;
4404     -4373     -    3851 +    3481 +     26 +  /* Syntax Highlighting - Production-Grade Token Colors (Based on One Dark Architecture) */
4405     -4374     -    3852 +    3482 + 34  27  
4406     -4375     -    3853 +    3483 + 35     -  /* Additional Token Types for Full Customization */
4407     -4376     -    3854 +    3484 + 36     -  --syntax-variable: #ea580c; /* Variables - sunset orange */
4408     -4377     -    3855 +    3485 + 37     -  --syntax-property: #dc2626; /* Properties - red */
4409     -4378     -    3856 +    3486 + 38     -  --syntax-namespace: #f97316; /* Namespaces - bright orange */
4410     -4379     -    3857 +    3487 + 39     -  --syntax-builtin: #dc2626; /* Builtins - red */
4411     -4380     -    3858 +    3488 +     28 +  /* Core hue-1: Cyan (187¬∞) - URLs, special strings */
4412     -4381     -    3859 +    3489 +     29 +  --syntax-url: #14b8a6; /* Teal/cyan for URLs */
4413     -4382     -    3860 +    3490 +     30 +
4414     -4383     -    3861 +    3491 +     31 +  /* Core hue-2: Blue (207¬∞) - Functions, variables, operators */
4415     -4384     -    3862 +    3492 +     32 +  --syntax-function: #3b82f6; /* Bright blue for functions */
4416     -4385     -    3863 +    3493 +     33 +  --syntax-variable: #0ea5e9; /* Sky blue for variables */
4417     -4386     -    3864 +    3494 +     34 +
4418     -4387     -    3865 +    3495 +     35 +  /* Core hue-3: Purple (286¬∞) - Keywords */
4419     -4388     -    3866 +    3496 +     36 +  --syntax-keyword: #a855f7; /* Vibrant purple for keywords (if, final, sealed) */
4420     -4389     -    3867 +    3497 +     37 +
4421     -4390     -    3868 +    3498 +     38 +  /* Core hue-4: Green (95¬∞) - Strings, builtins, inserted */
4422     -4391     -    3869 +    3499 +     39 +  --syntax-string: #10b981; /* Emerald green for strings */
4423     -4392     -    3870 +    3500 +     40 +  --syntax-builtin: #059669; /* Darker green for builtins (String, List, Array) */
4424     -4393     -    3871 +    3501 +     41 +  --syntax-char: #10b981; /* Same as strings */
4425     -4394     -    3872 +    3502 +     42 +  --syntax-regex: #10b981; /* Same as strings */
4426     -4395     -    3873 +    3503 +     43 +  --syntax-inserted: #10b981; /* For diff highlights */
4427     -4396     -    3874 +    3504 +     44 +
4428     -4397     -    3875 +    3505 +     45 +  /* Core hue-5: Red (355¬∞) - Properties, tags, deleted, important */
4429     -4398     -    3876 +    3506 +     46 +  --syntax-property: #ef4444; /* Red for properties */
4430     -4399     -    3877 +    3507 +     47 +  --syntax-tag: #ef4444; /* Red for HTML tags */
4431     -4400     -    3878 +    3508 +     48 +  --syntax-deleted: #ef4444; /* For diff highlights */
4432     -4401     -    3879 +    3509 +     49 +  --syntax-important: #ef4444; /* For !important */
4433     -4402     -    3880 +    3510 +     50 +
4434     -4403     -    3881 +    3511 +     51 +  /* Core hue-6: Orange (29¬∞) - Class names, constants, numbers, atrules */
4435     -4404     -    3882 +    3512 +     52 +  --syntax-class-name: #f97316; /* Orange for class/type names (Rectangle, Shape) */
4436     -4405     -    3883 +    3513 +     53 +  --syntax-number: #fb923c; /* Bright orange for numbers */
4437     -4406     -    3884 +    3514 +     54 +  --syntax-constant: #ea580c; /* Burnt orange for constants */
4438     -4407     -    3885 +    3515 +     55 +  --syntax-boolean: #fb923c; /* Same as numbers */
4439     -4408     -    3886 +    3516 +     56 +  --syntax-atrule: #fb923c; /* CSS @ rules */
4440     -4409     -    3887 +    3517 +     57 +
4441     -4410     -    3888 +    3518 +     58 +  /* Neutral colors */
4442     -4411     -    3889 +    3519 +     59 +  --syntax-comment: #a8a29e; /* Muted stone for comments */
4443     -4412     -    3890 +    3520 +     60 +  --syntax-punctuation: #64748b; /* Slate for punctuation */
4444     -4413     -    3891 +    3521 +     61 +  --syntax-operator: #fb7185; /* Coral rose for operators */
4445     -4414     -    3892 +    3522 +     62 +
4446     -4415     -    3893 +    3523 +     63 +  /* Markup specific */
4447     -4416     -    3894 +    3524 +     64 +  --syntax-attr-name: #f97316; /* Orange like class-name */
4448     -4417     -    3895 +    3525 +     65 +  --syntax-attr-value: #10b981; /* Green like strings */
4449     -4418     -    3896 +    3526 +     66 +  --syntax-namespace: #a855f7; /* Purple like keywords */
4450     -4419     -    3897 +    3527 +     67 +  --syntax-entity: #64748b; /* Neutral */
4451     -4420     -    3898 +    3528 +     68 +  --syntax-selector: #ef4444; /* Red like properties */
4452     -4421     -    3899 +    3529 + 40  69  
4453     -4422     -    3900 +    3530 + 41  70    --blockquote-border: #f97316;
4454     -4423     -    3901 +    3531 + 42  71    --blockquote-bg: #ffedd5;
4455     -4424     -    3902 +    3532 +@@ -44,4 +73,87 @@
4456     -4425     -    3903 +    3533 + 44  73    --italic-color: #e11d48;
4457     -4426     -    3904 +    3534 + 45  74    --table-header-bg: #fed7aa;
4458     -4427     -    3905 +    3535 + 46  75    --table-border: #fdba74;
4459     -4428     -    3906 +    3536 +     76 +
4460     -4429     -    3907 +    3537 +     77 +  /* === MERMAID COMPREHENSIVE CONFIGURATION === */
4461     -4430     -    3908 +    3538 +     78 +
4462     -4431     -    3909 +    3539 +     79 +  /* Core Global */
4463     -4432     -    3910 +    3540 +     80 +  --mermaid-background: #fff7ed;
4464     -4433     -    3911 +    3541 +     81 +  --mermaid-text-color: #431407;
4465     -4434     -    3912 +    3542 +     82 +  --mermaid-line-color: #f97316;
4466     -4435     -    3913 +    3543 +     83 +  --mermaid-main-bkg: #fed7aa;
4467     -4436     -    3914 +    3544 +     84 +
4468     -4437     -    3915 +    3545 +     85 +  /* Primary Set */
4469     -4438     -    3916 +    3546 +     86 +  --mermaid-primary-color: #fed7aa;
4470     -4439     -    3917 +    3547 +     87 +  --mermaid-primary-text-color: #431407;
4471     -4440     -    3918 +    3548 +     88 +  --mermaid-primary-border-color: #ea580c;
4472     -4441     -    3919 +    3549 +     89 +
4473     -4442     -    3920 +    3550 +     90 +  /* Secondary Set */
4474     -4443     -    3921 +    3551 +     91 +  --mermaid-secondary-color: #ffedd5;
4475     -4444     -    3922 +    3552 +     92 +  --mermaid-secondary-text-color: #431407;
4476     -4445     -    3923 +    3553 +     93 +  --mermaid-secondary-border-color: #f97316;
4477     -4446     -    3924 +    3554 +     94 +
4478     -4447     -    3925 +    3555 +     95 +  /* Tertiary Set */
4479     -4448     -    3926 +    3556 +     96 +  --mermaid-tertiary-color: #fff7ed;
4480     -4449     -    3927 +    3557 +     97 +  --mermaid-tertiary-text-color: #431407;
4481     -4450     -    3928 +    3558 +     98 +  --mermaid-tertiary-border-color: #fb923c;
4482     -4451     -    3929 +    3559 +     99 +
4483     -4452     -    3930 +    3560 +    100 +  /* Flowchart */
4484     -4453     -    3931 +    3561 +    101 +  --mermaid-node-border: #ea580c;
4485     -4454     -    3932 +    3562 +    102 +  --mermaid-cluster-bkg: #ffedd5;
4486     -4455     -    3933 +    3563 +    103 +  --mermaid-cluster-border: #f97316;
4487     -4456     -    3934 +    3564 +    104 +  --mermaid-default-link-color: #f97316;
4488     -4457     -    3935 +    3565 +    105 +  --mermaid-title-color: #431407;
4489     -4458     -    3936 +    3566 +    106 +  --mermaid-edge-label-background: #fff7ed;
4490     -4459     -    3937 +    3567 +    107 +  --mermaid-node-text-color: #431407;
4491     -4460     -    3938 +    3568 +    108 +
4492     -4461     -    3939 +    3569 +    109 +  /* Sequence Diagram */
4493     -4462     -    3940 +    3570 +    110 +  --mermaid-actor-bkg: #fed7aa;
4494     -4463     -    3941 +    3571 +    111 +  --mermaid-actor-border: #ea580c;
4495     -4464     -    3942 +    3572 +    112 +  --mermaid-actor-text-color: #431407;
4496     -4465     -    3943 +    3573 +    113 +  --mermaid-actor-line-color: #ea580c;
4497     -4466     -    3944 +    3574 +    114 +  --mermaid-signal-color: #f97316;
4498     -4467     -    3945 +    3575 +    115 +  --mermaid-signal-text-color: #431407;
4499     -4468     -    3946 +    3576 +    116 +  --mermaid-label-box-bkg-color: #fed7aa;
4500     -4469     -    3947 +    3577 +    117 +  --mermaid-label-box-border-color: #ea580c;
4501     -4470     -    3948 +    3578 +    118 +  --mermaid-label-text-color: #431407;
4502     -4471     -    3949 +    3579 +    119 +  --mermaid-loop-text-color: #431407;
4503     -4472     -    3950 +    3580 +    120 +  --mermaid-activation-border-color: #f97316;
4504     -4473     -    3951 +    3581 +    121 +  --mermaid-activation-bkg-color: #ffedd5;
4505     -4474     -    3952 +    3582 +    122 +  --mermaid-sequence-number-color: #431407;
4506     -4475     -    3953 +    3583 +    123 +
4507     -4476     -    3954 +    3584 +    124 +  /* Pie Chart */
4508     -4477     -    3955 +    3585 +    125 +  --mermaid-pie1: #ea580c;
4509     -4478     -    3956 +    3586 +    126 +  --mermaid-pie2: #f97316;
4510     -4479     -    3957 +    3587 +    127 +  --mermaid-pie3: #fb923c;
4511     -4480     -    3958 +    3588 +    128 +  --mermaid-pie4: #dc2626;
4512     -4481     -    3959 +    3589 +    129 +  --mermaid-pie5: #e11d48;
4513     -4482     -    3960 +    3590 +    130 +  --mermaid-pie6: #db2777;
4514     -4483     -    3961 +    3591 +    131 +  --mermaid-pie7: #c2410c;
4515     -4484     -    3962 +    3592 +    132 +  --mermaid-pie8: #14b8a6;
4516     -4485     -    3963 +    3593 +    133 +  --mermaid-pie9: #3b82f6;
4517     -4486     -    3964 +    3594 +    134 +  --mermaid-pie10: #a855f7;
4518     -4487     -    3965 +    3595 +    135 +  --mermaid-pie11: #ef4444;
4519     -4488     -    3966 +    3596 +    136 +  --mermaid-pie12: #10b981;
4520     -4489     -    3967 +    3597 +    137 +  --mermaid-pie-title-text-color: #431407;
4521     -4490     -    3968 +    3598 +    138 +  --mermaid-pie-section-text-color: #fff7ed; /* Light on vibrant slices */
4522     -4491     -    3969 +    3599 +    139 +  --mermaid-pie-legend-text-color: #431407;
4523     -4492     -    3970 +    3600 +    140 +  --mermaid-pie-stroke-color: #ea580c;
4524     -4493     -    3971 +    3601 +    141 +  --mermaid-pie-outer-stroke-color: #ea580c;
4525     -4494     -    3972 +    3602 +    142 +
4526     -4495     -    3973 +    3603 +    143 +  /* State Diagram */
4527     -4496     -    3974 +    3604 +    144 +  --mermaid-label-color: #431407;
4528     -4497     -    3975 +    3605 +    145 +  --mermaid-alt-background: #ffedd5;
4529     -4498     -    3976 +    3606 +    146 +
4530     -4499     -    3977 +    3607 +    147 +  /* Class Diagram */
4531     -4500     -    3978 +    3608 +    148 +  --mermaid-class-text: #431407;
4532     -4501     -    3979 +    3609 +    149 +
4533     -4502     -    3980 +    3610 +    150 +  /* User Journey */
4534     -4503     -    3981 +    3611 +    151 +  --mermaid-fill-type0: #ea580c;
4535     -4504     -    3982 +    3612 +    152 +  --mermaid-fill-type1: #f97316;
4536     -4505     -    3983 +    3613 +    153 +  --mermaid-fill-type2: #fb923c;
4537     -4506     -    3984 +    3614 +    154 +  --mermaid-fill-type3: #dc2626;
4538     -4507     -    3985 +    3615 +    155 +  --mermaid-fill-type4: #e11d48;
4539     -4508     -    3986 +    3616 +    156 +  --mermaid-fill-type5: #db2777;
4540     -4509     -    3987 +    3617 +    157 +  --mermaid-fill-type6: #c2410c;
4541     -4510     -    3988 +    3618 +    158 +  --mermaid-fill-type7: #14b8a6;
4542     -4511     -    3989 +    3619 + 47 159  }
4543     -4512     -    3990 +    3620 + 48 160  
4544     -4513     -    3991 +379 3621  
4545     -4514     -    3992 +380 3622  ```
4546     -4515     -    3993 +381 3623  
4547     -4516     -    3994 +@@ -421,4 +3663,4 @@ Please provide specific feedback on:
4548     -4517     -    3995 +421 3663  
4549     -4518     -    3996 +422 3664  ---
4550     -4519     -    3997 +423 3665  *Generated by AI Visual Code Review v2.0 - Unified Export Script*
4551     -4520     -    3998 +424     -*Files processed: 3/3 | Errors: 0 | Generated: 2025-12-07T02:57:20.361Z*
4552     -4521     -    3999 +    3666 +*Files processed: 18/18 | Errors: 0 | Generated: 2025-12-07T04:29:24.609Z*
4553     -4522     -    4000 +425 3667  
4554     -4523     -496 4001  
4555     -4524     -497 4002  ```
4556     -4525     -498 4003  
4557     -4526     -499 4004  
4558     -4527     -500     -### ‚ú® `docs/02-architecture/mermaid-theme-architecture.md` **[ADDED]**
4559     -4528     -    4005 +### ‚ú® `codebase_audit/audit_summary.md` **[ADDED]**
4560     -4529     -501 4006  
4561     -4530     -502 4007  **Status:** ‚úÖ **NEW FILE** - This file has been newly created
4562     -4531     -503 4008  
4563     -4532     -504 4009  **Type:** Documentation üìñ
4564     -4533     -505 4010  
4565     -4534     -506 4011  ```diff
4566     -4535     -507     -@@ -0,0 +1,208 @@
4567     -4536     -508     -      1 +# Mermaid Theme Architecture - Comprehensive Reference
4568     -4537     -    4012 +@@ -0,0 +1,49 @@
4569     -4538     -    4013 +      1 +# üìä Codebase Audit Summary
4570     -4539     -509 4014        2 +
4571     -4540     -510     -      3 +**Last Updated:** 12/7/2025
4572     -4541     -511     -      4 +**Source:** Official Mermaid.js theming documentation
4573     -4542     -512     -      5 +
4574     -4543     -513     -      6 +## Complete Mermaid Theme Variables
4575     -4544     -514     -      7 +
4576     -4545     -515     -      8 +### Core Global Variables
4577     -4546     -516     -      9 +
4578     -4547     -517     -     10 +| Variable     | Type       | Description                  | Default                        |
4579     -4548     -518     -     11 +| ------------ | ---------- | ---------------------------- | ------------------------------ |
4580     -4549     -519     -     12 +| `background` | Background | Page background              | `#f4f4f4`                      |
4581     -4550     -520     -     13 +| `fontFamily` | Text       | Font family                  | `trebuchet ms, verdana, arial` |
4582     -4551     -521     -     14 +| `fontSize`   | Text       | Font size                    | `16px`                         |
4583     -4552     -522     -     15 +| `darkMode`   | Boolean    | Affects color calculations   | `false`                        |
4584     -4553     -523     -     16 +| `textColor`  | Text       | General text over background | calculated                     |
4585     -4554     -524     -     17 +| `lineColor`  | Line       | Lines and connections        | calculated                     |
4586     -4555     -525     -     18 +| `mainBkg`    | Background | Main background for objects  | calculated                     |
4587     -4556     -    4015 +      3 +**Date:** 2025-12-09
4588     -4557     -    4016 +      4 +**Auditor:** CodeBaseGPT
4589     -4558     -    4017 +      5 +**Repository:** `markdown-viewer-app`
4590     -4559     -    4018 +      6 +
4591     -4560     -    4019 +      7 +---
4592     -4561     -    4020 +      8 +
4593     -4562     -    4021 +      9 +## üèÅ Executive Summary
4594     -4563     -    4022 +     10 +
4595     -4564     -    4023 +     11 +The `markdown-viewer-app` is a **Client-Side SPA** built with **Vanilla JavaScript**. It has a solid modular foundation (`Services` directory) but suffers from "Controller Bloat" in `script.js`.
4596     -4565     -    4024 +     12 +
4597     -4566     -    4025 +     13 +**Health Score:** üü° **C+ (Needs Attention)**
4598     -4567     -    4026 +     14 +
4599     -4568     -    4027 +     15 +- **Architecture:** ‚≠ê‚≠ê‚≠ê (3/5) - Good service separation, but monolithic controller.
4600     -4569     -    4028 +     16 +- **Security:** ‚≠ê (1/5) - **CRITICAL** Stored XSS vulnerability detected.
4601     -4570     -    4029 +     17 +- **Code Quality:** ‚≠ê‚≠ê‚≠ê (3/5) - Human-readable, but prone to race conditions.
4602     -4571     -    4030 +     18 +- **Documentation:** ‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê (5/5) - Excellent, comprehensive documentation.
4603     -4572     -526 4031       19 +
4604     -4573     -527     -     20 +### Primary/Secondary/Tertiary Color Sets
4605     -4574     -    4032 +     20 +---
4606     -4575     -528 4033       21 +
4607     -4576     -529     -     22 +Each set has 3 variables (background, text, border):
4608     -4577     -    4034 +     22 +## üìÇ Audit Artifacts
4609     -4578     -530 4035       23 +
4610     -4579     -531     -     24 +| Variable               | Type       | Description                |
4611     -4580     -532     -     25 +| ---------------------- | ---------- | -------------------------- |
4612     -4581     -533     -     26 +| `primaryColor`         | Background | Primary node background    |
4613     -4582     -534     -     27 +| `primaryTextColor`     | Text       | Text in primary nodes      |
4614     -4583     -535     -     28 +| `primaryBorderColor`   | Border     | Border for primary nodes   |
4615     -4584     -536     -     29 +| `secondaryColor`       | Background | Secondary node background  |
4616     -4585     -537     -     30 +| `secondaryTextColor`   | Text       | Text in secondary nodes    |
4617     -4586     -538     -     31 +| `secondaryBorderColor` | Border     | Border for secondary nodes |
4618     -4587     -539     -     32 +| `tertiaryColor`        | Background | Tertiary node background   |
4619     -4588     -540     -     33 +| `tertiaryTextColor`    | Text       | Text in tertiary nodes     |
4620     -4589     -541     -     34 +| `tertiaryBorderColor`  | Border     | Border for tertiary nodes  |
4621     -4590     -    4036 +     24 +1.  **[Repo Manifest](./repo_manifest.json)** - Full inventory of files.
4622     -4591     -    4037 +     25 +2.  **[Consolidated Findings](./phase4_consolidated_findings.md)** - High-level issue list.
4623     -4592     -    4038 +     26 +3.  **[Implementation Plan](./phase4_implementation_plan.md)** - Step-by-step roadmap.
4624     -4593     -    4039 +     27 +4.  **[Detailed Roadmap](./phase5_recommendations.md)** - Strategic recommendations.
4625     -4594     -    4040 +     28 +
4626     -4595     -    4041 +     29 +### üî¨ Deep Dive Reviews
4627     -4596     -    4042 +     30 +*   **[script.js Review](./deep_dive_reviews/script_js_review.md)** (Critical Issues)
4628     -4597     -    4043 +     31 +*   **[ThemeManager.js Review](./deep_dive_reviews/theme_manager_review.md)** (Performance Notes)
4629     -4598     -    4044 +     32 +*   **[MermaidService.js Review](./deep_dive_reviews/mermaid_service_review.md)** (Coupling Notes)
4630     -4599     -    4045 +     33 +
4631     -4600     -    4046 +     34 +---
4632     -4601     -542 4047       35 +
4633     -4602     -543     -     36 +### Flowchart-Specific Variables
4634     -4603     -    4048 +     36 +## üõë Top 3 Priorities
4635     -4604     -544 4049       37 +
4636     -4605     -545     -     38 +| Variable              | Type       | Description           |
4637     -4606     -546     -     39 +| --------------------- | ---------- | --------------------- |
4638     -4607     -547     -     40 +| `nodeBorder`          | Border     | Node border color     |
4639     -4608     -548     -     41 +| `clusterBkg`          | Background | Subgraph background   |
4640     -4609     -549     -     42 +| `clusterBorder`       | Border     | Subgraph border       |
4641     -4610     -550     -     43 +| `defaultLinkColor`    | Line       | Link/edge color       |
4642     -4611     -551     -     44 +| `titleColor`          | Text       | Title text color      |
4643     -4612     -552     -     45 +| `edgeLabelBackground` | Background | Edge label background |
4644     -4613     -553     -     46 +| `nodeTextColor`       | Text       | Text inside nodes     |
4645     -4614     -554     -     47 +
4646     -4615     -555     -     48 +### Sequence Diagram Variables
4647     -4616     -556     -     49 +
4648     -4617     -557     -     50 +| Variable                | Type       | Description           |
4649     -4618     -558     -     51 +| ----------------------- | ---------- | --------------------- |
4650     -4619     -559     -     52 +| `actorBkg`              | Background | Actor box background  |
4651     -4620     -560     -     53 +| `actorBorder`           | Border     | Actor box border      |
4652     -4621     -561     -     54 +| `actorTextColor`        | Text       | Actor text            |
4653     -4622     -562     -     55 +| `actorLineColor`        | Line       | Actor lifeline        |
4654     -4623     -563     -     56 +| `signalColor`           | Line       | Signal arrows         |
4655     -4624     -564     -     57 +| `signalTextColor`       | Text       | Signal labels         |
4656     -4625     -565     -     58 +| `labelBoxBkgColor`      | Background | Label box background  |
4657     -4626     -566     -     59 +| `labelBoxBorderColor`   | Border     | Label box border      |
4658     -4627     -567     -     60 +| `labelTextColor`        | Text       | Label text            |
4659     -4628     -568     -     61 +| `loopTextColor`         | Text       | Loop text             |
4660     -4629     -569     -     62 +| `activationBorderColor` | Border     | Activation border     |
4661     -4630     -570     -     63 +| `activationBkgColor`    | Background | Activation background |
4662     -4631     -571     -     64 +| `sequenceNumberColor`   | Text       | Sequence numbers      |
4663     -4632     -572     -     65 +
4664     -4633     -573     -     66 +### Pie Chart Variables
4665     -4634     -574     -     67 +
4666     -4635     -575     -     68 +| Variable              | Type       | Description                           |
4667     -4636     -576     -     69 +| --------------------- | ---------- | ------------------------------------- |
4668     -4637     -577     -     70 +| `pie1` - `pie12`      | Background | Fill colors for sections              |
4669     -4638     -578     -     71 +| `pieTitleTextSize`    | Text       | Title font size (default: `25px`)     |
4670     -4639     -579     -     72 +| `pieTitleTextColor`   | Text       | Title text color                      |
4671     -4640     -580     -     73 +| `pieSectionTextSize`  | Text       | Section label size (default: `17px`)  |
4672     -4641     -581     -     74 +| `pieSectionTextColor` | Text       | **Section label color (ON SLICES!)**  |
4673     -4642     -582     -     75 +| `pieLegendTextSize`   | Text       | Legend font size (default: `17px`)    |
4674     -4643     -583     -     76 +| `pieLegendTextColor`  | Text       | Legend text color                     |
4675     -4644     -584     -     77 +| `pieStrokeColor`      | Border     | Slice borders (default: `black`)      |
4676     -4645     -585     -     78 +| `pieStrokeWidth`      | Border     | Slice border width (default: `2px`)   |
4677     -4646     -586     -     79 +| `pieOuterStrokeWidth` | Border     | Outer circle width (default: `2px`)   |
4678     -4647     -587     -     80 +| `pieOuterStrokeColor` | Border     | Outer circle color (default: `black`) |
4679     -4648     -588     -     81 +| `pieOpacity`          | Visual     | Slice opacity (default: `0.7`)        |
4680     -4649     -589     -     82 +
4681     -4650     -590     -     83 +### State Diagram Variables
4682     -4651     -591     -     84 +
4683     -4652     -592     -     85 +| Variable        | Type       | Description                |
4684     -4653     -593     -     86 +| --------------- | ---------- | -------------------------- |
4685     -4654     -594     -     87 +| `labelColor`    | Text       | State label color          |
4686     -4655     -595     -     88 +| `altBackground` | Background | Composite state background |
4687     -4656     -596     -     89 +
4688     -4657     -597     -     90 +### Class Diagram Variables
4689     -4658     -598     -     91 +
4690     -4659     -599     -     92 +| Variable    | Type | Description      |
4691     -4660     -600     -     93 +| ----------- | ---- | ---------------- |
4692     -4661     -601     -     94 +| `classText` | Text | Class text color |
4693     -4662     -602     -     95 +
4694     -4663     -603     -     96 +### User Journey Variables
4695     -4664     -604     -     97 +
4696     -4665     -605     -     98 +| Variable                  | Type       | Description   |
4697     -4666     -606     -     99 +| ------------------------- | ---------- | ------------- |
4698     -4667     -607     -    100 +| `fillType0` - `fillType7` | Background | Section fills |
4699     -4668     -608     -    101 +
4700     -4669     -609     -    102 +## Critical Insights
4701     -4670     -610     -    103 +
4702     -4671     -611     -    104 +### 1. Pie Section Text Contrast Issue
4703     -4672     -612     -    105 +
4704     -4673     -613     -    106 +**Problem:** `pieSectionTextColor` is text **ON** the colored pie slices!
4705     -4674     -614     -    107 +
4706     -4675     -615     -    108 +- If slices are dark and text is dark ‚Üí **UNREADABLE**
4707     -4676     -616     -    109 +- If slices are light and text is light ‚Üí **UNREADABLE**
4708     -4677     -617     -    110 +
4709     -4678     -618     -    111 +**Solution:** `pieSectionTextColor` must contrast with `pie1-pie12` colors!
4710     -4679     -619     -    112 +
4711     -4680     -620     -    113 +### 2. Background vs Text Variables
4712     -4681     -621     -    114 +
4713     -4682     -622     -    115 +- **Background variables** (end with `Bkg`, `Color`, or are named `pie1-12`)
4714     -4683     -623     -    116 +- **Text variables** (contain `Text` or `textColor`)
4715     -4684     -624     -    117 +- **Border variables** (contain `Border` or `Stroke`)
4716     -4685     -625     -    118 +- **Line variables** (contain `Line` or `lineColor`)
4717     -4686     -626     -    119 +
4718     -4687     -627     -    120 +### 3. Calculated vs Explicit
4719     -4688     -628     -    121 +
4720     -4689     -629     -    122 +- Mermaid **calculates** many colors if not provided
4721     -4690     -630     -    123 +- But calculation may not match our theme aesthetics
4722     -4691     -631     -    124 +- **We should set ALL critical variables explicitly**
4723     -4692     -632     -    125 +
4724     -4693     -633     -    126 +## Implementation Strategy
4725     -4694     -634     -    127 +
4726     -4695     -635     -    128 +### For Each Theme, Define
4727     -4696     -636     -    129 +
4728     -4697     -637     -    130 +1. **Core Backgrounds** (3 levels for hierarchy)
4729     -4698     -638     -    131 +   - `primaryColor`, `secondaryColor`, `tertiaryColor`
4730     -4699     -639     -    132 +
4731     -4700     -640     -    133 +2. **All Text Colors** (must contrast with their backgrounds!)
4732     -4701     -641     -    134 +   - `primaryTextColor`, `secondaryTextColor`, `tertiaryTextColor`
4733     -4702     -642     -    135 +   - `nodeTextColor`, `actorTextColor`, `signalTextColor`
4734     -4703     -643     -    136 +   - `pieTitleTextColor`, `pieSectionTextColor`, `pieLegendTextColor`
4735     -4704     -644     -    137 +
4736     -4705     -645     -    138 +3. **All Border Colors** (visible against backgrounds)
4737     -4706     -646     -    139 +   - `primaryBorderColor`, `secondaryBorderColor`, `tertiaryBorderColor`
4738     -4707     -647     -    140 +   - `nodeBorder`, `actorBorder`, `clusterBorder`
4739     -4708     -648     -    141 +   - `pieStrokeColor`, `pieOuterStrokeColor`
4740     -4709     -649     -    142 +
4741     -4710     -650     -    143 +4. **Line/Connection Colors**
4742     -4711     -651     -    144 +   - `lineColor`, `defaultLinkColor`
4743     -4712     -652     -    145 +   - `signalColor`, `actorLineColor`
4744     -4713     -653     -    146 +
4745     -4714     -654     -    147 +5. **Pie Slice Backgrounds** (12 distinct colors)
4746     -4715     -655     -    148 +   - `pie1` through `pie12` - must be DISTINCT from text color!
4747     -4716     -656     -    149 +
4748     -4717     -657     -    150 +## Architecture Pattern
4749     -4718     -658     -    151 +
4750     -4719     -659     -    152 +```javascript
4751     -4720     -660     -    153 +mermaid.initialize({
4752     -4721     -661     -    154 +  theme: 'base',
4753     -4722     -662     -    155 +  themeVariables: {
4754     -4723     -663     -    156 +    // Core (affects ALL diagrams)
4755     -4724     -664     -    157 +    background: bgPrimary,
4756     -4725     -665     -    158 +    fontFamily: '...',
4757     -4726     -666     -    159 +    fontSize: '16px',
4758     -4727     -667     -    160 +
4759     -4728     -668     -    161 +    // Primary set (most nodes)
4760     -4729     -669     -    162 +    primaryColor: [BACKGROUND],
4761     -4730     -670     -    163 +    primaryTextColor: [TEXT - must contrast!],
4762     -4731     -671     -    164 +    primaryBorderColor: [BORDER - visible],
4763     -4732     -672     -    165 +
4764     -4733     -673     -    166 +    // Secondary set (clusters, special nodes)
4765     -4734     -674     -    167 +    secondaryColor: [BACKGROUND],
4766     -4735     -675     -    168 +    secondaryTextColor: [TEXT - must contrast!],
4767     -4736     -676     -    169 +    secondaryBorderColor: [BORDER - visible],
4768     -4737     -677     -    170 +
4769     -4738     -678     -    171 +    // Tertiary set (nested elements)
4770     -4739     -679     -    172 +    tertiaryColor: [BACKGROUND],
4771     -4740     -680     -    173 +    tertiaryTextColor: [TEXT - must contrast!],
4772     -4741     -681     -    174 +    tertiaryBorderColor: [BORDER - visible],
4773     -4742     -682     -    175 +
4774     -4743     -683     -    176 +    // Flowchart specific
4775     -4744     -684     -    177 +    nodeBorder: [VISIBLE],
4776     -4745     -685     -    178 +    nodeTextColor: [CONTRASTING],
4777     -4746     -686     -    179 +    edgeLabelBackground: [BACKGROUND],
4778     -4747     -687     -    180 +
4779     -4748     -688     -    181 +    // Sequence diagram specific
4780     -4749     -689     -    182 +    actorBkg: [BACKGROUND],
4781     -4750     -690     -    183 +    actorTextColor: [CONTRASTING],
4782     -4751     -691     -    184 +
4783     -4752     -692     -    185 +    // Pie chart specific
4784     -4753     -693     -    186 +    pie1-12: [12 DISTINCT COLORS],
4785     -4754     -694     -    187 +    pieSectionTextColor: [CONTRASTS WITH pie1-12!],
4786     -4755     -695     -    188 +
4787     -4756     -696     -    189 +    // Lines
4788     -4757     -697     -    190 +    lineColor: [VISIBLE],
4789     -4758     -698     -    191 +    signalColor: [VISIBLE],
4790     -4759     -699     -    192 +  }
4791     -4760     -700     -    193 +});
4792     -4761     -701     -    194 +```
4793     -4762     -702     -    195 +
4794     -4763     -703     -    196 +## Testing Checklist
4795     -4764     -704     -    197 +
4796     -4765     -705     -    198 +- [ ] Flowchart - nodes, clusters, edges readable
4797     -4766     -706     -    199 +- [ ] Sequence diagram - actors, signals, loops readable
4798     -4767     -707     -    200 +- [ ] Pie chart - slices, percentages, legend readable
4799     -4768     -708     -    201 +- [ ] State diagram - states, transitions readable
4800     -4769     -709     -    202 +- [ ] Class diagram - classes, methods readable
4801     -4770     -710     -    203 +- [ ] User journey - tasks, emotions readable
4802     -4771     -711     -    204 +
4803     -4772     -712     -    205 +## References
4804     -4773     -713     -    206 +
4805     -4774     -714     -    207 +- [Mermaid Theming Documentation](https://mermaid.js.org/config/theming.html)
4806     -4775     -715     -    208 +- [Base Theme Source](https://github.com/mermaid-js/mermaid/blob/develop/packages/mermaid/src/themes/theme-base.js)
4807     -4776     -716     -    209  
4808     -4777     -    4050 +     38 +1.  **üî• FIX:** Install `dompurify` and sanitize Markdown rendering immediately.
4809     -4778     -    4051 +     39 +2.  **üèóÔ∏è REFACTOR:** Break `script.js` into `UIManager`, `EventManager`, and `AppController`.
4810     -4779     -    4052 +     40 +3.  **üêõ BUG:** Replace `setTimeout` callbacks with `Promise` chains for robust rendering.
4811     -4780     -    4053 +     41 +
4812     -4781     -    4054 +     42 +---
4813     -4782     -    4055 +     43 +
4814     -4783     -    4056 +     44 +## üìù Next Steps
4815     -4784     -    4057 +     45 +
4816     -4785     -    4058 +     46 +Ready to begin **Phase 1 of Remediation**:
4817     -4786     -    4059 +     47 +> Executing `npm install dompurify` and patching `script.js` to fix the XSS vulnerability.
4818     -4787     -    4060 +     48 +
4819     -4788     -    4061 +     49 +**Proceed?**
4820     -4789     -    4062 +     50  
4821     -4790     -717 4063  
4822     -4791     -718 4064  ```
4823     -4792     -719 4065  
4824     -4793     -720 4066  
4825     -4794     -721     -### ‚ú® `docs/02-architecture/prism-token-architecture.md` **[ADDED]**
4826     -4795     -    4067 +### ‚ú® `codebase_audit/deep_dive_reviews/mermaid_service_review.md` **[ADDED]**
4827     -4796     -722 4068  
4828     -4797     -723 4069  **Status:** ‚úÖ **NEW FILE** - This file has been newly created
4829     -4798     -724 4070  
4830     -4799     -725 4071  **Type:** Documentation üìñ
4831     -4800     -726 4072  
4832     -4801     -727 4073  ```diff
4833     -4802     -728     -@@ -0,0 +1,226 @@
4834     -4803     -729     -      1 +# Prism Token Architecture - Comprehensive Reference
4835     -4804     -    4074 +@@ -0,0 +1,47 @@
4836     -4805     -    4075 +      1 +# üïµÔ∏è‚Äç‚ôÇÔ∏è Deep Dive Code Review: `MermaidService.js`
4837     -4806     -730 4076        2 +
4838     -4807     -731     -      3 +**Last Updated:** 12/7/2025
4839     -4808     -732     -      4 +**Source:** Official Prism.js documentation + One Dark theme analysis
4840     -4809     -733     -      5 +
4841     -4810     -734     -      6 +## Standard Token Classes
4842     -4811     -735     -      7 +
4843     -4812     -736     -      8 +### Core Language Constructs
4844     -4813     -737     -      9 +
4845     -4814     -738     -     10 +| Token Class   | Purpose                    | Example                                  | Recommended Color Hue             |
4846     -4815     -739     -     11 +| ------------- | -------------------------- | ---------------------------------------- | --------------------------------- |
4847     -4816     -740     -     12 +| `keyword`     | Reserved words             | `if`, `else`, `class`, `final`, `sealed` | Purple/Magenta (286¬∞)             |
4848     -4817     -741     -     13 +| `builtin`     | Built-in functions/types   | `String`, `Array`, `Console`             | Green (95¬∞)                       |
4849     -4818     -742     -     14 +| `class-name`  | Class/Interface/Type names | `Rectangle`, `Shape`, `Person`           | Orange (29¬∞)                      |
4850     -4819     -743     -     15 +| `function`    | Function/method names      | `main`, `println`, `forEach`             | Blue (207¬∞)                       |
4851     -4820     -744     -     16 +| `boolean`     | True/false values          | `true`, `false`                          | Orange (29¬∞)                      |
4852     -4821     -745     -     17 +| `number`      | Numeric literals           | `42`, `3.14`, `0xDEADBEEF`               | Orange (29¬∞)                      |
4853     -4822     -746     -     18 +| `string`      | String literals            | `"Hello"`, `'World'`                     | Green (95¬∞)                       |
4854     -4823     -747     -     19 +| `char`        | Character literals         | `'A'`, `'\n'`                            | Green (95¬∞)                       |
4855     -4824     -748     -     20 +| `symbol`      | Symbols (Smalltalk, Ruby)  | `:mySymbol`                              | Green (95¬∞)                       |
4856     -4825     -749     -     21 +| `regex`       | Regular expressions        | `/[a-z]+/i`                              | Green (95¬∞)                       |
4857     -4826     -750     -     22 +| `operator`    | Operators                  | `+`, `-`, `*`, `/`, `=`, `==`            | Purple (286¬∞)                     |
4858     -4827     -751     -     23 +| `variable`    | Variable names (special)   | Less/Bash variables                      | Blue (207¬∞)                       |
4859     -4828     -752     -     24 +| `constant`    | Constants                  | `PI`, `MAX_SIZE`, `stdout`               | Orange (29¬∞)                      |
4860     -4829     -753     -     25 +| `property`    | Object properties          | CSS properties, JSON keys                | Red (355¬∞)                        |
4861     -4830     -754     -     26 +| `punctuation` | Delimiters                 | `{`, `}`, `;`, `,`                       | Gray/White                        |
4862     -4831     -755     -     27 +| `comment`     | Code comments              | `// comment`, `/* block */`              | Muted gray (220¬∞, low saturation) |
4863     -4832     -    4077 +      3 +**Reviewer:** CodeBaseGPT (Senior SDE Persona)
4864     -4833     -    4078 +      4 +**Date:** 2025-12-09
4865     -4834     -    4079 +      5 +**File:** `src/js/services/MermaidService.js` (302 Lines)
4866     -4835     -    4080 +      6 +
4867     -4836     -    4081 +      7 +---
4868     -4837     -    4082 +      8 +
4869     -4838     -    4083 +      9 +## ‚ö†Ô∏è Issues & Observations
4870     -4839     -    4084 +     10 +
4871     -4840     -    4085 +     11 +### 1. ‚öôÔ∏è Massive Configuration Object (Line 96)
4872     -4841     -    4086 +     12 +```javascript
4873     -4842     -    4087 +     13 +themeVariables: { ... 100+ lines ... }
4874     -4843     -    4088 +     14 +```
4875     -4844     -    4089 +     15 +**Critique:** You are explicitly mapping every single Mermaid variable (60+) to your own CSS variables.
4876     -4845     -    4090 +     16 +- **Pros:** Total control over the look.
4877     -4846     -    4091 +     17 +- **Cons:** **High Coupling**. If Mermaid v12 changes its variable names (e.g., `primaryColor` -> `mainColor`), your integration breaks or looks wrong.
4878     -4847     -    4092 +     18 +- **Suggestion:** Consider whether mapped sets (Primary, Secondary, Tertiary) are sufficient, or if this granular control is truly business-critical.
4879     -4848     -    4093 +     19 +
4880     -4849     -    4094 +     20 +### 2. üî¢ Hardcoded Font configurations (Lines 99, 100)
4881     -4850     -    4095 +     21 +```javascript
4882     -4851     -    4096 +     22 +fontFamily: '-apple-system, ...',
4883     -4852     -    4097 +     23 +fontSize: '16px',
4884     -4853     -    4098 +     24 +```
4885     -4854     -    4099 +     25 +**Critique:** You are hardcoding fonts in JS.
4886     -4855     -    4100 +     26 +- **Issue:** If the user changes the font in `style.css`, the diagrams won't match the rest of the app.
4887     -4856     -    4101 +     27 +- **Fix:** Use `getCssVariable('--font-family')` and `getCssVariable('--font-size-base')`.
4888     -4857     -756 4102       28 +
4889     -4858     -757     -     29 +### Markup-Specific Tokens
4890     -4859     -    4103 +     29 +### 3. üìâ Missing Debounce/Cancellation
4891     -4860     -    4104 +     30 +**Critique:** `MermaidService.render` is async.
4892     -4861     -    4105 +     31 +- **Scenario:** User types fast. `render('id', 'graph TD...')` is called 5 times in 200ms.
4893     -4862     -    4106 +     32 +- **Result:** You might have 5 parallel rendering processes competing.
4894     -4863     -    4107 +     33 +- **Fix:** Implement a `Cancellation` mechanism or rely on the Controller to debounce calls (which `script.js` currently fails to do properly).
4895     -4864     -    4108 +     34 +
4896     -4865     -    4109 +     35 +### 4. üé≠ Theme Detection Logic (Line 45)
4897     -4866     -    4110 +     36 +```javascript
4898     -4867     -    4111 +     37 +function isLightTheme(bgColor) { ... }
4899     -4868     -    4112 +     38 +```
4900     -4869     -    4113 +     39 +**Critique:** Clever use of luminance calculation!
4901     -4870     -    4114 +     40 +- **Positive:** This is a nice "Senior Dev" touch. It ensures that even if I pick a weird Custom Theme color (e.g., bright yellow background), Mermaid will likely pick the correct "Dark/Light" base mode.
4902     -4871     -    4115 +     41 +- **Refactor:** Move `getRelativeLuminance` to `src/js/utils/colorHelpers.js`. It is a pure utility function and might be useful elsewhere (e.g., checking text contrast accessibility).
4903     -4872     -    4116 +     42 +
4904     -4873     -    4117 +     43 +---
4905     -4874     -    4118 +     44 +
4906     -4875     -    4119 +     45 +## üèÅ Verdict
4907     -4876     -    4120 +     46 +**Grade: B+**
4908     -4877     -    4121 +     47 +The logic is solid, but the coupling to Mermaid's specific variable names is a risk. It's "Enterprise Grade" in the sense that it handles everything, but "Enterprise Grade" also means "Heavy maintenance".
4909     -4878     -    4122 +     48  
4910     -4879     -    4123 +
4911     -4880     -    4124 +```
4912     -4881     -    4125 +
4913     -4882     -    4126 +
4914     -4883     -    4127 +### ‚ú® `codebase_audit/deep_dive_reviews/script_js_review.md` **[ADDED]**
4915     -4884     -    4128 +
4916     -4885     -    4129 +**Status:** ‚úÖ **NEW FILE** - This file has been newly created
4917     -4886     -    4130 +
4918     -4887     -    4131 +**Type:** Documentation üìñ
4919     -4888     -    4132 +
4920     -4889     -    4133 +```diff
4921     -4890     -    4134 +@@ -0,0 +1,121 @@
4922     -4891     -    4135 +      1 +# üïµÔ∏è‚Äç‚ôÇÔ∏è Deep Dive Code Review: `script.js`
4923     -4892     -    4136 +      2 +
4924     -4893     -    4137 +      3 +**Reviewer:** CodeBaseGPT (Senior SDE Persona)
4925     -4894     -    4138 +      4 +**Date:** 2025-12-09
4926     -4895     -    4139 +      5 +**File:** `script.js` (1372 Lines)
4927     -4896     -    4140 +      6 +
4928     -4897     -    4141 +      7 +---
4929     -4898     -    4142 +      8 +
4930     -4899     -    4143 +      9 +## üõë Critical Issues (Must Fix)
4931     -4900     -    4144 +     10 +
4932     -4901     -    4145 +     11 +### 1. üíÄ Stored XSS Vulnerability (Line 512)
4933     -4902     -    4146 +     12 +```javascript
4934     -4903     -    4147 +     13 +preview.innerHTML = html;
4935     -4904     -    4148 +     14 +```
4936     -4905     -    4149 +     15 +**Critique:** You are taking the output of `marked.parse()` and dumping it directly into the DOM. `marked` does **not** sanitize HTML execution by default.
4937     -4906     -    4150 +     16 +- **Scenario:** A user opens a markdown file containing `<img src=x onerror=alert(1)>`.
4938     -4907     -    4151 +     17 +- ** Impact:** Arbitrary code execution.
4939     -4908     -    4152 +     18 +- **Fix:** You **MUST** use `DOMPurify.sanitize(html)` before assignment.
4940     -4909     -    4153 +     19 +
4941     -4910     -    4154 +     20 +### 2. üê¢ recursive Polling for Dependencies (Lines 46-75)
4942     -4911     -    4155 +     21 +```javascript
4943     -4912     -    4156 +     22 +if (typeof marked === 'undefined' ...) {
4944     -4913     -    4157 +     23 +    setTimeout(initializeApp, 100);
4945     -4914     -    4158 +     24 +    return;
4946     -4915     -    4159 +     25 +}
4947     -4916     -    4160 +     26 +```
4948     -4917     -    4161 +     27 +**Critique:** This "check and retry" pattern is an anti-pattern.
4949     -4918     -    4162 +     28 +- **Why:** It burns CPU in a tight loop. It complicates the startup race conditions.
4950     -4919     -    4163 +     29 +- **Fix:** Use standard `<script defer>` or ES Module `import` statements to guarantee execution order. If you strictly need globals, use `window.onload`.
4951     -4920     -758 4164       30 +
4952     -4921     -759     -     31 +| Token Class  | Purpose             | Example                     |
4953     -4922     -760     -     32 +| ------------ | ------------------- | --------------------------- |
4954     -4923     -761     -     33 +| `tag`        | HTML/XML tags       | `<div>`, `<p>`              |
4955     -4924     -762     -     34 +| `attr-name`  | Attribute names     | `id`, `class`, `href`       |
4956     -4925     -763     -     35 +| `attr-value` | Attribute values    | `"header"`, `"https://..."` |
4957     -4926     -764     -     36 +| `namespace`  | XML namespaces      | `html:p`, `foo:bar`         |
4958     -4927     -765     -     37 +| `prolog`     | XML prolog          | `<?xml version="1.0"?>`     |
4959     -4928     -766     -     38 +| `doctype`    | DOCTYPE declaration | `<!DOCTYPE html>`           |
4960     -4929     -767     -     39 +| `cdata`      | CDATA sections      | `<![CDATA[...]]>`           |
4961     -4930     -768     -     40 +| `entity`     | HTML entities       | `&amp;`, `&#x2665;`         |
4962     -4931     -769     -     41 +
4963     -4932     -770     -     42 +### Document Markup Tokens
4964     -4933     -771     -     43 +
4965     -4934     -772     -     44 +| Token Class | Purpose         | Example      |
4966     -4935     -773     -     45 +| ----------- | --------------- | ------------ |
4967     -4936     -774     -     46 +| `bold`      | Bold text       | `**bold**`   |
4968     -4937     -775     -     47 +| `italic`    | Italic text     | `*italic*`   |
4969     -4938     -776     -     48 +| `important` | Important (CSS) | `!important` |
4970     -4939     -777     -     49 +
4971     -4940     -778     -     50 +### Stylesheet Tokens
4972     -4941     -779     -     51 +
4973     -4942     -780     -     52 +| Token Class | Purpose       | Example                  |
4974     -4943     -781     -     53 +| ----------- | ------------- | ------------------------ |
4975     -4944     -782     -     54 +| `atrule`    | CSS @ rules   | `@media`, `@import`      |
4976     -4945     -783     -     55 +| `selector`  | CSS selectors | `.class`, `#id`, `div p` |
4977     -4946     -784     -     56 +| `url`       | URLs          | `url(image.png)`         |
4978     -4947     -785     -     57 +
4979     -4948     -786     -     58 +### Diff Tokens
4980     -4949     -787     -     59 +
4981     -4950     -788     -     60 +| Token Class | Purpose       |
4982     -4951     -789     -     61 +| ----------- | ------------- |
4983     -4952     -790     -     62 +| `inserted`  | Added lines   |
4984     -4953     -791     -     63 +| `deleted`   | Removed lines |
4985     -4954     -792     -     64 +
4986     -4955     -793     -     65 +## Professional Theme Analysis (One Dark)
4987     -4956     -794     -     66 +
4988     -4957     -795     -     67 +### Color Grouping Strategy
4989     -4958     -796     -     68 +
4990     -4959     -797     -     69 +One Dark uses **7 core hues** systematically:
4991     -4960     -798     -     70 +
4992     -4961     -799     -     71 +1. **mono-1** (220¬∞, 14%, 71%) - Default text
4993     -4962     -800     -     72 +2. **mono-2** (220¬∞, 9%, 55%) - Secondary text
4994     -4963     -801     -     73 +3. **mono-3** (220¬∞, 10%, 40%) - Comments
4995     -4964     -802     -     74 +4. **hue-1** (187¬∞, 47%, 55%) - Cyan - URLs
4996     -4965     -803     -     75 +5. **hue-2** (207¬∞, 82%, 66%) - Blue - Variables, operators, functions
4997     -4966     -804     -     76 +6. **hue-3** (286¬∞, 60%, 67%) - Purple - Keywords
4998     -4967     -805     -     77 +7. **hue-4** (95¬∞, 38%, 62%) - Green - Strings
4999     -4968     -806     -     78 +8. **hue-5** (355¬∞, 65%, 65%) - Red - Properties, tags, symbols
5000     -4969     -807     -     79 +9. **hue-6** (29¬∞, 54%, 61%) - Orange - Class names, constants, numbers
5001     -4970     -808     -     80 +
5002     -4971     -809     -     81 +### Token Grouping
5003     -4972     -810     -     82 +
5004     -4973     -811     -     83 +```css
5005     -4974     -812     -     84 +/* Group 1: Comments */
5006     -4975     -813     -     85 +.token.comment, .token.prolog, .token.cdata
5007     -4976     -814     -     86 +
5008     -4977     -815     -     87 +/* Group 2: Neutral (inherit default color) */
5009     -4978     -816     -     88 +.token.doctype, .token.punctuation, .token.entity
5010     -4979     -817     -     89 +
5011     -4980     -818     -     90 +/* Group 3: Orange - Class names, constants, numbers */
5012     -4981     -819     -     91 +.token.attr-name, .token.class-name, .token.boolean,
5013     -4982     -820     -     92 +.token.constant, .token.number, .token.atrule
5014     -4983     -821     -     93 +
5015     -4984     -822     -     94 +/* Group 4: Purple - Keywords */
5016     -4985     -823     -     95 +.token.keyword
5017     -4986     -824     -     96 +
5018     -4987     -825     -     97 +/* Group 5: Red - Properties, tags */
5019     -4988     -826     -     98 +.token.property, .token.tag, .token.symbol,
5020     -4989     -827     -     99 +.token.deleted, .token.important
5021     -4990     -828     -    100 +
5022     -4991     -829     -    101 +/* Group 6: Green - Strings, builtins */
5023     -4992     -830     -    102 +.token.selector, .token.string, .token.char,
5024     -4993     -831     -    103 +.token.builtin, .token.inserted, .token.regex,
5025     -4994     -832     -    104 +.token.attr-value
5026     -4995     -833     -    105 +
5027     -4996     -834     -    106 +/* Group 7: Blue - Variables, operators, functions */
5028     -4997     -835     -    107 +.token.variable, .token.operator, .token.function
5029     -4998     -836     -    108 +
5030     -4999     -837     -    109 +/* Group 8: Cyan - URLs */
5031     -5000     -838     -    110 +.token.url
5032     -5001     -839     -    111 +```
5033     -5002     -840     -    112 +
5034     -5003     -841     -    113 +### Language-Specific Overrides
5035     -5004     -842     -    114 +
5036     -5005     -843     -    115 +Professional themes use **cascading specificity** for language-specific rules:
5037     -5006     -844     -    116 +
5038     -5007     -845     -    117 +```css
5039     -5008     -846     -    118 +/* JavaScript overrides */
5040     -5009     -847     -    119 +.language-javascript .token.operator { color: purple; }
5041     -5010     -848     -    120 +.language-javascript .token.template-string > .token.interpolation { ... }
5042     -5011     -849     -    121 +
5043     -5012     -850     -    122 +/* CSS overrides */
5044     -5013     -851     -    123 +.language-css .token.selector { color: red; }
5045     -5014     -852     -    124 +.language-css .token.property { color: gray; }
5046     -5015     -853     -    125 +
5047     -5016     -854     -    126 +/* JSON overrides */
5048     -5017     -855     -    127 +.language-json .token.null.keyword { color: orange; }
5049     -5018     -856     -    128 +
5050     -5019     -857     -    129 +/* Markdown overrides */
5051     -5020     -858     -    130 +.language-markdown .token.url { ... }
5052     -5021     -859     -    131 +```
5053     -5022     -860     -    132 +
5054     -5023     -861     -    133 +## Implementation Architecture
5055     -5024     -862     -    134 +
5056     -5025     -863     -    135 +### CSS Specificity Levels
5057     -5026     -864     -    136 +
5058     -5027     -865     -    137 +1. **Base tokens** - All languages
5059     -5028     -866     -    138 +2. **Language-specific overrides** - `.language-xxx .token.yyy`
5060     -5029     -867     -    139 +3. **Nested tokens** - `.token.xxx > .token.yyy`
5061     -5030     -868     -    140 +4. **Plugin overrides** - `.rainbow-braces`, `.diff-highlight`, etc.
5062     -5031     -869     -    141 +
5063     -5032     -870     -    142 +### Variable Mapping Strategy
5064     -5033     -871     -    143 +
5065     -5034     -872     -    144 +```css
5066     -5035     -873     -    145 +/* Map standard Prism tokens to theme CSS variables */
5067     -5036     -874     -    146 +.token.keyword {
5068     -5037     -875     -    147 +  color: var(--syntax-keyword);
5069     -5038     -876     -    148 +}
5070     -5039     -877     -    149 +.token.string {
5071     -5040     -878     -    150 +  color: var(--syntax-string);
5072     -5041     -879     -    151 +}
5073     -5042     -880     -    152 +.token.class-name {
5074     -5043     -881     -    153 +  color: var(--syntax-class-name); /* Distinct variable! */
5075     -5044     -882     -    154 +}
5076     -5045     -883     -    155 +```
5077     -5046     -884     -    156 +
5078     -5047     -885     -    157 +### Token Aliases
5079     -5048     -886     -    158 +
5080     -5049     -887     -    159 +Prism uses aliases to group similar tokens:
5081     -5050     -888     -    160 +
5082     -5051     -889     -    161 +- `attr-value` can contain nested `punctuation` tokens
5083     -5052     -890     -    162 +- `template-string` can contain `interpolation` with nested tokens
5084     -5053     -891     -    163 +- Language definitions use `alias` property to inherit styles
5085     -5054     -892     -    164 +
5086     -5055     -893     -    165 +## Best Practices
5087     -5056     -894     -    166 +
5088     -5057     -895     -    167 +1. **Use Distinct Variables** - Don't reuse variables across semantically different tokens
5089     -5058     -896     -    168 +2. **Follow Standards** - Match Prism's standard token names
5090     -5059     -897     -    169 +3. **Language Overrides** - Use when default grouping doesn't fit
5091     -5060     -898     -    170 +4. **Test Comprehensively** - Verify with multiple languages (Java, Python, JS, CSS, etc.)
5092     -5061     -899     -    171 +5. **Font Weight** - Use bold/normal strategically for visual hierarchy
5093     -5062     -900     -    172 +6. **Color Contrast** - Ensure WCAG AA compliance (4.5:1 for text)
5094     -5063     -901     -    173 +
5095     -5064     -902     -    174 +## Token Coverage Checklist
5096     -5065     -903     -    175 +
5097     -5066     -904     -    176 +### Must Cover (Core)
5098     -5067     -905     -    177 +
5099     -5068     -906     -    178 +- [ ] keyword
5100     -5069     -907     -    179 +- [ ] builtin
5101     -5070     -908     -    180 +- [ ] class-name (distinct from keyword!)
5102     -5071     -909     -    181 +- [ ] function
5103     -5072     -910     -    182 +- [ ] string
5104     -5073     -911     -    183 +- [ ] number
5105     -5074     -912     -    184 +- [ ] boolean
5106     -5075     -913     -    185 +- [ ] comment
5107     -5076     -914     -    186 +- [ ] operator
5108     -5077     -915     -    187 +- [ ] punctuation
5109     -5078     -916     -    188 +- [ ] variable
5110     -5079     -917     -    189 +- [ ] property
5111     -5080     -918     -    190 +- [ ] constant
5112     -5081     -919     -    191 +- [ ] regex
5113     -5082     -920     -    192 +
5114     -5083     -921     -    193 +### Markup Languages
5115     -5084     -922     -    194 +
5116     -5085     -923     -    195 +- [ ] tag
5117     -5086     -924     -    196 +- [ ] attr-name
5118     -5087     -925     -    197 +- [ ] attr-value
5119     -5088     -926     -    198 +- [ ] namespace
5120     -5089     -927     -    199 +- [ ] doctype
5121     -5090     -928     -    200 +- [ ] entity
5122     -5091     -929     -    201 +
5123     -5092     -930     -    202 +### Advanced
5124     -5093     -931     -    203 +
5125     -5094     -932     -    204 +- [ ] atrule (CSS)
5126     -5095     -933     -    205 +- [ ] selector (CSS)
5127     -5096     -934     -    206 +- [ ] url
5128     -5097     -935     -    207 +- [ ] inserted/deleted (Diff)
5129     -5098     -936     -    208 +- [ ] bold/italic (Markdown)
5130     -5099     -937     -    209 +- [ ] important (CSS)
5131     -5100     -938     -    210 +
5132     -5101     -939     -    211 +## Implementation Checklist
5133     -5102     -940     -    212 +
5134     -5103     -941     -    213 +- [ ] Define comprehensive CSS variable palette (8-10 distinct hues)
5135     -5104     -942     -    214 +- [ ] Map ALL standard tokens to variables
5136     -5105     -943     -    215 +- [ ] Add language-specific overrides where needed
5137     -5106     -944     -    216 +- [ ] Test with Java (most complex token usage)
5138     -5107     -945     -    217 +- [ ] Test with Python, JavaScript, CSS
5139     -5108     -946     -    218 +- [ ] Verify font-weight hierarchy
5140     -5109     -947     -    219 +- [ ] Check color contrast ratios
5141     -5110     -948     -    220 +- [ ] Document color semantics
5142     -5111     -949     -    221 +
5143     -5112     -950     -    222 +## References
5144     -5113     -951     -    223 +
5145     -5114     -952     -    224 +- [Prism Standard Tokens](https://prismjs.com/tokens.html)
5146     -5115     -953     -    225 +- [Prism Theme: One Dark](https://github.com/PrismJS/prism-themes/blob/master/themes/prism-one-dark.css)
5147     -5116     -954     -    226 +- [Atom One Dark Colors](https://github.com/atom/atom/tree/master/packages/one-dark-syntax)
5148     -5117     -955     -    227  
5149     -5118     -956     -
5150     -5119     -957     -```
5151     -5120     -958     -
5152     -5121     -959     -
5153     -5122     -960     -### üìÑ `script.js`
5154     -5123     -961     -
5155     -5124     -962     -**Type:** JavaScript Source File üü®
5156     -5125     -963     -
5157     -5126     -964     -```diff
5158     -5127     -965     -@@ -20,9 +20,20 @@ const folderBrowserService = new FolderBrowserService(storageManager);
5159     -5128     -966     - 20  20  const currentFolderFiles = [];
5160     -5129     -967     - 21  21  const currentFileHandle = null;
5161     -5130     -968     - 22  22  
5162     -5131     -969     - 23     -// Configure theme change listener to update Mermaid
5163     -5132     -970     -     23 +// Global render function reference (will be set in setupEditor)
5164     -5133     -971     -     24 +let globalRenderMarkdown = null;
5165     -5134     -972     -     25 +
5166     -5135     -973     -     26 +// Configure theme change listener to update Mermaid and force re-render
5167     -5136     -974     - 24  27  themeManager.setThemeChangeListener(() => {
5168     -5137     -975     - 25  28    mermaidService.reinitialize();
5169     -5138     -976     -     29 +
5170     -5139     -977     -     30 +  // Force re-render of markdown to apply new Mermaid colors
5171     -5140     -978     -     31 +  setTimeout(() => {
5172     -5141     -979     -     32 +    if (globalRenderMarkdown) {
5173     -5142     -980     -     33 +      console.log('üîÑ Re-rendering diagrams with new theme colors');
5174     -5143     -981     -     34 +      globalRenderMarkdown();
5175     -5144     -982     -     35 +    }
5176     -5145     -983     -     36 +  }, 200);
5177     -5146     -984     - 26  37  });
5178     -5147     -985     - 27  38  
5179     -5148     -986     - 28  39  // Wait for all scripts to load
5180     -5149     -987     -@@ -77,8 +88,8 @@ function initializeApp() {
5181     -5150     -988     - 77  88    // Configure marked.js extensions
5182     -5151     -989     - 78  89    configureMarkedExtensions();
5183     -5152     -990     - 79  90  
5184     -5153     -991     - 80     -  // Initialize Mermaid with theme-aware configuration
5185     -5154     -992     - 81     -  initMermaidTheme();
5186     -5155     -993     -     91 +  // DON'T initialize Mermaid here - let saved theme load first
5187     -5156     -994     -     92 +  // Mermaid will initialize after theme loads in setupEditor()
5188     -5157     -995     - 82  93  
5189     -5158     -996     - 83  94    setupEditor();
5190     -5159     -997     - 84  95  }
5191     -5160     -998     -@@ -461,7 +472,7 @@ graph TD
5192     -5161     -999     -461 472  
5193     -5162     -1000     -462 473    console.log('‚úÖ Subscript and superscript enabled (LaTeX environments display as-is)');
5194     -5163     -1001     -463 474  
5195     -5164     -1002     -464     -  // Render markdown
5196     -5165     -1003     -    475 +  // Render markdown (expose globally for theme changes)
5197     -5166     -1004     -465 476    function renderMarkdown() {
5198     -5167     -1005     -466 477      try {
5199     -5168     -1006     -467 478        const markdownText = editor.value;
5200     -5169     -1007     -@@ -520,8 +531,16 @@ graph TD
5201     -5170     -1008     -520 531    async function changeTheme(themeName) {
5202     -5171     -1009     -521 532      await themeManager.loadTheme(themeName);
5203     -5172     -1010     -522 533  
5204     -5173     -1011     -523     -    // Re-render to apply new Mermaid theme (observer already handles reinit)
5205     -5174     -1012     -    534 +    // Wait for theme to load, then reinitialize Mermaid and force re-render
5206     -5175     -1013     -524 535      setTimeout(() => {
5207     -5176     -1014     -    536 +      // Clear existing Mermaid diagrams to force fresh render with new colors
5208     -5177     -1015     -    537 +      const mermaidElements = preview.querySelectorAll('.mermaid');
5209     -5178     -1016     -    538 +      mermaidElements.forEach(el => {
5210     -5179     -1017     -    539 +        // Reset to original code to force re-render
5211     -5180     -1018     -    540 +        el.innerHTML = el.dataset.originalCode || '';
5212     -5181     -1019     -    541 +      });
5213     -5182     -1020     -    542 +
5214     -5183     -1021     -    543 +      // Re-render markdown with new theme
5215     -5184     -1022     -525 544        renderMarkdown();
5216     -5185     -1023     -526 545      }, 100);
5217     -5186     -1024     -527 546    }
5218     -5187     -1025     -@@ -969,24 +988,36 @@ graph TD
5219     -5188     -1026     -969 988    // Initialize visibility
5220     -5189     -1027     -970 989    updateSyncScrollVisibility();
5221     -5190     -1028     -971 990  
5222     -5191     -1029     -972     -  // Load saved theme using ThemeManager
5223     -5192     -1030     -    991 +  // Load saved theme FIRST, then initialize Mermaid with correct colors
5224     -5193     -1031     -973 992    const savedTheme = storageManager.get('selectedTheme');
5225     -5194     -1032     -974 993    if (savedTheme) {
5226     -5195     -1033     -975     -    // Load theme first, then sync dropdown only on success
5227     -5196     -1034     -    994 +    // Load theme first, then sync dropdown and reinit Mermaid
5228     -5197     -1035     -976 995      themeManager
5229     -5198     -1036     -977 996        .loadTheme(savedTheme)
5230     -5199     -1037     -978 997        .then(() => {
5231     -5200     -1038     -979 998          // Theme loaded successfully - sync dropdown
5232     -5201     -1039     -980 999          themeSelector.value = savedTheme;
5233     -5202     -1040     -981 1000          console.log(`‚úÖ Theme restored: ${savedTheme}`);
5234     -5203     -1041     -    1001 +
5235     -5204     -1042     -    1002 +        // NOW initialize Mermaid with correct theme colors
5236     -5205     -1043     -    1003 +        mermaidService.initialize();
5237     -5206     -1044     -    1004 +
5238     -5207     -1045     -    1005 +        // Re-render to apply theme
5239     -5208     -1046     -    1006 +        renderMarkdown();
5240     -5209     -1047     -982 1007        })
5241     -5210     -1048     -983 1008        .catch(err => {
5242     -5211     -1049     -984 1009          console.error('Failed to load saved theme:', err);
5243     -5212     -1050     -985 1010          // Fallback to default-light on error
5244     -5213     -1051     -986 1011          themeManager.loadTheme('default-light').then(() => {
5245     -5214     -1052     -987 1012            themeSelector.value = 'default-light';
5246     -5215     -1053     -    1013 +          mermaidService.initialize();
5247     -5216     -1054     -    1014 +          renderMarkdown();
5248     -5217     -1055     -988 1015          });
5249     -5218     -1056     -989 1016        });
5250     -5219     -1057     -    1017 +  } else {
5251     -5220     -1058     -    1018 +    // No saved theme - initialize with default-light
5252     -5221     -1059     -    1019 +    mermaidService.initialize();
5253     -5222     -1060     -    1020 +    renderMarkdown();
5254     -5223     -1061     -990 1021    }
5255     -5224     -1062     -991 1022  
5256     -5225     -1063     -992 1023    // Zoom functionality
5257     -5226     -1064     -@@ -1332,6 +1363,9 @@ graph TD
5258     -5227     -1065     -1332 1363      console.log(`‚úÖ Loaded file: ${fileItem.name} (${result.size} bytes)`);
5259     -5228     -1066     -1333 1364    }
5260     -5229     -1067     -1334 1365  
5261     -5230     -1068     -1335     -  // Initial render
5262     -5231     -1069     -1336     -  renderMarkdown();
5263     -5232     -1070     -    1366 +  // Expose renderMarkdown globally for theme changes
5264     -5233     -1071     -    1367 +  globalRenderMarkdown = renderMarkdown;
5265     -5234     -1072     -    1368 +
5266     -5235     -1073     -    1369 +  // DON'T render immediately - wait for theme to load
5267     -5236     -1074     -    1370 +  // renderMarkdown will be called after theme loads above
5268     -5237     -1075     -1337 1371  }
5269     -5238     -1076     -1338 1372  
5270     -5239     -1077     -
5271     -5240     -1078     -```
5272     -5241     -1079     -
5273     -5242     -1080     -
5274     -5243     -1081     -### üìÑ `src/js/services/MermaidService.js`
5275     -5244     -1082     -
5276     -5245     -1083     -**Type:** JavaScript Source File üü®
5277     -5246     -1084     -
5278     -5247     -1085     -```diff
5279     -5248     -1086     -@@ -2,12 +2,51 @@
5280     -5249     -1087     -  2   2   * MermaidService - Mermaid Diagram Rendering Service
5281     -5250     -1088     -  3   3   *
5282     -5251     -1089     -  4   4   * Handles all Mermaid diagram rendering with theme-aware configuration.
5283     -5252     -1090     -      5 + * Automatically detects light/dark themes and adjusts for optimal readability.
5284     -5253     -1091     -  5   6   * Isolated service for better testability and maintainability.
5285     -5254     -1092     -  6   7   */
5286     -5255     -1093     -  7   8  
5287     -5256     -1094     -  8   9  import { MERMAID_CONFIG } from '../config/constants.js';
5288     -5257     -1095     -  9  10  import { getCssVariable } from '../utils/colorHelpers.js';
5289     -5258     -1096     - 10  11  
5290     -5259     -1097     -     12 +/**
5291     -5260     -1098     -     13 + * Calculate relative luminance of a color
5292     -5261     -1099     -     14 + * Used to detect if theme is light or dark
5293     -5262     -1100     -     15 + *
5294     -5263     -1101     -     16 + * @param {string} color - Hex color (#rrggbb)
5295     -5264     -1102     -     17 + * @returns {number} Luminance value (0-1)
5296     -5265     -1103     -     18 + * @private
5297     -5266     -1104     -     19 + */
5298     -5267     -1105     -     20 +function getRelativeLuminance(color) {
5299     -5268     -1106     -     21 +  // Remove # if present
5300     -5269     -1107     -     22 +  const hex = color.replace('#', '');
5301     -5270     -1108     -     23 +
5302     -5271     -1109     -     24 +  // Convert to RGB
5303     -5272     -1110     -     25 +  const r = parseInt(hex.substr(0, 2), 16) / 255;
5304     -5273     -1111     -     26 +  const g = parseInt(hex.substr(2, 2), 16) / 255;
5305     -5274     -1112     -     27 +  const b = parseInt(hex.substr(4, 2), 16) / 255;
5306     -5275     -1113     -     28 +
5307     -5276     -1114     -     29 +  // Apply sRGB gamma correction
5308     -5277     -1115     -     30 +  const rsRGB = r <= 0.03928 ? r / 12.92 : ((r + 0.055) / 1.055) ** 2.4;
5309     -5278     -1116     -     31 +  const gsRGB = g <= 0.03928 ? g / 12.92 : ((g + 0.055) / 1.055) ** 2.4;
5310     -5279     -1117     -     32 +  const bsRGB = b <= 0.03928 ? b / 12.92 : ((b + 0.055) / 1.055) ** 2.4;
5311     -5280     -1118     -     33 +
5312     -5281     -1119     -     34 +  // Calculate relative luminance
5313     -5282     -1120     -     35 +  return 0.2126 * rsRGB + 0.7152 * gsRGB + 0.0722 * bsRGB;
5314     -5283     -1121     -     36 +}
5315     -5284     -1122     -     37 +
5316     -5285     -1123     -     38 +/**
5317     -5286     -1124     -     39 + * Detect if current theme is light or dark
5318     -5287     -1125     -     40 + *
5319     -5288     -1126     -     41 + * @param {string} bgColor - Background color
5320     -5289     -1127     -     42 + * @returns {boolean} True if light theme
5321     -5290     -1128     -     43 + * @private
5322     -5291     -1129     -     44 + */
5323     -5292     -1130     -     45 +function isLightTheme(bgColor) {
5324     -5293     -1131     -     46 +  const luminance = getRelativeLuminance(bgColor);
5325     -5294     -1132     -     47 +  return luminance > 0.5; // Threshold for light/dark
5326     -5295     -1133     -     48 +}
5327     -5296     -1134     -     49 +
5328     -5297     -1135     - 11  50  /**
5329     -5298     -1136     - 12  51   * @class MermaidService
5330     -5299     -1137     - 13  52   * @description Service for rendering Mermaid diagrams with theme integration
5331     -5300     -1138     -@@ -23,46 +62,187 @@ export class MermaidService {
5332     -5301     -1139     - 23  62    }
5333     -5302     -1140     - 24  63  
5334     -5303     -1141     - 25  64    /**
5335     -5304     -1142     - 26     -   * Initialize Mermaid with current theme colors
5336     -5305     -1143     - 27     -   * Extracts theme colors from CSS variables and configures Mermaid
5337     -5306     -1144     -     65 +   * Initialize Mermaid with COMPREHENSIVE theme configuration
5338     -5307     -1145     -     66 +   * Reads ALL 60+ variables from theme CSS with smart fallbacks
5339     -5308     -1146     -     67 +   * Based on official Mermaid.js theming documentation
5340     -5309     -1147     - 28  68     *
5341     -5310     -1148     - 29  69     * @returns {void}
5342     -5311     -1149     - 30  70     */
5343     -5312     -1150     - 31  71    initialize() {
5344     -5313     -1151     - 32     -    // Extract theme colors from CSS variables
5345     -5314     -1152     - 33     -    const h1Color = getCssVariable('--h1-color');
5346     -5315     -1153     - 34     -    const h2Color = getCssVariable('--h2-color');
5347     -5316     -1154     - 35     -    const h3Color = getCssVariable('--h3-color');
5348     -5317     -1155     - 36     -    const bgSecondary = getCssVariable('--bg-secondary');
5349     -5318     -1156     - 37     -    const textPrimary = getCssVariable('--text-primary');
5350     -5319     -1157     -     72 +    // Helper to get variable with fallback
5351     -5320     -1158     -     73 +    const get = (varName, fallback) => {
5352     -5321     -1159     -     74 +      const value = getCssVariable(varName);
5353     -5322     -1160     -     75 +      return value && value.trim() !== '' ? value : fallback;
5354     -5323     -1161     -     76 +    };
5355     -5324     -    4165 +     31 +### 3. üí• Race Condition "Magic Numbers" (Lines 490, 535)
5356     -5325     -    4166 +     32 +```javascript
5357     -5326     -    4167 +     33 +// Line 490
5358     -5327     -    4168 +     34 +setTimeout(() => { ... mermaid.render(...) }, 100);
5359     -5328     -    4169 +     35 +
5360     -5329     -    4170 +     36 +// Line 535
5361     -5330     -    4171 +     37 +setTimeout(() => { ... renderMarkdown() }, 100);
5362     -5331     -    4172 +     38 +```
5363     -5332     -    4173 +     39 +**Critique:** You are using `setTimeout` with a magic number (`100ms`) to "wait" for the DOM or other processes.
5364     -5333     -    4174 +     40 +- **Why:** This is unreliable. On a slow machine, 100ms isn't enough, and the render fails. On a fast machine, it causes a perceptible UI stutter.
5365     -5334     -    4175 +     41 +- **Fix:** Use **Promises** and `requestAnimationFrame`. `mermaid.render` returns a promise; await it.
5366     -5335     -    4176 +     42 +
5367     -5336     -    4177 +     43 +### 4. üî• Un-Debounced Rendering (Line 666)
5368     -5337     -    4178 +     44 +```javascript
5369     -5338     -    4179 +     45 +editor.addEventListener('input', renderMarkdown);
5370     -5339     -    4180 +     46 +```
5371     -5340     -    4181 +     47 +**Critique:** `renderMarkdown` is heavy (Regex + Parsing + DOM clear + Prism + Mermaid).
5372     -5341     -    4182 +     48 +- **Why:** Triggers on *every keystroke*. Typing fast will freeze the UI.
5373     -5342     -    4183 +     49 +- **Fix:** Wrap the handler in a `debounce` function (e.g., wait 300ms after last keystroke).
5374     -5343     -    4184 +     50 +
5375     -5344     -    4185 +     51 +---
5376     -5345     -    4186 +     52 +
5377     -5346     -    4187 +     53 +## ‚ö†Ô∏è Major Logic Flaws & Architecture
5378     -5347     -    4188 +     54 +
5379     -5348     -    4189 +     55 +### 5. üèóÔ∏è The "God Function": `setupEditor` (Lines 295-1372)
5380     -5349     -    4190 +     56 +**Critique:** This function is **1077 lines long**.
5381     -5350     -    4191 +     57 +- **Issue:** It contains state (`folderFiles`), event listeners, UI logic (`updatePDFPreview`), and utility helpers (`renderFileTree`).
5382     -5351     -    4192 +     58 +- **Impact:** It is effectively impossible to unit test. Scope pollution is rampant.
5383     -5352     -    4193 +     59 +- **Fix:** Break this file apart immediately.
5384     -5353     -    4194 +     60 +    - `setupEditor()` should only orchestrate.
5385     -5354     -    4195 +     61 +    - `setupPDFHandling()` should be its own module.
5386     -5355     -    4196 +     62 +    - `setupFolderBrowser()` should be its own module.
5387     -5356     -    4197 +     63 +
5388     -5357     -    4198 +     64 +### 6. üçù Spaghetti Events (Global Scope Pollution)
5389     -5358     -    4199 +     65 +```javascript
5390     -5359     -    4200 +     66 +let globalRenderMarkdown = null; // Line 24
5391     -5360     -    4201 +     67 +...
5392     -5361     -    4202 +     68 +globalRenderMarkdown = renderMarkdown; // Line 1367
5393     -5362     -    4203 +     69 +```
5394     -5363     -    4204 +     70 +**Critique:** You are leaking a local function to the global scope to hack around scope limitations for the theme manager callback.
5395     -5364     -    4205 +     71 +- **Fix:** Pass `renderMarkdown` as a dependency or use a proper `EventManager` (Pub/Sub pattern).
5396     -5365     -    4206 +     72 +
5397     -5366     -    4207 +     73 +### 7. üìÅ Hardcoded DOM Generation (Lines 1241-1334)
5398     -5367     -    4208 +     74 +**Critique:** The `renderFileTree` function essentially constructs a Virtual DOM manually using `document.createElement`.
5399     -5368     -    4209 +     75 +- **Issue:** This logic is mixed with the controller.
5400     -5369     -    4210 +     76 +- **Fix:** Move this to a `FileTreeView.js` class. The controller should just say `treeView.render(files)`.
5401     -5370     -1162 4211       77 +
5402     -5371     -1163     -     78 +    // Extract core theme colors for fallbacks
5403     -5372     -1164     -     79 +    const bgPri = getCssVariable('--bg-primary');
5404     -5373     -1165     -     80 +    const bgSec = getCssVariable('--bg-secondary');
5405     -5374     -1166     -     81 +    const bgTer = getCssVariable('--bg-tertiary');
5406     -5375     -1167     -     82 +    const txtPri = getCssVariable('--text-primary');
5407     -5376     -1168     -     83 +    const txtSec = getCssVariable('--text-secondary');
5408     -5377     -1169     -     84 +    const h1 = getCssVariable('--h1-color');
5409     -5378     -1170     -     85 +    const h2 = getCssVariable('--h2-color');
5410     -5379     -1171     -     86 +    const h3 = getCssVariable('--h3-color');
5411     -5380     -1172     -     87 +
5412     -5381     -1173     -     88 +    const isLight = isLightTheme(bgPri);
5413     -5382     -1174     -     89 +    const nodeBkg = isLight ? bgTer : bgSec;
5414     -5383     -1175     -     90 +    const clusterBkg = isLight ? bgSec : bgTer;
5415     -5384     -1176     - 38  91  
5416     -5385     -1177     - 39     -    // Configure Mermaid with theme colors
5417     -5386     -1178     - 40  92      if (typeof mermaid !== 'undefined') {
5418     -5387     -1179     - 41  93        mermaid.initialize({
5419     -5388     -1180     - 42  94          startOnLoad: MERMAID_CONFIG.START_ON_LOAD,
5420     -5389     -1181     - 43  95          theme: MERMAID_CONFIG.THEME,
5421     -5390     -1182     - 44  96          themeVariables: {
5422     -5391     -1183     - 45     -          primaryColor: bgSecondary,
5423     -5392     -1184     - 46     -          primaryTextColor: textPrimary,
5424     -5393     -1185     - 47     -          primaryBorderColor: h1Color,
5425     -5394     -1186     - 48     -          lineColor: h2Color,
5426     -5395     -1187     - 49     -          secondaryColor: bgSecondary,
5427     -5396     -1188     - 50     -          tertiaryColor: bgSecondary,
5428     -5397     -1189     - 51     -          background: bgSecondary,
5429     -5398     -1190     - 52     -          mainBkg: bgSecondary,
5430     -5399     -1191     - 53     -          secondBkg: bgSecondary,
5431     -5400     -1192     - 54     -          tertiaryBkg: bgSecondary,
5432     -5401     -1193     - 55     -          nodeBorder: h1Color,
5433     -5402     -1194     - 56     -          clusterBkg: bgSecondary,
5434     -5403     -1195     - 57     -          clusterBorder: h3Color,
5435     -5404     -1196     - 58     -          titleColor: textPrimary,
5436     -5405     -1197     - 59     -          edgeLabelBackground: bgSecondary,
5437     -5406     -1198     - 60     -          nodeTextColor: textPrimary,
5438     -5407     -1199     -     97 +          // Core Global
5439     -5408     -1200     -     98 +          background: get('--mermaid-background', bgPri),
5440     -5409     -1201     - 61  99            fontFamily: '-apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif',
5441     -5410     -1202     -    100 +          fontSize: '16px',
5442     -5411     -1203     -    101 +          darkMode: !isLight,
5443     -5412     -1204     -    102 +          textColor: get('--mermaid-text-color', txtPri),
5444     -5413     -1205     -    103 +          lineColor: get('--mermaid-line-color', h2),
5445     -5414     -1206     -    104 +          mainBkg: get('--mermaid-main-bkg', nodeBkg),
5446     -5415     -1207     -    105 +
5447     -5416     -1208     -    106 +          // Primary Set
5448     -5417     -1209     -    107 +          primaryColor: get('--mermaid-primary-color', nodeBkg),
5449     -5418     -1210     -    108 +          primaryTextColor: get('--mermaid-primary-text-color', txtPri),
5450     -5419     -1211     -    109 +          primaryBorderColor: get('--mermaid-primary-border-color', h1),
5451     -5420     -1212     -    110 +
5452     -5421     -1213     -    111 +          // Secondary Set
5453     -5422     -1214     -    112 +          secondaryColor: get('--mermaid-secondary-color', clusterBkg),
5454     -5423     -1215     -    113 +          secondaryTextColor: get('--mermaid-secondary-text-color', txtPri),
5455     -5424     -1216     -    114 +          secondaryBorderColor: get('--mermaid-secondary-border-color', h2),
5456     -5425     -1217     -    115 +
5457     -5426     -1218     -    116 +          // Tertiary Set
5458     -5427     -1219     -    117 +          tertiaryColor: get('--mermaid-tertiary-color', bgPri),
5459     -5428     -1220     -    118 +          tertiaryTextColor: get('--mermaid-tertiary-text-color', txtPri),
5460     -5429     -1221     -    119 +          tertiaryBorderColor: get('--mermaid-tertiary-border-color', h3),
5461     -5430     -1222     -    120 +
5462     -5431     -1223     -    121 +          // Flowchart
5463     -5432     -1224     -    122 +          nodeBorder: get('--mermaid-node-border', h1),
5464     -5433     -1225     -    123 +          clusterBkg: get('--mermaid-cluster-bkg', clusterBkg),
5465     -5434     -1226     -    124 +          clusterBorder: get('--mermaid-cluster-border', h2),
5466     -5435     -1227     -    125 +          defaultLinkColor: get('--mermaid-default-link-color', h2),
5467     -5436     -1228     -    126 +          titleColor: get('--mermaid-title-color', txtPri),
5468     -5437     -1229     -    127 +          edgeLabelBackground: get('--mermaid-edge-label-background', bgPri),
5469     -5438     -1230     -    128 +          nodeTextColor: get('--mermaid-node-text-color', txtPri),
5470     -5439     -1231     -    129 +
5471     -5440     -1232     -    130 +          // Sequence Diagram
5472     -5441     -1233     -    131 +          actorBkg: get('--mermaid-actor-bkg', nodeBkg),
5473     -5442     -1234     -    132 +          actorBorder: get('--mermaid-actor-border', h1),
5474     -5443     -1235     -    133 +          actorTextColor: get('--mermaid-actor-text-color', txtPri),
5475     -5444     -1236     -    134 +          actorLineColor: get('--mermaid-actor-line-color', h1),
5476     -5445     -1237     -    135 +          signalColor: get('--mermaid-signal-color', h2),
5477     -5446     -1238     -    136 +          signalTextColor: get('--mermaid-signal-text-color', txtPri),
5478     -5447     -1239     -    137 +          labelBoxBkgColor: get('--mermaid-label-box-bkg-color', nodeBkg),
5479     -5448     -1240     -    138 +          labelBoxBorderColor: get('--mermaid-label-box-border-color', h1),
5480     -5449     -1241     -    139 +          labelTextColor: get('--mermaid-label-text-color', txtPri),
5481     -5450     -1242     -    140 +          loopTextColor: get('--mermaid-loop-text-color', txtPri),
5482     -5451     -1243     -    141 +          activationBorderColor: get('--mermaid-activation-border-color', h2),
5483     -5452     -1244     -    142 +          activationBkgColor: get('--mermaid-activation-bkg-color', clusterBkg),
5484     -5453     -1245     -    143 +          sequenceNumberColor: get('--mermaid-sequence-number-color', txtPri),
5485     -5454     -1246     -    144 +
5486     -5455     -1247     -    145 +          // Pie Chart
5487     -5456     -1248     -    146 +          pie1: get('--mermaid-pie1', h1),
5488     -5457     -1249     -    147 +          pie2: get('--mermaid-pie2', h2),
5489     -5458     -1250     -    148 +          pie3: get('--mermaid-pie3', h3),
5490     -5459     -1251     -    149 +          pie4: get('--mermaid-pie4', txtSec),
5491     -5460     -1252     -    150 +          pie5: get('--mermaid-pie5', h1),
5492     -5461     -1253     -    151 +          pie6: get('--mermaid-pie6', h2),
5493     -5462     -1254     -    152 +          pie7: get('--mermaid-pie7', h3),
5494     -5463     -1255     -    153 +          pie8: get('--mermaid-pie8', txtSec),
5495     -5464     -1256     -    154 +          pie9: get('--mermaid-pie9', h1),
5496     -5465     -1257     -    155 +          pie10: get('--mermaid-pie10', h2),
5497     -5466     -1258     -    156 +          pie11: get('--mermaid-pie11', h3),
5498     -5467     -1259     -    157 +          pie12: get('--mermaid-pie12', txtSec),
5499     -5468     -1260     -    158 +          pieTitleTextSize: '25px',
5500     -5469     -1261     -    159 +          pieTitleTextColor: get('--mermaid-pie-title-text-color', txtPri),
5501     -5470     -1262     -    160 +          pieSectionTextSize: '17px',
5502     -5471     -1263     -    161 +          pieSectionTextColor: get('--mermaid-pie-section-text-color', bgPri),
5503     -5472     -1264     -    162 +          pieLegendTextSize: '17px',
5504     -5473     -1265     -    163 +          pieLegendTextColor: get('--mermaid-pie-legend-text-color', txtPri),
5505     -5474     -1266     -    164 +          pieStrokeColor: get('--mermaid-pie-stroke-color', h1),
5506     -5475     -1267     -    165 +          pieStrokeWidth: '2px',
5507     -5476     -1268     -    166 +          pieOuterStrokeWidth: '2px',
5508     -5477     -1269     -    167 +          pieOuterStrokeColor: get('--mermaid-pie-outer-stroke-color', h1),
5509     -5478     -1270     -    168 +          pieOpacity: '0.9',
5510     -5479     -1271     -    169 +
5511     -5480     -1272     -    170 +          // State Diagram
5512     -5481     -1273     -    171 +          labelColor: get('--mermaid-label-color', txtPri),
5513     -5482     -1274     -    172 +          altBackground: get('--mermaid-alt-background', clusterBkg),
5514     -5483     -1275     -    173 +
5515     -5484     -1276     -    174 +          // Class Diagram
5516     -5485     -1277     -    175 +          classText: get('--mermaid-class-text', txtPri),
5517     -5486     -1278     -    176 +
5518     -5487     -1279     -    177 +          // User Journey
5519     -5488     -1280     -    178 +          fillType0: get('--mermaid-fill-type0', h1),
5520     -5489     -1281     -    179 +          fillType1: get('--mermaid-fill-type1', h2),
5521     -5490     -1282     -    180 +          fillType2: get('--mermaid-fill-type2', h3),
5522     -5491     -1283     -    181 +          fillType3: get('--mermaid-fill-type3', txtSec),
5523     -5492     -1284     -    182 +          fillType4: get('--mermaid-fill-type4', h1),
5524     -5493     -1285     -    183 +          fillType5: get('--mermaid-fill-type5', h2),
5525     -5494     -1286     -    184 +          fillType6: get('--mermaid-fill-type6', h3),
5526     -5495     -1287     -    185 +          fillType7: get('--mermaid-fill-type7', txtSec),
5527     -5496     -1288     -    186 +
5528     -5497     -1289     -    187 +          // Gantt Chart
5529     -5498     -1290     -    188 +          sectionBkgColor: get('--mermaid-section-bkg-color', bgSec),
5530     -5499     -1291     -    189 +          altSectionBkgColor: get('--mermaid-alt-section-bkg-color', bgTer),
5531     -5500     -1292     -    190 +          sectionBkgColor2: get('--mermaid-section-bkg-color2', bgSec),
5532     -5501     -1293     -    191 +          taskTextColor: get('--mermaid-task-text-color', txtPri),
5533     -5502     -1294     -    192 +          taskTextLightColor: get('--mermaid-task-text-light-color', txtPri),
5534     -5503     -1295     -    193 +          taskTextOutsideColor: get('--mermaid-task-text-outside-color', txtPri),
5535     -5504     -1296     -    194 +          taskTextClickableColor: get('--mermaid-task-text-clickable-color', h1),
5536     -5505     -1297     -    195 +          activeTaskBkgColor: get('--mermaid-active-task-bkg-color', h1),
5537     -5506     -1298     -    196 +          activeTaskBorderColor: get('--mermaid-active-task-border-color', h1),
5538     -5507     -1299     -    197 +          doneTaskBkgColor: get('--mermaid-done-task-bkg-color', h3),
5539     -5508     -1300     -    198 +          doneTaskBorderColor: get('--mermaid-done-task-border-color', h3),
5540     -5509     -1301     -    199 +          critBorderColor: get('--mermaid-crit-border-color', h2),
5541     -5510     -1302     -    200 +          critBkgColor: get('--mermaid-crit-bkg-color', h2),
5542     -5511     -1303     -    201 +          todayLineColor: get('--mermaid-today-line-color', h2),
5543     -5512     -1304     -    202 +          gridColor: get('--mermaid-grid-color', bgTer),
5544     -5513     -1305     -    203 +          sectionTextColor: get('--mermaid-section-text-color', txtPri),
5545     -5514     -1306     -    204 +          taskBorderColor: get('--mermaid-task-border-color', h1),
5546     -5515     -1307     -    205 +
5547     -5516     -1308     -    206 +          // ER Diagram
5548     -5517     -1309     -    207 +          attributeBackgroundColorOdd: get('--mermaid-attribute-background-color-odd', bgSec),
5549     -5518     -1310     -    208 +          attributeBackgroundColorEven: get('--mermaid-attribute-background-color-even', bgPri),
5550     -5519     -1311     -    209 +          relationshipLabelBackground: get('--mermaid-relationship-label-background', bgPri),
5551     -5520     -1312     -    210 +          relationshipLabelColor: get('--mermaid-relationship-label-color', txtPri),
5552     -5521     -1313     -    211 +          entityBackground: get('--mermaid-entity-background', nodeBkg),
5553     -5522     -1314     -    212 +          entityBorderColor: get('--mermaid-entity-border-color', h1),
5554     -5523     -1315     -    213 +
5555     -5524     -1316     -    214 +          // Git Graph
5556     -5525     -1317     -    215 +          git0: get('--mermaid-git0', h1),
5557     -5526     -1318     -    216 +          git1: get('--mermaid-git1', h2),
5558     -5527     -1319     -    217 +          git2: get('--mermaid-git2', h3),
5559     -5528     -1320     -    218 +          git3: get('--mermaid-git3', txtSec),
5560     -5529     -1321     -    219 +          git4: get('--mermaid-git4', h1),
5561     -5530     -1322     -    220 +          git5: get('--mermaid-git5', h2),
5562     -5531     -1323     -    221 +          git6: get('--mermaid-git6', h3),
5563     -5532     -1324     -    222 +          git7: get('--mermaid-git7', txtSec),
5564     -5533     -1325     -    223 +          gitInv0: get('--mermaid-git-inv0', bgPri),
5565     -5534     -1326     -    224 +          gitBranchLabel0: get('--mermaid-git-branch-label0', txtPri),
5566     -5535     -1327     -    225 +          gitBranchLabel1: get('--mermaid-git-branch-label1', txtPri),
5567     -5536     -1328     -    226 +          gitBranchLabel2: get('--mermaid-git-branch-label2', txtPri),
5568     -5537     -1329     -    227 +          gitBranchLabel3: get('--mermaid-git-branch-label3', txtPri),
5569     -5538     -1330     -    228 +          gitBranchLabel4: get('--mermaid-git-branch-label4', txtPri),
5570     -5539     -1331     -    229 +          commitLabelColor: get('--mermaid-commit-label-color', txtPri),
5571     -5540     -1332     -    230 +          commitLabelBackground: get('--mermaid-commit-label-background', bgPri),
5572     -5541     -1333     -    231 +          tagLabelColor: get('--mermaid-tag-label-color', txtPri),
5573     -5542     -1334     -    232 +          tagLabelBackground: get('--mermaid-tag-label-background', nodeBkg),
5574     -5543     -1335     -    233 +          tagLabelBorder: get('--mermaid-tag-label-border', h1),
5575     -5544     -1336     - 62 234          },
5576     -5545     -1337     - 63 235        });
5577     -5546     -1338     - 64 236  
5578     -5547     -1339     - 65 237        this.initialized = true;
5579     -5548     -1340     -    238 +
5580     -5549     -1341     -    239 +      // Debug: Log sample of loaded variables
5581     -5550     -1342     -    240 +      console.log(`‚úÖ Mermaid initialized`);
5582     -5551     -1343     -    241 +      console.log(`  - Background: ${get('--mermaid-background', bgPri)}`);
5583     -5552     -1344     -    242 +      console.log(`  - Text: ${get('--mermaid-text-color', txtPri)}`);
5584     -5553     -1345     -    243 +      console.log(`  - Line: ${get('--mermaid-line-color', h2)}`);
5585     -5554     -1346     -    244 +      console.log(`  - Primary: ${get('--mermaid-primary-color', nodeBkg)}`);
5586     -5555     -1347     -    245 +      console.log(`  - Pie1: ${get('--mermaid-pie1', h1)}`);
5587     -5556     -1348     - 66 246      } else {
5588     -5557     -1349     - 67 247        console.warn('Mermaid library not loaded');
5589     -5558     -1350     - 68 248      }
5590     -5559     -1351     - 69 249  
5591     -5560     -1352     -
5592     -5561     -1353     -```
5593     -5562     -1354     -
5594     -5563     -1355     -
5595     -5564     -1356     -### üìÑ `style.css`
5596     -5565     -1357     -
5597     -5566     -1358     -**Type:** Stylesheet üé®
5598     -5567     -1359     -
5599     -5568     -1360     -```diff
5600     -5569     -1361     -@@ -297,68 +297,119 @@ body {
5601     -5570     -1362     -297 297    padding: 0;
5602     -5571     -1363     -298 298  }
5603     -5572     -1364     -299 299  
5604     -5573     -1365     -300     -/* Syntax Highlighting with Custom Variables - Comprehensive Token Coverage */
5605     -5574     -1366     -301     -#markdown-preview .token.keyword {
5606     -5575     -1367     -302     -  color: var(--syntax-keyword, #c792ea) !important;
5607     -5576     -1368     -    300 +/* ==================== PRISM SYNTAX HIGHLIGHTING - PRODUCTION GRADE ==================== */
5608     -5577     -1369     -    301 +/* Based on One Dark theme architecture - comprehensive token coverage */
5609     -5578     -1370     -    302 +
5610     -5579     -1371     -    303 +/* Group 1: Comments and documentation */
5611     -5580     -1372     -    304 +#markdown-preview .token.comment,
5612     -5581     -1373     -    305 +#markdown-preview .token.prolog,
5613     -5582     -1374     -    306 +#markdown-preview .token.cdata {
5614     -5583     -1375     -    307 +  color: var(--syntax-comment, #7f85a3);
5615     -5584     -1376     -    308 +  font-style: italic;
5616     -5585     -1377     -303 309  }
5617     -5586     -1378     -304 310  
5618     -5587     -1379     -305     -#markdown-preview .token.string {
5619     -5588     -1380     -306     -  color: var(--syntax-string, #a5e844) !important;
5620     -5589     -1381     -307     -}
5621     -5590     -1382     -308     -
5622     -5591     -1383     -309     -#markdown-preview .token.number,
5623     -5592     -1384     -310     -#markdown-preview .token.boolean {
5624     -5593     -1385     -311     -  color: var(--syntax-number, #ffcb6b) !important;
5625     -5594     -1386     -312     -}
5626     -5595     -1387     -313     -
5627     -5596     -1388     -314     -#markdown-preview .token.function,
5628     -5597     -1389     -315     -#markdown-preview .token.function-variable,
5629     -5598     -1390     -316     -#markdown-preview .token.method,
5630     -5599     -1391     -317     -#markdown-preview .token.method-variable {
5631     -5600     -1392     -318     -  color: var(--syntax-function, #82aaff) !important;
5632     -5601     -1393     -319     -  font-weight: 600;
5633     -5602     -1394     -320     -}
5634     -5603     -1395     -321     -
5635     -5604     -1396     -322     -#markdown-preview .token.comment {
5636     -5605     -1397     -323     -  color: var(--syntax-comment, #7f85a3) !important;
5637     -5606     -1398     -324     -}
5638     -5607     -1399     -325     -
5639     -5608     -1400     -326     -#markdown-preview .token.operator {
5640     -5609     -1401     -327     -  color: var(--syntax-operator, #89ddff) !important;
5641     -5610     -1402     -328     -}
5642     -5611     -1403     -329     -
5643     -5612     -1404     -330     -#markdown-preview .token.punctuation {
5644     -5613     -1405     -331     -  color: var(--syntax-punctuation, #89ddff) !important;
5645     -5614     -1406     -    311 +/* Group 2: Neutral tokens (inherit or subtle) */
5646     -5615     -1407     -    312 +#markdown-preview .token.doctype,
5647     -5616     -1408     -    313 +#markdown-preview .token.punctuation,
5648     -5617     -1409     -    314 +#markdown-preview .token.entity {
5649     -5618     -1410     -    315 +  color: var(--syntax-punctuation, #64748b);
5650     -5619     -1411     -332 316  }
5651     -5620     -1412     -333 317  
5652     -5621     -1413     -    318 +/* Group 3: Orange hue - Class names, constants, numbers, booleans, atrules */
5653     -5622     -1414     -    319 +#markdown-preview .token.attr-name,
5654     -5623     -1415     -334 320  #markdown-preview .token.class-name,
5655     -5624     -1416     -335     -#markdown-preview .token.type-class-name {
5656     -5625     -1417     -336     -  color: var(--syntax-keyword, #ffcb6b) !important;
5657     -5626     -1418     -    321 +#markdown-preview .token.boolean,
5658     -5627     -1419     -    322 +#markdown-preview .token.constant,
5659     -5628     -1420     -    323 +#markdown-preview .token.number,
5660     -5629     -1421     -    324 +#markdown-preview .token.atrule {
5661     -5630     -1422     -    325 +  color: var(--syntax-class-name, #f97316);
5662     -5631     -1423     -337 326    font-weight: 600;
5663     -5632     -1424     -338 327  }
5664     -5633     -1425     -339 328  
5665     -5634     -1426     -340     -/* Variables and Parameters - NEW */
5666     -5635     -1427     -341     -#markdown-preview .token.parameter,
5667     -5636     -1428     -342     -#markdown-preview .token.variable,
5668     -5637     -1429     -343     -#markdown-preview .token.plain {
5669     -5638     -1430     -344     -  color: var(--syntax-variable, var(--text-primary)) !important;
5670     -5639     -1431     -345     -  font-weight: 500;
5671     -5640     -1432     -    329 +/* Group 4: Purple hue - Keywords (distinct from class names!) */
5672     -5641     -1433     -    330 +#markdown-preview .token.keyword {
5673     -5642     -1434     -    331 +  color: var(--syntax-keyword, #a855f7);
5674     -5643     -1435     -    332 +  font-weight: 700;
5675     -5644     -1436     -346 333  }
5676     -5645     -1437     -347 334  
5677     -5646     -1438     -348     -/* Properties and Namespaces - NEW */
5678     -5647     -1439     -    335 +/* Group 5: Red hue - Properties, tags, symbols, deleted, important */
5679     -5648     -1440     -349 336  #markdown-preview .token.property,
5680     -5649     -1441     -350     -#markdown-preview .token.property-access {
5681     -5650     -1442     -351     -  color: var(--syntax-property, var(--syntax-function)) !important;
5682     -5651     -1443     -    337 +#markdown-preview .token.tag,
5683     -5652     -1444     -    338 +#markdown-preview .token.symbol,
5684     -5653     -1445     -    339 +#markdown-preview .token.deleted,
5685     -5654     -1446     -    340 +#markdown-preview .token.important {
5686     -5655     -1447     -    341 +  color: var(--syntax-property, #ef4444);
5687     -5656     -1448     -    342 +  font-weight: 600;
5688     -5657     -1449     -352 343  }
5689     -5658     -1450     -353 344  
5690     -5659     -1451     -    345 +/* Group 6: Green hue - Strings, chars, builtins, inserted, regex, selectors */
5691     -5660     -1452     -    346 +#markdown-preview .token.selector,
5692     -5661     -1453     -    347 +#markdown-preview .token.string,
5693     -5662     -1454     -    348 +#markdown-preview .token.char,
5694     -5663     -1455     -    349 +#markdown-preview .token.builtin,
5695     -5664     -1456     -    350 +#markdown-preview .token.inserted,
5696     -5665     -1457     -    351 +#markdown-preview .token.regex,
5697     -5666     -1458     -    352 +#markdown-preview .token.attr-value {
5698     -5667     -1459     -    353 +  color: var(--syntax-string, #10b981);
5699     -5668     -1460     -    354 +}
5700     -5669     -1461     -    355 +
5701     -5670     -1462     -    356 +/* Nested attr-value punctuation (quotes) */
5702     -5671     -1463     -    357 +#markdown-preview .token.attr-value > .token.punctuation {
5703     -5672     -1464     -    358 +  color: var(--syntax-string, #10b981);
5704     -5673     -1465     -    359 +}
5705     -5674     -1466     -    360 +
5706     -5675     -1467     -    361 +/* Group 7: Blue hue - Variables, operators, functions */
5707     -5676     -1468     -    362 +#markdown-preview .token.variable,
5708     -5677     -1469     -    363 +#markdown-preview .token.operator,
5709     -5678     -1470     -    364 +#markdown-preview .token.function {
5710     -5679     -1471     -    365 +  color: var(--syntax-function, #3b82f6);
5711     -5680     -1472     -    366 +  font-weight: 600;
5712     -5681     -1473     -    367 +}
5713     -5682     -1474     -    368 +
5714     -5683     -1475     -    369 +/* Group 8: Cyan hue - URLs */
5715     -5684     -1476     -    370 +#markdown-preview .token.url {
5716     -5685     -1477     -    371 +  color: var(--syntax-url, #14b8a6);
5717     -5686     -1478     -    372 +}
5718     -5687     -1479     -    373 +
5719     -5688     -1480     -    374 +/* ==================== LANGUAGE-SPECIFIC OVERRIDES ==================== */
5720     -5689     -1481     -    375 +
5721     -5690     -1482     -    376 +/* JavaScript overrides */
5722     -5691     -1483     -    377 +#markdown-preview .language-javascript .token.operator {
5723     -5692     -1484     -    378 +  color: var(--syntax-keyword, #a855f7);
5724     -5693     -1485     -    379 +}
5725     -5694     -1486     -    380 +
5726     -5695     -1487     -    381 +/* CSS overrides */
5727     -5696     -1488     -    382 +#markdown-preview .language-css .token.selector {
5728     -5697     -1489     -    383 +  color: var(--syntax-property, #ef4444);
5729     -5698     -1490     -    384 +}
5730     -5699     -1491     -    385 +
5731     -5700     -1492     -    386 +#markdown-preview .language-css .token.property {
5732     -5701     -1493     -    387 +  color: var(--text-primary);
5733     -5702     -1494     -    388 +}
5734     -5703     -1495     -    389 +
5735     -5704     -1496     -    390 +/* JSON overrides */
5736     -5705     -1497     -    391 +#markdown-preview .language-json .token.operator {
5737     -5706     -1498     -    392 +  color: var(--syntax-punctuation, #64748b);
5738     -5707     -1499     -    393 +}
5739     -5708     -1500     -    394 +
5740     -5709     -1501     -    395 +#markdown-preview .language-json .token.null.keyword {
5741     -5710     -1502     -    396 +  color: var(--syntax-number, #fb923c);
5742     -5711     -1503     -    397 +}
5743     -5712     -1504     -    398 +
5744     -5713     -1505     -    399 +/* ==================== VISUAL ENHANCEMENTS ==================== */
5745     -5714     -1506     -    400 +
5746     -5715     -1507     -    401 +/* Bold/italic styling */
5747     -5716     -1508     -    402 +#markdown-preview .token.bold {
5748     -5717     -1509     -    403 +  font-weight: bold;
5749     -5718     -1510     -    404 +}
5750     -5719     -1511     -    405 +
5751     -5720     -1512     -    406 +#markdown-preview .token.italic {
5752     -5721     -1513     -    407 +  font-style: italic;
5753     -5722     -1514     -    408 +}
5754     -5723     -1515     -    409 +
5755     -5724     -1516     -    410 +/* Namespace opacity */
5756     -5725     -1517     -354 411  #markdown-preview .token.namespace {
5757     -5726     -1518     -355     -  color: var(--syntax-namespace, var(--syntax-keyword)) !important;
5758     -5727     -1519     -356     -  font-weight: 500;
5759     -5728     -1520     -357     -}
5760     -5729     -1521     -358     -
5761     -5730     -1522     -359     -#markdown-preview .token.builtin {
5762     -5731     -1523     -360     -  color: var(--syntax-builtin, var(--syntax-function)) !important;
5763     -5732     -1524     -361     -  font-weight: 500;
5764     -5733     -1525     -    412 +  opacity: 0.8;
5765     -5734     -1526     -362 413  }
5766     -5735     -1527     -363 414  
5767     -5736     -1528     -364 415  #markdown-preview blockquote {
5768     -5737     -1529     -365 416  
5769     -5738     -1530     -
5770     -5739     -1531     -```
5771     -5740     -1532     -
5772     -5741     -1533     -
5773     -5742     -1534     -### üìÑ `themes/default-dark.css`
5774     -5743     -1535     -
5775     -5744     -1536     -**Type:** Stylesheet üé®
5776     -5745     -1537     -
5777     -5746     -1538     -```diff
5778     -5747     -1539     -@@ -26,24 +26,184 @@
5779     -5748     -1540     - 26  26    --code-block-bg: #0d1117;
5780     -5749     -1541     - 27  27    --code-border: #30363d;
5781     -5750     -1542     - 28  28  
5782     -5751     -1543     - 29     -  /* Syntax Highlighting */
5783     -5752     -1544     - 30     -  --syntax-keyword: #ff7b72;
5784     -5753     -1545     - 31     -  --syntax-string: #a5e844;
5785     -5754     -1546     - 32     -  --syntax-number: #79c0ff;
5786     -5755     -1547     - 33     -  --syntax-function: #d2a8ff;
5787     -5756     -1548     - 34     -  --syntax-comment: #8b949e;
5788     -5757     -1549     - 35     -  --syntax-operator: #ff7b72;
5789     -5758     -1550     - 36     -  --syntax-punctuation: #7d8590;
5790     -5759     -1551     -     29 +  /* Syntax Highlighting - Production-Grade Token Colors (One Dark Architecture) */
5791     -5760     -1552     - 37  30  
5792     -5761     -1553     - 38     -  /* Additional Token Types */
5793     -5762     -1554     - 39     -  --syntax-variable: #79c0ff; /* Variables - blue (distinct from text #e6edf3) */
5794     -5763     -1555     - 40     -  --syntax-property: #d2a8ff; /* Properties - purple */
5795     -5764     -1556     - 41     -  --syntax-namespace: #ff7b72; /* Namespaces - red */
5796     -5765     -1557     - 42     -  --syntax-builtin: #d2a8ff; /* Builtins - purple */
5797     -5766     -1558     -     31 +  /* Core hue-1: Cyan - URLs */
5798     -5767     -1559     -     32 +  --syntax-url: #56d4dd; /* Cyan for URLs */
5799     -5768     -1560     -     33 +
5800     -5769     -1561     -     34 +  /* Core hue-2: Blue - Functions, variables */
5801     -5770     -1562     -     35 +  --syntax-function: #d2a8ff; /* Purple for functions */
5802     -5771     -1563     -     36 +  --syntax-variable: #79c0ff; /* Bright blue for variables */
5803     -5772     -1564     -     37 +
5804     -5773     -1565     -     38 +  /* Core hue-3: Red - Keywords */
5805     -5774     -1566     -     39 +  --syntax-keyword: #ff7b72; /* Coral red for keywords (final, sealed, class) */
5806     -5775     -1567     -     40 +
5807     -5776     -1568     -     41 +  /* Core hue-4: Green - Strings, builtins */
5808     -5777     -1569     -     42 +  --syntax-string: #a5d6ff; /* Light blue-green for strings */
5809     -5778     -1570     -     43 +  --syntax-builtin: #7ee787; /* Vibrant green for builtins (String, List) */
5810     -5779     -1571     -     44 +  --syntax-char: #a5d6ff; /* Same as strings */
5811     -5780     -1572     -     45 +  --syntax-regex: #a5d6ff; /* Same as strings */
5812     -5781     -1573     -     46 +  --syntax-inserted: #7ee787; /* For diff */
5813     -5782     -1574     -     47 +
5814     -5783     -1575     -     48 +  /* Core hue-5: Orange - Properties, tags */
5815     -5784     -1576     -     49 +  --syntax-property: #ffa657; /* Orange for properties */
5816     -5785     -1577     -     50 +  --syntax-tag: #ff7b72; /* Coral for tags */
5817     -5786     -1578     -     51 +  --syntax-deleted: #ff7b72; /* For diff */
5818     -5787     -1579     -     52 +  --syntax-important: #ffa657; /* For !important */
5819     -5788     -1580     -     53 +
5820     -5789     -1581     -     54 +  /* Core hue-6: Yellow - Class names, constants, numbers */
5821     -5790     -1582     -     55 +  --syntax-class-name: #ffa657; /* Orange for class names (Rectangle, Shape) */
5822     -5791     -1583     -     56 +  --syntax-number: #79c0ff; /* Blue for numbers */
5823     -5792     -1584     -     57 +  --syntax-constant: #79c0ff; /* Blue for constants */
5824     -5793     -1585     -     58 +  --syntax-boolean: #79c0ff; /* Same as numbers */
5825     -5794     -1586     -     59 +  --syntax-atrule: #d2a8ff; /* Purple for CSS @ rules */
5826     -5795     -1587     -     60 +
5827     -5796     -1588     -     61 +  /* Neutral colors */
5828     -5797     -1589     -     62 +  --syntax-comment: #8b949e; /* Gray for comments */
5829     -5798     -1590     -     63 +  --syntax-punctuation: #7d8590; /* Muted gray for punctuation */
5830     -5799     -1591     -     64 +  --syntax-operator: #ff7b72; /* Coral for operators */
5831     -5800     -1592     -     65 +
5832     -5801     -1593     -     66 +  /* Markup specific */
5833     -5802     -1594     -     67 +  --syntax-attr-name: #ffa657; /* Orange like class-name */
5834     -5803     -1595     -     68 +  --syntax-attr-value: #a5d6ff; /* Light blue like strings */
5835     -5804     -1596     -     69 +  --syntax-namespace: #d2a8ff; /* Purple */
5836     -5805     -1597     -     70 +  --syntax-entity: #7d8590; /* Neutral */
5837     -5806     -1598     -     71 +  --syntax-selector: #ffa657; /* Orange like properties */
5838     -5807     -1599     - 43  72  
5839     -5808     -1600     - 44  73    --blockquote-border: #bc8cff;
5840     -5809     -1601     - 45  74    --blockquote-bg: #161b22;
5841     -5810     -1602     - 46  75  
5842     -5811     -1603     - 47  76    --table-header-bg: #21262d;
5843     -5812     -1604     - 48  77    --table-border: #30363d;
5844     -5813     -1605     -     78 +
5845     -5814     -1606     -     79 +  /* === MERMAID COMPREHENSIVE CONFIGURATION === */
5846     -5815     -1607     -     80 +
5847     -5816     -1608     -     81 +  /* Core Global */
5848     -5817     -1609     -     82 +  --mermaid-background: #0d1117;
5849     -5818     -1610     -     83 +  --mermaid-text-color: #e6edf3;
5850     -5819     -1611     -     84 +  --mermaid-line-color: #58a6ff;
5851     -5820     -1612     -     85 +  --mermaid-main-bkg: #1c2128;
5852     -5821     -1613     -     86 +
5853     -5822     -1614     -     87 +  /* Primary Set - Main nodes/boxes */
5854     -5823     -1615     -     88 +  --mermaid-primary-color: #1c2128;
5855     -5824     -1616     -     89 +  --mermaid-primary-text-color: #e6edf3;
5856     -5825     -1617     -     90 +  --mermaid-primary-border-color: #58a6ff;
5857     -5826     -1618     -     91 +
5858     -5827     -1619     -     92 +  /* Secondary Set - Clusters/subgraphs */
5859     -5828     -1620     -     93 +  --mermaid-secondary-color: #161b22;
5860     -5829     -1621     -     94 +  --mermaid-secondary-text-color: #e6edf3;
5861     -5830     -1622     -     95 +  --mermaid-secondary-border-color: #bc8cff;
5862     -5831     -1623     -     96 +
5863     -5832     -1624     -     97 +  /* Tertiary Set - Edge labels */
5864     -5833     -1625     -     98 +  --mermaid-tertiary-color: #0d1117;
5865     -5834     -1626     -     99 +  --mermaid-tertiary-text-color: #e6edf3;
5866     -5835     -1627     -    100 +  --mermaid-tertiary-border-color: #ff7b72;
5867     -5836     -1628     -    101 +
5868     -5837     -1629     -    102 +  /* Flowchart */
5869     -5838     -1630     -    103 +  --mermaid-node-border: #58a6ff;
5870     -5839     -1631     -    104 +  --mermaid-cluster-bkg: #161b22;
5871     -5840     -1632     -    105 +  --mermaid-cluster-border: #bc8cff;
5872     -5841     -1633     -    106 +  --mermaid-default-link-color: #58a6ff;
5873     -5842     -1634     -    107 +  --mermaid-title-color: #e6edf3;
5874     -5843     -1635     -    108 +  --mermaid-edge-label-background: #0d1117;
5875     -5844     -1636     -    109 +  --mermaid-node-text-color: #e6edf3;
5876     -5845     -1637     -    110 +
5877     -5846     -1638     -    111 +  /* Sequence Diagram */
5878     -5847     -1639     -    112 +  --mermaid-actor-bkg: #1c2128;
5879     -5848     -1640     -    113 +  --mermaid-actor-border: #58a6ff;
5880     -5849     -1641     -    114 +  --mermaid-actor-text-color: #e6edf3;
5881     -5850     -1642     -    115 +  --mermaid-actor-line-color: #58a6ff;
5882     -5851     -1643     -    116 +  --mermaid-signal-color: #bc8cff;
5883     -5852     -1644     -    117 +  --mermaid-signal-text-color: #e6edf3;
5884     -5853     -1645     -    118 +  --mermaid-label-box-bkg-color: #1c2128;
5885     -5854     -1646     -    119 +  --mermaid-label-box-border-color: #58a6ff;
5886     -5855     -1647     -    120 +  --mermaid-label-text-color: #e6edf3;
5887     -5856     -1648     -    121 +  --mermaid-loop-text-color: #e6edf3;
5888     -5857     -1649     -    122 +  --mermaid-activation-border-color: #bc8cff;
5889     -5858     -1650     -    123 +  --mermaid-activation-bkg-color: #161b22;
5890     -5859     -1651     -    124 +  --mermaid-sequence-number-color: #e6edf3;
5891     -5860     -1652     -    125 +
5892     -5861     -1653     -    126 +  /* Pie Chart - 12 distinct slice colors + text */
5893     -5862     -1654     -    127 +  --mermaid-pie1: #58a6ff;
5894     -5863     -1655     -    128 +  --mermaid-pie2: #bc8cff;
5895     -5864     -1656     -    129 +  --mermaid-pie3: #ff7b72;
5896     -5865     -1657     -    130 +  --mermaid-pie4: #3fb950;
5897     -5866     -1658     -    131 +  --mermaid-pie5: #ffa657;
5898     -5867     -1659     -    132 +  --mermaid-pie6: #d2a8ff;
5899     -5868     -1660     -    133 +  --mermaid-pie7: #56d4dd;
5900     -5869     -1661     -    134 +  --mermaid-pie8: #7ee787;
5901     -5870     -1662     -    135 +  --mermaid-pie9: #a5d6ff;
5902     -5871     -1663     -    136 +  --mermaid-pie10: #79c0ff;
5903     -5872     -1664     -    137 +  --mermaid-pie11: #d2a8ff;
5904     -5873     -1665     -    138 +  --mermaid-pie12: #ffa657;
5905     -5874     -1666     -    139 +  --mermaid-pie-title-text-color: #e6edf3;
5906     -5875     -1667     -    140 +  --mermaid-pie-section-text-color: #0d1117; /* Dark on vibrant slices */
5907     -5876     -1668     -    141 +  --mermaid-pie-legend-text-color: #e6edf3;
5908     -5877     -1669     -    142 +  --mermaid-pie-stroke-color: #58a6ff;
5909     -5878     -1670     -    143 +  --mermaid-pie-outer-stroke-color: #58a6ff;
5910     -5879     -1671     -    144 +
5911     -5880     -1672     -    145 +  /* State Diagram */
5912     -5881     -1673     -    146 +  --mermaid-label-color: #e6edf3;
5913     -5882     -1674     -    147 +  --mermaid-alt-background: #161b22;
5914     -5883     -1675     -    148 +
5915     -5884     -1676     -    149 +  /* Class Diagram */
5916     -5885     -1677     -    150 +  --mermaid-class-text: #e6edf3;
5917     -5886     -1678     -    151 +
5918     -5887     -1679     -    152 +  /* User Journey - 8 distinct colors */
5919     -5888     -1680     -    153 +  --mermaid-fill-type0: #58a6ff;
5920     -5889     -1681     -    154 +  --mermaid-fill-type1: #bc8cff;
5921     -5890     -1682     -    155 +  --mermaid-fill-type2: #ff7b72;
5922     -5891     -1683     -    156 +  --mermaid-fill-type3: #3fb950;
5923     -5892     -1684     -    157 +  --mermaid-fill-type4: #ffa657;
5924     -5893     -1685     -    158 +  --mermaid-fill-type5: #d2a8ff;
5925     -5894     -1686     -    159 +  --mermaid-fill-type6: #56d4dd;
5926     -5895     -1687     -    160 +  --mermaid-fill-type7: #7ee787;
5927     -5896     -1688     -    161 +
5928     -5897     -1689     -    162 +  /* Gantt Chart */
5929     -5898     -1690     -    163 +  --mermaid-section-bkg-color: #1c2128;
5930     -5899     -1691     -    164 +  --mermaid-alt-section-bkg-color: #161b22;
5931     -5900     -1692     -    165 +  --mermaid-section-bkg-color2: #1c2128;
5932     -5901     -1693     -    166 +  --mermaid-task-text-color: #e6edf3;
5933     -5902     -1694     -    167 +  --mermaid-task-text-light-color: #e6edf3;
5934     -5903     -1695     -    168 +  --mermaid-task-text-outside-color: #e6edf3;
5935     -5904     -1696     -    169 +  --mermaid-task-text-clickable-color: #58a6ff;
5936     -5905     -1697     -    170 +  --mermaid-active-task-bkg-color: #58a6ff;
5937     -5906     -1698     -    171 +  --mermaid-active-task-border-color: #58a6ff;
5938     -5907     -1699     -    172 +  --mermaid-done-task-bkg-color: #3fb950;
5939     -5908     -1700     -    173 +  --mermaid-done-task-border-color: #3fb950;
5940     -5909     -1701     -    174 +  --mermaid-crit-border-color: #ff7b72;
5941     -5910     -1702     -    175 +  --mermaid-crit-bkg-color: #ff7b72;
5942     -5911     -1703     -    176 +  --mermaid-today-line-color: #ff7b72;
5943     -5912     -1704     -    177 +  --mermaid-grid-color: #30363d;
5944     -5913     -1705     -    178 +  --mermaid-section-text-color: #e6edf3;
5945     -5914     -1706     -    179 +  --mermaid-task-border-color: #58a6ff;
5946     -5915     -1707     -    180 +
5947     -5916     -1708     -    181 +  /* ER Diagram */
5948     -5917     -1709     -    182 +  --mermaid-attribute-background-color-odd: #161b22;
5949     -5918     -1710     -    183 +  --mermaid-attribute-background-color-even: #0d1117;
5950     -5919     -1711     -    184 +  --mermaid-relationship-label-background: #0d1117;
5951     -5920     -1712     -    185 +  --mermaid-relationship-label-color: #e6edf3;
5952     -5921     -1713     -    186 +  --mermaid-entity-background: #1c2128;
5953     -5922     -1714     -    187 +  --mermaid-entity-border-color: #58a6ff;
5954     -5923     -1715     -    188 +
5955     -5924     -1716     -    189 +  /* Git Graph */
5956     -5925     -1717     -    190 +  --mermaid-git0: #58a6ff;
5957     -5926     -1718     -    191 +  --mermaid-git1: #bc8cff;
5958     -5927     -1719     -    192 +  --mermaid-git2: #ff7b72;
5959     -5928     -1720     -    193 +  --mermaid-git3: #3fb950;
5960     -5929     -1721     -    194 +  --mermaid-git4: #ffa657;
5961     -5930     -1722     -    195 +  --mermaid-git5: #d2a8ff;
5962     -5931     -1723     -    196 +  --mermaid-git6: #56d4dd;
5963     -5932     -1724     -    197 +  --mermaid-git7: #7ee787;
5964     -5933     -1725     -    198 +  --mermaid-git-inv0: #0d1117;
5965     -5934     -1726     -    199 +  --mermaid-git-branch-label0: #e6edf3;
5966     -5935     -1727     -    200 +  --mermaid-git-branch-label1: #e6edf3;
5967     -5936     -1728     -    201 +  --mermaid-git-branch-label2: #e6edf3;
5968     -5937     -1729     -    202 +  --mermaid-git-branch-label3: #e6edf3;
5969     -5938     -1730     -    203 +  --mermaid-git-branch-label4: #e6edf3;
5970     -5939     -1731     -    204 +  --mermaid-commit-label-color: #e6edf3;
5971     -5940     -1732     -    205 +  --mermaid-commit-label-background: #0d1117;
5972     -5941     -1733     -    206 +  --mermaid-tag-label-color: #e6edf3;
5973     -5942     -1734     -    207 +  --mermaid-tag-label-background: #1c2128;
5974     -5943     -1735     -    208 +  --mermaid-tag-label-border: #58a6ff;
5975     -5944     -1736     - 49 209  }
5976     -5945     -1737     - 50 210  
5977     -5946     -1738     -
5978     -5947     -1739     -```
5979     -5948     -1740     -
5980     -5949     -1741     -
5981     -5950     -1742     -### üìÑ `themes/default-light.css`
5982     -5951     -1743     -
5983     -5952     -1744     -**Type:** Stylesheet üé®
5984     -5953     -1745     -
5985     -5954     -1746     -```diff
5986     -5955     -1747     -@@ -26,24 +26,184 @@
5987     -5956     -1748     - 26  26    --code-block-bg: #f6f8fa;
5988     -5957     -1749     - 27  27    --code-border: #d0d7de;
5989     -5958     -1750     - 28  28  
5990     -5959     -1751     - 29     -  /* Syntax Highlighting - Comprehensive Token Colors */
5991     -5960     -1752     - 30     -  --syntax-keyword: #cf222e;
5992     -5961     -1753     - 31     -  --syntax-string: #1a7f37;
5993     -5962     -1754     - 32     -  --syntax-number: #0550ae;
5994     -5963     -1755     - 33     -  --syntax-function: #8250df;
5995     -5964     -1756     - 34     -  --syntax-comment: #636c76;
5996     -5965     -1757     - 35     -  --syntax-operator: #cf222e;
5997     -5966     -1758     - 36     -  --syntax-punctuation: #636c76;
5998     -5967     -1759     -     29 +  /* Syntax Highlighting - Production-Grade Token Colors (One Dark Architecture) */
5999     -5968     -1760     - 37  30  
6000     -5969     -1761     - 38     -  /* Additional Token Types for Full Customization */
6001     -5970     -1762     - 39     -  --syntax-variable: #0550ae; /* Variables, parameters */
6002     -5971     -1763     - 40     -  --syntax-property: #1a7f37; /* Properties, attributes */
6003     -5972     -1764     - 41     -  --syntax-namespace: #cf222e; /* Namespaces */
6004     -5973     -1765     - 42     -  --syntax-builtin: #8250df; /* Built-in functions */
6005     -5974     -1766     -     31 +  /* Core hue-1: Cyan - URLs */
6006     -5975     -1767     -     32 +  --syntax-url: #0969da; /* GitHub blue for URLs */
6007     -5976     -1768     -     33 +
6008     -5977     -1769     -     34 +  /* Core hue-2: Blue - Functions, variables */
6009     -5978     -1770     -     35 +  --syntax-function: #8250df; /* Purple-blue for functions */
6010     -5979     -1771     -     36 +  --syntax-variable: #0550ae; /* Deep blue for variables */
6011     -5980     -1772     -     37 +
6012     -5981     -1773     -     38 +  /* Core hue-3: Red - Keywords */
6013     -5982     -1774     -     39 +  --syntax-keyword: #cf222e; /* GitHub red for keywords (final, sealed, class) */
6014     -5983     -1775     -     40 +
6015     -5984     -1776     -     41 +  /* Core hue-4: Green - Strings, builtins */
6016     -5985     -1777     -     42 +  --syntax-string: #1a7f37; /* GitHub green for strings */
6017     -5986     -1778     -     43 +  --syntax-builtin: #116329; /* Darker green for builtins (String, List) */
6018     -5987     -1779     -     44 +  --syntax-char: #1a7f37; /* Same as strings */
6019     -5988     -1780     -     45 +  --syntax-regex: #1a7f37; /* Same as strings */
6020     -5989     -1781     -     46 +  --syntax-inserted: #1a7f37; /* For diff */
6021     -5990     -1782     -     47 +
6022     -5991     -1783     -     48 +  /* Core hue-5: Orange/Brown - Properties, tags */
6023     -5992     -1784     -     49 +  --syntax-property: #bc4c00; /* Orange-brown for properties */
6024     -5993     -1785     -     50 +  --syntax-tag: #cf222e; /* Red for tags */
6025     -5994     -1786     -     51 +  --syntax-deleted: #cf222e; /* For diff */
6026     -5995     -1787     -     52 +  --syntax-important: #bc4c00; /* For !important */
6027     -5996     -1788     -     53 +
6028     -5997     -1789     -     54 +  /* Core hue-6: Blue - Class names, constants, numbers */
6029     -5998     -1790     -     55 +  --syntax-class-name: #0969da; /* Bright blue for class names (Rectangle, Shape) */
6030     -5999     -1791     -     56 +  --syntax-number: #0550ae; /* Deep blue for numbers */
6031     -6000     -1792     -     57 +  --syntax-constant: #0969da; /* Bright blue for constants */
6032     -6001     -1793     -     58 +  --syntax-boolean: #0550ae; /* Same as numbers */
6033     -6002     -1794     -     59 +  --syntax-atrule: #8250df; /* Purple for CSS @ rules */
6034     -6003     -1795     -     60 +
6035     -6004     -1796     -     61 +  /* Neutral colors */
6036     -6005     -1797     -     62 +  --syntax-comment: #636c76; /* GitHub gray for comments */
6037     -6006     -1798     -     63 +  --syntax-punctuation: #636c76; /* Gray for punctuation */
6038     -6007     -1799     -     64 +  --syntax-operator: #cf222e; /* Red for operators */
6039     -6008     -1800     -     65 +
6040     -6009     -1801     -     66 +  /* Markup specific */
6041     -6010     -1802     -     67 +  --syntax-attr-name: #0969da; /* Blue like class-name */
6042     -6011     -1803     -     68 +  --syntax-attr-value: #1a7f37; /* Green like strings */
6043     -6012     -1804     -     69 +  --syntax-namespace: #8250df; /* Purple */
6044     -6013     -1805     -     70 +  --syntax-entity: #636c76; /* Neutral */
6045     -6014     -1806     -     71 +  --syntax-selector: #bc4c00; /* Orange like properties */
6046     -6015     -1807     - 43  72  
6047     -6016     -1808     - 44  73    --blockquote-border: #0969da;
6048     -6017     -1809     - 45  74    --blockquote-bg: #ddf4ff;
6049     -6018     -1810     - 46  75  
6050     -6019     -1811     - 47  76    --table-header-bg: #f6f8fa;
6051     -6020     -1812     - 48  77    --table-border: #d0d7de;
6052     -6021     -1813     -     78 +
6053     -6022     -1814     -     79 +  /* === MERMAID COMPREHENSIVE CONFIGURATION === */
6054     -6023     -1815     -     80 +
6055     -6024     -1816     -     81 +  /* Core Global */
6056     -6025     -1817     -     82 +  --mermaid-background: #ffffff;
6057     -6026     -1818     -     83 +  --mermaid-text-color: #1f2328;
6058     -6027     -1819     -     84 +  --mermaid-line-color: #0969da;
6059     -6028     -1820     -     85 +  --mermaid-main-bkg: #eaeef2;
6060     -6029     -1821     -     86 +
6061     -6030     -1822     -     87 +  /* Primary Set */
6062     -6031     -1823     -     88 +  --mermaid-primary-color: #eaeef2;
6063     -6032     -1824     -     89 +  --mermaid-primary-text-color: #1f2328;
6064     -6033     -1825     -     90 +  --mermaid-primary-border-color: #0969da;
6065     -6034     -1826     -     91 +
6066     -6035     -1827     -     92 +  /* Secondary Set */
6067     -6036     -1828     -     93 +  --mermaid-secondary-color: #f6f8fa;
6068     -6037     -1829     -     94 +  --mermaid-secondary-text-color: #1f2328;
6069     -6038     -1830     -     95 +  --mermaid-secondary-border-color: #8250df;
6070     -6039     -1831     -     96 +
6071     -6040     -1832     -     97 +  /* Tertiary Set */
6072     -6041     -1833     -     98 +  --mermaid-tertiary-color: #ffffff;
6073     -6042     -1834     -     99 +  --mermaid-tertiary-text-color: #1f2328;
6074     -6043     -1835     -    100 +  --mermaid-tertiary-border-color: #cf222e;
6075     -6044     -1836     -    101 +
6076     -6045     -1837     -    102 +  /* Flowchart */
6077     -6046     -1838     -    103 +  --mermaid-node-border: #0969da;
6078     -6047     -1839     -    104 +  --mermaid-cluster-bkg: #f6f8fa;
6079     -6048     -1840     -    105 +  --mermaid-cluster-border: #8250df;
6080     -6049     -1841     -    106 +  --mermaid-default-link-color: #0969da;
6081     -6050     -1842     -    107 +  --mermaid-title-color: #1f2328;
6082     -6051     -1843     -    108 +  --mermaid-edge-label-background: #ffffff;
6083     -6052     -1844     -    109 +  --mermaid-node-text-color: #1f2328;
6084     -6053     -1845     -    110 +
6085     -6054     -1846     -    111 +  /* Sequence Diagram */
6086     -6055     -1847     -    112 +  --mermaid-actor-bkg: #eaeef2;
6087     -6056     -1848     -    113 +  --mermaid-actor-border: #0969da;
6088     -6057     -1849     -    114 +  --mermaid-actor-text-color: #1f2328;
6089     -6058     -1850     -    115 +  --mermaid-actor-line-color: #0969da;
6090     -6059     -1851     -    116 +  --mermaid-signal-color: #8250df;
6091     -6060     -1852     -    117 +  --mermaid-signal-text-color: #1f2328;
6092     -6061     -1853     -    118 +  --mermaid-label-box-bkg-color: #eaeef2;
6093     -6062     -1854     -    119 +  --mermaid-label-box-border-color: #0969da;
6094     -6063     -1855     -    120 +  --mermaid-label-text-color: #1f2328;
6095     -6064     -1856     -    121 +  --mermaid-loop-text-color: #1f2328;
6096     -6065     -1857     -    122 +  --mermaid-activation-border-color: #8250df;
6097     -6066     -1858     -    123 +  --mermaid-activation-bkg-color: #f6f8fa;
6098     -6067     -1859     -    124 +  --mermaid-sequence-number-color: #1f2328;
6099     -6068     -1860     -    125 +
6100     -6069     -1861     -    126 +  /* Pie Chart */
6101     -6070     -1862     -    127 +  --mermaid-pie1: #0969da;
6102     -6071     -1863     -    128 +  --mermaid-pie2: #8250df;
6103     -6072     -1864     -    129 +  --mermaid-pie3: #cf222e;
6104     -6073     -1865     -    130 +  --mermaid-pie4: #1a7f37;
6105     -6074     -1866     -    131 +  --mermaid-pie5: #bc4c00;
6106     -6075     -1867     -    132 +  --mermaid-pie6: #0550ae;
6107     -6076     -1868     -    133 +  --mermaid-pie7: #116329;
6108     -6077     -1869     -    134 +  --mermaid-pie8: #0969da;
6109     -6078     -1870     -    135 +  --mermaid-pie9: #8250df;
6110     -6079     -1871     -    136 +  --mermaid-pie10: #cf222e;
6111     -6080     -1872     -    137 +  --mermaid-pie11: #1a7f37;
6112     -6081     -1873     -    138 +  --mermaid-pie12: #bc4c00;
6113     -6082     -1874     -    139 +  --mermaid-pie-title-text-color: #1f2328;
6114     -6083     -1875     -    140 +  --mermaid-pie-section-text-color: #ffffff; /* White on vibrant slices */
6115     -6084     -1876     -    141 +  --mermaid-pie-legend-text-color: #1f2328;
6116     -6085     -1877     -    142 +  --mermaid-pie-stroke-color: #0969da;
6117     -6086     -1878     -    143 +  --mermaid-pie-outer-stroke-color: #0969da;
6118     -6087     -1879     -    144 +
6119     -6088     -1880     -    145 +  /* State Diagram */
6120     -6089     -1881     -    146 +  --mermaid-label-color: #1f2328;
6121     -6090     -1882     -    147 +  --mermaid-alt-background: #f6f8fa;
6122     -6091     -1883     -    148 +
6123     -6092     -1884     -    149 +  /* Class Diagram */
6124     -6093     -1885     -    150 +  --mermaid-class-text: #1f2328;
6125     -6094     -1886     -    151 +
6126     -6095     -1887     -    152 +  /* User Journey */
6127     -6096     -1888     -    153 +  --mermaid-fill-type0: #0969da;
6128     -6097     -1889     -    154 +  --mermaid-fill-type1: #8250df;
6129     -6098     -1890     -    155 +  --mermaid-fill-type2: #cf222e;
6130     -6099     -1891     -    156 +  --mermaid-fill-type3: #1a7f37;
6131     -6100     -1892     -    157 +  --mermaid-fill-type4: #bc4c00;
6132     -6101     -1893     -    158 +  --mermaid-fill-type5: #0550ae;
6133     -6102     -1894     -    159 +  --mermaid-fill-type6: #116329;
6134     -6103     -1895     -    160 +  --mermaid-fill-type7: #0969da;
6135     -6104     -1896     -    161 +
6136     -6105     -1897     -    162 +  /* Gantt Chart */
6137     -6106     -1898     -    163 +  --mermaid-section-bkg-color: #eaeef2;
6138     -6107     -1899     -    164 +  --mermaid-alt-section-bkg-color: #f6f8fa;
6139     -6108     -1900     -    165 +  --mermaid-section-bkg-color2: #eaeef2;
6140     -6109     -1901     -    166 +  --mermaid-task-text-color: #1f2328;
6141     -6110     -1902     -    167 +  --mermaid-task-text-light-color: #1f2328;
6142     -6111     -1903     -    168 +  --mermaid-task-text-outside-color: #1f2328;
6143     -6112     -1904     -    169 +  --mermaid-task-text-clickable-color: #0969da;
6144     -6113     -1905     -    170 +  --mermaid-active-task-bkg-color: #0969da;
6145     -6114     -1906     -    171 +  --mermaid-active-task-border-color: #0969da;
6146     -6115     -1907     -    172 +  --mermaid-done-task-bkg-color: #1a7f37;
6147     -6116     -1908     -    173 +  --mermaid-done-task-border-color: #1a7f37;
6148     -6117     -1909     -    174 +  --mermaid-crit-border-color: #cf222e;
6149     -6118     -1910     -    175 +  --mermaid-crit-bkg-color: #cf222e;
6150     -6119     -1911     -    176 +  --mermaid-today-line-color: #cf222e;
6151     -6120     -1912     -    177 +  --mermaid-grid-color: #d0d7de;
6152     -6121     -1913     -    178 +  --mermaid-section-text-color: #1f2328;
6153     -6122     -1914     -    179 +  --mermaid-task-border-color: #0969da;
6154     -6123     -1915     -    180 +
6155     -6124     -1916     -    181 +  /* ER Diagram */
6156     -6125     -1917     -    182 +  --mermaid-attribute-background-color-odd: #f6f8fa;
6157     -6126     -1918     -    183 +  --mermaid-attribute-background-color-even: #ffffff;
6158     -6127     -1919     -    184 +  --mermaid-relationship-label-background: #ffffff;
6159     -6128     -1920     -    185 +  --mermaid-relationship-label-color: #1f2328;
6160     -6129     -1921     -    186 +  --mermaid-entity-background: #eaeef2;
6161     -6130     -1922     -    187 +  --mermaid-entity-border-color: #0969da;
6162     -6131     -1923     -    188 +
6163     -6132     -1924     -    189 +  /* Git Graph */
6164     -6133     -1925     -    190 +  --mermaid-git0: #0969da;
6165     -6134     -1926     -    191 +  --mermaid-git1: #8250df;
6166     -6135     -1927     -    192 +  --mermaid-git2: #cf222e;
6167     -6136     -1928     -    193 +  --mermaid-git3: #1a7f37;
6168     -6137     -1929     -    194 +  --mermaid-git4: #bc4c00;
6169     -6138     -1930     -    195 +  --mermaid-git5: #0550ae;
6170     -6139     -1931     -    196 +  --mermaid-git6: #116329;
6171     -6140     -1932     -    197 +  --mermaid-git7: #0969da;
6172     -6141     -1933     -    198 +  --mermaid-git-inv0: #ffffff;
6173     -6142     -1934     -    199 +  --mermaid-git-branch-label0: #1f2328;
6174     -6143     -1935     -    200 +  --mermaid-git-branch-label1: #1f2328;
6175     -6144     -1936     -    201 +  --mermaid-git-branch-label2: #1f2328;
6176     -6145     -1937     -    202 +  --mermaid-git-branch-label3: #1f2328;
6177     -6146     -1938     -    203 +  --mermaid-git-branch-label4: #1f2328;
6178     -6147     -1939     -    204 +  --mermaid-commit-label-color: #1f2328;
6179     -6148     -1940     -    205 +  --mermaid-commit-label-background: #ffffff;
6180     -6149     -1941     -    206 +  --mermaid-tag-label-color: #1f2328;
6181     -6150     -1942     -    207 +  --mermaid-tag-label-background: #eaeef2;
6182     -6151     -1943     -    208 +  --mermaid-tag-label-border: #0969da;
6183     -6152     -1944     - 49 209  }
6184     -6153     -1945     - 50 210  
6185     -6154     -1946     -
6186     -6155     -1947     -```
6187     -6156     -1948     -
6188     -6157     -1949     -
6189     -6158     -1950     -### üìÑ `themes/forest-dark.css`
6190     -6159     -1951     -
6191     -6160     -1952     -**Type:** Stylesheet üé®
6192     -6161     -1953     -
6193     -6162     -1954     -```diff
6194     -6163     -1955     -@@ -1,11 +1,11 @@
6195     -6164     -1956     -  1     -/* Forest Dark Theme */
6196     -6165     -1957     -      1 +/* Forest Dark Theme - Deep Jungle Aesthetic */
6197     -6166     -1958     -  2   2  :root {
6198     -6167     -1959     -  3     -  --bg-primary: #0f1c0a;
6199     -6168     -1960     -  4     -  --bg-secondary: #1a2817;
6200     -6169     -1961     -  5     -  --bg-tertiary: #2d4a2b;
6201     -6170     -1962     -  6     -  --text-primary: #d9f99d;
6202     -6171     -1963     -  7     -  --text-secondary: #a3e635;
6203     -6172     -1964     -  8     -  --border-color: #3f6212;
6204     -6173     -1965     -      3 +  --bg-primary: #0a1408; /* Deep forest green with blue undertones */
6205     -6174     -1966     -      4 +  --bg-secondary: #132118; /* Darker moss green */
6206     -6175     -1967     -      5 +  --bg-tertiary: #1e3a29; /* Rich forest green */
6207     -6176     -1968     -      6 +  --text-primary: #d9f99d; /* Bright lime (firefly glow) */
6208     -6177     -1969     -      7 +  --text-secondary: #a3e635; /* Vibrant lime */
6209     -6178     -1970     -      8 +  --border-color: #2d5a3d; /* Forest green border */
6210     -6179     -1971     -  9   9  
6211     -6180     -1972     - 10  10    --h1-color: #84cc16;
6212     -6181     -1973     - 11  11    --h2-color: #a3e635;
6213     -6182     -1974     -@@ -17,31 +17,144 @@
6214     -6183     -1975     - 17  17    --link-color: #84cc16;
6215     -6184     -1976     - 18  18    --link-hover: #a3e635;
6216     -6185     -1977     - 19  19  
6217     -6186     -1978     - 20     -  /* Code Colors */
6218     -6187     -1979     - 21     -  --code-bg: #1a2817;
6219     -6188     -1980     -     20 +  /* Code Colors - Organic forest glow */
6220     -6189     -1981     -     21 +  --code-bg: rgba(132, 204, 22, 0.12); /* Lime-tinted background */
6221     -6190     -1982     - 22  22    --code-text: #a3e635;
6222     -6191     -1983     - 23     -  --code-block-bg: #0f1c0a;
6223     -6192     -1984     - 24     -  --code-border: #3f6212;
6224     -6193     -1985     -     23 +  --code-block-bg: #0d1a11; /* Deep forest with blue-green tint */
6225     -6194     -1986     -     24 +  --code-border: rgba(163, 230, 53, 0.3); /* Lime glow border */
6226     -6195     -1987     - 25  25  
6227     -6196     -1988     - 26     -  /* Syntax Highlighting - Comprehensive Token Colors */
6228     -6197     -1989     - 27     -  --syntax-keyword: #84cc16;
6229     -6198     -1990     - 28     -  --syntax-string: #a3e635;
6230     -6199     -1991     - 29     -  --syntax-number: #bef264;
6231     -6200     -1992     - 30     -  --syntax-function: #4ade80;
6232     -6201     -1993     - 31     -  --syntax-comment: #737373;
6233     -6202     -1994     - 32     -  --syntax-operator: #22c55e;
6234     -6203     -1995     - 33     -  --syntax-punctuation: #a3a3a3;
6235     -6204     -1996     -     26 +  /* Syntax Highlighting - Production-Grade Token Colors (One Dark Architecture) */
6236     -6205     -1997     - 34  27  
6237     -6206     -1998     - 35     -  /* Additional Token Types */
6238     -6207     -1999     - 36     -  --syntax-variable: #bef264; /* Variables - bright lime (distinct from text #d9f99d) */
6239     -6208     -2000     - 37     -  --syntax-property: #4ade80; /* Properties - green */
6240     -6209     -2001     - 38     -  --syntax-namespace: #84cc16; /* Namespaces - lime */
6241     -6210     -2002     - 39     -  --syntax-builtin: #22c55e; /* Builtins - green */
6242     -6211     -2003     -     28 +  /* Core hue-1: Teal - URLs */
6243     -6212     -2004     -     29 +  --syntax-url: #5eead4; /* Bright teal for URLs */
6244     -6213     -2005     -     30 +
6245     -6214     -2006     -     31 +  /* Core hue-2: Green - Functions, variables */
6246     -6215     -2007     -     32 +  --syntax-function: #4ade80; /* Bright green for functions */
6247     -6216     -2008     -     33 +  --syntax-variable: #22c55e; /* Medium green for variables */
6248     -6217     -2009     -     34 +
6249     -6218     -2010     -     35 +  /* Core hue-3: Yellow - Keywords */
6250     -6219     -2011     -     36 +  --syntax-keyword: #fbbf24; /* Golden yellow for keywords (final, sealed, class) */
6251     -6220     -2012     -     37 +
6252     -6221     -2013     -     38 +  /* Core hue-4: Lime - Strings, builtins */
6253     -6222     -2014     -     39 +  --syntax-string: #a3e635; /* Bright lime for strings */
6254     -6223     -2015     -     40 +  --syntax-builtin: #84cc16; /* Lime for builtins (String, List) */
6255     -6224     -2016     -     41 +  --syntax-char: #a3e635; /* Same as strings */
6256     -6225     -2017     -     42 +  --syntax-regex: #a3e635; /* Same as strings */
6257     -6226     -2018     -     43 +  --syntax-inserted: #84cc16; /* For diff */
6258     -6227     -2019     -     44 +
6259     -6228     -2020     -     45 +  /* Core hue-5: Orange/Amber - Properties, tags */
6260     -6229     -2021     -     46 +  --syntax-property: #fb923c; /* Orange for properties */
6261     -6230     -2022     -     47 +  --syntax-tag: #f97316; /* Burnt orange for tags */
6262     -6231     -2023     -     48 +  --syntax-deleted: #f87171; /* Coral for diff */
6263     -6232     -2024     -     49 +  --syntax-important: #fb923c; /* Orange for !important */
6264     -6233     -2025     -     50 +
6265     -6234     -2026     -     51 +  /* Core hue-6: Yellow-green - Class names, constants, numbers */
6266     -6235     -2027     -     52 +  --syntax-class-name: #bef264; /* Bright yellow-green for class names (Rectangle, Shape) */
6267     -6236     -2028     -     53 +  --syntax-number: #fde047; /* Bright yellow for numbers */
6268     -6237     -2029     -     54 +  --syntax-constant: #84cc16; /* Lime for constants */
6269     -6238     -2030     -     55 +  --syntax-boolean: #fde047; /* Same as numbers */
6270     -6239     -2031     -     56 +  --syntax-atrule: #a3e635; /* Lime for CSS @ rules */
6271     -6240     -2032     -     57 +
6272     -6241     -2033     -     58 +  /* Neutral colors */
6273     -6242     -2034     -     59 +  --syntax-comment: #737373; /* Gray for comments */
6274     -6243     -2035     -     60 +  --syntax-punctuation: #a3a3a3; /* Light gray for punctuation */
6275     -6244     -2036     -     61 +  --syntax-operator: #22c55e; /* Green for operators */
6276     -6245     -2037     -     62 +
6277     -6246     -2038     -     63 +  /* Markup specific */
6278     -6247     -2039     -     64 +  --syntax-attr-name: #bef264; /* Yellow-green like class-name */
6279     -6248     -2040     -     65 +  --syntax-attr-value: #a3e635; /* Lime like strings */
6280     -6249     -2041     -     66 +  --syntax-namespace: #fbbf24; /* Yellow like keywords */
6281     -6250     -2042     -     67 +  --syntax-entity: #a3a3a3; /* Neutral */
6282     -6251     -2043     -     68 +  --syntax-selector: #fb923c; /* Orange like properties */
6283     -6252     -2044     - 40  69  
6284     -6253     -2045     - 41  70    --blockquote-border: #84cc16;
6285     -6254     -2046     - 42     -  --blockquote-bg: #1a2817;
6286     -6255     -2047     -     71 +  --blockquote-bg: rgba(132, 204, 22, 0.08); /* Lime-tinted blockquote */
6287     -6256     -2048     - 43  72    --bold-color: #fbbf24;
6288     -6257     -2049     - 44  73    --italic-color: #84cc16;
6289     -6258     -2050     - 45     -  --table-header-bg: #2d4a2b;
6290     -6259     -2051     - 46     -  --table-border: #3f6212;
6291     -6260     -2052     -     74 +  --table-header-bg: rgba(74, 222, 128, 0.12); /* Green-tinted table header */
6292     -6261     -2053     -     75 +  --table-border: rgba(45, 90, 61, 0.4); /* Forest-tinted border */
6293     -6262     -2054     -     76 +
6294     -6263     -2055     -     77 +  /* === MERMAID COMPREHENSIVE CONFIGURATION === */
6295     -6264     -2056     -     78 +  /* Complete control over ALL diagram elements */
6296     -6265     -    4212 +     78 +---
6297     -6266     -2057 4213       79 +
6298     -6267     -2058     -     80 +  /* Core Global */
6299     -6268     -2059     -     81 +  --mermaid-background: #0a1408;
6300     -6269     -2060     -     82 +  --mermaid-text-color: #d9f99d;
6301     -6270     -2061     -     83 +  --mermaid-line-color: #a3e635;
6302     -6271     -2062     -     84 +  --mermaid-main-bkg: #2d5a3d;
6303     -6272     -    4214 +     80 +## üîç Nitpicks & Code Style (Senior SDE Standards)
6304     -6273     -    4215 +     81 +
6305     -6274     -    4216 +     82 +### 8. üìù Hardcoded Content (Lines 297-381)
6306     -6275     -    4217 +     83 +**Critique:** The default "Welcome" markdown is 84 lines of hardcoded string inside a logic file.
6307     -6276     -    4218 +     84 +- **Fix:** Move to `src/js/config/defaultContent.js` or load from a file.
6308     -6277     -2063 4219       85 +
6309     -6278     -2064     -     86 +  /* Primary Set - Main nodes/boxes */
6310     -6279     -2065     -     87 +  --mermaid-primary-color: #2d5a3d;
6311     -6280     -2066     -     88 +  --mermaid-primary-text-color: #d9f99d;
6312     -6281     -2067     -     89 +  --mermaid-primary-border-color: #84cc16;
6313     -6282     -2068     -     90 +
6314     -6283     -2069     -     91 +  /* Secondary Set - Clusters/subgraphs */
6315     -6284     -2070     -     92 +  --mermaid-secondary-color: #1e3a29;
6316     -6285     -2071     -     93 +  --mermaid-secondary-text-color: #d9f99d;
6317     -6286     -2072     -     94 +  --mermaid-secondary-border-color: #a3e635;
6318     -6287     -2073     -     95 +
6319     -6288     -2074     -     96 +  /* Tertiary Set - Edge labels */
6320     -6289     -2075     -     97 +  --mermaid-tertiary-color: #0a1408;
6321     -6290     -2076     -     98 +  --mermaid-tertiary-text-color: #d9f99d;
6322     -6291     -2077     -     99 +  --mermaid-tertiary-border-color: #bef264;
6323     -6292     -2078     -    100 +
6324     -6293     -2079     -    101 +  /* Flowchart */
6325     -6294     -2080     -    102 +  --mermaid-node-border: #84cc16;
6326     -6295     -2081     -    103 +  --mermaid-cluster-bkg: #1e3a29;
6327     -6296     -2082     -    104 +  --mermaid-cluster-border: #a3e635;
6328     -6297     -2083     -    105 +  --mermaid-default-link-color: #a3e635;
6329     -6298     -2084     -    106 +  --mermaid-title-color: #d9f99d;
6330     -6299     -2085     -    107 +  --mermaid-edge-label-background: #0a1408;
6331     -6300     -2086     -    108 +  --mermaid-node-text-color: #d9f99d;
6332     -6301     -    4220 +     86 +### 9. üé® CSS Variable Extraction (Line 553)
6333     -6302     -    4221 +     87 +```javascript
6334     -6303     -    4222 +     88 +const currentValue = getComputedStyle(document.documentElement).getPropertyValue(varName).trim();
6335     -6304     -    4223 +     89 +```
6336     -6305     -    4224 +     90 +**Critique:** You are calling `getComputedStyle` inside a loop (`forEach` on Line 550).
6337     -6306     -    4225 +     91 +- **Impact:** This forces a **Style Recalculation** (Reflow) on every iteration. Expensive.
6338     -6307     -    4226 +     92 +- **Fix:** Cache `getComputedStyle` once outside the loop.
6339     -6308     -    4227 +     93 +
6340     -6309     -    4228 +     94 +### 10. ‚ùå Regex ReDoS Potential (Lines 111, 485)
6341     -6310     -    4229 +     95 +```javascript
6342     -6311     -    4230 +     96 +// Line 485
6343     -6312     -    4231 +     97 +html = html.replace(/<pre><code class="language-mermaid">([\s\S]*?)<\/code><\/pre>/g, ...
6344     -6313     -    4232 +     98 +```
6345     -6314     -    4233 +     99 +**Critique:** `[\s\S]*?` is generally safe-ish, but processing the entire HTML output with regex to find code blocks is fragile HTML parsing.
6346     -6315     -    4234 +    100 +- **Fix:** Marked.js has a `renderer` option. Override the `code` renderer instead of string-replacing the output HTML. This is much cleaner and safer.
6347     -6316     -    4235 +    101 +
6348     -6317     -    4236 +    102 +### 11. üß© Mixed 'var' and 'let' (Lines 884-885)
6349     -6318     -    4237 +    103 +```javascript
6350     -6319     -    4238 +    104 +var syncScrollEnabled = ...
6351     -6320     -    4239 +    105 +var syncScrolling = ...
6352     -6321     -    4240 +    106 +```
6353     -6322     -    4241 +    107 +**Critique:** Why `var`? You used `const/let` everywhere else.
6354     -6323     -    4242 +    108 +- **Fix:** Be consistent. Use `let`.
6355     -6324     -2087 4243      109 +
6356     -6325     -2088     -    110 +  /* Sequence Diagram */
6357     -6326     -2089     -    111 +  --mermaid-actor-bkg: #2d5a3d;
6358     -6327     -2090     -    112 +  --mermaid-actor-border: #84cc16;
6359     -6328     -2091     -    113 +  --mermaid-actor-text-color: #d9f99d;
6360     -6329     -2092     -    114 +  --mermaid-actor-line-color: #84cc16;
6361     -6330     -2093     -    115 +  --mermaid-signal-color: #a3e635;
6362     -6331     -2094     -    116 +  --mermaid-signal-text-color: #d9f99d;
6363     -6332     -2095     -    117 +  --mermaid-label-box-bkg-color: #2d5a3d;
6364     -6333     -2096     -    118 +  --mermaid-label-box-border-color: #84cc16;
6365     -6334     -2097     -    119 +  --mermaid-label-text-color: #d9f99d;
6366     -6335     -2098     -    120 +  --mermaid-loop-text-color: #d9f99d;
6367     -6336     -2099     -    121 +  --mermaid-activation-border-color: #a3e635;
6368     -6337     -2100     -    122 +  --mermaid-activation-bkg-color: #1e3a29;
6369     -6338     -2101     -    123 +  --mermaid-sequence-number-color: #d9f99d;
6370     -6339     -2102     -    124 +
6371     -6340     -2103     -    125 +  /* Pie Chart - 12 distinct slice colors + text colors */
6372     -6341     -2104     -    126 +  --mermaid-pie1: #4ade80;
6373     -6342     -2105     -    127 +  --mermaid-pie2: #fbbf24;
6374     -6343     -2106     -    128 +  --mermaid-pie3: #fb923c;
6375     -6344     -2107     -    129 +  --mermaid-pie4: #5eead4;
6376     -6345     -2108     -    130 +  --mermaid-pie5: #a3e635;
6377     -6346     -2109     -    131 +  --mermaid-pie6: #22c55e;
6378     -6347     -2110     -    132 +  --mermaid-pie7: #84cc16;
6379     -6348     -2111     -    133 +  --mermaid-pie8: #fde047;
6380     -6349     -2112     -    134 +  --mermaid-pie9: #4ade80;
6381     -6350     -2113     -    135 +  --mermaid-pie10: #fbbf24;
6382     -6351     -2114     -    136 +  --mermaid-pie11: #fb923c;
6383     -6352     -2115     -    137 +  --mermaid-pie12: #5eead4;
6384     -6353     -2116     -    138 +  --mermaid-pie-title-text-color: #d9f99d;
6385     -6354     -2117     -    139 +  --mermaid-pie-section-text-color: #0a1408; /* Dark on vibrant slices */
6386     -6355     -2118     -    140 +  --mermaid-pie-legend-text-color: #d9f99d;
6387     -6356     -2119     -    141 +  --mermaid-pie-stroke-color: #84cc16;
6388     -6357     -2120     -    142 +  --mermaid-pie-outer-stroke-color: #84cc16;
6389     -6358     -2121     -    143 +
6390     -6359     -2122     -    144 +  /* State Diagram */
6391     -6360     -2123     -    145 +  --mermaid-label-color: #d9f99d;
6392     -6361     -2124     -    146 +  --mermaid-alt-background: #1e3a29;
6393     -6362     -2125     -    147 +
6394     -6363     -2126     -    148 +  /* Class Diagram */
6395     -6364     -2127     -    149 +  --mermaid-class-text: #d9f99d;
6396     -6365     -2128     -    150 +
6397     -6366     -2129     -    151 +  /* User Journey - 8 distinct colors */
6398     -6367     -2130     -    152 +  --mermaid-fill-type0: #4ade80;
6399     -6368     -2131     -    153 +  --mermaid-fill-type1: #fbbf24;
6400     -6369     -2132     -    154 +  --mermaid-fill-type2: #fb923c;
6401     -6370     -2133     -    155 +  --mermaid-fill-type3: #5eead4;
6402     -6371     -2134     -    156 +  --mermaid-fill-type4: #a3e635;
6403     -6372     -2135     -    157 +  --mermaid-fill-type5: #22c55e;
6404     -6373     -2136     -    158 +  --mermaid-fill-type6: #84cc16;
6405     -6374     -2137     -    159 +  --mermaid-fill-type7: #fde047;
6406     -6375     -2138     - 47 160  }
6407     -6376     -2139     - 48 161  
6408     -6377     -2140     -
6409     -6378     -2141     -```
6410     -6379     -2142     -
6411     -6380     -2143     -
6412     -6381     -2144     -### üìÑ `themes/forest-light.css`
6413     -6382     -2145     -
6414     -6383     -2146     -**Type:** Stylesheet üé®
6415     -6384     -2147     -
6416     -6385     -2148     -```diff
6417     -6386     -2149     -@@ -23,20 +23,49 @@
6418     -6387     -2150     - 23  23    --code-block-bg: #ecfccb; /* Light green background */
6419     -6388     -2151     - 24  24    --code-border: #bef264;
6420     -6389     -2152     - 25  25  
6421     -6390     -2153     - 26     -  /* Syntax Highlighting - Comprehensive Token Colors */
6422     -6391     -2154     - 27     -  --syntax-keyword: #15803d;
6423     -6392     -2155     - 28     -  --syntax-string: #16a34a;
6424     -6393     -2156     - 29     -  --syntax-number: #84cc16;
6425     -6394     -2157     - 30     -  --syntax-function: #22c55e;
6426     -6395     -2158     - 31     -  --syntax-comment: #737373;
6427     -6396     -2159     - 32     -  --syntax-operator: #3f6212;
6428     -6397     -2160     - 33     -  --syntax-punctuation: #525252;
6429     -6398     -2161     -     26 +  /* Syntax Highlighting - Production-Grade Token Colors (One Dark Architecture) */
6430     -6399     -2162     - 34  27  
6431     -6400     -2163     - 35     -  /* Additional Token Types for Full Customization */
6432     -6401     -2164     - 36     -  --syntax-variable: #15803d; /* Variables - forest green */
6433     -6402     -2165     - 37     -  --syntax-property: #16a34a; /* Properties - bright green */
6434     -6403     -2166     - 38     -  --syntax-namespace: #84cc16; /* Namespaces - lime */
6435     -6404     -2167     - 39     -  --syntax-builtin: #22c55e; /* Builtins - bright green */
6436     -6405     -2168     -     28 +  /* Core hue-1: Teal - URLs */
6437     -6406     -2169     -     29 +  --syntax-url: #14b8a6; /* Teal for URLs */
6438     -6407     -2170     -     30 +
6439     -6408     -2171     -     31 +  /* Core hue-2: Green - Functions, variables */
6440     -6409     -2172     -     32 +  --syntax-function: #22c55e; /* Bright green for functions */
6441     -6410     -2173     -     33 +  --syntax-variable: #16a34a; /* Forest green for variables */
6442     -6411     -2174     -     34 +
6443     -6412     -2175     -     35 +  /* Core hue-3: Emerald - Keywords */
6444     -6413     -2176     -     36 +  --syntax-keyword: #059669; /* Deep emerald for keywords (final, sealed, class) */
6445     -6414     -2177     -     37 +
6446     -6415     -2178     -     38 +  /* Core hue-4: Lime - Strings, builtins */
6447     -6416     -2179     -     39 +  --syntax-string: #84cc16; /* Lime green for strings */
6448     -6417     -2180     -     40 +  --syntax-builtin: #65a30d; /* Vibrant lime for builtins (String, List) */
6449     -6418     -2181     -     41 +  --syntax-char: #84cc16; /* Same as strings */
6450     -6419     -2182     -     42 +  --syntax-regex: #84cc16; /* Same as strings */
6451     -6420     -2183     -     43 +  --syntax-inserted: #65a30d; /* For diff */
6452     -6421     -2184     -     44 +
6453     -6422     -2185     -     45 +  /* Core hue-5: Amber/Brown - Properties, tags */
6454     -6423     -2186     -     46 +  --syntax-property: #b45309; /* Amber-brown for properties */
6455     -6424     -2187     -     47 +  --syntax-tag: #854d0e; /* Brown for tags */
6456     -6425     -2188     -     48 +  --syntax-deleted: #dc2626; /* Red for diff */
6457     -6426     -2189     -     49 +  --syntax-important: #b45309; /* Amber for !important */
6458     -6427     -2190     -     50 +
6459     -6428     -2191     -     51 +  /* Core hue-6: Yellow/Green - Class names, constants, numbers */
6460     -6429     -2192     -     52 +  --syntax-class-name: #facc15; /* Bright yellow for class names (Rectangle, Shape) */
6461     -6430     -2193     -     53 +  --syntax-number: #eab308; /* Yellow for numbers */
6462     -6431     -2194     -     54 +  --syntax-constant: #15803d; /* Forest green for constants */
6463     -6432     -2195     -     55 +  --syntax-boolean: #eab308; /* Same as numbers */
6464     -6433     -2196     -     56 +  --syntax-atrule: #84cc16; /* Lime for CSS @ rules */
6465     -6434     -2197     -     57 +
6466     -6435     -2198     -     58 +  /* Neutral colors */
6467     -6436     -2199     -     59 +  --syntax-comment: #737373; /* Gray for comments */
6468     -6437     -2200     -     60 +  --syntax-punctuation: #525252; /* Dark gray for punctuation */
6469     -6438     -2201     -     61 +  --syntax-operator: #3f6212; /* Olive for operators */
6470     -6439     -2202     -     62 +
6471     -6440     -2203     -     63 +  /* Markup specific */
6472     -6441     -2204     -     64 +  --syntax-attr-name: #facc15; /* Yellow like class-name */
6473     -6442     -2205     -     65 +  --syntax-attr-value: #84cc16; /* Lime like strings */
6474     -6443     -2206     -     66 +  --syntax-namespace: #059669; /* Emerald like keywords */
6475     -6444     -2207     -     67 +  --syntax-entity: #525252; /* Neutral */
6476     -6445     -2208     -     68 +  --syntax-selector: #b45309; /* Amber like properties */
6477     -6446     -2209     - 40  69  
6478     -6447     -2210     - 41  70    --blockquote-border: #16a34a;
6479     -6448     -2211     - 42  71    --blockquote-bg: #ecfccb;
6480     -6449     -2212     -@@ -44,4 +73,87 @@
6481     -6450     -2213     - 44  73    --italic-color: #15803d;
6482     -6451     -2214     - 45  74    --table-header-bg: #d9f99d;
6483     -6452     -2215     - 46  75    --table-border: #bef264;
6484     -6453     -2216     -     76 +
6485     -6454     -2217     -     77 +  /* === MERMAID COMPREHENSIVE CONFIGURATION === */
6486     -6455     -2218     -     78 +
6487     -6456     -2219     -     79 +  /* Core Global */
6488     -6457     -2220     -     80 +  --mermaid-background: #f7fee7;
6489     -6458     -2221     -     81 +  --mermaid-text-color: #1a2e05;
6490     -6459     -2222     -     82 +  --mermaid-line-color: #16a34a;
6491     -6460     -2223     -     83 +  --mermaid-main-bkg: #d9f99d;
6492     -6461     -2224     -     84 +
6493     -6462     -2225     -     85 +  /* Primary Set */
6494     -6463     -2226     -     86 +  --mermaid-primary-color: #d9f99d;
6495     -6464     -2227     -     87 +  --mermaid-primary-text-color: #1a2e05;
6496     -6465     -2228     -     88 +  --mermaid-primary-border-color: #15803d;
6497     -6466     -2229     -     89 +
6498     -6467     -2230     -     90 +  /* Secondary Set */
6499     -6468     -2231     -     91 +  --mermaid-secondary-color: #ecfccb;
6500     -6469     -2232     -     92 +  --mermaid-secondary-text-color: #1a2e05;
6501     -6470     -2233     -     93 +  --mermaid-secondary-border-color: #16a34a;
6502     -6471     -2234     -     94 +
6503     -6472     -2235     -     95 +  /* Tertiary Set */
6504     -6473     -2236     -     96 +  --mermaid-tertiary-color: #f7fee7;
6505     -6474     -2237     -     97 +  --mermaid-tertiary-text-color: #1a2e05;
6506     -6475     -2238     -     98 +  --mermaid-tertiary-border-color: #22c55e;
6507     -6476     -2239     -     99 +
6508     -6477     -2240     -    100 +  /* Flowchart */
6509     -6478     -2241     -    101 +  --mermaid-node-border: #15803d;
6510     -6479     -2242     -    102 +  --mermaid-cluster-bkg: #ecfccb;
6511     -6480     -2243     -    103 +  --mermaid-cluster-border: #16a34a;
6512     -6481     -2244     -    104 +  --mermaid-default-link-color: #16a34a;
6513     -6482     -2245     -    105 +  --mermaid-title-color: #1a2e05;
6514     -6483     -2246     -    106 +  --mermaid-edge-label-background: #f7fee7;
6515     -6484     -2247     -    107 +  --mermaid-node-text-color: #1a2e05;
6516     -6485     -2248     -    108 +
6517     -6486     -2249     -    109 +  /* Sequence Diagram */
6518     -6487     -2250     -    110 +  --mermaid-actor-bkg: #d9f99d;
6519     -6488     -2251     -    111 +  --mermaid-actor-border: #15803d;
6520     -6489     -2252     -    112 +  --mermaid-actor-text-color: #1a2e05;
6521     -6490     -2253     -    113 +  --mermaid-actor-line-color: #15803d;
6522     -6491     -2254     -    114 +  --mermaid-signal-color: #16a34a;
6523     -6492     -2255     -    115 +  --mermaid-signal-text-color: #1a2e05;
6524     -6493     -2256     -    116 +  --mermaid-label-box-bkg-color: #d9f99d;
6525     -6494     -2257     -    117 +  --mermaid-label-box-border-color: #15803d;
6526     -6495     -2258     -    118 +  --mermaid-label-text-color: #1a2e05;
6527     -6496     -2259     -    119 +  --mermaid-loop-text-color: #1a2e05;
6528     -6497     -2260     -    120 +  --mermaid-activation-border-color: #16a34a;
6529     -6498     -2261     -    121 +  --mermaid-activation-bkg-color: #ecfccb;
6530     -6499     -2262     -    122 +  --mermaid-sequence-number-color: #1a2e05;
6531     -6500     -2263     -    123 +
6532     -6501     -2264     -    124 +  /* Pie Chart */
6533     -6502     -2265     -    125 +  --mermaid-pie1: #15803d;
6534     -6503     -2266     -    126 +  --mermaid-pie2: #16a34a;
6535     -6504     -2267     -    127 +  --mermaid-pie3: #22c55e;
6536     -6505     -2268     -    128 +  --mermaid-pie4: #4ade80;
6537     -6506     -2269     -    129 +  --mermaid-pie5: #84cc16;
6538     -6507     -2270     -    130 +  --mermaid-pie6: #a3e635;
6539     -6508     -2271     -    131 +  --mermaid-pie7: #14b8a6;
6540     -6509     -2272     -    132 +  --mermaid-pie8: #facc15;
6541     -6510     -2273     -    133 +  --mermaid-pie9: #b45309;
6542     -6511     -2274     -    134 +  --mermaid-pie10: #15803d;
6543     -6512     -2275     -    135 +  --mermaid-pie11: #16a34a;
6544     -6513     -2276     -    136 +  --mermaid-pie12: #22c55e;
6545     -6514     -2277     -    137 +  --mermaid-pie-title-text-color: #1a2e05;
6546     -6515     -2278     -    138 +  --mermaid-pie-section-text-color: #f7fee7; /* Light on vibrant slices */
6547     -6516     -2279     -    139 +  --mermaid-pie-legend-text-color: #1a2e05;
6548     -6517     -2280     -    140 +  --mermaid-pie-stroke-color: #15803d;
6549     -6518     -2281     -    141 +  --mermaid-pie-outer-stroke-color: #15803d;
6550     -6519     -2282     -    142 +
6551     -6520     -2283     -    143 +  /* State Diagram */
6552     -6521     -2284     -    144 +  --mermaid-label-color: #1a2e05;
6553     -6522     -2285     -    145 +  --mermaid-alt-background: #ecfccb;
6554     -6523     -2286     -    146 +
6555     -6524     -2287     -    147 +  /* Class Diagram */
6556     -6525     -2288     -    148 +  --mermaid-class-text: #1a2e05;
6557     -6526     -2289     -    149 +
6558     -6527     -2290     -    150 +  /* User Journey */
6559     -6528     -2291     -    151 +  --mermaid-fill-type0: #15803d;
6560     -6529     -2292     -    152 +  --mermaid-fill-type1: #16a34a;
6561     -6530     -2293     -    153 +  --mermaid-fill-type2: #22c55e;
6562     -6531     -2294     -    154 +  --mermaid-fill-type3: #4ade80;
6563     -6532     -2295     -    155 +  --mermaid-fill-type4: #84cc16;
6564     -6533     -2296     -    156 +  --mermaid-fill-type5: #a3e635;
6565     -6534     -2297     -    157 +  --mermaid-fill-type6: #14b8a6;
6566     -6535     -2298     -    158 +  --mermaid-fill-type7: #facc15;
6567     -6536     -2299     - 47 159  }
6568     -6537     -2300     - 48 160  
6569     -6538     -2301     -
6570     -6539     -2302     -```
6571     -6540     -2303     -
6572     -6541     -2304     -
6573     -6542     -2305     -### üìÑ `themes/neon-dark.css`
6574     -6543     -2306     -
6575     -6544     -2307     -**Type:** Stylesheet üé®
6576     -6545     -2308     -
6577     -6546     -2309     -```diff
6578     -6547     -2310     -@@ -1,11 +1,11 @@
6579     -6548     -2311     -  1     -/* Neon Dark Theme */
6580     -6549     -2312     -      1 +/* Neon Dark Theme - Cyberpunk Aesthetic */
6581     -6550     -2313     -  2   2  :root {
6582     -6551     -2314     -  3     -  --bg-primary: #0d0d0d;
6583     -6552     -2315     -  4     -  --bg-secondary: #1a1a1a;
6584     -6553     -2316     -  5     -  --bg-tertiary: #262626;
6585     -6554     -2317     -  6     -  --text-primary: #ffffff;
6586     -6555     -2318     -  7     -  --text-secondary: #a3a3a3;
6587     -6556     -2319     -  8     -  --border-color: #404040;
6588     -6557     -2320     -      3 +  --bg-primary: #0a0e1a; /* Dark blue-purple, not pure black */
6589     -6558     -2321     -      4 +  --bg-secondary: #141827; /* Dark navy with purple tint */
6590     -6559     -2322     -      5 +  --bg-tertiary: #1e2539; /* Lighter navy */
6591     -6560     -2323     -      6 +  --text-primary: #e0e7ff; /* Slightly blue-tinted white */
6592     -6561     -2324     -      7 +  --text-secondary: #a5b4fc; /* Light indigo */
6593     -6562     -2325     -      8 +  --border-color: #4c1d95; /* Purple border for neon feel */
6594     -6563     -2326     -  9   9  
6595     -6564     -2327     - 10  10    --h1-color: #ff006e;
6596     -6565     -2328     - 11  11    --h2-color: #8338ec;
6597     -6566     -2329     -@@ -17,31 +17,143 @@
6598     -6567     -2330     - 17  17    --link-color: #ff006e;
6599     -6568     -2331     - 18  18    --link-hover: #ff1a8c;
6600     -6569     -2332     - 19  19  
6601     -6570     -2333     - 20     -  /* Code Colors */
6602     -6571     -2334     - 21     -  --code-bg: #1a1a1a;
6603     -6572     -2335     -     20 +  /* Code Colors - Neonic with purple glow */
6604     -6573     -2336     -     21 +  --code-bg: rgba(131, 56, 236, 0.15); /* Purple-tinted background */
6605     -6574     -2337     - 22  22    --code-text: #00f5d4;
6606     -6575     -2338     - 23     -  --code-block-bg: #0d0d0d;
6607     -6576     -2339     - 24     -  --code-border: #404040;
6608     -6577     -2340     -     23 +  --code-block-bg: #0f1419; /* Dark blue-black with hint of purple */
6609     -6578     -2341     -     24 +  --code-border: rgba(255, 0, 110, 0.3); /* Pink glow border */
6610     -6579     -2342     - 25  25  
6611     -6580     -2343     - 26     -  /* Syntax Highlighting - Comprehensive Token Colors */
6612     -6581     -2344     - 27     -  --syntax-keyword: #ff006e;
6613     -6582     -2345     - 28     -  --syntax-string: #00f5d4;
6614     -6583     -2346     - 29     -  --syntax-number: #ffbe0b;
6615     -6584     -2347     - 30     -  --syntax-function: #8338ec;
6616     -6585     -2348     - 31     -  --syntax-comment: #737373;
6617     -6586     -2349     - 32     -  --syntax-operator: #ff1a8c;
6618     -6587     -2350     - 33     -  --syntax-punctuation: #a3a3a3;
6619     -6588     -2351     -     26 +  /* Syntax Highlighting - Production-Grade Token Colors (One Dark Architecture) */
6620     -6589     -2352     - 34  27  
6621     -6590     -2353     - 35     -  /* Additional Token Types */
6622     -6591     -2354     - 36     -  --syntax-variable: #3a86ff; /* Variables - bright blue (distinct from text #ffffff) */
6623     -6592     -2355     - 37     -  --syntax-property: #8338ec; /* Properties - purple */
6624     -6593     -2356     - 38     -  --syntax-namespace: #ff006e; /* Namespaces - neon pink */
6625     -6594     -2357     - 39     -  --syntax-builtin: #00f5d4; /* Builtins - cyan */
6626     -6595     -2358     -     28 +  /* Core hue-1: Cyan - URLs */
6627     -6596     -2359     -     29 +  --syntax-url: #00f5d4; /* Electric cyan for URLs */
6628     -6597     -2360     -     30 +
6629     -6598     -2361     -     31 +  /* Core hue-2: Purple/Blue - Functions, variables */
6630     -6599     -2362     -     32 +  --syntax-function: #8338ec; /* Neon purple for functions */
6631     -6600     -2363     -     33 +  --syntax-variable: #3a86ff; /* Electric blue for variables */
6632     -6601     -2364     -     34 +
6633     -6602     -2365     -     35 +  /* Core hue-3: Pink - Keywords */
6634     -6603     -2366     -     36 +  --syntax-keyword: #ff006e; /* Hot pink for keywords (final, sealed, class) */
6635     -6604     -2367     -     37 +
6636     -6605     -2368     -     38 +  /* Core hue-4: Cyan/Teal - Strings, builtins */
6637     -6606     -2369     -     39 +  --syntax-string: #00f5d4; /* Electric cyan for strings */
6638     -6607     -2370     -     40 +  --syntax-builtin: #00d4aa; /* Bright teal for builtins (String, List) */
6639     -6608     -2371     -     41 +  --syntax-char: #00f5d4; /* Same as strings */
6640     -6609     -2372     -     42 +  --syntax-regex: #00f5d4; /* Same as strings */
6641     -6610     -2373     -     43 +  --syntax-inserted: #00d4aa; /* For diff */
6642     -6611     -2374     -     44 +
6643     -6612     -2375     -     45 +  /* Core hue-5: Orange/Red - Properties, tags */
6644     -6613     -2376     -     46 +  --syntax-property: #fb5607; /* Neon orange for properties */
6645     -6614     -2377     -     47 +  --syntax-tag: #ff006e; /* Hot pink for tags */
6646     -6615     -2378     -     48 +  --syntax-deleted: #ff006e; /* Pink for diff */
6647     -6616     -2379     -     49 +  --syntax-important: #fb5607; /* Orange for !important */
6648     -6617     -2380     -     50 +
6649     -6618     -2381     -     51 +  /* Core hue-6: Yellow/Purple - Class names, constants, numbers */
6650     -6619     -2382     -     52 +  --syntax-class-name: #ffbe0b; /* Electric yellow for class names (Rectangle, Shape) */
6651     -6620     -2383     -     53 +  --syntax-number: #ffbe0b; /* Yellow for numbers */
6652     -6621     -2384     -     54 +  --syntax-constant: #fb5607; /* Orange for constants */
6653     -6622     -2385     -     55 +  --syntax-boolean: #ffbe0b; /* Same as numbers */
6654     -6623     -2386     -     56 +  --syntax-atrule: #8338ec; /* Purple for CSS @ rules */
6655     -6624     -2387     -     57 +
6656     -6625     -2388     -     58 +  /* Neutral colors */
6657     -6626     -2389     -     59 +  --syntax-comment: #737373; /* Gray for comments */
6658     -6627     -2390     -     60 +  --syntax-punctuation: #a3a3a3; /* Light gray for punctuation */
6659     -6628     -2391     -     61 +  --syntax-operator: #ff1a8c; /* Pink for operators */
6660     -6629     -2392     -     62 +
6661     -6630     -2393     -     63 +  /* Markup specific */
6662     -6631     -2394     -     64 +  --syntax-attr-name: #ffbe0b; /* Yellow like class-name */
6663     -6632     -2395     -     65 +  --syntax-attr-value: #00f5d4; /* Cyan like strings */
6664     -6633     -2396     -     66 +  --syntax-namespace: #8338ec; /* Purple */
6665     -6634     -2397     -     67 +  --syntax-entity: #a3a3a3; /* Neutral */
6666     -6635     -2398     -     68 +  --syntax-selector: #fb5607; /* Orange like properties */
6667     -6636     -2399     - 40  69  
6668     -6637     -2400     - 41  70    --blockquote-border: #8338ec;
6669     -6638     -2401     - 42     -  --blockquote-bg: #1a1a1a;
6670     -6639     -2402     -     71 +  --blockquote-bg: rgba(131, 56, 236, 0.1); /* Purple-tinted blockquote */
6671     -6640     -2403     - 43  72    --bold-color: #ffbe0b;
6672     -6641     -2404     - 44  73    --italic-color: #ff006e;
6673     -6642     -2405     - 45     -  --table-header-bg: #262626;
6674     -6643     -2406     - 46     -  --table-border: #404040;
6675     -6644     -2407     -     74 +  --table-header-bg: rgba(58, 134, 255, 0.15); /* Blue-tinted table header */
6676     -6645     -2408     -     75 +  --table-border: rgba(76, 29, 149, 0.3); /* Purple-tinted border */
6677     -6646     -2409     -     76 +
6678     -6647     -2410     -     77 +  /* === MERMAID COMPREHENSIVE CONFIGURATION === */
6679     -6648     -2411     -     78 +
6680     -6649     -2412     -     79 +  /* Core Global */
6681     -6650     -2413     -     80 +  --mermaid-background: #0a0e1a;
6682     -6651     -2414     -     81 +  --mermaid-text-color: #e0e7ff;
6683     -6652     -2415     -     82 +  --mermaid-line-color: #3a86ff;
6684     -6653     -2416     -     83 +  --mermaid-main-bkg: #1e2539;
6685     -6654     -2417     -     84 +
6686     -6655     -2418     -     85 +  /* Primary Set */
6687     -6656     -2419     -     86 +  --mermaid-primary-color: #1e2539;
6688     -6657     -2420     -     87 +  --mermaid-primary-text-color: #e0e7ff;
6689     -6658     -2421     -     88 +  --mermaid-primary-border-color: #8338ec;
6690     -6659     -2422     -     89 +
6691     -6660     -2423     -     90 +  /* Secondary Set */
6692     -6661     -2424     -     91 +  --mermaid-secondary-color: #141827;
6693     -6662     -2425     -     92 +  --mermaid-secondary-text-color: #e0e7ff;
6694     -6663     -2426     -     93 +  --mermaid-secondary-border-color: #3a86ff;
6695     -6664     -2427     -     94 +
6696     -6665     -2428     -     95 +  /* Tertiary Set */
6697     -6666     -2429     -     96 +  --mermaid-tertiary-color: #0a0e1a;
6698     -6667     -2430     -     97 +  --mermaid-tertiary-text-color: #e0e7ff;
6699     -6668     -2431     -     98 +  --mermaid-tertiary-border-color: #ff006e;
6700     -6669     -2432     -     99 +
6701     -6670     -2433     -    100 +  /* Flowchart */
6702     -6671     -2434     -    101 +  --mermaid-node-border: #8338ec;
6703     -6672     -2435     -    102 +  --mermaid-cluster-bkg: #141827;
6704     -6673     -2436     -    103 +  --mermaid-cluster-border: #3a86ff;
6705     -6674     -2437     -    104 +  --mermaid-default-link-color: #3a86ff;
6706     -6675     -2438     -    105 +  --mermaid-title-color: #e0e7ff;
6707     -6676     -2439     -    106 +  --mermaid-edge-label-background: #0a0e1a;
6708     -6677     -2440     -    107 +  --mermaid-node-text-color: #e0e7ff;
6709     -6678     -2441     -    108 +
6710     -6679     -2442     -    109 +  /* Sequence Diagram */
6711     -6680     -2443     -    110 +  --mermaid-actor-bkg: #1e2539;
6712     -6681     -2444     -    111 +  --mermaid-actor-border: #8338ec;
6713     -6682     -2445     -    112 +  --mermaid-actor-text-color: #e0e7ff;
6714     -6683     -2446     -    113 +  --mermaid-actor-line-color: #8338ec;
6715     -6684     -2447     -    114 +  --mermaid-signal-color: #3a86ff;
6716     -6685     -2448     -    115 +  --mermaid-signal-text-color: #e0e7ff;
6717     -6686     -2449     -    116 +  --mermaid-label-box-bkg-color: #1e2539;
6718     -6687     -2450     -    117 +  --mermaid-label-box-border-color: #8338ec;
6719     -6688     -2451     -    118 +  --mermaid-label-text-color: #e0e7ff;
6720     -6689     -2452     -    119 +  --mermaid-loop-text-color: #e0e7ff;
6721     -6690     -2453     -    120 +  --mermaid-activation-border-color: #3a86ff;
6722     -6691     -2454     -    121 +  --mermaid-activation-bkg-color: #141827;
6723     -6692     -2455     -    122 +  --mermaid-sequence-number-color: #e0e7ff;
6724     -6693     -2456     -    123 +
6725     -6694     -2457     -    124 +  /* Pie Chart */
6726     -6695     -2458     -    125 +  --mermaid-pie1: #ff006e;
6727     -6696     -2459     -    126 +  --mermaid-pie2: #8338ec;
6728     -6697     -2460     -    127 +  --mermaid-pie3: #3a86ff;
6729     -6698     -2461     -    128 +  --mermaid-pie4: #00f5d4;
6730     -6699     -2462     -    129 +  --mermaid-pie5: #ffbe0b;
6731     -6700     -2463     -    130 +  --mermaid-pie6: #fb5607;
6732     -6701     -2464     -    131 +  --mermaid-pie7: #ff1a8c;
6733     -6702     -2465     -    132 +  --mermaid-pie8: #00d4aa;
6734     -6703     -2466     -    133 +  --mermaid-pie9: #a5b4fc;
6735     -6704     -2467     -    134 +  --mermaid-pie10: #ff006e;
6736     -6705     -2468     -    135 +  --mermaid-pie11: #8338ec;
6737     -6706     -2469     -    136 +  --mermaid-pie12: #3a86ff;
6738     -6707     -2470     -    137 +  --mermaid-pie-title-text-color: #e0e7ff;
6739     -6708     -2471     -    138 +  --mermaid-pie-section-text-color: #0a0e1a; /* Dark on vibrant slices */
6740     -6709     -2472     -    139 +  --mermaid-pie-legend-text-color: #e0e7ff;
6741     -6710     -2473     -    140 +  --mermaid-pie-stroke-color: #8338ec;
6742     -6711     -2474     -    141 +  --mermaid-pie-outer-stroke-color: #8338ec;
6743     -6712     -2475     -    142 +
6744     -6713     -2476     -    143 +  /* State Diagram */
6745     -6714     -2477     -    144 +  --mermaid-label-color: #e0e7ff;
6746     -6715     -2478     -    145 +  --mermaid-alt-background: #141827;
6747     -6716     -2479     -    146 +
6748     -6717     -2480     -    147 +  /* Class Diagram */
6749     -6718     -2481     -    148 +  --mermaid-class-text: #e0e7ff;
6750     -6719     -2482     -    149 +
6751     -6720     -2483     -    150 +  /* User Journey */
6752     -6721     -2484     -    151 +  --mermaid-fill-type0: #ff006e;
6753     -6722     -2485     -    152 +  --mermaid-fill-type1: #8338ec;
6754     -6723     -2486     -    153 +  --mermaid-fill-type2: #3a86ff;
6755     -6724     -2487     -    154 +  --mermaid-fill-type3: #00f5d4;
6756     -6725     -2488     -    155 +  --mermaid-fill-type4: #ffbe0b;
6757     -6726     -2489     -    156 +  --mermaid-fill-type5: #fb5607;
6758     -6727     -2490     -    157 +  --mermaid-fill-type6: #ff1a8c;
6759     -6728     -2491     -    158 +  --mermaid-fill-type7: #00d4aa;
6760     -6729     -2492     - 47 159  }
6761     -6730     -2493     - 48 160  
6762     -6731     -2494     -
6763     -6732     -2495     -```
6764     -6733     -2496     -
6765     -6734     -2497     -
6766     -6735     -2498     -### üìÑ `themes/neon-light.css`
6767     -6736     -2499     -
6768     -6737     -2500     -**Type:** Stylesheet üé®
6769     -6738     -2501     -
6770     -6739     -2502     -```diff
6771     -6740     -2503     -@@ -23,20 +23,49 @@
6772     -6741     -2504     - 23  23    --code-block-bg: #fef3ff; /* Light purple background */
6773     -6742     -2505     - 24  24    --code-border: #e9d5ff;
6774     -6743     -2506     - 25  25  
6775     -6744     -2507     - 26     -  /* Syntax Highlighting - Comprehensive Token Colors */
6776     -6745     -2508     - 27     -  --syntax-keyword: #c026d3;
6777     -6746     -2509     - 28     -  --syntax-string: #10b981;
6778     -6747     -2510     - 29     -  --syntax-number: #f59e0b;
6779     -6748     -2511     - 30     -  --syntax-function: #7c3aed;
6780     -6749     -2512     - 31     -  --syntax-comment: #9ca3af;
6781     -6750     -2513     - 32     -  --syntax-operator: #a21caf;
6782     -6751     -2514     - 33     -  --syntax-punctuation: #6b7280;
6783     -6752     -2515     -     26 +  /* Syntax Highlighting - Production-Grade Token Colors (One Dark Architecture) */
6784     -6753     -2516     - 34  27  
6785     -6754     -2517     - 35     -  /* Additional Token Types for Full Customization */
6786     -6755     -2518     - 36     -  --syntax-variable: #7c3aed; /* Variables - purple */
6787     -6756     -2519     - 37     -  --syntax-property: #a21caf; /* Properties - magenta */
6788     -6757     -2520     - 38     -  --syntax-namespace: #c026d3; /* Namespaces - pink */
6789     -6758     -2521     - 39     -  --syntax-builtin: #7c3aed; /* Builtins - purple */
6790     -6759     -2522     -     28 +  /* Core hue-1: Cyan - URLs */
6791     -6760     -2523     -     29 +  --syntax-url: #06b6d4; /* Cyan for URLs */
6792     -6761     -2524     -     30 +
6793     -6762     -2525     -     31 +  /* Core hue-2: Purple/Violet - Functions, variables */
6794     -6763     -2526     -     32 +  --syntax-function: #7c3aed; /* Vibrant purple for functions */
6795     -6764     -2527     -     33 +  --syntax-variable: #6366f1; /* Indigo for variables */
6796     -6765     -2528     -     34 +
6797     -6766     -2529     -     35 +  /* Core hue-3: Magenta - Keywords */
6798     -6767     -2530     -     36 +  --syntax-keyword: #c026d3; /* Bright magenta for keywords (final, sealed, class) */
6799     -6768     -2531     -     37 +
6800     -6769     -2532     -     38 +  /* Core hue-4: Green - Strings, builtins */
6801     -6770     -2533     -     39 +  --syntax-string: #10b981; /* Emerald green for strings */
6802     -6771     -2534     -     40 +  --syntax-builtin: #059669; /* Dark emerald for builtins (String, List) */
6803     -6772     -2535     -     41 +  --syntax-char: #10b981; /* Same as strings */
6804     -6773     -2536     -     42 +  --syntax-regex: #10b981; /* Same as strings */
6805     -6774     -2537     -     43 +  --syntax-inserted: #10b981; /* For diff */
6806     -6775     -2538     -     44 +
6807     -6776     -2539     -     45 +  /* Core hue-5: Blue - Properties, tags */
6808     -6777     -2540     -     46 +  --syntax-property: #3b82f6; /* Blue for properties */
6809     -6778     -2541     -     47 +  --syntax-tag: #2563eb; /* Dark blue for tags */
6810     -6779     -2542     -     48 +  --syntax-deleted: #ef4444; /* Red for diff */
6811     -6780     -2543     -     49 +  --syntax-important: #3b82f6; /* Blue for !important */
6812     -6781     -2544     -     50 +
6813     -6782     -2545     -     51 +  /* Core hue-6: Amber/Pink - Class names, constants, numbers */
6814     -6783     -2546     -     52 +  --syntax-class-name: #d946ef; /* Fuchsia for class names (Rectangle, Shape) */
6815     -6784     -2547     -     53 +  --syntax-number: #f59e0b; /* Amber for numbers */
6816     -6785     -2548     -     54 +  --syntax-constant: #c026d3; /* Magenta for constants */
6817     -6786     -2549     -     55 +  --syntax-boolean: #f59e0b; /* Same as numbers */
6818     -6787     -2550     -     56 +  --syntax-atrule: #d946ef; /* Fuchsia for CSS @ rules */
6819     -6788     -2551     -     57 +
6820     -6789     -2552     -     58 +  /* Neutral colors */
6821     -6790     -2553     -     59 +  --syntax-comment: #9ca3af; /* Gray for comments */
6822     -6791     -2554     -     60 +  --syntax-punctuation: #6b7280; /* Dark gray for punctuation */
6823     -6792     -2555     -     61 +  --syntax-operator: #a21caf; /* Magenta-pink for operators */
6824     -6793     -2556     -     62 +
6825     -6794     -2557     -     63 +  /* Markup specific */
6826     -6795     -2558     -     64 +  --syntax-attr-name: #d946ef; /* Fuchsia like class-name */
6827     -6796     -2559     -     65 +  --syntax-attr-value: #10b981; /* Green like strings */
6828     -6797     -2560     -     66 +  --syntax-namespace: #7c3aed; /* Purple like keywords */
6829     -6798     -2561     -     67 +  --syntax-entity: #6b7280; /* Neutral */
6830     -6799     -2562     -     68 +  --syntax-selector: #3b82f6; /* Blue like properties */
6831     -6800     -2563     - 40  69  
6832     -6801     -2564     - 41  70    --blockquote-border: #c026d3;
6833     -6802     -2565     - 42  71    --blockquote-bg: #fef3ff;
6834     -6803     -2566     -@@ -44,4 +73,87 @@
6835     -6804     -2567     - 44  73    --italic-color: #c026d3;
6836     -6805     -2568     - 45  74    --table-header-bg: #fce7f3;
6837     -6806     -2569     - 46  75    --table-border: #e9d5ff;
6838     -6807     -2570     -     76 +
6839     -6808     -2571     -     77 +  /* === MERMAID COMPREHENSIVE CONFIGURATION === */
6840     -6809     -2572     -     78 +
6841     -6810     -2573     -     79 +  /* Core Global */
6842     -6811     -2574     -     80 +  --mermaid-background: #ffffff;
6843     -6812     -2575     -     81 +  --mermaid-text-color: #3b0764;
6844     -6813     -2576     -     82 +  --mermaid-line-color: #7c3aed;
6845     -6814     -2577     -     83 +  --mermaid-main-bkg: #fce7f3;
6846     -6815     -2578     -     84 +
6847     -6816     -2579     -     85 +  /* Primary Set */
6848     -6817     -2580     -     86 +  --mermaid-primary-color: #fce7f3;
6849     -6818     -2581     -     87 +  --mermaid-primary-text-color: #3b0764;
6850     -6819     -2582     -     88 +  --mermaid-primary-border-color: #c026d3;
6851     -6820     -2583     -     89 +
6852     -6821     -2584     -     90 +  /* Secondary Set */
6853     -6822     -2585     -     91 +  --mermaid-secondary-color: #fef3ff;
6854     -6823     -2586     -     92 +  --mermaid-secondary-text-color: #3b0764;
6855     -6824     -2587     -     93 +  --mermaid-secondary-border-color: #7c3aed;
6856     -6825     -2588     -     94 +
6857     -6826     -2589     -     95 +  /* Tertiary Set */
6858     -6827     -2590     -     96 +  --mermaid-tertiary-color: #ffffff;
6859     -6828     -2591     -     97 +  --mermaid-tertiary-text-color: #3b0764;
6860     -6829     -2592     -     98 +  --mermaid-tertiary-border-color: #d946ef;
6861     -6830     -2593     -     99 +
6862     -6831     -2594     -    100 +  /* Flowchart */
6863     -6832     -2595     -    101 +  --mermaid-node-border: #c026d3;
6864     -6833     -2596     -    102 +  --mermaid-cluster-bkg: #fef3ff;
6865     -6834     -2597     -    103 +  --mermaid-cluster-border: #7c3aed;
6866     -6835     -2598     -    104 +  --mermaid-default-link-color: #7c3aed;
6867     -6836     -2599     -    105 +  --mermaid-title-color: #3b0764;
6868     -6837     -2600     -    106 +  --mermaid-edge-label-background: #ffffff;
6869     -6838     -2601     -    107 +  --mermaid-node-text-color: #3b0764;
6870     -6839     -2602     -    108 +
6871     -6840     -2603     -    109 +  /* Sequence Diagram */
6872     -6841     -2604     -    110 +  --mermaid-actor-bkg: #fce7f3;
6873     -6842     -2605     -    111 +  --mermaid-actor-border: #c026d3;
6874     -6843     -2606     -    112 +  --mermaid-actor-text-color: #3b0764;
6875     -6844     -2607     -    113 +  --mermaid-actor-line-color: #c026d3;
6876     -6845     -2608     -    114 +  --mermaid-signal-color: #7c3aed;
6877     -6846     -2609     -    115 +  --mermaid-signal-text-color: #3b0764;
6878     -6847     -2610     -    116 +  --mermaid-label-box-bkg-color: #fce7f3;
6879     -6848     -2611     -    117 +  --mermaid-label-box-border-color: #c026d3;
6880     -6849     -2612     -    118 +  --mermaid-label-text-color: #3b0764;
6881     -6850     -2613     -    119 +  --mermaid-loop-text-color: #3b0764;
6882     -6851     -2614     -    120 +  --mermaid-activation-border-color: #7c3aed;
6883     -6852     -2615     -    121 +  --mermaid-activation-bkg-color: #fef3ff;
6884     -6853     -2616     -    122 +  --mermaid-sequence-number-color: #3b0764;
6885     -6854     -2617     -    123 +
6886     -6855     -2618     -    124 +  /* Pie Chart */
6887     -6856     -2619     -    125 +  --mermaid-pie1: #c026d3;
6888     -6857     -2620     -    126 +  --mermaid-pie2: #7c3aed;
6889     -6858     -2621     -    127 +  --mermaid-pie3: #3b82f6;
6890     -6859     -2622     -    128 +  --mermaid-pie4: #06b6d4;
6891     -6860     -2623     -    129 +  --mermaid-pie5: #f59e0b;
6892     -6861     -2624     -    130 +  --mermaid-pie6: #ef4444;
6893     -6862     -2625     -    131 +  --mermaid-pie7: #d946ef;
6894     -6863     -2626     -    132 +  --mermaid-pie8: #6366f1;
6895     -6864     -2627     -    133 +  --mermaid-pie9: #10b981;
6896     -6865     -2628     -    134 +  --mermaid-pie10: #c026d3;
6897     -6866     -2629     -    135 +  --mermaid-pie11: #7c3aed;
6898     -6867     -2630     -    136 +  --mermaid-pie12: #3b82f6;
6899     -6868     -2631     -    137 +  --mermaid-pie-title-text-color: #3b0764;
6900     -6869     -2632     -    138 +  --mermaid-pie-section-text-color: #ffffff; /* White on vibrant slices */
6901     -6870     -2633     -    139 +  --mermaid-pie-legend-text-color: #3b0764;
6902     -6871     -2634     -    140 +  --mermaid-pie-stroke-color: #c026d3;
6903     -6872     -2635     -    141 +  --mermaid-pie-outer-stroke-color: #c026d3;
6904     -6873     -2636     -    142 +
6905     -6874     -2637     -    143 +  /* State Diagram */
6906     -6875     -2638     -    144 +  --mermaid-label-color: #3b0764;
6907     -6876     -2639     -    145 +  --mermaid-alt-background: #fef3ff;
6908     -6877     -2640     -    146 +
6909     -6878     -2641     -    147 +  /* Class Diagram */
6910     -6879     -2642     -    148 +  --mermaid-class-text: #3b0764;
6911     -6880     -2643     -    149 +
6912     -6881     -2644     -    150 +  /* User Journey */
6913     -6882     -2645     -    151 +  --mermaid-fill-type0: #c026d3;
6914     -6883     -2646     -    152 +  --mermaid-fill-type1: #7c3aed;
6915     -6884     -2647     -    153 +  --mermaid-fill-type2: #3b82f6;
6916     -6885     -2648     -    154 +  --mermaid-fill-type3: #06b6d4;
6917     -6886     -2649     -    155 +  --mermaid-fill-type4: #f59e0b;
6918     -6887     -2650     -    156 +  --mermaid-fill-type5: #ef4444;
6919     -6888     -2651     -    157 +  --mermaid-fill-type6: #d946ef;
6920     -6889     -2652     -    158 +  --mermaid-fill-type7: #6366f1;
6921     -6890     -2653     - 47 159  }
6922     -6891     -2654     - 48 160  
6923     -6892     -2655     -
6924     -6893     -2656     -```
6925     -6894     -2657     -
6926     -6895     -2658     -
6927     -6896     -2659     -### üìÑ `themes/obsidian-dark.css`
6928     -6897     -2660     -
6929     -6898     -2661     -**Type:** Stylesheet üé®
6930     -6899     -2662     -
6931     -6900     -2663     -```diff
6932     -6901     -2664     -@@ -52,20 +52,49 @@
6933     -6902     -2665     - 52  52    --code-block-bg: #232635;
6934     -6903     -2666     - 53  53    --code-border: rgba(78, 205, 196, 0.2);
6935     -6904     -2667     - 54  54  
6936     -6905     -2668     - 55     -  /* Syntax Highlighting */
6937     -6906     -2669     - 56     -  --syntax-keyword: #c792ea;
6938     -6907     -2670     - 57     -  --syntax-string: #6bcf7f;
6939     -6908     -2671     - 58     -  --syntax-number: #ffcb6b;
6940     -6909     -2672     - 59     -  --syntax-function: #82aaff;
6941     -6910     -2673     - 60     -  --syntax-comment: #7f85a3;
6942     -6911     -2674     - 61     -  --syntax-operator: #89ddff;
6943     -6912     -2675     - 62     -  --syntax-punctuation: #b8bcc8;
6944     -6913     -2676     -     55 +  /* Syntax Highlighting - Production-Grade Token Colors (One Dark Architecture) */
6945     -6914     -2677     - 63  56  
6946     -6915     -2678     - 64     -  /* Additional Token Types */
6947     -6916     -2679     - 65     -  --syntax-variable: #82aaff; /* Variables - blue (distinct from text #f5f7ff) */
6948     -6917     -2680     - 66     -  --syntax-property: #4ecdc4; /* Properties - cyan */
6949     -6918     -2681     - 67     -  --syntax-namespace: #ffb86c; /* Namespaces - orange */
6950     -6919     -2682     - 68     -  --syntax-builtin: #c77dff; /* Builtins - purple */
6951     -6920     -2683     -     57 +  /* Core hue-1: Cyan - URLs */
6952     -6921     -2684     -     58 +  --syntax-url: #4ecdc4; /* Bright cyan for URLs */
6953     -6922     -2685     -     59 +
6954     -6923     -2686     -     60 +  /* Core hue-2: Blue - Functions, variables */
6955     -6924     -2687     -     61 +  --syntax-function: #82aaff; /* Bright blue for functions */
6956     -6925     -2688     -     62 +  --syntax-variable: #5da9ff; /* Sky blue for variables */
6957     -6926     -2689     -     63 +
6958     -6927     -2690     -     64 +  /* Core hue-3: Purple - Keywords */
6959     -6928     -2691     -     65 +  --syntax-keyword: #c792ea; /* Lavender purple for keywords (final, sealed, class) */
6960     -6929     -2692     -     66 +
6961     -6930     -2693     -     67 +  /* Core hue-4: Green - Strings, builtins */
6962     -6931     -2694     -     68 +  --syntax-string: #95e1d3; /* Mint green for strings */
6963     -6932     -2695     -     69 +  --syntax-builtin: #6bcf7f; /* Vibrant green for builtins (String, List) */
6964     -6933     -2696     -     70 +  --syntax-char: #95e1d3; /* Same as strings */
6965     -6934     -2697     -     71 +  --syntax-regex: #95e1d3; /* Same as strings */
6966     -6935     -2698     -     72 +  --syntax-inserted: #6bcf7f; /* For diff */
6967     -6936     -2699     -     73 +
6968     -6937     -2700     -     74 +  /* Core hue-5: Pink - Properties, tags */
6969     -6938     -2701     -     75 +  --syntax-property: #ff6b9d; /* Hot pink for properties */
6970     -6939     -2702     -     76 +  --syntax-tag: #ff7eb3; /* Coral pink for tags */
6971     -6940     -2703     -     77 +  --syntax-deleted: #f38ba8; /* Pink-red for diff */
6972     -6941     -2704     -     78 +  --syntax-important: #ff6b9d; /* Hot pink for !important */
6973     -6942     -2705     -     79 +
6974     -6943     -2706     -     80 +  /* Core hue-6: Yellow/Orange - Class names, constants, numbers */
6975     -6944     -2707     -     81 +  --syntax-class-name: #ffb86c; /* Peach orange for class names (Rectangle, Shape) */
6976     -6945     -2708     -     82 +  --syntax-number: #ffd93d; /* Bright yellow for numbers */
6977     -6946     -2709     -     83 +  --syntax-constant: #ffb86c; /* Peach for constants */
6978     -6947     -2710     -     84 +  --syntax-boolean: #ffd93d; /* Same as numbers */
6979     -6948     -2711     -     85 +  --syntax-atrule: #c77dff; /* Purple for CSS @ rules */
6980     -6949     -2712     -     86 +
6981     -6950     -2713     -     87 +  /* Neutral colors */
6982     -6951     -2714     -     88 +  --syntax-comment: #7f85a3; /* Muted blue-gray for comments */
6983     -6952     -2715     -     89 +  --syntax-punctuation: #b8bcc8; /* Light gray for punctuation */
6984     -6953     -2716     -     90 +  --syntax-operator: #89ddff; /* Cyan for operators */
6985     -6954     -2717     -     91 +
6986     -6955     -2718     -     92 +  /* Markup specific */
6987     -6956     -2719     -     93 +  --syntax-attr-name: #ffb86c; /* Peach like class-name */
6988     -6957     -2720     -     94 +  --syntax-attr-value: #95e1d3; /* Mint like strings */
6989     -6958     -2721     -     95 +  --syntax-namespace: #c792ea; /* Purple like keywords */
6990     -6959     -2722     -     96 +  --syntax-entity: #b8bcc8; /* Neutral */
6991     -6960     -2723     -     97 +  --syntax-selector: #ff6b9d; /* Pink like properties */
6992     -6961     -2724     - 69  98  
6993     -6962     -2725     - 70  99    /* Blockquote */
6994     -6963     -2726     - 71 100    --blockquote-border: #ff6b9d;
6995     -6964     -2727     -@@ -77,4 +106,87 @@
6996     -6965     -2728     - 77 106  
6997     -6966     -2729     - 78 107    /* Border */
6998     -6967     -2730     - 79 108    --border-color: rgba(255, 255, 255, 0.1);
6999     -6968     -2731     -    109 +
7000     -6969     -2732     -    110 +  /* === MERMAID COMPREHENSIVE CONFIGURATION === */
7001     -6970     -2733     -    111 +
7002     -6971     -2734     -    112 +  /* Core Global */
7003     -6972     -2735     -    113 +  --mermaid-background: #1e1e2e;
7004     -6973     -2736     -    114 +  --mermaid-text-color: #f5f7ff;
7005     -6974     -2737     -    115 +  --mermaid-line-color: #82aaff;
7006     -6975     -2738     -    116 +  --mermaid-main-bkg: #383a4f;
7007     -6976     -    4244 +    110 +### 12. üêõ Error Handling in `loadTheme` (Line 1008)
7008     -6977     -    4245 +    111 +```javascript
7009     -6978     -    4246 +    112 +.catch(err => {
7010     -6979     -    4247 +    113 +  console.error('Failed to load saved theme:', err);
7011     -6980     -    4248 +    114 +  // Fallback to default-light
7012     -6981     -    4249 +    115 +```
7013     -6982     -    4250 +    116 +**Critique:** Good fallback logic, but `alert()` or `toast` missing. User won't know why their theme didn't load.
7014     -6983     -2739 4251      117 +
7015     -6984     -2740     -    118 +  /* Primary Set */
7016     -6985     -2741     -    119 +  --mermaid-primary-color: #383a4f;
7017     -6986     -2742     -    120 +  --mermaid-primary-text-color: #f5f7ff;
7018     -6987     -2743     -    121 +  --mermaid-primary-border-color: #ff6b9d;
7019     -6988     -2744     -    122 +
7020     -6989     -2745     -    123 +  /* Secondary Set */
7021     -6990     -2746     -    124 +  --mermaid-secondary-color: #2b2d3e;
7022     -6991     -2747     -    125 +  --mermaid-secondary-text-color: #f5f7ff;
7023     -6992     -2748     -    126 +  --mermaid-secondary-border-color: #82aaff;
7024     -6993     -2749     -    127 +
7025     -6994     -2750     -    128 +  /* Tertiary Set */
7026     -6995     -2751     -    129 +  --mermaid-tertiary-color: #1e1e2e;
7027     -6996     -2752     -    130 +  --mermaid-tertiary-text-color: #f5f7ff;
7028     -6997     -2753     -    131 +  --mermaid-tertiary-border-color: #4ecdc4;
7029     -6998     -2754     -    132 +
7030     -6999     -2755     -    133 +  /* Flowchart */
7031     -7000     -2756     -    134 +  --mermaid-node-border: #ff6b9d;
7032     -7001     -2757     -    135 +  --mermaid-cluster-bkg: #2b2d3e;
7033     -7002     -2758     -    136 +  --mermaid-cluster-border: #82aaff;
7034     -7003     -2759     -    137 +  --mermaid-default-link-color: #82aaff;
7035     -7004     -2760     -    138 +  --mermaid-title-color: #f5f7ff;
7036     -7005     -2761     -    139 +  --mermaid-edge-label-background: #1e1e2e;
7037     -7006     -2762     -    140 +  --mermaid-node-text-color: #f5f7ff;
7038     -7007     -2763     -    141 +
7039     -7008     -2764     -    142 +  /* Sequence Diagram */
7040     -7009     -2765     -    143 +  --mermaid-actor-bkg: #383a4f;
7041     -7010     -2766     -    144 +  --mermaid-actor-border: #ff6b9d;
7042     -7011     -2767     -    145 +  --mermaid-actor-text-color: #f5f7ff;
7043     -7012     -2768     -    146 +  --mermaid-actor-line-color: #ff6b9d;
7044     -7013     -2769     -    147 +  --mermaid-signal-color: #82aaff;
7045     -7014     -2770     -    148 +  --mermaid-signal-text-color: #f5f7ff;
7046     -7015     -2771     -    149 +  --mermaid-label-box-bkg-color: #383a4f;
7047     -7016     -2772     -    150 +  --mermaid-label-box-border-color: #ff6b9d;
7048     -7017     -2773     -    151 +  --mermaid-label-text-color: #f5f7ff;
7049     -7018     -2774     -    152 +  --mermaid-loop-text-color: #f5f7ff;
7050     -7019     -2775     -    153 +  --mermaid-activation-border-color: #82aaff;
7051     -7020     -2776     -    154 +  --mermaid-activation-bkg-color: #2b2d3e;
7052     -7021     -2777     -    155 +  --mermaid-sequence-number-color: #f5f7ff;
7053     -7022     -2778     -    156 +
7054     -7023     -2779     -    157 +  /* Pie Chart */
7055     -7024     -2780     -    158 +  --mermaid-pie1: #ff6b9d;
7056     -7025     -2781     -    159 +  --mermaid-pie2: #ffd93d;
7057     -7026     -2782     -    160 +  --mermaid-pie3: #4ecdc4;
7058     -7027     -2783     -    161 +  --mermaid-pie4: #c77dff;
7059     -7028     -2784     -    162 +  --mermaid-pie5: #ffb86c;
7060     -7029     -2785     -    163 +  --mermaid-pie6: #95e1d3;
7061     -7030     -2786     -    164 +  --mermaid-pie7: #82aaff;
7062     -7031     -2787     -    165 +  --mermaid-pie8: #ff7eb3;
7063     -7032     -2788     -    166 +  --mermaid-pie9: #c8f6c2;
7064     -7033     -2789     -    167 +  --mermaid-pie10: #89dceb;
7065     -7034     -2790     -    168 +  --mermaid-pie11: #ff6b9d;
7066     -7035     -2791     -    169 +  --mermaid-pie12: #ffd93d;
7067     -7036     -2792     -    170 +  --mermaid-pie-title-text-color: #f5f7ff;
7068     -7037     -2793     -    171 +  --mermaid-pie-section-text-color: #1e1e2e; /* Dark on vibrant slices */
7069     -7038     -2794     -    172 +  --mermaid-pie-legend-text-color: #f5f7ff;
7070     -7039     -2795     -    173 +  --mermaid-pie-stroke-color: #ff6b9d;
7071     -7040     -2796     -    174 +  --mermaid-pie-outer-stroke-color: #ff6b9d;
7072     -7041     -2797     -    175 +
7073     -7042     -2798     -    176 +  /* State Diagram */
7074     -7043     -2799     -    177 +  --mermaid-label-color: #f5f7ff;
7075     -7044     -2800     -    178 +  --mermaid-alt-background: #2b2d3e;
7076     -7045     -2801     -    179 +
7077     -7046     -2802     -    180 +  /* Class Diagram */
7078     -7047     -2803     -    181 +  --mermaid-class-text: #f5f7ff;
7079     -7048     -2804     -    182 +
7080     -7049     -2805     -    183 +  /* User Journey */
7081     -7050     -2806     -    184 +  --mermaid-fill-type0: #ff6b9d;
7082     -7051     -2807     -    185 +  --mermaid-fill-type1: #ffd93d;
7083     -7052     -2808     -    186 +  --mermaid-fill-type2: #4ecdc4;
7084     -7053     -2809     -    187 +  --mermaid-fill-type3: #c77dff;
7085     -7054     -2810     -    188 +  --mermaid-fill-type4: #ffb86c;
7086     -7055     -2811     -    189 +  --mermaid-fill-type5: #95e1d3;
7087     -7056     -2812     -    190 +  --mermaid-fill-type6: #82aaff;
7088     -7057     -2813     -    191 +  --mermaid-fill-type7: #ff7eb3;
7089     -7058     -2814     - 80 192  }
7090     -7059     -2815     - 81 193  
7091     -7060     -    4252 +    118 +---
7092     -7061     -    4253 +    119 +
7093     -7062     -    4254 +    120 +## ‚úÖ Summary
7094     -7063     -    4255 +    121 +The code works "happy path" but is brittle. The usage of `setTimeout` for flow control and the lack of debouncing are the biggest "Senior SDE" red flags. The Security hole (XSS) is a blocker for any production release.
7095     -7064     -    4256 +    122  
7096     -7065     -2816 4257  
7097     -7066     -2817 4258  ```
7098     -7067     -2818 4259  
7099     -7068     -2819 4260  
7100     -7069     -2820     -### üìÑ `themes/obsidian-light.css`
7101     -7070     -    4261 +### ‚ú® `codebase_audit/deep_dive_reviews/theme_manager_review.md` **[ADDED]**
7102     -7071     -2821 4262  
7103     -7072     -2822     -**Type:** Stylesheet üé®
7104     -7073     -    4263 +**Status:** ‚úÖ **NEW FILE** - This file has been newly created
7105     -7074     -    4264 +
7106     -7075     -    4265 +**Type:** Documentation üìñ
7107     -7076     -2823 4266  
7108     -7077     -2824 4267  ```diff
7109     -7078     -2825     -@@ -52,20 +52,49 @@
7110     -7079     -2826     - 52  52    --code-block-bg: #f8f9fc;
7111     -7080     -2827     - 53  53    --code-border: rgba(0, 188, 212, 0.2);
7112     -7081     -2828     - 54  54  
7113     -7082     -2829     - 55     -  /* Syntax Highlighting - Comprehensive Token Colors */
7114     -7083     -2830     - 56     -  --syntax-keyword: #9c27b0;
7115     -7084     -2831     - 57     -  --syntax-string: #4caf50;
7116     -7085     -2832     - 58     -  --syntax-number: #f57c00;
7117     -7086     -2833     - 59     -  --syntax-function: #2196f3;
7118     -7087     -2834     - 60     -  --syntax-comment: #9e9e9e;
7119     -7088     -2835     - 61     -  --syntax-operator: #00bcd4;
7120     -7089     -2836     - 62     -  --syntax-punctuation: #616161;
7121     -7090     -2837     -     55 +  /* Syntax Highlighting - Production-Grade Token Colors (One Dark Architecture) */
7122     -7091     -2838     - 63  56  
7123     -7092     -2839     - 64     -  /* Additional Token Types for Full Customization */
7124     -7093     -2840     - 65     -  --syntax-variable: #2196f3; /* Variables, parameters - bright blue */
7125     -7094     -2841     - 66     -  --syntax-property: #00bcd4; /* Properties - cyan */
7126     -7095     -2842     - 67     -  --syntax-namespace: #f57c00; /* Namespaces - orange */
7127     -7096     -2843     - 68     -  --syntax-builtin: #9c27b0; /* Built-in functions - purple */
7128     -7097     -2844     -     57 +  /* Core hue-1: Cyan - URLs */
7129     -7098     -2845     -     58 +  --syntax-url: #00bcd4; /* Cyan for URLs */
7130     -7099     -2846     -     59 +
7131     -7100     -2847     -     60 +  /* Core hue-2: Blue - Functions, variables */
7132     -7101     -2848     -     61 +  --syntax-function: #2196f3; /* Bright blue for functions */
7133     -7102     -2849     -     62 +  --syntax-variable: #1976d2; /* Deep blue for variables */
7134     -7103     -    4268 +@@ -0,0 +1,53 @@
7135     -7104     -    4269 +      1 +# üïµÔ∏è‚Äç‚ôÇÔ∏è Deep Dive Code Review: `ThemeManager.js`
7136     -7105     -    4270 +      2 +
7137     -7106     -    4271 +      3 +**Reviewer:** CodeBaseGPT (Senior SDE Persona)
7138     -7107     -    4272 +      4 +**Date:** 2025-12-09
7139     -7108     -    4273 +      5 +**File:** `src/js/core/ThemeManager.js` (263 Lines)
7140     -7109     -    4274 +      6 +
7141     -7110     -    4275 +      7 +---
7142     -7111     -    4276 +      8 +
7143     -7112     -    4277 +      9 +## üü¢ strengths
7144     -7113     -    4278 +     10 +*   **SOLID Principles:** Class has a clear Single Responsibility.
7145     -7114     -    4279 +     11 +*   **Error Handling:** `try...catch` blocks are present in `loadBuiltInTheme` and `loadCustomTheme`.
7146     -7115     -    4280 +     12 +*   **JSDoc:** Excellent documentation and usage examples.
7147     -7116     -    4281 +     13 +
7148     -7117     -    4282 +     14 +## ‚ö†Ô∏è Issues & Observations
7149     -7118     -    4283 +     15 +
7150     -7119     -    4284 +     16 +### 1. üêå Performance: `clearInlineStyles` (Line 205)
7151     -7120     -    4285 +     17 +```javascript
7152     -7121     -    4286 +     18 +for (let i = styles.length - 1; i >= 0; i--) {
7153     -7122     -    4287 +     19 +  const prop = styles[i];
7154     -7123     -    4288 +     20 +  if (prop.startsWith('--')) {
7155     -7124     -    4289 +     21 +    removeCssVariable(prop);
7156     -7125     -    4290 +     22 +  }
7157     -7126     -    4291 +     23 +}
7158     -7127     -    4292 +     24 +```
7159     -7128     -    4293 +     25 +**Critique:** This loop calls `removeProperty` repeatedly on the root element.
7160     -7129     -    4294 +     26 +- **Impact:** Each removal can trigger a Style Recalculation (Reflow) in the browser engine.
7161     -7130     -    4295 +     27 +- **Optimization:** If you only use inline styles for custom themes, you could simply clear the `style` attribute: `document.documentElement.removeAttribute('style');` (unless there are other non-theme inline styles needed).
7162     -7131     -    4296 +     28 +
7163     -7132     -    4297 +     29 +### 2. üß© Hardcoded Variable List (Line 171)
7164     -7133     -    4298 +     30 +```javascript
7165     -7134     -    4299 +     31 +const cssVarNames = [ '--bg-primary', ... ];
7166     -7135     -    4300 +     32 +```
7167     -7136     -    4301 +     33 +**Critique:** You manually list 18 variables here to "capture" the current theme colors.
7168     -7137     -    4302 +     34 +- **Risk:** This list is a **Maintenance Liability**. If a developer adds a new color (e.g., `--warning-color`) to `style.css` but forgets to add it here, the "Save Custom Theme" feature will silently drop that color.
7169     -7138     -    4303 +     35 +- **Fix:** Import this list from `src/js/config/constants.js` (SSOT). Do not define it inside the method.
7170     -7139     -    4304 +     36 +
7171     -7140     -    4305 +     37 +### 3. üß™ Production Path Resolution (Line 80)
7172     -7141     -    4306 +     38 +```javascript
7173     -7142     -    4307 +     39 +const baseUrl = import.meta.env.BASE_URL || '/';
7174     -7143     -    4308 +     40 +stylesheet.href = `${baseUrl}themes/${themeName}.css`;
7175     -7144     -    4309 +     41 +```
7176     -7145     -    4310 +     42 +**Critique:** Good job anticipating Vite's `BASE_URL`.
7177     -7146     -    4311 +     43 +- **Observation:** Ensure `themes/` folder is actually copied to `dist/` during build. Since they are static assets referenced via code (not import), Vite might not hash/include them unless configured in `vite.config.js` static assets.
7178     -7147     -    4312 +     44 +
7179     -7148     -    4313 +     45 +### 4. üîí Private Methods (Semantics)
7180     -7149     -    4314 +     46 +**Critique:** You use JSDoc `@private` but the methods `loadBuiltInTheme` are technically public.
7181     -7150     -    4315 +     47 +- **Suggestion:** Use `#privateFields` (ES2022) if you want true privacy, e.g., `#loadBuiltInTheme`.
7182     -7151     -    4316 +     48 +
7183     -7152     -    4317 +     49 +---
7184     -7153     -    4318 +     50 +
7185     -7154     -    4319 +     51 +## üèÅ Verdict
7186     -7155     -    4320 +     52 +**Grade: A-**
7187     -7156     -    4321 +     53 +This is high-quality code. The issues are mostly maintenance optimizations. The logic is sound.
7188     -7157     -    4322 +     54  
7189     -7158     -    4323 +
7190     -7159     -    4324 +```
7191     -7160     -    4325 +
7192     -7161     -    4326 +
7193     -7162     -    4327 +### ‚ú® `codebase_audit/docs_summary.json` **[ADDED]**
7194     -7163     -    4328 +
7195     -7164     -    4329 +**Status:** ‚úÖ **NEW FILE** - This file has been newly created
7196     -7165     -    4330 +
7197     -7166     -    4331 +**Type:** Configuration/Data File üìã
7198     -7167     -    4332 +
7199     -7168     -    4333 +```diff
7200     -7169     -    4334 +@@ -0,0 +1,12 @@
7201     -7170     -    4335 +      1 +{
7202     -7171     -    4336 +      2 +  "hld": "The application follows a client-side monolithic architecture with pure vanilla JavaScript, CSS variables for theming, and no backend. It uses a \"Service Layer\" pattern to isolate business logic (Mermaid, Prism) from UI, and an \"Observer Pattern\" for theme changes. Data is persisted solely via browser `localStorage`. Security relies on client-side sanitization (Marked.js) and no external data transmission.",
7203     -7172     -    4337 +      3 +  "lld": "The codebase is organized into modular layers: `UI` (HTML), `Application` (script.js controller), `Core` (StorageManager, ThemeManager), `Services` (MermaidService, PrismService), and `Utils` (HTML/Color helpers). The `ThemeManager` handles 12 built-in themes + custom themes using CSS variables. `MermaidService` and `PrismService` wrap external libraries with lazy initialization and error handling. `script.js` acts as the entry point, treating other modules as injected dependencies.",
7204     -7173     -    4338 +      4 +  "other": {
7205     -7174     -    4339 +      5 +    "folder-browser-plan": "Plan to add a file system sidebar using the File System Access API for local folder navigation.",
7206     -7175     -    4340 +      6 +    "math-rendering-plan": "Proposal to integrate KaTeX for LaTeX math rendering ($ and $$ syntax) via marked extension.",
7207     -7176     -    4341 +      7 +    "pdf-export-plan": "Design to add PDF export using html2pdf.js, preserving styles and Mermaid diagrams.",
7208     -7177     -    4342 +      8 +    "implementation-plan": "6-week refactoring roadmap moving from monolithic script.js to modular ES modules structure (currently in progress/partially complete).",
7209     -7178     -    4343 +      9 +    "deployment-guide": "Documentation for deploying to Vercel, Netlify, or GitHub Pages as a static site.",
7210     -7179     -    4344 +     10 +    "ai-review": "Recent automated code review log highlighting fixes for theme dropdown sync and architecture documentation additions."
7211     -7180     -    4345 +     11 +  }
7212     -7181     -    4346 +     12 +}
7213     -7182     -    4347 +     13  
7214     -7183     -    4348 +
7215     -7184     -    4349 +```
7216     -7185     -    4350 +
7217     -7186     -    4351 +
7218     -7187     -    4352 +### ‚ú® `codebase_audit/future_enhancements_roadmap.md` **[ADDED]**
7219     -7188     -    4353 +
7220     -7189     -    4354 +**Status:** ‚úÖ **NEW FILE** - This file has been newly created
7221     -7190     -    4355 +
7222     -7191     -    4356 +**Type:** Documentation üìñ
7223     -7192     -    4357 +
7224     -7193     -    4358 +```diff
7225     -7194     -    4359 +@@ -0,0 +1,87 @@
7226     -7195     -    4360 +      1 +# üöÄ Future Enhancements: Enterprise-Grade Roadmap
7227     -7196     -    4361 +      2 +
7228     -7197     -    4362 +      3 +This document outlines the strategic roadmap to transform the `markdown-viewer-app` into a truly **Enterprise-Grade** web application.
7229     -7198     -    4363 +      4 +
7230     -7199     -    4364 +      5 +---
7231     -7200     -    4365 +      6 +
7232     -7201     -    4366 +      7 +## üèóÔ∏è Phase 1: Robust Application Architecture (Modernization)
7233     -7202     -    4367 +      8 +
7234     -7203     -    4368 +      9 +To support enterprise scale, we must move beyond the "Vanilla JS" constraints suitable for prototypes and adopt a robust, type-safe ecosystem.
7235     -7204     -    4369 +     10 +
7236     -7205     -    4370 +     11 +### 1.1 Migrate to TypeScript
7237     -7206     -    4371 +     12 +*   **Why:** Enterprise apps require type safety to prevent runtime errors (undefined is not ...).
7238     -7207     -    4372 +     13 +*   **Plan:** Rename `.js` to `.ts`. Define interfaces for `Theme`, `FileNode`, and `AppConfig`. Strict null checks.
7239     -7208     -    4373 +     14 +
7240     -7209     -    4374 +     15 +### 1.2 Component-Based Architecture (Web Components or Framework)
7241     -7210     -    4375 +     16 +*   **Why:** The `script.js` monolith is unmaintainable.
7242     -7211     -    4376 +     17 +*   **Plan:**
7243     -7212     -    4377 +     18 +    *   **Option A (Vanilla):** Adopt Web Components (`<markdown-editor>`, `<file-tree>`).
7244     -7213     -    4378 +     19 +    *   **Option B (Standard):** Migrate to **React** or **Vue**. This allows us to use massive ecosystems of tested components (e.g., `Monaco Editor` for better markdown editing).
7245     -7214     -    4379 +     20 +
7246     -7215     -    4380 +     21 +### 1.3 State Management
7247     -7216     -    4381 +     22 +*   **Why:** Passing `globalRenderMarkdown` around is fragile.
7248     -7217     -    4382 +     23 +*   **Plan:** Implement a centralized store (e.g., `Redux`, `Zustand`, or a simple `StateService` observable) to manage:
7249     -7218     -    4383 +     24 +    *   `currentFile`
7250     -7219     -    4384 +     25 +    *   `theme`
7251     -7220     -    4385 +     26 +    *   `settings`
7252     -7221     -    4386 +     27 +    *   `folderStructure`
7253     -7222     -    4387 +     28 +
7254     -7223     -    4388 +     29 +---
7255     -7224     -    4389 +     30 +
7256     -7225     -    4390 +     31 +## üõ°Ô∏è Phase 2: Enterprise Security & Compliance
7257     -7226     -    4391 +     32 +
7258     -7227     -    4392 +     33 +### 2.1 Content Security Policy (CSP)
7259     -7228     -    4393 +     34 +*   **Goal:** Prevent XSS and Data Exfiltration.
7260     -7229     -    4394 +     35 +*   **Action:** implement strict CSP headers (or `<meta>` tags):
7261     -7230     -    4395 +     36 +    ```html
7262     -7231     -    4396 +     37 +    <meta http-equiv="Content-Security-Policy" content="default-src 'self'; script-src 'self' 'unsafe-eval' (for mermaid); style-src 'self' 'unsafe-inline';">
7263     -7232     -    4397 +     38 +    ```
7264     -7233     -    4398 +     39 +
7265     -7234     -    4399 +     40 +### 2.2 Input Sanitization Layer
7266     -7235     -    4400 +     41 +*   **Goal:** trust No Input.
7267     -7236     -    4401 +     42 +*   **Action:** Integrate `DOMPurify` deeply into the rendering pipeline. Create a `SanitizationService` that all HTML output must pass through.
7268     -7237     -    4402 +     43 +
7269     -7238     -    4403 +     44 +---
7270     -7239     -    4404 +     45 +
7271     -7240     -    4405 +     46 +## ‚ö° Phase 3: Performance & Scalability
7272     -7241     -    4406 +     47 +
7273     -7242     -    4407 +     48 +### 3.1 Web Workers for Parsing
7274     -7243     -    4408 +     49 +*   **Issue:** Parsing large markdown files (1000+ lines) freezes the UI.
7275     -7244     -    4409 +     50 +*   **Solution:** Move `marked.parse` and syntax highlighting logic to a **Web Worker**. The main thread should only handle User Input and DOM updates.
7276     -7245     -    4410 +     51 +
7277     -7246     -    4411 +     52 +### 3.2 Virtualized Rendering
7278     -7247     -    4412 +     53 +*   **Issue:** The File Browser and Large Preview will lag with thousands of items.
7279     -7248     -    4413 +     54 +*   **Solution:** Implement "Virtual Scrolling" (Windowing). Only render the DOM nodes currently visible on screen.
7280     -7249     -    4414 +     55 +
7281     -7250     -    4415 +     56 +### 3.3 Offline-First (PWA)
7282     -7251     -    4416 +     57 +*   **Goal:** Native-like reliability.
7283     -7252     -    4417 +     58 +*   **Action:**
7284     -7253     -    4418 +     59 +    *   Add a Service Worker to cache App Shell and Assets (Fonts, CSS).
7285     -7254     -    4419 +     60 +    *   Use `IndexedDB` instead of `localStorage` for saving files (allows saving images/blobs).
7286     -7255     -    4420 +     61 +
7287     -7256     -    4421 +     62 +---
7288     -7257     -2850 4422       63 +
7289     -7258     -2851     -     64 +  /* Core hue-3: Purple - Keywords */
7290     -7259     -2852     -     65 +  --syntax-keyword: #9c27b0; /* Vibrant purple for keywords (final, sealed, class) */
7291     -7260     -2853     -     66 +
7292     -7261     -2854     -     67 +  /* Core hue-4: Green - Strings, builtins */
7293     -7262     -2855     -     68 +  --syntax-string: #4caf50; /* Green for strings */
7294     -7263     -2856     -     69 +  --syntax-builtin: #388e3c; /* Dark green for builtins (String, List) */
7295     -7264     -2857     -     70 +  --syntax-char: #4caf50; /* Same as strings */
7296     -7265     -2858     -     71 +  --syntax-regex: #4caf50; /* Same as strings */
7297     -7266     -2859     -     72 +  --syntax-inserted: #388e3c; /* For diff */
7298     -7267     -    4423 +     64 +## üß© Phase 4: Advanced Features (The "Wow" Factor)
7299     -7268     -    4424 +     65 +
7300     -7269     -    4425 +     66 +### 4.1 Collaborative Editing (Real-Time)
7301     -7270     -    4426 +     67 +*   **Tech:** `Yjs` or `Automerge` (CRDTs).
7302     -7271     -    4427 +     68 +*   **Feature:** Allow two users to edit the same doc via WebRTC (local peer-to-peer) without a central server.
7303     -7272     -    4428 +     69 +
7304     -7273     -    4429 +     70 +### 4.2 Semantic Search (AI)
7305     -7274     -    4430 +     71 +*   **Start:** Implement client-side full-text search (FlexSearch).
7306     -7275     -    4431 +     72 +*   **Upgrade:** Use a local LLM or Embedding model (via WebGPU) to allow "Chat with my Docs".
7307     -7276     -2860 4432       73 +
7308     -7277     -2861     -     74 +  /* Core hue-5: Pink/Orange - Properties, tags */
7309     -7278     -2862     -     75 +  --syntax-property: #e91e63; /* Pink for properties */
7310     -7279     -2863     -     76 +  --syntax-tag: #ff4081; /* Coral for tags */
7311     -7280     -2864     -     77 +  --syntax-deleted: #d32f2f; /* Red for diff */
7312     -7281     -2865     -     78 +  --syntax-important: #e91e63; /* Pink for !important */
7313     -7282     -    4433 +     74 +### 4.3 Plugin System
7314     -7283     -    4434 +     75 +*   **Architecture:** Allow users to write JavaScript "plugins" to extend functionality (e.g., a "Date Picker" markdown extension).
7315     -7284     -    4435 +     76 +*   **Security:** Run plugins in a Sandboxed Iframe.
7316     -7285     -    4436 +     77 +
7317     -7286     -    4437 +     78 +---
7318     -7287     -2866 4438       79 +
7319     -7288     -2867     -     80 +  /* Core hue-6: Orange/Yellow - Class names, constants, numbers */
7320     -7289     -2868     -     81 +  --syntax-class-name: #ff9800; /* Orange for class names (Rectangle, Shape) */
7321     -7290     -2869     -     82 +  --syntax-number: #f57c00; /* Dark orange for numbers */
7322     -7291     -2870     -     83 +  --syntax-constant: #ff9800; /* Orange for constants */
7323     -7292     -2871     -     84 +  --syntax-boolean: #f57c00; /* Same as numbers */
7324     -7293     -2872     -     85 +  --syntax-atrule: #9c27b0; /* Purple for CSS @ rules */
7325     -7294     -2873     -     86 +
7326     -7295     -2874     -     87 +  /* Neutral colors */
7327     -7296     -2875     -     88 +  --syntax-comment: #9e9e9e; /* Gray for comments */
7328     -7297     -2876     -     89 +  --syntax-punctuation: #616161; /* Dark gray for punctuation */
7329     -7298     -2877     -     90 +  --syntax-operator: #00bcd4; /* Cyan for operators */
7330     -7299     -2878     -     91 +
7331     -7300     -2879     -     92 +  /* Markup specific */
7332     -7301     -2880     -     93 +  --syntax-attr-name: #ff9800; /* Orange like class-name */
7333     -7302     -2881     -     94 +  --syntax-attr-value: #4caf50; /* Green like strings */
7334     -7303     -2882     -     95 +  --syntax-namespace: #9c27b0; /* Purple like keywords */
7335     -7304     -2883     -     96 +  --syntax-entity: #616161; /* Neutral */
7336     -7305     -2884     -     97 +  --syntax-selector: #e91e63; /* Pink like properties */
7337     -7306     -2885     - 69  98  
7338     -7307     -2886     - 70  99    /* Blockquote */
7339     -7308     -2887     - 71 100    --blockquote-border: #e91e63;
7340     -7309     -2888     -@@ -77,4 +106,87 @@
7341     -7310     -2889     - 77 106  
7342     -7311     -2890     - 78 107    /* Border */
7343     -7312     -2891     - 79 108    --border-color: rgba(0, 0, 0, 0.12);
7344     -7313     -2892     -    109 +
7345     -7314     -2893     -    110 +  /* === MERMAID COMPREHENSIVE CONFIGURATION === */
7346     -7315     -2894     -    111 +
7347     -7316     -2895     -    112 +  /* Core Global */
7348     -7317     -2896     -    113 +  --mermaid-background: #ffffff;
7349     -7318     -2897     -    114 +  --mermaid-text-color: #1a1a1a;
7350     -7319     -2898     -    115 +  --mermaid-line-color: #9c27b0;
7351     -7320     -2899     -    116 +  --mermaid-main-bkg: #e8ecf1;
7352     -7321     -2900     -    117 +
7353     -7322     -2901     -    118 +  /* Primary Set */
7354     -7323     -2902     -    119 +  --mermaid-primary-color: #e8ecf1;
7355     -7324     -2903     -    120 +  --mermaid-primary-text-color: #1a1a1a;
7356     -7325     -2904     -    121 +  --mermaid-primary-border-color: #e91e63;
7357     -7326     -2905     -    122 +
7358     -7327     -2906     -    123 +  /* Secondary Set */
7359     -7328     -2907     -    124 +  --mermaid-secondary-color: #f5f7fa;
7360     -7329     -2908     -    125 +  --mermaid-secondary-text-color: #1a1a1a;
7361     -7330     -2909     -    126 +  --mermaid-secondary-border-color: #9c27b0;
7362     -7331     -2910     -    127 +
7363     -7332     -2911     -    128 +  /* Tertiary Set */
7364     -7333     -2912     -    129 +  --mermaid-tertiary-color: #ffffff;
7365     -7334     -2913     -    130 +  --mermaid-tertiary-text-color: #1a1a1a;
7366     -7335     -2914     -    131 +  --mermaid-tertiary-border-color: #00bcd4;
7367     -7336     -2915     -    132 +
7368     -7337     -2916     -    133 +  /* Flowchart */
7369     -7338     -2917     -    134 +  --mermaid-node-border: #e91e63;
7370     -7339     -2918     -    135 +  --mermaid-cluster-bkg: #f5f7fa;
7371     -7340     -2919     -    136 +  --mermaid-cluster-border: #9c27b0;
7372     -7341     -2920     -    137 +  --mermaid-default-link-color: #9c27b0;
7373     -7342     -2921     -    138 +  --mermaid-title-color: #1a1a1a;
7374     -7343     -2922     -    139 +  --mermaid-edge-label-background: #ffffff;
7375     -7344     -2923     -    140 +  --mermaid-node-text-color: #1a1a1a;
7376     -7345     -2924     -    141 +
7377     -7346     -2925     -    142 +  /* Sequence Diagram */
7378     -7347     -2926     -    143 +  --mermaid-actor-bkg: #e8ecf1;
7379     -7348     -2927     -    144 +  --mermaid-actor-border: #e91e63;
7380     -7349     -2928     -    145 +  --mermaid-actor-text-color: #1a1a1a;
7381     -7350     -2929     -    146 +  --mermaid-actor-line-color: #e91e63;
7382     -7351     -2930     -    147 +  --mermaid-signal-color: #9c27b0;
7383     -7352     -2931     -    148 +  --mermaid-signal-text-color: #1a1a1a;
7384     -7353     -2932     -    149 +  --mermaid-label-box-bkg-color: #e8ecf1;
7385     -7354     -2933     -    150 +  --mermaid-label-box-border-color: #e91e63;
7386     -7355     -2934     -    151 +  --mermaid-label-text-color: #1a1a1a;
7387     -7356     -2935     -    152 +  --mermaid-loop-text-color: #1a1a1a;
7388     -7357     -2936     -    153 +  --mermaid-activation-border-color: #9c27b0;
7389     -7358     -2937     -    154 +  --mermaid-activation-bkg-color: #f5f7fa;
7390     -7359     -2938     -    155 +  --mermaid-sequence-number-color: #1a1a1a;
7391     -7360     -2939     -    156 +
7392     -7361     -2940     -    157 +  /* Pie Chart */
7393     -7362     -2941     -    158 +  --mermaid-pie1: #e91e63;
7394     -7363     -2942     -    159 +  --mermaid-pie2: #9c27b0;
7395     -7364     -2943     -    160 +  --mermaid-pie3: #2196f3;
7396     -7365     -2944     -    161 +  --mermaid-pie4: #00bcd4;
7397     -7366     -2945     -    162 +  --mermaid-pie5: #4caf50;
7398     -7367     -2946     -    163 +  --mermaid-pie6: #ff9800;
7399     -7368     -2947     -    164 +  --mermaid-pie7: #f57c00;
7400     -7369     -2948     -    165 +  --mermaid-pie8: #ff4081;
7401     -7370     -2949     -    166 +  --mermaid-pie9: #1976d2;
7402     -7371     -2950     -    167 +  --mermaid-pie10: #388e3c;
7403     -7372     -2951     -    168 +  --mermaid-pie11: #e91e63;
7404     -7373     -2952     -    169 +  --mermaid-pie12: #9c27b0;
7405     -7374     -2953     -    170 +  --mermaid-pie-title-text-color: #1a1a1a;
7406     -7375     -2954     -    171 +  --mermaid-pie-section-text-color: #ffffff; /* White on vibrant slices */
7407     -7376     -2955     -    172 +  --mermaid-pie-legend-text-color: #1a1a1a;
7408     -7377     -2956     -    173 +  --mermaid-pie-stroke-color: #e91e63;
7409     -7378     -2957     -    174 +  --mermaid-pie-outer-stroke-color: #e91e63;
7410     -7379     -2958     -    175 +
7411     -7380     -2959     -    176 +  /* State Diagram */
7412     -7381     -2960     -    177 +  --mermaid-label-color: #1a1a1a;
7413     -7382     -2961     -    178 +  --mermaid-alt-background: #f5f7fa;
7414     -7383     -2962     -    179 +
7415     -7384     -2963     -    180 +  /* Class Diagram */
7416     -7385     -2964     -    181 +  --mermaid-class-text: #1a1a1a;
7417     -7386     -2965     -    182 +
7418     -7387     -2966     -    183 +  /* User Journey */
7419     -7388     -2967     -    184 +  --mermaid-fill-type0: #e91e63;
7420     -7389     -2968     -    185 +  --mermaid-fill-type1: #9c27b0;
7421     -7390     -2969     -    186 +  --mermaid-fill-type2: #2196f3;
7422     -7391     -2970     -    187 +  --mermaid-fill-type3: #00bcd4;
7423     -7392     -2971     -    188 +  --mermaid-fill-type4: #4caf50;
7424     -7393     -2972     -    189 +  --mermaid-fill-type5: #ff9800;
7425     -7394     -2973     -    190 +  --mermaid-fill-type6: #f57c00;
7426     -7395     -2974     -    191 +  --mermaid-fill-type7: #ff4081;
7427     -7396     -2975     - 80 192  }
7428     -7397     -2976     - 81 193  
7429     -7398     -    4439 +     80 +## üìà Roadmap Estimate
7430     -7399     -    4440 +     81 +
7431     -7400     -    4441 +     82 +| Feature | Complexity | Impact | Timeline |
7432     -7401     -    4442 +     83 +|---------|------------|--------|----------|
7433     -7402     -    4443 +     84 +| **TS Migration** | Medium | High | Q1 |
7434     -7403     -    4444 +     85 +| **PWA / Offline** | Low | High | Q1 |
7435     -7404     -    4445 +     86 +| **Web Workers** | High | Medium | Q2 |
7436     -7405     -    4446 +     87 +| **Collaboration**| Very High| High | Q3 |
7437     -7406     -    4447 +     88  
7438     -7407     -2977 4448  
7439     -7408     -2978 4449  ```
7440     -7409     -2979 4450  
7441     -7410     -2980 4451  
7442     -7411     -2981     -### üìÑ `themes/ocean-dark.css`
7443     -7412     -    4452 +### ‚ú® `codebase_audit/phase3_codebase_review.json` **[ADDED]**
7444     -7413     -2982 4453  
7445     -7414     -2983     -**Type:** Stylesheet üé®
7446     -7415     -    4454 +**Status:** ‚úÖ **NEW FILE** - This file has been newly created
7447     -7416     -    4455 +
7448     -7417     -    4456 +**Type:** Configuration/Data File üìã
7449     -7418     -2984 4457  
7450     -7419     -2985 4458  ```diff
7451     -7420     -2986     -@@ -23,20 +23,49 @@
7452     -7421     -2987     - 23  23    --code-block-bg: #0a192f;
7453     -7422     -2988     - 24  24    --code-border: #233554;
7454     -7423     -2989     - 25  25  
7455     -7424     -2990     - 26     -  /* Syntax Highlighting - Comprehensive Token Colors */
7456     -7425     -2991     - 27     -  --syntax-keyword: #64ffda;
7457     -7426     -2992     - 28     -  --syntax-string: #5eead4;
7458     -7427     -2993     - 29     -  --syntax-number: #38bdf8;
7459     -7428     -2994     - 30     -  --syntax-function: #22d3ee;
7460     -7429     -2995     - 31     -  --syntax-comment: #8892b0;
7461     -7430     -2996     - 32     -  --syntax-operator: #06b6d4;
7462     -7431     -2997     - 33     -  --syntax-punctuation: #8892b0;
7463     -7432     -2998     -     26 +  /* Syntax Highlighting - Production-Grade Token Colors (One Dark Architecture) */
7464     -7433     -2999     - 34  27  
7465     -7434     -3000     - 35     -  /* Additional Token Types */
7466     -7435     -3001     - 36     -  --syntax-variable: #38bdf8; /* Variables - cyan (distinct from text #ccd6f6) */
7467     -7436     -3002     - 37     -  --syntax-property: #22d3ee; /* Properties - teal */
7468     -7437     -3003     - 38     -  --syntax-namespace: #64ffda; /* Namespaces - mint */
7469     -7438     -3004     - 39     -  --syntax-builtin: #5eead4; /* Builtins - teal */
7470     -7439     -3005     -     28 +  /* Core hue-1: Bright Cyan - URLs */
7471     -7440     -3006     -     29 +  --syntax-url: #67e8f9; /* Electric cyan for URLs */
7472     -7441     -3007     -     30 +
7473     -7442     -3008     -     31 +  /* Core hue-2: Blue - Functions, variables */
7474     -7443     -3009     -     32 +  --syntax-function: #38bdf8; /* Sky blue for functions */
7475     -7444     -3010     -     33 +  --syntax-variable: #0ea5e9; /* Deep sky for variables */
7476     -7445     -3011     -     34 +
7477     -7446     -3012     -     35 +  /* Core hue-3: Violet/Purple - Keywords */
7478     -7447     -3013     -     36 +  --syntax-keyword: #c084fc; /* Bright violet for keywords (final, sealed, class) */
7479     -7448     -3014     -     37 +
7480     -7449     -3015     -     38 +  /* Core hue-4: Green/Teal - Strings, builtins */
7481     -7450     -3016     -     39 +  --syntax-string: #5eead4; /* Teal for strings */
7482     -7451     -3017     -     40 +  --syntax-builtin: #2dd4bf; /* Vibrant teal for builtins (String, List) */
7483     -7452     -3018     -     41 +  --syntax-char: #5eead4; /* Same as strings */
7484     -7453     -3019     -     42 +  --syntax-regex: #5eead4; /* Same as strings */
7485     -7454     -3020     -     43 +  --syntax-inserted: #2dd4bf; /* For diff */
7486     -7455     -3021     -     44 +
7487     -7456     -3022     -     45 +  /* Core hue-5: Pink/Rose - Properties, tags */
7488     -7457     -3023     -     46 +  --syntax-property: #f472b6; /* Pink for properties */
7489     -7458     -3024     -     47 +  --syntax-tag: #fb7185; /* Rose for tags */
7490     -7459     -3025     -     48 +  --syntax-deleted: #f87171; /* Coral for diff */
7491     -7460     -3026     -     49 +  --syntax-important: #f472b6; /* Pink for !important */
7492     -7461     -3027     -     50 +
7493     -7462     -3028     -     51 +  /* Core hue-6: Mint/Cyan - Class names, constants, numbers */
7494     -7463     -3029     -     52 +  --syntax-class-name: #64ffda; /* Mint green for class names (Rectangle, Shape) */
7495     -7464     -3030     -     53 +  --syntax-number: #22d3ee; /* Bright cyan for numbers */
7496     -7465     -3031     -     54 +  --syntax-constant: #06b6d4; /* Cyan for constants */
7497     -7466     -3032     -     55 +  --syntax-boolean: #22d3ee; /* Same as numbers */
7498     -7467     -3033     -     56 +  --syntax-atrule: #64ffda; /* Mint for CSS @ rules */
7499     -7468     -3034     -     57 +
7500     -7469     -3035     -     58 +  /* Neutral colors */
7501     -7470     -3036     -     59 +  --syntax-comment: #8892b0; /* Muted blue-gray for comments */
7502     -7471     -3037     -     60 +  --syntax-punctuation: #a0aec0; /* Light gray for punctuation */
7503     -7472     -3038     -     61 +  --syntax-operator: #0891b2; /* Teal for operators */
7504     -7473     -3039     -     62 +
7505     -7474     -3040     -     63 +  /* Markup specific */
7506     -7475     -3041     -     64 +  --syntax-attr-name: #64ffda; /* Mint like class-name */
7507     -7476     -3042     -     65 +  --syntax-attr-value: #5eead4; /* Teal like strings */
7508     -7477     -3043     -     66 +  --syntax-namespace: #c084fc; /* Violet like keywords */
7509     -7478     -3044     -     67 +  --syntax-entity: #a0aec0; /* Neutral */
7510     -7479     -3045     -     68 +  --syntax-selector: #f472b6; /* Pink like properties */
7511     -7480     -3046     - 40  69  
7512     -7481     -3047     - 41  70    --blockquote-border: #64ffda;
7513     -7482     -3048     - 42  71    --blockquote-bg: #112240;
7514     -7483     -3049     -@@ -44,4 +73,87 @@
7515     -7484     -3050     - 44  73    --italic-color: #5eead4;
7516     -7485     -3051     - 45  74    --table-header-bg: #1d3461;
7517     -7486     -3052     - 46  75    --table-border: #233554;
7518     -7487     -3053     -     76 +
7519     -7488     -3054     -     77 +  /* === MERMAID COMPREHENSIVE CONFIGURATION === */
7520     -7489     -3055     -     78 +
7521     -7490     -3056     -     79 +  /* Core Global */
7522     -7491     -3057     -     80 +  --mermaid-background: #0a192f;
7523     -7492     -3058     -     81 +  --mermaid-text-color: #ccd6f6;
7524     -7493     -3059     -     82 +  --mermaid-line-color: #5eead4;
7525     -7494     -3060     -     83 +  --mermaid-main-bkg: #1d3461;
7526     -7495     -3061     -     84 +
7527     -7496     -3062     -     85 +  /* Primary Set */
7528     -7497     -3063     -     86 +  --mermaid-primary-color: #1d3461;
7529     -7498     -3064     -     87 +  --mermaid-primary-text-color: #ccd6f6;
7530     -7499     -3065     -     88 +  --mermaid-primary-border-color: #64ffda;
7531     -7500     -3066     -     89 +
7532     -7501     -3067     -     90 +  /* Secondary Set */
7533     -7502     -3068     -     91 +  --mermaid-secondary-color: #112240;
7534     -7503     -3069     -     92 +  --mermaid-secondary-text-color: #ccd6f6;
7535     -7504     -3070     -     93 +  --mermaid-secondary-border-color: #5eead4;
7536     -7505     -3071     -     94 +
7537     -7506     -3072     -     95 +  /* Tertiary Set */
7538     -7507     -3073     -     96 +  --mermaid-tertiary-color: #0a192f;
7539     -7508     -3074     -     97 +  --mermaid-tertiary-text-color: #ccd6f6;
7540     -7509     -3075     -     98 +  --mermaid-tertiary-border-color: #38bdf8;
7541     -7510     -3076     -     99 +
7542     -7511     -3077     -    100 +  /* Flowchart */
7543     -7512     -3078     -    101 +  --mermaid-node-border: #64ffda;
7544     -7513     -3079     -    102 +  --mermaid-cluster-bkg: #112240;
7545     -7514     -3080     -    103 +  --mermaid-cluster-border: #5eead4;
7546     -7515     -3081     -    104 +  --mermaid-default-link-color: #5eead4;
7547     -7516     -3082     -    105 +  --mermaid-title-color: #ccd6f6;
7548     -7517     -3083     -    106 +  --mermaid-edge-label-background: #0a192f;
7549     -7518     -3084     -    107 +  --mermaid-node-text-color: #ccd6f6;
7550     -7519     -3085     -    108 +
7551     -7520     -3086     -    109 +  /* Sequence Diagram */
7552     -7521     -3087     -    110 +  --mermaid-actor-bkg: #1d3461;
7553     -7522     -3088     -    111 +  --mermaid-actor-border: #64ffda;
7554     -7523     -3089     -    112 +  --mermaid-actor-text-color: #ccd6f6;
7555     -7524     -3090     -    113 +  --mermaid-actor-line-color: #64ffda;
7556     -7525     -3091     -    114 +  --mermaid-signal-color: #5eead4;
7557     -7526     -3092     -    115 +  --mermaid-signal-text-color: #ccd6f6;
7558     -7527     -3093     -    116 +  --mermaid-label-box-bkg-color: #1d3461;
7559     -7528     -3094     -    117 +  --mermaid-label-box-border-color: #64ffda;
7560     -7529     -3095     -    118 +  --mermaid-label-text-color: #ccd6f6;
7561     -7530     -3096     -    119 +  --mermaid-loop-text-color: #ccd6f6;
7562     -7531     -3097     -    120 +  --mermaid-activation-border-color: #5eead4;
7563     -7532     -3098     -    121 +  --mermaid-activation-bkg-color: #112240;
7564     -7533     -3099     -    122 +  --mermaid-sequence-number-color: #ccd6f6;
7565     -7534     -3100     -    123 +
7566     -7535     -3101     -    124 +  /* Pie Chart */
7567     -7536     -3102     -    125 +  --mermaid-pie1: #64ffda;
7568     -7537     -3103     -    126 +  --mermaid-pie2: #5eead4;
7569     -7538     -3104     -    127 +  --mermaid-pie3: #38bdf8;
7570     -7539     -3105     -    128 +  --mermaid-pie4: #22d3ee;
7571     -7540     -3106     -    129 +  --mermaid-pie5: #06b6d4;
7572     -7541     -3107     -    130 +  --mermaid-pie6: #0891b2;
7573     -7542     -3108     -    131 +  --mermaid-pie7: #c084fc;
7574     -7543     -3109     -    132 +  --mermaid-pie8: #f472b6;
7575     -7544     -3110     -    133 +  --mermaid-pie9: #0ea5e9;
7576     -7545     -3111     -    134 +  --mermaid-pie10: #64ffda;
7577     -7546     -3112     -    135 +  --mermaid-pie11: #5eead4;
7578     -7547     -3113     -    136 +  --mermaid-pie12: #38bdf8;
7579     -7548     -3114     -    137 +  --mermaid-pie-title-text-color: #ccd6f6;
7580     -7549     -3115     -    138 +  --mermaid-pie-section-text-color: #0a192f; /* Dark on vibrant slices */
7581     -7550     -3116     -    139 +  --mermaid-pie-legend-text-color: #ccd6f6;
7582     -7551     -3117     -    140 +  --mermaid-pie-stroke-color: #64ffda;
7583     -7552     -3118     -    141 +  --mermaid-pie-outer-stroke-color: #64ffda;
7584     -7553     -3119     -    142 +
7585     -7554     -3120     -    143 +  /* State Diagram */
7586     -7555     -3121     -    144 +  --mermaid-label-color: #ccd6f6;
7587     -7556     -3122     -    145 +  --mermaid-alt-background: #112240;
7588     -7557     -3123     -    146 +
7589     -7558     -3124     -    147 +  /* Class Diagram */
7590     -7559     -3125     -    148 +  --mermaid-class-text: #ccd6f6;
7591     -7560     -3126     -    149 +
7592     -7561     -3127     -    150 +  /* User Journey */
7593     -7562     -3128     -    151 +  --mermaid-fill-type0: #64ffda;
7594     -7563     -3129     -    152 +  --mermaid-fill-type1: #5eead4;
7595     -7564     -3130     -    153 +  --mermaid-fill-type2: #38bdf8;
7596     -7565     -3131     -    154 +  --mermaid-fill-type3: #22d3ee;
7597     -7566     -3132     -    155 +  --mermaid-fill-type4: #06b6d4;
7598     -7567     -3133     -    156 +  --mermaid-fill-type5: #0891b2;
7599     -7568     -3134     -    157 +  --mermaid-fill-type6: #c084fc;
7600     -7569     -3135     -    158 +  --mermaid-fill-type7: #f472b6;
7601     -7570     -3136     - 47 159  }
7602     -7571     -3137     - 48 160  
7603     -7572     -    4459 +@@ -0,0 +1,68 @@
7604     -7573     -    4460 +      1 +{
7605     -7574     -    4461 +      2 +  "phase": "3 - Codebase Review",
7606     -7575     -    4462 +      3 +  "status": "COMPLETED",
7607     -7576     -    4463 +      4 +  "findings": {
7608     -7577     -    4464 +      5 +    "security": [
7609     -7578     -    4465 +      6 +      {
7610     -7579     -    4466 +      7 +        "severity": "CRITICAL",
7611     -7580     -    4467 +      8 +        "type": "Stored XSS",
7612     -7581     -    4468 +      9 +        "location": "script.js:512",
7613     -7582     -    4469 +     10 +        "description": "Marked.js output is assigned to innerHTML without sanitization. DOMPurify is missing from dependencies.",
7614     -7583     -    4470 +     11 +        "remediation": "Install dompurify and sanitize 'html' variable before assignment."
7615     -7584     -    4471 +     12 +      },
7616     -7585     -    4472 +     13 +      {
7617     -7586     -    4473 +     14 +        "severity": "LOW",
7618     -7587     -    4474 +     15 +        "type": "Data Privacy",
7619     -7588     -    4475 +     16 +        "location": "script.js:522",
7620     -7589     -    4476 +     17 +        "description": "User content stored in localStorage unencrypted. Acceptable for MVP but should be noted.",
7621     -7590     -    4477 +     18 +        "remediation": "Add warning or option to disable local storage persistence."
7622     -7591     -    4478 +     19 +      }
7623     -7592     -    4479 +     20 +    ],
7624     -7593     -    4480 +     21 +    "architecture": [
7625     -7594     -    4481 +     22 +      {
7626     -7595     -    4482 +     23 +        "severity": "HIGH",
7627     -7596     -    4483 +     24 +        "type": "Monolithic Controller",
7628     -7597     -    4484 +     25 +        "location": "script.js",
7629     -7598     -    4485 +     26 +        "description": "script.js is over 1300 lines and handles UI, logic, and service orchestration. Needs splitting.",
7630     -7599     -    4486 +     27 +        "remediation": "Extract UI logic into UIManager.js and EventManager.js."
7631     -7600     -    4487 +     28 +      },
7632     -7601     -    4488 +     29 +      {
7633     -7602     -    4489 +     30 +        "severity": "MEDIUM",
7634     -7603     -    4490 +     31 +        "type": "Race Condition",
7635     -7604     -    4491 +     32 +        "location": "script.js:490,535",
7636     -7605     -    4492 +     33 +        "description": "Reliance on setTimeout magic numbers (100ms) for synchronization between Theme loading and Mermaid rendering.",
7637     -7606     -    4493 +     34 +        "remediation": "Implement proper Promise-based initialization chain."
7638     -7607     -    4494 +     35 +      },
7639     -7608     -    4495 +     36 +      {
7640     -7609     -    4496 +     37 +        "severity": "LOW",
7641     -7610     -    4497 +     38 +        "type": "Mixed Dependency Management",
7642     -7611     -    4498 +     39 +        "location": "index.html / package.json",
7643     -7612     -    4499 +     40 +        "description": "Project uses NPM for dev tools but CDNs for runtime libraries (marked, plotly, etc.). Hard to version control runtime deps.",
7644     -7613     -    4500 +     41 +        "remediation": "Migrate runtime dependencies to NPM and bundle with Vite."
7645     -7614     -    4501 +     42 +      }
7646     -7615     -    4502 +     43 +    ],
7647     -7616     -    4503 +     44 +    "code_quality": [
7648     -7617     -    4504 +     45 +      {
7649     -7618     -    4505 +     46 +        "severity": "MEDIUM",
7650     -7619     -    4506 +     47 +        "type": "Redundant Logic",
7651     -7620     -    4507 +     48 +        "location": "script.js:1241",
7652     -7621     -    4508 +     49 +        "description": "DOM generation for File Browser is hardcoded in script.js instead of being in FolderBrowserService or a View component.",
7653     -7622     -    4509 +     50 +        "remediation": "Move renderFileTree logic to a dedicated UI component."
7654     -7623     -    4510 +     51 +      },
7655     -7624     -    4511 +     52 +      {
7656     -7625     -    4512 +     53 +        "severity": "LOW",
7657     -7626     -    4513 +     54 +        "type": "Hardcoded Config",
7658     -7627     -    4514 +     55 +        "location": "script.js",
7659     -7628     -    4515 +     56 +        "description": "Some configuration values (sidebar width limits) are hardcoded in script.js, duplicating constants potential.",
7660     -7629     -    4516 +     57 +        "remediation": "Move all magic numbers to src/js/config/constants.js."
7661     -7630     -    4517 +     58 +      }
7662     -7631     -    4518 +     59 +    ]
7663     -7632     -    4519 +     60 +  },
7664     -7633     -    4520 +     61 +  "metrics": {
7665     -7634     -    4521 +     62 +    "files_reviewed": 18,
7666     -7635     -    4522 +     63 +    "lines_of_code": "~3000",
7667     -7636     -    4523 +     64 +    "critical_issues": 1,
7668     -7637     -    4524 +     65 +    "high_issues": 1,
7669     -7638     -    4525 +     66 +    "medium_issues": 2
7670     -7639     -    4526 +     67 +  }
7671     -7640     -    4527 +     68 +}
7672     -7641     -    4528 +     69  
7673     -7642     -3138 4529  
7674     -7643     -3139 4530  ```
7675     -7644     -3140 4531  
7676     -7645     -3141 4532  
7677     -7646     -3142     -### üìÑ `themes/ocean-light.css`
7678     -7647     -    4533 +### ‚ú® `codebase_audit/phase4_consolidated_findings.md` **[ADDED]**
7679     -7648     -3143 4534  
7680     -7649     -3144     -**Type:** Stylesheet üé®
7681     -7650     -    4535 +**Status:** ‚úÖ **NEW FILE** - This file has been newly created
7682     -7651     -    4536 +
7683     -7652     -    4537 +**Type:** Documentation üìñ
7684     -7653     -3145 4538  
7685     -7654     -3146 4539  ```diff
7686     -7655     -3147     -@@ -23,20 +23,49 @@
7687     -7656     -3148     - 23  23    --code-block-bg: #e0f2fe; /* Light cyan background */
7688     -7657     -3149     - 24  24    --code-border: #7dd3fc;
7689     -7658     -3150     - 25  25  
7690     -7659     -3151     - 26     -  /* Syntax Highlighting - Comprehensive Token Colors */
7691     -7660     -3152     - 27     -  --syntax-keyword: #0284c7;
7692     -7661     -3153     - 28     -  --syntax-string: #0891b2;
7693     -7662     -3154     - 29     -  --syntax-number: #06b6d4;
7694     -7663     -3155     - 30     -  --syntax-function: #22d3ee;
7695     -7664     -3156     - 31     -  --syntax-comment: #64748b;
7696     -7665     -3157     - 32     -  --syntax-operator: #0369a1;
7697     -7666     -3158     - 33     -  --syntax-punctuation: #475569;
7698     -7667     -3159     -     26 +  /* Syntax Highlighting - Production-Grade Token Colors (One Dark Architecture) */
7699     -7668     -3160     - 34  27  
7700     -7669     -3161     - 35     -  /* Additional Token Types for Full Customization */
7701     -7670     -3162     - 36     -  --syntax-variable: #0369a1; /* Variables - ocean blue */
7702     -7671     -3163     - 37     -  --syntax-property: #0891b2; /* Properties - teal */
7703     -7672     -3164     - 38     -  --syntax-namespace: #0284c7; /* Namespaces - cyan */
7704     -7673     -3165     - 39     -  --syntax-builtin: #22d3ee; /* Builtins - bright cyan */
7705     -7674     -3166     -     28 +  /* Core hue-1: Cyan - URLs */
7706     -7675     -3167     -     29 +  --syntax-url: #06b6d4; /* Bright cyan for URLs */
7707     -7676     -3168     -     30 +
7708     -7677     -3169     -     31 +  /* Core hue-2: Blue - Functions, variables */
7709     -7678     -3170     -     32 +  --syntax-function: #0284c7; /* Ocean blue for functions */
7710     -7679     -3171     -     33 +  --syntax-variable: #0369a1; /* Deep blue for variables */
7711     -7680     -3172     -     34 +
7712     -7681     -3173     -     35 +  /* Core hue-3: Purple/Violet - Keywords */
7713     -7682     -3174     -     36 +  --syntax-keyword: #7c3aed; /* Vivid purple for keywords (final, sealed, class) */
7714     -7683     -3175     -     37 +
7715     -7684     -3176     -     38 +  /* Core hue-4: Green/Teal - Strings, builtins */
7716     -7685     -3177     -     39 +  --syntax-string: #0891b2; /* Teal for strings */
7717     -7686     -3178     -     40 +  --syntax-builtin: #14b8a6; /* Bright teal for builtins (String, List) */
7718     -7687     -3179     -     41 +  --syntax-char: #0891b2; /* Same as strings */
7719     -7688     -3180     -     42 +  --syntax-regex: #0891b2; /* Same as strings */
7720     -7689     -3181     -     43 +  --syntax-inserted: #14b8a6; /* For diff */
7721     -7690     -3182     -     44 +
7722     -7691     -3183     -     45 +  /* Core hue-5: Orange/Amber - Properties, tags */
7723     -7692     -3184     -     46 +  --syntax-property: #f59e0b; /* Amber for properties */
7724     -7693     -3185     -     47 +  --syntax-tag: #ea580c; /* Orange for tags */
7725     -7694     -3186     -     48 +  --syntax-deleted: #ef4444; /* Red for diff */
7726     -7695     -3187     -     49 +  --syntax-important: #f59e0b; /* Amber for !important */
7727     -7696     -3188     -     50 +
7728     -7697     -3189     -     51 +  /* Core hue-6: Cyan - Class names, constants, numbers */
7729     -7698     -3190     -     52 +  --syntax-class-name: #22d3ee; /* Bright cyan for class names (Rectangle, Shape) */
7730     -7699     -3191     -     53 +  --syntax-number: #06b6d4; /* Cyan for numbers */
7731     -7700     -3192     -     54 +  --syntax-constant: #0891b2; /* Teal for constants */
7732     -7701     -3193     -     55 +  --syntax-boolean: #06b6d4; /* Same as numbers */
7733     -7702     -3194     -     56 +  --syntax-atrule: #22d3ee; /* Bright cyan for CSS @ rules */
7734     -7703     -3195     -     57 +
7735     -7704     -3196     -     58 +  /* Neutral colors */
7736     -7705     -3197     -     59 +  --syntax-comment: #64748b; /* Slate gray for comments */
7737     -7706     -3198     -     60 +  --syntax-punctuation: #475569; /* Dark slate for punctuation */
7738     -7707     -3199     -     61 +  --syntax-operator: #0369a1; /* Deep ocean for operators */
7739     -7708     -3200     -     62 +
7740     -7709     -3201     -     63 +  /* Markup specific */
7741     -7710     -3202     -     64 +  --syntax-attr-name: #22d3ee; /* Cyan like class-name */
7742     -7711     -3203     -     65 +  --syntax-attr-value: #0891b2; /* Teal like strings */
7743     -7712     -3204     -     66 +  --syntax-namespace: #7c3aed; /* Purple like keywords */
7744     -7713     -3205     -     67 +  --syntax-entity: #475569; /* Neutral */
7745     -7714     -3206     -     68 +  --syntax-selector: #f59e0b; /* Amber like properties */
7746     -7715     -3207     - 40  69  
7747     -7716     -3208     - 41  70    --blockquote-border: #0891b2;
7748     -7717     -3209     - 42  71    --blockquote-bg: #e0f2fe;
7749     -7718     -3210     -@@ -44,4 +73,87 @@
7750     -7719     -3211     - 44  73    --italic-color: #0891b2;
7751     -7720     -3212     - 45  74    --table-header-bg: #bae6fd;
7752     -7721     -3213     - 46  75    --table-border: #7dd3fc;
7753     -7722     -3214     -     76 +
7754     -7723     -3215     -     77 +  /* === MERMAID COMPREHENSIVE CONFIGURATION === */
7755     -7724     -3216     -     78 +
7756     -7725     -3217     -     79 +  /* Core Global */
7757     -7726     -3218     -     80 +  --mermaid-background: #f0f9ff;
7758     -7727     -3219     -     81 +  --mermaid-text-color: #0c4a6e;
7759     -7728     -3220     -     82 +  --mermaid-line-color: #0891b2;
7760     -7729     -3221     -     83 +  --mermaid-main-bkg: #bae6fd;
7761     -7730     -3222     -     84 +
7762     -7731     -3223     -     85 +  /* Primary Set */
7763     -7732     -3224     -     86 +  --mermaid-primary-color: #bae6fd;
7764     -7733     -3225     -     87 +  --mermaid-primary-text-color: #0c4a6e;
7765     -7734     -3226     -     88 +  --mermaid-primary-border-color: #0284c7;
7766     -7735     -3227     -     89 +
7767     -7736     -3228     -     90 +  /* Secondary Set */
7768     -7737     -3229     -     91 +  --mermaid-secondary-color: #e0f2fe;
7769     -7738     -3230     -     92 +  --mermaid-secondary-text-color: #0c4a6e;
7770     -7739     -3231     -     93 +  --mermaid-secondary-border-color: #0891b2;
7771     -7740     -3232     -     94 +
7772     -7741     -3233     -     95 +  /* Tertiary Set */
7773     -7742     -3234     -     96 +  --mermaid-tertiary-color: #f0f9ff;
7774     -7743     -3235     -     97 +  --mermaid-tertiary-text-color: #0c4a6e;
7775     -7744     -3236     -     98 +  --mermaid-tertiary-border-color: #06b6d4;
7776     -7745     -3237     -     99 +
7777     -7746     -3238     -    100 +  /* Flowchart */
7778     -7747     -3239     -    101 +  --mermaid-node-border: #0284c7;
7779     -7748     -3240     -    102 +  --mermaid-cluster-bkg: #e0f2fe;
7780     -7749     -3241     -    103 +  --mermaid-cluster-border: #0891b2;
7781     -7750     -3242     -    104 +  --mermaid-default-link-color: #0891b2;
7782     -7751     -3243     -    105 +  --mermaid-title-color: #0c4a6e;
7783     -7752     -3244     -    106 +  --mermaid-edge-label-background: #f0f9ff;
7784     -7753     -3245     -    107 +  --mermaid-node-text-color: #0c4a6e;
7785     -7754     -3246     -    108 +
7786     -7755     -3247     -    109 +  /* Sequence Diagram */
7787     -7756     -3248     -    110 +  --mermaid-actor-bkg: #bae6fd;
7788     -7757     -3249     -    111 +  --mermaid-actor-border: #0284c7;
7789     -7758     -3250     -    112 +  --mermaid-actor-text-color: #0c4a6e;
7790     -7759     -3251     -    113 +  --mermaid-actor-line-color: #0284c7;
7791     -7760     -3252     -    114 +  --mermaid-signal-color: #0891b2;
7792     -7761     -3253     -    115 +  --mermaid-signal-text-color: #0c4a6e;
7793     -7762     -3254     -    116 +  --mermaid-label-box-bkg-color: #bae6fd;
7794     -7763     -3255     -    117 +  --mermaid-label-box-border-color: #0284c7;
7795     -7764     -3256     -    118 +  --mermaid-label-text-color: #0c4a6e;
7796     -7765     -3257     -    119 +  --mermaid-loop-text-color: #0c4a6e;
7797     -7766     -3258     -    120 +  --mermaid-activation-border-color: #0891b2;
7798     -7767     -3259     -    121 +  --mermaid-activation-bkg-color: #e0f2fe;
7799     -7768     -3260     -    122 +  --mermaid-sequence-number-color: #0c4a6e;
7800     -7769     -3261     -    123 +
7801     -7770     -3262     -    124 +  /* Pie Chart */
7802     -7771     -3263     -    125 +  --mermaid-pie1: #0284c7;
7803     -7772     -3264     -    126 +  --mermaid-pie2: #0891b2;
7804     -7773     -3265     -    127 +  --mermaid-pie3: #06b6d4;
7805     -7774     -3266     -    128 +  --mermaid-pie4: #22d3ee;
7806     -7775     -3267     -    129 +  --mermaid-pie5: #7c3aed;
7807     -7776     -3268     -    130 +  --mermaid-pie6: #f59e0b;
7808     -7777     -3269     -    131 +  --mermaid-pie7: #14b8a6;
7809     -7778     -3270     -    132 +  --mermaid-pie8: #0369a1;
7810     -7779     -3271     -    133 +  --mermaid-pie9: #0284c7;
7811     -7780     -3272     -    134 +  --mermaid-pie10: #0891b2;
7812     -7781     -3273     -    135 +  --mermaid-pie11: #06b6d4;
7813     -7782     -3274     -    136 +  --mermaid-pie12: #22d3ee;
7814     -7783     -3275     -    137 +  --mermaid-pie-title-text-color: #0c4a6e;
7815     -7784     -3276     -    138 +  --mermaid-pie-section-text-color: #f0f9ff; /* Light on vibrant slices */
7816     -7785     -3277     -    139 +  --mermaid-pie-legend-text-color: #0c4a6e;
7817     -7786     -3278     -    140 +  --mermaid-pie-stroke-color: #0284c7;
7818     -7787     -3279     -    141 +  --mermaid-pie-outer-stroke-color: #0284c7;
7819     -7788     -3280     -    142 +
7820     -7789     -3281     -    143 +  /* State Diagram */
7821     -7790     -3282     -    144 +  --mermaid-label-color: #0c4a6e;
7822     -7791     -3283     -    145 +  --mermaid-alt-background: #e0f2fe;
7823     -7792     -3284     -    146 +
7824     -7793     -3285     -    147 +  /* Class Diagram */
7825     -7794     -3286     -    148 +  --mermaid-class-text: #0c4a6e;
7826     -7795     -3287     -    149 +
7827     -7796     -3288     -    150 +  /* User Journey */
7828     -7797     -3289     -    151 +  --mermaid-fill-type0: #0284c7;
7829     -7798     -3290     -    152 +  --mermaid-fill-type1: #0891b2;
7830     -7799     -3291     -    153 +  --mermaid-fill-type2: #06b6d4;
7831     -7800     -3292     -    154 +  --mermaid-fill-type3: #22d3ee;
7832     -7801     -3293     -    155 +  --mermaid-fill-type4: #7c3aed;
7833     -7802     -3294     -    156 +  --mermaid-fill-type5: #f59e0b;
7834     -7803     -3295     -    157 +  --mermaid-fill-type6: #14b8a6;
7835     -7804     -3296     -    158 +  --mermaid-fill-type7: #0369a1;
7836     -7805     -3297     - 47 159  }
7837     -7806     -3298     - 48 160  
7838     -7807     -    4540 +@@ -0,0 +1,31 @@
7839     -7808     -    4541 +      1 +# üß© Phase 4: Consolidated Findings
7840     -7809     -    4542 +      2 +
7841     -7810     -    4543 +      3 +This document consolidates all findings from the Codebase Review (Phase 3) and Documentation Review (Phase 2), grouped by category.
7842     -7811     -    4544 +      4 +
7843     -7812     -    4545 +      5 +## 1. Security Findings
7844     -7813     -    4546 +      6 +| ID | Severity | Issue | Location |
7845     -7814     -    4547 +      7 +|----|----------|-------|----------|
7846     -7815     -    4548 +      8 +| SEC-01 | **CRITICAL** | **Stored XSS Vulnerability**<br>Markdown renders directly to `innerHTML` without sanitization. | `script.js:512` |
7847     -7816     -    4549 +      9 +| SEC-02 | LOW | **Unencrypted Local Storage**<br>User content persists in plain text in browser storage. | `StorageManager.js` |
7848     -7817     -    4550 +     10 +| SEC-03 | LOW | **External CDN Dependency**<br>Runtime libraries loaded from third-party CDNs (jsdelivr/cdnjs). | `index.html` |
7849     -7818     -    4551 +     11 +
7850     -7819     -    4552 +     12 +## 2. Architecture & Design
7851     -7820     -    4553 +     13 +| ID | Severity | Issue | Location |
7852     -7821     -    4554 +     14 +|----|----------|-------|----------|
7853     -7822     -    4555 +     15 +| ARC-01 | **HIGH** | **Monolithic Controller**<br>`script.js` (1300+ lines) violates Single Responsibility Principle. | `script.js` |
7854     -7823     -    4556 +     16 +| ARC-02 | MEDIUM | **Tight Coupling**<br>`script.js` directly manipulates DOM, manages state, and calls services. | `script.js` |
7855     -7824     -    4557 +     17 +| ARC-03 | MEDIUM | **Race Conditions**<br>Reliance on `setTimeout` for synchronization between themes/Mermaid. | `script.js:490` |
7856     -7825     -    4558 +     18 +| ARC-04 | LOW | **Hardcoded Configuration**<br>Magic numbers (sidebar width, zoom limits) found in logic. | `script.js` |
7857     -7826     -    4559 +     19 +
7858     -7827     -    4560 +     20 +## 3. Code Quality & Maintenance
7859     -7828     -    4561 +     21 +| ID | Severity | Issue | Location |
7860     -7829     -    4562 +     22 +|----|----------|-------|----------|
7861     -7830     -    4563 +     23 +| COD-01 | MEDIUM | **No Type Safety**<br>Pure JavaScript used; logic errors (e.g. string vs number) possible. | All Files |
7862     -7831     -    4564 +     24 +| COD-02 | LOW | **Incomplete Tests**<br>Tests exist but coverage for UI interactions is manual. | `tests/` |
7863     -7832     -    4565 +     25 +| COD-03 | LOW | **Redundant Logic**<br>DOM generation for File Browse tree is inline, not reusable. | `script.js:1241` |
7864     -7833     -    4566 +     26 +
7865     -7834     -    4567 +     27 +## 4. Documentation Gaps
7866     -7835     -    4568 +     28 +| ID | Severity | Issue | Location |
7867     -7836     -    4569 +     29 +|----|----------|-------|----------|
7868     -7837     -    4570 +     30 +| DOC-01 | LOW | **Stack Mismatch**<br>README mentions Java/Python support (likely meant highlighting), implying backend. | `README.md` |
7869     -7838     -    4571 +     31 +| DOC-02 | LOW | **Install Instructions**<br>No "Install" section for local dev beyond "Open index.html". | `README.md` |
7870     -7839     -    4572 +     32  
7871     -7840     -3299 4573  
7872     -7841     -3300 4574  ```
7873     -7842     -3301 4575  
7874     -7843     -3302 4576  
7875     -7844     -3303     -### üìÑ `themes/sunset-dark.css`
7876     -7845     -    4577 +### ‚ú® `codebase_audit/phase4_implementation_plan.md` **[ADDED]**
7877     -7846     -3304 4578  
7878     -7847     -3305     -**Type:** Stylesheet üé®
7879     -7848     -    4579 +**Status:** ‚úÖ **NEW FILE** - This file has been newly created
7880     -7849     -    4580 +
7881     -7850     -    4581 +**Type:** Documentation üìñ
7882     -7851     -3306 4582  
7883     -7852     -3307 4583  ```diff
7884     -7853     -3308     -@@ -23,20 +23,49 @@
7885     -7854     -3309     - 23  23    --code-block-bg: #1c0a00;
7886     -7855     -3310     - 24  24    --code-border: #7c2d12;
7887     -7856     -3311     - 25  25  
7888     -7857     -3312     - 26     -  /* Syntax Highlighting - Comprehensive Token Colors */
7889     -7858     -3313     - 27     -  --syntax-keyword: #fb923c;
7890     -7859     -3314     - 28     -  --syntax-string: #a3e635;
7891     -7860     -3315     - 29     -  --syntax-number: #fbbf24;
7892     -7861     -3316     - 30     -  --syntax-function: #f87171;
7893     -7862     -3317     - 31     -  --syntax-comment: #78716c;
7894     -7863     -3318     - 32     -  --syntax-operator: #fdba74;
7895     -7864     -3319     - 33     -  --syntax-punctuation: #d4d4d4;
7896     -7865     -3320     -     26 +  /* Syntax Highlighting - Production-Grade Token Colors (One Dark Architecture) */
7897     -7866     -3321     - 34  27  
7898     -7867     -3322     - 35     -  /* Additional Token Types */
7899     -7868     -3323     - 36     -  --syntax-variable: #fcd34d; /* Variables - bright yellow (distinct from text #fed7aa) */
7900     -7869     -3324     - 37     -  --syntax-property: #f87171; /* Properties - coral */
7901     -7870     -3325     - 38     -  --syntax-namespace: #fb923c; /* Namespaces - sunset orange */
7902     -7871     -3326     - 39     -  --syntax-builtin: #f87171; /* Builtins - coral */
7903     -7872     -3327     -     28 +  /* Core hue-1: Cyan (187¬∞) - URLs */
7904     -7873     -3328     -     29 +  --syntax-url: #5eead4; /* Bright teal for URLs */
7905     -7874     -3329     -     30 +
7906     -7875     -3330     -     31 +  /* Core hue-2: Blue (207¬∞) - Functions, variables */
7907     -7876     -3331     -     32 +  --syntax-function: #60a5fa; /* Bright blue for functions */
7908     -7877     -3332     -     33 +  --syntax-variable: #38bdf8; /* Sky blue for variables */
7909     -7878     -    4584 +@@ -0,0 +1,71 @@
7910     -7879     -    4585 +      1 +# üõ°Ô∏è Audit Phase 4: Consolidation & Implementation Plan
7911     -7880     -    4586 +      2 +
7912     -7881     -    4587 +      3 +## üö® Critical Priority (Immediate Action Required)
7913     -7882     -    4588 +      4 +
7914     -7883     -    4589 +      5 +### 1. Fix Stored XSS Vulnerability
7915     -7884     -    4590 +      6 +- **Severity:** Critical
7916     -7885     -    4591 +      7 +- **Location:** `script.js` (Line 512)
7917     -7886     -    4592 +      8 +- **Issue:** Markdown is parsed and injected directly into `innerHTML` without sanitization. Malicious markdown files can execute arbitrary JavaScript.
7918     -7887     -    4593 +      9 +- **Action Plan:**
7919     -7888     -    4594 +     10 +  1. Install `dompurify`: `npm install dompurify`
7920     -7889     -    4595 +     11 +  2. Import it in `script.js` (or load via CDN if sticking to hybrid approach).
7921     -7890     -    4596 +     12 +  3. Wrap parsing: `preview.innerHTML = DOMPurify.sanitize(marked.parse(markdownText));`
7922     -7891     -    4597 +     13 +
7923     -7892     -    4598 +     14 +### 2. Remove Race Conditions in Threading
7924     -7893     -    4599 +     15 +- **Severity:** High
7925     -7894     -    4600 +     16 +- **Location:** `script.js` (Lines 490, 535)
7926     -7895     -    4601 +     17 +- **Issue:** `setTimeout` (100ms) used to guess when libraries are ready. This leads to flaky rendering and "pop-in" effects.
7927     -7896     -    4602 +     18 +- **Action Plan:**
7928     -7897     -    4603 +     19 +  1. Refactor `MermaidService.render()` to return a Promise that resolves *only* when rendering is complete.
7929     -7898     -    4604 +     20 +  2. Await this promise in `renderMarkdown()` instead of using `setTimeout`.
7930     -7899     -    4605 +     21 +
7931     -7900     -    4606 +     22 +---
7932     -7901     -    4607 +     23 +
7933     -7902     -    4608 +     24 +## üèóÔ∏è High Priority (Architectural Refactoring)
7934     -7903     -    4609 +     25 +
7935     -7904     -    4610 +     26 +### 3. Decompose Monolithic `script.js`
7936     -7905     -    4611 +     27 +- **Severity:** High
7937     -7906     -    4612 +     28 +- **Location:** `script.js` (1372 lines)
7938     -7907     -    4613 +     29 +- **Issue:** File violates Single Responsibility Principle. Handles initialization, event binding, UI rendering, logic, and service orchestration.
7939     -7908     -    4614 +     30 +- **Action Plan:**
7940     -7909     -    4615 +     31 +  1. **Extract `UIManager`**: Move all `document.getElementById` and UI toggling logic here.
7941     -7910     -    4616 +     32 +  2. **Extract `FileTreeView`**: Move the 200+ lines of DOM generation for the folder browser out of `script.js`.
7942     -7911     -    4617 +     33 +  3. **Extract `EventManager`**: Centralize event listener bindings.
7943     -7912     -3333 4618       34 +
7944     -7913     -3334     -     35 +  /* Core hue-3: Purple (286¬∞) - Keywords */
7945     -7914     -3335     -     36 +  --syntax-keyword: #c084fc; /* Bright purple for keywords (final, sealed, class keyword) */
7946     -7915     -3336     -     37 +
7947     -7916     -3337     -     38 +  /* Core hue-4: Green (95¬∞) - Strings, builtins */
7948     -7917     -3338     -     39 +  --syntax-string: #a3e635; /* Lime green for strings */
7949     -7918     -3339     -     40 +  --syntax-builtin: #84cc16; /* Vibrant green for builtins (String, List) */
7950     -7919     -3340     -     41 +  --syntax-char: #a3e635; /* Same as strings */
7951     -7920     -3341     -     42 +  --syntax-regex: #a3e635; /* Same as strings */
7952     -7921     -3342     -     43 +  --syntax-inserted: #a3e635; /* For diff */
7953     -7922     -3343     -     44 +
7954     -7923     -3344     -     45 +  /* Core hue-5: Red (355¬∞) - Properties, tags */
7955     -7924     -3345     -     46 +  --syntax-property: #fb7185; /* Coral rose for properties */
7956     -7925     -3346     -     47 +  --syntax-tag: #f87171; /* Coral for tags */
7957     -7926     -3347     -     48 +  --syntax-deleted: #f87171; /* For diff */
7958     -7927     -3348     -     49 +  --syntax-important: #fb7185; /* For !important */
7959     -7928     -3349     -     50 +
7960     -7929     -3350     -     51 +  /* Core hue-6: Orange (29¬∞) - Class names, constants, numbers */
7961     -7930     -3351     -     52 +  --syntax-class-name: #fb923c; /* Bright sunset orange for class names (Rectangle, Shape) */
7962     -7931     -3352     -     53 +  --syntax-number: #fbbf24; /* Golden yellow for numbers */
7963     -7932     -3353     -     54 +  --syntax-constant: #f97316; /* Burnt orange for constants */
7964     -7933     -3354     -     55 +  --syntax-boolean: #fbbf24; /* Same as numbers */
7965     -7934     -3355     -     56 +  --syntax-atrule: #fb923c; /* CSS @ rules */
7966     -7935     -3356     -     57 +
7967     -7936     -3357     -     58 +  /* Neutral colors */
7968     -7937     -3358     -     59 +  --syntax-comment: #a8a29e; /* Muted for comments */
7969     -7938     -3359     -     60 +  --syntax-punctuation: #d4d4d8; /* Light gray for punctuation */
7970     -7939     -3360     -     61 +  --syntax-operator: #fdba74; /* Light sunset for operators */
7971     -7940     -3361     -     62 +
7972     -7941     -3362     -     63 +  /* Markup specific */
7973     -7942     -3363     -     64 +  --syntax-attr-name: #fb923c; /* Orange like class-name */
7974     -7943     -3364     -     65 +  --syntax-attr-value: #a3e635; /* Green like strings */
7975     -7944     -3365     -     66 +  --syntax-namespace: #c084fc; /* Purple like keywords */
7976     -7945     -3366     -     67 +  --syntax-entity: #d4d4d8; /* Neutral */
7977     -7946     -3367     -     68 +  --syntax-selector: #fb7185; /* Red like properties */
7978     -7947     -3368     - 40  69  
7979     -7948     -3369     - 41  70    --blockquote-border: #f97316;
7980     -7949     -3370     - 42  71    --blockquote-bg: #2d1b0e;
7981     -7950     -3371     -@@ -44,4 +73,87 @@
7982     -7951     -3372     - 44  73    --italic-color: #fb923c;
7983     -7952     -3373     - 45  74    --table-header-bg: #3d2417;
7984     -7953     -3374     - 46  75    --table-border: #7c2d12;
7985     -7954     -3375     -     76 +
7986     -7955     -3376     -     77 +  /* === MERMAID COMPREHENSIVE CONFIGURATION === */
7987     -7956     -3377     -     78 +
7988     -7957     -3378     -     79 +  /* Core Global */
7989     -7958     -3379     -     80 +  --mermaid-background: #1c0a00;
7990     -7959     -3380     -     81 +  --mermaid-text-color: #fed7aa;
7991     -7960     -3381     -     82 +  --mermaid-line-color: #f97316;
7992     -7961     -3382     -     83 +  --mermaid-main-bkg: #3d2417;
7993     -7962     -3383     -     84 +
7994     -7963     -3384     -     85 +  /* Primary Set */
7995     -7964     -3385     -     86 +  --mermaid-primary-color: #3d2417;
7996     -7965     -3386     -     87 +  --mermaid-primary-text-color: #fed7aa;
7997     -7966     -3387     -     88 +  --mermaid-primary-border-color: #fb923c;
7998     -7967     -3388     -     89 +
7999     -7968     -3389     -     90 +  /* Secondary Set */
8000     -7969     -3390     -     91 +  --mermaid-secondary-color: #2d1b0e;
8001     -7970     -3391     -     92 +  --mermaid-secondary-text-color: #fed7aa;
8002     -7971     -3392     -     93 +  --mermaid-secondary-border-color: #f97316;
8003     -7972     -3393     -     94 +
8004     -7973     -3394     -     95 +  /* Tertiary Set */
8005     -7974     -3395     -     96 +  --mermaid-tertiary-color: #1c0a00;
8006     -7975     -3396     -     97 +  --mermaid-tertiary-text-color: #fed7aa;
8007     -7976     -3397     -     98 +  --mermaid-tertiary-border-color: #ea580c;
8008     -7977     -3398     -     99 +
8009     -7978     -3399     -    100 +  /* Flowchart */
8010     -7979     -3400     -    101 +  --mermaid-node-border: #fb923c;
8011     -7980     -3401     -    102 +  --mermaid-cluster-bkg: #2d1b0e;
8012     -7981     -3402     -    103 +  --mermaid-cluster-border: #f97316;
8013     -7982     -3403     -    104 +  --mermaid-default-link-color: #f97316;
8014     -7983     -3404     -    105 +  --mermaid-title-color: #fed7aa;
8015     -7984     -3405     -    106 +  --mermaid-edge-label-background: #1c0a00;
8016     -7985     -3406     -    107 +  --mermaid-node-text-color: #fed7aa;
8017     -7986     -3407     -    108 +
8018     -7987     -3408     -    109 +  /* Sequence Diagram */
8019     -7988     -3409     -    110 +  --mermaid-actor-bkg: #3d2417;
8020     -7989     -3410     -    111 +  --mermaid-actor-border: #fb923c;
8021     -7990     -3411     -    112 +  --mermaid-actor-text-color: #fed7aa;
8022     -7991     -3412     -    113 +  --mermaid-actor-line-color: #fb923c;
8023     -7992     -3413     -    114 +  --mermaid-signal-color: #f97316;
8024     -7993     -3414     -    115 +  --mermaid-signal-text-color: #fed7aa;
8025     -7994     -3415     -    116 +  --mermaid-label-box-bkg-color: #3d2417;
8026     -7995     -3416     -    117 +  --mermaid-label-box-border-color: #fb923c;
8027     -7996     -3417     -    118 +  --mermaid-label-text-color: #fed7aa;
8028     -7997     -3418     -    119 +  --mermaid-loop-text-color: #fed7aa;
8029     -7998     -3419     -    120 +  --mermaid-activation-border-color: #f97316;
8030     -7999     -3420     -    121 +  --mermaid-activation-bkg-color: #2d1b0e;
8031     -8000     -3421     -    122 +  --mermaid-sequence-number-color: #fed7aa;
8032     -8001     -3422     -    123 +
8033     -8002     -3423     -    124 +  /* Pie Chart */
8034     -8003     -3424     -    125 +  --mermaid-pie1: #fb923c;
8035     -8004     -3425     -    126 +  --mermaid-pie2: #f97316;
8036     -8005     -3426     -    127 +  --mermaid-pie3: #ea580c;
8037     -8006     -3427     -    128 +  --mermaid-pie4: #f87171;
8038     -8007     -3428     -    129 +  --mermaid-pie5: #fb7185;
8039     -8008     -3429     -    130 +  --mermaid-pie6: #f472b6;
8040     -8009     -3430     -    131 +  --mermaid-pie7: #fdba74;
8041     -8010     -3431     -    132 +  --mermaid-pie8: #5eead4;
8042     -8011     -3432     -    133 +  --mermaid-pie9: #60a5fa;
8043     -8012     -3433     -    134 +  --mermaid-pie10: #c084fc;
8044     -8013     -3434     -    135 +  --mermaid-pie11: #a3e635;
8045     -8014     -3435     -    136 +  --mermaid-pie12: #fbbf24;
8046     -8015     -3436     -    137 +  --mermaid-pie-title-text-color: #fed7aa;
8047     -8016     -3437     -    138 +  --mermaid-pie-section-text-color: #1c0a00; /* Dark on vibrant slices */
8048     -8017     -3438     -    139 +  --mermaid-pie-legend-text-color: #fed7aa;
8049     -8018     -3439     -    140 +  --mermaid-pie-stroke-color: #fb923c;
8050     -8019     -3440     -    141 +  --mermaid-pie-outer-stroke-color: #fb923c;
8051     -8020     -3441     -    142 +
8052     -8021     -3442     -    143 +  /* State Diagram */
8053     -8022     -3443     -    144 +  --mermaid-label-color: #fed7aa;
8054     -8023     -3444     -    145 +  --mermaid-alt-background: #2d1b0e;
8055     -8024     -3445     -    146 +
8056     -8025     -3446     -    147 +  /* Class Diagram */
8057     -8026     -3447     -    148 +  --mermaid-class-text: #fed7aa;
8058     -8027     -3448     -    149 +
8059     -8028     -3449     -    150 +  /* User Journey */
8060     -8029     -3450     -    151 +  --mermaid-fill-type0: #fb923c;
8061     -8030     -3451     -    152 +  --mermaid-fill-type1: #f97316;
8062     -8031     -3452     -    153 +  --mermaid-fill-type2: #ea580c;
8063     -8032     -3453     -    154 +  --mermaid-fill-type3: #f87171;
8064     -8033     -3454     -    155 +  --mermaid-fill-type4: #fb7185;
8065     -8034     -3455     -    156 +  --mermaid-fill-type5: #f472b6;
8066     -8035     -3456     -    157 +  --mermaid-fill-type6: #fdba74;
8067     -8036     -3457     -    158 +  --mermaid-fill-type7: #5eead4;
8068     -8037     -3458     - 47 159  }
8069     -8038     -3459     - 48 160  
8070     -8039     -    4619 +     35 +### 4. Standardize Dependency Management
8071     -8040     -    4620 +     36 +- **Severity:** Medium
8072     -8041     -    4621 +     37 +- **Location:** `index.html`
8073     -8042     -    4622 +     38 +- **Issue:** Runtime dependencies (Marked, Prism, Mermaid, KaTeX) are loaded via CDNs, while dev tools are in `package.json`. This creates a fragility where internet access is required for the "local" app to run.
8074     -8043     -    4623 +     39 +- **Action Plan:**
8075     -8044     -    4624 +     40 +  1. Install runtime deps: `npm install marked prismjs mermaid katex html2pdf.js`
8076     -8045     -    4625 +     41 +  2. Update `vite.config.js` to bundle these assets.
8077     -8046     -    4626 +     42 +  3. Remove CDN links from `index.html`.
8078     -8047     -    4627 +     43 +
8079     -8048     -    4628 +     44 +---
8080     -8049     -    4629 +     45 +
8081     -8050     -    4630 +     46 +## üßπ Medium Priority (Cleanup)
8082     -8051     -    4631 +     47 +
8083     -8052     -    4632 +     48 +### 5. Update Documentation
8084     -8053     -    4633 +     49 +- **Severity:** Low
8085     -8054     -    4634 +     50 +- **Location:** `README.md`
8086     -8055     -    4635 +     51 +- **Issue:** Documentation mentions Java/Python support, implying backend code, but the repo is purely static frontend.
8087     -8056     -    4636 +     52 +- **Action Plan:**
8088     -8057     -    4637 +     53 +  1. Clarify "Client-Side Only" architecture in README.
8089     -8058     -    4638 +     54 +  2. Update "Tech Stack" section to reflect actual discovered files.
8090     -8059     -    4639 +     55 +
8091     -8060     -    4640 +     56 +### 6. Centralize Configuration
8092     -8061     -    4641 +     57 +- **Severity:** Low
8093     -8062     -    4642 +     58 +- **Issue:** Some magic numbers (sidebar widths, zoom limits) are still hardcoded in `script.js`.
8094     -8063     -    4643 +     59 +- **Action Plan:**
8095     -8064     -    4644 +     60 +  1. Move all remaining constants to `src/js/config/constants.js`.
8096     -8065     -    4645 +     61 +
8097     -8066     -    4646 +     62 +---
8098     -8067     -    4647 +     63 +
8099     -8068     -    4648 +     64 +## üìÖ Roadmap
8100     -8069     -    4649 +     65 +
8101     -8070     -    4650 +     66 +| Phase | Task | Est. Effort |
8102     -8071     -    4651 +     67 +|-------|------|-------------|
8103     -8072     -    4652 +     68 +| **Week 1** | Security Fixes (XSS) + `setTimeout` Removal | 1 Day |
8104     -8073     -    4653 +     69 +| **Week 2** | Split `script.js` -> `UIManager`, `AppController` | 3 Days |
8105     -8074     -    4654 +     70 +| **Week 3** | Dependency Migration (CDN -> NPM) | 2 Days |
8106     -8075     -    4655 +     71 +| **Week 4** | Documentation & Final Polish | 1 Day |
8107     -8076     -    4656 +     72  
8108     -8077     -3460 4657  
8109     -8078     -3461 4658  ```
8110     -8079     -3462 4659  
8111     -8080     -3463 4660  
8112     -8081     -3464     -### üìÑ `themes/sunset-light.css`
8113     -8082     -    4661 +### ‚ú® `codebase_audit/phase5_recommendations.md` **[ADDED]**
8114     -8083     -3465 4662  
8115     -8084     -3466     -**Type:** Stylesheet üé®
8116     -8085     -    4663 +**Status:** ‚úÖ **NEW FILE** - This file has been newly created
8117     -8086     -    4664 +
8118     -8087     -    4665 +**Type:** Documentation üìñ
8119     -8088     -3467 4666  
8120     -8089     -3468 4667  ```diff
8121     -8090     -3469     -@@ -23,20 +23,49 @@
8122     -8091     -3470     - 23  23    --code-block-bg: #ffedd5; /* Light orange background */
8123     -8092     -3471     - 24  24    --code-border: #fdba74;
8124     -8093     -3472     - 25  25  
8125     -8094     -3473     - 26     -  /* Syntax Highlighting - Comprehensive Token Colors */
8126     -8095     -3474     - 27     -  --syntax-keyword: #ea580c;
8127     -8096     -3475     - 28     -  --syntax-string: #16a34a;
8128     -8097     -3476     - 29     -  --syntax-number: #f59e0b;
8129     -8098     -3477     - 30     -  --syntax-function: #dc2626;
8130     -8099     -3478     - 31     -  --syntax-comment: #78716c;
8131     -8100     -3479     - 32     -  --syntax-operator: #c2410c;
8132     -8101     -3480     - 33     -  --syntax-punctuation: #57534e;
8133     -8102     -3481     -     26 +  /* Syntax Highlighting - Production-Grade Token Colors (Based on One Dark Architecture) */
8134     -8103     -3482     - 34  27  
8135     -8104     -3483     - 35     -  /* Additional Token Types for Full Customization */
8136     -8105     -3484     - 36     -  --syntax-variable: #ea580c; /* Variables - sunset orange */
8137     -8106     -3485     - 37     -  --syntax-property: #dc2626; /* Properties - red */
8138     -8107     -3486     - 38     -  --syntax-namespace: #f97316; /* Namespaces - bright orange */
8139     -8108     -3487     - 39     -  --syntax-builtin: #dc2626; /* Builtins - red */
8140     -8109     -3488     -     28 +  /* Core hue-1: Cyan (187¬∞) - URLs, special strings */
8141     -8110     -3489     -     29 +  --syntax-url: #14b8a6; /* Teal/cyan for URLs */
8142     -8111     -3490     -     30 +
8143     -8112     -3491     -     31 +  /* Core hue-2: Blue (207¬∞) - Functions, variables, operators */
8144     -8113     -3492     -     32 +  --syntax-function: #3b82f6; /* Bright blue for functions */
8145     -8114     -3493     -     33 +  --syntax-variable: #0ea5e9; /* Sky blue for variables */
8146     -8115     -3494     -     34 +
8147     -8116     -3495     -     35 +  /* Core hue-3: Purple (286¬∞) - Keywords */
8148     -8117     -3496     -     36 +  --syntax-keyword: #a855f7; /* Vibrant purple for keywords (if, final, sealed) */
8149     -8118     -    4668 +@@ -0,0 +1,41 @@
8150     -8119     -    4669 +      1 +# üí° Phase 5: Recommendations & Roadmap
8151     -8120     -    4670 +      2 +
8152     -8121     -    4671 +      3 +Based on the consolidated findings, here are the strategic recommendations for the `markdown-viewer-app`.
8153     -8122     -    4672 +      4 +
8154     -8123     -    4673 +      5 +## üß† Strategic Recommendations
8155     -8124     -    4674 +      6 +
8156     -8125     -    4675 +      7 +### 1. Security Hardening (Immediate)
8157     -8126     -    4676 +      8 +*   **Mitigate XSS:** The application **must** integrate a sanitization library (e.g., `DOMPurify`) before rendering any Markdown content. This is non-negotiable for a viewer app.
8158     -8127     -    4677 +      9 +*   **Content Security Policy (CSP):** Implement a strict CSP in `index.html` to prevent unauthorized script execution, especially since we rely on CDNs.
8159     -8128     -    4678 +     10 +
8160     -8129     -    4679 +     11 +### 2. Architectural Refactoring (Short Term)
8161     -8130     -    4680 +     12 +*   **Adopt MVC/MVVM:** Move away from the "Giant Script" pattern.
8162     -8131     -    4681 +     13 +    *   **Model:** `StorageManager.js` (Already exists, good).
8163     -8132     -    4682 +     14 +    *   **View:** Create `UIManager.js` to handle all DOM updates.
8164     -8133     -    4683 +     15 +    *   **Controller:** Slim down `script.js` to only handle event orchestration.
8165     -8134     -    4684 +     16 +*   **Event-Driven Architecture:** Expand the `ThemeManager`'s observer pattern to a global `EventManager` to decouple components.
8166     -8135     -    4685 +     17 +
8167     -8136     -    4686 +     18 +### 3. Modernization (Medium Term)
8168     -8137     -    4687 +     19 +*   **Migrate to TypeScript:** The project checks for TS in `package.json` but uses JS. Migrating to TypeScript will eliminate type-related bugs and self-document the code.
8169     -8138     -    4688 +     20 +*   **Bundle Management:** Move from CDN links in `index.html` to a built bundle (Vite). This ensures the app works offline (a key value prop) and stabilizes dependency versions.
8170     -8139     -    4689 +     21 +
8171     -8140     -    4690 +     22 +### 4. Quality Assurance (Long Term)
8172     -8141     -    4691 +     23 +*   **Automated E2E Testing:** Implement Playwright or Cypress tests to verify the "Sync Scroll" and "Theme Switching" features automatically, reducing manual testing burden.
8173     -8142     -    4692 +     24 +
8174     -8143     -    4693 +     25 +## üó∫Ô∏è Proposed Roadmap
8175     -8144     -    4694 +     26 +
8176     -8145     -    4695 +     27 +### Phase A: Stability & Security (Week 1)
8177     -8146     -    4696 +     28 +- [ ] Install `dompurify`
8178     -8147     -    4697 +     29 +- [ ] Implement input sanitization
8179     -8148     -    4698 +     30 +- [ ] Replace `setTimeout` with `Promise` chains
8180     -8149     -    4699 +     31 +- [ ] Fix race conditions in Theme/Mermaid loading
8181     -8150     -    4700 +     32 +
8182     -8151     -    4701 +     33 +### Phase B: decoupling (Week 2)
8183     -8152     -    4702 +     34 +- [ ] Extract `FolderBrowser` logic to `src/js/components/FileTree.js`
8184     -8153     -    4703 +     35 +- [ ] Extract global event listeners to `src/js/core/EventManager.js`
8185     -8154     -    4704 +     36 +- [ ] Refactor `script.js` to use these new modules
8186     -8155     -3497 4705       37 +
8187     -8156     -3498     -     38 +  /* Core hue-4: Green (95¬∞) - Strings, builtins, inserted */
8188     -8157     -3499     -     39 +  --syntax-string: #10b981; /* Emerald green for strings */
8189     -8158     -3500     -     40 +  --syntax-builtin: #059669; /* Darker green for builtins (String, List, Array) */
8190     -8159     -3501     -     41 +  --syntax-char: #10b981; /* Same as strings */
8191     -8160     -3502     -     42 +  --syntax-regex: #10b981; /* Same as strings */
8192     -8161     -3503     -     43 +  --syntax-inserted: #10b981; /* For diff highlights */
8193     -8162     -3504     -     44 +
8194     -8163     -3505     -     45 +  /* Core hue-5: Red (355¬∞) - Properties, tags, deleted, important */
8195     -8164     -3506     -     46 +  --syntax-property: #ef4444; /* Red for properties */
8196     -8165     -3507     -     47 +  --syntax-tag: #ef4444; /* Red for HTML tags */
8197     -8166     -3508     -     48 +  --syntax-deleted: #ef4444; /* For diff highlights */
8198     -8167     -3509     -     49 +  --syntax-important: #ef4444; /* For !important */
8199     -8168     -3510     -     50 +
8200     -8169     -3511     -     51 +  /* Core hue-6: Orange (29¬∞) - Class names, constants, numbers, atrules */
8201     -8170     -3512     -     52 +  --syntax-class-name: #f97316; /* Orange for class/type names (Rectangle, Shape) */
8202     -8171     -3513     -     53 +  --syntax-number: #fb923c; /* Bright orange for numbers */
8203     -8172     -3514     -     54 +  --syntax-constant: #ea580c; /* Burnt orange for constants */
8204     -8173     -3515     -     55 +  --syntax-boolean: #fb923c; /* Same as numbers */
8205     -8174     -3516     -     56 +  --syntax-atrule: #fb923c; /* CSS @ rules */
8206     -8175     -3517     -     57 +
8207     -8176     -3518     -     58 +  /* Neutral colors */
8208     -8177     -3519     -     59 +  --syntax-comment: #a8a29e; /* Muted stone for comments */
8209     -8178     -3520     -     60 +  --syntax-punctuation: #64748b; /* Slate for punctuation */
8210     -8179     -3521     -     61 +  --syntax-operator: #fb7185; /* Coral rose for operators */
8211     -8180     -3522     -     62 +
8212     -8181     -3523     -     63 +  /* Markup specific */
8213     -8182     -3524     -     64 +  --syntax-attr-name: #f97316; /* Orange like class-name */
8214     -8183     -3525     -     65 +  --syntax-attr-value: #10b981; /* Green like strings */
8215     -8184     -3526     -     66 +  --syntax-namespace: #a855f7; /* Purple like keywords */
8216     -8185     -3527     -     67 +  --syntax-entity: #64748b; /* Neutral */
8217     -8186     -3528     -     68 +  --syntax-selector: #ef4444; /* Red like properties */
8218     -8187     -3529     - 40  69  
8219     -8188     -3530     - 41  70    --blockquote-border: #f97316;
8220     -8189     -3531     - 42  71    --blockquote-bg: #ffedd5;
8221     -8190     -3532     -@@ -44,4 +73,87 @@
8222     -8191     -3533     - 44  73    --italic-color: #e11d48;
8223     -8192     -3534     - 45  74    --table-header-bg: #fed7aa;
8224     -8193     -3535     - 46  75    --table-border: #fdba74;
8225     -8194     -3536     -     76 +
8226     -8195     -3537     -     77 +  /* === MERMAID COMPREHENSIVE CONFIGURATION === */
8227     -8196     -3538     -     78 +
8228     -8197     -3539     -     79 +  /* Core Global */
8229     -8198     -3540     -     80 +  --mermaid-background: #fff7ed;
8230     -8199     -3541     -     81 +  --mermaid-text-color: #431407;
8231     -8200     -3542     -     82 +  --mermaid-line-color: #f97316;
8232     -8201     -3543     -     83 +  --mermaid-main-bkg: #fed7aa;
8233     -8202     -3544     -     84 +
8234     -8203     -3545     -     85 +  /* Primary Set */
8235     -8204     -3546     -     86 +  --mermaid-primary-color: #fed7aa;
8236     -8205     -3547     -     87 +  --mermaid-primary-text-color: #431407;
8237     -8206     -3548     -     88 +  --mermaid-primary-border-color: #ea580c;
8238     -8207     -3549     -     89 +
8239     -8208     -3550     -     90 +  /* Secondary Set */
8240     -8209     -3551     -     91 +  --mermaid-secondary-color: #ffedd5;
8241     -8210     -3552     -     92 +  --mermaid-secondary-text-color: #431407;
8242     -8211     -3553     -     93 +  --mermaid-secondary-border-color: #f97316;
8243     -8212     -3554     -     94 +
8244     -8213     -3555     -     95 +  /* Tertiary Set */
8245     -8214     -3556     -     96 +  --mermaid-tertiary-color: #fff7ed;
8246     -8215     -3557     -     97 +  --mermaid-tertiary-text-color: #431407;
8247     -8216     -3558     -     98 +  --mermaid-tertiary-border-color: #fb923c;
8248     -8217     -3559     -     99 +
8249     -8218     -3560     -    100 +  /* Flowchart */
8250     -8219     -3561     -    101 +  --mermaid-node-border: #ea580c;
8251     -8220     -3562     -    102 +  --mermaid-cluster-bkg: #ffedd5;
8252     -8221     -3563     -    103 +  --mermaid-cluster-border: #f97316;
8253     -8222     -3564     -    104 +  --mermaid-default-link-color: #f97316;
8254     -8223     -3565     -    105 +  --mermaid-title-color: #431407;
8255     -8224     -3566     -    106 +  --mermaid-edge-label-background: #fff7ed;
8256     -8225     -3567     -    107 +  --mermaid-node-text-color: #431407;
8257     -8226     -3568     -    108 +
8258     -8227     -3569     -    109 +  /* Sequence Diagram */
8259     -8228     -3570     -    110 +  --mermaid-actor-bkg: #fed7aa;
8260     -8229     -3571     -    111 +  --mermaid-actor-border: #ea580c;
8261     -8230     -3572     -    112 +  --mermaid-actor-text-color: #431407;
8262     -8231     -3573     -    113 +  --mermaid-actor-line-color: #ea580c;
8263     -8232     -3574     -    114 +  --mermaid-signal-color: #f97316;
8264     -8233     -3575     -    115 +  --mermaid-signal-text-color: #431407;
8265     -8234     -3576     -    116 +  --mermaid-label-box-bkg-color: #fed7aa;
8266     -8235     -3577     -    117 +  --mermaid-label-box-border-color: #ea580c;
8267     -8236     -3578     -    118 +  --mermaid-label-text-color: #431407;
8268     -8237     -3579     -    119 +  --mermaid-loop-text-color: #431407;
8269     -8238     -3580     -    120 +  --mermaid-activation-border-color: #f97316;
8270     -8239     -3581     -    121 +  --mermaid-activation-bkg-color: #ffedd5;
8271     -8240     -3582     -    122 +  --mermaid-sequence-number-color: #431407;
8272     -8241     -3583     -    123 +
8273     -8242     -3584     -    124 +  /* Pie Chart */
8274     -8243     -3585     -    125 +  --mermaid-pie1: #ea580c;
8275     -8244     -3586     -    126 +  --mermaid-pie2: #f97316;
8276     -8245     -3587     -    127 +  --mermaid-pie3: #fb923c;
8277     -8246     -3588     -    128 +  --mermaid-pie4: #dc2626;
8278     -8247     -3589     -    129 +  --mermaid-pie5: #e11d48;
8279     -8248     -3590     -    130 +  --mermaid-pie6: #db2777;
8280     -8249     -3591     -    131 +  --mermaid-pie7: #c2410c;
8281     -8250     -3592     -    132 +  --mermaid-pie8: #14b8a6;
8282     -8251     -3593     -    133 +  --mermaid-pie9: #3b82f6;
8283     -8252     -3594     -    134 +  --mermaid-pie10: #a855f7;
8284     -8253     -3595     -    135 +  --mermaid-pie11: #ef4444;
8285     -8254     -3596     -    136 +  --mermaid-pie12: #10b981;
8286     -8255     -3597     -    137 +  --mermaid-pie-title-text-color: #431407;
8287     -8256     -3598     -    138 +  --mermaid-pie-section-text-color: #fff7ed; /* Light on vibrant slices */
8288     -8257     -3599     -    139 +  --mermaid-pie-legend-text-color: #431407;
8289     -8258     -3600     -    140 +  --mermaid-pie-stroke-color: #ea580c;
8290     -8259     -3601     -    141 +  --mermaid-pie-outer-stroke-color: #ea580c;
8291     -8260     -3602     -    142 +
8292     -8261     -3603     -    143 +  /* State Diagram */
8293     -8262     -3604     -    144 +  --mermaid-label-color: #431407;
8294     -8263     -3605     -    145 +  --mermaid-alt-background: #ffedd5;
8295     -8264     -3606     -    146 +
8296     -8265     -3607     -    147 +  /* Class Diagram */
8297     -8266     -3608     -    148 +  --mermaid-class-text: #431407;
8298     -8267     -3609     -    149 +
8299     -8268     -3610     -    150 +  /* User Journey */
8300     -8269     -3611     -    151 +  --mermaid-fill-type0: #ea580c;
8301     -8270     -3612     -    152 +  --mermaid-fill-type1: #f97316;
8302     -8271     -3613     -    153 +  --mermaid-fill-type2: #fb923c;
8303     -8272     -3614     -    154 +  --mermaid-fill-type3: #dc2626;
8304     -8273     -3615     -    155 +  --mermaid-fill-type4: #e11d48;
8305     -8274     -3616     -    156 +  --mermaid-fill-type5: #db2777;
8306     -8275     -3617     -    157 +  --mermaid-fill-type6: #c2410c;
8307     -8276     -3618     -    158 +  --mermaid-fill-type7: #14b8a6;
8308     -8277     -3619     - 47 159  }
8309     -8278     -3620     - 48 160  
8310     -8279     -    4706 +     38 +### Phase C: Infrastructure (Week 3)
8311     -8280     -    4707 +     39 +- [ ] Migrate runtime deps (Marked, Mermaid) to `npm`
8312     -8281     -    4708 +     40 +- [ ] Configure Vite for production bundling
8313     -8282     -    4709 +     41 +- [ ] Set up basic E2E tests for critical paths (Render, Export)
8314     -8283     -    4710 +     42  
8315     -8284     -    4711 +
8316     -8285     -    4712 +```
8317     -8286     -    4713 +
8318     -8287     -    4714 +
8319     -8288     -    4715 +### ‚ú® `codebase_audit/phase6_final_deliverables.md` **[ADDED]**
8320     -8289     -    4716 +
8321     -8290     -    4717 +**Status:** ‚úÖ **NEW FILE** - This file has been newly created
8322     -8291     -    4718 +
8323     -8292     -    4719 +**Type:** Documentation üìñ
8324     -8293     -    4720 +
8325     -8294     -    4721 +```diff
8326     -8295     -    4722 +@@ -0,0 +1,44 @@
8327     -8296     -    4723 +      1 +# üì¶ Phase 6: Final Deliverables
8328     -8297     -    4724 +      2 +
8329     -8298     -    4725 +      3 +## 1. Audit Summary
8330     -8299     -    4726 +      4 +The `markdown-viewer-app` is a capable, feature-rich static web application. It delivers on its core promise of "no set-up" markdown viewing. However, it carries significant **Technical Debt** in its control structure (`script.js`) and a **Critical Security Vulnerability** that makes it unsafe for handling untrusted files.
8331     -8300     -    4727 +      5 +
8332     -8301     -    4728 +      6 +## 2. Test Strategy Outline
8333     -8302     -    4729 +      7 +To ensure quality during the proposed refactoring, we recommend the following test strategy:
8334     -8303     -    4730 +      8 +
8335     -8304     -    4731 +      9 +*   **Unit Tests (Vitest):**
8336     -8305     -    4732 +     10 +    *   Cover `StorageManager` (Data persistence).
8337     -8306     -    4733 +     11 +    *   Cover `ThemeManager` (Logic correctness).
8338     -8307     -    4734 +     12 +    *   Cover `Sanitization` (Verify malicious inputs are stripped).
8339     -8308     -    4735 +     13 +*   **Integration Tests:**
8340     -8309     -    4736 +     14 +    *   Verify `MermaidService` correctly loads config from `ThemeManager`.
8341     -8310     -    4737 +     15 +*   **Manual Acceptance Tests:**
8342     -8311     -    4738 +     16 +    *   "The Scroll Sync Test": Verify proportional scrolling in split view.
8343     -8312     -    4739 +     17 +    *   "The Theme Switch Test": Verify no "flash of white" or broken diagrams on switch.
8344     -8313     -    4740 +     18 +
8345     -8314     -    4741 +     19 +## 3. Stakeholder Slide-Deck Outline
8346     -8315     -    4742 +     20 +
8347     -8316     -    4743 +     21 +**Slide 1: Title**
8348     -8317     -    4744 +     22 +*   **audit Report: Markdown Viewer Pro**
8349     -8318     -    4745 +     23 +*   *Status: Critical Issues Found*
8350     -8319     -    4746 +     24 +
8351     -8320     -    4747 +     25 +**Slide 2: The Good**
8352     -8321     -    4748 +     26 +*   Zero-config, runs everywhere.
8353     -8322     -    4749 +     27 +*   Modular Service layer (Mermaid, Prism, PDF) is well-designed.
8354     -8323     -    4750 +     28 +*   Excellent Documentation.
8355     -8324     -    4751 +     29 +
8356     -8325     -    4752 +     30 +**Slide 3: The Bad (Critical Findings)**
8357     -8326     -    4753 +     31 +*   **Security:** XSS Vulnerability (Malicious MD files can hack users).
8358     -8327     -    4754 +     32 +*   **Stability:** Race conditions cause occasional rendering glitches.
8359     -8328     -    4755 +     33 +
8360     -8329     -    4756 +     34 +**Slide 4: The Ugly (Tech Debt)**
8361     -8330     -    4757 +     35 +*   `script.js` is a "God Object" (1300+ lines).
8362     -8331     -    4758 +     36 +*   Hard to maintain or extend without accidental breakage.
8363     -8332     -    4759 +     37 +
8364     -8333     -    4760 +     38 +**Slide 5: The Plan**
8365     -8334     -    4761 +     39 +*   **Immediate:** Fix Security.
8366     -8335     -    4762 +     40 +*   **Next:** Refactor Controller.
8367     -8336     -    4763 +     41 +*   **Future:** TypeScript & Bundling.
8368     -8337     -    4764 +     42 +
8369     -8338     -    4765 +     43 +**Slide 6: Approval Request**
8370     -8339     -    4766 +     44 +*   Requesting approval to proceed with Phase A (Security Fixes).
8371     -8340     -    4767 +     45  
8372     -8341     -    4768 +
8373     -8342     -    4769 +```
8374     -8343     -    4770 +
8375     -8344     -    4771 +
8376     -8345     -    4772 +### ‚ú® `codebase_audit/repo_manifest.json` **[ADDED]**
8377     -8346     -    4773 +
8378     -8347     -    4774 +**Status:** ‚úÖ **NEW FILE** - This file has been newly created
8379     -8348     -    4775 +
8380     -8349     -    4776 +**Type:** Configuration/Data File üìã
8381     -8350     -    4777 +
8382     -8351     -    4778 +```diff
8383     -8352     -    4779 +@@ -0,0 +1,74 @@
8384     -8353     -    4780 +      1 +{
8385     -8354     -    4781 +      2 +  "documentation": [
8386     -8355     -    4782 +      3 +    "AI_REVIEW.md",
8387     -8356     -    4783 +      4 +    "MARKDOWN_TEST.md",
8388     -8357     -    4784 +      5 +    "QUICK-REFERENCE.md",
8389     -8358     -    4785 +      6 +    "README.md",
8390     -8359     -    4786 +      7 +    "docs/01-requirements/folder-browser-feature-plan.md",
8391     -8360     -    4787 +      8 +    "docs/01-requirements/math-rendering-feature-plan.md",
8392     -8361     -    4788 +      9 +    "docs/01-requirements/pdf-export-plan.md",
8393     -8362     -    4789 +     10 +    "docs/01-requirements/pdf-viewer-feature-plan.md",
8394     -8363     -    4790 +     11 +    "docs/02-architecture/architecture-review.md",
8395     -8364     -    4791 +     12 +    "docs/02-architecture/architecture.md",
8396     -8365     -    4792 +     13 +    "docs/02-architecture/mermaid-theme-architecture.md",
8397     -8366     -    4793 +     14 +    "docs/02-architecture/phase6-improvements.md",
8398     -8367     -    4794 +     15 +    "docs/02-architecture/prism-token-architecture.md",
8399     -8368     -    4795 +     16 +    "docs/02-architecture/syntax-highlighting-architecture.md",
8400     -8369     -    4796 +     17 +    "docs/05-implementation/implementation-plan.md",
8401     -8370     -    4797 +     18 +    "docs/05-implementation/refactoring-guide.md",
8402     -8371     -    4798 +     19 +    "docs/05-implementation/refactoring-strategy.md",
8403     -8372     -    4799 +     20 +    "docs/05-implementation/week6-final-integration.md",
8404     -8373     -    4800 +     21 +    "docs/08-deployment/deployment.md",
8405     -8374     -    4801 +     22 +    "docs/08-deployment/github-pages-deployment.md",
8406     -8375     -    4802 +     23 +    "memory-bank/activeContext.md",
8407     -8376     -    4803 +     24 +    "memory-bank/productContext.md",
8408     -8377     -    4804 +     25 +    "memory-bank/progress.md",
8409     -8378     -    4805 +     26 +    "memory-bank/projectbrief.md",
8410     -8379     -    4806 +     27 +    "memory-bank/systemPatterns.md",
8411     -8380     -    4807 +     28 +    "memory-bank/techContext.md"
8412     -8381     -    4808 +     29 +  ],
8413     -8382     -    4809 +     30 +  "source_code": {
8414     -8383     -    4810 +     31 +    "javascript": [
8415     -8384     -    4811 +     32 +      "script.js",
8416     -8385     -    4812 +     33 +      "src/js/services/MermaidService.js",
8417     -8386     -    4813 +     34 +      "src/js/services/FolderBrowserService.js",
8418     -8387     -    4814 +     35 +      "src/js/services/PDFService.js",
8419     -8388     -    4815 +     36 +      "src/js/services/PrismService.js",
8420     -8389     -    4816 +     37 +      "src/js/utils/htmlHelpers.js",
8421     -8390     -    4817 +     38 +      "src/js/utils/colorHelpers.js",
8422     -8391     -    4818 +     39 +      "src/js/utils/validators.js",
8423     -8392     -    4819 +     40 +      "src/js/config/featureFlags.js",
8424     -8393     -    4820 +     41 +      "src/js/config/constants.js",
8425     -8394     -    4821 +     42 +      "src/js/core/ThemeManager.js",
8426     -8395     -    4822 +     43 +      "src/js/core/StorageManager.js"
8427     -8396     -    4823 +     44 +    ],
8428     -8397     -    4824 +     45 +    "css": [
8429     -8398     -    4825 +     46 +      "style.css",
8430     -8399     -    4826 +     47 +      "themes/obsidian-light.css",
8431     -8400     -    4827 +     48 +      "themes/ocean-light.css",
8432     -8401     -    4828 +     49 +      "themes/sunset-light.css",
8433     -8402     -    4829 +     50 +      "themes/default-light.css",
8434     -8403     -    4830 +     51 +      "themes/obsidian-dark.css",
8435     -8404     -    4831 +     52 +      "themes/sunset-dark.css",
8436     -8405     -    4832 +     53 +      "themes/neon-light.css",
8437     -8406     -    4833 +     54 +      "themes/forest-light.css",
8438     -8407     -    4834 +     55 +      "themes/forest-dark.css",
8439     -8408     -    4835 +     56 +      "themes/ocean-dark.css",
8440     -8409     -    4836 +     57 +      "themes/neon-dark.css",
8441     -8410     -    4837 +     58 +      "themes/default-dark.css"
8442     -8411     -    4838 +     59 +    ],
8443     -8412     -    4839 +     60 +    "html": [
8444     -8413     -    4840 +     61 +      "index.html"
8445     -8414     -    4841 +     62 +    ]
8446     -8415     -    4842 +     63 +  },
8447     -8416     -    4843 +     64 +  "config": [
8448     -8417     -    4844 +     65 +    ".clinerules",
8449     -8418     -    4845 +     66 +    ".eslintrc.js",
8450     -8419     -    4846 +     67 +    ".gitignore",
8451     -8420     -    4847 +     68 +    ".prettierrc",
8452     -8421     -    4848 +     69 +    "package.json",
8453     -8422     -    4849 +     70 +    "vite.config.js",
8454     -8423     -    4850 +     71 +    "vitest.config.js",
8455     -8424     -    4851 +     72 +    "tests/setup.js"
8456     -8425     -    4852 +     73 +  ]
8457     -8426     -    4853 +     74 +}
8458     -8427     -    4854 +     75  
8459     -8428     -3621 4855  
8460     -8429     -3622 4856  ```
8461     -8430     -3623 4857  
8462     -8431     -@@ -3663,4 +4897,4 @@ Please provide specific feedback on:
8463     -8432     -3663 4897  
8464     -8433     -3664 4898  ---
8465     -8434     -3665 4899  *Generated by AI Visual Code Review v2.0 - Unified Export Script*
8466     -8435     -3666     -*Files processed: 18/18 | Errors: 0 | Generated: 2025-12-07T04:29:24.609Z*
8467     -8436     -    4900 +*Files processed: 13/13 | Errors: 0 | Generated: 2025-12-09T01:32:01.029Z*
8468     -8437     -3667 4901  
8469     -8438     -
8470     -8439     -```
8471     -8440     -
8472     -8441     -
8473     -8442     -### üìÑ `package-lock.json`
8474     -8443     -
8475     -8444     -**Type:** Configuration/Data File üìã
8476     -8445     -
8477     -8446     -```diff
8478     -8447     -@@ -9,6 +9,7 @@
8479     -8448     -  9   9        "version": "0.1.0",
8480     -8449     - 10  10        "license": "MIT",
8481     -8450     - 11  11        "dependencies": {
8482     -8451     -     12 +        "dompurify": "3.3.1",
8483     -8452     - 12  13          "marked-footnote": "1.4.0"
8484     -8453     - 13  14        },
8485     -8454     - 14  15        "devDependencies": {
8486     -8455     -@@ -1280,6 +1281,13 @@
8487     -8456     -1280 1281        "dev": true,
8488     -8457     -1281 1282        "license": "MIT"
8489     -8458     -1282 1283      },
8490     -8459     -    1284 +    "node_modules/@types/trusted-types": {
8491     -8460     -    1285 +      "version": "2.0.7",
8492     -8461     -    1286 +      "resolved": "https://registry.npmjs.org/@types/trusted-types/-/trusted-types-2.0.7.tgz",
8493     -8462     -    1287 +      "integrity": "sha512-ScaPdn1dQczgbl0QFTeTOmVHFULt394XJgOQNoyVhZ6r2vLnMLJfBPd53SB52T/3G36VI1/g2MZaX0cwDuXsfw==",
8494     -8463     -    1288 +      "license": "MIT",
8495     -8464     -    1289 +      "optional": true
8496     -8465     -    1290 +    },
8497     -8466     -1283 1291      "node_modules/@vitest/coverage-v8": {
8498     -8467     -1284 1292        "version": "4.0.8",
8499     -8468     -1285 1293        "resolved": "https://registry.npmjs.org/@vitest/coverage-v8/-/coverage-v8-4.0.8.tgz",
8500     -8469     -@@ -1932,6 +1940,15 @@
8501     -8470     -1932 1940          "npm": "1.2.8000 || >= 1.4.16"
8502     -8471     -1933 1941        }
8503     -8472     -1934 1942      },
8504     -8473     -    1943 +    "node_modules/dompurify": {
8505     -8474     -    1944 +      "version": "3.3.1",
8506     -8475     -    1945 +      "resolved": "https://registry.npmjs.org/dompurify/-/dompurify-3.3.1.tgz",
8507     -8476     -    1946 +      "integrity": "sha512-qkdCKzLNtrgPFP1Vo+98FRzJnBRGe4ffyCea9IwHB1fyxPOeNTHpLKYGd4Uk9xvNoH0ZoOjwZxNptyMwqrId1Q==",
8508     -8477     -    1947 +      "license": "(MPL-2.0 OR Apache-2.0)",
8509     -8478     -    1948 +      "optionalDependencies": {
8510     -8479     -    1949 +        "@types/trusted-types": "^2.0.7"
8511     -8480     -    1950 +      }
8512     -8481     -    1951 +    },
8513     -8482     -1935 1952      "node_modules/dunder-proto": {
8514     -8483     -1936 1953        "version": "1.0.1",
8515     -8484     -1937 1954        "resolved": "https://registry.npmjs.org/dunder-proto/-/dunder-proto-1.0.1.tgz",
8516     -8485     -1938 1955  
8517     -8486     -
8518     -8487     -```
8519     -8488     -
8520     -8489     -
8521     -8490     -### üìÑ `package.json`
8522     -8491     -
8523     -8492     -**Type:** Configuration/Data File üìã
8524     -8493     -
8525     -8494     -```diff
8526     -8495     -@@ -41,6 +41,7 @@
8527     -8496     - 41  41      "vitest": "4.0.8"
8528     -8497     - 42  42    },
8529     -8498     - 43  43    "dependencies": {
8530     -8499     -     44 +    "dompurify": "3.3.1",
8531     -8500     - 44  45      "marked-footnote": "1.4.0"
8532     -8501     - 45  46    }
8533     -8502     - 46  47  }
8534     -8503     - 47  48  
8535     -8504     -
8536     -8505     -```
8537     -     16 +### üì¶ Large Files Skipped
8538     -     17 +The following files were skipped due to size (use --no-size-limit to include):
8539     -     18 +- `AI_REVIEW.md`
8540     -8506  19  
8541     -8507  20  
8542     -8508  21  ### üìÑ `script.js`
8543     -@@ -8510,1585 +23,1614 @@
8544     -8510  23  **Type:** JavaScript Source File üü®
8545     -8511  24  
8546     -8512  25  ```diff
8547     -8513     -@@ -7,6 +7,7 @@ import { FolderBrowserService } from './src/js/services/FolderBrowserService.js'
8548     -8514     -  7   7  import { MermaidService } from './src/js/services/MermaidService.js';
8549     -8515     -  8   8  import { PDFService } from './src/js/services/PDFService.js';
8550     -8516     -  9   9  import { PrismService } from './src/js/services/PrismService.js';
8551     -8517     -     10 +import DOMPurify from 'dompurify';
8552     -8518     - 10  11  
8553     -8519     - 11  12  // Initialize services and managers
8554     -8520     - 12  13  const storageManager = new StorageManager();
8555     -8521     -@@ -94,6 +95,23 @@ function initializeApp() {
8556     -8522     - 94  95    setupEditor();
8557     -8523     - 95  96  }
8558     -8524     - 96  97  
8559     -8525     -     98 +/**
8560     -8526     -     99 + * Debounce utility function
8561     -8527     -    100 + * @param {Function} func - Function to debounce
8562     -8528     -    101 + * @param {number} wait - Wait time in milliseconds
8563     -8529     -    102 + * @returns {Function} Debounced function
8564     -8530     -    103 + */
8565     -8531     -    104 +function debounce(func, wait) {
8566     -8532     -    105 +  let timeout;
8567     -8533     -    106 +  return function truncated(...args) {
8568     -8534     -    107 +    const context = this;
8569     -8535     -    108 +    clearTimeout(timeout);
8570     -8536     -    109 +    timeout = setTimeout(() => {
8571     -8537     -    110 +      func.apply(context, args);
8572     -8538     -    111 +    }, wait);
8573     -8539     -    112 +  };
8574     -8540     -    113 +}
8575     -8541     -    114 +
8576     -8542     - 97 115  // Configure marked.js extensions (math + footnotes + admonitions)
8577     -8543     - 98 116  function configureMarkedExtensions() {
8578     -8544     - 99 117    // Enable footnote support
8579     -8545     -@@ -507,98 +525,107 @@ graph TD
8580     -8546     -507 525            }, 100);
8581     -8547     -508 526            return `<div class="mermaid" id="${id}">${code}</div>`;
8582     -8548     -509 527          }
8583     -8549     -    528 +        }
8584     -8550     -510 529        );
8585     -8551     -511 530  
8586     -8552     -512     -      preview.innerHTML = html;
8587     -8553     -513     -
8588     -8554     -514     -      // Apply Prism syntax highlighting using PrismService
8589     -8555     -515     -      prismService.highlightAll(preview);
8590     -8556     -516     -
8591     -8557     -517     -      // NOTE: KaTeX auto-render is DISABLED
8592     -8558     -518     -      // We handle all math via marked.js extensions ($...$ and $$...$$)
8593     -8559     -519     -      // KaTeX auto-render was causing issues with unsupported LaTeX environments
8594     -8560     -520     -
8595     -8561     -521     -      // Save content using StorageManager
8596     -8562     -522     -      storageManager.set('markdownContent', markdownText);
8597     -8563     -523     -    } catch (error) {
8598     -8564     -524     -      console.error('Render error:', error);
8599     -8565     -525     -      preview.innerHTML =
8600     -8566     -526     -        '<p style="color: red;">Error rendering markdown: ' + error.message + '</p>';
8601     -8567     -527     -    }
8602     -8568     -528     -  }
8603     -8569     -529     -
8604     -8570     -530     -  // Change theme using ThemeManager
8605     -8571     -531     -  async function changeTheme(themeName) {
8606     -8572     -532     -    await themeManager.loadTheme(themeName);
8607     -8573     -533     -
8608     -8574     -534     -    // Wait for theme to load, then reinitialize Mermaid and force re-render
8609     -8575     -535     -    setTimeout(() => {
8610     -8576     -536     -      // Clear existing Mermaid diagrams to force fresh render with new colors
8611     -8577     -537     -      const mermaidElements = preview.querySelectorAll('.mermaid');
8612     -8578     -538     -      mermaidElements.forEach(el => {
8613     -8579     -539     -        // Reset to original code to force re-render
8614     -8580     -540     -        el.innerHTML = el.dataset.originalCode || '';
8615     -8581     -541     -      });
8616     -8582     -542     -
8617     -8583     -543     -      // Re-render markdown with new theme
8618     -8584     -544     -      renderMarkdown();
8619     -8585     -545     -    }, 100);
8620     -8586     -546     -  }
8621     -     26 +@@ -1,13 +1,13 @@
8622     -     27 +  1   1  // Markdown Viewer Pro - Main Script
8623     -     28 +  2   2  
8624     -     29 +  3   3  // Import constants, utilities, services, and core modules
8625     -     30 +      4 +import DOMPurify from 'dompurify';
8626     -     31 +  4   5  import { StorageManager } from './src/js/core/StorageManager.js';
8627     -     32 +  5   6  import { ThemeManager } from './src/js/core/ThemeManager.js';
8628     -     33 +  6   7  import { FolderBrowserService } from './src/js/services/FolderBrowserService.js';
8629     -     34 +  7   8  import { MermaidService } from './src/js/services/MermaidService.js';
8630     -     35 +  8   9  import { PDFService } from './src/js/services/PDFService.js';
8631     -     36 +  9  10  import { PrismService } from './src/js/services/PrismService.js';
8632     -     37 + 10     -import DOMPurify from 'dompurify';
8633     -     38 + 11  11  
8634     -     39 + 12  12  // Initialize services and managers
8635     -     40 + 13  13  const storageManager = new StorageManager();
8636     -     41 +@@ -29,12 +29,11 @@ themeManager.setThemeChangeListener(() => {
8637     -     42 + 29  29    mermaidService.reinitialize();
8638     -     43 + 30  30  
8639     -     44 + 31  31    // Force re-render of markdown to apply new Mermaid colors
8640     -     45 + 32     -  setTimeout(() => {
8641     -     46 + 33     -    if (globalRenderMarkdown) {
8642     -     47 + 34     -      console.log('üîÑ Re-rendering diagrams with new theme colors');
8643     -     48 + 35     -      globalRenderMarkdown();
8644     -     49 + 36     -    }
8645     -     50 + 37     -  }, 200);
8646     -     51 +     32 +  // No timeout needed - waiting for next microtask is sufficient
8647     -     52 +     33 +  if (globalRenderMarkdown) {
8648     -     53 +     34 +    console.log('üîÑ Re-rendering diagrams with new theme colors');
8649     -     54 +     35 +    globalRenderMarkdown();
8650     -     55 +     36 +  }
8651     -     56 + 38  37  });
8652     -     57 + 39  38  
8653     -     58 + 40  39  // Wait for all scripts to load
8654     -     59 +@@ -498,134 +497,120 @@ graph TD
8655     -     60 +498 497        // Parse markdown with all extensions
8656     -     61 +499 498        let html = marked.parse(markdownText);
8657     -     62 +500 499  
8658     -     63 +501     -      // Replace mermaid code blocks
8659     -     64 +    500 +      // Replace mermaid code blocks with placeholders
8660     -     65 +502 501        html = html.replace(
8661     -     66 +503 502          /<pre><code class="language-mermaid">([\s\S]*?)<\/code><\/pre>/g,
8662     -     67 +504 503          (match, code) => {
8663     -     68 +505     -          // Decode HTML entities before passing to Mermaid
8664     -     69 +506 504            const decodedCode = decodeHtmlEntities(code);
8665     -     70 +507 505            const id = 'mermaid-' + Math.random().toString(36).substr(2, 9);
8666     -     71 +508     -          setTimeout(() => {
8667     -     72 +509     -            try {
8668     -     73 +510     -              const element = document.getElementById(id);
8669     -     74 +511     -              if (element && typeof mermaid !== 'undefined') {
8670     -     75 +512     -                mermaid
8671     -     76 +513     -                  .render('mermaid-svg-' + id, decodedCode)
8672     -     77 +514     -                  .then(result => {
8673     -     78 +515     -                    element.innerHTML = result.svg;
8674     -     79 +516     -                  })
8675     -     80 +517     -                  .catch(err => {
8676     -     81 +518     -                    element.innerHTML =
8677     -     82 +519     -                      '<p style="color: red;">Mermaid diagram error: ' + err.message + '</p>';
8678     -     83 +520     -                  });
8679     -     84 +521     -              }
8680     -     85 +522     -            } catch (e) {
8681     -     86 +523     -              console.error('Mermaid render error:', e);
8682     -     87 +524     -            }
8683     -     88 +525     -          }, 100);
8684     -     89 +526     -          return `<div class="mermaid" id="${id}">${code}</div>`;
8685     -     90 +527     -        }
8686     -     91 +    506 +          // Return placeholder div
8687     -     92 +    507 +          return `<div class="mermaid" id="${id}" data-code="${encodeURIComponent(decodedCode)}">${code}</div>`;
8688     -     93 +528 508          }
8689     -     94 +529 509        );
8690     -     95 +530 510  
8691     -     96 +531     -    // Sanitize HTML using DOMPurify
8692     -     97 +532     -    // Allow SVG for Mermaid diagrams and math classes
8693     -     98 +533     -    const cleanHtml = DOMPurify.sanitize(html, {
8694     -     99 +534     -      ADD_TAGS: ['iframe'], // Allow iframes for PDF preview if needed
8695     -    100 +535     -      ADD_ATTR: ['allow', 'allowfullscreen', 'frameborder', 'scrolling', 'target'],
8696     -    101 +536     -      USE_PROFILES: { html: true, svg: true, mathml: true },
8697     -    102 +537     -    });
8698     -    103 +538     -
8699     -    104 +539     -    preview.innerHTML = cleanHtml;
8700     -    105 +540     -
8701     -    106 +541     -    // Apply Prism syntax highlighting using PrismService
8702     -    107 +542     -    prismService.highlightAll(preview);
8703     -    108 +543     -
8704     -    109 +544     -    // NOTE: KaTeX auto-render is DISABLED
8705     -    110 +545     -    // We handle all math via marked.js extensions ($...$ and $$...$$)
8706     -    111 +546     -    // KaTeX auto-render was causing issues with unsupported LaTeX environments
8707     -8587 112  547     -
8708     -8588     -548     -  // Initialize color inputs
8709     -8589     -549     -  function initColorInputs() {
8710     -8590     -550     -    document.querySelectorAll('.color-control input[type="color"]').forEach(input => {
8711     -8591     -551     -      const varName = input.dataset.var;
8712     -8592     -552     -      const textInput = document.getElementById(input.id + '-text');
8713     -8593     -553     -      const currentValue = getComputedStyle(document.documentElement)
8714     -8594     -554     -        .getPropertyValue(varName)
8715     -8595     -555     -        .trim();
8716     -    113 +548     -    // Save content using StorageManager
8717     -    114 +549     -    storageManager.set('markdownContent', markdownText);
8718     -    115 +550     -  } catch (error) {
8719     -    116 +551     -    console.error('Render error:', error);
8720     -    117 +552     -    preview.innerHTML =
8721     -    118 +553     -      '<p style="color: red;">Error rendering markdown: ' + error.message + '</p>';
8722     -    119 +554     -  }
8723     -    120 +555     -}
8724     -8596 121  556     -
8725     -8597     -557     -      input.value = currentValue;
8726     -8598     -558     -      textInput.value = currentValue;
8727     -8599     -559     -
8728     -8600     -560     -      input.addEventListener('input', e => {
8729     -8601     -561     -        const color = e.target.value;
8730     -8602     -562     -        document.documentElement.style.setProperty(varName, color);
8731     -8603     -563     -        textInput.value = color;
8732     -8604     -564     -      });
8733     -8605     -    531 +    // Sanitize HTML using DOMPurify
8734     -8606     -    532 +    // Allow SVG for Mermaid diagrams and math classes
8735     -8607     -    533 +    const cleanHtml = DOMPurify.sanitize(html, {
8736     -8608     -    534 +      ADD_TAGS: ['iframe'], // Allow iframes for PDF preview if needed
8737     -8609     -    535 +      ADD_ATTR: ['allow', 'allowfullscreen', 'frameborder', 'scrolling', 'target'],
8738     -8610     -    536 +      USE_PROFILES: { html: true, svg: true, mathml: true },
8739     -8611     -565 537      });
8740     -8612     -    538 +
8741     -8613     -    539 +    preview.innerHTML = cleanHtml;
8742     -8614     -    540 +
8743     -8615     -    541 +    // Apply Prism syntax highlighting using PrismService
8744     -8616     -    542 +    prismService.highlightAll(preview);
8745     -8617     -    543 +
8746     -8618     -    544 +    // NOTE: KaTeX auto-render is DISABLED
8747     -8619     -    545 +    // We handle all math via marked.js extensions ($...$ and $$...$$)
8748     -8620     -    546 +    // KaTeX auto-render was causing issues with unsupported LaTeX environments
8749     -8621     -    547 +
8750     -8622     -    548 +    // Save content using StorageManager
8751     -8623     -    549 +    storageManager.set('markdownContent', markdownText);
8752     -8624     -    550 +  } catch (error) {
8753     -8625     -    551 +    console.error('Render error:', error);
8754     -8626     -    552 +    preview.innerHTML =
8755     -8627     -    553 +      '<p style="color: red;">Error rendering markdown: ' + error.message + '</p>';
8756     -8628     -    554 +  }
8757     -8629     -    555 +}
8758     -8630     -    556 +
8759     -8631     -    557 +// Change theme using ThemeManager
8760     -8632     -    558 +async function changeTheme(themeName) {
8761     -8633     -    559 +  await themeManager.loadTheme(themeName);
8762     -8634     -    560 +
8763     -8635     -    561 +  // Wait for theme to load, then reinitialize Mermaid and force re-render
8764     -8636     -    562 +  setTimeout(() => {
8765     -8637     -    563 +    // Clear existing Mermaid diagrams to force fresh render with new colors
8766     -8638     -    564 +    const mermaidElements = preview.querySelectorAll('.mermaid');
8767     -8639     -    565 +    mermaidElements.forEach(el => {
8768     -8640     -    566 +      // Reset to original code to force re-render
8769     -8641     -    567 +      el.innerHTML = el.dataset.originalCode || '';
8770     -8642     -    568 +    });
8771     -8643     -    569 +
8772     -8644     -    570 +    // Re-render markdown with new theme
8773     -8645     -    571 +    renderMarkdown();
8774     -8646     -    572 +  }, 100);
8775     -8647     -    573 +}
8776     -8648     -    574 +
8777     -8649     -    575 +// Initialize color inputs
8778     -8650     -    576 +function initColorInputs() {
8779     -8651     -    577 +  document.querySelectorAll('.color-control input[type="color"]').forEach(input => {
8780     -8652     -    578 +    const varName = input.dataset.var;
8781     -8653     -    579 +    const textInput = document.getElementById(input.id + '-text');
8782     -8654     -    580 +    const currentValue = getComputedStyle(document.documentElement)
8783     -8655     -    581 +      .getPropertyValue(varName)
8784     -8656     -    582 +      .trim();
8785     -8657     -    583 +
8786     -8658     -    584 +    input.value = currentValue;
8787     -8659     -    585 +    textInput.value = currentValue;
8788     -8660     -    586 +
8789     -8661     -    587 +    input.addEventListener('input', e => {
8790     -8662     -    588 +      const color = e.target.value;
8791     -8663     -    589 +      document.documentElement.style.setProperty(varName, color);
8792     -8664     -    590 +      textInput.value = color;
8793     -8665     -    591 +    });
8794     -8666     -    592 +  });
8795     -8667     -    593 +}
8796     -8668     -    594 +
8797     -8669     -    595 +// Export to HTML
8798     -8670     -    596 +function exportHTML() {
8799     -8671     -    597 +  const currentTheme = themeSelector.value;
8800     -8672     -    598 +  let themeCSS = '';
8801     -8673     -    599 +
8802     -8674     -    600 +  if (currentTheme === 'custom') {
8803     -8675     -    601 +    const customTheme = storageManager.getJSON('customTheme');
8804     -8676     -    602 +    if (customTheme) {
8805     -8677     -    603 +      const theme = customTheme;
8806     -8678     -    604 +      themeCSS = ':root {\n';
8807     -8679     -    605 +      Object.entries(theme).forEach(([property, value]) => {
8808     -8680     -    606 +        themeCSS += `    ${property}: ${value};\n`;
8809     -8681     -    607 +      });
8810     -8682     -    608 +      themeCSS += '}';
8811     -8683     -    609 +    }
8812     -8684     -    610 +  } else {
8813     -8685     -    611 +    // Fetch theme CSS
8814     -8686     -    612 +    fetch(`themes/${currentTheme}.css`)
8815     -8687     -    613 +      .then(response => response.text())
8816     -8688     -    614 +      .then(css => {
8817     -8689     -    615 +        themeCSS = css;
8818     -8690     -    616 +        generateHTML();
8819     -8691     -    617 +      })
8820     -8692     -    618 +      .catch(err => {
8821     -8693     -    619 +        console.error('Error loading theme:', err);
8822     -8694     -    620 +        generateHTML();
8823     -8695     -    621 +      });
8824     -8696     -    622 +    return;
8825     -8697     -566 623    }
8826     -8698     -567 624  
8827     -8699     -568     -  // Export to HTML
8828     -8700     -569     -  function exportHTML() {
8829     -8701     -570     -    const currentTheme = themeSelector.value;
8830     -8702     -571     -    let themeCSS = '';
8831     -8703     -    625 +  generateHTML();
8832     -8704     -572 626  
8833     -8705     -573     -    if (currentTheme === 'custom') {
8834     -8706     -574     -      const customTheme = storageManager.getJSON('customTheme');
8835     -8707     -575     -      if (customTheme) {
8836     -8708     -576     -        const theme = customTheme;
8837     -8709     -577     -        themeCSS = ':root {\n';
8838     -8710     -578     -        Object.entries(theme).forEach(([property, value]) => {
8839     -8711     -579     -          themeCSS += `    ${property}: ${value};\n`;
8840     -8712     -580     -        });
8841     -8713     -581     -        themeCSS += '}';
8842     -8714     -582     -      }
8843     -8715     -583     -    } else {
8844     -8716     -584     -      // Fetch theme CSS
8845     -8717     -585     -      fetch(`themes/${currentTheme}.css`)
8846     -8718     -586     -        .then(response => response.text())
8847     -8719     -587     -        .then(css => {
8848     -8720     -588     -          themeCSS = css;
8849     -8721     -589     -          generateHTML();
8850     -8722     -590     -        })
8851     -8723     -591     -        .catch(err => {
8852     -8724     -592     -          console.error('Error loading theme:', err);
8853     -8725     -593     -          generateHTML();
8854     -8726     -594     -        });
8855     -8727     -595     -      return;
8856     -8728     -596     -    }
8857     -8729     -597     -
8858     -8730     -598     -    generateHTML();
8859     -    122 +557     -// Change theme using ThemeManager
8860     -    123 +558     -async function changeTheme(themeName) {
8861     -    124 +559     -  await themeManager.loadTheme(themeName);
8862     -    125 +560     -
8863     -    126 +561     -  // Wait for theme to load, then reinitialize Mermaid and force re-render
8864     -    127 +562     -  setTimeout(() => {
8865     -    128 +563     -    // Clear existing Mermaid diagrams to force fresh render with new colors
8866     -    129 +564     -    const mermaidElements = preview.querySelectorAll('.mermaid');
8867     -    130 +565     -    mermaidElements.forEach(el => {
8868     -    131 +566     -      // Reset to original code to force re-render
8869     -    132 +567     -      el.innerHTML = el.dataset.originalCode || '';
8870     -    133 +568     -    });
8871     -    134 +569     -
8872     -    135 +570     -    // Re-render markdown with new theme
8873     -    136 +571     -    renderMarkdown();
8874     -    137 +572     -  }, 100);
8875     -    138 +573     -}
8876     -    139 +574     -
8877     -    140 +575     -// Initialize color inputs
8878     -    141 +576     -function initColorInputs() {
8879     -    142 +577     -  document.querySelectorAll('.color-control input[type="color"]').forEach(input => {
8880     -    143 +578     -    const varName = input.dataset.var;
8881     -    144 +579     -    const textInput = document.getElementById(input.id + '-text');
8882     -    145 +580     -    const currentValue = getComputedStyle(document.documentElement)
8883     -    146 +581     -      .getPropertyValue(varName)
8884     -    147 +582     -      .trim();
8885     -    148 +583     -
8886     -    149 +584     -    input.value = currentValue;
8887     -    150 +585     -    textInput.value = currentValue;
8888     -    151 +586     -
8889     -    152 +587     -    input.addEventListener('input', e => {
8890     -    153 +588     -      const color = e.target.value;
8891     -    154 +589     -      document.documentElement.style.setProperty(varName, color);
8892     -    155 +590     -      textInput.value = color;
8893     -    156 +591     -    });
8894     -    157 +592     -  });
8895     -    158 +593     -}
8896     -    159 +594     -
8897     -    160 +595     -// Export to HTML
8898     -    161 +596     -function exportHTML() {
8899     -    162 +597     -  const currentTheme = themeSelector.value;
8900     -    163 +598     -  let themeCSS = '';
8901     -8731 164  599     -
8902     -8732     -600     -    function generateHTML() {
8903     -8733     -601     -      const html = `<!DOCTYPE html>
8904     -8734     -    627 +  function generateHTML() {
8905     -8735     -    628 +    const html = `<!DOCTYPE html>
8906     -8736     -602 629  <html>
8907     -8737     -603 630  <head>
8908     -8738     -604 631      <meta charset="UTF-8">
8909     -8739     -@@ -648,723 +675,724 @@ graph TD
8910     -8740     -648 675      </style>
8911     -8741     -649 676  </head>
8912     -8742     -650 677  <body>
8913     -8743     -651     -    ${preview.innerHTML}
8914     -8744     -    678 +    ${DOMPurify.sanitize(preview.innerHTML)}
8915     -8745     -652 679  </body>
8916     -8746     -653 680  </html>`;
8917     -8747     -654 681  
8918     -8748     -655     -      const blob = new Blob([html], { type: 'text/html' });
8919     -8749     -656     -      const url = URL.createObjectURL(blob);
8920     -8750     -657     -      const a = document.createElement('a');
8921     -8751     -658     -      a.href = url;
8922     -8752     -659     -      a.download = 'markdown-export.html';
8923     -8753     -660     -      a.click();
8924     -8754     -661     -      URL.revokeObjectURL(url);
8925     -8755     -662     -    }
8926     -8756     -    682 +    const blob = new Blob([html], { type: 'text/html' });
8927     -8757     -    683 +    const url = URL.createObjectURL(blob);
8928     -8758     -    684 +    const a = document.createElement('a');
8929     -8759     -    685 +    a.href = url;
8930     -8760     -    686 +    a.download = 'markdown-export.html';
8931     -8761     -    687 +    a.click();
8932     -8762     -    688 +    URL.revokeObjectURL(url);
8933     -8763     -663 689    }
8934     -8764     -    690 +}
8935     -8765     -664 691  
8936     -8766     -665     -  // Event Listeners
8937     -8767     -666     -  editor.addEventListener('input', renderMarkdown);
8938     -8768     -    692 +// Event Listeners
8939     -8769     -    693 +const debouncedRender = debounce(renderMarkdown, 300);
8940     -8770     -    694 +editor.addEventListener('input', debouncedRender);
8941     -8771     -667 695  
8942     -8772     -668     -  themeSelector.addEventListener('change', async e => {
8943     -8773     -669     -    await changeTheme(e.target.value);
8944     -8774     -670     -  });
8945     -8775     -    696 +themeSelector.addEventListener('change', async e => {
8946     -8776     -    697 +  await changeTheme(e.target.value);
8947     -8777     -    698 +});
8948     -8778     -671 699  
8949     -8779     -672     -  customizeBtn.addEventListener('click', () => {
8950     -8780     -673     -    modal.classList.add('active');
8951     -8781     -674     -    initColorInputs();
8952     -8782     -675     -  });
8953     -8783     -    700 +customizeBtn.addEventListener('click', () => {
8954     -8784     -    701 +  modal.classList.add('active');
8955     -8785     -    702 +  initColorInputs();
8956     -8786     -    703 +});
8957     -8787     -676 704  
8958     -8788     -677     -  closeModal.addEventListener('click', () => {
8959     -8789     -    705 +closeModal.addEventListener('click', () => {
8960     -8790     -    706 +  modal.classList.remove('active');
8961     -8791     -    707 +});
8962     -8792     -    708 +
8963     -8793     -    709 +modal.addEventListener('click', e => {
8964     -8794     -    710 +  if (e.target === modal) {
8965     -8795     -678 711      modal.classList.remove('active');
8966     -8796     -    712 +  }
8967     -8797     -    713 +});
8968     -8798     -    714 +
8969     -8799     -    715 +resetBtn.addEventListener('click', async () => {
8970     -8800     -    716 +  const currentTheme = themeSelector.value === 'custom' ? 'default-light' : themeSelector.value;
8971     -8801     -    717 +  await changeTheme(currentTheme);
8972     -8802     -    718 +  initColorInputs();
8973     -8803     -    719 +});
8974     -8804     -    720 +
8975     -8805     -    721 +saveThemeBtn.addEventListener('click', async () => {
8976     -8806     -    722 +  const customTheme = {};
8977     -8807     -    723 +  document.querySelectorAll('.color-control input[type="color"]').forEach(input => {
8978     -8808     -    724 +    const varName = input.dataset.var;
8979     -8809     -    725 +    customTheme[varName] = input.value;
8980     -8810     -679 726    });
8981     -8811     -680 727  
8982     -8812     -681     -  modal.addEventListener('click', e => {
8983     -8813     -682     -    if (e.target === modal) {
8984     -8814     -683     -      modal.classList.remove('active');
8985     -8815     -    728 +  // Save and load custom theme using ThemeManager
8986     -8816     -    729 +  themeManager.saveCustomTheme(customTheme);
8987     -8817     -    730 +  await themeManager.loadTheme('custom');
8988     -8818     -    731 +  themeSelector.value = 'custom';
8989     -8819     -    732 +
8990     -8820     -    733 +  alert('Custom theme saved and applied!');
8991     -8821     -    734 +  modal.classList.remove('active');
8992     -8822     -    735 +});
8993     -8823     -    736 +
8994     -8824     -    737 +// PDF Modal and Controls
8995     -8825     -    738 +const pdfModal = document.getElementById('pdf-modal');
8996     -8826     -    739 +const closePdfModal = document.getElementById('close-pdf-modal');
8997     -8827     -    740 +const pdfPreviewFrame = document.getElementById('pdf-preview-frame');
8998     -8828     -    741 +const pdfPageSize = document.getElementById('pdf-page-size');
8999     -8829     -    742 +const pdfOrientation = document.getElementById('pdf-orientation');
9000     -8830     -    743 +const pdfMarginTop = document.getElementById('pdf-margin-top');
9001     -8831     -    744 +const pdfMarginRight = document.getElementById('pdf-margin-right');
9002     -8832     -    745 +const pdfMarginBottom = document.getElementById('pdf-margin-bottom');
9003     -8833     -    746 +const pdfMarginLeft = document.getElementById('pdf-margin-left');
9004     -8834     -    747 +const pdfFontDecrease = document.getElementById('pdf-font-decrease');
9005     -8835     -    748 +const pdfFontIncrease = document.getElementById('pdf-font-increase');
9006     -8836     -    749 +const pdfFontSizeDisplay = document.getElementById('pdf-font-size-display');
9007     -8837     -    750 +const pdfPreviewBtn = document.getElementById('pdf-preview-btn');
9008     -8838     -    751 +const pdfDownloadBtn = document.getElementById('pdf-download-btn');
9009     -8839     -    752 +
9010     -8840     -    753 +let currentFontSize = 12;
9011     -8841     -    754 +
9012     -8842     -    755 +// Open PDF modal
9013     -8843     -    756 +function openPDFModal() {
9014     -8844     -    757 +  if (!pdfService.isReady()) {
9015     -8845     -    758 +    alert('PDF library is still loading. Please try again in a moment.');
9016     -8846     -    759 +    return;
9017     -8847     -    760 +  }
9018     -8848     -    761 +  pdfModal.classList.add('active');
9019     -8849     -    762 +  updatePDFPreview();
9020     -8850     -    763 +}
9021     -8851     -    764 +
9022     -8852     -    765 +// Close PDF modal
9023     -8853     -    766 +closePdfModal.addEventListener('click', () => {
9024     -8854     -    767 +  pdfModal.classList.remove('active');
9025     -8855     -    768 +  // Clean up iframe
9026     -8856     -    769 +  pdfPreviewFrame.src = '';
9027     -8857     -    770 +});
9028     -8858     -    771 +
9029     -8859     -    772 +pdfModal.addEventListener('click', e => {
9030     -8860     -    773 +  if (e.target === pdfModal) {
9031     -8861     -    774 +    pdfModal.classList.remove('active');
9032     -8862     -    775 +    pdfPreviewFrame.src = '';
9033     -8863     -    776 +  }
9034     -8864     -    777 +});
9035     -8865     -    778 +
9036     -8866     -    779 +// Get current PDF configuration from UI
9037     -8867     -    780 +function getPDFConfig() {
9038     -8868     -    781 +  return {
9039     -8869     -    782 +    pageSize: pdfPageSize.value,
9040     -8870     -    783 +    orientation: pdfOrientation.value,
9041     -8871     -    784 +    margins: [
9042     -8872     -    785 +      parseFloat(pdfMarginTop.value),
9043     -8873     -    786 +      parseFloat(pdfMarginRight.value),
9044     -8874     -    787 +      parseFloat(pdfMarginBottom.value),
9045     -8875     -    788 +      parseFloat(pdfMarginLeft.value),
9046     -8876     -    789 +    ],
9047     -8877     -    790 +    fontSize: currentFontSize,
9048     -8878     -    791 +  };
9049     -8879     -    792 +}
9050     -8880     -    793 +
9051     -8881     -    794 +// Update PDF preview
9052     -8882     -    795 +async function updatePDFPreview() {
9053     -8883     -    796 +  try {
9054     -8884     -    797 +    pdfPreviewBtn.textContent = '‚è≥ Generating Preview...';
9055     -8885     -    798 +    pdfPreviewBtn.disabled = true;
9056     -8886     -    799 +
9057     -8887     -    800 +    const config = getPDFConfig();
9058     -8888     -    801 +    const previewUrl = await pdfService.previewPDF(preview, config);
9059     -8889     -    802 +    pdfPreviewFrame.src = previewUrl;
9060     -8890     -    803 +
9061     -8891     -    804 +    pdfPreviewBtn.textContent = 'üëÅÔ∏è Update Preview';
9062     -8892     -    805 +    pdfPreviewBtn.disabled = false;
9063     -8893     -    806 +  } catch (error) {
9064     -8894     -    807 +    console.error('PDF preview error:', error);
9065     -8895     -    808 +    alert('Error generating preview: ' + error.message);
9066     -8896     -    809 +    pdfPreviewBtn.textContent = 'üëÅÔ∏è Update Preview';
9067     -8897     -    810 +    pdfPreviewBtn.disabled = false;
9068     -8898     -    811 +  }
9069     -8899     -    812 +}
9070     -8900     -    813 +
9071     -8901     -    814 +// Download PDF
9072     -8902     -    815 +async function downloadPDF() {
9073     -8903     -    816 +  try {
9074     -8904     -    817 +    pdfDownloadBtn.textContent = '‚è≥ Downloading...';
9075     -8905     -    818 +    pdfDownloadBtn.disabled = true;
9076     -8906     -    819 +
9077     -8907     -    820 +    const success = pdfService.downloadPDF();
9078     -8908     -    821 +    if (success) {
9079     -8909     -    822 +      setTimeout(() => {
9080     -8910     -    823 +        pdfModal.classList.remove('active');
9081     -8911     -    824 +        pdfPreviewFrame.src = '';
9082     -8912     -    825 +      }, 500);
9083     -8913     -684 826      }
9084     -8914     -685     -  });
9085     -8915     -686 827  
9086     -8916     -687     -  resetBtn.addEventListener('click', async () => {
9087     -8917     -688     -    const currentTheme = themeSelector.value === 'custom' ? 'default-light' : themeSelector.value;
9088     -8918     -689     -    await changeTheme(currentTheme);
9089     -8919     -690     -    initColorInputs();
9090     -8920     -691     -  });
9091     -8921     -    828 +    pdfDownloadBtn.textContent = 'üíæ Download PDF';
9092     -8922     -    829 +    pdfDownloadBtn.disabled = false;
9093     -8923     -    830 +  } catch (error) {
9094     -8924     -    831 +    console.error('PDF download error:', error);
9095     -8925     -    832 +    alert('Error downloading PDF: ' + error.message);
9096     -8926     -    833 +    pdfDownloadBtn.textContent = 'üíæ Download PDF';
9097     -8927     -    834 +    pdfDownloadBtn.disabled = false;
9098     -8928     -    835 +  }
9099     -8929     -    836 +}
9100     -8930     -692 837  
9101     -8931     -693     -  saveThemeBtn.addEventListener('click', async () => {
9102     -8932     -694     -    const customTheme = {};
9103     -8933     -695     -    document.querySelectorAll('.color-control input[type="color"]').forEach(input => {
9104     -8934     -696     -      const varName = input.dataset.var;
9105     -8935     -697     -      customTheme[varName] = input.value;
9106     -8936     -698     -    });
9107     -    165 +600     -  if (currentTheme === 'custom') {
9108     -    166 +601     -    const customTheme = storageManager.getJSON('customTheme');
9109     -    167 +602     -    if (customTheme) {
9110     -    168 +603     -      const theme = customTheme;
9111     -    169 +604     -      themeCSS = ':root {\n';
9112     -    170 +605     -      Object.entries(theme).forEach(([property, value]) => {
9113     -    171 +606     -        themeCSS += `    ${property}: ${value};\n`;
9114     -    172 +    511 +      // Sanitize HTML using DOMPurify
9115     -    173 +    512 +      const cleanHtml = DOMPurify.sanitize(html, {
9116     -    174 +    513 +        ADD_TAGS: ['iframe'],
9117     -    175 +    514 +        ADD_ATTR: ['allow', 'allowfullscreen', 'frameborder', 'scrolling', 'target', 'data-code'], // Add data-code
9118     -    176 +    515 +        USE_PROFILES: { html: true, svg: true, mathml: true },
9119     -    177 +607 516        });
9120     -    178 +608     -      themeCSS += '}';
9121     -    179 +    517 +
9122     -    180 +    518 +      preview.innerHTML = cleanHtml;
9123     -    181 +    519 +
9124     -    182 +    520 +      // Render Mermaid diagrams synchronously after DOM update
9125     -    183 +    521 +      const mermaidElements = preview.querySelectorAll('.mermaid');
9126     -    184 +    522 +      mermaidElements.forEach(element => {
9127     -    185 +    523 +        const id = element.id;
9128     -    186 +    524 +        const code = decodeURIComponent(element.dataset.code);
9129     -    187 +    525 +
9130     -    188 +    526 +        if (typeof mermaid !== 'undefined') {
9131     -    189 +    527 +          mermaid
9132     -    190 +    528 +            .render('mermaid-svg-' + id, code)
9133     -    191 +    529 +            .then(result => {
9134     -    192 +    530 +              element.innerHTML = result.svg;
9135     -    193 +    531 +            })
9136     -    194 +    532 +            .catch(err => {
9137     -    195 +    533 +              element.innerHTML = `<p style="color: red;">Mermaid diagram error: ${err.message}</p>`;
9138     -    196 +    534 +            });
9139     -    197 +    535 +        }
9140     -    198 +    536 +      });
9141     -    199 +    537 +
9142     -    200 +    538 +      // Apply Prism syntax highlighting using PrismService
9143     -    201 +    539 +      prismService.highlightAll(preview);
9144     -    202 +    540 +
9145     -    203 +    541 +      // NOTE: KaTeX auto-render is DISABLED
9146     -    204 +    542 +      // We handle all math via marked.js extensions ($...$ and $$...$$)
9147     -    205 +    543 +      // KaTeX auto-render was causing issues with unsupported LaTeX environments
9148     -    206 +    544 +
9149     -    207 +    545 +      // Save content using StorageManager
9150     -    208 +    546 +      storageManager.set('markdownContent', markdownText);
9151     -    209 +    547 +    } catch (error) {
9152     -    210 +    548 +      console.error('Render error:', error);
9153     -    211 +    549 +      preview.innerHTML =
9154     -    212 +    550 +        '<p style="color: red;">Error rendering markdown: ' + error.message + '</p>';
9155     -    213 +609 551      }
9156     -    214 +610     -  } else {
9157     -    215 +611     -    // Fetch theme CSS
9158     -    216 +612     -    fetch(`themes/${currentTheme}.css`)
9159     -    217 +613     -      .then(response => response.text())
9160     -    218 +614     -      .then(css => {
9161     -    219 +615     -        themeCSS = css;
9162     -    220 +616     -        generateHTML();
9163     -    221 +617     -      })
9164     -    222 +618     -      .catch(err => {
9165     -    223 +619     -        console.error('Error loading theme:', err);
9166     -    224 +620     -        generateHTML();
9167     -    225 +621     -      });
9168     -    226 +622     -    return;
9169     -    227 +623 552    }
9170     -    228 +624 553  
9171     -    229 +625     -  generateHTML();
9172     -    230 +    554 +  // Change theme using ThemeManager
9173     -    231 +    555 +  async function changeTheme(themeName) {
9174     -    232 +    556 +    await themeManager.loadTheme(themeName);
9175     -    233 +    557 +    // ThemeManager listener (above) will handle the re-render automatically
9176     -    234 +    558 +  }
9177     -    235 +626 559  
9178     -    236 +627     -  function generateHTML() {
9179     -    237 +628     -    const html = `<!DOCTYPE html>
9180     -    238 +    560 +  // Initialize color inputs
9181     -    239 +    561 +  function initColorInputs() {
9182     -    240 +    562 +    document.querySelectorAll('.color-control input[type="color"]').forEach(input => {
9183     -    241 +    563 +      const varName = input.dataset.var;
9184     -    242 +    564 +      const textInput = document.getElementById(input.id + '-text');
9185     -    243 +    565 +      const currentValue = getComputedStyle(document.documentElement)
9186     -    244 +    566 +        .getPropertyValue(varName)
9187     -    245 +    567 +        .trim();
9188     -    246 +    568 +
9189     -    247 +    569 +      input.value = currentValue;
9190     -    248 +    570 +      textInput.value = currentValue;
9191     -    249 +    571 +
9192     -    250 +    572 +      input.addEventListener('input', e => {
9193     -    251 +    573 +        const color = e.target.value;
9194     -    252 +    574 +        document.documentElement.style.setProperty(varName, color);
9195     -    253 +    575 +        textInput.value = color;
9196     -    254 +    576 +      });
9197     -    255 +    577 +    });
9198     -    256 +    578 +  }
9199     -    257 +    579 +
9200     -    258 +    580 +  // Export to HTML
9201     -    259 +    581 +  function exportHTML() {
9202     -    260 +    582 +    const currentTheme = themeSelector.value;
9203     -    261 +    583 +    let themeCSS = '';
9204     -    262 +    584 +
9205     -    263 +    585 +    if (currentTheme === 'custom') {
9206     -    264 +    586 +      const customTheme = storageManager.getJSON('customTheme');
9207     -    265 +    587 +      if (customTheme) {
9208     -    266 +    588 +        const theme = customTheme;
9209     -    267 +    589 +        themeCSS = ':root {\n';
9210     -    268 +    590 +        Object.entries(theme).forEach(([property, value]) => {
9211     -    269 +    591 +          themeCSS += `    ${property}: ${value};\n`;
9212     -    270 +    592 +        });
9213     -    271 +    593 +        themeCSS += '}';
9214     -    272 +    594 +      }
9215     -    273 +    595 +    } else {
9216     -    274 +    596 +      // Fetch theme CSS
9217     -    275 +    597 +      fetch(`themes/${currentTheme}.css`)
9218     -    276 +    598 +        .then(response => response.text())
9219     -    277 +    599 +        .then(css => {
9220     -    278 +    600 +          themeCSS = css;
9221     -    279 +    601 +          generateHTML();
9222     -    280 +    602 +        })
9223     -    281 +    603 +        .catch(err => {
9224     -    282 +    604 +          console.error('Error loading theme:', err);
9225     -    283 +    605 +          generateHTML();
9226     -    284 +    606 +        });
9227     -    285 +    607 +      return;
9228     -    286 +    608 +    }
9229     -    287 +    609 +
9230     -    288 +    610 +    generateHTML();
9231     -    289 +    611 +
9232     -    290 +    612 +    function generateHTML() {
9233     -    291 +    613 +      const html = `<!DOCTYPE html>
9234     -    292 +629 614  <html>
9235     -    293 +630 615  <head>
9236     -    294 +631 616      <meta charset="UTF-8">
9237     -    295 +@@ -679,720 +664,720 @@ function exportHTML() {
9238     -    296 +679 664  </body>
9239     -    297 +680 665  </html>`;
9240     -    298 +681 666  
9241     -    299 +682     -    const blob = new Blob([html], { type: 'text/html' });
9242     -    300 +683     -    const url = URL.createObjectURL(blob);
9243     -    301 +684     -    const a = document.createElement('a');
9244     -    302 +685     -    a.href = url;
9245     -    303 +686     -    a.download = 'markdown-export.html';
9246     -    304 +687     -    a.click();
9247     -    305 +688     -    URL.revokeObjectURL(url);
9248     -    306 +    667 +      const blob = new Blob([html], { type: 'text/html' });
9249     -    307 +    668 +      const url = URL.createObjectURL(blob);
9250     -    308 +    669 +      const a = document.createElement('a');
9251     -    309 +    670 +      a.href = url;
9252     -    310 +    671 +      a.download = 'markdown-export.html';
9253     -    311 +    672 +      a.click();
9254     -    312 +    673 +      URL.revokeObjectURL(url);
9255     -    313 +    674 +    }
9256     -    314 +689 675    }
9257     -    315 +690     -}
9258     -    316 +691 676  
9259     -    317 +692     -// Event Listeners
9260     -    318 +693     -const debouncedRender = debounce(renderMarkdown, 300);
9261     -    319 +694     -editor.addEventListener('input', debouncedRender);
9262     -    320 +    677 +  // Event Listeners
9263     -    321 +    678 +  const debouncedRender = debounce(renderMarkdown, 300);
9264     -    322 +    679 +  editor.addEventListener('input', debouncedRender);
9265     -    323 +695 680  
9266     -    324 +696     -themeSelector.addEventListener('change', async e => {
9267     -    325 +697     -  await changeTheme(e.target.value);
9268     -    326 +698     -});
9269     -8937 327  699     -
9270     -8938     -700     -    // Save and load custom theme using ThemeManager
9271     -8939     -701     -    themeManager.saveCustomTheme(customTheme);
9272     -8940     -702     -    await themeManager.loadTheme('custom');
9273     -8941     -703     -    themeSelector.value = 'custom';
9274     -    328 +700     -customizeBtn.addEventListener('click', () => {
9275     -    329 +701     -  modal.classList.add('active');
9276     -    330 +702     -  initColorInputs();
9277     -    331 +703     -});
9278     -8942 332  704     -
9279     -8943     -705     -    alert('Custom theme saved and applied!');
9280     -8944     -706     -    modal.classList.remove('active');
9281     -8945     -707     -  });
9282     -    333 +705     -closeModal.addEventListener('click', () => {
9283     -    334 +706     -  modal.classList.remove('active');
9284     -    335 +707     -});
9285     -8946 336  708     -
9286     -8947     -709     -  // PDF Modal and Controls
9287     -8948     -710     -  const pdfModal = document.getElementById('pdf-modal');
9288     -8949     -711     -  const closePdfModal = document.getElementById('close-pdf-modal');
9289     -8950     -712     -  const pdfPreviewFrame = document.getElementById('pdf-preview-frame');
9290     -8951     -713     -  const pdfPageSize = document.getElementById('pdf-page-size');
9291     -8952     -714     -  const pdfOrientation = document.getElementById('pdf-orientation');
9292     -8953     -715     -  const pdfMarginTop = document.getElementById('pdf-margin-top');
9293     -8954     -716     -  const pdfMarginRight = document.getElementById('pdf-margin-right');
9294     -8955     -717     -  const pdfMarginBottom = document.getElementById('pdf-margin-bottom');
9295     -8956     -718     -  const pdfMarginLeft = document.getElementById('pdf-margin-left');
9296     -8957     -719     -  const pdfFontDecrease = document.getElementById('pdf-font-decrease');
9297     -8958     -720     -  const pdfFontIncrease = document.getElementById('pdf-font-increase');
9298     -8959     -721     -  const pdfFontSizeDisplay = document.getElementById('pdf-font-size-display');
9299     -8960     -722     -  const pdfPreviewBtn = document.getElementById('pdf-preview-btn');
9300     -8961     -723     -  const pdfDownloadBtn = document.getElementById('pdf-download-btn');
9301     -8962     -724     -
9302     -8963     -725     -  let currentFontSize = 12;
9303     -8964     -726     -
9304     -8965     -727     -  // Open PDF modal
9305     -8966     -728     -  function openPDFModal() {
9306     -8967     -729     -    if (!pdfService.isReady()) {
9307     -8968     -730     -      alert('PDF library is still loading. Please try again in a moment.');
9308     -8969     -731     -      return;
9309     -8970     -732     -    }
9310     -8971     -733     -    pdfModal.classList.add('active');
9311     -8972     -    838 +// Font size controls with auto-update
9312     -8973     -    839 +pdfFontDecrease.addEventListener('click', () => {
9313     -8974     -    840 +  if (currentFontSize > 8) {
9314     -8975     -    841 +    currentFontSize -= 1;
9315     -8976     -    842 +    pdfFontSizeDisplay.textContent = `${currentFontSize}pt`;
9316     -8977     -734 843      updatePDFPreview();
9317     -8978     -735 844    }
9318     -8979     -    845 +});
9319     -8980     -736 846  
9320     -8981     -737     -  // Close PDF modal
9321     -8982     -738     -  closePdfModal.addEventListener('click', () => {
9322     -8983     -739     -    pdfModal.classList.remove('active');
9323     -8984     -740     -    // Clean up iframe
9324     -8985     -741     -    pdfPreviewFrame.src = '';
9325     -8986     -742     -  });
9326     -8987     -    847 +pdfFontIncrease.addEventListener('click', () => {
9327     -8988     -    848 +  if (currentFontSize < 24) {
9328     -8989     -    849 +    currentFontSize += 1;
9329     -8990     -    850 +    pdfFontSizeDisplay.textContent = `${currentFontSize}pt`;
9330     -8991     -    851 +    updatePDFPreview();
9331     -8992     -    852 +  }
9332     -8993     -    853 +});
9333     -8994     -743 854  
9334     -8995     -744     -  pdfModal.addEventListener('click', e => {
9335     -8996     -745     -    if (e.target === pdfModal) {
9336     -8997     -746     -      pdfModal.classList.remove('active');
9337     -8998     -747     -      pdfPreviewFrame.src = '';
9338     -8999     -748     -    }
9339     -9000     -749     -  });
9340     -9001     -    855 +// Auto-update preview when settings change
9341     -9002     -    856 +pdfPageSize.addEventListener('change', updatePDFPreview);
9342     -9003     -    857 +pdfOrientation.addEventListener('change', updatePDFPreview);
9343     -9004     -    858 +pdfMarginTop.addEventListener('input', updatePDFPreview);
9344     -9005     -    859 +pdfMarginRight.addEventListener('input', updatePDFPreview);
9345     -9006     -    860 +pdfMarginBottom.addEventListener('input', updatePDFPreview);
9346     -9007     -    861 +pdfMarginLeft.addEventListener('input', updatePDFPreview);
9347     -9008     -750 862  
9348     -9009     -751     -  // Get current PDF configuration from UI
9349     -9010     -752     -  function getPDFConfig() {
9350     -9011     -753     -    return {
9351     -9012     -754     -      pageSize: pdfPageSize.value,
9352     -9013     -755     -      orientation: pdfOrientation.value,
9353     -9014     -756     -      margins: [
9354     -9015     -757     -        parseFloat(pdfMarginTop.value),
9355     -9016     -758     -        parseFloat(pdfMarginRight.value),
9356     -9017     -759     -        parseFloat(pdfMarginBottom.value),
9357     -9018     -760     -        parseFloat(pdfMarginLeft.value),
9358     -9019     -761     -      ],
9359     -9020     -762     -      fontSize: currentFontSize,
9360     -9021     -763     -    };
9361     -9022     -    863 +// PDF Event Listeners
9362     -9023     -    864 +pdfPreviewBtn.addEventListener('click', updatePDFPreview);
9363     -9024     -    865 +pdfDownloadBtn.addEventListener('click', downloadPDF);
9364     -9025     -    866 +
9365     -9026     -    867 +// Event listeners for export buttons
9366     -9027     -    868 +exportHtmlBtn.addEventListener('click', exportHTML);
9367     -9028     -    869 +exportPdfBtn.addEventListener('click', () => {
9368     -9029     -    870 +  console.log('Export PDF button clicked');
9369     -9030     -    871 +  openPDFModal();
9370     -9031     -    872 +});
9371     -9032     -    873 +
9372     -9033     -    874 +// Debug: Verify elements are found
9373     -9034     -    875 +console.log('Export PDF Button:', exportPdfBtn);
9374     -9035     -    876 +console.log('PDF Modal:', pdfModal);
9375     -9036     -    877 +console.log('PDF Service Ready:', pdfService.isReady());
9376     -9037     -    878 +
9377     -9038     -    879 +// View mode switching
9378     -9039     -    880 +function setViewMode(mode) {
9379     -9040     -    881 +  // Remove active class from all buttons
9380     -9041     -    882 +  editorOnlyBtn.classList.remove('active');
9381     -9042     -    883 +  splitViewBtn.classList.remove('active');
9382     -9043     -    884 +  previewOnlyBtn.classList.remove('active');
9383     -9044     -    885 +
9384     -9045     -    886 +  // Apply view mode
9385     -9046     -    887 +  switch (mode) {
9386     -9047     -    888 +    case 'editor-only':
9387     -9048     -    889 +      editorOnlyBtn.classList.add('active');
9388     -9049     -    890 +      editorContainer.style.display = 'flex';
9389     -9050     -    891 +      previewContainer.style.display = 'none';
9390     -9051     -    892 +      break;
9391     -9052     -    893 +    case 'split-view':
9392     -9053     -    894 +      splitViewBtn.classList.add('active');
9393     -9054     -    895 +      editorContainer.style.display = 'flex';
9394     -9055     -    896 +      previewContainer.style.display = 'flex';
9395     -9056     -    897 +      break;
9396     -9057     -    898 +    case 'preview-only':
9397     -9058     -    899 +      previewOnlyBtn.classList.add('active');
9398     -9059     -    900 +      editorContainer.style.display = 'none';
9399     -9060     -    901 +      previewContainer.style.display = 'flex';
9400     -9061     -    902 +      break;
9401     -9062     -764 903    }
9402     -9063     -765 904  
9403     -9064     -766     -  // Update PDF preview
9404     -9065     -767     -  async function updatePDFPreview() {
9405     -9066     -768     -    try {
9406     -9067     -769     -      pdfPreviewBtn.textContent = '‚è≥ Generating Preview...';
9407     -9068     -770     -      pdfPreviewBtn.disabled = true;
9408     -9069     -    905 +  // Save view mode preference
9409     -9070     -    906 +  storageManager.set('viewMode', mode);
9410     -9071     -    907 +}
9411     -9072     -771 908  
9412     -9073     -772     -      const config = getPDFConfig();
9413     -9074     -773     -      const previewUrl = await pdfService.previewPDF(preview, config);
9414     -9075     -774     -      pdfPreviewFrame.src = previewUrl;
9415     -9076     -    909 +// ==================== SYNC SCROLL FUNCTIONALITY ====================
9416     -9077     -775 910  
9417     -9078     -776     -      pdfPreviewBtn.textContent = 'üëÅÔ∏è Update Preview';
9418     -9079     -777     -      pdfPreviewBtn.disabled = false;
9419     -9080     -778     -    } catch (error) {
9420     -9081     -779     -      console.error('PDF preview error:', error);
9421     -9082     -780     -      alert('Error generating preview: ' + error.message);
9422     -9083     -781     -      pdfPreviewBtn.textContent = 'üëÅÔ∏è Update Preview';
9423     -9084     -782     -      pdfPreviewBtn.disabled = false;
9424     -9085     -783     -    }
9425     -9086     -    911 +// Sync scroll state (using var to avoid formatter issues)
9426     -9087     -    912 +var syncScrollEnabled = storageManager.get('syncScrollEnabled') === 'true';
9427     -9088     -    913 +var syncScrolling = false;
9428     -9089     -    914 +
9429     -9090     -    915 +// Load saved state and update button
9430     -9091     -    916 +if (syncScrollEnabled) {
9431     -9092     -    917 +  syncScrollBtn.classList.add('active');
9432     -9093     -    918 +}
9433     -9094     -    919 +
9434     -9095     -    920 +// Show sync scroll button only in split view
9435     -9096     -    921 +function updateSyncScrollVisibility() {
9436     -9097     -    922 +  const currentView = storageManager.get('viewMode') || 'split-view';
9437     -9098     -    923 +  if (currentView === 'split-view') {
9438     -9099     -    924 +    syncScrollBtn.style.display = 'inline-block';
9439     -9100     -    925 +  } else {
9440     -9101     -    926 +    syncScrollBtn.style.display = 'none';
9441     -9102     -784 927    }
9442     -9103     -    928 +}
9443     -9104     -785 929  
9444     -9105     -786     -  // Download PDF
9445     -9106     -787     -  async function downloadPDF() {
9446     -9107     -788     -    try {
9447     -9108     -789     -      pdfDownloadBtn.textContent = '‚è≥ Downloading...';
9448     -9109     -790     -      pdfDownloadBtn.disabled = true;
9449     -9110     -    930 +// Sync scroll toggle
9450     -9111     -    931 +syncScrollBtn.addEventListener('click', () => {
9451     -9112     -    932 +  syncScrollEnabled = !syncScrollEnabled;
9452     -9113     -    933 +  storageManager.set('syncScrollEnabled', syncScrollEnabled.toString());
9453     -9114     -791 934  
9454     -9115     -792     -      const success = pdfService.downloadPDF();
9455     -9116     -793     -      if (success) {
9456     -9117     -794     -        setTimeout(() => {
9457     -9118     -795     -          pdfModal.classList.remove('active');
9458     -9119     -796     -          pdfPreviewFrame.src = '';
9459     -9120     -797     -        }, 500);
9460     -9121     -798     -      }
9461     -9122     -799     -
9462     -9123     -800     -      pdfDownloadBtn.textContent = 'üíæ Download PDF';
9463     -9124     -801     -      pdfDownloadBtn.disabled = false;
9464     -9125     -802     -    } catch (error) {
9465     -9126     -803     -      console.error('PDF download error:', error);
9466     -9127     -804     -      alert('Error downloading PDF: ' + error.message);
9467     -9128     -805     -      pdfDownloadBtn.textContent = 'üíæ Download PDF';
9468     -9129     -806     -      pdfDownloadBtn.disabled = false;
9469     -9130     -807     -    }
9470     -9131     -808     -  }
9471     -9132     -809     -
9472     -9133     -810     -  // Font size controls with auto-update
9473     -9134     -811     -  pdfFontDecrease.addEventListener('click', () => {
9474     -9135     -812     -    if (currentFontSize > 8) {
9475     -9136     -813     -      currentFontSize -= 1;
9476     -9137     -814     -      pdfFontSizeDisplay.textContent = `${currentFontSize}pt`;
9477     -9138     -815     -      updatePDFPreview();
9478     -9139     -816     -    }
9479     -9140     -817     -  });
9480     -9141     -818     -
9481     -9142     -819     -  pdfFontIncrease.addEventListener('click', () => {
9482     -9143     -820     -    if (currentFontSize < 24) {
9483     -9144     -821     -      currentFontSize += 1;
9484     -9145     -822     -      pdfFontSizeDisplay.textContent = `${currentFontSize}pt`;
9485     -9146     -823     -      updatePDFPreview();
9486     -9147     -824     -    }
9487     -9148     -825     -  });
9488     -9149     -826     -
9489     -9150     -827     -  // Auto-update preview when settings change
9490     -9151     -828     -  pdfPageSize.addEventListener('change', updatePDFPreview);
9491     -9152     -829     -  pdfOrientation.addEventListener('change', updatePDFPreview);
9492     -9153     -830     -  pdfMarginTop.addEventListener('input', updatePDFPreview);
9493     -9154     -831     -  pdfMarginRight.addEventListener('input', updatePDFPreview);
9494     -9155     -832     -  pdfMarginBottom.addEventListener('input', updatePDFPreview);
9495     -9156     -833     -  pdfMarginLeft.addEventListener('input', updatePDFPreview);
9496     -9157     -834     -
9497     -9158     -835     -  // PDF Event Listeners
9498     -9159     -836     -  pdfPreviewBtn.addEventListener('click', updatePDFPreview);
9499     -9160     -837     -  pdfDownloadBtn.addEventListener('click', downloadPDF);
9500     -9161     -838     -
9501     -9162     -839     -  // Event listeners for export buttons
9502     -9163     -840     -  exportHtmlBtn.addEventListener('click', exportHTML);
9503     -9164     -841     -  exportPdfBtn.addEventListener('click', () => {
9504     -9165     -842     -    console.log('Export PDF button clicked');
9505     -9166     -843     -    openPDFModal();
9506     -9167     -844     -  });
9507     -9168     -845     -
9508     -9169     -846     -  // Debug: Verify elements are found
9509     -9170     -847     -  console.log('Export PDF Button:', exportPdfBtn);
9510     -9171     -848     -  console.log('PDF Modal:', pdfModal);
9511     -9172     -849     -  console.log('PDF Service Ready:', pdfService.isReady());
9512     -9173     -850     -
9513     -9174     -851     -  // View mode switching
9514     -9175     -852     -  function setViewMode(mode) {
9515     -9176     -853     -    // Remove active class from all buttons
9516     -9177     -854     -    editorOnlyBtn.classList.remove('active');
9517     -9178     -855     -    splitViewBtn.classList.remove('active');
9518     -9179     -856     -    previewOnlyBtn.classList.remove('active');
9519     -9180     -857     -
9520     -9181     -858     -    // Apply view mode
9521     -9182     -859     -    switch (mode) {
9522     -9183     -860     -      case 'editor-only':
9523     -9184     -861     -        editorOnlyBtn.classList.add('active');
9524     -9185     -862     -        editorContainer.style.display = 'flex';
9525     -9186     -863     -        previewContainer.style.display = 'none';
9526     -9187     -864     -        break;
9527     -9188     -865     -      case 'split-view':
9528     -9189     -866     -        splitViewBtn.classList.add('active');
9529     -9190     -867     -        editorContainer.style.display = 'flex';
9530     -9191     -868     -        previewContainer.style.display = 'flex';
9531     -9192     -869     -        break;
9532     -9193     -870     -      case 'preview-only':
9533     -9194     -871     -        previewOnlyBtn.classList.add('active');
9534     -9195     -872     -        editorContainer.style.display = 'none';
9535     -9196     -873     -        previewContainer.style.display = 'flex';
9536     -9197     -874     -        break;
9537     -9198     -875     -    }
9538     -9199     -876     -
9539     -9200     -877     -    // Save view mode preference
9540     -9201     -878     -    storageManager.set('viewMode', mode);
9541     -9202     -879     -  }
9542     -9203     -880     -
9543     -9204     -881     -  // ==================== SYNC SCROLL FUNCTIONALITY ====================
9544     -9205     -882     -
9545     -9206     -883     -  // Sync scroll state (using var to avoid formatter issues)
9546     -9207     -884     -  var syncScrollEnabled = storageManager.get('syncScrollEnabled') === 'true';
9547     -9208     -885     -  var syncScrolling = false;
9548     -9209     -886     -
9549     -9210     -887     -  // Load saved state and update button
9550     -9211     -888 935    if (syncScrollEnabled) {
9551     -9212     -889 936      syncScrollBtn.classList.add('active');
9552     -9213     -890     -  }
9553     -9214     -891     -
9554     -9215     -892     -  // Show sync scroll button only in split view
9555     -9216     -893     -  function updateSyncScrollVisibility() {
9556     -9217     -894     -    const currentView = storageManager.get('viewMode') || 'split-view';
9557     -9218     -895     -    if (currentView === 'split-view') {
9558     -9219     -896     -      syncScrollBtn.style.display = 'inline-block';
9559     -9220     -897     -    } else {
9560     -9221     -898     -      syncScrollBtn.style.display = 'none';
9561     -9222     -899     -    }
9562     -9223     -900     -  }
9563     -9224     -901     -
9564     -9225     -902     -  // Sync scroll toggle
9565     -9226     -903     -  syncScrollBtn.addEventListener('click', () => {
9566     -9227     -904     -    syncScrollEnabled = !syncScrollEnabled;
9567     -9228     -905     -    storageManager.set('syncScrollEnabled', syncScrollEnabled.toString());
9568     -9229     -906     -
9569     -9230     -907     -    if (syncScrollEnabled) {
9570     -9231     -908     -      syncScrollBtn.classList.add('active');
9571     -9232     -909     -      console.log('‚úÖ Sync scroll enabled');
9572     -9233     -910     -    } else {
9573     -9234     -911     -      syncScrollBtn.classList.remove('active');
9574     -9235     -912     -      console.log('‚ùå Sync scroll disabled');
9575     -9236     -913     -    }
9576     -9237     -914     -  });
9577     -9238     -915     -
9578     -9239     -916     -  // Editor scroll handler with smooth sync
9579     -9240     -917     -  editor.addEventListener('scroll', () => {
9580     -9241     -918     -    if (!syncScrollEnabled || syncScrolling) return;
9581     -    337 +709     -modal.addEventListener('click', e => {
9582     -    338 +710     -  if (e.target === modal) {
9583     -    339 +711     -    modal.classList.remove('active');
9584     -    340 +712     -  }
9585     -    341 +713     -});
9586     -    342 +714     -
9587     -    343 +715     -resetBtn.addEventListener('click', async () => {
9588     -    344 +716     -  const currentTheme = themeSelector.value === 'custom' ? 'default-light' : themeSelector.value;
9589     -    345 +717     -  await changeTheme(currentTheme);
9590     -    346 +718     -  initColorInputs();
9591     -    347 +719     -});
9592     -    348 +720     -
9593     -    349 +721     -saveThemeBtn.addEventListener('click', async () => {
9594     -    350 +722     -  const customTheme = {};
9595     -    351 +723     -  document.querySelectorAll('.color-control input[type="color"]').forEach(input => {
9596     -    352 +724     -    const varName = input.dataset.var;
9597     -    353 +725     -    customTheme[varName] = input.value;
9598     -    354 +    681 +  themeSelector.addEventListener('change', async e => {
9599     -    355 +    682 +    await changeTheme(e.target.value);
9600     -    356 +726 683    });
9601     -    357 +727 684  
9602     -    358 +728     -  // Save and load custom theme using ThemeManager
9603     -    359 +729     -  themeManager.saveCustomTheme(customTheme);
9604     -    360 +730     -  await themeManager.loadTheme('custom');
9605     -    361 +731     -  themeSelector.value = 'custom';
9606     -    362 +    685 +  customizeBtn.addEventListener('click', () => {
9607     -    363 +    686 +    modal.classList.add('active');
9608     -    364 +    687 +    initColorInputs();
9609     -    365 +    688 +  });
9610     -    366 +732 689  
9611     -    367 +733     -  alert('Custom theme saved and applied!');
9612     -    368 +734     -  modal.classList.remove('active');
9613     -    369 +735     -});
9614     -    370 +    690 +  closeModal.addEventListener('click', () => {
9615     -    371 +    691 +    modal.classList.remove('active');
9616     -    372 +    692 +  });
9617     -    373 +736 693  
9618     -    374 +737     -// PDF Modal and Controls
9619     -    375 +738     -const pdfModal = document.getElementById('pdf-modal');
9620     -    376 +739     -const closePdfModal = document.getElementById('close-pdf-modal');
9621     -    377 +740     -const pdfPreviewFrame = document.getElementById('pdf-preview-frame');
9622     -    378 +741     -const pdfPageSize = document.getElementById('pdf-page-size');
9623     -    379 +742     -const pdfOrientation = document.getElementById('pdf-orientation');
9624     -    380 +743     -const pdfMarginTop = document.getElementById('pdf-margin-top');
9625     -    381 +744     -const pdfMarginRight = document.getElementById('pdf-margin-right');
9626     -    382 +745     -const pdfMarginBottom = document.getElementById('pdf-margin-bottom');
9627     -    383 +746     -const pdfMarginLeft = document.getElementById('pdf-margin-left');
9628     -    384 +747     -const pdfFontDecrease = document.getElementById('pdf-font-decrease');
9629     -    385 +748     -const pdfFontIncrease = document.getElementById('pdf-font-increase');
9630     -    386 +749     -const pdfFontSizeDisplay = document.getElementById('pdf-font-size-display');
9631     -    387 +750     -const pdfPreviewBtn = document.getElementById('pdf-preview-btn');
9632     -    388 +751     -const pdfDownloadBtn = document.getElementById('pdf-download-btn');
9633     -    389 +    694 +  modal.addEventListener('click', e => {
9634     -    390 +    695 +    if (e.target === modal) {
9635     -    391 +    696 +      modal.classList.remove('active');
9636     -    392 +    697 +    }
9637     -    393 +    698 +  });
9638     -    394 +752 699  
9639     -    395 +753     -let currentFontSize = 12;
9640     -    396 +    700 +  resetBtn.addEventListener('click', async () => {
9641     -    397 +    701 +    const currentTheme = themeSelector.value === 'custom' ? 'default-light' : themeSelector.value;
9642     -    398 +    702 +    await changeTheme(currentTheme);
9643     -    399 +    703 +    initColorInputs();
9644     -    400 +    704 +  });
9645     -    401 +754 705  
9646     -    402 +755     -// Open PDF modal
9647     -    403 +756     -function openPDFModal() {
9648     -    404 +757     -  if (!pdfService.isReady()) {
9649     -    405 +758     -    alert('PDF library is still loading. Please try again in a moment.');
9650     -    406 +759     -    return;
9651     -    407 +    706 +  saveThemeBtn.addEventListener('click', async () => {
9652     -    408 +    707 +    const customTheme = {};
9653     -    409 +    708 +    document.querySelectorAll('.color-control input[type="color"]').forEach(input => {
9654     -    410 +    709 +      const varName = input.dataset.var;
9655     -    411 +    710 +      customTheme[varName] = input.value;
9656     -    412 +    711 +    });
9657     -    413 +    712 +
9658     -    414 +    713 +    // Save and load custom theme using ThemeManager
9659     -    415 +    714 +    themeManager.saveCustomTheme(customTheme);
9660     -    416 +    715 +    await themeManager.loadTheme('custom');
9661     -    417 +    716 +    themeSelector.value = 'custom';
9662     -    418 +    717 +
9663     -    419 +    718 +    alert('Custom theme saved and applied!');
9664     -    420 +    719 +    modal.classList.remove('active');
9665     -    421 +    720 +  });
9666     -    422 +    721 +
9667     -    423 +    722 +  // PDF Modal and Controls
9668     -    424 +    723 +  const pdfModal = document.getElementById('pdf-modal');
9669     -    425 +    724 +  const closePdfModal = document.getElementById('close-pdf-modal');
9670     -    426 +    725 +  const pdfPreviewFrame = document.getElementById('pdf-preview-frame');
9671     -    427 +    726 +  const pdfPageSize = document.getElementById('pdf-page-size');
9672     -    428 +    727 +  const pdfOrientation = document.getElementById('pdf-orientation');
9673     -    429 +    728 +  const pdfMarginTop = document.getElementById('pdf-margin-top');
9674     -    430 +    729 +  const pdfMarginRight = document.getElementById('pdf-margin-right');
9675     -    431 +    730 +  const pdfMarginBottom = document.getElementById('pdf-margin-bottom');
9676     -    432 +    731 +  const pdfMarginLeft = document.getElementById('pdf-margin-left');
9677     -    433 +    732 +  const pdfFontDecrease = document.getElementById('pdf-font-decrease');
9678     -    434 +    733 +  const pdfFontIncrease = document.getElementById('pdf-font-increase');
9679     -    435 +    734 +  const pdfFontSizeDisplay = document.getElementById('pdf-font-size-display');
9680     -    436 +    735 +  const pdfPreviewBtn = document.getElementById('pdf-preview-btn');
9681     -    437 +    736 +  const pdfDownloadBtn = document.getElementById('pdf-download-btn');
9682     -    438 +    737 +
9683     -    439 +    738 +  let currentFontSize = 12;
9684     -    440 +    739 +
9685     -    441 +    740 +  // Open PDF modal
9686     -    442 +    741 +  function openPDFModal() {
9687     -    443 +    742 +    if (!pdfService.isReady()) {
9688     -    444 +    743 +      alert('PDF library is still loading. Please try again in a moment.');
9689     -    445 +    744 +      return;
9690     -    446 +    745 +    }
9691     -    447 +    746 +    pdfModal.classList.add('active');
9692     -    448 +    747 +    updatePDFPreview();
9693     -    449 +760 748    }
9694     -    450 +761     -  pdfModal.classList.add('active');
9695     -    451 +762     -  updatePDFPreview();
9696     -    452 +763     -}
9697     -    453 +764 749  
9698     -    454 +765     -// Close PDF modal
9699     -    455 +766     -closePdfModal.addEventListener('click', () => {
9700     -    456 +767     -  pdfModal.classList.remove('active');
9701     -    457 +768     -  // Clean up iframe
9702     -    458 +769     -  pdfPreviewFrame.src = '';
9703     -    459 +770     -});
9704     -    460 +771     -
9705     -    461 +772     -pdfModal.addEventListener('click', e => {
9706     -    462 +773     -  if (e.target === pdfModal) {
9707     -    463 +    750 +  // Close PDF modal
9708     -    464 +    751 +  closePdfModal.addEventListener('click', () => {
9709     -    465 +774 752      pdfModal.classList.remove('active');
9710     -    466 +    753 +    // Clean up iframe
9711     -    467 +775 754      pdfPreviewFrame.src = '';
9712     -    468 +    755 +  });
9713     -    469 +    756 +
9714     -    470 +    757 +  pdfModal.addEventListener('click', e => {
9715     -    471 +    758 +    if (e.target === pdfModal) {
9716     -    472 +    759 +      pdfModal.classList.remove('active');
9717     -    473 +    760 +      pdfPreviewFrame.src = '';
9718     -    474 +    761 +    }
9719     -    475 +    762 +  });
9720     -    476 +    763 +
9721     -    477 +    764 +  // Get current PDF configuration from UI
9722     -    478 +    765 +  function getPDFConfig() {
9723     -    479 +    766 +    return {
9724     -    480 +    767 +      pageSize: pdfPageSize.value,
9725     -    481 +    768 +      orientation: pdfOrientation.value,
9726     -    482 +    769 +      margins: [
9727     -    483 +    770 +        parseFloat(pdfMarginTop.value),
9728     -    484 +    771 +        parseFloat(pdfMarginRight.value),
9729     -    485 +    772 +        parseFloat(pdfMarginBottom.value),
9730     -    486 +    773 +        parseFloat(pdfMarginLeft.value),
9731     -    487 +    774 +      ],
9732     -    488 +    775 +      fontSize: currentFontSize,
9733     -    489 +    776 +    };
9734     -    490 +776 777    }
9735     -    491 +777     -});
9736     -    492 +778 778  
9737     -    493 +779     -// Get current PDF configuration from UI
9738     -    494 +780     -function getPDFConfig() {
9739     -    495 +781     -  return {
9740     -    496 +782     -    pageSize: pdfPageSize.value,
9741     -    497 +783     -    orientation: pdfOrientation.value,
9742     -    498 +784     -    margins: [
9743     -    499 +785     -      parseFloat(pdfMarginTop.value),
9744     -    500 +786     -      parseFloat(pdfMarginRight.value),
9745     -    501 +787     -      parseFloat(pdfMarginBottom.value),
9746     -    502 +788     -      parseFloat(pdfMarginLeft.value),
9747     -    503 +789     -    ],
9748     -    504 +790     -    fontSize: currentFontSize,
9749     -    505 +791     -  };
9750     -    506 +792     -}
9751     -    507 +    779 +  // Update PDF preview
9752     -    508 +    780 +  async function updatePDFPreview() {
9753     -    509 +    781 +    try {
9754     -    510 +    782 +      pdfPreviewBtn.textContent = '‚è≥ Generating Preview...';
9755     -    511 +    783 +      pdfPreviewBtn.disabled = true;
9756     -    512 +793 784  
9757     -    513 +794     -// Update PDF preview
9758     -    514 +795     -async function updatePDFPreview() {
9759     -    515 +796     -  try {
9760     -    516 +797     -    pdfPreviewBtn.textContent = '‚è≥ Generating Preview...';
9761     -    517 +798     -    pdfPreviewBtn.disabled = true;
9762     -    518 +    785 +      const config = getPDFConfig();
9763     -    519 +    786 +      const previewUrl = await pdfService.previewPDF(preview, config);
9764     -    520 +    787 +      pdfPreviewFrame.src = previewUrl;
9765     -    521 +799 788  
9766     -    522 +800     -    const config = getPDFConfig();
9767     -    523 +801     -    const previewUrl = await pdfService.previewPDF(preview, config);
9768     -    524 +802     -    pdfPreviewFrame.src = previewUrl;
9769     -    525 +803     -
9770     -    526 +804     -    pdfPreviewBtn.textContent = 'üëÅÔ∏è Update Preview';
9771     -    527 +805     -    pdfPreviewBtn.disabled = false;
9772     -    528 +806     -  } catch (error) {
9773     -    529 +807     -    console.error('PDF preview error:', error);
9774     -    530 +808     -    alert('Error generating preview: ' + error.message);
9775     -    531 +809     -    pdfPreviewBtn.textContent = 'üëÅÔ∏è Update Preview';
9776     -    532 +810     -    pdfPreviewBtn.disabled = false;
9777     -    533 +    789 +      pdfPreviewBtn.textContent = 'üëÅÔ∏è Update Preview';
9778     -    534 +    790 +      pdfPreviewBtn.disabled = false;
9779     -    535 +    791 +    } catch (error) {
9780     -    536 +    792 +      console.error('PDF preview error:', error);
9781     -    537 +    793 +      alert('Error generating preview: ' + error.message);
9782     -    538 +    794 +      pdfPreviewBtn.textContent = 'üëÅÔ∏è Update Preview';
9783     -    539 +    795 +      pdfPreviewBtn.disabled = false;
9784     -    540 +    796 +    }
9785     -    541 +811 797    }
9786     -    542 +812     -}
9787     -    543 +813 798  
9788     -    544 +814     -// Download PDF
9789     -    545 +815     -async function downloadPDF() {
9790     -    546 +816     -  try {
9791     -    547 +817     -    pdfDownloadBtn.textContent = '‚è≥ Downloading...';
9792     -    548 +818     -    pdfDownloadBtn.disabled = true;
9793     -    549 +    799 +  // Download PDF
9794     -    550 +    800 +  async function downloadPDF() {
9795     -    551 +    801 +    try {
9796     -    552 +    802 +      pdfDownloadBtn.textContent = '‚è≥ Downloading...';
9797     -    553 +    803 +      pdfDownloadBtn.disabled = true;
9798     -    554 +819 804  
9799     -    555 +820     -    const success = pdfService.downloadPDF();
9800     -    556 +821     -    if (success) {
9801     -    557 +822     -      setTimeout(() => {
9802     -    558 +823     -        pdfModal.classList.remove('active');
9803     -    559 +824     -        pdfPreviewFrame.src = '';
9804     -    560 +825     -      }, 500);
9805     -    561 +    805 +      const success = pdfService.downloadPDF();
9806     -    562 +    806 +      if (success) {
9807     -    563 +    807 +        setTimeout(() => {
9808     -    564 +    808 +          pdfModal.classList.remove('active');
9809     -    565 +    809 +          pdfPreviewFrame.src = '';
9810     -    566 +    810 +        }, 500);
9811     -    567 +    811 +      }
9812     -    568 +    812 +
9813     -    569 +    813 +      pdfDownloadBtn.textContent = 'üíæ Download PDF';
9814     -    570 +    814 +      pdfDownloadBtn.disabled = false;
9815     -    571 +    815 +    } catch (error) {
9816     -    572 +    816 +      console.error('PDF download error:', error);
9817     -    573 +    817 +      alert('Error downloading PDF: ' + error.message);
9818     -    574 +    818 +      pdfDownloadBtn.textContent = 'üíæ Download PDF';
9819     -    575 +    819 +      pdfDownloadBtn.disabled = false;
9820     -    576 +    820 +    }
9821     -    577 +    821 +  }
9822     -    578 +    822 +
9823     -    579 +    823 +  // Font size controls with auto-update
9824     -    580 +    824 +  pdfFontDecrease.addEventListener('click', () => {
9825     -    581 +    825 +    if (currentFontSize > 8) {
9826     -    582 +    826 +      currentFontSize -= 1;
9827     -    583 +    827 +      pdfFontSizeDisplay.textContent = `${currentFontSize}pt`;
9828     -    584 +    828 +      updatePDFPreview();
9829     -    585 +    829 +    }
9830     -    586 +    830 +  });
9831     -    587 +    831 +
9832     -    588 +    832 +  pdfFontIncrease.addEventListener('click', () => {
9833     -    589 +    833 +    if (currentFontSize < 24) {
9834     -    590 +    834 +      currentFontSize += 1;
9835     -    591 +    835 +      pdfFontSizeDisplay.textContent = `${currentFontSize}pt`;
9836     -    592 +    836 +      updatePDFPreview();
9837     -    593 +    837 +    }
9838     -    594 +    838 +  });
9839     -    595 +    839 +
9840     -    596 +    840 +  // Auto-update preview when settings change
9841     -    597 +    841 +  pdfPageSize.addEventListener('change', updatePDFPreview);
9842     -    598 +    842 +  pdfOrientation.addEventListener('change', updatePDFPreview);
9843     -    599 +    843 +  pdfMarginTop.addEventListener('input', updatePDFPreview);
9844     -    600 +    844 +  pdfMarginRight.addEventListener('input', updatePDFPreview);
9845     -    601 +    845 +  pdfMarginBottom.addEventListener('input', updatePDFPreview);
9846     -    602 +    846 +  pdfMarginLeft.addEventListener('input', updatePDFPreview);
9847     -    603 +    847 +
9848     -    604 +    848 +  // PDF Event Listeners
9849     -    605 +    849 +  pdfPreviewBtn.addEventListener('click', updatePDFPreview);
9850     -    606 +    850 +  pdfDownloadBtn.addEventListener('click', downloadPDF);
9851     -    607 +    851 +
9852     -    608 +    852 +  // Event listeners for export buttons
9853     -    609 +    853 +  exportHtmlBtn.addEventListener('click', exportHTML);
9854     -    610 +    854 +  exportPdfBtn.addEventListener('click', () => {
9855     -    611 +    855 +    console.log('Export PDF button clicked');
9856     -    612 +    856 +    openPDFModal();
9857     -    613 +    857 +  });
9858     -    614 +    858 +
9859     -    615 +    859 +  // Debug: Verify elements are found
9860     -    616 +    860 +  console.log('Export PDF Button:', exportPdfBtn);
9861     -    617 +    861 +  console.log('PDF Modal:', pdfModal);
9862     -    618 +    862 +  console.log('PDF Service Ready:', pdfService.isReady());
9863     -    619 +    863 +
9864     -    620 +    864 +  // View mode switching
9865     -    621 +    865 +  function setViewMode(mode) {
9866     -    622 +    866 +    // Remove active class from all buttons
9867     -    623 +    867 +    editorOnlyBtn.classList.remove('active');
9868     -    624 +    868 +    splitViewBtn.classList.remove('active');
9869     -    625 +    869 +    previewOnlyBtn.classList.remove('active');
9870     -    626 +    870 +
9871     -    627 +    871 +    // Apply view mode
9872     -    628 +    872 +    switch (mode) {
9873     -    629 +    873 +      case 'editor-only':
9874     -    630 +    874 +        editorOnlyBtn.classList.add('active');
9875     -    631 +    875 +        editorContainer.style.display = 'flex';
9876     -    632 +    876 +        previewContainer.style.display = 'none';
9877     -    633 +    877 +        break;
9878     -    634 +    878 +      case 'split-view':
9879     -    635 +    879 +        splitViewBtn.classList.add('active');
9880     -    636 +    880 +        editorContainer.style.display = 'flex';
9881     -    637 +    881 +        previewContainer.style.display = 'flex';
9882     -    638 +    882 +        break;
9883     -    639 +    883 +      case 'preview-only':
9884     -    640 +    884 +        previewOnlyBtn.classList.add('active');
9885     -    641 +    885 +        editorContainer.style.display = 'none';
9886     -    642 +    886 +        previewContainer.style.display = 'flex';
9887     -    643 +    887 +        break;
9888     -    644 +826 888      }
9889     -    645 +827 889  
9890     -    646 +828     -    pdfDownloadBtn.textContent = 'üíæ Download PDF';
9891     -    647 +829     -    pdfDownloadBtn.disabled = false;
9892     -    648 +830     -  } catch (error) {
9893     -    649 +831     -    console.error('PDF download error:', error);
9894     -    650 +832     -    alert('Error downloading PDF: ' + error.message);
9895     -    651 +833     -    pdfDownloadBtn.textContent = 'üíæ Download PDF';
9896     -    652 +834     -    pdfDownloadBtn.disabled = false;
9897     -    653 +835     -  }
9898     -    654 +836     -}
9899     -    655 +837     -
9900     -    656 +838     -// Font size controls with auto-update
9901     -    657 +839     -pdfFontDecrease.addEventListener('click', () => {
9902     -    658 +840     -  if (currentFontSize > 8) {
9903     -    659 +841     -    currentFontSize -= 1;
9904     -    660 +842     -    pdfFontSizeDisplay.textContent = `${currentFontSize}pt`;
9905     -    661 +843     -    updatePDFPreview();
9906     -    662 +844     -  }
9907     -    663 +845     -});
9908     -    664 +846     -
9909     -    665 +847     -pdfFontIncrease.addEventListener('click', () => {
9910     -    666 +848     -  if (currentFontSize < 24) {
9911     -    667 +849     -    currentFontSize += 1;
9912     -    668 +850     -    pdfFontSizeDisplay.textContent = `${currentFontSize}pt`;
9913     -    669 +851     -    updatePDFPreview();
9914     -    670 +852     -  }
9915     -    671 +853     -});
9916     -    672 +854     -
9917     -    673 +855     -// Auto-update preview when settings change
9918     -    674 +856     -pdfPageSize.addEventListener('change', updatePDFPreview);
9919     -    675 +857     -pdfOrientation.addEventListener('change', updatePDFPreview);
9920     -    676 +858     -pdfMarginTop.addEventListener('input', updatePDFPreview);
9921     -    677 +859     -pdfMarginRight.addEventListener('input', updatePDFPreview);
9922     -    678 +860     -pdfMarginBottom.addEventListener('input', updatePDFPreview);
9923     -    679 +861     -pdfMarginLeft.addEventListener('input', updatePDFPreview);
9924     -    680 +862     -
9925     -    681 +863     -// PDF Event Listeners
9926     -    682 +864     -pdfPreviewBtn.addEventListener('click', updatePDFPreview);
9927     -    683 +865     -pdfDownloadBtn.addEventListener('click', downloadPDF);
9928     -    684 +866     -
9929     -    685 +867     -// Event listeners for export buttons
9930     -    686 +868     -exportHtmlBtn.addEventListener('click', exportHTML);
9931     -    687 +869     -exportPdfBtn.addEventListener('click', () => {
9932     -    688 +870     -  console.log('Export PDF button clicked');
9933     -    689 +871     -  openPDFModal();
9934     -    690 +872     -});
9935     -    691 +873     -
9936     -    692 +874     -// Debug: Verify elements are found
9937     -    693 +875     -console.log('Export PDF Button:', exportPdfBtn);
9938     -    694 +876     -console.log('PDF Modal:', pdfModal);
9939     -    695 +877     -console.log('PDF Service Ready:', pdfService.isReady());
9940     -    696 +878     -
9941     -    697 +879     -// View mode switching
9942     -    698 +880     -function setViewMode(mode) {
9943     -    699 +881     -  // Remove active class from all buttons
9944     -    700 +882     -  editorOnlyBtn.classList.remove('active');
9945     -    701 +883     -  splitViewBtn.classList.remove('active');
9946     -    702 +884     -  previewOnlyBtn.classList.remove('active');
9947     -    703 +885     -
9948     -    704 +886     -  // Apply view mode
9949     -    705 +887     -  switch (mode) {
9950     -    706 +888     -    case 'editor-only':
9951     -    707 +889     -      editorOnlyBtn.classList.add('active');
9952     -    708 +890     -      editorContainer.style.display = 'flex';
9953     -    709 +891     -      previewContainer.style.display = 'none';
9954     -    710 +892     -      break;
9955     -    711 +893     -    case 'split-view':
9956     -    712 +894     -      splitViewBtn.classList.add('active');
9957     -    713 +895     -      editorContainer.style.display = 'flex';
9958     -    714 +896     -      previewContainer.style.display = 'flex';
9959     -    715 +897     -      break;
9960     -    716 +898     -    case 'preview-only':
9961     -    717 +899     -      previewOnlyBtn.classList.add('active');
9962     -    718 +900     -      editorContainer.style.display = 'none';
9963     -    719 +901     -      previewContainer.style.display = 'flex';
9964     -    720 +902     -      break;
9965     -    721 +    890 +    // Save view mode preference
9966     -    722 +    891 +    storageManager.set('viewMode', mode);
9967     -    723 +903 892    }
9968     -    724 +904 893  
9969     -    725 +905     -  // Save view mode preference
9970     -    726 +906     -  storageManager.set('viewMode', mode);
9971     -    727 +907     -}
9972     -    728 +    894 +  // ==================== SYNC SCROLL FUNCTIONALITY ====================
9973     -    729 +908 895  
9974     -    730 +909     -// ==================== SYNC SCROLL FUNCTIONALITY ====================
9975     -    731 +910     -
9976     -    732 +911     -// Sync scroll state (using var to avoid formatter issues)
9977     -    733 +912     -var syncScrollEnabled = storageManager.get('syncScrollEnabled') === 'true';
9978     -    734 +913     -var syncScrolling = false;
9979     -    735 +914     -
9980     -    736 +915     -// Load saved state and update button
9981     -    737 +916     -if (syncScrollEnabled) {
9982     -    738 +917     -  syncScrollBtn.classList.add('active');
9983     -    739 +918     -}
9984     -9242 740  919     -
9985     -9243     -920     -    syncScrolling = true;
9986     -9244     -921     -
9987     -9245     -922     -    requestAnimationFrame(() => {
9988     -9246     -923     -      const editorHeight = editor.scrollHeight - editor.clientHeight;
9989     -9247     -924     -      const previewHeight = previewContainer.scrollHeight - previewContainer.clientHeight;
9990     -9248     -925     -
9991     -9249     -926     -      // Handle edge cases for perfect alignment
9992     -9250     -927     -      if (editor.scrollTop <= 0) {
9993     -9251     -928     -        // At top
9994     -9252     -929     -        previewContainer.scrollTop = 0;
9995     -9253     -930     -      } else if (editor.scrollTop >= editorHeight) {
9996     -9254     -931     -        // At bottom
9997     -9255     -932     -        previewContainer.scrollTop = previewHeight;
9998     -9256     -933     -      } else {
9999     -9257     -934     -        // Middle - proportional scroll
10000     -9258     -935     -        const scrollPercent = editor.scrollTop / editorHeight;
10001     -9259     -936     -        previewContainer.scrollTop = scrollPercent * previewHeight;
10002     -9260     -937     -      }
10003     -9261     -938     -
10004     -9262     -939     -      setTimeout(() => {
10005     -9263     -940     -        syncScrolling = false;
10006     -9264     -941     -      }, 10); // Reduced from 50ms for more responsive feel
10007     -9265     -942     -    });
10008     -9266     -943     -  });
10009     -9267     -944     -
10010     -9268     -945     -  // Preview container scroll handler with smooth sync
10011     -9269     -946     -  previewContainer.addEventListener('scroll', () => {
10012     -9270     -947     -    if (!syncScrollEnabled || syncScrolling) return;
10013     -9271     -948     -
10014     -9272     -949     -    syncScrolling = true;
10015     -9273     -950     -
10016     -9274     -951     -    requestAnimationFrame(() => {
10017     -9275     -952     -      const editorHeight = editor.scrollHeight - editor.clientHeight;
10018     -9276     -953     -      const previewHeight = previewContainer.scrollHeight - previewContainer.clientHeight;
10019     -9277     -954     -
10020     -9278     -955     -      // Handle edge cases for perfect alignment
10021     -9279     -956     -      if (previewContainer.scrollTop <= 0) {
10022     -9280     -957     -        // At top
10023     -9281     -958     -        editor.scrollTop = 0;
10024     -9282     -959     -      } else if (previewContainer.scrollTop >= previewHeight) {
10025     -9283     -960     -        // At bottom
10026     -9284     -961     -        editor.scrollTop = editorHeight;
10027     -9285     -962     -      } else {
10028     -9286     -963     -        // Middle - proportional scroll
10029     -9287     -964     -        const scrollPercent = previewContainer.scrollTop / previewHeight;
10030     -9288     -965     -        editor.scrollTop = scrollPercent * editorHeight;
10031     -9289     -966     -      }
10032     -9290     -967     -
10033     -9291     -968     -      setTimeout(() => {
10034     -9292     -969     -        syncScrolling = false;
10035     -9293     -970     -      }, 10); // Reduced from 50ms for more responsive feel
10036     -9294     -971     -    });
10037     -9295     -972     -  });
10038     -9296     -973     -
10039     -9297     -974     -  // View mode button event listeners with sync button update
10040     -9298     -975     -  editorOnlyBtn.addEventListener('click', () => {
10041     -9299     -976     -    setViewMode('editor-only');
10042     -9300     -977     -    updateSyncScrollVisibility();
10043     -9301     -978     -  });
10044     -9302     -979     -  splitViewBtn.addEventListener('click', () => {
10045     -9303     -980     -    setViewMode('split-view');
10046     -9304     -981     -    updateSyncScrollVisibility();
10047     -9305     -982     -  });
10048     -9306     -983     -  previewOnlyBtn.addEventListener('click', () => {
10049     -9307     -984     -    setViewMode('preview-only');
10050     -9308     -985     -    updateSyncScrollVisibility();
10051     -9309     -986     -  });
10052     -9310     -987     -
10053     -9311     -988     -  // Initialize visibility
10054     -9312     -989     -  updateSyncScrollVisibility();
10055     -9313     -990     -
10056     -9314     -991     -  // Load saved theme FIRST, then initialize Mermaid with correct colors
10057     -9315     -992     -  const savedTheme = storageManager.get('selectedTheme');
10058     -9316     -993     -  if (savedTheme) {
10059     -9317     -994     -    // Load theme first, then sync dropdown and reinit Mermaid
10060     -9318     -995     -    themeManager
10061     -9319     -996     -      .loadTheme(savedTheme)
10062     -9320     -997     -      .then(() => {
10063     -9321     -998     -        // Theme loaded successfully - sync dropdown
10064     -9322     -999     -        themeSelector.value = savedTheme;
10065     -9323     -1000     -        console.log(`‚úÖ Theme restored: ${savedTheme}`);
10066     -9324     -1001     -
10067     -9325     -1002     -        // NOW initialize Mermaid with correct theme colors
10068     -9326     -1003     -        mermaidService.initialize();
10069     -9327     -1004     -
10070     -9328     -1005     -        // Re-render to apply theme
10071     -9329     -1006     -        renderMarkdown();
10072     -9330     -1007     -      })
10073     -9331     -1008     -      .catch(err => {
10074     -9332     -1009     -        console.error('Failed to load saved theme:', err);
10075     -9333     -1010     -        // Fallback to default-light on error
10076     -9334     -1011     -        themeManager.loadTheme('default-light').then(() => {
10077     -9335     -1012     -          themeSelector.value = 'default-light';
10078     -9336     -1013     -          mermaidService.initialize();
10079     -9337     -1014     -          renderMarkdown();
10080     -9338     -1015     -        });
10081     -9339     -1016     -      });
10082     -9340     -    937 +    console.log('‚úÖ Sync scroll enabled');
10083     -9341     -1017 938    } else {
10084     -9342     -1018     -    // No saved theme - initialize with default-light
10085     -9343     -1019     -    mermaidService.initialize();
10086     -9344     -1020     -    renderMarkdown();
10087     -9345     -    939 +    syncScrollBtn.classList.remove('active');
10088     -9346     -    940 +    console.log('‚ùå Sync scroll disabled');
10089     -9347     -1021 941    }
10090     -9348     -    942 +});
10091     -9349     -1022 943  
10092     -9350     -1023     -  // Zoom functionality
10093     -9351     -1024     -  function setZoom(zoomLevel) {
10094     -9352     -1025     -    // Constrain zoom level between 50% and 200%
10095     -9353     -1026     -    currentZoom = Math.max(50, Math.min(200, zoomLevel));
10096     -9354     -    944 +// Editor scroll handler with smooth sync
10097     -9355     -    945 +editor.addEventListener('scroll', () => {
10098     -9356     -    946 +  if (!syncScrollEnabled || syncScrolling) return;
10099     -9357     -1027 947  
10100     -9358     -1028     -    // Apply zoom using CSS transform with proper container sizing
10101     -9359     -1029     -    preview.style.transform = `scale(${currentZoom / 100})`;
10102     -9360     -1030     -    preview.style.transformOrigin = 'top left';
10103     -9361     -1031     -    preview.style.width = `${10000 / currentZoom}%`;
10104     -9362     -1032     -    preview.style.height = `${10000 / currentZoom}%`;
10105     -9363     -    948 +  syncScrolling = true;
10106     -9364     -1033 949  
10107     -9365     -1034     -    // Ensure scrollbar remains visible and functional
10108     -9366     -1035     -    const previewContainer = preview.parentElement;
10109     -9367     -1036     -    if (previewContainer) {
10110     -9368     -1037     -      previewContainer.style.overflow = 'auto';
10111     -9369     -    950 +  requestAnimationFrame(() => {
10112     -9370     -    951 +    const editorHeight = editor.scrollHeight - editor.clientHeight;
10113     -9371     -    952 +    const previewHeight = previewContainer.scrollHeight - previewContainer.clientHeight;
10114     -9372     -    953 +
10115     -9373     -    954 +    // Handle edge cases for perfect alignment
10116     -9374     -    955 +    if (editor.scrollTop <= 0) {
10117     -9375     -    956 +      // At top
10118     -9376     -    957 +      previewContainer.scrollTop = 0;
10119     -9377     -    958 +    } else if (editor.scrollTop >= editorHeight) {
10120     -9378     -    959 +      // At bottom
10121     -9379     -    960 +      previewContainer.scrollTop = previewHeight;
10122     -9380     -    961 +    } else {
10123     -9381     -    962 +      // Middle - proportional scroll
10124     -9382     -    963 +      const scrollPercent = editor.scrollTop / editorHeight;
10125     -9383     -    964 +      previewContainer.scrollTop = scrollPercent * previewHeight;
10126     -9384     -1038 965      }
10127     -9385     -1039 966  
10128     -9386     -1040     -    // Update display
10129     -9387     -1041     -    zoomLevelDisplay.textContent = `${currentZoom}%`;
10130     -9388     -1042     -
10131     -9389     -1043     -    // Save to localStorage
10132     -9390     -1044     -    storageManager.set('previewZoom', currentZoom.toString());
10133     -9391     -1045     -  }
10134     -9392     -1046     -
10135     -9393     -1047     -  function zoomIn() {
10136     -9394     -1048     -    setZoom(currentZoom + 10);
10137     -9395     -1049     -  }
10138     -9396     -1050     -
10139     -9397     -1051     -  function zoomOut() {
10140     -9398     -1052     -    setZoom(currentZoom - 10);
10141     -9399     -1053     -  }
10142     -9400     -1054     -
10143     -9401     -1055     -  function resetZoom() {
10144     -9402     -1056     -    setZoom(100);
10145     -9403     -1057     -  }
10146     -9404     -1058     -
10147     -9405     -1059     -  // Zoom event listeners
10148     -9406     -1060     -  zoomInBtn.addEventListener('click', zoomIn);
10149     -9407     -1061     -  zoomOutBtn.addEventListener('click', zoomOut);
10150     -9408     -1062     -  zoomResetBtn.addEventListener('click', resetZoom);
10151     -9409     -1063     -
10152     -9410     -1064     -  // Keyboard shortcuts for zoom (Ctrl/Cmd + Plus/Minus/0)
10153     -9411     -1065     -  preview.addEventListener('wheel', e => {
10154     -9412     -1066     -    if (e.ctrlKey || e.metaKey) {
10155     -9413     -1067     -      e.preventDefault();
10156     -9414     -1068     -      if (e.deltaY < 0) {
10157     -9415     -1069     -        zoomIn();
10158     -9416     -1070     -      } else {
10159     -9417     -1071     -        zoomOut();
10160     -9418     -1072     -      }
10161     -9419     -1073     -    }
10162     -9420     -    967 +    setTimeout(() => {
10163     -9421     -    968 +      syncScrolling = false;
10164     -9422     -    969 +    }, 10); // Reduced from 50ms for more responsive feel
10165     -9423     -1074 970    });
10166     -9424     -    971 +});
10167     -9425     -1075 972  
10168     -9426     -1076     -  document.addEventListener('keydown', e => {
10169     -9427     -1077     -    if ((e.ctrlKey || e.metaKey) && e.target.tagName !== 'TEXTAREA') {
10170     -9428     -1078     -      if (e.key === '=' || e.key === '+') {
10171     -9429     -1079     -        e.preventDefault();
10172     -9430     -1080     -        zoomIn();
10173     -9431     -1081     -      } else if (e.key === '-') {
10174     -9432     -1082     -        e.preventDefault();
10175     -9433     -1083     -        zoomOut();
10176     -9434     -1084     -      } else if (e.key === '0') {
10177     -9435     -1085     -        e.preventDefault();
10178     -9436     -1086     -        resetZoom();
10179     -9437     -1087     -      }
10180     -9438     -    973 +// Preview container scroll handler with smooth sync
10181     -9439     -    974 +previewContainer.addEventListener('scroll', () => {
10182     -9440     -    975 +  if (!syncScrollEnabled || syncScrolling) return;
10183     -9441     -    976 +
10184     -9442     -    977 +  syncScrolling = true;
10185     -9443     -    978 +
10186     -9444     -    979 +  requestAnimationFrame(() => {
10187     -9445     -    980 +    const editorHeight = editor.scrollHeight - editor.clientHeight;
10188     -9446     -    981 +    const previewHeight = previewContainer.scrollHeight - previewContainer.clientHeight;
10189     -9447     -    982 +
10190     -9448     -    983 +    // Handle edge cases for perfect alignment
10191     -9449     -    984 +    if (previewContainer.scrollTop <= 0) {
10192     -9450     -    985 +      // At top
10193     -9451     -    986 +      editor.scrollTop = 0;
10194     -9452     -    987 +    } else if (previewContainer.scrollTop >= previewHeight) {
10195     -9453     -    988 +      // At bottom
10196     -9454     -    989 +      editor.scrollTop = editorHeight;
10197     -9455     -    990 +    } else {
10198     -9456     -    991 +      // Middle - proportional scroll
10199     -9457     -    992 +      const scrollPercent = previewContainer.scrollTop / previewHeight;
10200     -9458     -    993 +      editor.scrollTop = scrollPercent * editorHeight;
10201     -9459     -1088 994      }
10202     -9460     -    995 +
10203     -9461     -    996 +    setTimeout(() => {
10204     -9462     -    997 +      syncScrolling = false;
10205     -9463     -    998 +    }, 10); // Reduced from 50ms for more responsive feel
10206     -9464     -1089 999    });
10207     -9465     -    1000 +});
10208     -9466     -1090 1001  
10209     -9467     -1091     -  // Load saved zoom level
10210     -9468     -1092     -  const savedZoom = storageManager.get('previewZoom');
10211     -9469     -1093     -  if (savedZoom) {
10212     -9470     -1094     -    currentZoom = parseInt(savedZoom, 10);
10213     -9471     -1095     -    setZoom(currentZoom);
10214     -9472     -    1002 +// View mode button event listeners with sync button update
10215     -9473     -    1003 +editorOnlyBtn.addEventListener('click', () => {
10216     -9474     -    1004 +  setViewMode('editor-only');
10217     -9475     -    1005 +  updateSyncScrollVisibility();
10218     -9476     -    1006 +});
10219     -9477     -    1007 +splitViewBtn.addEventListener('click', () => {
10220     -9478     -    1008 +  setViewMode('split-view');
10221     -9479     -    1009 +  updateSyncScrollVisibility();
10222     -9480     -    1010 +});
10223     -9481     -    1011 +previewOnlyBtn.addEventListener('click', () => {
10224     -9482     -    1012 +  setViewMode('preview-only');
10225     -9483     -    1013 +  updateSyncScrollVisibility();
10226     -9484     -    1014 +});
10227     -9485     -    1015 +
10228     -9486     -    1016 +// Initialize visibility
10229     -9487     -    1017 +updateSyncScrollVisibility();
10230     -9488     -    1018 +
10231     -9489     -    1019 +// Load saved theme FIRST, then initialize Mermaid with correct colors
10232     -9490     -    1020 +const savedTheme = storageManager.get('selectedTheme');
10233     -9491     -    1021 +if (savedTheme) {
10234     -9492     -    1022 +  // Load theme first, then sync dropdown and reinit Mermaid
10235     -9493     -    1023 +  themeManager
10236     -9494     -    1024 +    .loadTheme(savedTheme)
10237     -9495     -    1025 +    .then(() => {
10238     -9496     -    1026 +      // Theme loaded successfully - sync dropdown
10239     -9497     -    1027 +      themeSelector.value = savedTheme;
10240     -9498     -    1028 +      console.log(`‚úÖ Theme restored: ${savedTheme}`);
10241     -9499     -    1029 +
10242     -9500     -    1030 +      // NOW initialize Mermaid with correct theme colors
10243     -9501     -    1031 +      mermaidService.initialize();
10244     -9502     -    1032 +
10245     -9503     -    1033 +      // Re-render to apply theme
10246     -9504     -    1034 +      renderMarkdown();
10247     -9505     -    1035 +    })
10248     -9506     -    1036 +    .catch(err => {
10249     -9507     -    1037 +      console.error('Failed to load saved theme:', err);
10250     -9508     -    1038 +      // Fallback to default-light on error
10251     -9509     -    1039 +      themeManager.loadTheme('default-light').then(() => {
10252     -9510     -    1040 +        themeSelector.value = 'default-light';
10253     -9511     -    1041 +        mermaidService.initialize();
10254     -9512     -    1042 +        renderMarkdown();
10255     -9513     -    1043 +      });
10256     -9514     -    1044 +    });
10257     -9515     -    1045 +} else {
10258     -9516     -    1046 +  // No saved theme - initialize with default-light
10259     -9517     -    1047 +  mermaidService.initialize();
10260     -9518     -    1048 +  renderMarkdown();
10261     -9519     -    1049 +}
10262     -9520     -    1050 +
10263     -9521     -    1051 +// Zoom functionality
10264     -9522     -    1052 +function setZoom(zoomLevel) {
10265     -9523     -    1053 +  // Constrain zoom level between 50% and 200%
10266     -9524     -    1054 +  currentZoom = Math.max(50, Math.min(200, zoomLevel));
10267     -9525     -    1055 +
10268     -9526     -    1056 +  // Apply zoom using CSS transform with proper container sizing
10269     -9527     -    1057 +  preview.style.transform = `scale(${currentZoom / 100})`;
10270     -9528     -    1058 +  preview.style.transformOrigin = 'top left';
10271     -9529     -    1059 +  preview.style.width = `${10000 / currentZoom}%`;
10272     -9530     -    1060 +  preview.style.height = `${10000 / currentZoom}%`;
10273     -9531     -    1061 +
10274     -9532     -    1062 +  // Ensure scrollbar remains visible and functional
10275     -9533     -    1063 +  const previewContainer = preview.parentElement;
10276     -9534     -    1064 +  if (previewContainer) {
10277     -9535     -    1065 +    previewContainer.style.overflow = 'auto';
10278     -9536     -1096 1066    }
10279     -9537     -1097 1067  
10280     -9538     -1098     -  // Load saved view mode
10281     -9539     -1099     -  const savedViewMode = storageManager.get('viewMode') || 'split-view';
10282     -9540     -1100     -  setViewMode(savedViewMode);
10283     -9541     -    1068 +  // Update display
10284     -9542     -    1069 +  zoomLevelDisplay.textContent = `${currentZoom}%`;
10285     -9543     -1101 1070  
10286     -9544     -1102     -  // ==================== FOLDER BROWSER FUNCTIONALITY ====================
10287     -9545     -    1071 +  // Save to localStorage
10288     -9546     -    1072 +  storageManager.set('previewZoom', currentZoom.toString());
10289     -9547     -    1073 +}
10290     -9548     -1103 1074  
10291     -9549     -1104     -  // Folder browser DOM elements
10292     -9550     -1105     -  const fileBrowser = document.getElementById('file-browser');
10293     -9551     -1106     -  const openFolderBtn = document.getElementById('open-folder-btn');
10294     -9552     -1107     -  const toggleSidebarBtn = document.getElementById('toggle-sidebar-btn');
10295     -9553     -1108     -  const closeBrowserBtn = document.getElementById('close-browser-btn');
10296     -9554     -1109     -  const floatingShowBtn = document.getElementById('floating-show-btn');
10297     -9555     -1110     -  const resizeHandle = document.getElementById('resize-handle');
10298     -9556     -1111     -  const fileTree = document.getElementById('file-tree');
10299     -9557     -1112     -  const currentFolderNameEl = document.getElementById('current-folder-name');
10300     -9558     -1113     -  const fileCountEl = document.getElementById('file-count');
10301     -9559     -    1075 +function zoomIn() {
10302     -9560     -    1076 +  setZoom(currentZoom + 10);
10303     -9561     -    1077 +}
10304     -9562     -1114 1078  
10305     -9563     -1115     -  // Folder browser state (using let to allow reassignment)
10306     -9564     -1116     -  let folderFiles = [];
10307     -9565     -1117     -  let activeFileHandle = null;
10308     -9566     -1118     -  let isResizing = false;
10309     -9567     -1119     -  let sidebarWidth = 280; // Default width
10310     -9568     -1120     -  const minWidth = 100; // Allow squeezing to very narrow
10311     -9569     -1121     -  const maxWidth = 600;
10312     -9570     -1122     -  const collapseThreshold = 80; // Auto-collapse at very left edge only
10313     -9571     -    1079 +function zoomOut() {
10314     -9572     -    1080 +  setZoom(currentZoom - 10);
10315     -9573     -    1081 +}
10316     -9574     -1123 1082  
10317     -9575     -1124     -  // Load saved sidebar width
10318     -9576     -1125     -  const savedWidth = storageManager.get('sidebarWidth');
10319     -9577     -1126     -  if (savedWidth) {
10320     -9578     -1127     -    sidebarWidth = parseInt(savedWidth, 10);
10321     -9579     -1128     -  }
10322     -9580     -    1083 +function resetZoom() {
10323     -9581     -    1084 +  setZoom(100);
10324     -9582     -    1085 +}
10325     -9583     -1129 1086  
10326     -9584     -1130     -  // Resize functionality
10327     -9585     -1131     -  resizeHandle.addEventListener('mousedown', e => {
10328     -9586     -1132     -    isResizing = true;
10329     -9587     -1133     -    fileBrowser.classList.add('resizing');
10330     -9588     -1134     -    resizeHandle.classList.add('dragging');
10331     -9589     -1135     -    document.body.style.cursor = 'col-resize';
10332     -9590     -1136     -    document.body.style.userSelect = 'none';
10333     -9591     -    1087 +// Zoom event listeners
10334     -9592     -    1088 +zoomInBtn.addEventListener('click', zoomIn);
10335     -9593     -    1089 +zoomOutBtn.addEventListener('click', zoomOut);
10336     -9594     -    1090 +zoomResetBtn.addEventListener('click', resetZoom);
10337     -9595     -    1091 +
10338     -9596     -    1092 +// Keyboard shortcuts for zoom (Ctrl/Cmd + Plus/Minus/0)
10339     -9597     -    1093 +preview.addEventListener('wheel', e => {
10340     -9598     -    1094 +  if (e.ctrlKey || e.metaKey) {
10341     -9599     -1137 1095      e.preventDefault();
10342     -9600     -1138     -  });
10343     -9601     -1139     -
10344     -9602     -1140     -  document.addEventListener('mousemove', e => {
10345     -9603     -1141     -    if (!isResizing) return;
10346     -9604     -1142     -
10347     -9605     -1143     -    const newWidth = e.clientX;
10348     -9606     -1144     -
10349     -9607     -1145     -    // Check if dragged to leftmost (auto-collapse)
10350     -9608     -1146     -    if (newWidth < collapseThreshold) {
10351     -9609     -1147     -      // Auto-collapse with smooth animation
10352     -9610     -1148     -      fileBrowser.classList.remove('resizing');
10353     -9611     -1149     -      fileBrowser.style.display = 'none';
10354     -9612     -1150     -      floatingShowBtn.style.display = 'block';
10355     -9613     -1151     -      isResizing = false;
10356     -9614     -1152     -      resizeHandle.classList.remove('dragging');
10357     -9615     -1153     -      document.body.style.cursor = '';
10358     -9616     -1154     -      document.body.style.userSelect = '';
10359     -9617     -1155     -      return;
10360     -9618     -    1096 +    if (e.deltaY < 0) {
10361     -9619     -    1097 +      zoomIn();
10362     -9620     -    1098 +    } else {
10363     -9621     -    1099 +      zoomOut();
10364     -9622     -1156 1100      }
10365     -9623     -    1101 +  }
10366     -9624     -    1102 +});
10367     -9625     -1157 1103  
10368     -9626     -1158     -    // Constrain width
10369     -9627     -1159     -    if (newWidth >= minWidth && newWidth <= maxWidth) {
10370     -9628     -1160     -      sidebarWidth = newWidth;
10371     -9629     -1161     -      fileBrowser.style.width = `${sidebarWidth}px`;
10372     -9630     -    1104 +document.addEventListener('keydown', e => {
10373     -9631     -    1105 +  if ((e.ctrlKey || e.metaKey) && e.target.tagName !== 'TEXTAREA') {
10374     -9632     -    1106 +    if (e.key === '=' || e.key === '+') {
10375     -9633     -    1107 +      e.preventDefault();
10376     -9634     -    1108 +      zoomIn();
10377     -9635     -    1109 +    } else if (e.key === '-') {
10378     -9636     -    1110 +      e.preventDefault();
10379     -9637     -    1111 +      zoomOut();
10380     -9638     -    1112 +    } else if (e.key === '0') {
10381     -9639     -    1113 +      e.preventDefault();
10382     -9640     -    1114 +      resetZoom();
10383     -9641     -1162 1115      }
10384     -9642     -1163     -  });
10385     -9643     -    1116 +  }
10386     -9644     -    1117 +});
10387     -9645     -1164 1118  
10388     -9646     -1165     -  document.addEventListener('mouseup', () => {
10389     -9647     -1166     -    if (isResizing) {
10390     -9648     -1167     -      isResizing = false;
10391     -9649     -1168     -      fileBrowser.classList.remove('resizing');
10392     -9650     -1169     -      resizeHandle.classList.remove('dragging');
10393     -9651     -1170     -      document.body.style.cursor = '';
10394     -9652     -1171     -      document.body.style.userSelect = '';
10395     -9653     -    1119 +// Load saved zoom level
10396     -9654     -    1120 +const savedZoom = storageManager.get('previewZoom');
10397     -9655     -    1121 +if (savedZoom) {
10398     -9656     -    1122 +  currentZoom = parseInt(savedZoom, 10);
10399     -9657     -    1123 +  setZoom(currentZoom);
10400     -9658     -    1124 +}
10401     -9659     -1172 1125  
10402     -9660     -1173     -      // Save width
10403     -9661     -1174     -      storageManager.set('sidebarWidth', sidebarWidth.toString());
10404     -9662     -1175     -    }
10405     -9663     -1176     -  });
10406     -9664     -    1126 +// Load saved view mode
10407     -9665     -    1127 +const savedViewMode = storageManager.get('viewMode') || 'split-view';
10408     -9666     -    1128 +setViewMode(savedViewMode);
10409     -9667     -1177 1129  
10410     -9668     -1178     -  // Open folder handler
10411     -9669     -1179     -  openFolderBtn.addEventListener('click', async () => {
10412     -9670     -1180     -    if (!folderBrowserService.isSupported()) {
10413     -9671     -1181     -      alert(
10414     -9672     -1182     -        'Folder browsing requires File System Access API.\n\n' +
10415     -9673     -1183     -          'Please use Chrome 86+ or Edge 86+.\n\n' +
10416     -9674     -1184     -          'Firefox and Safari are not currently supported.'
10417     -9675     -1185     -      );
10418     -9676     -1186     -      return;
10419     -9677     -1187     -    }
10420     -9678     -    1130 +// ==================== FOLDER BROWSER FUNCTIONALITY ====================
10421     -9679     -1188 1131  
10422     -9680     -1189     -    const result = await folderBrowserService.openFolder();
10423     -9681     -    1132 +// Folder browser DOM elements
10424     -9682     -    1133 +const fileBrowser = document.getElementById('file-browser');
10425     -9683     -    1134 +const openFolderBtn = document.getElementById('open-folder-btn');
10426     -9684     -    1135 +const toggleSidebarBtn = document.getElementById('toggle-sidebar-btn');
10427     -9685     -    1136 +const closeBrowserBtn = document.getElementById('close-browser-btn');
10428     -9686     -    1137 +const floatingShowBtn = document.getElementById('floating-show-btn');
10429     -9687     -    1138 +const resizeHandle = document.getElementById('resize-handle');
10430     -9688     -    1139 +const fileTree = document.getElementById('file-tree');
10431     -9689     -    1140 +const currentFolderNameEl = document.getElementById('current-folder-name');
10432     -9690     -    1141 +const fileCountEl = document.getElementById('file-count');
10433     -9691     -1190 1142  
10434     -9692     -1191     -    if (result.cancelled) {
10435     -9693     -1192     -      return; // User cancelled
10436     -9694     -1193     -    }
10437     -9695     -    1143 +// Folder browser state (using let to allow reassignment)
10438     -9696     -    1144 +let folderFiles = [];
10439     -9697     -    1145 +let activeFileHandle = null;
10440     -9698     -    1146 +let isResizing = false;
10441     -9699     -    1147 +let sidebarWidth = 280; // Default width
10442     -9700     -    1148 +const minWidth = 100; // Allow squeezing to very narrow
10443     -9701     -    1149 +const maxWidth = 600;
10444     -9702     -    1150 +const collapseThreshold = 80; // Auto-collapse at very left edge only
10445     -9703     -1194 1151  
10446     -9704     -1195     -    if (!result.success) {
10447     -9705     -1196     -      alert('Error opening folder: ' + result.error);
10448     -9706     -1197     -      return;
10449     -9707     -1198     -    }
10450     -9708     -    1152 +// Load saved sidebar width
10451     -9709     -    1153 +const savedWidth = storageManager.get('sidebarWidth');
10452     -9710     -    1154 +if (savedWidth) {
10453     -9711     -    1155 +  sidebarWidth = parseInt(savedWidth, 10);
10454     -9712     -    1156 +}
10455     -9713     -1199 1157  
10456     -9714     -1200     -    // Store files
10457     -9715     -1201     -    folderFiles = result.files;
10458     -9716     -    1158 +// Resize functionality
10459     -9717     -    1159 +resizeHandle.addEventListener('mousedown', e => {
10460     -9718     -    1160 +  isResizing = true;
10461     -9719     -    1161 +  fileBrowser.classList.add('resizing');
10462     -9720     -    1162 +  resizeHandle.classList.add('dragging');
10463     -9721     -    1163 +  document.body.style.cursor = 'col-resize';
10464     -9722     -    1164 +  document.body.style.userSelect = 'none';
10465     -9723     -    1165 +  e.preventDefault();
10466     -9724     -    1166 +});
10467     -9725     -1202 1167  
10468     -9726     -1203     -    // Show browser sidebar, hide floating button
10469     -9727     -1204     -    fileBrowser.style.display = 'flex';
10470     -9728     -1205     -    floatingShowBtn.style.display = 'none';
10471     -9729     -    1168 +document.addEventListener('mousemove', e => {
10472     -9730     -    1169 +  if (!isResizing) return;
10473     -9731     -1206 1170  
10474     -9732     -1207     -    // Update UI
10475     -9733     -1208     -    currentFolderNameEl.textContent = result.folderName;
10476     -9734     -1209     -    fileCountEl.textContent = `${result.totalFiles} file${result.totalFiles !== 1 ? 's' : ''}`;
10477     -9735     -    1171 +  const newWidth = e.clientX;
10478     -9736     -1210 1172  
10479     -9737     -1211     -    // Render tree
10480     -9738     -1212     -    renderFileTree(result.files);
10481     -9739     -1213     -
10482     -9740     -1214     -    console.log(`‚úÖ Loaded ${result.totalFiles} markdown files from ${result.folderName}`);
10483     -9741     -1215     -  });
10484     -    741 +920     -// Show sync scroll button only in split view
10485     -    742 +921     -function updateSyncScrollVisibility() {
10486     -    743 +922     -  const currentView = storageManager.get('viewMode') || 'split-view';
10487     -    744 +923     -  if (currentView === 'split-view') {
10488     -    745 +924     -    syncScrollBtn.style.display = 'inline-block';
10489     -    746 +925     -  } else {
10490     -    747 +926     -    syncScrollBtn.style.display = 'none';
10491     -    748 +927     -  }
10492     -    749 +928     -}
10493     -    750 +929     -
10494     -    751 +930     -// Sync scroll toggle
10495     -    752 +931     -syncScrollBtn.addEventListener('click', () => {
10496     -    753 +932     -  syncScrollEnabled = !syncScrollEnabled;
10497     -    754 +933     -  storageManager.set('syncScrollEnabled', syncScrollEnabled.toString());
10498     -    755 +    896 +  // Sync scroll state (using var to avoid formatter issues)
10499     -    756 +    897 +  var syncScrollEnabled = storageManager.get('syncScrollEnabled') === 'true';
10500     -    757 +    898 +  var syncScrolling = false;
10501     -    758 +934 899  
10502     -    759 +    900 +  // Load saved state and update button
10503     -    760 +935 901    if (syncScrollEnabled) {
10504     -    761 +936 902      syncScrollBtn.classList.add('active');
10505     -    762 +937     -    console.log('‚úÖ Sync scroll enabled');
10506     -    763 +938     -  } else {
10507     -    764 +939     -    syncScrollBtn.classList.remove('active');
10508     -    765 +940     -    console.log('‚ùå Sync scroll disabled');
10509     -    766 +941 903    }
10510     -    767 +942     -});
10511     -    768 +943 904  
10512     -    769 +944     -// Editor scroll handler with smooth sync
10513     -    770 +945     -editor.addEventListener('scroll', () => {
10514     -    771 +946     -  if (!syncScrollEnabled || syncScrolling) return;
10515     -    772 +947     -
10516     -    773 +948     -  syncScrolling = true;
10517     -    774 +949     -
10518     -    775 +950     -  requestAnimationFrame(() => {
10519     -    776 +951     -    const editorHeight = editor.scrollHeight - editor.clientHeight;
10520     -    777 +952     -    const previewHeight = previewContainer.scrollHeight - previewContainer.clientHeight;
10521     -    778 +953     -
10522     -    779 +954     -    // Handle edge cases for perfect alignment
10523     -    780 +955     -    if (editor.scrollTop <= 0) {
10524     -    781 +956     -      // At top
10525     -    782 +957     -      previewContainer.scrollTop = 0;
10526     -    783 +958     -    } else if (editor.scrollTop >= editorHeight) {
10527     -    784 +959     -      // At bottom
10528     -    785 +960     -      previewContainer.scrollTop = previewHeight;
10529     -    786 +    905 +  // Show sync scroll button only in split view
10530     -    787 +    906 +  function updateSyncScrollVisibility() {
10531     -    788 +    907 +    const currentView = storageManager.get('viewMode') || 'split-view';
10532     -    789 +    908 +    if (currentView === 'split-view') {
10533     -    790 +    909 +      syncScrollBtn.style.display = 'inline-block';
10534     -    791 +961 910      } else {
10535     -    792 +962     -      // Middle - proportional scroll
10536     -    793 +963     -      const scrollPercent = editor.scrollTop / editorHeight;
10537     -    794 +964     -      previewContainer.scrollTop = scrollPercent * previewHeight;
10538     -    795 +    911 +      syncScrollBtn.style.display = 'none';
10539     -    796 +965 912      }
10540     -    797 +    913 +  }
10541     -    798 +966 914  
10542     -    799 +967     -    setTimeout(() => {
10543     -    800 +968     -      syncScrolling = false;
10544     -    801 +969     -    }, 10); // Reduced from 50ms for more responsive feel
10545     -    802 +970     -  });
10546     -    803 +971     -});
10547     -    804 +    915 +  // Sync scroll toggle
10548     -    805 +    916 +  syncScrollBtn.addEventListener('click', () => {
10549     -    806 +    917 +    syncScrollEnabled = !syncScrollEnabled;
10550     -    807 +    918 +    storageManager.set('syncScrollEnabled', syncScrollEnabled.toString());
10551     -    808 +972 919  
10552     -    809 +973     -// Preview container scroll handler with smooth sync
10553     -    810 +974     -previewContainer.addEventListener('scroll', () => {
10554     -    811 +975     -  if (!syncScrollEnabled || syncScrolling) return;
10555     -    812 +976     -
10556     -    813 +977     -  syncScrolling = true;
10557     -    814 +978     -
10558     -    815 +979     -  requestAnimationFrame(() => {
10559     -    816 +980     -    const editorHeight = editor.scrollHeight - editor.clientHeight;
10560     -    817 +981     -    const previewHeight = previewContainer.scrollHeight - previewContainer.clientHeight;
10561     -    818 +982     -
10562     -    819 +983     -    // Handle edge cases for perfect alignment
10563     -    820 +984     -    if (previewContainer.scrollTop <= 0) {
10564     -    821 +985     -      // At top
10565     -    822 +986     -      editor.scrollTop = 0;
10566     -    823 +987     -    } else if (previewContainer.scrollTop >= previewHeight) {
10567     -    824 +988     -      // At bottom
10568     -    825 +989     -      editor.scrollTop = editorHeight;
10569     -    826 +    920 +    if (syncScrollEnabled) {
10570     -    827 +    921 +      syncScrollBtn.classList.add('active');
10571     -    828 +    922 +      console.log('‚úÖ Sync scroll enabled');
10572     -    829 +990 923      } else {
10573     -    830 +991     -      // Middle - proportional scroll
10574     -    831 +992     -      const scrollPercent = previewContainer.scrollTop / previewHeight;
10575     -    832 +993     -      editor.scrollTop = scrollPercent * editorHeight;
10576     -    833 +    924 +      syncScrollBtn.classList.remove('active');
10577     -    834 +    925 +      console.log('‚ùå Sync scroll disabled');
10578     -    835 +994 926      }
10579     -    836 +995     -
10580     -    837 +996     -    setTimeout(() => {
10581     -    838 +997     -      syncScrolling = false;
10582     -    839 +998     -    }, 10); // Reduced from 50ms for more responsive feel
10583     -    840 +999 927    });
10584     -    841 +1000     -});
10585     -    842 +1001 928  
10586     -    843 +1002     -// View mode button event listeners with sync button update
10587     -    844 +1003     -editorOnlyBtn.addEventListener('click', () => {
10588     -    845 +1004     -  setViewMode('editor-only');
10589     -    846 +1005     -  updateSyncScrollVisibility();
10590     -    847 +1006     -});
10591     -    848 +1007     -splitViewBtn.addEventListener('click', () => {
10592     -    849 +1008     -  setViewMode('split-view');
10593     -    850 +1009     -  updateSyncScrollVisibility();
10594     -    851 +1010     -});
10595     -    852 +1011     -previewOnlyBtn.addEventListener('click', () => {
10596     -    853 +1012     -  setViewMode('preview-only');
10597     -    854 +1013     -  updateSyncScrollVisibility();
10598     -    855 +1014     -});
10599     -    856 +    929 +  // Editor scroll handler with smooth sync
10600     -    857 +    930 +  editor.addEventListener('scroll', () => {
10601     -    858 +    931 +    if (!syncScrollEnabled || syncScrolling) return;
10602     -    859 +1015 932  
10603     -    860 +1016     -// Initialize visibility
10604     -    861 +1017     -updateSyncScrollVisibility();
10605     -    862 +    933 +    syncScrolling = true;
10606     -    863 +1018 934  
10607     -    864 +1019     -// Load saved theme FIRST, then initialize Mermaid with correct colors
10608     -    865 +1020     -const savedTheme = storageManager.get('selectedTheme');
10609     -    866 +1021     -if (savedTheme) {
10610     -    867 +1022     -  // Load theme first, then sync dropdown and reinit Mermaid
10611     -    868 +1023     -  themeManager
10612     -    869 +1024     -    .loadTheme(savedTheme)
10613     -    870 +1025     -    .then(() => {
10614     -    871 +1026     -      // Theme loaded successfully - sync dropdown
10615     -    872 +1027     -      themeSelector.value = savedTheme;
10616     -    873 +1028     -      console.log(`‚úÖ Theme restored: ${savedTheme}`);
10617     -    874 +    935 +    requestAnimationFrame(() => {
10618     -    875 +    936 +      const editorHeight = editor.scrollHeight - editor.clientHeight;
10619     -    876 +    937 +      const previewHeight = previewContainer.scrollHeight - previewContainer.clientHeight;
10620     -    877 +1029 938  
10621     -    878 +1030     -      // NOW initialize Mermaid with correct theme colors
10622     -    879 +1031     -      mermaidService.initialize();
10623     -    880 +    939 +      // Handle edge cases for perfect alignment
10624     -    881 +    940 +      if (editor.scrollTop <= 0) {
10625     -    882 +    941 +        // At top
10626     -    883 +    942 +        previewContainer.scrollTop = 0;
10627     -    884 +    943 +      } else if (editor.scrollTop >= editorHeight) {
10628     -    885 +    944 +        // At bottom
10629     -    886 +    945 +        previewContainer.scrollTop = previewHeight;
10630     -    887 +    946 +      } else {
10631     -    888 +    947 +        // Middle - proportional scroll
10632     -    889 +    948 +        const scrollPercent = editor.scrollTop / editorHeight;
10633     -    890 +    949 +        previewContainer.scrollTop = scrollPercent * previewHeight;
10634     -    891 +    950 +      }
10635     -    892 +1032 951  
10636     -    893 +1033     -      // Re-render to apply theme
10637     -    894 +1034     -      renderMarkdown();
10638     -    895 +1035     -    })
10639     -    896 +1036     -    .catch(err => {
10640     -    897 +1037     -      console.error('Failed to load saved theme:', err);
10641     -    898 +1038     -      // Fallback to default-light on error
10642     -    899 +1039     -      themeManager.loadTheme('default-light').then(() => {
10643     -    900 +1040     -        themeSelector.value = 'default-light';
10644     -    901 +1041     -        mermaidService.initialize();
10645     -    902 +1042     -        renderMarkdown();
10646     -    903 +1043     -      });
10647     -    904 +    952 +      setTimeout(() => {
10648     -    905 +    953 +        syncScrolling = false;
10649     -    906 +    954 +      }, 10); // Reduced from 50ms for more responsive feel
10650     -    907 +1044 955      });
10651     -    908 +1045     -} else {
10652     -    909 +1046     -  // No saved theme - initialize with default-light
10653     -    910 +1047     -  mermaidService.initialize();
10654     -    911 +1048     -  renderMarkdown();
10655     -    912 +1049     -}
10656     -    913 +    956 +  });
10657     -    914 +1050 957  
10658     -    915 +1051     -// Zoom functionality
10659     -    916 +1052     -function setZoom(zoomLevel) {
10660     -    917 +1053     -  // Constrain zoom level between 50% and 200%
10661     -    918 +1054     -  currentZoom = Math.max(50, Math.min(200, zoomLevel));
10662     -    919 +    958 +  // Preview container scroll handler with smooth sync
10663     -    920 +    959 +  previewContainer.addEventListener('scroll', () => {
10664     -    921 +    960 +    if (!syncScrollEnabled || syncScrolling) return;
10665     -    922 +1055 961  
10666     -    923 +1056     -  // Apply zoom using CSS transform with proper container sizing
10667     -    924 +1057     -  preview.style.transform = `scale(${currentZoom / 100})`;
10668     -    925 +1058     -  preview.style.transformOrigin = 'top left';
10669     -    926 +1059     -  preview.style.width = `${10000 / currentZoom}%`;
10670     -    927 +1060     -  preview.style.height = `${10000 / currentZoom}%`;
10671     -    928 +    962 +    syncScrolling = true;
10672     -    929 +1061 963  
10673     -    930 +1062     -  // Ensure scrollbar remains visible and functional
10674     -    931 +1063     -  const previewContainer = preview.parentElement;
10675     -    932 +1064     -  if (previewContainer) {
10676     -    933 +1065     -    previewContainer.style.overflow = 'auto';
10677     -    934 +    964 +    requestAnimationFrame(() => {
10678     -    935 +    965 +      const editorHeight = editor.scrollHeight - editor.clientHeight;
10679     -    936 +    966 +      const previewHeight = previewContainer.scrollHeight - previewContainer.clientHeight;
10680     -    937 +    967 +
10681     -    938 +    968 +      // Handle edge cases for perfect alignment
10682     -    939 +    969 +      if (previewContainer.scrollTop <= 0) {
10683     -    940 +    970 +        // At top
10684     -    941 +    971 +        editor.scrollTop = 0;
10685     -    942 +    972 +      } else if (previewContainer.scrollTop >= previewHeight) {
10686     -    943 +    973 +        // At bottom
10687     -    944 +    974 +        editor.scrollTop = editorHeight;
10688     -    945 +    975 +      } else {
10689     -    946 +    976 +        // Middle - proportional scroll
10690     -    947 +    977 +        const scrollPercent = previewContainer.scrollTop / previewHeight;
10691     -    948 +    978 +        editor.scrollTop = scrollPercent * editorHeight;
10692     -    949 +    979 +      }
10693     -    950 +    980 +
10694     -    951 +    981 +      setTimeout(() => {
10695     -    952 +    982 +        syncScrolling = false;
10696     -    953 +    983 +      }, 10); // Reduced from 50ms for more responsive feel
10697     -    954 +    984 +    });
10698     -    955 +    985 +  });
10699     -    956 +    986 +
10700     -    957 +    987 +  // View mode button event listeners with sync button update
10701     -    958 +    988 +  editorOnlyBtn.addEventListener('click', () => {
10702     -    959 +    989 +    setViewMode('editor-only');
10703     -    960 +    990 +    updateSyncScrollVisibility();
10704     -    961 +    991 +  });
10705     -    962 +    992 +  splitViewBtn.addEventListener('click', () => {
10706     -    963 +    993 +    setViewMode('split-view');
10707     -    964 +    994 +    updateSyncScrollVisibility();
10708     -    965 +    995 +  });
10709     -    966 +    996 +  previewOnlyBtn.addEventListener('click', () => {
10710     -    967 +    997 +    setViewMode('preview-only');
10711     -    968 +    998 +    updateSyncScrollVisibility();
10712     -    969 +    999 +  });
10713     -    970 +    1000 +
10714     -    971 +    1001 +  // Initialize visibility
10715     -    972 +    1002 +  updateSyncScrollVisibility();
10716     -    973 +    1003 +
10717     -    974 +    1004 +  // Load saved theme FIRST, then initialize Mermaid with correct colors
10718     -    975 +    1005 +  const savedTheme = storageManager.get('selectedTheme');
10719     -    976 +    1006 +  if (savedTheme) {
10720     -    977 +    1007 +    // Load theme first, then sync dropdown and reinit Mermaid
10721     -    978 +    1008 +    themeManager
10722     -    979 +    1009 +      .loadTheme(savedTheme)
10723     -    980 +    1010 +      .then(() => {
10724     -    981 +    1011 +        // Theme loaded successfully - sync dropdown
10725     -    982 +    1012 +        themeSelector.value = savedTheme;
10726     -    983 +    1013 +        console.log(`‚úÖ Theme restored: ${savedTheme}`);
10727     -    984 +    1014 +
10728     -    985 +    1015 +        // NOW initialize Mermaid with correct theme colors
10729     -    986 +    1016 +        mermaidService.initialize();
10730     -    987 +    1017 +
10731     -    988 +    1018 +        // Re-render to apply theme
10732     -    989 +    1019 +        renderMarkdown();
10733     -    990 +    1020 +      })
10734     -    991 +    1021 +      .catch(err => {
10735     -    992 +    1022 +        console.error('Failed to load saved theme:', err);
10736     -    993 +    1023 +        // Fallback to default-light on error
10737     -    994 +    1024 +        themeManager.loadTheme('default-light').then(() => {
10738     -    995 +    1025 +          themeSelector.value = 'default-light';
10739     -    996 +    1026 +          mermaidService.initialize();
10740     -    997 +    1027 +          renderMarkdown();
10741     -    998 +    1028 +        });
10742     -    999 +    1029 +      });
10743     -    1000 +    1030 +  } else {
10744     -    1001 +    1031 +    // No saved theme - initialize with default-light
10745     -    1002 +    1032 +    mermaidService.initialize();
10746     -    1003 +    1033 +    renderMarkdown();
10747     -    1004 +1066 1034    }
10748     -    1005 +1067 1035  
10749     -    1006 +1068     -  // Update display
10750     -    1007 +1069     -  zoomLevelDisplay.textContent = `${currentZoom}%`;
10751     -    1008 +    1036 +  // Zoom functionality
10752     -    1009 +    1037 +  function setZoom(zoomLevel) {
10753     -    1010 +    1038 +    // Constrain zoom level between 50% and 200%
10754     -    1011 +    1039 +    currentZoom = Math.max(50, Math.min(200, zoomLevel));
10755     -    1012 +1070 1040  
10756     -    1013 +1071     -  // Save to localStorage
10757     -    1014 +1072     -  storageManager.set('previewZoom', currentZoom.toString());
10758     -    1015 +1073     -}
10759     -    1016 +    1041 +    // Apply zoom using CSS transform with proper container sizing
10760     -    1017 +    1042 +    preview.style.transform = `scale(${currentZoom / 100})`;
10761     -    1018 +    1043 +    preview.style.transformOrigin = 'top left';
10762     -    1019 +    1044 +    preview.style.width = `${10000 / currentZoom}%`;
10763     -    1020 +    1045 +    preview.style.height = `${10000 / currentZoom}%`;
10764     -    1021 +1074 1046  
10765     -    1022 +1075     -function zoomIn() {
10766     -    1023 +1076     -  setZoom(currentZoom + 10);
10767     -    1024 +1077     -}
10768     -    1025 +    1047 +    // Ensure scrollbar remains visible and functional
10769     -    1026 +    1048 +    const previewContainer = preview.parentElement;
10770     -    1027 +    1049 +    if (previewContainer) {
10771     -    1028 +    1050 +      previewContainer.style.overflow = 'auto';
10772     -    1029 +    1051 +    }
10773     -    1030 +1078 1052  
10774     -    1031 +1079     -function zoomOut() {
10775     -    1032 +1080     -  setZoom(currentZoom - 10);
10776     -    1033 +1081     -}
10777     -    1034 +    1053 +    // Update display
10778     -    1035 +    1054 +    zoomLevelDisplay.textContent = `${currentZoom}%`;
10779     -    1036 +1082 1055  
10780     -    1037 +1083     -function resetZoom() {
10781     -    1038 +1084     -  setZoom(100);
10782     -    1039 +1085     -}
10783     -    1040 +    1056 +    // Save to localStorage
10784     -    1041 +    1057 +    storageManager.set('previewZoom', currentZoom.toString());
10785     -    1042 +    1058 +  }
10786     -    1043 +1086 1059  
10787     -    1044 +1087     -// Zoom event listeners
10788     -    1045 +1088     -zoomInBtn.addEventListener('click', zoomIn);
10789     -    1046 +1089     -zoomOutBtn.addEventListener('click', zoomOut);
10790     -    1047 +1090     -zoomResetBtn.addEventListener('click', resetZoom);
10791     -    1048 +    1060 +  function zoomIn() {
10792     -    1049 +    1061 +    setZoom(currentZoom + 10);
10793     -    1050 +    1062 +  }
10794     -    1051 +1091 1063  
10795     -    1052 +1092     -// Keyboard shortcuts for zoom (Ctrl/Cmd + Plus/Minus/0)
10796     -    1053 +1093     -preview.addEventListener('wheel', e => {
10797     -    1054 +1094     -  if (e.ctrlKey || e.metaKey) {
10798     -    1055 +    1064 +  function zoomOut() {
10799     -    1056 +    1065 +    setZoom(currentZoom - 10);
10800     -    1057 +    1066 +  }
10801     -    1058 +    1067 +
10802     -    1059 +    1068 +  function resetZoom() {
10803     -    1060 +    1069 +    setZoom(100);
10804     -    1061 +    1070 +  }
10805     -    1062 +    1071 +
10806     -    1063 +    1072 +  // Zoom event listeners
10807     -    1064 +    1073 +  zoomInBtn.addEventListener('click', zoomIn);
10808     -    1065 +    1074 +  zoomOutBtn.addEventListener('click', zoomOut);
10809     -    1066 +    1075 +  zoomResetBtn.addEventListener('click', resetZoom);
10810     -    1067 +    1076 +
10811     -    1068 +    1077 +  // Keyboard shortcuts for zoom (Ctrl/Cmd + Plus/Minus/0)
10812     -    1069 +    1078 +  preview.addEventListener('wheel', e => {
10813     -    1070 +    1079 +    if (e.ctrlKey || e.metaKey) {
10814     -    1071 +    1080 +      e.preventDefault();
10815     -    1072 +    1081 +      if (e.deltaY < 0) {
10816     -    1073 +    1082 +        zoomIn();
10817     -    1074 +    1083 +      } else {
10818     -    1075 +    1084 +        zoomOut();
10819     -    1076 +    1085 +      }
10820     -    1077 +    1086 +    }
10821     -    1078 +    1087 +  });
10822     -    1079 +    1088 +
10823     -    1080 +    1089 +  document.addEventListener('keydown', e => {
10824     -    1081 +    1090 +    if ((e.ctrlKey || e.metaKey) && e.target.tagName !== 'TEXTAREA') {
10825     -    1082 +    1091 +      if (e.key === '=' || e.key === '+') {
10826     -    1083 +    1092 +        e.preventDefault();
10827     -    1084 +    1093 +        zoomIn();
10828     -    1085 +    1094 +      } else if (e.key === '-') {
10829     -    1086 +    1095 +        e.preventDefault();
10830     -    1087 +    1096 +        zoomOut();
10831     -    1088 +    1097 +      } else if (e.key === '0') {
10832     -    1089 +    1098 +        e.preventDefault();
10833     -    1090 +    1099 +        resetZoom();
10834     -    1091 +    1100 +      }
10835     -    1092 +    1101 +    }
10836     -    1093 +    1102 +  });
10837     -    1094 +    1103 +
10838     -    1095 +    1104 +  // Load saved zoom level
10839     -    1096 +    1105 +  const savedZoom = storageManager.get('previewZoom');
10840     -    1097 +    1106 +  if (savedZoom) {
10841     -    1098 +    1107 +    currentZoom = parseInt(savedZoom, 10);
10842     -    1099 +    1108 +    setZoom(currentZoom);
10843     -    1100 +    1109 +  }
10844     -    1101 +    1110 +
10845     -    1102 +    1111 +  // Load saved view mode
10846     -    1103 +    1112 +  const savedViewMode = storageManager.get('viewMode') || 'split-view';
10847     -    1104 +    1113 +  setViewMode(savedViewMode);
10848     -    1105 +    1114 +
10849     -    1106 +    1115 +  // ==================== FOLDER BROWSER FUNCTIONALITY ====================
10850     -    1107 +    1116 +
10851     -    1108 +    1117 +  // Folder browser DOM elements
10852     -    1109 +    1118 +  const fileBrowser = document.getElementById('file-browser');
10853     -    1110 +    1119 +  const openFolderBtn = document.getElementById('open-folder-btn');
10854     -    1111 +    1120 +  const toggleSidebarBtn = document.getElementById('toggle-sidebar-btn');
10855     -    1112 +    1121 +  const closeBrowserBtn = document.getElementById('close-browser-btn');
10856     -    1113 +    1122 +  const floatingShowBtn = document.getElementById('floating-show-btn');
10857     -    1114 +    1123 +  const resizeHandle = document.getElementById('resize-handle');
10858     -    1115 +    1124 +  const fileTree = document.getElementById('file-tree');
10859     -    1116 +    1125 +  const currentFolderNameEl = document.getElementById('current-folder-name');
10860     -    1117 +    1126 +  const fileCountEl = document.getElementById('file-count');
10861     -    1118 +    1127 +
10862     -    1119 +    1128 +  // Folder browser state (using let to allow reassignment)
10863     -    1120 +    1129 +  let folderFiles = [];
10864     -    1121 +    1130 +  let activeFileHandle = null;
10865     -    1122 +    1131 +  let isResizing = false;
10866     -    1123 +    1132 +  let sidebarWidth = 280; // Default width
10867     -    1124 +    1133 +  const minWidth = 100; // Allow squeezing to very narrow
10868     -    1125 +    1134 +  const maxWidth = 600;
10869     -    1126 +    1135 +  const collapseThreshold = 80; // Auto-collapse at very left edge only
10870     -    1127 +    1136 +
10871     -    1128 +    1137 +  // Load saved sidebar width
10872     -    1129 +    1138 +  const savedWidth = storageManager.get('sidebarWidth');
10873     -    1130 +    1139 +  if (savedWidth) {
10874     -    1131 +    1140 +    sidebarWidth = parseInt(savedWidth, 10);
10875     -    1132 +    1141 +  }
10876     -    1133 +    1142 +
10877     -    1134 +    1143 +  // Resize functionality
10878     -    1135 +    1144 +  resizeHandle.addEventListener('mousedown', e => {
10879     -    1136 +    1145 +    isResizing = true;
10880     -    1137 +    1146 +    fileBrowser.classList.add('resizing');
10881     -    1138 +    1147 +    resizeHandle.classList.add('dragging');
10882     -    1139 +    1148 +    document.body.style.cursor = 'col-resize';
10883     -    1140 +    1149 +    document.body.style.userSelect = 'none';
10884     -    1141 +1095 1150      e.preventDefault();
10885     -    1142 +1096     -    if (e.deltaY < 0) {
10886     -    1143 +1097     -      zoomIn();
10887     -    1144 +1098     -    } else {
10888     -    1145 +1099     -      zoomOut();
10889     -    1146 +    1151 +  });
10890     -    1147 +    1152 +
10891     -    1148 +    1153 +  document.addEventListener('mousemove', e => {
10892     -    1149 +    1154 +    if (!isResizing) return;
10893     -    1150 +    1155 +
10894     -    1151 +    1156 +    const newWidth = e.clientX;
10895     -    1152 +    1157 +
10896     -    1153 +    1158 +    // Check if dragged to leftmost (auto-collapse)
10897     -    1154 +    1159 +    if (newWidth < collapseThreshold) {
10898     -    1155 +    1160 +      // Auto-collapse with smooth animation
10899     -    1156 +    1161 +      fileBrowser.classList.remove('resizing');
10900     -    1157 +    1162 +      fileBrowser.style.display = 'none';
10901     -    1158 +    1163 +      floatingShowBtn.style.display = 'block';
10902     -    1159 +    1164 +      isResizing = false;
10903     -    1160 +    1165 +      resizeHandle.classList.remove('dragging');
10904     -    1161 +    1166 +      document.body.style.cursor = '';
10905     -    1162 +    1167 +      document.body.style.userSelect = '';
10906     -    1163 +    1168 +      return;
10907     -    1164 +1100 1169      }
10908     -    1165 +1101     -  }
10909     -    1166 +1102     -});
10910     -    1167 +1103 1170  
10911     -    1168 +1104     -document.addEventListener('keydown', e => {
10912     -    1169 +1105     -  if ((e.ctrlKey || e.metaKey) && e.target.tagName !== 'TEXTAREA') {
10913     -    1170 +1106     -    if (e.key === '=' || e.key === '+') {
10914     -    1171 +1107     -      e.preventDefault();
10915     -    1172 +1108     -      zoomIn();
10916     -    1173 +1109     -    } else if (e.key === '-') {
10917     -    1174 +1110     -      e.preventDefault();
10918     -    1175 +1111     -      zoomOut();
10919     -    1176 +1112     -    } else if (e.key === '0') {
10920     -    1177 +1113     -      e.preventDefault();
10921     -    1178 +1114     -      resetZoom();
10922     -    1179 +    1171 +    // Constrain width
10923     -    1180 +    1172 +    if (newWidth >= minWidth && newWidth <= maxWidth) {
10924     -    1181 +    1173 +      sidebarWidth = newWidth;
10925     -    1182 +    1174 +      fileBrowser.style.width = `${sidebarWidth}px`;
10926     -    1183 +1115 1175      }
10927     -    1184 +1116     -  }
10928     -    1185 +1117     -});
10929     -    1186 +    1176 +  });
10930     -    1187 +1118 1177  
10931     -    1188 +1119     -// Load saved zoom level
10932     -    1189 +1120     -const savedZoom = storageManager.get('previewZoom');
10933     -    1190 +1121     -if (savedZoom) {
10934     -    1191 +1122     -  currentZoom = parseInt(savedZoom, 10);
10935     -    1192 +1123     -  setZoom(currentZoom);
10936     -    1193 +1124     -}
10937     -    1194 +    1178 +  document.addEventListener('mouseup', () => {
10938     -    1195 +    1179 +    if (isResizing) {
10939     -    1196 +    1180 +      isResizing = false;
10940     -    1197 +    1181 +      fileBrowser.classList.remove('resizing');
10941     -    1198 +    1182 +      resizeHandle.classList.remove('dragging');
10942     -    1199 +    1183 +      document.body.style.cursor = '';
10943     -    1200 +    1184 +      document.body.style.userSelect = '';
10944     -    1201 +1125 1185  
10945     -    1202 +1126     -// Load saved view mode
10946     -    1203 +1127     -const savedViewMode = storageManager.get('viewMode') || 'split-view';
10947     -    1204 +1128     -setViewMode(savedViewMode);
10948     -    1205 +    1186 +      // Save width
10949     -    1206 +    1187 +      storageManager.set('sidebarWidth', sidebarWidth.toString());
10950     -    1207 +    1188 +    }
10951     -    1208 +    1189 +  });
10952     -    1209 +1129 1190  
10953     -    1210 +1130     -// ==================== FOLDER BROWSER FUNCTIONALITY ====================
10954     -    1211 +    1191 +  // Open folder handler
10955     -    1212 +    1192 +  openFolderBtn.addEventListener('click', async () => {
10956     -    1213 +    1193 +    if (!folderBrowserService.isSupported()) {
10957     -    1214 +    1194 +      alert(
10958     -    1215 +    1195 +        'Folder browsing requires File System Access API.\n\n' +
10959     -    1216 +    1196 +        'Please use Chrome 86+ or Edge 86+.\n\n' +
10960     -    1217 +    1197 +        'Firefox and Safari are not currently supported.'
10961     -    1218 +    1198 +      );
10962     -    1219 +    1199 +      return;
10963     -    1220 +    1200 +    }
10964     -    1221 +1131 1201  
10965     -    1222 +1132     -// Folder browser DOM elements
10966     -    1223 +1133     -const fileBrowser = document.getElementById('file-browser');
10967     -    1224 +1134     -const openFolderBtn = document.getElementById('open-folder-btn');
10968     -    1225 +1135     -const toggleSidebarBtn = document.getElementById('toggle-sidebar-btn');
10969     -    1226 +1136     -const closeBrowserBtn = document.getElementById('close-browser-btn');
10970     -    1227 +1137     -const floatingShowBtn = document.getElementById('floating-show-btn');
10971     -    1228 +1138     -const resizeHandle = document.getElementById('resize-handle');
10972     -    1229 +1139     -const fileTree = document.getElementById('file-tree');
10973     -    1230 +1140     -const currentFolderNameEl = document.getElementById('current-folder-name');
10974     -    1231 +1141     -const fileCountEl = document.getElementById('file-count');
10975     -    1232 +    1202 +    const result = await folderBrowserService.openFolder();
10976     -    1233 +1142 1203  
10977     -    1234 +1143     -// Folder browser state (using let to allow reassignment)
10978     -    1235 +1144     -let folderFiles = [];
10979     -    1236 +1145     -let activeFileHandle = null;
10980     -    1237 +1146     -let isResizing = false;
10981     -    1238 +1147     -let sidebarWidth = 280; // Default width
10982     -    1239 +1148     -const minWidth = 100; // Allow squeezing to very narrow
10983     -    1240 +1149     -const maxWidth = 600;
10984     -    1241 +1150     -const collapseThreshold = 80; // Auto-collapse at very left edge only
10985     -    1242 +    1204 +    if (result.cancelled) {
10986     -    1243 +    1205 +      return; // User cancelled
10987     -    1244 +    1206 +    }
10988     -    1245 +1151 1207  
10989     -    1246 +1152     -// Load saved sidebar width
10990     -    1247 +1153     -const savedWidth = storageManager.get('sidebarWidth');
10991     -    1248 +1154     -if (savedWidth) {
10992     -    1249 +1155     -  sidebarWidth = parseInt(savedWidth, 10);
10993     -    1250 +1156     -}
10994     -    1251 +    1208 +    if (!result.success) {
10995     -    1252 +    1209 +      alert('Error opening folder: ' + result.error);
10996     -    1253 +    1210 +      return;
10997     -    1254 +    1211 +    }
10998     -    1255 +1157 1212  
10999     -    1256 +1158     -// Resize functionality
11000     -    1257 +1159     -resizeHandle.addEventListener('mousedown', e => {
11001     -    1258 +1160     -  isResizing = true;
11002     -    1259 +1161     -  fileBrowser.classList.add('resizing');
11003     -    1260 +1162     -  resizeHandle.classList.add('dragging');
11004     -    1261 +1163     -  document.body.style.cursor = 'col-resize';
11005     -    1262 +1164     -  document.body.style.userSelect = 'none';
11006     -    1263 +1165     -  e.preventDefault();
11007     -    1264 +1166     -});
11008     -    1265 +    1213 +    // Store files
11009     -    1266 +    1214 +    folderFiles = result.files;
11010     -    1267 +1167 1215  
11011     -    1268 +1168     -document.addEventListener('mousemove', e => {
11012     -    1269 +1169     -  if (!isResizing) return;
11013     -    1270 +    1216 +    // Show browser sidebar, hide floating button
11014     -    1271 +    1217 +    fileBrowser.style.display = 'flex';
11015     -    1272 +    1218 +    floatingShowBtn.style.display = 'none';
11016     -    1273 +1170 1219  
11017     -    1274 +1171     -  const newWidth = e.clientX;
11018     -    1275 +    1220 +    // Update UI
11019     -    1276 +    1221 +    currentFolderNameEl.textContent = result.folderName;
11020     -    1277 +    1222 +    fileCountEl.textContent = `${result.totalFiles} file${result.totalFiles !== 1 ? 's' : ''}`;
11021     -    1278 +1172 1223  
11022     -    1279 +1173     -  // Check if dragged to leftmost (auto-collapse)
11023     -    1280 +1174     -  if (newWidth < collapseThreshold) {
11024     -    1281 +1175     -    // Auto-collapse with smooth animation
11025     -    1282 +1176     -    fileBrowser.classList.remove('resizing');
11026     -    1283 +    1224 +    // Render tree
11027     -    1284 +    1225 +    renderFileTree(result.files);
11028     -    1285 +    1226 +
11029     -    1286 +    1227 +    console.log(`‚úÖ Loaded ${result.totalFiles} markdown files from ${result.folderName}`);
11030     -    1287 +    1228 +  });
11031     -    1288 +    1229 +
11032     -    1289 +    1230 +  // Toggle sidebar collapse/expand (keeps folder data)
11033     -    1290 +    1231 +  toggleSidebarBtn.addEventListener('click', () => {
11034     -    1291 +    1232 +    // Hide sidebar, show floating button
11035     -    1292 +1177 1233      fileBrowser.style.display = 'none';
11036     -    1293 +1178 1234      floatingShowBtn.style.display = 'block';
11037     -    1294 +1179     -    isResizing = false;
11038     -    1295 +1180     -    resizeHandle.classList.remove('dragging');
11039     -    1296 +1181     -    document.body.style.cursor = '';
11040     -    1297 +1182     -    document.body.style.userSelect = '';
11041     -    1298 +1183     -    return;
11042     -    1299 +1184     -  }
11043     -    1300 +    1235 +  });
11044     -    1301 +1185 1236  
11045     -    1302 +1186     -  // Constrain width
11046     -    1303 +1187     -  if (newWidth >= minWidth && newWidth <= maxWidth) {
11047     -    1304 +1188     -    sidebarWidth = newWidth;
11048     -    1305 +1189     -    fileBrowser.style.width = `${sidebarWidth}px`;
11049     -    1306 +1190     -  }
11050     -    1307 +1191     -});
11051     -    1308 +    1237 +  // Floating button - show sidebar
11052     -    1309 +    1238 +  floatingShowBtn.addEventListener('click', () => {
11053     -    1310 +    1239 +    // Show sidebar, hide floating button
11054     -    1311 +    1240 +    fileBrowser.style.display = 'flex';
11055     -    1312 +    1241 +    floatingShowBtn.style.display = 'none';
11056     -    1313 +    1242 +  });
11057     -    1314 +1192 1243  
11058     -    1315 +1193     -document.addEventListener('mouseup', () => {
11059     -    1316 +1194     -  if (isResizing) {
11060     -    1317 +1195     -    isResizing = false;
11061     -    1318 +1196     -    fileBrowser.classList.remove('resizing');
11062     -    1319 +1197     -    resizeHandle.classList.remove('dragging');
11063     -    1320 +1198     -    document.body.style.cursor = '';
11064     -    1321 +1199     -    document.body.style.userSelect = '';
11065     -    1322 +    1244 +  // Close browser handler (clears all folder data)
11066     -    1323 +    1245 +  closeBrowserBtn.addEventListener('click', () => {
11067     -    1324 +    1246 +    // Hide everything AND clear data
11068     -    1325 +    1247 +    fileBrowser.style.display = 'none';
11069     -    1326 +    1248 +    floatingShowBtn.style.display = 'none';
11070     -    1327 +    1249 +    folderFiles = [];
11071     -    1328 +    1250 +    activeFileHandle = null;
11072     -    1329 +    1251 +  });
11073     -    1330 +1200 1252  
11074     -    1331 +1201     -    // Save width
11075     -    1332 +1202     -    storageManager.set('sidebarWidth', sidebarWidth.toString());
11076     -    1333 +1203     -  }
11077     -    1334 +1204     -});
11078     -    1335 +    1253 +  // Render file tree
11079     -    1336 +    1254 +  function renderFileTree(items, container = fileTree, indent = 0) {
11080     -    1337 +    1255 +    // Clear container on first render
11081     -    1338 +    1256 +    if (indent === 0) {
11082     -    1339 +    1257 +      container.innerHTML = '';
11083     -    1340 +    1258 +    }
11084     -    1341 +1205 1259  
11085     -    1342 +1206     -// Open folder handler
11086     -    1343 +1207     -openFolderBtn.addEventListener('click', async () => {
11087     -    1344 +1208     -  if (!folderBrowserService.isSupported()) {
11088     -    1345 +1209     -    alert(
11089     -    1346 +1210     -      'Folder browsing requires File System Access API.\n\n' +
11090     -    1347 +1211     -      'Please use Chrome 86+ or Edge 86+.\n\n' +
11091     -    1348 +1212     -      'Firefox and Safari are not currently supported.'
11092     -    1349 +1213     -    );
11093     -    1350 +1214     -    return;
11094     -    1351 +1215     -  }
11095     -9742 1352  1216     -
11096     -9743     -1217     -  // Toggle sidebar collapse/expand (keeps folder data)
11097     -9744     -1218     -  toggleSidebarBtn.addEventListener('click', () => {
11098     -9745     -1219     -    // Hide sidebar, show floating button
11099     -9746     -    1173 +  // Check if dragged to leftmost (auto-collapse)
11100     -9747     -    1174 +  if (newWidth < collapseThreshold) {
11101     -9748     -    1175 +    // Auto-collapse with smooth animation
11102     -9749     -    1176 +    fileBrowser.classList.remove('resizing');
11103     -9750     -1220 1177      fileBrowser.style.display = 'none';
11104     -9751     -1221 1178      floatingShowBtn.style.display = 'block';
11105     -9752     -1222     -  });
11106     -9753     -    1179 +    isResizing = false;
11107     -9754     -    1180 +    resizeHandle.classList.remove('dragging');
11108     -9755     -    1181 +    document.body.style.cursor = '';
11109     -9756     -    1182 +    document.body.style.userSelect = '';
11110     -9757     -    1183 +    return;
11111     -9758     -    1184 +  }
11112     -9759     -1223 1185  
11113     -9760     -1224     -  // Floating button - show sidebar
11114     -9761     -1225     -  floatingShowBtn.addEventListener('click', () => {
11115     -9762     -1226     -    // Show sidebar, hide floating button
11116     -9763     -1227     -    fileBrowser.style.display = 'flex';
11117     -9764     -1228     -    floatingShowBtn.style.display = 'none';
11118     -9765     -1229     -  });
11119     -9766     -    1186 +  // Constrain width
11120     -9767     -    1187 +  if (newWidth >= minWidth && newWidth <= maxWidth) {
11121     -9768     -    1188 +    sidebarWidth = newWidth;
11122     -9769     -    1189 +    fileBrowser.style.width = `${sidebarWidth}px`;
11123     -9770     -    1190 +  }
11124     -9771     -    1191 +});
11125     -9772     -1230 1192  
11126     -9773     -1231     -  // Close browser handler (clears all folder data)
11127     -9774     -1232     -  closeBrowserBtn.addEventListener('click', () => {
11128     -9775     -1233     -    // Hide everything AND clear data
11129     -9776     -1234     -    fileBrowser.style.display = 'none';
11130     -9777     -1235     -    floatingShowBtn.style.display = 'none';
11131     -9778     -1236     -    folderFiles = [];
11132     -9779     -1237     -    activeFileHandle = null;
11133     -9780     -1238     -  });
11134     -9781     -    1193 +document.addEventListener('mouseup', () => {
11135     -9782     -    1194 +  if (isResizing) {
11136     -9783     -    1195 +    isResizing = false;
11137     -9784     -    1196 +    fileBrowser.classList.remove('resizing');
11138     -9785     -    1197 +    resizeHandle.classList.remove('dragging');
11139     -9786     -    1198 +    document.body.style.cursor = '';
11140     -9787     -    1199 +    document.body.style.userSelect = '';
11141     -9788     -1239 1200  
11142     -9789     -1240     -  // Render file tree
11143     -9790     -1241     -  function renderFileTree(items, container = fileTree, indent = 0) {
11144     -9791     -1242     -    // Clear container on first render
11145     -9792     -1243     -    if (indent === 0) {
11146     -9793     -1244     -      container.innerHTML = '';
11147     -9794     -1245     -    }
11148     -9795     -    1201 +    // Save width
11149     -9796     -    1202 +    storageManager.set('sidebarWidth', sidebarWidth.toString());
11150     -9797     -    1203 +  }
11151     -9798     -    1204 +});
11152     -9799     -1246 1205  
11153     -9800     -1247     -    if (items.length === 0 && indent === 0) {
11154     -9801     -1248     -      container.innerHTML = `
11155     -9802     -    1206 +// Open folder handler
11156     -9803     -    1207 +openFolderBtn.addEventListener('click', async () => {
11157     -9804     -    1208 +  if (!folderBrowserService.isSupported()) {
11158     -9805     -    1209 +    alert(
11159     -9806     -    1210 +      'Folder browsing requires File System Access API.\n\n' +
11160     -9807     -    1211 +      'Please use Chrome 86+ or Edge 86+.\n\n' +
11161     -9808     -    1212 +      'Firefox and Safari are not currently supported.'
11162     -9809     -    1213 +    );
11163     -9810     -    1214 +    return;
11164     -9811     -    1215 +  }
11165     -9812     -    1216 +
11166     -9813     -    1217 +  const result = await folderBrowserService.openFolder();
11167     -9814     -    1218 +
11168     -9815     -    1219 +  if (result.cancelled) {
11169     -9816     -    1220 +    return; // User cancelled
11170     -9817     -    1221 +  }
11171     -9818     -    1222 +
11172     -9819     -    1223 +  if (!result.success) {
11173     -9820     -    1224 +    alert('Error opening folder: ' + result.error);
11174     -9821     -    1225 +    return;
11175     -9822     -    1226 +  }
11176     -9823     -    1227 +
11177     -9824     -    1228 +  // Store files
11178     -9825     -    1229 +  folderFiles = result.files;
11179     -9826     -    1230 +
11180     -9827     -    1231 +  // Show browser sidebar, hide floating button
11181     -9828     -    1232 +  fileBrowser.style.display = 'flex';
11182     -9829     -    1233 +  floatingShowBtn.style.display = 'none';
11183     -9830     -    1234 +
11184     -9831     -    1235 +  // Update UI
11185     -9832     -    1236 +  currentFolderNameEl.textContent = result.folderName;
11186     -9833     -    1237 +  fileCountEl.textContent = `${result.totalFiles} file${result.totalFiles !== 1 ? 's' : ''}`;
11187     -9834     -    1238 +
11188     -9835     -    1239 +  // Render tree
11189     -9836     -    1240 +  renderFileTree(result.files);
11190     -9837     -    1241 +
11191     -9838     -    1242 +  console.log(`‚úÖ Loaded ${result.totalFiles} markdown files from ${result.folderName}`);
11192     -9839     -    1243 +});
11193     -9840     -    1244 +
11194     -9841     -    1245 +// Toggle sidebar collapse/expand (keeps folder data)
11195     -9842     -    1246 +toggleSidebarBtn.addEventListener('click', () => {
11196     -9843     -    1247 +  // Hide sidebar, show floating button
11197     -9844     -    1248 +  fileBrowser.style.display = 'none';
11198     -9845     -    1249 +  floatingShowBtn.style.display = 'block';
11199     -9846     -    1250 +});
11200     -9847     -    1251 +
11201     -9848     -    1252 +// Floating button - show sidebar
11202     -9849     -    1253 +floatingShowBtn.addEventListener('click', () => {
11203     -9850     -    1254 +  // Show sidebar, hide floating button
11204     -9851     -    1255 +  fileBrowser.style.display = 'flex';
11205     -9852     -    1256 +  floatingShowBtn.style.display = 'none';
11206     -9853     -    1257 +});
11207     -9854     -    1258 +
11208     -9855     -    1259 +// Close browser handler (clears all folder data)
11209     -9856     -    1260 +closeBrowserBtn.addEventListener('click', () => {
11210     -9857     -    1261 +  // Hide everything AND clear data
11211     -9858     -    1262 +  fileBrowser.style.display = 'none';
11212     -9859     -    1263 +  floatingShowBtn.style.display = 'none';
11213     -9860     -    1264 +  folderFiles = [];
11214     -9861     -    1265 +  activeFileHandle = null;
11215     -9862     -    1266 +});
11216     -9863     -    1267 +
11217     -9864     -    1268 +// Render file tree
11218     -9865     -    1269 +function renderFileTree(items, container = fileTree, indent = 0) {
11219     -9866     -    1270 +  // Clear container on first render
11220     -9867     -    1271 +  if (indent === 0) {
11221     -9868     -    1272 +    container.innerHTML = '';
11222     -9869     -    1273 +  }
11223     -9870     -    1274 +
11224     -9871     -    1275 +  if (items.length === 0 && indent === 0) {
11225     -9872     -    1276 +    container.innerHTML = `
11226     -9873     -1249 1277          <div class="empty-state">
11227     -9874     -1250 1278            <p>üìÇ No markdown files found</p>
11228     -9875     -1251 1279            <p class="hint">This folder doesn't contain any .md files</p>
11229     -9876     -1252 1280          </div>
11230     -9877     -1253 1281        `;
11231     -9878     -1254     -      return;
11232     -9879     -1255     -    }
11233     -9880     -    1282 +    return;
11234     -9881     -    1283 +  }
11235     -9882     -1256 1284  
11236     -9883     -1257     -    items.forEach(item => {
11237     -9884     -1258     -      if (item.type === 'directory') {
11238     -9885     -1259     -        const folderDiv = createFolderElement(item, indent);
11239     -9886     -1260     -        container.appendChild(folderDiv);
11240     -9887     -    1285 +  items.forEach(item => {
11241     -9888     -    1286 +    if (item.type === 'directory') {
11242     -9889     -    1287 +      const folderDiv = createFolderElement(item, indent);
11243     -9890     -    1288 +      container.appendChild(folderDiv);
11244     -9891     -1261 1289  
11245     -9892     -1262     -        if (item.expanded && item.children) {
11246     -9893     -1263     -          const childContainer = document.createElement('div');
11247     -9894     -1264     -          childContainer.className = 'tree-children';
11248     -9895     -1265     -          renderFileTree(item.children, childContainer, indent + 1);
11249     -9896     -1266     -          container.appendChild(childContainer);
11250     -9897     -1267     -        }
11251     -9898     -1268     -      } else if (item.type === 'file') {
11252     -9899     -1269     -        const fileDiv = createFileElement(item, indent);
11253     -9900     -1270     -        container.appendChild(fileDiv);
11254     -9901     -    1290 +      if (item.expanded && item.children) {
11255     -9902     -    1291 +        const childContainer = document.createElement('div');
11256     -9903     -    1292 +        childContainer.className = 'tree-children';
11257     -9904     -    1293 +        renderFileTree(item.children, childContainer, indent + 1);
11258     -9905     -    1294 +        container.appendChild(childContainer);
11259     -9906     -1271 1295        }
11260     -9907     -1272     -    });
11261     -    1353 +1217     -  const result = await folderBrowserService.openFolder();
11262     -    1354 +1218     -
11263     -    1355 +1219     -  if (result.cancelled) {
11264     -    1356 +1220     -    return; // User cancelled
11265     -    1357 +1221     -  }
11266     -    1358 +1222     -
11267     -    1359 +1223     -  if (!result.success) {
11268     -    1360 +1224     -    alert('Error opening folder: ' + result.error);
11269     -    1361 +1225     -    return;
11270     -    1362 +1226     -  }
11271     -    1363 +1227     -
11272     -    1364 +1228     -  // Store files
11273     -    1365 +1229     -  folderFiles = result.files;
11274     -    1366 +1230     -
11275     -    1367 +1231     -  // Show browser sidebar, hide floating button
11276     -    1368 +1232     -  fileBrowser.style.display = 'flex';
11277     -    1369 +1233     -  floatingShowBtn.style.display = 'none';
11278     -    1370 +1234     -
11279     -    1371 +1235     -  // Update UI
11280     -    1372 +1236     -  currentFolderNameEl.textContent = result.folderName;
11281     -    1373 +1237     -  fileCountEl.textContent = `${result.totalFiles} file${result.totalFiles !== 1 ? 's' : ''}`;
11282     -    1374 +1238     -
11283     -    1375 +1239     -  // Render tree
11284     -    1376 +1240     -  renderFileTree(result.files);
11285     -    1377 +1241     -
11286     -    1378 +1242     -  console.log(`‚úÖ Loaded ${result.totalFiles} markdown files from ${result.folderName}`);
11287     -    1379 +1243     -});
11288     -    1380 +1244     -
11289     -    1381 +1245     -// Toggle sidebar collapse/expand (keeps folder data)
11290     -    1382 +1246     -toggleSidebarBtn.addEventListener('click', () => {
11291     -    1383 +1247     -  // Hide sidebar, show floating button
11292     -    1384 +1248     -  fileBrowser.style.display = 'none';
11293     -    1385 +1249     -  floatingShowBtn.style.display = 'block';
11294     -    1386 +1250     -});
11295     -    1387 +1251     -
11296     -    1388 +1252     -// Floating button - show sidebar
11297     -    1389 +1253     -floatingShowBtn.addEventListener('click', () => {
11298     -    1390 +1254     -  // Show sidebar, hide floating button
11299     -    1391 +1255     -  fileBrowser.style.display = 'flex';
11300     -    1392 +1256     -  floatingShowBtn.style.display = 'none';
11301     -    1393 +1257     -});
11302     -    1394 +1258     -
11303     -    1395 +1259     -// Close browser handler (clears all folder data)
11304     -    1396 +1260     -closeBrowserBtn.addEventListener('click', () => {
11305     -    1397 +1261     -  // Hide everything AND clear data
11306     -    1398 +1262     -  fileBrowser.style.display = 'none';
11307     -    1399 +1263     -  floatingShowBtn.style.display = 'none';
11308     -    1400 +1264     -  folderFiles = [];
11309     -    1401 +1265     -  activeFileHandle = null;
11310     -    1402 +1266     -});
11311     -    1403 +1267     -
11312     -    1404 +1268     -// Render file tree
11313     -    1405 +1269     -function renderFileTree(items, container = fileTree, indent = 0) {
11314     -    1406 +1270     -  // Clear container on first render
11315     -    1407 +1271     -  if (indent === 0) {
11316     -    1408 +1272     -    container.innerHTML = '';
11317     -9908 1409  1273     -  }
11318     -9909 1410  1274     -
11319     -9910     -1275     -  // Create folder element
11320     -9911     -1276     -  function createFolderElement(item, indent) {
11321     -9912     -1277     -    const div = document.createElement('div');
11322     -9913     -1278     -    div.className = 'tree-item folder';
11323     -9914     -1279     -    div.style.paddingLeft = indent * 20 + 12 + 'px';
11324     -9915     -1280     -
11325     -9916     -1281     -    const icon = item.expanded ? 'üìÇ' : 'üìÅ';
11326     -9917     -1282     -    const folderIcon = document.createElement('span');
11327     -9918     -1283     -    folderIcon.className = 'folder-icon';
11328     -9919     -1284     -    folderIcon.textContent = icon;
11329     -9920     -1285     -
11330     -9921     -1286     -    const folderName = document.createElement('span');
11331     -9922     -1287     -    folderName.className = 'folder-name';
11332     -9923     -1288     -    folderName.textContent = item.name;
11333     -    1411 +1275     -  if (items.length === 0 && indent === 0) {
11334     -    1412 +1276     -    container.innerHTML = `
11335     -    1413 +    1260 +    if (items.length === 0 && indent === 0) {
11336     -    1414 +    1261 +      container.innerHTML = `
11337     -    1415 +1277 1262          <div class="empty-state">
11338     -    1416 +1278 1263            <p>üìÇ No markdown files found</p>
11339     -    1417 +1279 1264            <p class="hint">This folder doesn't contain any .md files</p>
11340     -    1418 +1280 1265          </div>
11341     -    1419 +1281 1266        `;
11342     -    1420 +1282     -    return;
11343     -    1421 +1283     -  }
11344     -    1422 +1284     -
11345     -    1423 +1285     -  items.forEach(item => {
11346     -    1424 +1286     -    if (item.type === 'directory') {
11347     -    1425 +1287     -      const folderDiv = createFolderElement(item, indent);
11348     -    1426 +1288     -      container.appendChild(folderDiv);
11349     -9924 1427  1289     -
11350     -9925     -1290     -    const fileCount = document.createElement('span');
11351     -9926     -1291     -    fileCount.className = 'file-count';
11352     -9927     -1292     -    fileCount.textContent = item.fileCount;
11353     -9928     -1293     -
11354     -9929     -1294     -    div.appendChild(folderIcon);
11355     -9930     -1295     -    div.appendChild(folderName);
11356     -9931     -1296     -    div.appendChild(fileCount);
11357     -9932     -1297     -
11358     -9933     -1298     -    div.addEventListener('click', e => {
11359     -9934     -1299     -      e.stopPropagation();
11360     -9935     -1300     -      toggleFolder(item);
11361     -9936     -1301     -    });
11362     -9937     -1302     -
11363     -9938     -1303     -    return div;
11364     -9939     -1304     -  }
11365     -9940     -1305     -
11366     -9941     -1306     -  // Create file element
11367     -9942     -1307     -  function createFileElement(item, indent) {
11368     -9943     -1308     -    const div = document.createElement('div');
11369     -9944     -1309     -    div.className = 'tree-item file';
11370     -9945     -1310     -    div.style.paddingLeft = indent * 20 + 12 + 'px';
11371     -9946     -1311     -
11372     -9947     -1312     -    // Mark as active if this is the current file
11373     -9948     -1313     -    if (activeFileHandle === item.handle) {
11374     -9949     -1314     -      div.classList.add('active');
11375     -9950     -    1296 +    } else if (item.type === 'file') {
11376     -9951     -    1297 +      const fileDiv = createFileElement(item, indent);
11377     -9952     -    1298 +      container.appendChild(fileDiv);
11378     -9953     -1315 1299      }
11379     -9954     -    1300 +  });
11380     -9955     -    1301 +}
11381     -9956     -1316 1302  
11382     -9957     -1317     -    const fileIcon = document.createElement('span');
11383     -9958     -1318     -    fileIcon.className = 'file-icon';
11384     -9959     -1319     -    fileIcon.textContent = 'üìÑ';
11385     -9960     -    1303 +// Create folder element
11386     -9961     -    1304 +function createFolderElement(item, indent) {
11387     -9962     -    1305 +  const div = document.createElement('div');
11388     -9963     -    1306 +  div.className = 'tree-item folder';
11389     -9964     -    1307 +  div.style.paddingLeft = indent * 20 + 12 + 'px';
11390     -9965     -1320 1308  
11391     -9966     -1321     -    const fileName = document.createElement('span');
11392     -9967     -1322     -    fileName.className = 'file-name';
11393     -9968     -1323     -    fileName.textContent = item.name;
11394     -9969     -    1309 +  const icon = item.expanded ? 'üìÇ' : 'üìÅ';
11395     -9970     -    1310 +  const folderIcon = document.createElement('span');
11396     -9971     -    1311 +  folderIcon.className = 'folder-icon';
11397     -9972     -    1312 +  folderIcon.textContent = icon;
11398     -9973     -1324 1313  
11399     -9974     -1325     -    div.appendChild(fileIcon);
11400     -9975     -1326     -    div.appendChild(fileName);
11401     -9976     -    1314 +  const folderName = document.createElement('span');
11402     -9977     -    1315 +  folderName.className = 'folder-name';
11403     -9978     -    1316 +  folderName.textContent = item.name;
11404     -9979     -1327 1317  
11405     -9980     -1328     -    div.addEventListener('click', async e => {
11406     -9981     -1329     -      e.stopPropagation();
11407     -9982     -1330     -      await loadFileFromBrowser(item);
11408     -9983     -1331     -    });
11409     -9984     -    1318 +  const fileCount = document.createElement('span');
11410     -9985     -    1319 +  fileCount.className = 'file-count';
11411     -9986     -    1320 +  fileCount.textContent = item.fileCount;
11412     -9987     -1332 1321  
11413     -9988     -1333     -    return div;
11414     -9989     -    1322 +  div.appendChild(folderIcon);
11415     -9990     -    1323 +  div.appendChild(folderName);
11416     -9991     -    1324 +  div.appendChild(fileCount);
11417     -9992     -    1325 +
11418     -9993     -    1326 +  div.addEventListener('click', e => {
11419     -9994     -    1327 +    e.stopPropagation();
11420     -9995     -    1328 +    toggleFolder(item);
11421     -9996     -    1329 +  });
11422     -9997     -    1330 +
11423     -9998     -    1331 +  return div;
11424     -9999     -    1332 +}
11425     -10000     -    1333 +
11426     -10001     -    1334 +// Create file element
11427     -10002     -    1335 +function createFileElement(item, indent) {
11428     -10003     -    1336 +  const div = document.createElement('div');
11429     -10004     -    1337 +  div.className = 'tree-item file';
11430     -10005     -    1338 +  div.style.paddingLeft = indent * 20 + 12 + 'px';
11431     -10006     -    1339 +
11432     -10007     -    1340 +  // Mark as active if this is the current file
11433     -10008     -    1341 +  if (activeFileHandle === item.handle) {
11434     -10009     -    1342 +    div.classList.add('active');
11435     -10010     -1334 1343    }
11436     -10011     -1335 1344  
11437     -10012     -1336     -  // Toggle folder expand/collapse
11438     -10013     -1337     -  function toggleFolder(folder) {
11439     -10014     -1338     -    folder.expanded = !folder.expanded;
11440     -10015     -1339     -    renderFileTree(folderFiles);
11441     -10016     -    1345 +  const fileIcon = document.createElement('span');
11442     -10017     -    1346 +  fileIcon.className = 'file-icon';
11443     -10018     -    1347 +  fileIcon.textContent = 'üìÑ';
11444     -    1428 +1290     -      if (item.expanded && item.children) {
11445     -    1429 +1291     -        const childContainer = document.createElement('div');
11446     -    1430 +1292     -        childContainer.className = 'tree-children';
11447     -    1431 +1293     -        renderFileTree(item.children, childContainer, indent + 1);
11448     -    1432 +1294     -        container.appendChild(childContainer);
11449     -    1433 +1295     -      }
11450     -    1434 +1296     -    } else if (item.type === 'file') {
11451     -    1435 +1297     -      const fileDiv = createFileElement(item, indent);
11452     -    1436 +1298     -      container.appendChild(fileDiv);
11453     -    1437 +    1267 +      return;
11454     -    1438 +1299 1268      }
11455     -    1439 +1300     -  });
11456     -    1440 +1301     -}
11457     -    1441 +1302 1269  
11458     -    1442 +1303     -// Create folder element
11459     -    1443 +1304     -function createFolderElement(item, indent) {
11460     -    1444 +1305     -  const div = document.createElement('div');
11461     -    1445 +1306     -  div.className = 'tree-item folder';
11462     -    1446 +1307     -  div.style.paddingLeft = indent * 20 + 12 + 'px';
11463     -    1447 +    1270 +    items.forEach(item => {
11464     -    1448 +    1271 +      if (item.type === 'directory') {
11465     -    1449 +    1272 +        const folderDiv = createFolderElement(item, indent);
11466     -    1450 +    1273 +        container.appendChild(folderDiv);
11467     -    1451 +1308 1274  
11468     -    1452 +1309     -  const icon = item.expanded ? 'üìÇ' : 'üìÅ';
11469     -    1453 +1310     -  const folderIcon = document.createElement('span');
11470     -    1454 +1311     -  folderIcon.className = 'folder-icon';
11471     -    1455 +1312     -  folderIcon.textContent = icon;
11472     -    1456 +1313     -
11473     -    1457 +1314     -  const folderName = document.createElement('span');
11474     -    1458 +1315     -  folderName.className = 'folder-name';
11475     -    1459 +1316     -  folderName.textContent = item.name;
11476     -    1460 +1317     -
11477     -    1461 +1318     -  const fileCount = document.createElement('span');
11478     -    1462 +1319     -  fileCount.className = 'file-count';
11479     -    1463 +1320     -  fileCount.textContent = item.fileCount;
11480     -    1464 +1321     -
11481     -    1465 +1322     -  div.appendChild(folderIcon);
11482     -    1466 +1323     -  div.appendChild(folderName);
11483     -    1467 +1324     -  div.appendChild(fileCount);
11484     -    1468 +1325     -
11485     -    1469 +1326     -  div.addEventListener('click', e => {
11486     -    1470 +1327     -    e.stopPropagation();
11487     -    1471 +1328     -    toggleFolder(item);
11488     -    1472 +1329     -  });
11489     -    1473 +1330     -
11490     -    1474 +1331     -  return div;
11491     -    1475 +1332     -}
11492     -    1476 +1333     -
11493     -    1477 +1334     -// Create file element
11494     -    1478 +1335     -function createFileElement(item, indent) {
11495     -    1479 +1336     -  const div = document.createElement('div');
11496     -    1480 +1337     -  div.className = 'tree-item file';
11497     -    1481 +1338     -  div.style.paddingLeft = indent * 20 + 12 + 'px';
11498     -    1482 +1339     -
11499     -    1483 +1340     -  // Mark as active if this is the current file
11500     -    1484 +1341     -  if (activeFileHandle === item.handle) {
11501     -    1485 +1342     -    div.classList.add('active');
11502     -    1486 +    1275 +        if (item.expanded && item.children) {
11503     -    1487 +    1276 +          const childContainer = document.createElement('div');
11504     -    1488 +    1277 +          childContainer.className = 'tree-children';
11505     -    1489 +    1278 +          renderFileTree(item.children, childContainer, indent + 1);
11506     -    1490 +    1279 +          container.appendChild(childContainer);
11507     -    1491 +    1280 +        }
11508     -    1492 +    1281 +      } else if (item.type === 'file') {
11509     -    1493 +    1282 +        const fileDiv = createFileElement(item, indent);
11510     -    1494 +    1283 +        container.appendChild(fileDiv);
11511     -    1495 +    1284 +      }
11512     -    1496 +    1285 +    });
11513     -    1497 +1343 1286    }
11514     -    1498 +1344 1287  
11515     -    1499 +1345     -  const fileIcon = document.createElement('span');
11516     -    1500 +1346     -  fileIcon.className = 'file-icon';
11517     -    1501 +1347     -  fileIcon.textContent = 'üìÑ';
11518     -    1502 +    1288 +  // Create folder element
11519     -    1503 +    1289 +  function createFolderElement(item, indent) {
11520     -    1504 +    1290 +    const div = document.createElement('div');
11521     -    1505 +    1291 +    div.className = 'tree-item folder';
11522     -    1506 +    1292 +    div.style.paddingLeft = indent * 20 + 12 + 'px';
11523     -    1507 +1348 1293  
11524     -    1508 +1349     -  const fileName = document.createElement('span');
11525     -    1509 +1350     -  fileName.className = 'file-name';
11526     -    1510 +1351     -  fileName.textContent = item.name;
11527     -    1511 +    1294 +    const icon = item.expanded ? 'üìÇ' : 'üìÅ';
11528     -    1512 +    1295 +    const folderIcon = document.createElement('span');
11529     -    1513 +    1296 +    folderIcon.className = 'folder-icon';
11530     -    1514 +    1297 +    folderIcon.textContent = icon;
11531     -    1515 +1352 1298  
11532     -    1516 +1353     -  div.appendChild(fileIcon);
11533     -    1517 +1354     -  div.appendChild(fileName);
11534     -    1518 +    1299 +    const folderName = document.createElement('span');
11535     -    1519 +    1300 +    folderName.className = 'folder-name';
11536     -    1520 +    1301 +    folderName.textContent = item.name;
11537     -    1521 +1355 1302  
11538     -    1522 +1356     -  div.addEventListener('click', async e => {
11539     -    1523 +1357     -    e.stopPropagation();
11540     -    1524 +1358     -    await loadFileFromBrowser(item);
11541     -    1525 +1359     -  });
11542     -    1526 +    1303 +    const fileCount = document.createElement('span');
11543     -    1527 +    1304 +    fileCount.className = 'file-count';
11544     -    1528 +    1305 +    fileCount.textContent = item.fileCount;
11545     -    1529 +1360 1306  
11546     -    1530 +1361     -  return div;
11547     -    1531 +1362     -}
11548     -    1532 +    1307 +    div.appendChild(folderIcon);
11549     -    1533 +    1308 +    div.appendChild(folderName);
11550     -    1534 +    1309 +    div.appendChild(fileCount);
11551     -    1535 +1363 1310  
11552     -    1536 +1364     -// Toggle folder expand/collapse
11553     -    1537 +1365     -function toggleFolder(folder) {
11554     -    1538 +1366     -  folder.expanded = !folder.expanded;
11555     -    1539 +1367     -  renderFileTree(folderFiles);
11556     -    1540 +1368     -}
11557     -    1541 +    1311 +    div.addEventListener('click', e => {
11558     -    1542 +    1312 +      e.stopPropagation();
11559     -    1543 +    1313 +      toggleFolder(item);
11560     -    1544 +    1314 +    });
11561     -    1545 +1369 1315  
11562     -    1546 +1370     -// Load file from browser
11563     -    1547 +1371     -async function loadFileFromBrowser(fileItem) {
11564     -    1548 +1372     -  const result = await folderBrowserService.readFile(fileItem.handle);
11565     -    1549 +1373     -
11566     -    1550 +1374     -  if (!result.success) {
11567     -    1551 +1375     -    alert('Error loading file: ' + result.error);
11568     -    1552 +1376     -    return;
11569     -    1553 +    1316 +    return div;
11570     -    1554 +1377 1317    }
11571     -    1555 +1378 1318  
11572     -    1556 +1379     -  // Load content into editor
11573     -    1557 +1380     -  editor.value = result.content;
11574     -    1558 +    1319 +  // Create file element
11575     -    1559 +    1320 +  function createFileElement(item, indent) {
11576     -    1560 +    1321 +    const div = document.createElement('div');
11577     -    1561 +    1322 +    div.className = 'tree-item file';
11578     -    1562 +    1323 +    div.style.paddingLeft = indent * 20 + 12 + 'px';
11579     -    1563 +1381 1324  
11580     -    1564 +1382     -  // Mark as active file
11581     -    1565 +1383     -  activeFileHandle = fileItem.handle;
11582     -    1566 +    1325 +    // Mark as active if this is the current file
11583     -    1567 +    1326 +    if (activeFileHandle === item.handle) {
11584     -    1568 +    1327 +      div.classList.add('active');
11585     -    1569 +    1328 +    }
11586     -    1570 +1384 1329  
11587     -    1571 +1385     -  // Re-render tree to update active state
11588     -    1572 +1386     -  renderFileTree(folderFiles);
11589     -    1573 +    1330 +    const fileIcon = document.createElement('span');
11590     -    1574 +    1331 +    fileIcon.className = 'file-icon';
11591     -    1575 +    1332 +    fileIcon.textContent = 'üìÑ';
11592     -    1576 +1387 1333  
11593     -    1577 +1388     -  // Render markdown
11594     -    1578 +1389     -  renderMarkdown();
11595     -    1579 +    1334 +    const fileName = document.createElement('span');
11596     -    1580 +    1335 +    fileName.className = 'file-name';
11597     -    1581 +    1336 +    fileName.textContent = item.name;
11598     -    1582 +1390 1337  
11599     -    1583 +1391     -  console.log(`‚úÖ Loaded file: ${fileItem.name} (${result.size} bytes)`);
11600     -    1584 +1392     -}
11601     -    1585 +    1338 +    div.appendChild(fileIcon);
11602     -    1586 +    1339 +    div.appendChild(fileName);
11603     -    1587 +1393 1340  
11604     -    1588 +1394     -// Expose renderMarkdown globally for theme changes
11605     -    1589 +1395     -globalRenderMarkdown = renderMarkdown;
11606     -    1590 +    1341 +    div.addEventListener('click', async e => {
11607     -    1591 +    1342 +      e.stopPropagation();
11608     -    1592 +    1343 +      await loadFileFromBrowser(item);
11609     -    1593 +    1344 +    });
11610     -    1594 +    1345 +
11611     -    1595 +    1346 +    return div;
11612     -    1596 +    1347 +  }
11613     -10019 1597      1348 +
11614     -10020     -    1349 +  const fileName = document.createElement('span');
11615     -10021     -    1350 +  fileName.className = 'file-name';
11616     -10022     -    1351 +  fileName.textContent = item.name;
11617     -10023     -    1352 +
11618     -10024     -    1353 +  div.appendChild(fileIcon);
11619     -10025     -    1354 +  div.appendChild(fileName);
11620     -10026     -    1355 +
11621     -10027     -    1356 +  div.addEventListener('click', async e => {
11622     -10028     -    1357 +    e.stopPropagation();
11623     -10029     -    1358 +    await loadFileFromBrowser(item);
11624     -10030     -    1359 +  });
11625     -10031     -    1360 +
11626     -10032     -    1361 +  return div;
11627     -10033     -    1362 +}
11628     -    1598 +    1349 +  // Toggle folder expand/collapse
11629     -    1599 +    1350 +  function toggleFolder(folder) {
11630     -    1600 +    1351 +    folder.expanded = !folder.expanded;
11631     -    1601 +    1352 +    renderFileTree(folderFiles);
11632     -    1602 +    1353 +  }
11633     -    1603 +    1354 +
11634     -    1604 +    1355 +  // Load file from browser
11635     -    1605 +    1356 +  async function loadFileFromBrowser(fileItem) {
11636     -    1606 +    1357 +    const result = await folderBrowserService.readFile(fileItem.handle);
11637     -    1607 +    1358 +
11638     -    1608 +    1359 +    if (!result.success) {
11639     -    1609 +    1360 +      alert('Error loading file: ' + result.error);
11640     -    1610 +    1361 +      return;
11641     -    1611 +    1362 +    }
11642     -10034 1612      1363 +
11643     -10035     -    1364 +// Toggle folder expand/collapse
11644     -10036     -    1365 +function toggleFolder(folder) {
11645     -10037     -    1366 +  folder.expanded = !folder.expanded;
11646     -10038     -    1367 +  renderFileTree(folderFiles);
11647     -10039     -    1368 +}
11648     -    1613 +    1364 +    // Load content into editor
11649     -    1614 +    1365 +    editor.value = result.content;
11650     -    1615 +    1366 +
11651     -    1616 +    1367 +    // Mark as active file
11652     -    1617 +    1368 +    activeFileHandle = fileItem.handle;
11653     -10040 1618      1369 +
11654     -10041     -    1370 +// Load file from browser
11655     -10042     -    1371 +async function loadFileFromBrowser(fileItem) {
11656     -10043     -    1372 +  const result = await folderBrowserService.readFile(fileItem.handle);
11657     -10044     -    1373 +
11658     -10045     -    1374 +  if (!result.success) {
11659     -10046     -    1375 +    alert('Error loading file: ' + result.error);
11660     -10047     -    1376 +    return;
11661     -10048     -1340 1377    }
11662     -10049     -1341 1378  
11663     -10050     -1342     -  // Load file from browser
11664     -10051     -1343     -  async function loadFileFromBrowser(fileItem) {
11665     -10052     -1344     -    const result = await folderBrowserService.readFile(fileItem.handle);
11666     -10053     -    1379 +  // Load content into editor
11667     -10054     -    1380 +  editor.value = result.content;
11668     -10055     -1345 1381  
11669     -10056     -1346     -    if (!result.success) {
11670     -10057     -1347     -      alert('Error loading file: ' + result.error);
11671     -10058     -1348     -      return;
11672     -10059     -1349     -    }
11673     -10060     -    1382 +  // Mark as active file
11674     -10061     -    1383 +  activeFileHandle = fileItem.handle;
11675     -10062     -1350 1384  
11676     -10063     -1351     -    // Load content into editor
11677     -10064     -1352     -    editor.value = result.content;
11678     -10065     -    1385 +  // Re-render tree to update active state
11679     -10066     -    1386 +  renderFileTree(folderFiles);
11680     -10067     -1353 1387  
11681     -10068     -1354     -    // Mark as active file
11682     -10069     -1355     -    activeFileHandle = fileItem.handle;
11683     -10070     -    1388 +  // Render markdown
11684     -10071     -    1389 +  renderMarkdown();
11685     -10072     -1356 1390  
11686     -10073     -1357     -    // Re-render tree to update active state
11687     -10074     -1358     -    renderFileTree(folderFiles);
11688     -10075     -    1391 +  console.log(`‚úÖ Loaded file: ${fileItem.name} (${result.size} bytes)`);
11689     -10076     -    1392 +}
11690     -10077     -1359 1393  
11691     -10078     -1360     -    // Render markdown
11692     -10079     -1361     -    renderMarkdown();
11693     -10080     -1362     -
11694     -10081     -1363     -    console.log(`‚úÖ Loaded file: ${fileItem.name} (${result.size} bytes)`);
11695     -10082     -1364     -  }
11696     -10083     -1365     -
11697     -10084     -1366     -  // Expose renderMarkdown globally for theme changes
11698     -10085     -1367     -  globalRenderMarkdown = renderMarkdown;
11699     -10086     -    1394 +// Expose renderMarkdown globally for theme changes
11700     -10087     -    1395 +globalRenderMarkdown = renderMarkdown;
11701     -10088     -1368 1396  
11702     -10089     -1369 1397    // DON'T render immediately - wait for theme to load
11703     -10090     -1370 1398    // renderMarkdown will be called after theme loads above
11704     -10091     -1371 1399  
11705     -    1619 +    1370 +    // Re-render tree to update active state
11706     -    1620 +    1371 +    renderFileTree(folderFiles);
11707     -    1621 +    1372 +
11708     -    1622 +    1373 +    // Render markdown
11709     -    1623 +    1374 +    renderMarkdown();
11710     -    1624 +    1375 +
11711     -    1625 +    1376 +    console.log(`‚úÖ Loaded file: ${fileItem.name} (${result.size} bytes)`);
11712     -    1626 +    1377 +  }
11713     -    1627 +    1378 +
11714     -    1628 +    1379 +  // Expose renderMarkdown globally for theme changes
11715     -    1629 +    1380 +  globalRenderMarkdown = renderMarkdown;
11716     -    1630 +1396 1381  
11717     -    1631 +1397 1382    // DON'T render immediately - wait for theme to load
11718     -    1632 +1398 1383    // renderMarkdown will be called after theme loads above
11719     -    1633 +1399 1384  
11720     -10092 1634  
11721     -10093 1635  ```
11722     -10094 1636  
11723     -@@ -10134,4 +1676,4 @@ Please provide specific feedback on:
11724     -10134 1676  
11725     -10135 1677  ---
11726     -10136 1678  *Generated by AI Visual Code Review v2.0 - Unified Export Script*
11727     -10137     -*Files processed: 5/5 | Errors: 0 | Generated: 2025-12-09T01:34:12.899Z*
11728     -    1679 +*Files processed: 1/1 | Errors: 0 | Generated: 2025-12-09T01:35:49.634Z*
11729     -10138 1680  
11730     -
11731     -```
11732     -
11733     -
11734     -### ‚ú® `codebase_audit/migration_analysis.md` **[ADDED]**
     22 +### ‚ú® `codebase_audit/ui_ux_review.md` **[ADDED]**
11735  23  
11736  24  **Status:** ‚úÖ **NEW FILE** - This file has been newly created
11737  25  
11738  26  **Type:** Documentation üìñ
11739  27  
11740  28  ```diff
11741     -@@ -0,0 +1,21 @@
11742     -      1 +# ‚öñÔ∏è Impact Analysis: CDN to NPM Migration
     29 +@@ -0,0 +1,55 @@
     30 +      1 +# üé® UI/UX Review & Test Report
11743  31        2 +
11744     -      3 +## üöÄ Pros (Why we should do it)
11745     -      4 +1.  **Offline Capability (Major)**: The app will work without internet. Currently, if you are on a plane or have spotty Wi-Fi, the app is broken.
11746     -      5 +2.  **Reliability**: CDNs can go down (rare, but fatal). NPM packages are saved in your `node_modules` and bundled into your final `dist` folder.
11747     -      6 +3.  **Speed**: Instead of the browser opening 6 parallel connections to `cdn.jsdelivr.net` (costing DNS + SSL time for each), Vite bundles everything into a single efficient file.
11748     -      7 +4.  **Security**: You can run `npm audit` to check for specific vulnerability in your dependencies. CDN links are opaque.
11749     -      8 +5.  **Better Coding Experience**: Importing modules (`import { parse } from 'marked'`) gives you **Autocomplete** and **Type Checking** in VS Code.
     32 +      3 +**Date:** 2025-12-09
     33 +      4 +**Tester:** AI CodeBase Agent
     34 +      5 +**Environment:** Localhost (Vite), Desktop (1920x1080) & Mobile Simulation (400x800)
     35 +      6 +
     36 +      7 +## 1. üß™ Functional Testing Results
     37 +      8 +The application was tested against `tests/comprehensive_test.md` containing extensive edge cases.
11750  38        9 +
11751     -     10 +## ‚ö†Ô∏è Cons & Risks (What could go wrong)
11752     -     11 +1.  **Initial Breakage**: The current code relies on global variables (e.g., `window.marked`). We will need to refactor `script.js` to use `import` variables.
11753     -     12 +2.  **Prism Autoloader Complexity**: PrismJS's "Download languages on the fly" feature hates bundlers. It tries to fetch files from a URL. We will need to configure Vite to copy language files to the `dist` folder manually, or import common languages explicitly.
11754     -     13 +3.  **Local "Start" Requirement**: You won't be able to just "Double Click index.html" to run the app anymore. You **must** use a local server (`npm run dev` or `npm run preview`). *Note: This is already true for ES Modules usually.*
11755     -     14 +
11756     -     15 +## ‚ùì Will it become outdated?
11757     -     16 +**No.** In fact, the opposite.
11758     -     17 +*   **Current State:** Your HTML hardcodes `marked@11.0.0`. It is *already* outdated and will stay that way forever until you manually edit the HTML string.
11759     -     18 +*   **NPM State:** You run `npm update` and everything upgrades to the latest stable versions automatically. You have **more control**.
11760     -     19 +
11761     -     20 +## üõ°Ô∏è Verdict
11762     -     21 +**Proceed.** The "Prism Autoloader" risk is the only technical hurdle, but solvable. The benefits for an "Enterprise Grade" app (Security, Offline support) appear to outweigh the configuration effort.
11763     -     22  
     39 +     10 +| Feature Category | Status | Observations |
     40 +     11 +| :--- | :--- | :--- |
     41 +     12 +| **Markdown Parsing** | ‚úÖ PASS | Standard GFM (Headers, Lists, Bold/Italic) renders correctly. |
     42 +     13 +| **Math (KaTeX)** | ‚úÖ PASS | Complex formulas (Matrices, Integrals, Physics equations) render beautifully. Inline math spacing is correct. |
     43 +     14 +| **Mermaid Diagrams** | ‚úÖ PASS | Flowcharts and Graphs render. Theme colors apply correctly after refactor. |
     44 +     15 +| **Code Highlighting** | ‚úÖ PASS | Syntax highlighting works for JS, Python, HTML. Colors obey the selected theme. |
     45 +     16 +| **Responsiveness** | ‚ö†Ô∏è OK | Layout adjusts to mobile, but UX is suboptimal (see below). |
     46 +     17 +| **Theme Switching** | ‚úÖ PASS | Switching themes instantly updates the UI, Editors, and Diagrams without reload. |
     47 +     18 +
     48 +     19 +## 2. üëÅÔ∏è UI/UX Analysis
     49 +     20 +
     50 +     21 +### ‚úÖ Positives
     51 +     22 +*   **Visual Aesthetics:** The themes (Forest, Neon, Sunset) provide a very premium feel compared to standard "GitHub-like" viewers.
     52 +     23 +*   **Performance:** The new **Debounce** logic makes typing feel smooth even with the massive test file. No UI freezing.
     53 +     24 +*   **Math Support:** First-class LaTeX support is a killer feature for academic/technical users.
     54 +     25 +*   **Diagrams:** Mermaid integration is seamless.
     55 +     26 +
     56 +     27 +### üö© Flaws & Issues
     57 +     28 +1.  **Mobile Layout (Vertical Stacking):**
     58 +     29 +    *   *Issue:* On mobile, the Editor and Preview stack vertically. For long documents (like the test file), you have to scroll past 600 lines of editor to see the preview.
     59 +     30 +    *   *Impact:* High friction for mobile users.
     60 +     31 +    *   *Recommendation:* Implement a **Tabbed Interface** (Edit / Preview) for screens < 768px.
     61 +     32 +
     62 +     33 +2.  **Scroll Sync Jitter:**
     63 +     34 +    *   *Issue:* While scroll sync works, large images or diagrams in the preview can cause slight misalignment between the source text and rendered output.
     64 +     35 +    *   *Recommendation:* Implement "Intelligent Scroll Sync" using AST mapping (future enhancement).
     65 +     36 +
     66 +     37 +3.  **Toolbar Clutter:**
     67 +     38 +    *   *Issue:* The toolbar has many buttons (Open Folder, View Modes, Sync Scroll, Custom styling).
     68 +     39 +    *   *Recommendation:* Group less common actions into a "Settings" or "More" dropdown.
     69 +     40 +
     70 +     41 +4.  **Raw HTML Injection:**
     71 +     42 +    *   *Issue:* Raw HTML `<div style="...">` works (as seen in test), which is good for power users but risky if we ever allow loading untrusted files (XSS risk was mitigating via DOMPurify, so this is safe now, but styling might break layout).
     72 +     43 +
     73 +     44 +## 3. üöÄ Improvement Suggestions
     74 +     45 +
     75 +     46 +### Immediate (High Value)
     76 +     47 +1.  **Mobile Tabs:** Convert the mobile layout to a tabbed view to toggle between Editor and Preview.
     77 +     48 +2.  **Export Options:** Add "Export to PDF" button (functionality exists in code, needs UI visibility/polish). *Note: It is there but hidden or hard to find? Check `index.html`.*
     78 +     49 +
     79 +     50 +### Future
     80 +     51 +1.  **AST-Based Scroll Sync:** Use `unist` or similar to map line numbers to DOM elements for perfect scrolling.
     81 +     52 +2.  **Monaco Editor:** Replace the simple textarea with Monaco Editor (VS Code editor) for minimap, multi-cursor, and better syntax highlighting in input.
     82 +     53 +
     83 +     54 +## 4. üèÅ Verdict
     84 +     55 +The application is **Production Ready** for a V1 release. The migration to NPM makes it robust. The rendering quality is Enterprise Grade.
     85 +     56  
11764  86  
11765  87  ```
11766  88  
11767  89  
11768     -### üìÑ `index.html`
     90 +### ‚ú® `tests/comprehensive_test.md` **[ADDED]**
11769  91  
11770     -**Type:** HTML Template üåê
     92 +**Status:** ‚úÖ **NEW FILE** - This file has been newly created
     93 +
     94 +**Type:** Documentation üìñ
11771  95  
11772  96  ```diff
11773     -@@ -5,41 +5,6 @@
11774     -  5   5      <meta name="viewport" content="width=device-width, initial-scale=1.0" />
11775     -  6   6      <title>Markdown Viewer Pro</title>
11776     -  7   7  
11777     -  8     -    <!-- External Libraries -->
11778     -  9     -    <script src="https://cdn.jsdelivr.net/npm/marked@11.0.0/marked.min.js"></script>
11779     - 10     -    <script src="https://cdn.jsdelivr.net/npm/marked-footnote@1.2.2/dist/index.umd.min.js"></script>
11780     - 11     -    <!-- Prism.js with Autoloader Plugin - Enterprise-grade solution -->
11781     - 12     -    <!-- Supports 200+ languages with automatic dependency resolution -->
11782     - 13     -    <script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/prism.min.js"></script>
11783     - 14     -    <script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/plugins/autoloader/prism-autoloader.min.js"></script>
11784     - 15     -    <script src="https://cdn.jsdelivr.net/npm/mermaid@11.4.0/dist/mermaid.min.js" defer></script>
11785     - 16     -    <script
11786     - 17     -      src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.10.1/html2pdf.bundle.min.js"
11787     - 18     -      defer
11788     - 19     -    ></script>
11789     - 20     -    <link
11790     - 21     -      rel="stylesheet"
11791     - 22     -      href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism-tomorrow.min.css"
11792     - 23     -    />
11793     - 24     -    <!-- KaTeX for Math Formula Rendering -->
11794     - 25     -    <link
11795     - 26     -      rel="stylesheet"
11796     - 27     -      href="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/katex.min.css"
11797     - 28     -      integrity="sha384-n8MVd4RsNIU0tAv4ct0nTaAbDJwPJzDEaqSD1odI+WdtXRGWt2kTvGFasHpSy3SV"
11798     - 29     -      crossorigin="anonymous"
11799     - 30     -    />
11800     - 31     -    <script
11801     - 32     -      src="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/katex.min.js"
11802     - 33     -      integrity="sha384-XjKyOOlGwcjNTAIQHIpgOno0Hl1YQqzUOEleOLALmuqehneUG+vnGctmUb0ZY0l8"
11803     - 34     -      crossorigin="anonymous"
11804     - 35     -    ></script>
11805     - 36     -    <!-- KaTeX Auto-Render for LaTeX Environments -->
11806     - 37     -    <script
11807     - 38     -      src="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/contrib/auto-render.min.js"
11808     - 39     -      integrity="sha384-+VBxd3r6XgURycqtZ117nYw44OOcIax56Z4dCRWbxyPt0Koah1uHoK0o4+/RRE05"
11809     - 40     -      crossorigin="anonymous"
11810     - 41     -    ></script>
11811     - 42     -
11812     - 43   8      <!-- Main Styles -->
11813     - 44   9      <link rel="stylesheet" href="style.css" />
11814     - 45  10  
11815     - 46  11  
11816     -
11817     -```
11818     -
11819     -
11820     -### üìÑ `package-lock.json`
11821     -
11822     -**Type:** Configuration/Data File üìã
11823     -
11824     -```diff
11825     -@@ -10,7 +10,12 @@
11826     - 10  10        "license": "MIT",
11827     - 11  11        "dependencies": {
11828     - 12  12          "dompurify": "3.3.1",
11829     - 13     -        "marked-footnote": "1.4.0"
11830     -     13 +        "html2pdf.js": "0.12.1",
11831     -     14 +        "katex": "0.16.27",
11832     -     15 +        "marked": "17.0.1",
11833     -     16 +        "marked-footnote": "1.4.0",
11834     -     17 +        "mermaid": "11.12.2",
11835     -     18 +        "prismjs": "1.30.0"
11836     - 14  19        },
11837     - 15  20        "devDependencies": {
11838     - 16  21          "@vitest/coverage-v8": "4.0.8",
11839     -@@ -31,6 +36,28 @@
11840     - 31  36        "dev": true,
11841     - 32  37        "license": "MIT"
11842     - 33  38      },
11843     -     39 +    "node_modules/@antfu/install-pkg": {
11844     -     40 +      "version": "1.1.0",
11845     -     41 +      "resolved": "https://registry.npmjs.org/@antfu/install-pkg/-/install-pkg-1.1.0.tgz",
11846     -     42 +      "integrity": "sha512-MGQsmw10ZyI+EJo45CdSER4zEb+p31LpDAFp2Z3gkSd1yqVZGi0Ebx++YTEMonJy4oChEMLsxZ64j8FH6sSqtQ==",
11847     -     43 +      "license": "MIT",
11848     -     44 +      "dependencies": {
11849     -     45 +        "package-manager-detector": "^1.3.0",
11850     -     46 +        "tinyexec": "^1.0.1"
11851     -     47 +      },
11852     -     48 +      "funding": {
11853     -     49 +        "url": "https://github.com/sponsors/antfu"
11854     -     50 +      }
11855     -     51 +    },
11856     -     52 +    "node_modules/@antfu/install-pkg/node_modules/tinyexec": {
11857     -     53 +      "version": "1.0.2",
11858     -     54 +      "resolved": "https://registry.npmjs.org/tinyexec/-/tinyexec-1.0.2.tgz",
11859     -     55 +      "integrity": "sha512-W/KYk+NFhkmsYpuHq5JykngiOCnxeVL8v8dFnqxSD8qEEdRfXk1SDM6JzNqcERbcGYj9tMrDQBYV9cjgnunFIg==",
11860     -     56 +      "license": "MIT",
11861     -     57 +      "engines": {
11862     -     58 +        "node": ">=18"
11863     -     59 +      }
11864     -     60 +    },
11865     - 34  61      "node_modules/@asamuzakjp/css-color": {
11866     - 35  62        "version": "4.0.5",
11867     - 36  63        "resolved": "https://registry.npmjs.org/@asamuzakjp/css-color/-/css-color-4.0.5.tgz",
11868     -@@ -102,6 +129,15 @@
11869     -102 129          "node": ">=6.0.0"
11870     -103 130        }
11871     -104 131      },
11872     -    132 +    "node_modules/@babel/runtime": {
11873     -    133 +      "version": "7.28.4",
11874     -    134 +      "resolved": "https://registry.npmjs.org/@babel/runtime/-/runtime-7.28.4.tgz",
11875     -    135 +      "integrity": "sha512-Q/N6JNWvIvPnLDvjlE1OUBLPQHH6l3CltCEsHIujp45zQUSSh8K+gHnaEX45yAT1nyngnINhvWtzN+Nb9D8RAQ==",
11876     -    136 +      "license": "MIT",
11877     -    137 +      "engines": {
11878     -    138 +        "node": ">=6.9.0"
11879     -    139 +      }
11880     -    140 +    },
11881     -105 141      "node_modules/@babel/types": {
11882     -106 142        "version": "7.28.5",
11883     -107 143        "resolved": "https://registry.npmjs.org/@babel/types/-/types-7.28.5.tgz",
11884     -@@ -126,6 +162,51 @@
11885     -126 162          "node": ">=18"
11886     -127 163        }
11887     -128 164      },
11888     -    165 +    "node_modules/@braintree/sanitize-url": {
11889     -    166 +      "version": "7.1.1",
11890     -    167 +      "resolved": "https://registry.npmjs.org/@braintree/sanitize-url/-/sanitize-url-7.1.1.tgz",
11891     -    168 +      "integrity": "sha512-i1L7noDNxtFyL5DmZafWy1wRVhGehQmzZaz1HiN5e7iylJMSZR7ekOV7NsIqa5qBldlLrsKv4HbgFUVlQrz8Mw==",
11892     -    169 +      "license": "MIT"
11893     -    170 +    },
11894     -    171 +    "node_modules/@chevrotain/cst-dts-gen": {
11895     -    172 +      "version": "11.0.3",
11896     -    173 +      "resolved": "https://registry.npmjs.org/@chevrotain/cst-dts-gen/-/cst-dts-gen-11.0.3.tgz",
11897     -    174 +      "integrity": "sha512-BvIKpRLeS/8UbfxXxgC33xOumsacaeCKAjAeLyOn7Pcp95HiRbrpl14S+9vaZLolnbssPIUuiUd8IvgkRyt6NQ==",
11898     -    175 +      "license": "Apache-2.0",
11899     -    176 +      "dependencies": {
11900     -    177 +        "@chevrotain/gast": "11.0.3",
11901     -    178 +        "@chevrotain/types": "11.0.3",
11902     -    179 +        "lodash-es": "4.17.21"
11903     -    180 +      }
11904     -    181 +    },
11905     -    182 +    "node_modules/@chevrotain/gast": {
11906     -    183 +      "version": "11.0.3",
11907     -    184 +      "resolved": "https://registry.npmjs.org/@chevrotain/gast/-/gast-11.0.3.tgz",
11908     -    185 +      "integrity": "sha512-+qNfcoNk70PyS/uxmj3li5NiECO+2YKZZQMbmjTqRI3Qchu8Hig/Q9vgkHpI3alNjr7M+a2St5pw5w5F6NL5/Q==",
11909     -    186 +      "license": "Apache-2.0",
11910     -    187 +      "dependencies": {
11911     -    188 +        "@chevrotain/types": "11.0.3",
11912     -    189 +        "lodash-es": "4.17.21"
11913     -    190 +      }
11914     -    191 +    },
11915     -    192 +    "node_modules/@chevrotain/regexp-to-ast": {
11916     -    193 +      "version": "11.0.3",
11917     -    194 +      "resolved": "https://registry.npmjs.org/@chevrotain/regexp-to-ast/-/regexp-to-ast-11.0.3.tgz",
11918     -    195 +      "integrity": "sha512-1fMHaBZxLFvWI067AVbGJav1eRY7N8DDvYCTwGBiE/ytKBgP8azTdgyrKyWZ9Mfh09eHWb5PgTSO8wi7U824RA==",
11919     -    196 +      "license": "Apache-2.0"
11920     -    197 +    },
11921     -    198 +    "node_modules/@chevrotain/types": {
11922     -    199 +      "version": "11.0.3",
11923     -    200 +      "resolved": "https://registry.npmjs.org/@chevrotain/types/-/types-11.0.3.tgz",
11924     -    201 +      "integrity": "sha512-gsiM3G8b58kZC2HaWR50gu6Y1440cHiJ+i3JUvcp/35JchYejb2+5MVeJK0iKThYpAa/P2PYFV4hoi44HD+aHQ==",
11925     -    202 +      "license": "Apache-2.0"
11926     -    203 +    },
11927     -    204 +    "node_modules/@chevrotain/utils": {
11928     -    205 +      "version": "11.0.3",
11929     -    206 +      "resolved": "https://registry.npmjs.org/@chevrotain/utils/-/utils-11.0.3.tgz",
11930     -    207 +      "integrity": "sha512-YslZMgtJUyuMbZ+aKvfF3x1f5liK4mWNxghFRv7jqRR9C3R3fAOGTTKvxXDa2Y1s9zSbcpuO0cAxDYsc9SrXoQ==",
11931     -    208 +      "license": "Apache-2.0"
11932     -    209 +    },
11933     -129 210      "node_modules/@csstools/color-helpers": {
11934     -130 211        "version": "5.1.0",
11935     -131 212        "resolved": "https://registry.npmjs.org/@csstools/color-helpers/-/color-helpers-5.1.0.tgz",
11936     -@@ -899,6 +980,23 @@
11937     -899 980          "url": "https://github.com/sponsors/nzakas"
11938     -900 981        }
11939     -901 982      },
11940     -    983 +    "node_modules/@iconify/types": {
11941     -    984 +      "version": "2.0.0",
11942     -    985 +      "resolved": "https://registry.npmjs.org/@iconify/types/-/types-2.0.0.tgz",
11943     -    986 +      "integrity": "sha512-+wluvCrRhXrhyOmRDJ3q8mux9JkKy5SJ/v8ol2tu4FVjyYvtEzkc/3pK15ET6RKg4b4w4BmTk1+gsCUhf21Ykg==",
11944     -    987 +      "license": "MIT"
11945     -    988 +    },
11946     -    989 +    "node_modules/@iconify/utils": {
11947     -    990 +      "version": "3.1.0",
11948     -    991 +      "resolved": "https://registry.npmjs.org/@iconify/utils/-/utils-3.1.0.tgz",
11949     -    992 +      "integrity": "sha512-Zlzem1ZXhI1iHeeERabLNzBHdOa4VhQbqAcOQaMKuTuyZCpwKbC2R4Dd0Zo3g9EAc+Y4fiarO8HIHRAth7+skw==",
11950     -    993 +      "license": "MIT",
11951     -    994 +      "dependencies": {
11952     -    995 +        "@antfu/install-pkg": "^1.1.0",
11953     -    996 +        "@iconify/types": "^2.0.0",
11954     -    997 +        "mlly": "^1.8.0"
11955     -    998 +      }
11956     -    999 +    },
11957     -902 1000      "node_modules/@jridgewell/resolve-uri": {
11958     -903 1001        "version": "3.1.2",
11959     -904 1002        "resolved": "https://registry.npmjs.org/@jridgewell/resolve-uri/-/resolve-uri-3.1.2.tgz",
11960     -@@ -927,6 +1025,15 @@
11961     -927 1025          "@jridgewell/sourcemap-codec": "^1.4.14"
11962     -928 1026        }
11963     -929 1027      },
11964     -    1028 +    "node_modules/@mermaid-js/parser": {
11965     -    1029 +      "version": "0.6.3",
11966     -    1030 +      "resolved": "https://registry.npmjs.org/@mermaid-js/parser/-/parser-0.6.3.tgz",
11967     -    1031 +      "integrity": "sha512-lnjOhe7zyHjc+If7yT4zoedx2vo4sHaTmtkl1+or8BRTnCtDmcTpAjpzDSfCZrshM5bCoz0GyidzadJAH1xobA==",
11968     -    1032 +      "license": "MIT",
11969     -    1033 +      "dependencies": {
11970     -    1034 +        "langium": "3.3.1"
11971     -    1035 +      }
11972     -    1036 +    },
11973     -930 1037      "node_modules/@polka/url": {
11974     -931 1038        "version": "1.0.0-next.29",
11975     -932 1039        "resolved": "https://registry.npmjs.org/@polka/url/-/url-1.0.0-next.29.tgz",
11976     -@@ -1260,6 +1367,259 @@
11977     -1260 1367          "assertion-error": "^2.0.1"
11978     -1261 1368        }
11979     -1262 1369      },
11980     -    1370 +    "node_modules/@types/d3": {
11981     -    1371 +      "version": "7.4.3",
11982     -    1372 +      "resolved": "https://registry.npmjs.org/@types/d3/-/d3-7.4.3.tgz",
11983     -    1373 +      "integrity": "sha512-lZXZ9ckh5R8uiFVt8ogUNf+pIrK4EsWrx2Np75WvF/eTpJ0FMHNhjXk8CKEx/+gpHbNQyJWehbFaTvqmHWB3ww==",
11984     -    1374 +      "license": "MIT",
11985     -    1375 +      "dependencies": {
11986     -    1376 +        "@types/d3-array": "*",
11987     -    1377 +        "@types/d3-axis": "*",
11988     -    1378 +        "@types/d3-brush": "*",
11989     -    1379 +        "@types/d3-chord": "*",
11990     -    1380 +        "@types/d3-color": "*",
11991     -    1381 +        "@types/d3-contour": "*",
11992     -    1382 +        "@types/d3-delaunay": "*",
11993     -    1383 +        "@types/d3-dispatch": "*",
11994     -    1384 +        "@types/d3-drag": "*",
11995     -    1385 +        "@types/d3-dsv": "*",
11996     -    1386 +        "@types/d3-ease": "*",
11997     -    1387 +        "@types/d3-fetch": "*",
11998     -    1388 +        "@types/d3-force": "*",
11999     -    1389 +        "@types/d3-format": "*",
12000     -    1390 +        "@types/d3-geo": "*",
12001     -    1391 +        "@types/d3-hierarchy": "*",
12002     -    1392 +        "@types/d3-interpolate": "*",
12003     -    1393 +        "@types/d3-path": "*",
12004     -    1394 +        "@types/d3-polygon": "*",
12005     -    1395 +        "@types/d3-quadtree": "*",
12006     -    1396 +        "@types/d3-random": "*",
12007     -    1397 +        "@types/d3-scale": "*",
12008     -    1398 +        "@types/d3-scale-chromatic": "*",
12009     -    1399 +        "@types/d3-selection": "*",
12010     -    1400 +        "@types/d3-shape": "*",
12011     -    1401 +        "@types/d3-time": "*",
12012     -    1402 +        "@types/d3-time-format": "*",
12013     -    1403 +        "@types/d3-timer": "*",
12014     -    1404 +        "@types/d3-transition": "*",
12015     -    1405 +        "@types/d3-zoom": "*"
12016     -    1406 +      }
12017     -    1407 +    },
12018     -    1408 +    "node_modules/@types/d3-array": {
12019     -    1409 +      "version": "3.2.2",
12020     -    1410 +      "resolved": "https://registry.npmjs.org/@types/d3-array/-/d3-array-3.2.2.tgz",
12021     -    1411 +      "integrity": "sha512-hOLWVbm7uRza0BYXpIIW5pxfrKe0W+D5lrFiAEYR+pb6w3N2SwSMaJbXdUfSEv+dT4MfHBLtn5js0LAWaO6otw==",
12022     -    1412 +      "license": "MIT"
12023     -    1413 +    },
12024     -    1414 +    "node_modules/@types/d3-axis": {
12025     -    1415 +      "version": "3.0.6",
12026     -    1416 +      "resolved": "https://registry.npmjs.org/@types/d3-axis/-/d3-axis-3.0.6.tgz",
12027     -    1417 +      "integrity": "sha512-pYeijfZuBd87T0hGn0FO1vQ/cgLk6E1ALJjfkC0oJ8cbwkZl3TpgS8bVBLZN+2jjGgg38epgxb2zmoGtSfvgMw==",
12028     -    1418 +      "license": "MIT",
12029     -    1419 +      "dependencies": {
12030     -    1420 +        "@types/d3-selection": "*"
12031     -    1421 +      }
12032     -    1422 +    },
12033     -    1423 +    "node_modules/@types/d3-brush": {
12034     -    1424 +      "version": "3.0.6",
12035     -    1425 +      "resolved": "https://registry.npmjs.org/@types/d3-brush/-/d3-brush-3.0.6.tgz",
12036     -    1426 +      "integrity": "sha512-nH60IZNNxEcrh6L1ZSMNA28rj27ut/2ZmI3r96Zd+1jrZD++zD3LsMIjWlvg4AYrHn/Pqz4CF3veCxGjtbqt7A==",
12037     -    1427 +      "license": "MIT",
12038     -    1428 +      "dependencies": {
12039     -    1429 +        "@types/d3-selection": "*"
12040     -    1430 +      }
12041     -    1431 +    },
12042     -    1432 +    "node_modules/@types/d3-chord": {
12043     -    1433 +      "version": "3.0.6",
12044     -    1434 +      "resolved": "https://registry.npmjs.org/@types/d3-chord/-/d3-chord-3.0.6.tgz",
12045     -    1435 +      "integrity": "sha512-LFYWWd8nwfwEmTZG9PfQxd17HbNPksHBiJHaKuY1XeqscXacsS2tyoo6OdRsjf+NQYeB6XrNL3a25E3gH69lcg==",
12046     -    1436 +      "license": "MIT"
12047     -    1437 +    },
12048     -    1438 +    "node_modules/@types/d3-color": {
12049     -    1439 +      "version": "3.1.3",
12050     -    1440 +      "resolved": "https://registry.npmjs.org/@types/d3-color/-/d3-color-3.1.3.tgz",
12051     -    1441 +      "integrity": "sha512-iO90scth9WAbmgv7ogoq57O9YpKmFBbmoEoCHDB2xMBY0+/KVrqAaCDyCE16dUspeOvIxFFRI+0sEtqDqy2b4A==",
12052     -    1442 +      "license": "MIT"
12053     -    1443 +    },
12054     -    1444 +    "node_modules/@types/d3-contour": {
12055     -    1445 +      "version": "3.0.6",
12056     -    1446 +      "resolved": "https://registry.npmjs.org/@types/d3-contour/-/d3-contour-3.0.6.tgz",
12057     -    1447 +      "integrity": "sha512-BjzLgXGnCWjUSYGfH1cpdo41/hgdWETu4YxpezoztawmqsvCeep+8QGfiY6YbDvfgHz/DkjeIkkZVJavB4a3rg==",
12058     -    1448 +      "license": "MIT",
12059     -    1449 +      "dependencies": {
12060     -    1450 +        "@types/d3-array": "*",
12061     -    1451 +        "@types/geojson": "*"
12062     -    1452 +      }
12063     -    1453 +    },
12064     -    1454 +    "node_modules/@types/d3-delaunay": {
12065     -    1455 +      "version": "6.0.4",
12066     -    1456 +      "resolved": "https://registry.npmjs.org/@types/d3-delaunay/-/d3-delaunay-6.0.4.tgz",
12067     -    1457 +      "integrity": "sha512-ZMaSKu4THYCU6sV64Lhg6qjf1orxBthaC161plr5KuPHo3CNm8DTHiLw/5Eq2b6TsNP0W0iJrUOFscY6Q450Hw==",
12068     -    1458 +      "license": "MIT"
12069     -    1459 +    },
12070     -    1460 +    "node_modules/@types/d3-dispatch": {
12071     -    1461 +      "version": "3.0.7",
12072     -    1462 +      "resolved": "https://registry.npmjs.org/@types/d3-dispatch/-/d3-dispatch-3.0.7.tgz",
12073     -    1463 +      "integrity": "sha512-5o9OIAdKkhN1QItV2oqaE5KMIiXAvDWBDPrD85e58Qlz1c1kI/J0NcqbEG88CoTwJrYe7ntUCVfeUl2UJKbWgA==",
12074     -    1464 +      "license": "MIT"
12075     -    1465 +    },
12076     -    1466 +    "node_modules/@types/d3-drag": {
12077     -    1467 +      "version": "3.0.7",
12078     -    1468 +      "resolved": "https://registry.npmjs.org/@types/d3-drag/-/d3-drag-3.0.7.tgz",
12079     -    1469 +      "integrity": "sha512-HE3jVKlzU9AaMazNufooRJ5ZpWmLIoc90A37WU2JMmeq28w1FQqCZswHZ3xR+SuxYftzHq6WU6KJHvqxKzTxxQ==",
12080     -    1470 +      "license": "MIT",
12081     -    1471 +      "dependencies": {
12082     -    1472 +        "@types/d3-selection": "*"
12083     -    1473 +      }
12084     -    1474 +    },
12085     -    1475 +    "node_modules/@types/d3-dsv": {
12086     -    1476 +      "version": "3.0.7",
12087     -    1477 +      "resolved": "https://registry.npmjs.org/@types/d3-dsv/-/d3-dsv-3.0.7.tgz",
12088     -    1478 +      "integrity": "sha512-n6QBF9/+XASqcKK6waudgL0pf/S5XHPPI8APyMLLUHd8NqouBGLsU8MgtO7NINGtPBtk9Kko/W4ea0oAspwh9g==",
12089     -    1479 +      "license": "MIT"
12090     -    1480 +    },
12091     -    1481 +    "node_modules/@types/d3-ease": {
12092     -    1482 +      "version": "3.0.2",
12093     -    1483 +      "resolved": "https://registry.npmjs.org/@types/d3-ease/-/d3-ease-3.0.2.tgz",
12094     -    1484 +      "integrity": "sha512-NcV1JjO5oDzoK26oMzbILE6HW7uVXOHLQvHshBUW4UMdZGfiY6v5BeQwh9a9tCzv+CeefZQHJt5SRgK154RtiA==",
12095     -    1485 +      "license": "MIT"
12096     -    1486 +    },
12097     -    1487 +    "node_modules/@types/d3-fetch": {
12098     -    1488 +      "version": "3.0.7",
12099     -    1489 +      "resolved": "https://registry.npmjs.org/@types/d3-fetch/-/d3-fetch-3.0.7.tgz",
12100     -    1490 +      "integrity": "sha512-fTAfNmxSb9SOWNB9IoG5c8Hg6R+AzUHDRlsXsDZsNp6sxAEOP0tkP3gKkNSO/qmHPoBFTxNrjDprVHDQDvo5aA==",
12101     -    1491 +      "license": "MIT",
12102     -    1492 +      "dependencies": {
12103     -    1493 +        "@types/d3-dsv": "*"
12104     -    1494 +      }
12105     -    1495 +    },
12106     -    1496 +    "node_modules/@types/d3-force": {
12107     -    1497 +      "version": "3.0.10",
12108     -    1498 +      "resolved": "https://registry.npmjs.org/@types/d3-force/-/d3-force-3.0.10.tgz",
12109     -    1499 +      "integrity": "sha512-ZYeSaCF3p73RdOKcjj+swRlZfnYpK1EbaDiYICEEp5Q6sUiqFaFQ9qgoshp5CzIyyb/yD09kD9o2zEltCexlgw==",
12110     -    1500 +      "license": "MIT"
12111     -    1501 +    },
12112     -    1502 +    "node_modules/@types/d3-format": {
12113     -    1503 +      "version": "3.0.4",
12114     -    1504 +      "resolved": "https://registry.npmjs.org/@types/d3-format/-/d3-format-3.0.4.tgz",
12115     -    1505 +      "integrity": "sha512-fALi2aI6shfg7vM5KiR1wNJnZ7r6UuggVqtDA+xiEdPZQwy/trcQaHnwShLuLdta2rTymCNpxYTiMZX/e09F4g==",
12116     -    1506 +      "license": "MIT"
12117     -    1507 +    },
12118     -    1508 +    "node_modules/@types/d3-geo": {
12119     -    1509 +      "version": "3.1.0",
12120     -    1510 +      "resolved": "https://registry.npmjs.org/@types/d3-geo/-/d3-geo-3.1.0.tgz",
12121     -    1511 +      "integrity": "sha512-856sckF0oP/diXtS4jNsiQw/UuK5fQG8l/a9VVLeSouf1/PPbBE1i1W852zVwKwYCBkFJJB7nCFTbk6UMEXBOQ==",
12122     -    1512 +      "license": "MIT",
12123     -    1513 +      "dependencies": {
12124     -    1514 +        "@types/geojson": "*"
12125     -    1515 +      }
12126     -    1516 +    },
12127     -    1517 +    "node_modules/@types/d3-hierarchy": {
12128     -    1518 +      "version": "3.1.7",
12129     -    1519 +      "resolved": "https://registry.npmjs.org/@types/d3-hierarchy/-/d3-hierarchy-3.1.7.tgz",
12130     -    1520 +      "integrity": "sha512-tJFtNoYBtRtkNysX1Xq4sxtjK8YgoWUNpIiUee0/jHGRwqvzYxkq0hGVbbOGSz+JgFxxRu4K8nb3YpG3CMARtg==",
12131     -    1521 +      "license": "MIT"
12132     -    1522 +    },
12133     -    1523 +    "node_modules/@types/d3-interpolate": {
12134     -    1524 +      "version": "3.0.4",
12135     -    1525 +      "resolved": "https://registry.npmjs.org/@types/d3-interpolate/-/d3-interpolate-3.0.4.tgz",
12136     -    1526 +      "integrity": "sha512-mgLPETlrpVV1YRJIglr4Ez47g7Yxjl1lj7YKsiMCb27VJH9W8NVM6Bb9d8kkpG/uAQS5AmbA48q2IAolKKo1MA==",
12137     -    1527 +      "license": "MIT",
12138     -    1528 +      "dependencies": {
12139     -    1529 +        "@types/d3-color": "*"
12140     -    1530 +      }
12141     -    1531 +    },
12142     -    1532 +    "node_modules/@types/d3-path": {
12143     -    1533 +      "version": "3.1.1",
12144     -    1534 +      "resolved": "https://registry.npmjs.org/@types/d3-path/-/d3-path-3.1.1.tgz",
12145     -    1535 +      "integrity": "sha512-VMZBYyQvbGmWyWVea0EHs/BwLgxc+MKi1zLDCONksozI4YJMcTt8ZEuIR4Sb1MMTE8MMW49v0IwI5+b7RmfWlg==",
12146     -    1536 +      "license": "MIT"
12147     -    1537 +    },
12148     -    1538 +    "node_modules/@types/d3-polygon": {
12149     -    1539 +      "version": "3.0.2",
12150     -    1540 +      "resolved": "https://registry.npmjs.org/@types/d3-polygon/-/d3-polygon-3.0.2.tgz",
12151     -    1541 +      "integrity": "sha512-ZuWOtMaHCkN9xoeEMr1ubW2nGWsp4nIql+OPQRstu4ypeZ+zk3YKqQT0CXVe/PYqrKpZAi+J9mTs05TKwjXSRA==",
12152     -    1542 +      "license": "MIT"
12153     -    1543 +    },
12154     -    1544 +    "node_modules/@types/d3-quadtree": {
12155     -    1545 +      "version": "3.0.6",
12156     -    1546 +      "resolved": "https://registry.npmjs.org/@types/d3-quadtree/-/d3-quadtree-3.0.6.tgz",
12157     -    1547 +      "integrity": "sha512-oUzyO1/Zm6rsxKRHA1vH0NEDG58HrT5icx/azi9MF1TWdtttWl0UIUsjEQBBh+SIkrpd21ZjEv7ptxWys1ncsg==",
12158     -    1548 +      "license": "MIT"
12159     -    1549 +    },
12160     -    1550 +    "node_modules/@types/d3-random": {
12161     -    1551 +      "version": "3.0.3",
12162     -    1552 +      "resolved": "https://registry.npmjs.org/@types/d3-random/-/d3-random-3.0.3.tgz",
12163     -    1553 +      "integrity": "sha512-Imagg1vJ3y76Y2ea0871wpabqp613+8/r0mCLEBfdtqC7xMSfj9idOnmBYyMoULfHePJyxMAw3nWhJxzc+LFwQ==",
12164     -    1554 +      "license": "MIT"
12165     -    1555 +    },
12166     -    1556 +    "node_modules/@types/d3-scale": {
12167     -    1557 +      "version": "4.0.9",
12168     -    1558 +      "resolved": "https://registry.npmjs.org/@types/d3-scale/-/d3-scale-4.0.9.tgz",
12169     -    1559 +      "integrity": "sha512-dLmtwB8zkAeO/juAMfnV+sItKjlsw2lKdZVVy6LRr0cBmegxSABiLEpGVmSJJ8O08i4+sGR6qQtb6WtuwJdvVw==",
12170     -    1560 +      "license": "MIT",
12171     -    1561 +      "dependencies": {
12172     -    1562 +        "@types/d3-time": "*"
12173     -    1563 +      }
12174     -    1564 +    },
12175     -    1565 +    "node_modules/@types/d3-scale-chromatic": {
12176     -    1566 +      "version": "3.1.0",
12177     -    1567 +      "resolved": "https://registry.npmjs.org/@types/d3-scale-chromatic/-/d3-scale-chromatic-3.1.0.tgz",
12178     -    1568 +      "integrity": "sha512-iWMJgwkK7yTRmWqRB5plb1kadXyQ5Sj8V/zYlFGMUBbIPKQScw+Dku9cAAMgJG+z5GYDoMjWGLVOvjghDEFnKQ==",
12179     -    1569 +      "license": "MIT"
12180     -    1570 +    },
12181     -    1571 +    "node_modules/@types/d3-selection": {
12182     -    1572 +      "version": "3.0.11",
12183     -    1573 +      "resolved": "https://registry.npmjs.org/@types/d3-selection/-/d3-selection-3.0.11.tgz",
12184     -    1574 +      "integrity": "sha512-bhAXu23DJWsrI45xafYpkQ4NtcKMwWnAC/vKrd2l+nxMFuvOT3XMYTIj2opv8vq8AO5Yh7Qac/nSeP/3zjTK0w==",
12185     -    1575 +      "license": "MIT"
12186     -    1576 +    },
12187     -    1577 +    "node_modules/@types/d3-shape": {
12188     -    1578 +      "version": "3.1.7",
12189     -    1579 +      "resolved": "https://registry.npmjs.org/@types/d3-shape/-/d3-shape-3.1.7.tgz",
12190     -    1580 +      "integrity": "sha512-VLvUQ33C+3J+8p+Daf+nYSOsjB4GXp19/S/aGo60m9h1v6XaxjiT82lKVWJCfzhtuZ3yD7i/TPeC/fuKLLOSmg==",
12191     -    1581 +      "license": "MIT",
12192     -    1582 +      "dependencies": {
12193     -    1583 +        "@types/d3-path": "*"
12194     -    1584 +      }
12195     -    1585 +    },
12196     -    1586 +    "node_modules/@types/d3-time": {
12197     -    1587 +      "version": "3.0.4",
12198     -    1588 +      "resolved": "https://registry.npmjs.org/@types/d3-time/-/d3-time-3.0.4.tgz",
12199     -    1589 +      "integrity": "sha512-yuzZug1nkAAaBlBBikKZTgzCeA+k1uy4ZFwWANOfKw5z5LRhV0gNA7gNkKm7HoK+HRN0wX3EkxGk0fpbWhmB7g==",
12200     -    1590 +      "license": "MIT"
12201     -    1591 +    },
12202     -    1592 +    "node_modules/@types/d3-time-format": {
12203     -    1593 +      "version": "4.0.3",
12204     -    1594 +      "resolved": "https://registry.npmjs.org/@types/d3-time-format/-/d3-time-format-4.0.3.tgz",
12205     -    1595 +      "integrity": "sha512-5xg9rC+wWL8kdDj153qZcsJ0FWiFt0J5RB6LYUNZjwSnesfblqrI/bJ1wBdJ8OQfncgbJG5+2F+qfqnqyzYxyg==",
12206     -    1596 +      "license": "MIT"
12207     -    1597 +    },
12208     -    1598 +    "node_modules/@types/d3-timer": {
12209     -    1599 +      "version": "3.0.2",
12210     -    1600 +      "resolved": "https://registry.npmjs.org/@types/d3-timer/-/d3-timer-3.0.2.tgz",
12211     -    1601 +      "integrity": "sha512-Ps3T8E8dZDam6fUyNiMkekK3XUsaUEik+idO9/YjPtfj2qruF8tFBXS7XhtE4iIXBLxhmLjP3SXpLhVf21I9Lw==",
12212     -    1602 +      "license": "MIT"
12213     -    1603 +    },
12214     -    1604 +    "node_modules/@types/d3-transition": {
12215     -    1605 +      "version": "3.0.9",
12216     -    1606 +      "resolved": "https://registry.npmjs.org/@types/d3-transition/-/d3-transition-3.0.9.tgz",
12217     -    1607 +      "integrity": "sha512-uZS5shfxzO3rGlu0cC3bjmMFKsXv+SmZZcgp0KD22ts4uGXp5EVYGzu/0YdwZeKmddhcAccYtREJKkPfXkZuCg==",
12218     -    1608 +      "license": "MIT",
12219     -    1609 +      "dependencies": {
12220     -    1610 +        "@types/d3-selection": "*"
12221     -    1611 +      }
12222     -    1612 +    },
12223     -    1613 +    "node_modules/@types/d3-zoom": {
12224     -    1614 +      "version": "3.0.8",
12225     -    1615 +      "resolved": "https://registry.npmjs.org/@types/d3-zoom/-/d3-zoom-3.0.8.tgz",
12226     -    1616 +      "integrity": "sha512-iqMC4/YlFCSlO8+2Ii1GGGliCAY4XdeG748w5vQUbevlbDu0zSjH/+jojorQVBK/se0j6DUFNPBGSqD3YWYnDw==",
12227     -    1617 +      "license": "MIT",
12228     -    1618 +      "dependencies": {
12229     -    1619 +        "@types/d3-interpolate": "*",
12230     -    1620 +        "@types/d3-selection": "*"
12231     -    1621 +      }
12232     -    1622 +    },
12233     -1263 1623      "node_modules/@types/deep-eql": {
12234     -1264 1624        "version": "4.0.2",
12235     -1265 1625        "resolved": "https://registry.npmjs.org/@types/deep-eql/-/deep-eql-4.0.2.tgz",
12236     -@@ -1274,6 +1634,12 @@
12237     -1274 1634        "dev": true,
12238     -1275 1635        "license": "MIT"
12239     -1276 1636      },
12240     -    1637 +    "node_modules/@types/geojson": {
12241     -    1638 +      "version": "7946.0.16",
12242     -    1639 +      "resolved": "https://registry.npmjs.org/@types/geojson/-/geojson-7946.0.16.tgz",
12243     -    1640 +      "integrity": "sha512-6C8nqWur3j98U6+lXDfTUWIfgvZU+EumvpHKcYjujKH7woYyLj2sUmff0tRhrqM7BohUw7Pz3ZB1jj2gW9Fvmg==",
12244     -    1641 +      "license": "MIT"
12245     -    1642 +    },
12246     -1277 1643      "node_modules/@types/json-schema": {
12247     -1278 1644        "version": "7.0.15",
12248     -1279 1645        "resolved": "https://registry.npmjs.org/@types/json-schema/-/json-schema-7.0.15.tgz",
12249     -@@ -1281,6 +1647,19 @@
12250     -1281 1647        "dev": true,
12251     -1282 1648        "license": "MIT"
12252     -1283 1649      },
12253     -    1650 +    "node_modules/@types/pako": {
12254     -    1651 +      "version": "2.0.4",
12255     -    1652 +      "resolved": "https://registry.npmjs.org/@types/pako/-/pako-2.0.4.tgz",
12256     -    1653 +      "integrity": "sha512-VWDCbrLeVXJM9fihYodcLiIv0ku+AlOa/TQ1SvYOaBuyrSKgEcro95LJyIsJ4vSo6BXIxOKxiJAat04CmST9Fw==",
12257     -    1654 +      "license": "MIT"
12258     -    1655 +    },
12259     -    1656 +    "node_modules/@types/raf": {
12260     -    1657 +      "version": "3.4.3",
12261     -    1658 +      "resolved": "https://registry.npmjs.org/@types/raf/-/raf-3.4.3.tgz",
12262     -    1659 +      "integrity": "sha512-c4YAvMedbPZ5tEyxzQdMoOhhJ4RD3rngZIdwC2/qDN3d7JpEhB6fiBRKVY1lg5B7Wk+uPBjn5f39j1/2MY1oOw==",
12263     -    1660 +      "license": "MIT",
12264     -    1661 +      "optional": true
12265     -    1662 +    },
12266     -1284 1663      "node_modules/@types/trusted-types": {
12267     -1285 1664        "version": "2.0.7",
12268     -1286 1665        "resolved": "https://registry.npmjs.org/@types/trusted-types/-/trusted-types-2.0.7.tgz",
12269     -@@ -1471,7 +1850,6 @@
12270     -1471 1850        "version": "8.15.0",
12271     -1472 1851        "resolved": "https://registry.npmjs.org/acorn/-/acorn-8.15.0.tgz",
12272     -1473 1852        "integrity": "sha512-NZyJarBfL7nWwIq+FDL6Zp/yHEhePMNnnJ0y3qfieCrmNvYct8uvtiV41UvlSe6apAfk0fY1FbWx+NwfmpvtTg==",
12273     -1474     -      "dev": true,
12274     -1475 1853        "license": "MIT",
12275     -1476 1854        "bin": {
12276     -1477 1855          "acorn": "bin/acorn"
12277     -@@ -1594,6 +1972,15 @@
12278     -1594 1972        "dev": true,
12279     -1595 1973        "license": "MIT"
12280     -1596 1974      },
12281     -    1975 +    "node_modules/base64-arraybuffer": {
12282     -    1976 +      "version": "1.0.2",
12283     -    1977 +      "resolved": "https://registry.npmjs.org/base64-arraybuffer/-/base64-arraybuffer-1.0.2.tgz",
12284     -    1978 +      "integrity": "sha512-I3yl4r9QB5ZRY3XuJVEPfc2XhZO6YweFPI+UovAzn+8/hb3oJ6lnysaFcjVpkCPfVWFUDvoZ8kmVDP7WyRtYtQ==",
12285     -    1979 +      "license": "MIT",
12286     -    1980 +      "engines": {
12287     -    1981 +        "node": ">= 0.6.0"
12288     -    1982 +      }
12289     -    1983 +    },
12290     -1597 1984      "node_modules/bidi-js": {
12291     -1598 1985        "version": "1.0.3",
12292     -1599 1986        "resolved": "https://registry.npmjs.org/bidi-js/-/bidi-js-1.0.3.tgz",
12293     -@@ -1721,6 +2108,26 @@
12294     -1721 2108          "node": ">=6"
12295     -1722 2109        }
12296     -1723 2110      },
12297     -    2111 +    "node_modules/canvg": {
12298     -    2112 +      "version": "3.0.11",
12299     -    2113 +      "resolved": "https://registry.npmjs.org/canvg/-/canvg-3.0.11.tgz",
12300     -    2114 +      "integrity": "sha512-5ON+q7jCTgMp9cjpu4Jo6XbvfYwSB2Ow3kzHKfIyJfaCAOHLbdKPQqGKgfED/R5B+3TFFfe8pegYA+b423SRyA==",
12301     -    2115 +      "license": "MIT",
12302     -    2116 +      "optional": true,
12303     -    2117 +      "dependencies": {
12304     -    2118 +        "@babel/runtime": "^7.12.5",
12305     -    2119 +        "@types/raf": "^3.4.0",
12306     -    2120 +        "core-js": "^3.8.3",
12307     -    2121 +        "raf": "^3.4.1",
12308     -    2122 +        "regenerator-runtime": "^0.13.7",
12309     -    2123 +        "rgbcolor": "^1.0.1",
12310     -    2124 +        "stackblur-canvas": "^2.0.0",
12311     -    2125 +        "svg-pathdata": "^6.0.3"
12312     -    2126 +      },
12313     -    2127 +      "engines": {
12314     -    2128 +        "node": ">=10.0.0"
12315     -    2129 +      }
12316     -    2130 +    },
12317     -1724 2131      "node_modules/chai": {
12318     -1725 2132        "version": "6.2.0",
12319     -1726 2133        "resolved": "https://registry.npmjs.org/chai/-/chai-6.2.0.tgz",
12320     -@@ -1748,6 +2155,32 @@
12321     -1748 2155          "url": "https://github.com/chalk/chalk?sponsor=1"
12322     -1749 2156        }
12323     -1750 2157      },
12324     -    2158 +    "node_modules/chevrotain": {
12325     -    2159 +      "version": "11.0.3",
12326     -    2160 +      "resolved": "https://registry.npmjs.org/chevrotain/-/chevrotain-11.0.3.tgz",
12327     -    2161 +      "integrity": "sha512-ci2iJH6LeIkvP9eJW6gpueU8cnZhv85ELY8w8WiFtNjMHA5ad6pQLaJo9mEly/9qUyCpvqX8/POVUTf18/HFdw==",
12328     -    2162 +      "license": "Apache-2.0",
12329     -    2163 +      "dependencies": {
12330     -    2164 +        "@chevrotain/cst-dts-gen": "11.0.3",
12331     -    2165 +        "@chevrotain/gast": "11.0.3",
12332     -    2166 +        "@chevrotain/regexp-to-ast": "11.0.3",
12333     -    2167 +        "@chevrotain/types": "11.0.3",
12334     -    2168 +        "@chevrotain/utils": "11.0.3",
12335     -    2169 +        "lodash-es": "4.17.21"
12336     -    2170 +      }
12337     -    2171 +    },
12338     -    2172 +    "node_modules/chevrotain-allstar": {
12339     -    2173 +      "version": "0.3.1",
12340     -    2174 +      "resolved": "https://registry.npmjs.org/chevrotain-allstar/-/chevrotain-allstar-0.3.1.tgz",
12341     -    2175 +      "integrity": "sha512-b7g+y9A0v4mxCW1qUhf3BSVPg+/NvGErk/dOkrDaHA0nQIQGAtrOjlX//9OQtRlSCy+x9rfB5N8yC71lH1nvMw==",
12342     -    2176 +      "license": "MIT",
12343     -    2177 +      "dependencies": {
12344     -    2178 +        "lodash-es": "^4.17.21"
12345     -    2179 +      },
12346     -    2180 +      "peerDependencies": {
12347     -    2181 +        "chevrotain": "^11.0.0"
12348     -    2182 +      }
12349     -    2183 +    },
12350     -1751 2184      "node_modules/color-convert": {
12351     -1752 2185        "version": "2.0.1",
12352     -1753 2186        "resolved": "https://registry.npmjs.org/color-convert/-/color-convert-2.0.1.tgz",
12353     -@@ -1768,6 +2201,15 @@
12354     -1768 2201        "dev": true,
12355     -1769 2202        "license": "MIT"
12356     -1770 2203      },
12357     -    2204 +    "node_modules/commander": {
12358     -    2205 +      "version": "8.3.0",
12359     -    2206 +      "resolved": "https://registry.npmjs.org/commander/-/commander-8.3.0.tgz",
12360     -    2207 +      "integrity": "sha512-OkTL9umf+He2DZkUq8f8J9of7yL6RJKI24dVITBmNfZBmri9zYZQrKkuXiKhyfPSu8tUhnVBB1iKXevvnlR4Ww==",
12361     -    2208 +      "license": "MIT",
12362     -    2209 +      "engines": {
12363     -    2210 +        "node": ">= 12"
12364     -    2211 +      }
12365     -    2212 +    },
12366     -1771 2213      "node_modules/concat-map": {
12367     -1772 2214        "version": "0.0.1",
12368     -1773 2215        "resolved": "https://registry.npmjs.org/concat-map/-/concat-map-0.0.1.tgz",
12369     -@@ -1775,6 +2217,12 @@
12370     -1775 2217        "dev": true,
12371     -1776 2218        "license": "MIT"
12372     -1777 2219      },
12373     -    2220 +    "node_modules/confbox": {
12374     -    2221 +      "version": "0.1.8",
12375     -    2222 +      "resolved": "https://registry.npmjs.org/confbox/-/confbox-0.1.8.tgz",
12376     -    2223 +      "integrity": "sha512-RMtmw0iFkeR4YV+fUOSucriAQNb9g8zFR52MWCtl+cCZOFRNL6zeB395vPzFhEjjn4fMxXudmELnl/KF/WrK6w==",
12377     -    2224 +      "license": "MIT"
12378     -    2225 +    },
12379     -1778 2226      "node_modules/content-disposition": {
12380     -1779 2227        "version": "0.5.4",
12381     -1780 2228        "resolved": "https://registry.npmjs.org/content-disposition/-/content-disposition-0.5.4.tgz",
12382     -@@ -1815,6 +2263,18 @@
12383     -1815 2263        "dev": true,
12384     -1816 2264        "license": "MIT"
12385     -1817 2265      },
12386     -    2266 +    "node_modules/core-js": {
12387     -    2267 +      "version": "3.47.0",
12388     -    2268 +      "resolved": "https://registry.npmjs.org/core-js/-/core-js-3.47.0.tgz",
12389     -    2269 +      "integrity": "sha512-c3Q2VVkGAUyupsjRnaNX6u8Dq2vAdzm9iuPj5FW0fRxzlxgq9Q39MDq10IvmQSpLgHQNyQzQmOo6bgGHmH3NNg==",
12390     -    2270 +      "hasInstallScript": true,
12391     -    2271 +      "license": "MIT",
12392     -    2272 +      "optional": true,
12393     -    2273 +      "funding": {
12394     -    2274 +        "type": "opencollective",
12395     -    2275 +        "url": "https://opencollective.com/core-js"
12396     -    2276 +      }
12397     -    2277 +    },
12398     -1818 2278      "node_modules/cors": {
12399     -1819 2279        "version": "2.8.5",
12400     -1820 2280        "resolved": "https://registry.npmjs.org/cors/-/cors-2.8.5.tgz",
12401     -@@ -1829,6 +2289,15 @@
12402     -1829 2289          "node": ">= 0.10"
12403     -1830 2290        }
12404     -1831 2291      },
12405     -    2292 +    "node_modules/cose-base": {
12406     -    2293 +      "version": "1.0.3",
12407     -    2294 +      "resolved": "https://registry.npmjs.org/cose-base/-/cose-base-1.0.3.tgz",
12408     -    2295 +      "integrity": "sha512-s9whTXInMSgAp/NVXVNuVxVKzGH2qck3aQlVHxDCdAEPgtMKwc4Wq6/QKhgdEdgbLSi9rBTAcPoRa6JpiG4ksg==",
12409     -    2296 +      "license": "MIT",
12410     -    2297 +      "dependencies": {
12411     -    2298 +        "layout-base": "^1.0.0"
12412     -    2299 +      }
12413     -    2300 +    },
12414     -1832 2301      "node_modules/cross-spawn": {
12415     -1833 2302        "version": "7.0.6",
12416     -1834 2303        "resolved": "https://registry.npmjs.org/cross-spawn/-/cross-spawn-7.0.6.tgz",
12417     -@@ -1844,6 +2313,15 @@
12418     -1844 2313          "node": ">= 8"
12419     -1845 2314        }
12420     -1846 2315      },
12421     -    2316 +    "node_modules/css-line-break": {
12422     -    2317 +      "version": "2.1.0",
12423     -    2318 +      "resolved": "https://registry.npmjs.org/css-line-break/-/css-line-break-2.1.0.tgz",
12424     -    2319 +      "integrity": "sha512-FHcKFCZcAha3LwfVBhCQbW2nCNbkZXn7KVUJcsT5/P8YmfsVja0FMPJr0B903j/E69HUphKiV9iQArX8SDYA4w==",
12425     -    2320 +      "license": "MIT",
12426     -    2321 +      "dependencies": {
12427     -    2322 +        "utrie": "^1.0.2"
12428     -    2323 +      }
12429     -    2324 +    },
12430     -1847 2325      "node_modules/css-tree": {
12431     -1848 2326        "version": "3.1.0",
12432     -1849 2327        "resolved": "https://registry.npmjs.org/css-tree/-/css-tree-3.1.0.tgz",
12433     -@@ -1873,6 +2351,514 @@
12434     -1873 2351          "node": ">=20"
12435     -1874 2352        }
12436     -1875 2353      },
12437     -    2354 +    "node_modules/cytoscape": {
12438     -    2355 +      "version": "3.33.1",
12439     -    2356 +      "resolved": "https://registry.npmjs.org/cytoscape/-/cytoscape-3.33.1.tgz",
12440     -    2357 +      "integrity": "sha512-iJc4TwyANnOGR1OmWhsS9ayRS3s+XQ185FmuHObThD+5AeJCakAAbWv8KimMTt08xCCLNgneQwFp+JRJOr9qGQ==",
12441     -    2358 +      "license": "MIT",
12442     -    2359 +      "engines": {
12443     -    2360 +        "node": ">=0.10"
12444     -    2361 +      }
12445     -    2362 +    },
12446     -    2363 +    "node_modules/cytoscape-cose-bilkent": {
12447     -    2364 +      "version": "4.1.0",
12448     -    2365 +      "resolved": "https://registry.npmjs.org/cytoscape-cose-bilkent/-/cytoscape-cose-bilkent-4.1.0.tgz",
12449     -    2366 +      "integrity": "sha512-wgQlVIUJF13Quxiv5e1gstZ08rnZj2XaLHGoFMYXz7SkNfCDOOteKBE6SYRfA9WxxI/iBc3ajfDoc6hb/MRAHQ==",
12450     -    2367 +      "license": "MIT",
12451     -    2368 +      "dependencies": {
12452     -    2369 +        "cose-base": "^1.0.0"
12453     -    2370 +      },
12454     -    2371 +      "peerDependencies": {
12455     -    2372 +        "cytoscape": "^3.2.0"
12456     -    2373 +      }
12457     -    2374 +    },
12458     -    2375 +    "node_modules/cytoscape-fcose": {
12459     -    2376 +      "version": "2.2.0",
12460     -    2377 +      "resolved": "https://registry.npmjs.org/cytoscape-fcose/-/cytoscape-fcose-2.2.0.tgz",
12461     -    2378 +      "integrity": "sha512-ki1/VuRIHFCzxWNrsshHYPs6L7TvLu3DL+TyIGEsRcvVERmxokbf5Gdk7mFxZnTdiGtnA4cfSmjZJMviqSuZrQ==",
12462     -    2379 +      "license": "MIT",
12463     -    2380 +      "dependencies": {
12464     -    2381 +        "cose-base": "^2.2.0"
12465     -    2382 +      },
12466     -    2383 +      "peerDependencies": {
12467     -    2384 +        "cytoscape": "^3.2.0"
12468     -    2385 +      }
12469     -    2386 +    },
12470     -    2387 +    "node_modules/cytoscape-fcose/node_modules/cose-base": {
12471     -    2388 +      "version": "2.2.0",
12472     -    2389 +      "resolved": "https://registry.npmjs.org/cose-base/-/cose-base-2.2.0.tgz",
12473     -    2390 +      "integrity": "sha512-AzlgcsCbUMymkADOJtQm3wO9S3ltPfYOFD5033keQn9NJzIbtnZj+UdBJe7DYml/8TdbtHJW3j58SOnKhWY/5g==",
12474     -    2391 +      "license": "MIT",
12475     -    2392 +      "dependencies": {
12476     -    2393 +        "layout-base": "^2.0.0"
12477     -    2394 +      }
12478     -    2395 +    },
12479     -    2396 +    "node_modules/cytoscape-fcose/node_modules/layout-base": {
12480     -    2397 +      "version": "2.0.1",
12481     -    2398 +      "resolved": "https://registry.npmjs.org/layout-base/-/layout-base-2.0.1.tgz",
12482     -    2399 +      "integrity": "sha512-dp3s92+uNI1hWIpPGH3jK2kxE2lMjdXdr+DH8ynZHpd6PUlH6x6cbuXnoMmiNumznqaNO31xu9e79F0uuZ0JFg==",
12483     -    2400 +      "license": "MIT"
12484     -    2401 +    },
12485     -    2402 +    "node_modules/d3": {
12486     -    2403 +      "version": "7.9.0",
12487     -    2404 +      "resolved": "https://registry.npmjs.org/d3/-/d3-7.9.0.tgz",
12488     -    2405 +      "integrity": "sha512-e1U46jVP+w7Iut8Jt8ri1YsPOvFpg46k+K8TpCb0P+zjCkjkPnV7WzfDJzMHy1LnA+wj5pLT1wjO901gLXeEhA==",
12489     -    2406 +      "license": "ISC",
12490     -    2407 +      "dependencies": {
12491     -    2408 +        "d3-array": "3",
12492     -    2409 +        "d3-axis": "3",
12493     -    2410 +        "d3-brush": "3",
12494     -    2411 +        "d3-chord": "3",
12495     -    2412 +        "d3-color": "3",
12496     -    2413 +        "d3-contour": "4",
12497     -    2414 +        "d3-delaunay": "6",
12498     -    2415 +        "d3-dispatch": "3",
12499     -    2416 +        "d3-drag": "3",
12500     -    2417 +        "d3-dsv": "3",
12501     -    2418 +        "d3-ease": "3",
12502     -    2419 +        "d3-fetch": "3",
12503     -    2420 +        "d3-force": "3",
12504     -    2421 +        "d3-format": "3",
12505     -    2422 +        "d3-geo": "3",
12506     -    2423 +        "d3-hierarchy": "3",
12507     -    2424 +        "d3-interpolate": "3",
12508     -    2425 +        "d3-path": "3",
12509     -    2426 +        "d3-polygon": "3",
12510     -    2427 +        "d3-quadtree": "3",
12511     -    2428 +        "d3-random": "3",
12512     -    2429 +        "d3-scale": "4",
12513     -    2430 +        "d3-scale-chromatic": "3",
12514     -    2431 +        "d3-selection": "3",
12515     -    2432 +        "d3-shape": "3",
12516     -    2433 +        "d3-time": "3",
12517     -    2434 +        "d3-time-format": "4",
12518     -    2435 +        "d3-timer": "3",
12519     -    2436 +        "d3-transition": "3",
12520     -    2437 +        "d3-zoom": "3"
12521     -    2438 +      },
12522     -    2439 +      "engines": {
12523     -    2440 +        "node": ">=12"
12524     -    2441 +      }
12525     -    2442 +    },
12526     -    2443 +    "node_modules/d3-array": {
12527     -    2444 +      "version": "3.2.4",
12528     -    2445 +      "resolved": "https://registry.npmjs.org/d3-array/-/d3-array-3.2.4.tgz",
12529     -    2446 +      "integrity": "sha512-tdQAmyA18i4J7wprpYq8ClcxZy3SC31QMeByyCFyRt7BVHdREQZ5lpzoe5mFEYZUWe+oq8HBvk9JjpibyEV4Jg==",
12530     -    2447 +      "license": "ISC",
12531     -    2448 +      "dependencies": {
12532     -    2449 +        "internmap": "1 - 2"
12533     -    2450 +      },
12534     -    2451 +      "engines": {
12535     -    2452 +        "node": ">=12"
12536     -    2453 +      }
12537     -    2454 +    },
12538     -    2455 +    "node_modules/d3-axis": {
12539     -    2456 +      "version": "3.0.0",
12540     -    2457 +      "resolved": "https://registry.npmjs.org/d3-axis/-/d3-axis-3.0.0.tgz",
12541     -    2458 +      "integrity": "sha512-IH5tgjV4jE/GhHkRV0HiVYPDtvfjHQlQfJHs0usq7M30XcSBvOotpmH1IgkcXsO/5gEQZD43B//fc7SRT5S+xw==",
12542     -    2459 +      "license": "ISC",
12543     -    2460 +      "engines": {
12544     -    2461 +        "node": ">=12"
12545     -    2462 +      }
12546     -    2463 +    },
12547     -    2464 +    "node_modules/d3-brush": {
12548     -    2465 +      "version": "3.0.0",
12549     -    2466 +      "resolved": "https://registry.npmjs.org/d3-brush/-/d3-brush-3.0.0.tgz",
12550     -    2467 +      "integrity": "sha512-ALnjWlVYkXsVIGlOsuWH1+3udkYFI48Ljihfnh8FZPF2QS9o+PzGLBslO0PjzVoHLZ2KCVgAM8NVkXPJB2aNnQ==",
12551     -    2468 +      "license": "ISC",
12552     -    2469 +      "dependencies": {
12553     -    2470 +        "d3-dispatch": "1 - 3",
12554     -    2471 +        "d3-drag": "2 - 3",
12555     -    2472 +        "d3-interpolate": "1 - 3",
12556     -    2473 +        "d3-selection": "3",
12557     -    2474 +        "d3-transition": "3"
12558     -    2475 +      },
12559     -    2476 +      "engines": {
12560     -    2477 +        "node": ">=12"
12561     -    2478 +      }
12562     -    2479 +    },
12563     -    2480 +    "node_modules/d3-chord": {
12564     -    2481 +      "version": "3.0.1",
12565     -    2482 +      "resolved": "https://registry.npmjs.org/d3-chord/-/d3-chord-3.0.1.tgz",
12566     -    2483 +      "integrity": "sha512-VE5S6TNa+j8msksl7HwjxMHDM2yNK3XCkusIlpX5kwauBfXuyLAtNg9jCp/iHH61tgI4sb6R/EIMWCqEIdjT/g==",
12567     -    2484 +      "license": "ISC",
12568     -    2485 +      "dependencies": {
12569     -    2486 +        "d3-path": "1 - 3"
12570     -    2487 +      },
12571     -    2488 +      "engines": {
12572     -    2489 +        "node": ">=12"
12573     -    2490 +      }
12574     -    2491 +    },
12575     -    2492 +    "node_modules/d3-color": {
12576     -    2493 +      "version": "3.1.0",
12577     -    2494 +      "resolved": "https://registry.npmjs.org/d3-color/-/d3-color-3.1.0.tgz",
12578     -    2495 +      "integrity": "sha512-zg/chbXyeBtMQ1LbD/WSoW2DpC3I0mpmPdW+ynRTj/x2DAWYrIY7qeZIHidozwV24m4iavr15lNwIwLxRmOxhA==",
12579     -    2496 +      "license": "ISC",
12580     -    2497 +      "engines": {
12581     -    2498 +        "node": ">=12"
12582     -    2499 +      }
12583     -    2500 +    },
12584     -    2501 +    "node_modules/d3-contour": {
12585     -    2502 +      "version": "4.0.2",
12586     -    2503 +      "resolved": "https://registry.npmjs.org/d3-contour/-/d3-contour-4.0.2.tgz",
12587     -    2504 +      "integrity": "sha512-4EzFTRIikzs47RGmdxbeUvLWtGedDUNkTcmzoeyg4sP/dvCexO47AaQL7VKy/gul85TOxw+IBgA8US2xwbToNA==",
12588     -    2505 +      "license": "ISC",
12589     -    2506 +      "dependencies": {
12590     -    2507 +        "d3-array": "^3.2.0"
12591     -    2508 +      },
12592     -    2509 +      "engines": {
12593     -    2510 +        "node": ">=12"
12594     -    2511 +      }
12595     -    2512 +    },
12596     -    2513 +    "node_modules/d3-delaunay": {
12597     -    2514 +      "version": "6.0.4",
12598     -    2515 +      "resolved": "https://registry.npmjs.org/d3-delaunay/-/d3-delaunay-6.0.4.tgz",
12599     -    2516 +      "integrity": "sha512-mdjtIZ1XLAM8bm/hx3WwjfHt6Sggek7qH043O8KEjDXN40xi3vx/6pYSVTwLjEgiXQTbvaouWKynLBiUZ6SK6A==",
12600     -    2517 +      "license": "ISC",
12601     -    2518 +      "dependencies": {
12602     -    2519 +        "delaunator": "5"
12603     -    2520 +      },
12604     -    2521 +      "engines": {
12605     -    2522 +        "node": ">=12"
12606     -    2523 +      }
12607     -    2524 +    },
12608     -    2525 +    "node_modules/d3-dispatch": {
12609     -    2526 +      "version": "3.0.1",
12610     -    2527 +      "resolved": "https://registry.npmjs.org/d3-dispatch/-/d3-dispatch-3.0.1.tgz",
12611     -    2528 +      "integrity": "sha512-rzUyPU/S7rwUflMyLc1ETDeBj0NRuHKKAcvukozwhshr6g6c5d8zh4c2gQjY2bZ0dXeGLWc1PF174P2tVvKhfg==",
12612     -    2529 +      "license": "ISC",
12613     -    2530 +      "engines": {
12614     -    2531 +        "node": ">=12"
12615     -    2532 +      }
12616     -    2533 +    },
12617     -    2534 +    "node_modules/d3-drag": {
12618     -    2535 +      "version": "3.0.0",
12619     -    2536 +      "resolved": "https://registry.npmjs.org/d3-drag/-/d3-drag-3.0.0.tgz",
12620     -    2537 +      "integrity": "sha512-pWbUJLdETVA8lQNJecMxoXfH6x+mO2UQo8rSmZ+QqxcbyA3hfeprFgIT//HW2nlHChWeIIMwS2Fq+gEARkhTkg==",
12621     -    2538 +      "license": "ISC",
12622     -    2539 +      "dependencies": {
12623     -    2540 +        "d3-dispatch": "1 - 3",
12624     -    2541 +        "d3-selection": "3"
12625     -    2542 +      },
12626     -    2543 +      "engines": {
12627     -    2544 +        "node": ">=12"
12628     -    2545 +      }
12629     -    2546 +    },
12630     -    2547 +    "node_modules/d3-dsv": {
12631     -    2548 +      "version": "3.0.1",
12632     -    2549 +      "resolved": "https://registry.npmjs.org/d3-dsv/-/d3-dsv-3.0.1.tgz",
12633     -    2550 +      "integrity": "sha512-UG6OvdI5afDIFP9w4G0mNq50dSOsXHJaRE8arAS5o9ApWnIElp8GZw1Dun8vP8OyHOZ/QJUKUJwxiiCCnUwm+Q==",
12634     -    2551 +      "license": "ISC",
12635     -    2552 +      "dependencies": {
12636     -    2553 +        "commander": "7",
12637     -    2554 +        "iconv-lite": "0.6",
12638     -    2555 +        "rw": "1"
12639     -    2556 +      },
12640     -    2557 +      "bin": {
12641     -    2558 +        "csv2json": "bin/dsv2json.js",
12642     -    2559 +        "csv2tsv": "bin/dsv2dsv.js",
12643     -    2560 +        "dsv2dsv": "bin/dsv2dsv.js",
12644     -    2561 +        "dsv2json": "bin/dsv2json.js",
12645     -    2562 +        "json2csv": "bin/json2dsv.js",
12646     -    2563 +        "json2dsv": "bin/json2dsv.js",
12647     -    2564 +        "json2tsv": "bin/json2dsv.js",
12648     -    2565 +        "tsv2csv": "bin/dsv2dsv.js",
12649     -    2566 +        "tsv2json": "bin/dsv2json.js"
12650     -    2567 +      },
12651     -    2568 +      "engines": {
12652     -    2569 +        "node": ">=12"
12653     -    2570 +      }
12654     -    2571 +    },
12655     -    2572 +    "node_modules/d3-dsv/node_modules/commander": {
12656     -    2573 +      "version": "7.2.0",
12657     -    2574 +      "resolved": "https://registry.npmjs.org/commander/-/commander-7.2.0.tgz",
12658     -    2575 +      "integrity": "sha512-QrWXB+ZQSVPmIWIhtEO9H+gwHaMGYiF5ChvoJ+K9ZGHG/sVsa6yiesAD1GC/x46sET00Xlwo1u49RVVVzvcSkw==",
12659     -    2576 +      "license": "MIT",
12660     -    2577 +      "engines": {
12661     -    2578 +        "node": ">= 10"
12662     -    2579 +      }
12663     -    2580 +    },
12664     -    2581 +    "node_modules/d3-ease": {
12665     -    2582 +      "version": "3.0.1",
12666     -    2583 +      "resolved": "https://registry.npmjs.org/d3-ease/-/d3-ease-3.0.1.tgz",
12667     -    2584 +      "integrity": "sha512-wR/XK3D3XcLIZwpbvQwQ5fK+8Ykds1ip7A2Txe0yxncXSdq1L9skcG7blcedkOX+ZcgxGAmLX1FrRGbADwzi0w==",
12668     -    2585 +      "license": "BSD-3-Clause",
12669     -    2586 +      "engines": {
12670     -    2587 +        "node": ">=12"
12671     -    2588 +      }
12672     -    2589 +    },
12673     -    2590 +    "node_modules/d3-fetch": {
12674     -    2591 +      "version": "3.0.1",
12675     -    2592 +      "resolved": "https://registry.npmjs.org/d3-fetch/-/d3-fetch-3.0.1.tgz",
12676     -    2593 +      "integrity": "sha512-kpkQIM20n3oLVBKGg6oHrUchHM3xODkTzjMoj7aWQFq5QEM+R6E4WkzT5+tojDY7yjez8KgCBRoj4aEr99Fdqw==",
12677     -    2594 +      "license": "ISC",
12678     -    2595 +      "dependencies": {
12679     -    2596 +        "d3-dsv": "1 - 3"
12680     -    2597 +      },
12681     -    2598 +      "engines": {
12682     -    2599 +        "node": ">=12"
12683     -    2600 +      }
12684     -    2601 +    },
12685     -    2602 +    "node_modules/d3-force": {
12686     -    2603 +      "version": "3.0.0",
12687     -    2604 +      "resolved": "https://registry.npmjs.org/d3-force/-/d3-force-3.0.0.tgz",
12688     -    2605 +      "integrity": "sha512-zxV/SsA+U4yte8051P4ECydjD/S+qeYtnaIyAs9tgHCqfguma/aAQDjo85A9Z6EKhBirHRJHXIgJUlffT4wdLg==",
12689     -    2606 +      "license": "ISC",
12690     -    2607 +      "dependencies": {
12691     -    2608 +        "d3-dispatch": "1 - 3",
12692     -    2609 +        "d3-quadtree": "1 - 3",
12693     -    2610 +        "d3-timer": "1 - 3"
12694     -    2611 +      },
12695     -    2612 +      "engines": {
12696     -    2613 +        "node": ">=12"
12697     -    2614 +      }
12698     -    2615 +    },
12699     -    2616 +    "node_modules/d3-format": {
12700     -    2617 +      "version": "3.1.0",
12701     -    2618 +      "resolved": "https://registry.npmjs.org/d3-format/-/d3-format-3.1.0.tgz",
12702     -    2619 +      "integrity": "sha512-YyUI6AEuY/Wpt8KWLgZHsIU86atmikuoOmCfommt0LYHiQSPjvX2AcFc38PX0CBpr2RCyZhjex+NS/LPOv6YqA==",
12703     -    2620 +      "license": "ISC",
12704     -    2621 +      "engines": {
12705     -    2622 +        "node": ">=12"
12706     -    2623 +      }
12707     -    2624 +    },
12708     -    2625 +    "node_modules/d3-geo": {
12709     -    2626 +      "version": "3.1.1",
12710     -    2627 +      "resolved": "https://registry.npmjs.org/d3-geo/-/d3-geo-3.1.1.tgz",
12711     -    2628 +      "integrity": "sha512-637ln3gXKXOwhalDzinUgY83KzNWZRKbYubaG+fGVuc/dxO64RRljtCTnf5ecMyE1RIdtqpkVcq0IbtU2S8j2Q==",
12712     -    2629 +      "license": "ISC",
12713     -    2630 +      "dependencies": {
12714     -    2631 +        "d3-array": "2.5.0 - 3"
12715     -    2632 +      },
12716     -    2633 +      "engines": {
12717     -    2634 +        "node": ">=12"
12718     -    2635 +      }
12719     -    2636 +    },
12720     -    2637 +    "node_modules/d3-hierarchy": {
12721     -    2638 +      "version": "3.1.2",
12722     -    2639 +      "resolved": "https://registry.npmjs.org/d3-hierarchy/-/d3-hierarchy-3.1.2.tgz",
12723     -    2640 +      "integrity": "sha512-FX/9frcub54beBdugHjDCdikxThEqjnR93Qt7PvQTOHxyiNCAlvMrHhclk3cD5VeAaq9fxmfRp+CnWw9rEMBuA==",
12724     -    2641 +      "license": "ISC",
12725     -    2642 +      "engines": {
12726     -    2643 +        "node": ">=12"
12727     -    2644 +      }
12728     -    2645 +    },
12729     -    2646 +    "node_modules/d3-interpolate": {
12730     -    2647 +      "version": "3.0.1",
12731     -    2648 +      "resolved": "https://registry.npmjs.org/d3-interpolate/-/d3-interpolate-3.0.1.tgz",
12732     -    2649 +      "integrity": "sha512-3bYs1rOD33uo8aqJfKP3JWPAibgw8Zm2+L9vBKEHJ2Rg+viTR7o5Mmv5mZcieN+FRYaAOWX5SJATX6k1PWz72g==",
12733     -    2650 +      "license": "ISC",
12734     -    2651 +      "dependencies": {
12735     -    2652 +        "d3-color": "1 - 3"
12736     -    2653 +      },
12737     -    2654 +      "engines": {
12738     -    2655 +        "node": ">=12"
12739     -    2656 +      }
12740     -    2657 +    },
12741     -    2658 +    "node_modules/d3-path": {
12742     -    2659 +      "version": "3.1.0",
12743     -    2660 +      "resolved": "https://registry.npmjs.org/d3-path/-/d3-path-3.1.0.tgz",
12744     -    2661 +      "integrity": "sha512-p3KP5HCf/bvjBSSKuXid6Zqijx7wIfNW+J/maPs+iwR35at5JCbLUT0LzF1cnjbCHWhqzQTIN2Jpe8pRebIEFQ==",
12745     -    2662 +      "license": "ISC",
12746     -    2663 +      "engines": {
12747     -    2664 +        "node": ">=12"
12748     -    2665 +      }
12749     -    2666 +    },
12750     -    2667 +    "node_modules/d3-polygon": {
12751     -    2668 +      "version": "3.0.1",
12752     -    2669 +      "resolved": "https://registry.npmjs.org/d3-polygon/-/d3-polygon-3.0.1.tgz",
12753     -    2670 +      "integrity": "sha512-3vbA7vXYwfe1SYhED++fPUQlWSYTTGmFmQiany/gdbiWgU/iEyQzyymwL9SkJjFFuCS4902BSzewVGsHHmHtXg==",
12754     -    2671 +      "license": "ISC",
12755     -    2672 +      "engines": {
12756     -    2673 +        "node": ">=12"
12757     -    2674 +      }
12758     -    2675 +    },
12759     -    2676 +    "node_modules/d3-quadtree": {
12760     -    2677 +      "version": "3.0.1",
12761     -    2678 +      "resolved": "https://registry.npmjs.org/d3-quadtree/-/d3-quadtree-3.0.1.tgz",
12762     -    2679 +      "integrity": "sha512-04xDrxQTDTCFwP5H6hRhsRcb9xxv2RzkcsygFzmkSIOJy3PeRJP7sNk3VRIbKXcog561P9oU0/rVH6vDROAgUw==",
12763     -    2680 +      "license": "ISC",
12764     -    2681 +      "engines": {
12765     -    2682 +        "node": ">=12"
12766     -    2683 +      }
12767     -    2684 +    },
12768     -    2685 +    "node_modules/d3-random": {
12769     -    2686 +      "version": "3.0.1",
12770     -    2687 +      "resolved": "https://registry.npmjs.org/d3-random/-/d3-random-3.0.1.tgz",
12771     -    2688 +      "integrity": "sha512-FXMe9GfxTxqd5D6jFsQ+DJ8BJS4E/fT5mqqdjovykEB2oFbTMDVdg1MGFxfQW+FBOGoB++k8swBrgwSHT1cUXQ==",
12772     -    2689 +      "license": "ISC",
12773     -    2690 +      "engines": {
12774     -    2691 +        "node": ">=12"
12775     -    2692 +      }
12776     -    2693 +    },
12777     -    2694 +    "node_modules/d3-sankey": {
12778     -    2695 +      "version": "0.12.3",
12779     -    2696 +      "resolved": "https://registry.npmjs.org/d3-sankey/-/d3-sankey-0.12.3.tgz",
12780     -    2697 +      "integrity": "sha512-nQhsBRmM19Ax5xEIPLMY9ZmJ/cDvd1BG3UVvt5h3WRxKg5zGRbvnteTyWAbzeSvlh3tW7ZEmq4VwR5mB3tutmQ==",
12781     -    2698 +      "license": "BSD-3-Clause",
12782     -    2699 +      "dependencies": {
12783     -    2700 +        "d3-array": "1 - 2",
12784     -    2701 +        "d3-shape": "^1.2.0"
12785     -    2702 +      }
12786     -    2703 +    },
12787     -    2704 +    "node_modules/d3-sankey/node_modules/d3-array": {
12788     -    2705 +      "version": "2.12.1",
12789     -    2706 +      "resolved": "https://registry.npmjs.org/d3-array/-/d3-array-2.12.1.tgz",
12790     -    2707 +      "integrity": "sha512-B0ErZK/66mHtEsR1TkPEEkwdy+WDesimkM5gpZr5Dsg54BiTA5RXtYW5qTLIAcekaS9xfZrzBLF/OAkB3Qn1YQ==",
12791     -    2708 +      "license": "BSD-3-Clause",
12792     -    2709 +      "dependencies": {
12793     -    2710 +        "internmap": "^1.0.0"
12794     -    2711 +      }
12795     -    2712 +    },
12796     -    2713 +    "node_modules/d3-sankey/node_modules/d3-path": {
12797     -    2714 +      "version": "1.0.9",
12798     -    2715 +      "resolved": "https://registry.npmjs.org/d3-path/-/d3-path-1.0.9.tgz",
12799     -    2716 +      "integrity": "sha512-VLaYcn81dtHVTjEHd8B+pbe9yHWpXKZUC87PzoFmsFrJqgFwDe/qxfp5MlfsfM1V5E/iVt0MmEbWQ7FVIXh/bg==",
12800     -    2717 +      "license": "BSD-3-Clause"
12801     -    2718 +    },
12802     -    2719 +    "node_modules/d3-sankey/node_modules/d3-shape": {
12803     -    2720 +      "version": "1.3.7",
12804     -    2721 +      "resolved": "https://registry.npmjs.org/d3-shape/-/d3-shape-1.3.7.tgz",
12805     -    2722 +      "integrity": "sha512-EUkvKjqPFUAZyOlhY5gzCxCeI0Aep04LwIRpsZ/mLFelJiUfnK56jo5JMDSE7yyP2kLSb6LtF+S5chMk7uqPqw==",
12806     -    2723 +      "license": "BSD-3-Clause",
12807     -    2724 +      "dependencies": {
12808     -    2725 +        "d3-path": "1"
12809     -    2726 +      }
12810     -    2727 +    },
12811     -    2728 +    "node_modules/d3-sankey/node_modules/internmap": {
12812     -    2729 +      "version": "1.0.1",
12813     -    2730 +      "resolved": "https://registry.npmjs.org/internmap/-/internmap-1.0.1.tgz",
12814     -    2731 +      "integrity": "sha512-lDB5YccMydFBtasVtxnZ3MRBHuaoE8GKsppq+EchKL2U4nK/DmEpPHNH8MZe5HkMtpSiTSOZwfN0tzYjO/lJEw==",
12815     -    2732 +      "license": "ISC"
12816     -    2733 +    },
12817     -    2734 +    "node_modules/d3-scale": {
12818     -    2735 +      "version": "4.0.2",
12819     -    2736 +      "resolved": "https://registry.npmjs.org/d3-scale/-/d3-scale-4.0.2.tgz",
12820     -    2737 +      "integrity": "sha512-GZW464g1SH7ag3Y7hXjf8RoUuAFIqklOAq3MRl4OaWabTFJY9PN/E1YklhXLh+OQ3fM9yS2nOkCoS+WLZ6kvxQ==",
12821     -    2738 +      "license": "ISC",
12822     -    2739 +      "dependencies": {
12823     -    2740 +        "d3-array": "2.10.0 - 3",
12824     -    2741 +        "d3-format": "1 - 3",
12825     -    2742 +        "d3-interpolate": "1.2.0 - 3",
12826     -    2743 +        "d3-time": "2.1.1 - 3",
12827     -    2744 +        "d3-time-format": "2 - 4"
12828     -    2745 +      },
12829     -    2746 +      "engines": {
12830     -    2747 +        "node": ">=12"
12831     -    2748 +      }
12832     -    2749 +    },
12833     -    2750 +    "node_modules/d3-scale-chromatic": {
12834     -    2751 +      "version": "3.1.0",
12835     -    2752 +      "resolved": "https://registry.npmjs.org/d3-scale-chromatic/-/d3-scale-chromatic-3.1.0.tgz",
12836     -    2753 +      "integrity": "sha512-A3s5PWiZ9YCXFye1o246KoscMWqf8BsD9eRiJ3He7C9OBaxKhAd5TFCdEx/7VbKtxxTsu//1mMJFrEt572cEyQ==",
12837     -    2754 +      "license": "ISC",
12838     -    2755 +      "dependencies": {
12839     -    2756 +        "d3-color": "1 - 3",
12840     -    2757 +        "d3-interpolate": "1 - 3"
12841     -    2758 +      },
12842     -    2759 +      "engines": {
12843     -    2760 +        "node": ">=12"
12844     -    2761 +      }
12845     -    2762 +    },
12846     -    2763 +    "node_modules/d3-selection": {
12847     -    2764 +      "version": "3.0.0",
12848     -    2765 +      "resolved": "https://registry.npmjs.org/d3-selection/-/d3-selection-3.0.0.tgz",
12849     -    2766 +      "integrity": "sha512-fmTRWbNMmsmWq6xJV8D19U/gw/bwrHfNXxrIN+HfZgnzqTHp9jOmKMhsTUjXOJnZOdZY9Q28y4yebKzqDKlxlQ==",
12850     -    2767 +      "license": "ISC",
12851     -    2768 +      "engines": {
12852     -    2769 +        "node": ">=12"
12853     -    2770 +      }
12854     -    2771 +    },
12855     -    2772 +    "node_modules/d3-shape": {
12856     -    2773 +      "version": "3.2.0",
12857     -    2774 +      "resolved": "https://registry.npmjs.org/d3-shape/-/d3-shape-3.2.0.tgz",
12858     -    2775 +      "integrity": "sha512-SaLBuwGm3MOViRq2ABk3eLoxwZELpH6zhl3FbAoJ7Vm1gofKx6El1Ib5z23NUEhF9AsGl7y+dzLe5Cw2AArGTA==",
12859     -    2776 +      "license": "ISC",
12860     -    2777 +      "dependencies": {
12861     -    2778 +        "d3-path": "^3.1.0"
12862     -    2779 +      },
12863     -    2780 +      "engines": {
12864     -    2781 +        "node": ">=12"
12865     -    2782 +      }
12866     -    2783 +    },
12867     -    2784 +    "node_modules/d3-time": {
12868     -    2785 +      "version": "3.1.0",
12869     -    2786 +      "resolved": "https://registry.npmjs.org/d3-time/-/d3-time-3.1.0.tgz",
12870     -    2787 +      "integrity": "sha512-VqKjzBLejbSMT4IgbmVgDjpkYrNWUYJnbCGo874u7MMKIWsILRX+OpX/gTk8MqjpT1A/c6HY2dCA77ZN0lkQ2Q==",
12871     -    2788 +      "license": "ISC",
12872     -    2789 +      "dependencies": {
12873     -    2790 +        "d3-array": "2 - 3"
12874     -    2791 +      },
12875     -    2792 +      "engines": {
12876     -    2793 +        "node": ">=12"
12877     -    2794 +      }
12878     -    2795 +    },
12879     -    2796 +    "node_modules/d3-time-format": {
12880     -    2797 +      "version": "4.1.0",
12881     -    2798 +      "resolved": "https://registry.npmjs.org/d3-time-format/-/d3-time-format-4.1.0.tgz",
12882     -    2799 +      "integrity": "sha512-dJxPBlzC7NugB2PDLwo9Q8JiTR3M3e4/XANkreKSUxF8vvXKqm1Yfq4Q5dl8budlunRVlUUaDUgFt7eA8D6NLg==",
12883     -    2800 +      "license": "ISC",
12884     -    2801 +      "dependencies": {
12885     -    2802 +        "d3-time": "1 - 3"
12886     -    2803 +      },
12887     -    2804 +      "engines": {
12888     -    2805 +        "node": ">=12"
12889     -    2806 +      }
12890     -    2807 +    },
12891     -    2808 +    "node_modules/d3-timer": {
12892     -    2809 +      "version": "3.0.1",
12893     -    2810 +      "resolved": "https://registry.npmjs.org/d3-timer/-/d3-timer-3.0.1.tgz",
12894     -    2811 +      "integrity": "sha512-ndfJ/JxxMd3nw31uyKoY2naivF+r29V+Lc0svZxe1JvvIRmi8hUsrMvdOwgS1o6uBHmiz91geQ0ylPP0aj1VUA==",
12895     -    2812 +      "license": "ISC",
12896     -    2813 +      "engines": {
12897     -    2814 +        "node": ">=12"
12898     -    2815 +      }
12899     -    2816 +    },
12900     -    2817 +    "node_modules/d3-transition": {
12901     -    2818 +      "version": "3.0.1",
12902     -    2819 +      "resolved": "https://registry.npmjs.org/d3-transition/-/d3-transition-3.0.1.tgz",
12903     -    2820 +      "integrity": "sha512-ApKvfjsSR6tg06xrL434C0WydLr7JewBB3V+/39RMHsaXTOG0zmt/OAXeng5M5LBm0ojmxJrpomQVZ1aPvBL4w==",
12904     -    2821 +      "license": "ISC",
12905     -    2822 +      "dependencies": {
12906     -    2823 +        "d3-color": "1 - 3",
12907     -    2824 +        "d3-dispatch": "1 - 3",
12908     -    2825 +        "d3-ease": "1 - 3",
12909     -    2826 +        "d3-interpolate": "1 - 3",
12910     -    2827 +        "d3-timer": "1 - 3"
12911     -    2828 +      },
12912     -    2829 +      "engines": {
12913     -    2830 +        "node": ">=12"
12914     -    2831 +      },
12915     -    2832 +      "peerDependencies": {
12916     -    2833 +        "d3-selection": "2 - 3"
12917     -    2834 +      }
12918     -    2835 +    },
12919     -    2836 +    "node_modules/d3-zoom": {
12920     -    2837 +      "version": "3.0.0",
12921     -    2838 +      "resolved": "https://registry.npmjs.org/d3-zoom/-/d3-zoom-3.0.0.tgz",
12922     -    2839 +      "integrity": "sha512-b8AmV3kfQaqWAuacbPuNbL6vahnOJflOhexLzMMNLga62+/nh0JzvJ0aO/5a5MVgUFGS7Hu1P9P03o3fJkDCyw==",
12923     -    2840 +      "license": "ISC",
12924     -    2841 +      "dependencies": {
12925     -    2842 +        "d3-dispatch": "1 - 3",
12926     -    2843 +        "d3-drag": "2 - 3",
12927     -    2844 +        "d3-interpolate": "1 - 3",
12928     -    2845 +        "d3-selection": "2 - 3",
12929     -    2846 +        "d3-transition": "2 - 3"
12930     -    2847 +      },
12931     -    2848 +      "engines": {
12932     -    2849 +        "node": ">=12"
12933     -    2850 +      }
12934     -    2851 +    },
12935     -    2852 +    "node_modules/dagre-d3-es": {
12936     -    2853 +      "version": "7.0.13",
12937     -    2854 +      "resolved": "https://registry.npmjs.org/dagre-d3-es/-/dagre-d3-es-7.0.13.tgz",
12938     -    2855 +      "integrity": "sha512-efEhnxpSuwpYOKRm/L5KbqoZmNNukHa/Flty4Wp62JRvgH2ojwVgPgdYyr4twpieZnyRDdIH7PY2mopX26+j2Q==",
12939     -    2856 +      "license": "MIT",
12940     -    2857 +      "dependencies": {
12941     -    2858 +        "d3": "^7.9.0",
12942     -    2859 +        "lodash-es": "^4.17.21"
12943     -    2860 +      }
12944     -    2861 +    },
12945     -1876 2862      "node_modules/data-urls": {
12946     -1877 2863        "version": "6.0.0",
12947     -1878 2864        "resolved": "https://registry.npmjs.org/data-urls/-/data-urls-6.0.0.tgz",
12948     -@@ -1887,6 +2873,12 @@
12949     -1887 2873          "node": ">=20"
12950     -1888 2874        }
12951     -1889 2875      },
12952     -    2876 +    "node_modules/dayjs": {
12953     -    2877 +      "version": "1.11.19",
12954     -    2878 +      "resolved": "https://registry.npmjs.org/dayjs/-/dayjs-1.11.19.tgz",
12955     -    2879 +      "integrity": "sha512-t5EcLVS6QPBNqM2z8fakk/NKel+Xzshgt8FFKAn+qwlD1pzZWxh0nVCrvFK7ZDb6XucZeF9z8C7CBWTRIVApAw==",
12956     -    2880 +      "license": "MIT"
12957     -    2881 +    },
12958     -1890 2882      "node_modules/debug": {
12959     -1891 2883        "version": "4.4.3",
12960     -1892 2884        "resolved": "https://registry.npmjs.org/debug/-/debug-4.4.3.tgz",
12961     -@@ -1919,6 +2911,15 @@
12962     -1919 2911        "dev": true,
12963     -1920 2912        "license": "MIT"
12964     -1921 2913      },
12965     -    2914 +    "node_modules/delaunator": {
12966     -    2915 +      "version": "5.0.1",
12967     -    2916 +      "resolved": "https://registry.npmjs.org/delaunator/-/delaunator-5.0.1.tgz",
12968     -    2917 +      "integrity": "sha512-8nvh+XBe96aCESrGOqMp/84b13H9cdKbG5P2ejQCh4d4sK9RL4371qou9drQjMhvnPmhWl5hnmqbEE0fXr9Xnw==",
12969     -    2918 +      "license": "ISC",
12970     -    2919 +      "dependencies": {
12971     -    2920 +        "robust-predicates": "^3.0.2"
12972     -    2921 +      }
12973     -    2922 +    },
12974     -1922 2923      "node_modules/depd": {
12975     -1923 2924        "version": "2.0.0",
12976     -1924 2925        "resolved": "https://registry.npmjs.org/depd/-/depd-2.0.0.tgz",
12977     -@@ -2365,6 +3366,17 @@
12978     -2365 3366        "dev": true,
12979     -2366 3367        "license": "MIT"
12980     -2367 3368      },
12981     -    3369 +    "node_modules/fast-png": {
12982     -    3370 +      "version": "6.4.0",
12983     -    3371 +      "resolved": "https://registry.npmjs.org/fast-png/-/fast-png-6.4.0.tgz",
12984     -    3372 +      "integrity": "sha512-kAqZq1TlgBjZcLr5mcN6NP5Rv4V2f22z00c3g8vRrwkcqjerx7BEhPbOnWCPqaHUl2XWQBJQvOT/FQhdMT7X/Q==",
12985     -    3373 +      "license": "MIT",
12986     -    3374 +      "dependencies": {
12987     -    3375 +        "@types/pako": "^2.0.3",
12988     -    3376 +        "iobuffer": "^5.3.2",
12989     -    3377 +        "pako": "^2.1.0"
12990     -    3378 +      }
12991     -    3379 +    },
12992     -2368 3380      "node_modules/fdir": {
12993     -2369 3381        "version": "6.5.0",
12994     -2370 3382        "resolved": "https://registry.npmjs.org/fdir/-/fdir-6.5.0.tgz",
12995     -@@ -2387,7 +3399,6 @@
12996     -2387 3399        "version": "0.8.2",
12997     -2388 3400        "resolved": "https://registry.npmjs.org/fflate/-/fflate-0.8.2.tgz",
12998     -2389 3401        "integrity": "sha512-cPJU47OaAoCbg0pBvzsgpTPhmhqI5eJjh/JIu8tPj5q+T7iLvW/JAYUqmE7KOB4R1ZyEhzBaIQpQpardBF5z8A==",
12999     -2390     -      "dev": true,
13000     -2391 3402        "license": "MIT"
13001     -2392 3403      },
13002     -2393 3404      "node_modules/file-entry-cache": {
13003     -@@ -2600,6 +3611,12 @@
13004     -2600 3611          "url": "https://github.com/sponsors/ljharb"
13005     -2601 3612        }
13006     -2602 3613      },
13007     -    3614 +    "node_modules/hachure-fill": {
13008     -    3615 +      "version": "0.5.2",
13009     -    3616 +      "resolved": "https://registry.npmjs.org/hachure-fill/-/hachure-fill-0.5.2.tgz",
13010     -    3617 +      "integrity": "sha512-3GKBOn+m2LX9iq+JC1064cSFprJY4jL1jCXTcpnfER5HYE2l/4EfWSGzkPa/ZDBmYI0ZOEj5VHV/eKnPGkHuOg==",
13011     -    3618 +      "license": "MIT"
13012     -    3619 +    },
13013     -2603 3620      "node_modules/has-flag": {
13014     -2604 3621        "version": "4.0.0",
13015     -2605 3622        "resolved": "https://registry.npmjs.org/has-flag/-/has-flag-4.0.0.tgz",
13016     -@@ -2656,6 +3673,29 @@
13017     -2656 3673        "dev": true,
13018     -2657 3674        "license": "MIT"
13019     -2658 3675      },
13020     -    3676 +    "node_modules/html2canvas": {
13021     -    3677 +      "version": "1.4.1",
13022     -    3678 +      "resolved": "https://registry.npmjs.org/html2canvas/-/html2canvas-1.4.1.tgz",
13023     -    3679 +      "integrity": "sha512-fPU6BHNpsyIhr8yyMpTLLxAbkaK8ArIBcmZIRiBLiDhjeqvXolaEmDGmELFuX9I4xDcaKKcJl+TKZLqruBbmWA==",
13024     -    3680 +      "license": "MIT",
13025     -    3681 +      "dependencies": {
13026     -    3682 +        "css-line-break": "^2.1.0",
13027     -    3683 +        "text-segmentation": "^1.0.3"
13028     -    3684 +      },
13029     -    3685 +      "engines": {
13030     -    3686 +        "node": ">=8.0.0"
13031     -    3687 +      }
13032     -    3688 +    },
13033     -    3689 +    "node_modules/html2pdf.js": {
13034     -    3690 +      "version": "0.12.1",
13035     -    3691 +      "resolved": "https://registry.npmjs.org/html2pdf.js/-/html2pdf.js-0.12.1.tgz",
13036     -    3692 +      "integrity": "sha512-3rBWQ96H5oOU9jtoz3MnE/epGi27ig9h8aonBk4JTpvUERM3lMRxhIRckhJZEi4wE0YfRINoYOIDY0hLY0CHgQ==",
13037     -    3693 +      "license": "MIT",
13038     -    3694 +      "dependencies": {
13039     -    3695 +        "html2canvas": "^1.0.0",
13040     -    3696 +        "jspdf": "^3.0.0"
13041     -    3697 +      }
13042     -    3698 +    },
13043     -2659 3699      "node_modules/http-errors": {
13044     -2660 3700        "version": "2.0.0",
13045     -2661 3701        "resolved": "https://registry.npmjs.org/http-errors/-/http-errors-2.0.0.tgz",
13046     -@@ -2705,7 +3745,6 @@
13047     -2705 3745        "version": "0.6.3",
13048     -2706 3746        "resolved": "https://registry.npmjs.org/iconv-lite/-/iconv-lite-0.6.3.tgz",
13049     -2707 3747        "integrity": "sha512-4fCk79wshMdzMp2rH06qWrJE4iolqLhCUH+OiuIgU++RB0+94NlDL81atO7GX55uUKueo0txHNtvEyI6D7WdMw==",
13050     -2708     -      "dev": true,
13051     -2709 3748        "license": "MIT",
13052     -2710 3749        "dependencies": {
13053     -2711 3750          "safer-buffer": ">= 2.1.2 < 3.0.0"
13054     -@@ -2758,6 +3797,21 @@
13055     -2758 3797        "dev": true,
13056     -2759 3798        "license": "ISC"
13057     -2760 3799      },
13058     -    3800 +    "node_modules/internmap": {
13059     -    3801 +      "version": "2.0.3",
13060     -    3802 +      "resolved": "https://registry.npmjs.org/internmap/-/internmap-2.0.3.tgz",
13061     -    3803 +      "integrity": "sha512-5Hh7Y1wQbvY5ooGgPbDaL5iYLAPzMTUrjMulskHLH6wnv/A+1q5rgEaiuqEjB+oxGXIVZs1FF+R/KPN3ZSQYYg==",
13062     -    3804 +      "license": "ISC",
13063     -    3805 +      "engines": {
13064     -    3806 +        "node": ">=12"
13065     -    3807 +      }
13066     -    3808 +    },
13067     -    3809 +    "node_modules/iobuffer": {
13068     -    3810 +      "version": "5.4.0",
13069     -    3811 +      "resolved": "https://registry.npmjs.org/iobuffer/-/iobuffer-5.4.0.tgz",
13070     -    3812 +      "integrity": "sha512-DRebOWuqDvxunfkNJAlc3IzWIPD5xVxwUNbHr7xKB8E6aLJxIPfNX3CoMJghcFjpv6RWQsrcJbghtEwSPoJqMA==",
13071     -    3813 +      "license": "MIT"
13072     -    3814 +    },
13073     -2761 3815      "node_modules/ipaddr.js": {
13074     -2762 3816        "version": "1.9.1",
13075     -2763 3817        "resolved": "https://registry.npmjs.org/ipaddr.js/-/ipaddr.js-1.9.1.tgz",
13076     -@@ -2940,6 +3994,39 @@
13077     -2940 3994        "dev": true,
13078     -2941 3995        "license": "MIT"
13079     -2942 3996      },
13080     -    3997 +    "node_modules/jspdf": {
13081     -    3998 +      "version": "3.0.4",
13082     -    3999 +      "resolved": "https://registry.npmjs.org/jspdf/-/jspdf-3.0.4.tgz",
13083     -    4000 +      "integrity": "sha512-dc6oQ8y37rRcHn316s4ngz/nOjayLF/FFxBF4V9zamQKRqXxyiH1zagkCdktdWhtoQId5K20xt1lB90XzkB+hQ==",
13084     -    4001 +      "license": "MIT",
13085     -    4002 +      "dependencies": {
13086     -    4003 +        "@babel/runtime": "^7.28.4",
13087     -    4004 +        "fast-png": "^6.2.0",
13088     -    4005 +        "fflate": "^0.8.1"
13089     -    4006 +      },
13090     -    4007 +      "optionalDependencies": {
13091     -    4008 +        "canvg": "^3.0.11",
13092     -    4009 +        "core-js": "^3.6.0",
13093     -    4010 +        "dompurify": "^3.2.4",
13094     -    4011 +        "html2canvas": "^1.0.0-rc.5"
13095     -    4012 +      }
13096     -    4013 +    },
13097     -    4014 +    "node_modules/katex": {
13098     -    4015 +      "version": "0.16.27",
13099     -    4016 +      "resolved": "https://registry.npmjs.org/katex/-/katex-0.16.27.tgz",
13100     -    4017 +      "integrity": "sha512-aeQoDkuRWSqQN6nSvVCEFvfXdqo1OQiCmmW1kc9xSdjutPv7BGO7pqY9sQRJpMOGrEdfDgF2TfRXe5eUAD2Waw==",
13101     -    4018 +      "funding": [
13102     -    4019 +        "https://opencollective.com/katex",
13103     -    4020 +        "https://github.com/sponsors/katex"
13104     -    4021 +      ],
13105     -    4022 +      "license": "MIT",
13106     -    4023 +      "dependencies": {
13107     -    4024 +        "commander": "^8.3.0"
13108     -    4025 +      },
13109     -    4026 +      "bin": {
13110     -    4027 +        "katex": "cli.js"
13111     -    4028 +      }
13112     -    4029 +    },
13113     -2943 4030      "node_modules/keyv": {
13114     -2944 4031        "version": "4.5.4",
13115     -2945 4032        "resolved": "https://registry.npmjs.org/keyv/-/keyv-4.5.4.tgz",
13116     -@@ -2950,6 +4037,33 @@
13117     -2950 4037          "json-buffer": "3.0.1"
13118     -2951 4038        }
13119     -2952 4039      },
13120     -    4040 +    "node_modules/khroma": {
13121     -    4041 +      "version": "2.1.0",
13122     -    4042 +      "resolved": "https://registry.npmjs.org/khroma/-/khroma-2.1.0.tgz",
13123     -    4043 +      "integrity": "sha512-Ls993zuzfayK269Svk9hzpeGUKob/sIgZzyHYdjQoAdQetRKpOLj+k/QQQ/6Qi0Yz65mlROrfd+Ev+1+7dz9Kw=="
13124     -    4044 +    },
13125     -    4045 +    "node_modules/langium": {
13126     -    4046 +      "version": "3.3.1",
13127     -    4047 +      "resolved": "https://registry.npmjs.org/langium/-/langium-3.3.1.tgz",
13128     -    4048 +      "integrity": "sha512-QJv/h939gDpvT+9SiLVlY7tZC3xB2qK57v0J04Sh9wpMb6MP1q8gB21L3WIo8T5P1MSMg3Ep14L7KkDCFG3y4w==",
13129     -    4049 +      "license": "MIT",
13130     -    4050 +      "dependencies": {
13131     -    4051 +        "chevrotain": "~11.0.3",
13132     -    4052 +        "chevrotain-allstar": "~0.3.0",
13133     -    4053 +        "vscode-languageserver": "~9.0.1",
13134     -    4054 +        "vscode-languageserver-textdocument": "~1.0.11",
13135     -    4055 +        "vscode-uri": "~3.0.8"
13136     -    4056 +      },
13137     -    4057 +      "engines": {
13138     -    4058 +        "node": ">=16.0.0"
13139     -    4059 +      }
13140     -    4060 +    },
13141     -    4061 +    "node_modules/layout-base": {
13142     -    4062 +      "version": "1.0.2",
13143     -    4063 +      "resolved": "https://registry.npmjs.org/layout-base/-/layout-base-1.0.2.tgz",
13144     -    4064 +      "integrity": "sha512-8h2oVEZNktL4BH2JCOI90iD1yXwL6iNW7KcCKT2QZgQJR2vbqDsldCTPRU9NifTCqHZci57XvQQ15YTu+sTYPg==",
13145     -    4065 +      "license": "MIT"
13146     -    4066 +    },
13147     -2953 4067      "node_modules/levn": {
13148     -2954 4068        "version": "0.4.1",
13149     -2955 4069        "resolved": "https://registry.npmjs.org/levn/-/levn-0.4.1.tgz",
13150     -@@ -2980,6 +4094,12 @@
13151     -2980 4094          "url": "https://github.com/sponsors/sindresorhus"
13152     -2981 4095        }
13153     -2982 4096      },
13154     -    4097 +    "node_modules/lodash-es": {
13155     -    4098 +      "version": "4.17.21",
13156     -    4099 +      "resolved": "https://registry.npmjs.org/lodash-es/-/lodash-es-4.17.21.tgz",
13157     -    4100 +      "integrity": "sha512-mKnC+QJ9pWVzv+C4/U3rRsHapFfHvQFoFB92e52xeyGMcX6/OlIl78je1u8vePzYZSkkogMPJ2yjxxsb89cxyw==",
13158     -    4101 +      "license": "MIT"
13159     -    4102 +    },
13160     -2983 4103      "node_modules/lodash.merge": {
13161     -2984 4104        "version": "4.6.2",
13162     -2985 4105        "resolved": "https://registry.npmjs.org/lodash.merge/-/lodash.merge-4.6.2.tgz",
13163     -@@ -3040,7 +4160,6 @@
13164     -3040 4160        "resolved": "https://registry.npmjs.org/marked/-/marked-17.0.1.tgz",
13165     -3041 4161        "integrity": "sha512-boeBdiS0ghpWcSwoNm/jJBwdpFaMnZWRzjA6SkUMYb40SVaN1x7mmfGKp0jvexGcx+7y2La5zRZsYFZI6Qpypg==",
13166     -3042 4162        "license": "MIT",
13167     -3043     -      "peer": true,
13168     -3044 4163        "bin": {
13169     -3045 4164          "marked": "bin/marked.js"
13170     -3046 4165        },
13171     -@@ -3094,6 +4213,46 @@
13172     -3094 4213          "url": "https://github.com/sponsors/sindresorhus"
13173     -3095 4214        }
13174     -3096 4215      },
13175     -    4216 +    "node_modules/mermaid": {
13176     -    4217 +      "version": "11.12.2",
13177     -    4218 +      "resolved": "https://registry.npmjs.org/mermaid/-/mermaid-11.12.2.tgz",
13178     -    4219 +      "integrity": "sha512-n34QPDPEKmaeCG4WDMGy0OT6PSyxKCfy2pJgShP+Qow2KLrvWjclwbc3yXfSIf4BanqWEhQEpngWwNp/XhZt6w==",
13179     -    4220 +      "license": "MIT",
13180     -    4221 +      "dependencies": {
13181     -    4222 +        "@braintree/sanitize-url": "^7.1.1",
13182     -    4223 +        "@iconify/utils": "^3.0.1",
13183     -    4224 +        "@mermaid-js/parser": "^0.6.3",
13184     -    4225 +        "@types/d3": "^7.4.3",
13185     -    4226 +        "cytoscape": "^3.29.3",
13186     -    4227 +        "cytoscape-cose-bilkent": "^4.1.0",
13187     -    4228 +        "cytoscape-fcose": "^2.2.0",
13188     -    4229 +        "d3": "^7.9.0",
13189     -    4230 +        "d3-sankey": "^0.12.3",
13190     -    4231 +        "dagre-d3-es": "7.0.13",
13191     -    4232 +        "dayjs": "^1.11.18",
13192     -    4233 +        "dompurify": "^3.2.5",
13193     -    4234 +        "katex": "^0.16.22",
13194     -    4235 +        "khroma": "^2.1.0",
13195     -    4236 +        "lodash-es": "^4.17.21",
13196     -    4237 +        "marked": "^16.2.1",
13197     -    4238 +        "roughjs": "^4.6.6",
13198     -    4239 +        "stylis": "^4.3.6",
13199     -    4240 +        "ts-dedent": "^2.2.0",
13200     -    4241 +        "uuid": "^11.1.0"
13201     -    4242 +      }
13202     -    4243 +    },
13203     -    4244 +    "node_modules/mermaid/node_modules/marked": {
13204     -    4245 +      "version": "16.4.2",
13205     -    4246 +      "resolved": "https://registry.npmjs.org/marked/-/marked-16.4.2.tgz",
13206     -    4247 +      "integrity": "sha512-TI3V8YYWvkVf3KJe1dRkpnjs68JUPyEa5vjKrp1XEEJUAOaQc+Qj+L1qWbPd0SJuAdQkFU0h73sXXqwDYxsiDA==",
13207     -    4248 +      "license": "MIT",
13208     -    4249 +      "bin": {
13209     -    4250 +        "marked": "bin/marked.js"
13210     -    4251 +      },
13211     -    4252 +      "engines": {
13212     -    4253 +        "node": ">= 20"
13213     -    4254 +      }
13214     -    4255 +    },
13215     -3097 4256      "node_modules/methods": {
13216     -3098 4257        "version": "1.1.2",
13217     -3099 4258        "resolved": "https://registry.npmjs.org/methods/-/methods-1.1.2.tgz",
13218     -@@ -3153,6 +4312,18 @@
13219     -3153 4312          "node": "*"
13220     -3154 4313        }
13221     -3155 4314      },
13222     -    4315 +    "node_modules/mlly": {
13223     -    4316 +      "version": "1.8.0",
13224     -    4317 +      "resolved": "https://registry.npmjs.org/mlly/-/mlly-1.8.0.tgz",
13225     -    4318 +      "integrity": "sha512-l8D9ODSRWLe2KHJSifWGwBqpTZXIXTeo8mlKjY+E2HAakaTeNpqAyBZ8GSqLzHgw4XmHmC8whvpjJNMbFZN7/g==",
13226     -    4319 +      "license": "MIT",
13227     -    4320 +      "dependencies": {
13228     -    4321 +        "acorn": "^8.15.0",
13229     -    4322 +        "pathe": "^2.0.3",
13230     -    4323 +        "pkg-types": "^1.3.1",
13231     -    4324 +        "ufo": "^1.6.1"
13232     -    4325 +      }
13233     -    4326 +    },
13234     -3156 4327      "node_modules/mrmime": {
13235     -3157 4328        "version": "2.0.1",
13236     -3158 4329        "resolved": "https://registry.npmjs.org/mrmime/-/mrmime-2.0.1.tgz",
13237     -@@ -3292,6 +4463,18 @@
13238     -3292 4463          "url": "https://github.com/sponsors/sindresorhus"
13239     -3293 4464        }
13240     -3294 4465      },
13241     -    4466 +    "node_modules/package-manager-detector": {
13242     -    4467 +      "version": "1.6.0",
13243     -    4468 +      "resolved": "https://registry.npmjs.org/package-manager-detector/-/package-manager-detector-1.6.0.tgz",
13244     -    4469 +      "integrity": "sha512-61A5ThoTiDG/C8s8UMZwSorAGwMJ0ERVGj2OjoW5pAalsNOg15+iQiPzrLJ4jhZ1HJzmC2PIHT2oEiH3R5fzNA==",
13245     -    4470 +      "license": "MIT"
13246     -    4471 +    },
13247     -    4472 +    "node_modules/pako": {
13248     -    4473 +      "version": "2.1.0",
13249     -    4474 +      "resolved": "https://registry.npmjs.org/pako/-/pako-2.1.0.tgz",
13250     -    4475 +      "integrity": "sha512-w+eufiZ1WuJYgPXbV/PO3NCMEc3xqylkKHzp8bxp1uW4qaSNQUkwmLLEc3kKsfz8lpV1F8Ht3U1Cm+9Srog2ug==",
13251     -    4476 +      "license": "(MIT AND Zlib)"
13252     -    4477 +    },
13253     -3295 4478      "node_modules/parent-module": {
13254     -3296 4479        "version": "1.0.1",
13255     -3297 4480        "resolved": "https://registry.npmjs.org/parent-module/-/parent-module-1.0.1.tgz",
13256     -@@ -3328,6 +4511,12 @@
13257     -3328 4511          "node": ">= 0.8"
13258     -3329 4512        }
13259     -3330 4513      },
13260     -    4514 +    "node_modules/path-data-parser": {
13261     -    4515 +      "version": "0.1.0",
13262     -    4516 +      "resolved": "https://registry.npmjs.org/path-data-parser/-/path-data-parser-0.1.0.tgz",
13263     -    4517 +      "integrity": "sha512-NOnmBpt5Y2RWbuv0LMzsayp3lVylAHLPUTut412ZA3l+C4uw4ZVkQbjShYCQ8TCpUMdPapr4YjUqLYD6v68j+w==",
13264     -    4518 +      "license": "MIT"
13265     -    4519 +    },
13266     -3331 4520      "node_modules/path-exists": {
13267     -3332 4521        "version": "4.0.0",
13268     -3333 4522        "resolved": "https://registry.npmjs.org/path-exists/-/path-exists-4.0.0.tgz",
13269     -@@ -3359,9 +4548,15 @@
13270     -3359 4548        "version": "2.0.3",
13271     -3360 4549        "resolved": "https://registry.npmjs.org/pathe/-/pathe-2.0.3.tgz",
13272     -3361 4550        "integrity": "sha512-WUjGcAqP1gQacoQe+OBJsFA7Ld4DyXuUIjZ5cc75cLHvJ7dtNsTugphxIADwspS+AraAUePCKrSVtPLFj/F88w==",
13273     -3362     -      "dev": true,
13274     -3363 4551        "license": "MIT"
13275     -3364 4552      },
13276     -    4553 +    "node_modules/performance-now": {
13277     -    4554 +      "version": "2.1.0",
13278     -    4555 +      "resolved": "https://registry.npmjs.org/performance-now/-/performance-now-2.1.0.tgz",
13279     -    4556 +      "integrity": "sha512-7EAHlyLHI56VEIdK57uwHdHKIaAGbnXPiw0yWbarQZOKaKpvUIgW0jWRVLiatnM+XXlSwsanIBH/hzGMJulMow==",
13280     -    4557 +      "license": "MIT",
13281     -    4558 +      "optional": true
13282     -    4559 +    },
13283     -3365 4560      "node_modules/picocolors": {
13284     -3366 4561        "version": "1.1.1",
13285     -3367 4562        "resolved": "https://registry.npmjs.org/picocolors/-/picocolors-1.1.1.tgz",
13286     -@@ -3382,6 +4577,33 @@
13287     -3382 4577          "url": "https://github.com/sponsors/jonschlinkert"
13288     -3383 4578        }
13289     -3384 4579      },
13290     -    4580 +    "node_modules/pkg-types": {
13291     -    4581 +      "version": "1.3.1",
13292     -    4582 +      "resolved": "https://registry.npmjs.org/pkg-types/-/pkg-types-1.3.1.tgz",
13293     -    4583 +      "integrity": "sha512-/Jm5M4RvtBFVkKWRu2BLUTNP8/M2a+UwuAX+ae4770q1qVGtfjG+WTCupoZixokjmHiry8uI+dlY8KXYV5HVVQ==",
13294     -    4584 +      "license": "MIT",
13295     -    4585 +      "dependencies": {
13296     -    4586 +        "confbox": "^0.1.8",
13297     -    4587 +        "mlly": "^1.7.4",
13298     -    4588 +        "pathe": "^2.0.1"
13299     -    4589 +      }
13300     -    4590 +    },
13301     -    4591 +    "node_modules/points-on-curve": {
13302     -    4592 +      "version": "0.2.0",
13303     -    4593 +      "resolved": "https://registry.npmjs.org/points-on-curve/-/points-on-curve-0.2.0.tgz",
13304     -    4594 +      "integrity": "sha512-0mYKnYYe9ZcqMCWhUjItv/oHjvgEsfKvnUTg8sAtnHr3GVy7rGkXCb6d5cSyqrWqL4k81b9CPg3urd+T7aop3A==",
13305     -    4595 +      "license": "MIT"
13306     -    4596 +    },
13307     -    4597 +    "node_modules/points-on-path": {
13308     -    4598 +      "version": "0.2.1",
13309     -    4599 +      "resolved": "https://registry.npmjs.org/points-on-path/-/points-on-path-0.2.1.tgz",
13310     -    4600 +      "integrity": "sha512-25ClnWWuw7JbWZcgqY/gJ4FQWadKxGWk+3kR/7kD0tCaDtPPMj7oHu2ToLaVhfpnHrZzYby2w6tUA0eOIuUg8g==",
13311     -    4601 +      "license": "MIT",
13312     -    4602 +      "dependencies": {
13313     -    4603 +        "path-data-parser": "0.1.0",
13314     -    4604 +        "points-on-curve": "0.2.0"
13315     -    4605 +      }
13316     -    4606 +    },
13317     -3385 4607      "node_modules/postcss": {
13318     -3386 4608        "version": "8.5.6",
13319     -3387 4609        "resolved": "https://registry.npmjs.org/postcss/-/postcss-8.5.6.tgz",
13320     -@@ -3437,6 +4659,15 @@
13321     -3437 4659          "url": "https://github.com/prettier/prettier?sponsor=1"
13322     -3438 4660        }
13323     -3439 4661      },
13324     -    4662 +    "node_modules/prismjs": {
13325     -    4663 +      "version": "1.30.0",
13326     -    4664 +      "resolved": "https://registry.npmjs.org/prismjs/-/prismjs-1.30.0.tgz",
13327     -    4665 +      "integrity": "sha512-DEvV2ZF2r2/63V+tK8hQvrR2ZGn10srHbXviTlcv7Kpzw8jWiNTqbVgjO3IY8RxrrOUF8VPMQQFysYYYv0YZxw==",
13328     -    4666 +      "license": "MIT",
13329     -    4667 +      "engines": {
13330     -    4668 +        "node": ">=6"
13331     -    4669 +      }
13332     -    4670 +    },
13333     -3440 4671      "node_modules/proxy-addr": {
13334     -3441 4672        "version": "2.0.7",
13335     -3442 4673        "resolved": "https://registry.npmjs.org/proxy-addr/-/proxy-addr-2.0.7.tgz",
13336     -@@ -3477,6 +4708,16 @@
13337     -3477 4708          "url": "https://github.com/sponsors/ljharb"
13338     -3478 4709        }
13339     -3479 4710      },
13340     -    4711 +    "node_modules/raf": {
13341     -    4712 +      "version": "3.4.1",
13342     -    4713 +      "resolved": "https://registry.npmjs.org/raf/-/raf-3.4.1.tgz",
13343     -    4714 +      "integrity": "sha512-Sq4CW4QhwOHE8ucn6J34MqtZCeWFP2aQSmrlroYgqAV1PjStIhJXxYuTgUIfkEk7zTLjmIjLmU5q+fbD1NnOJA==",
13344     -    4715 +      "license": "MIT",
13345     -    4716 +      "optional": true,
13346     -    4717 +      "dependencies": {
13347     -    4718 +        "performance-now": "^2.1.0"
13348     -    4719 +      }
13349     -    4720 +    },
13350     -3480 4721      "node_modules/range-parser": {
13351     -3481 4722        "version": "1.2.1",
13352     -3482 4723        "resolved": "https://registry.npmjs.org/range-parser/-/range-parser-1.2.1.tgz",
13353     -@@ -3516,6 +4757,13 @@
13354     -3516 4757          "node": ">=0.10.0"
13355     -3517 4758        }
13356     -3518 4759      },
13357     -    4760 +    "node_modules/regenerator-runtime": {
13358     -    4761 +      "version": "0.13.11",
13359     -    4762 +      "resolved": "https://registry.npmjs.org/regenerator-runtime/-/regenerator-runtime-0.13.11.tgz",
13360     -    4763 +      "integrity": "sha512-kY1AZVr2Ra+t+piVaJ4gxaFaReZVH40AKNo7UCX6W+dEwBo/2oZJzqfuN1qLq1oL45o56cPaTXELwrTh8Fpggg==",
13361     -    4764 +      "license": "MIT",
13362     -    4765 +      "optional": true
13363     -    4766 +    },
13364     -3519 4767      "node_modules/require-from-string": {
13365     -3520 4768        "version": "2.0.2",
13366     -3521 4769        "resolved": "https://registry.npmjs.org/require-from-string/-/require-from-string-2.0.2.tgz",
13367     -@@ -3536,6 +4784,22 @@
13368     -3536 4784          "node": ">=4"
13369     -3537 4785        }
13370     -3538 4786      },
13371     -    4787 +    "node_modules/rgbcolor": {
13372     -    4788 +      "version": "1.0.1",
13373     -    4789 +      "resolved": "https://registry.npmjs.org/rgbcolor/-/rgbcolor-1.0.1.tgz",
13374     -    4790 +      "integrity": "sha512-9aZLIrhRaD97sgVhtJOW6ckOEh6/GnvQtdVNfdZ6s67+3/XwLS9lBcQYzEEhYVeUowN7pRzMLsyGhK2i/xvWbw==",
13375     -    4791 +      "license": "MIT OR SEE LICENSE IN FEEL-FREE.md",
13376     -    4792 +      "optional": true,
13377     -    4793 +      "engines": {
13378     -    4794 +        "node": ">= 0.8.15"
13379     -    4795 +      }
13380     -    4796 +    },
13381     -    4797 +    "node_modules/robust-predicates": {
13382     -    4798 +      "version": "3.0.2",
13383     -    4799 +      "resolved": "https://registry.npmjs.org/robust-predicates/-/robust-predicates-3.0.2.tgz",
13384     -    4800 +      "integrity": "sha512-IXgzBWvWQwE6PrDI05OvmXUIruQTcoMDzRsOd5CDvHCVLcLHMTSYvOK5Cm46kWqlV3yAbuSpBZdJ5oP5OUoStg==",
13385     -    4801 +      "license": "Unlicense"
13386     -    4802 +    },
13387     -3539 4803      "node_modules/rollup": {
13388     -3540 4804        "version": "4.53.1",
13389     -3541 4805        "resolved": "https://registry.npmjs.org/rollup/-/rollup-4.53.1.tgz",
13390     -@@ -3578,6 +4842,24 @@
13391     -3578 4842          "fsevents": "~2.3.2"
13392     -3579 4843        }
13393     -3580 4844      },
13394     -    4845 +    "node_modules/roughjs": {
13395     -    4846 +      "version": "4.6.6",
13396     -    4847 +      "resolved": "https://registry.npmjs.org/roughjs/-/roughjs-4.6.6.tgz",
13397     -    4848 +      "integrity": "sha512-ZUz/69+SYpFN/g/lUlo2FXcIjRkSu3nDarreVdGGndHEBJ6cXPdKguS8JGxwj5HA5xIbVKSmLgr5b3AWxtRfvQ==",
13398     -    4849 +      "license": "MIT",
13399     -    4850 +      "dependencies": {
13400     -    4851 +        "hachure-fill": "^0.5.2",
13401     -    4852 +        "path-data-parser": "^0.1.0",
13402     -    4853 +        "points-on-curve": "^0.2.0",
13403     -    4854 +        "points-on-path": "^0.2.1"
13404     -    4855 +      }
13405     -    4856 +    },
13406     -    4857 +    "node_modules/rw": {
13407     -    4858 +      "version": "1.3.3",
13408     -    4859 +      "resolved": "https://registry.npmjs.org/rw/-/rw-1.3.3.tgz",
13409     -    4860 +      "integrity": "sha512-PdhdWy89SiZogBLaw42zdeqtRJ//zFd2PgQavcICDUgJT5oW10QCRKbJ6bg4r0/UY2M6BWd5tkxuGFRvCkgfHQ==",
13410     -    4861 +      "license": "BSD-3-Clause"
13411     -    4862 +    },
13412     -3581 4863      "node_modules/safe-buffer": {
13413     -3582 4864        "version": "5.2.1",
13414     -3583 4865        "resolved": "https://registry.npmjs.org/safe-buffer/-/safe-buffer-5.2.1.tgz",
13415     -@@ -3603,7 +4885,6 @@
13416     -3603 4885        "version": "2.1.2",
13417     -3604 4886        "resolved": "https://registry.npmjs.org/safer-buffer/-/safer-buffer-2.1.2.tgz",
13418     -3605 4887        "integrity": "sha512-YZo3K82SD7Riyi0E1EQPojLz7kpepnSQI9IyPbHHg1XXXevb5dJI7tpyN2ADxGcQbHG7vcyRHk0cbwqcQriUtg==",
13419     -3606     -      "dev": true,
13420     -3607 4888        "license": "MIT"
13421     -3608 4889      },
13422     -3609 4890      "node_modules/saxes": {
13423     -@@ -3845,6 +5126,16 @@
13424     -3845 5126        "dev": true,
13425     -3846 5127        "license": "MIT"
13426     -3847 5128      },
13427     -    5129 +    "node_modules/stackblur-canvas": {
13428     -    5130 +      "version": "2.7.0",
13429     -    5131 +      "resolved": "https://registry.npmjs.org/stackblur-canvas/-/stackblur-canvas-2.7.0.tgz",
13430     -    5132 +      "integrity": "sha512-yf7OENo23AGJhBriGx0QivY5JP6Y1HbrrDI6WLt6C5auYZXlQrheoY8hD4ibekFKz1HOfE48Ww8kMWMnJD/zcQ==",
13431     -    5133 +      "license": "MIT",
13432     -    5134 +      "optional": true,
13433     -    5135 +      "engines": {
13434     -    5136 +        "node": ">=0.1.14"
13435     -    5137 +      }
13436     -    5138 +    },
13437     -3848 5139      "node_modules/statuses": {
13438     -3849 5140        "version": "2.0.1",
13439     -3850 5141        "resolved": "https://registry.npmjs.org/statuses/-/statuses-2.0.1.tgz",
13440     -@@ -3875,6 +5166,12 @@
13441     -3875 5166          "url": "https://github.com/sponsors/sindresorhus"
13442     -3876 5167        }
13443     -3877 5168      },
13444     -    5169 +    "node_modules/stylis": {
13445     -    5170 +      "version": "4.3.6",
13446     -    5171 +      "resolved": "https://registry.npmjs.org/stylis/-/stylis-4.3.6.tgz",
13447     -    5172 +      "integrity": "sha512-yQ3rwFWRfwNUY7H5vpU0wfdkNSnvnJinhF9830Swlaxl03zsOjCfmX0ugac+3LtK0lYSgwL/KXc8oYL3mG4YFQ==",
13448     -    5173 +      "license": "MIT"
13449     -    5174 +    },
13450     -3878 5175      "node_modules/supports-color": {
13451     -3879 5176        "version": "7.2.0",
13452     -3880 5177        "resolved": "https://registry.npmjs.org/supports-color/-/supports-color-7.2.0.tgz",
13453     -@@ -3888,6 +5185,16 @@
13454     -3888 5185          "node": ">=8"
13455     -3889 5186        }
13456     -3890 5187      },
13457     -    5188 +    "node_modules/svg-pathdata": {
13458     -    5189 +      "version": "6.0.3",
13459     -    5190 +      "resolved": "https://registry.npmjs.org/svg-pathdata/-/svg-pathdata-6.0.3.tgz",
13460     -    5191 +      "integrity": "sha512-qsjeeq5YjBZ5eMdFuUa4ZosMLxgr5RZ+F+Y1OrDhuOCEInRMA3x74XdBtggJcj9kOeInz0WE+LgCPDkZFlBYJw==",
13461     -    5192 +      "license": "MIT",
13462     -    5193 +      "optional": true,
13463     -    5194 +      "engines": {
13464     -    5195 +        "node": ">=12.0.0"
13465     -    5196 +      }
13466     -    5197 +    },
13467     -3891 5198      "node_modules/symbol-tree": {
13468     -3892 5199        "version": "3.2.4",
13469     -3893 5200        "resolved": "https://registry.npmjs.org/symbol-tree/-/symbol-tree-3.2.4.tgz",
13470     -@@ -3895,6 +5202,15 @@
13471     -3895 5202        "dev": true,
13472     -3896 5203        "license": "MIT"
13473     -3897 5204      },
13474     -    5205 +    "node_modules/text-segmentation": {
13475     -    5206 +      "version": "1.0.3",
13476     -    5207 +      "resolved": "https://registry.npmjs.org/text-segmentation/-/text-segmentation-1.0.3.tgz",
13477     -    5208 +      "integrity": "sha512-iOiPUo/BGnZ6+54OsWxZidGCsdU8YbE4PSpdPinp7DeMtUJNJBoJ/ouUSTJjHkh1KntHaltHl/gDs2FC4i5+Nw==",
13478     -    5209 +      "license": "MIT",
13479     -    5210 +      "dependencies": {
13480     -    5211 +        "utrie": "^1.0.2"
13481     -    5212 +      }
13482     -    5213 +    },
13483     -3898 5214      "node_modules/tinybench": {
13484     -3899 5215        "version": "2.9.0",
13485     -3900 5216        "resolved": "https://registry.npmjs.org/tinybench/-/tinybench-2.9.0.tgz",
13486     -@@ -4002,6 +5318,15 @@
13487     -4002 5318          "node": ">=20"
13488     -4003 5319        }
13489     -4004 5320      },
13490     -    5321 +    "node_modules/ts-dedent": {
13491     -    5322 +      "version": "2.2.0",
13492     -    5323 +      "resolved": "https://registry.npmjs.org/ts-dedent/-/ts-dedent-2.2.0.tgz",
13493     -    5324 +      "integrity": "sha512-q5W7tVM71e2xjHZTlgfTDoPF/SmqKG5hddq9SzR49CH2hayqRKJtQ4mtRlSxKaJlR/+9rEM+mnBHf7I2/BQcpQ==",
13494     -    5325 +      "license": "MIT",
13495     -    5326 +      "engines": {
13496     -    5327 +        "node": ">=6.10"
13497     -    5328 +      }
13498     -    5329 +    },
13499     -4005 5330      "node_modules/type-check": {
13500     -4006 5331        "version": "0.4.0",
13501     -4007 5332        "resolved": "https://registry.npmjs.org/type-check/-/type-check-0.4.0.tgz",
13502     -@@ -4043,6 +5368,12 @@
13503     -4043 5368          "node": ">=14.17"
13504     -4044 5369        }
13505     -4045 5370      },
13506     -    5371 +    "node_modules/ufo": {
13507     -    5372 +      "version": "1.6.1",
13508     -    5373 +      "resolved": "https://registry.npmjs.org/ufo/-/ufo-1.6.1.tgz",
13509     -    5374 +      "integrity": "sha512-9a4/uxlTWJ4+a5i0ooc1rU7C7YOw3wT+UGqdeNNHWnOF9qcMBgLRS+4IYUqbczewFx4mLEig6gawh7X6mFlEkA==",
13510     -    5375 +      "license": "MIT"
13511     -    5376 +    },
13512     -4046 5377      "node_modules/unpipe": {
13513     -4047 5378        "version": "1.0.0",
13514     -4048 5379        "resolved": "https://registry.npmjs.org/unpipe/-/unpipe-1.0.0.tgz",
13515     -@@ -4073,6 +5404,28 @@
13516     -4073 5404          "node": ">= 0.4.0"
13517     -4074 5405        }
13518     -4075 5406      },
13519     -    5407 +    "node_modules/utrie": {
13520     -    5408 +      "version": "1.0.2",
13521     -    5409 +      "resolved": "https://registry.npmjs.org/utrie/-/utrie-1.0.2.tgz",
13522     -    5410 +      "integrity": "sha512-1MLa5ouZiOmQzUbjbu9VmjLzn1QLXBhwpUa7kdLUQK+KQ5KA9I1vk5U4YHe/X2Ch7PYnJfWuWT+VbuxbGwljhw==",
13523     -    5411 +      "license": "MIT",
13524     -    5412 +      "dependencies": {
13525     -    5413 +        "base64-arraybuffer": "^1.0.2"
13526     -    5414 +      }
13527     -    5415 +    },
13528     -    5416 +    "node_modules/uuid": {
13529     -    5417 +      "version": "11.1.0",
13530     -    5418 +      "resolved": "https://registry.npmjs.org/uuid/-/uuid-11.1.0.tgz",
13531     -    5419 +      "integrity": "sha512-0/A9rDy9P7cJ+8w1c9WD9V//9Wj15Ce2MPz8Ri6032usz+NfePxx5AcN3bN+r6ZL6jEo066/yNYB3tn4pQEx+A==",
13532     -    5420 +      "funding": [
13533     -    5421 +        "https://github.com/sponsors/broofa",
13534     -    5422 +        "https://github.com/sponsors/ctavan"
13535     -    5423 +      ],
13536     -    5424 +      "license": "MIT",
13537     -    5425 +      "bin": {
13538     -    5426 +        "uuid": "dist/esm/bin/uuid"
13539     -    5427 +      }
13540     -    5428 +    },
13541     -4076 5429      "node_modules/vary": {
13542     -4077 5430        "version": "1.1.2",
13543     -4078 5431        "resolved": "https://registry.npmjs.org/vary/-/vary-1.1.2.tgz",
13544     -@@ -4236,6 +5589,55 @@
13545     -4236 5589          }
13546     -4237 5590        }
13547     -4238 5591      },
13548     -    5592 +    "node_modules/vscode-jsonrpc": {
13549     -    5593 +      "version": "8.2.0",
13550     -    5594 +      "resolved": "https://registry.npmjs.org/vscode-jsonrpc/-/vscode-jsonrpc-8.2.0.tgz",
13551     -    5595 +      "integrity": "sha512-C+r0eKJUIfiDIfwJhria30+TYWPtuHJXHtI7J0YlOmKAo7ogxP20T0zxB7HZQIFhIyvoBPwWskjxrvAtfjyZfA==",
13552     -    5596 +      "license": "MIT",
13553     -    5597 +      "engines": {
13554     -    5598 +        "node": ">=14.0.0"
13555     -    5599 +      }
13556     -    5600 +    },
13557     -    5601 +    "node_modules/vscode-languageserver": {
13558     -    5602 +      "version": "9.0.1",
13559     -    5603 +      "resolved": "https://registry.npmjs.org/vscode-languageserver/-/vscode-languageserver-9.0.1.tgz",
13560     -    5604 +      "integrity": "sha512-woByF3PDpkHFUreUa7Hos7+pUWdeWMXRd26+ZX2A8cFx6v/JPTtd4/uN0/jB6XQHYaOlHbio03NTHCqrgG5n7g==",
13561     -    5605 +      "license": "MIT",
13562     -    5606 +      "dependencies": {
13563     -    5607 +        "vscode-languageserver-protocol": "3.17.5"
13564     -    5608 +      },
13565     -    5609 +      "bin": {
13566     -    5610 +        "installServerIntoExtension": "bin/installServerIntoExtension"
13567     -    5611 +      }
13568     -    5612 +    },
13569     -    5613 +    "node_modules/vscode-languageserver-protocol": {
13570     -    5614 +      "version": "3.17.5",
13571     -    5615 +      "resolved": "https://registry.npmjs.org/vscode-languageserver-protocol/-/vscode-languageserver-protocol-3.17.5.tgz",
13572     -    5616 +      "integrity": "sha512-mb1bvRJN8SVznADSGWM9u/b07H7Ecg0I3OgXDuLdn307rl/J3A9YD6/eYOssqhecL27hK1IPZAsaqh00i/Jljg==",
13573     -    5617 +      "license": "MIT",
13574     -    5618 +      "dependencies": {
13575     -    5619 +        "vscode-jsonrpc": "8.2.0",
13576     -    5620 +        "vscode-languageserver-types": "3.17.5"
13577     -    5621 +      }
13578     -    5622 +    },
13579     -    5623 +    "node_modules/vscode-languageserver-textdocument": {
13580     -    5624 +      "version": "1.0.12",
13581     -    5625 +      "resolved": "https://registry.npmjs.org/vscode-languageserver-textdocument/-/vscode-languageserver-textdocument-1.0.12.tgz",
13582     -    5626 +      "integrity": "sha512-cxWNPesCnQCcMPeenjKKsOCKQZ/L6Tv19DTRIGuLWe32lyzWhihGVJ/rcckZXJxfdKCFvRLS3fpBIsV/ZGX4zA==",
13583     -    5627 +      "license": "MIT"
13584     -    5628 +    },
13585     -    5629 +    "node_modules/vscode-languageserver-types": {
13586     -    5630 +      "version": "3.17.5",
13587     -    5631 +      "resolved": "https://registry.npmjs.org/vscode-languageserver-types/-/vscode-languageserver-types-3.17.5.tgz",
13588     -    5632 +      "integrity": "sha512-Ld1VelNuX9pdF39h2Hgaeb5hEZM2Z3jUrrMgWQAu82jMtZp7p3vJT3BzToKtZI7NgQssZje5o0zryOrhQvzQAg==",
13589     -    5633 +      "license": "MIT"
13590     -    5634 +    },
13591     -    5635 +    "node_modules/vscode-uri": {
13592     -    5636 +      "version": "3.0.8",
13593     -    5637 +      "resolved": "https://registry.npmjs.org/vscode-uri/-/vscode-uri-3.0.8.tgz",
13594     -    5638 +      "integrity": "sha512-AyFQ0EVmsOZOlAnxoFOGOq1SQDWAB7C6aqMGS23svWAllfOaxbuFvcT8D1i8z3Gyn8fraVeZNNmN6e9bxxXkKw==",
13595     -    5639 +      "license": "MIT"
13596     -    5640 +    },
13597     -4239 5641      "node_modules/w3c-xmlserializer": {
13598     -4240 5642        "version": "5.0.0",
13599     -4241 5643        "resolved": "https://registry.npmjs.org/w3c-xmlserializer/-/w3c-xmlserializer-5.0.0.tgz",
13600     -4242 5644  
13601     -
13602     -```
13603     -
13604     -
13605     -### üìÑ `package.json`
13606     -
13607     -**Type:** Configuration/Data File üìã
13608     -
13609     -```diff
13610     -@@ -42,6 +42,11 @@
13611     - 42  42    },
13612     - 43  43    "dependencies": {
13613     - 44  44      "dompurify": "3.3.1",
13614     - 45     -    "marked-footnote": "1.4.0"
13615     -     45 +    "html2pdf.js": "0.12.1",
13616     -     46 +    "katex": "0.16.27",
13617     -     47 +    "marked": "17.0.1",
13618     -     48 +    "marked-footnote": "1.4.0",
13619     -     49 +    "mermaid": "11.12.2",
13620     -     50 +    "prismjs": "1.30.0"
13621     - 46  51    }
13622     - 47  52  }
13623     - 48  53  
13624     -
13625     -```
13626     -
13627     -
13628     -### üìÑ `script.js`
13629     -
13630     -**Type:** JavaScript Source File üü®
13631     -
13632     -```diff
13633     -@@ -2,6 +2,26 @@
13634     -  2   2  
13635     -  3   3  // Import constants, utilities, services, and core modules
13636     -  4   4  import DOMPurify from 'dompurify';
13637     -      5 +import html2pdf from 'html2pdf.js';
13638     -      6 +import katex from 'katex';
13639     -      7 +import 'katex/dist/katex.min.css'; // Import KaTeX CSS
13640     -      8 +import { marked } from 'marked';
13641     -      9 +import markedFootnote from 'marked-footnote';
13642     -     10 +import mermaid from 'mermaid';
13643     -     11 +import Prism from 'prismjs';
13644     -     12 +import 'prismjs/components/prism-bash';
13645     -     13 +import 'prismjs/components/prism-c';
13646     -     14 +import 'prismjs/components/prism-cpp';
13647     -     15 +import 'prismjs/components/prism-css';
13648     -     16 +import 'prismjs/components/prism-java';
13649     -     17 +import 'prismjs/components/prism-javascript';
13650     -     18 +import 'prismjs/components/prism-json';
13651     -     19 +import 'prismjs/components/prism-markdown';
13652     -     20 +import 'prismjs/components/prism-python';
13653     -     21 +import 'prismjs/components/prism-sql';
13654     -     22 +import 'prismjs/components/prism-typescript';
13655     -     23 +import 'prismjs/themes/prism-tomorrow.css'; // Import Prism CSS
     97 +@@ -0,0 +1,1998 @@
     98 +      1 +# Markdown Rendering Test Document
     99 +      2 +
    100 +      3 +## Table of Contents
    101 +      4 +
    102 +      5 +- [Headers](#headers)
    103 +      6 +- [Text Formatting](#text-formatting)
    104 +      7 +- [Lists](#lists)
    105 +      8 +- [Links and Images](#links-and-images)
    106 +      9 +- [Code Blocks](#code-blocks)
    107 +     10 +- [Math Syntax](#math-syntax)
    108 +     11 +- [Tables](#tables)
    109 +     12 +- [Blockquotes](#blockquotes)
    110 +     13 +- [Mermaid Diagrams](#mermaid-diagrams)
    111 +     14 +- [Miscellaneous](#miscellaneous)
    112 +     15 +
    113 +     16 +---
    114 +     17 +
    115 +     18 +# H1 - Main Header
    116 +     19 +## H2 - Secondary Header
    117 +     20 +### H3 - Tertiary Header
    118 +     21 +#### H4 - Fourth Level
    119 +     22 +##### H5 - Fifth Level
    120 +     23 +###### H6 - Sixth Level
13656 121       24 +
13657     -  5  25  import { StorageManager } from './src/js/core/StorageManager.js';
13658     -  6  26  import { ThemeManager } from './src/js/core/ThemeManager.js';
13659     -  7  27  import { FolderBrowserService } from './src/js/services/FolderBrowserService.js';
13660     -@@ -9,6 +29,14 @@ import { MermaidService } from './src/js/services/MermaidService.js';
13661     -  9  29  import { PDFService } from './src/js/services/PDFService.js';
13662     - 10  30  import { PrismService } from './src/js/services/PrismService.js';
13663     - 11  31  
13664     -     32 +// Make libraries available globally for services if needed (backward compatibility)
13665     -     33 +window.marked = marked;
13666     -     34 +window.Prism = Prism;
13667     -     35 +window.mermaid = mermaid;
13668     -     36 +window.katex = katex;
13669     -     37 +window.html2pdf = html2pdf;
13670     -     38 +window.markedFootnote = markedFootnote;
13671     -     39 +
13672     - 12  40  // Initialize services and managers
13673     - 13  41  const storageManager = new StorageManager();
13674     - 14  42  const themeManager = new ThemeManager(storageManager);
13675     -@@ -36,61 +64,18 @@ themeManager.setThemeChangeListener(() => {
13676     - 36  64    }
13677     - 37  65  });
13678     - 38  66  
13679     - 39     -// Wait for all scripts to load
13680     -     67 +// Wait for DOM to be ready
13681     - 40  68  window.addEventListener('DOMContentLoaded', () => {
13682     - 41  69    initializeApp();
13683     - 42  70  });
13684     - 43  71  
13685     - 44  72  function initializeApp() {
13686     - 45     -  // Check if libraries are loaded
13687     - 46     -  if (
13688     - 47     -    typeof marked === 'undefined' ||
13689     - 48     -    typeof Prism === 'undefined' ||
13690     - 49     -    typeof mermaid === 'undefined'
13691     - 50     -  ) {
13692     - 51     -    console.error('Required libraries not loaded. Retrying...');
13693     - 52     -    setTimeout(initializeApp, 100);
13694     - 53     -    return;
13695     - 54     -  }
13696     - 55     -
13697     - 56     -  // Wait for html2pdf to load before setting up editor
13698     - 57     -  if (typeof html2pdf === 'undefined') {
13699     - 58     -    console.log('Waiting for html2pdf library...');
13700     - 59     -    setTimeout(initializeApp, 100);
13701     - 60     -    return;
13702     - 61     -  }
13703     - 62     -
13704     - 63     -  // Wait for KaTeX to load
13705     - 64     -  if (typeof katex === 'undefined') {
13706     - 65     -    console.log('Waiting for KaTeX library...');
13707     - 66     -    setTimeout(initializeApp, 100);
13708     - 67     -    return;
13709     - 68     -  }
13710     - 69     -
13711     - 70     -  // Wait for KaTeX auto-render to load
13712     - 71     -  if (typeof renderMathInElement === 'undefined') {
13713     - 72     -    console.log('Waiting for KaTeX auto-render...');
13714     - 73     -    setTimeout(initializeApp, 100);
13715     - 74     -    return;
13716     - 75     -  }
13717     - 76     -
13718     - 77     -  console.log('All libraries loaded successfully');
13719     - 78     -
13720     - 79     -  // Configure Prism autoloader with correct CDN path
13721     - 80     -  if (typeof Prism !== 'undefined' && Prism.plugins && Prism.plugins.autoloader) {
13722     - 81     -    Prism.plugins.autoloader.languages_path =
13723     - 82     -      'https://cdn.jsdelivr.net/npm/prismjs@1.29.0/components/';
13724     - 83     -    console.log('‚úÖ Prism autoloader configured - 200+ languages available');
13725     - 84     -  }
13726     - 85     -
13727     - 86     -  console.log('‚úÖ KaTeX loaded - Math formula rendering available');
13728     -     73 +  console.log('üöÄ Initializing Enterprise Markdown Viewer...');
13729     - 87  74  
13730     - 88  75    // Configure marked.js extensions
13731     - 89  76    configureMarkedExtensions();
13732     - 90  77  
13733     - 91     -  // DON'T initialize Mermaid here - let saved theme load first
13734     - 92     -  // Mermaid will initialize after theme loads in setupEditor()
13735     - 93     -
13736     -     78 +  // Setup the editor
13737     - 94  79    setupEditor();
13738     - 95  80  }
13739     - 96  81  
13740     -@@ -114,10 +99,8 @@ function debounce(func, wait) {
13741     -114  99  // Configure marked.js extensions (math + footnotes + admonitions)
13742     -115 100  function configureMarkedExtensions() {
13743     -116 101    // Enable footnote support
13744     -117     -  if (typeof markedFootnote !== 'undefined') {
13745     -118     -    marked.use(markedFootnote());
13746     -119     -    console.log('‚úÖ Footnotes enabled');
13747     -120     -  }
13748     -    102 +  marked.use(markedFootnote());
13749     -    103 +  console.log('‚úÖ Footnotes enabled');
13750     -121 104  
13751     -122 105    // Add GitHub-style admonitions
13752     -123 106    marked.use({
13753     -@@ -167,11 +150,7 @@ function configureMarkedExtensions() {
13754     -167 150    });
13755     -168 151    console.log('‚úÖ GitHub admonitions enabled');
13756     -169 152  
13757     -170     -  // Configure math formulas
13758     -171     -  if (typeof katex === 'undefined') {
13759     -172     -    console.warn('KaTeX not loaded, math rendering unavailable');
13760     -173     -    return;
13761     -174     -  }
13762     -    153 +  // Configure math formulas (KaTeX is now imported at top level)
13763     -175 154  
13764     -176 155    // Add inline math and text formatting extensions only
13765     -177 156    // LaTeX environments (align, gather, etc.) are not supported by KaTeX
13766     -178 157  
    122 +     25 +---
    123 +     26 +
    124 +     27 +## Text Formatting
    125 +     28 +
    126 +     29 +**Bold text** and __also bold__
    127 +     30 +
    128 +     31 +*Italic text* and _also italic_
    129 +     32 +
    130 +     33 +***Bold and italic*** and ___also bold italic___
    131 +     34 +
    132 +     35 +~~Strikethrough text~~
    133 +     36 +
    134 +     37 +==Highlighted text== (if supported)
    135 +     38 +
    136 +     39 +`Inline code snippet`
    137 +     40 +
    138 +     41 +<u>Underlined text</u> (HTML)
    139 +     42 +
    140 +     43 +<mark>Marked/highlighted text</mark> (HTML)
    141 +     44 +
    142 +     45 +Text with H~2~O subscript (if supported)
    143 +     46 +
    144 +     47 +Text with X^2^ superscript (if supported)
    145 +     48 +
    146 +     49 +HTML subscript: H<sub>2</sub>O and superscript: x<sup>2</sup>
    147 +     50 +
    148 +     51 +> [!NOTE]
    149 +     52 +> This is a note callout (GitHub style)
    150 +     53 +
    151 +     54 +> [!WARNING]
    152 +     55 +> This is a warning callout
    153 +     56 +
    154 +     57 +> [!TIP]
    155 +     58 +> This is a tip callout
    156 +     59 +
    157 +     60 +> [!IMPORTANT]
    158 +     61 +> This is an important callout
    159 +     62 +
    160 +     63 +> [!CAUTION]
    161 +     64 +> This is a caution callout
    162 +     65 +
    163 +     66 +---
    164 +     67 +
    165 +     68 +## Lists
    166 +     69 +
    167 +     70 +### Unordered Lists
    168 +     71 +
    169 +     72 +- Item 1
    170 +     73 +- Item 2
    171 +     74 +  - Nested item 2.1
    172 +     75 +  - Nested item 2.2
    173 +     76 +    - Deep nested 2.2.1
    174 +     77 +- Item 3
    175 +     78 +
    176 +     79 +* Alternative bullet
    177 +     80 +* Another item
    178 +     81 +
    179 +     82 ++ Plus sign bullet
    180 +     83 ++ Another item
    181 +     84 +
    182 +     85 +### Ordered Lists
    183 +     86 +
    184 +     87 +1. First item
    185 +     88 +2. Second item
    186 +     89 +   1. Nested numbered 2.1
    187 +     90 +   2. Nested numbered 2.2
    188 +     91 +      1. Deep nested 2.2.1
    189 +     92 +3. Third item
    190 +     93 +
    191 +     94 +### Mixed Lists
    192 +     95 +
    193 +     96 +1. Ordered item
    194 +     97 +   - Unordered nested
    195 +     98 +   - Another unordered
    196 +     99 +2. Back to ordered
    197 +    100 +   1. Nested ordered
    198 +    101 +      - Mixed deep nesting
    199 +    102 +
    200 +    103 +### Task Lists / Checkboxes
    201 +    104 +
    202 +    105 +- [x] Completed task
    203 +    106 +- [x] Another completed
    204 +    107 +- [ ] Incomplete task
    205 +    108 +- [ ] Another incomplete
    206 +    109 +  - [x] Nested completed
    207 +    110 +  - [ ] Nested incomplete
    208 +    111 +
    209 +    112 +### Definition Lists (if supported)
    210 +    113 +
    211 +    114 +Term 1
    212 +    115 +: Definition for term 1
    213 +    116 +
    214 +    117 +Term 2
    215 +    118 +: Definition for term 2
    216 +    119 +: Another definition for term 2
    217 +    120 +
    218 +    121 +---
    219 +    122 +
    220 +    123 +## Links and Images
    221 +    124 +
    222 +    125 +### Links
    223 +    126 +
    224 +    127 +[Basic link](https://example.com)
    225 +    128 +
    226 +    129 +[Link with title](https://example.com "Hover title text")
    227 +    130 +
    228 +    131 +<https://autolink-url.com>
    229 +    132 +
    230 +    133 +<email@example.com>
    231 +    134 +
    232 +    135 +[Reference style link][ref1]
    233 +    136 +
    234 +    137 +[Another reference][ref2]
    235 +    138 +
    236 +    139 +[ref1]: https://example.com "Reference 1"
    237 +    140 +[ref2]: https://example.org "Reference 2"
    238 +    141 +
    239 +    142 +### Images
    240 +    143 +
    241 +    144 +![Alt text for image](https://via.placeholder.com/300x150 "Image title")
    242 +    145 +
    243 +    146 +[![Clickable image](https://via.placeholder.com/200x100)](https://example.com)
    244 +    147 +
    245 +    148 +![Reference image][img1]
    246 +    149 +
    247 +    150 +[img1]: https://via.placeholder.com/250x125 "Reference image"
    248 +    151 +
    249 +    152 +### Image with sizing (HTML)
    250 +    153 +
    251 +    154 +<img src="https://via.placeholder.com/400x200" alt="Sized image" width="400" height="200">
    252 +    155 +
    253 +    156 +---
    254 +    157 +
    255 +    158 +## Code Blocks
    256 +    159 +
    257 +    160 +### Inline Code
    258 +    161 +
    259 +    162 +Use `console.log()` for debugging. The `<div>` element is a container. Run `npm install` first.
    260 +    163 +
    261 +    164 +### JavaScript / TypeScript
    262 +    165 +
    263 +    166 +```javascript
    264 +    167 +// JavaScript Example
    265 +    168 +const greeting = "Hello, World!";
    266 +    169 +const numbers = [1, 2, 3, 4, 5];
    267 +    170 +
    268 +    171 +const doubled = numbers.map(n => n * 2);
    269 +    172 +
    270 +    173 +async function fetchData(url) {
    271 +    174 +    try {
    272 +    175 +        const response = await fetch(url);
    273 +    176 +        const data = await response.json();
    274 +    177 +        return data;
    275 +    178 +    } catch (error) {
    276 +    179 +        console.error('Error:', error);
    277 +    180 +    }
    278 +    181 +}
    279 +    182 +
    280 +    183 +class Person {
    281 +    184 +    constructor(name, age) {
    282 +    185 +        this.name = name;
    283 +    186 +        this.age = age;
    284 +    187 +    }
    285 +    188 +
    286 +    189 +    greet() {
    287 +    190 +        return `Hello, I'm ${this.name}`;
    288 +    191 +    }
    289 +    192 +}
    290 +    193 +```
    291 +    194 +
    292 +    195 +```typescript
    293 +    196 +// TypeScript Example
    294 +    197 +interface User {
    295 +    198 +    id: number;
    296 +    199 +    name: string;
    297 +    200 +    email: string;
    298 +    201 +    isActive?: boolean;
    299 +    202 +}
    300 +    203 +
    301 +    204 +type Status = 'pending' | 'approved' | 'rejected';
    302 +    205 +
    303 +    206 +function processUser<T extends User>(user: T): void {
    304 +    207 +    console.log(`Processing ${user.name}`);
    305 +    208 +}
    306 +    209 +
    307 +    210 +const users: User[] = [
    308 +    211 +    { id: 1, name: 'Alice', email: 'alice@example.com' }
    309 +    212 +];
    310 +    213 +```
    311 +    214 +
    312 +    215 +### Python
    313 +    216 +
    314 +    217 +```python
    315 +    218 +# Python Example
    316 +    219 +from typing import List, Optional
    317 +    220 +import asyncio
    318 +    221 +
    319 +    222 +def fibonacci(n: int) -> List[int]:
    320 +    223 +    """Generate Fibonacci sequence up to n terms."""
    321 +    224 +    sequence = []
    322 +    225 +    a, b = 0, 1
    323 +    226 +    for _ in range(n):
    324 +    227 +        sequence.append(a)
    325 +    228 +        a, b = b, a + b
    326 +    229 +    return sequence
    327 +    230 +
    328 +    231 +class DataProcessor:
    329 +    232 +    def __init__(self, data: List[dict]):
    330 +    233 +        self.data = data
    331 +    234 +
    332 +    235 +    async def process(self) -> Optional[dict]:
    333 +    236 +        results = [item for item in self.data if item.get('active')]
    334 +    237 +        return results[0] if results else None
    335 +    238 +
    336 +    239 +# List comprehension with condition
    337 +    240 +squares = [x**2 for x in range(10) if x % 2 == 0]
    338 +    241 +
    339 +    242 +# Dictionary comprehension
    340 +    243 +word_lengths = {word: len(word) for word in ['hello', 'world', 'python']}
    341 +    244 +
    342 +    245 +# Lambda and map
    343 +    246 +doubled = list(map(lambda x: x * 2, [1, 2, 3, 4, 5]))
    344 +    247 +```
    345 +    248 +
    346 +    249 +### Java
    347 +    250 +
    348 +    251 +```java
    349 +    252 +// Java Example
    350 +    253 +package com.example;
    351 +    254 +
    352 +    255 +import java.util.*;
    353 +    256 +import java.util.stream.*;
    354 +    257 +
    355 +    258 +public class Main {
    356 +    259 +    public static void main(String[] args) {
    357 +    260 +        List<String> names = Arrays.asList("Alice", "Bob", "Charlie");
    358 +    261 +
    359 +    262 +        // Stream API
    360 +    263 +        List<String> filtered = names.stream()
    361 +    264 +            .filter(name -> name.length() > 3)
    362 +    265 +            .map(String::toUpperCase)
    363 +    266 +            .collect(Collectors.toList());
    364 +    267 +
    365 +    268 +        // Lambda expression
    366 +    269 +        names.forEach(name -> System.out.println("Hello, " + name));
    367 +    270 +    }
    368 +    271 +
    369 +    272 +    // Generic method
    370 +    273 +    public static <T extends Comparable<T>> T findMax(List<T> list) {
    371 +    274 +        return Collections.max(list);
    372 +    275 +    }
    373 +    276 +}
    374 +    277 +
    375 +    278 +// Record (Java 14+)
    376 +    279 +record Person(String name, int age) {}
    377 +    280 +
    378 +    281 +// Sealed class (Java 17+)
    379 +    282 +sealed interface Shape permits Circle, Rectangle {}
    380 +    283 +final class Circle implements Shape { double radius; }
    381 +    284 +final class Rectangle implements Shape { double width, height; }
    382 +    285 +```
    383 +    286 +
    384 +    287 +### C++
    385 +    288 +
    386 +    289 +```cpp
    387 +    290 +// C++ Example
    388 +    291 +#include <iostream>
    389 +    292 +#include <vector>
    390 +    293 +#include <algorithm>
    391 +    294 +#include <memory>
    392 +    295 +#include <string>
    393 +    296 +
    394 +    297 +template<typename T>
    395 +    298 +class Container {
    396 +    299 +private:
    397 +    300 +    std::vector<T> items;
    398 +    301 +public:
    399 +    302 +    void add(T item) { items.push_back(std::move(item)); }
    400 +    303 +    size_t size() const { return items.size(); }
    401 +    304 +
    402 +    305 +    // Iterator support
    403 +    306 +    auto begin() { return items.begin(); }
    404 +    307 +    auto end() { return items.end(); }
    405 +    308 +};
    406 +    309 +
    407 +    310 +int main() {
    408 +    311 +    // Smart pointers
    409 +    312 +    auto ptr = std::make_unique<int>(42);
    410 +    313 +    auto shared = std::make_shared<std::string>("Hello");
    411 +    314 +
    412 +    315 +    // Lambda with capture
    413 +    316 +    std::vector<int> nums = {1, 2, 3, 4, 5};
    414 +    317 +    int multiplier = 3;
    415 +    318 +    std::transform(nums.begin(), nums.end(), nums.begin(),
    416 +    319 +        [multiplier](int n) { return n * multiplier; });
    417 +    320 +
    418 +    321 +    // Range-based for loop
    419 +    322 +    for (const auto& n : nums) {
    420 +    323 +        std::cout << n << " ";
    421 +    324 +    }
    422 +    325 +
    423 +    326 +    // Structured bindings (C++17)
    424 +    327 +    std::pair<int, std::string> p{1, "one"};
    425 +    328 +    auto [num, str] = p;
    426 +    329 +
    427 +    330 +    return 0;
    428 +    331 +}
    429 +    332 +```
    430 +    333 +
    431 +    334 +### C
    432 +    335 +
    433 +    336 +```c
    434 +    337 +// C Example
    435 +    338 +#include <stdio.h>
    436 +    339 +#include <stdlib.h>
    437 +    340 +#include <string.h>
    438 +    341 +
    439 +    342 +typedef struct {
    440 +    343 +    char name[50];
    441 +    344 +    int age;
    442 +    345 +} Person;
    443 +    346 +
    444 +    347 +// Function pointer type
    445 +    348 +typedef int (*Comparator)(const void*, const void*);
    446 +    349 +
    447 +    350 +int compare_persons(const void* a, const void* b) {
    448 +    351 +    return ((Person*)a)->age - ((Person*)b)->age;
    449 +    352 +}
    450 +    353 +
    451 +    354 +int main() {
    452 +    355 +    // Dynamic memory allocation
    453 +    356 +    Person* people = malloc(3 * sizeof(Person));
    454 +    357 +
    455 +    358 +    strcpy(people[0].name, "Alice");
    456 +    359 +    people[0].age = 30;
    457 +    360 +
    458 +    361 +    // Function pointer usage
    459 +    362 +    qsort(people, 3, sizeof(Person), compare_persons);
    460 +    363 +
    461 +    364 +    // Pointer arithmetic
    462 +    365 +    for (Person* p = people; p < people + 3; p++) {
    463 +    366 +        printf("%s: %d\n", p->name, p->age);
    464 +    367 +    }
    465 +    368 +
    466 +    369 +    free(people);
    467 +    370 +    return 0;
    468 +    371 +}
    469 +    372 +```
    470 +    373 +
    471 +    374 +### Rust
    472 +    375 +
    473 +    376 +```rust
    474 +    377 +// Rust Example
    475 +    378 +use std::collections::HashMap;
    476 +    379 +
    477 +    380 +#[derive(Debug, Clone)]
    478 +    381 +struct User {
    479 +    382 +    name: String,
    480 +    383 +    age: u32,
    481 +    384 +}
    482 +    385 +
    483 +    386 +impl User {
    484 +    387 +    fn new(name: &str, age: u32) -> Self {
    485 +    388 +        Self {
    486 +    389 +            name: name.to_string(),
    487 +    390 +            age,
    488 +    391 +        }
    489 +    392 +    }
    490 +    393 +}
    491 +    394 +
    492 +    395 +fn main() {
    493 +    396 +    // Pattern matching
    494 +    397 +    let value = Some(42);
    495 +    398 +    match value {
    496 +    399 +        Some(n) if n > 0 => println!("Positive: {}", n),
    497 +    400 +        Some(n) => println!("Non-positive: {}", n),
    498 +    401 +        None => println!("No value"),
    499 +    402 +    }
    500 +    403 +
    501 +    404 +    // Iterator chain
    502 +    405 +    let numbers: Vec<i32> = (1..=10)
    503 +    406 +        .filter(|n| n % 2 == 0)
    504 +    407 +        .map(|n| n * n)
    505 +    408 +        .collect();
    506 +    409 +
    507 +    410 +    // HashMap
    508 +    411 +    let mut scores: HashMap<String, i32> = HashMap::new();
    509 +    412 +    scores.insert("Alice".to_string(), 100);
    510 +    413 +
    511 +    414 +    // Closure
    512 +    415 +    let add = |a: i32, b: i32| -> i32 { a + b };
    513 +    416 +}
    514 +    417 +```
    515 +    418 +
    516 +    419 +### Go
    517 +    420 +
    518 +    421 +```go
    519 +    422 +// Go Example
    520 +    423 +package main
    521 +    424 +
    522 +    425 +import (
    523 +    426 +    "fmt"
    524 +    427 +    "sync"
    525 +    428 +)
    526 +    429 +
    527 +    430 +type Server struct {
    528 +    431 +    mu      sync.Mutex
    529 +    432 +    clients map[string]chan string
    530 +    433 +}
    531 +    434 +
    532 +    435 +func (s *Server) AddClient(id string) <-chan string {
    533 +    436 +    s.mu.Lock()
    534 +    437 +    defer s.mu.Unlock()
    535 +    438 +
    536 +    439 +    ch := make(chan string, 10)
    537 +    440 +    s.clients[id] = ch
    538 +    441 +    return ch
    539 +    442 +}
    540 +    443 +
    541 +    444 +func main() {
    542 +    445 +    // Goroutine and channel
    543 +    446 +    ch := make(chan int)
    544 +    447 +
    545 +    448 +    go func() {
    546 +    449 +        for i := 0; i < 5; i++ {
    547 +    450 +            ch <- i
    548 +    451 +        }
    549 +    452 +        close(ch)
    550 +    453 +    }()
    551 +    454 +
    552 +    455 +    // Range over channel
    553 +    456 +    for n := range ch {
    554 +    457 +        fmt.Println(n)
    555 +    458 +    }
    556 +    459 +
    557 +    460 +    // Slice operations
    558 +    461 +    nums := []int{1, 2, 3, 4, 5}
    559 +    462 +    doubled := make([]int, len(nums))
    560 +    463 +    for i, n := range nums {
    561 +    464 +        doubled[i] = n * 2
    562 +    465 +    }
    563 +    466 +
    564 +    467 +    // Map
    565 +    468 +    scores := map[string]int{
    566 +    469 +        "Alice": 100,
    567 +    470 +        "Bob":   85,
    568 +    471 +    }
    569 +    472 +}
    570 +    473 +```
    571 +    474 +
    572 +    475 +### Shell / Bash
    573 +    476 +
    574 +    477 +```bash
    575 +    478 +#!/bin/bash
    576 +    479 +
    577 +    480 +# Variables
    578 +    481 +NAME="World"
    579 +    482 +COUNT=5
    580 +    483 +
    581 +    484 +# Function
    582 +    485 +greet() {
    583 +    486 +    local name="$1"
    584 +    487 +    echo "Hello, $name!"
    585 +    488 +}
    586 +    489 +
    587 +    490 +# Conditional
    588 +    491 +if [ "$COUNT" -gt 3 ]; then
    589 +    492 +    echo "Count is greater than 3"
    590 +    493 +elif [ "$COUNT" -eq 3 ]; then
    591 +    494 +    echo "Count is exactly 3"
    592 +    495 +else
    593 +    496 +    echo "Count is less than 3"
    594 +    497 +fi
    595 +    498 +
    596 +    499 +# Loop
    597 +    500 +for i in {1..5}; do
    598 +    501 +    echo "Iteration $i"
    599 +    502 +done
    600 +    503 +
    601 +    504 +# Array
    602 +    505 +fruits=("apple" "banana" "cherry")
    603 +    506 +for fruit in "${fruits[@]}"; do
    604 +    507 +    echo "Fruit: $fruit"
    605 +    508 +done
    606 +    509 +
    607 +    510 +# Command substitution
    608 +    511 +current_date=$(date +%Y-%m-%d)
    609 +    512 +echo "Today is: $current_date"
    610 +    513 +
    611 +    514 +# Pipe and redirection
    612 +    515 +cat file.txt | grep "pattern" | sort | uniq > output.txt
    613 +    516 +```
    614 +    517 +
    615 +    518 +### SQL
    616 +    519 +
    617 +    520 +```sql
    618 +    521 +-- SQL Example
    619 +    522 +CREATE TABLE users (
    620 +    523 +    id SERIAL PRIMARY KEY,
    621 +    524 +    username VARCHAR(50) NOT NULL UNIQUE,
    622 +    525 +    email VARCHAR(100) NOT NULL,
    623 +    526 +    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP
    624 +    527 +);
    625 +    528 +
    626 +    529 +-- Complex query with CTE
    627 +    530 +WITH monthly_sales AS (
    628 +    531 +    SELECT
    629 +    532 +        DATE_TRUNC('month', sale_date) AS month,
    630 +    533 +        SUM(amount) AS total_sales
    631 +    534 +    FROM sales
    632 +    535 +    WHERE sale_date >= '2024-01-01'
    633 +    536 +    GROUP BY DATE_TRUNC('month', sale_date)
    634 +    537 +)
    635 +    538 +SELECT
    636 +    539 +    month,
    637 +    540 +    total_sales,
    638 +    541 +    LAG(total_sales) OVER (ORDER BY month) AS prev_month_sales,
    639 +    542 +    ROUND((total_sales - LAG(total_sales) OVER (ORDER BY month)) /
    640 +    543 +          LAG(total_sales) OVER (ORDER BY month) * 100, 2) AS growth_pct
    641 +    544 +FROM monthly_sales
    642 +    545 +ORDER BY month;
    643 +    546 +
    644 +    547 +-- Window function example
    645 +    548 +SELECT
    646 +    549 +    department,
    647 +    550 +    employee_name,
    648 +    551 +    salary,
    649 +    552 +    RANK() OVER (PARTITION BY department ORDER BY salary DESC) as rank
    650 +    553 +FROM employees;
    651 +    554 +```
    652 +    555 +
    653 +    556 +### HTML
    654 +    557 +
    655 +    558 +```html
    656 +    559 +<!DOCTYPE html>
    657 +    560 +<html lang="en">
    658 +    561 +<head>
    659 +    562 +    <meta charset="UTF-8">
    660 +    563 +    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    661 +    564 +    <title>Sample Page</title>
    662 +    565 +    <style>
    663 +    566 +        .container { max-width: 1200px; margin: 0 auto; }
    664 +    567 +    </style>
    665 +    568 +</head>
    666 +    569 +<body>
    667 +    570 +    <header>
    668 +    571 +        <nav>
    669 +    572 +            <ul>
    670 +    573 +                <li><a href="#home">Home</a></li>
    671 +    574 +                <li><a href="#about">About</a></li>
    672 +    575 +            </ul>
    673 +    576 +        </nav>
    674 +    577 +    </header>
    675 +    578 +    <main class="container">
    676 +    579 +        <article>
    677 +    580 +            <h1>Welcome</h1>
    678 +    581 +            <p>This is a sample paragraph.</p>
    679 +    582 +        </article>
    680 +    583 +    </main>
    681 +    584 +    <script>
    682 +    585 +        document.addEventListener('DOMContentLoaded', () => {
    683 +    586 +            console.log('Page loaded');
    684 +    587 +        });
    685 +    588 +    </script>
    686 +    589 +</body>
    687 +    590 +</html>
    688 +    591 +```
    689 +    592 +
    690 +    593 +### CSS / SCSS
    691 +    594 +
    692 +    595 +```css
    693 +    596 +/* CSS Example */
    694 +    597 +:root {
    695 +    598 +    --primary-color: #3498db;
    696 +    599 +    --secondary-color: #2ecc71;
    697 +    600 +    --spacing: 1rem;
    698 +    601 +}
    699 +    602 +
    700 +    603 +.container {
    701 +    604 +    max-width: 1200px;
    702 +    605 +    margin: 0 auto;
    703 +    606 +    padding: var(--spacing);
    704 +    607 +}
    705 +    608 +
    706 +    609 +.card {
    707 +    610 +    background: white;
    708 +    611 +    border-radius: 8px;
    709 +    612 +    box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
    710 +    613 +    transition: transform 0.3s ease;
    711 +    614 +}
    712 +    615 +
    713 +    616 +.card:hover {
    714 +    617 +    transform: translateY(-4px);
    715 +    618 +}
    716 +    619 +
    717 +    620 +@media (max-width: 768px) {
    718 +    621 +    .container {
    719 +    622 +        padding: calc(var(--spacing) / 2);
    720 +    623 +    }
    721 +    624 +}
    722 +    625 +
    723 +    626 +/* Animation */
    724 +    627 +@keyframes fadeIn {
    725 +    628 +    from { opacity: 0; }
    726 +    629 +    to { opacity: 1; }
    727 +    630 +}
    728 +    631 +
    729 +    632 +.fade-in {
    730 +    633 +    animation: fadeIn 0.5s ease-in-out;
    731 +    634 +}
    732 +    635 +```
    733 +    636 +
    734 +    637 +```scss
    735 +    638 +// SCSS Example
    736 +    639 +$primary: #3498db;
    737 +    640 +$breakpoints: (
    738 +    641 +    'sm': 576px,
    739 +    642 +    'md': 768px,
    740 +    643 +    'lg': 992px
    741 +    644 +);
    742 +    645 +
    743 +    646 +@mixin respond-to($breakpoint) {
    744 +    647 +    @media (min-width: map-get($breakpoints, $breakpoint)) {
    745 +    648 +        @content;
    746 +    649 +    }
    747 +    650 +}
    748 +    651 +
    749 +    652 +.component {
    750 +    653 +    padding: 1rem;
    751 +    654 +
    752 +    655 +    &__title {
    753 +    656 +        font-size: 1.5rem;
    754 +    657 +        color: $primary;
    755 +    658 +    }
    756 +    659 +
    757 +    660 +    &__content {
    758 +    661 +        @include respond-to('md') {
    759 +    662 +            display: grid;
    760 +    663 +            grid-template-columns: repeat(3, 1fr);
    761 +    664 +        }
    762 +    665 +    }
    763 +    666 +
    764 +    667 +    &--highlighted {
    765 +    668 +        background: lighten($primary, 40%);
    766 +    669 +    }
    767 +    670 +}
    768 +    671 +```
    769 +    672 +
    770 +    673 +### JSON
    771 +    674 +
    772 +    675 +```json
    773 +    676 +{
    774 +    677 +    "name": "markdown-test",
    775 +    678 +    "version": "1.0.0",
    776 +    679 +    "description": "A comprehensive markdown test",
    777 +    680 +    "dependencies": {
    778 +    681 +        "react": "^18.2.0",
    779 +    682 +        "typescript": "^5.0.0"
    780 +    683 +    },
    781 +    684 +    "scripts": {
    782 +    685 +        "start": "node index.js",
    783 +    686 +        "build": "tsc && webpack"
    784 +    687 +    },
    785 +    688 +    "config": {
    786 +    689 +        "database": {
    787 +    690 +            "host": "localhost",
    788 +    691 +            "port": 5432,
    789 +    692 +            "name": "testdb"
    790 +    693 +        },
    791 +    694 +        "features": ["auth", "api", "notifications"],
    792 +    695 +        "enabled": true
    793 +    696 +    }
    794 +    697 +}
    795 +    698 +```
    796 +    699 +
    797 +    700 +### YAML
    798 +    701 +
    799 +    702 +```yaml
    800 +    703 +# YAML Example - Docker Compose
    801 +    704 +version: '3.8'
    802 +    705 +
    803 +    706 +services:
    804 +    707 +  web:
    805 +    708 +    build:
    806 +    709 +      context: .
    807 +    710 +      dockerfile: Dockerfile
    808 +    711 +    ports:
    809 +    712 +      - "3000:3000"
    810 +    713 +    environment:
    811 +    714 +      - NODE_ENV=production
    812 +    715 +      - DATABASE_URL=postgres://user:pass@db:5432/app
    813 +    716 +    depends_on:
    814 +    717 +      - db
    815 +    718 +      - redis
    816 +    719 +    volumes:
    817 +    720 +      - ./app:/usr/src/app
    818 +    721 +      - /usr/src/app/node_modules
    819 +    722 +    networks:
    820 +    723 +      - app-network
    821 +    724 +    deploy:
    822 +    725 +      replicas: 3
    823 +    726 +      restart_policy:
    824 +    727 +        condition: on-failure
    825 +    728 +
    826 +    729 +  db:
    827 +    730 +    image: postgres:15-alpine
    828 +    731 +    environment:
    829 +    732 +      POSTGRES_USER: user
    830 +    733 +      POSTGRES_PASSWORD: pass
    831 +    734 +      POSTGRES_DB: app
    832 +    735 +    volumes:
    833 +    736 +      - postgres-data:/var/lib/postgresql/data
    834 +    737 +
    835 +    738 +volumes:
    836 +    739 +  postgres-data:
    837 +    740 +
    838 +    741 +networks:
    839 +    742 +  app-network:
    840 +    743 +    driver: bridge
    841 +    744 +```
    842 +    745 +
    843 +    746 +### XML
    844 +    747 +
    845 +    748 +```xml
    846 +    749 +<?xml version="1.0" encoding="UTF-8"?>
    847 +    750 +<configuration>
    848 +    751 +    <appSettings>
    849 +    752 +        <add key="ApiUrl" value="https://api.example.com"/>
    850 +    753 +        <add key="Timeout" value="30"/>
    851 +    754 +    </appSettings>
    852 +    755 +
    853 +    756 +    <connectionStrings>
    854 +    757 +        <add name="DefaultConnection"
    855 +    758 +             connectionString="Server=localhost;Database=TestDB;"
    856 +    759 +             providerName="System.Data.SqlClient"/>
    857 +    760 +    </connectionStrings>
    858 +    761 +
    859 +    762 +    <system.web>
    860 +    763 +        <compilation debug="true" targetFramework="4.8"/>
    861 +    764 +        <httpRuntime targetFramework="4.8"/>
    862 +    765 +    </system.web>
    863 +    766 +</configuration>
    864 +    767 +```
    865 +    768 +
    866 +    769 +### R
    867 +    770 +
    868 +    771 +```r
    869 +    772 +# R Example
    870 +    773 +library(tidyverse)
    871 +    774 +library(ggplot2)
    872 +    775 +
    873 +    776 +# Data manipulation with dplyr
    874 +    777 +data <- mtcars %>%
    875 +    778 +  filter(mpg > 20) %>%
    876 +    779 +  group_by(cyl) %>%
    877 +    780 +  summarise(
    878 +    781 +    avg_mpg = mean(mpg),
    879 +    782 +    avg_hp = mean(hp),
    880 +    783 +    count = n()
    881 +    784 +  ) %>%
    882 +    785 +  arrange(desc(avg_mpg))
    883 +    786 +
    884 +    787 +# Function definition
    885 +    788 +calculate_stats <- function(x, na.rm = TRUE) {
    886 +    789 +  list(
    887 +    790 +    mean = mean(x, na.rm = na.rm),
    888 +    791 +    sd = sd(x, na.rm = na.rm),
    889 +    792 +    median = median(x, na.rm = na.rm)
    890 +    793 +  )
    891 +    794 +}
    892 +    795 +
    893 +    796 +# ggplot2 visualization
    894 +    797 +ggplot(mtcars, aes(x = wt, y = mpg, color = factor(cyl))) +
    895 +    798 +  geom_point(size = 3, alpha = 0.7) +
    896 +    799 +  geom_smooth(method = "lm", se = FALSE) +
    897 +    800 +  labs(
    898 +    801 +    title = "MPG vs Weight by Cylinders",
    899 +    802 +    x = "Weight (1000 lbs)",
    900 +    803 +    y = "Miles per Gallon",
    901 +    804 +    color = "Cylinders"
    902 +    805 +  ) +
    903 +    806 +  theme_minimal()
    904 +    807 +```
    905 +    808 +
    906 +    809 +### Diff
    907 +    810 +
    908 +    811 +```diff
    909 +    812 +--- a/file.txt
    910 +    813 +@@ -1,5 +1,5 @@
    911 +    814 + Line 1
    912 +    815 +-Line 2 (removed)
    913 +    816 ++Line 2 (added)
    914 +    817 + Line 3
    915 +    818 +-Old line 4
    916 +    819 ++New line 4
    917 +    820 + Line 5
    918 +    821 +```
    919 +    822 +
    920 +    823 +### Markdown (nested)
    921 +    824 +
    922 +    825 +```markdown
    923 +    826 +# Nested Markdown
    924 +    827 +
    925 +    828 +This is **markdown** inside a code block.
    926 +    829 +
    927 +    830 +- List item
    928 +    831 +- Another item
    929 +    832 +
    930 +    833 +[Link](https://example.com)
    931 +    834 +```
    932 +    835 +
    933 +    836 +### Plain text / No highlighting
    934 +    837 +
    935 +    838 +```
    936 +    839 +This is plain text without syntax highlighting.
    937 +    840 +It preserves spacing and formatting.
    938 +    841 +    Indented text here.
    939 +    842 +```
    940 +    843 +
    941 +    844 +---
    942 +    845 +
    943 +    846 +## Math Syntax
    944 +    847 +
    945 +    848 +### 1Ô∏è‚É£ Inline Math ‚Äì Basic & Edge Cases
    946 +    849 +
    947 +    850 +**Simple letters & numbers:** $a, b, c, 1, 2, 3$
    948 +    851 +
    949 +    852 +**Subscripts & superscripts (including nesting):** $x_i$, $y^{2}$, $z_{i}^{\,j}$, $a_{b_{c}}^{d^{e}}$
    950 +    853 +
    951 +    854 +**Euler's identity:** $e^{i\pi}+1=0$
    952 +    855 +
    953 +    856 +**Fractions inline:** $\frac{p}{q}$ and display-style inline: $\dfrac{a+b}{c+d}$, text-style: $\tfrac{x}{y}$
    954 +    857 +
    955 +    858 +**Binomial/choose notation:** $\binom{n}{k}$ and ${n \choose k}$
    956 +    859 +
    957 +    860 +**Roots with optional index:** $\sqrt{x}$, $\sqrt[3]{8}$, $\sqrt[n]{a}$
    958 +    861 +
    959 +    862 +**Greek letters:** $\alpha, \beta, \gamma, \delta, \epsilon, \zeta, \eta, \theta, \iota, \kappa, \lambda, \mu$
    960 +    863 +
    961 +    864 +**Greek uppercase:** $\Gamma, \Delta, \Theta, \Lambda, \Xi, \Pi, \Sigma, \Phi, \Psi, \Omega$
    962 +    865 +
    963 +    866 +**Blackboard-bold sets:** $\mathbb{R}, \mathbb{Z}, \mathbb{N}, \mathbb{Q}, \mathbb{C}, \mathbb{H}$
    964 +    867 +
    965 +    868 +**Calligraphic, fraktur, script fonts:** $\mathcal{F}, \mathcal{L}, \mathfrak{g}, \mathfrak{S}, \mathscr{L}, \mathscr{H}$
    966 +    869 +
    967 +    870 +**Bold/italic/sans-serif in math:** $\mathbf{ABC}, \mathsf{ABC}, \mathit{ABC}, \mathrm{ABC}$
    968 +    871 +
    969 +    872 +**Accents:** $\hat{x}, \tilde{y}, \bar{z}, \dot{u}, \ddot{v}, \acute{a}, \grave{e}, \breve{o}, \check{c}$
    970 +    873 +
    971 +    874 +**Vectors & arrow notation:** $\vec{a}, \overrightarrow{AB}, \overleftarrow{CD}, \widehat{ABC}$
    972 +    875 +
    973 +    876 +**Over/under braces with annotations:**
    974 +    877 +- $\overbrace{1+2+ \dots +n}^{\text{n terms}}$
    975 +    878 +- $\underbrace{a_1 + a_2 + \dots + a_n}_{\text{sum}}$
    976 +    879 +
    977 +    880 +**Strikethrough/cancel:** $\cancel{(x+y)}$, $\bcancel{abc}$, $\xcancel{xyz}$
    978 +    881 +
    979 +    882 +**Color in math:** $\color{red}{x^2} + \color{blue}{y^2} = \color{green}{z^2}$
    980 +    883 +
    981 +    884 +**Boxed expression:** $\boxed{E = mc^2}$
    982 +    885 +
    983 +    886 +**Multiple inline formulas on a single line (spacing test):**
    984 +    887 +The quadratic formula is $x = \frac{-b\pm\sqrt{b^{2}-4ac}}{2a}$ while the discriminant is $D = b^{2}-4ac$ and the roots satisfy $ax^{2}+bx+c=0$.
    985 +    888 +
    986 +    889 +---
    987 +    890 +
    988 +    891 +### 2Ô∏è‚É£ Display (Block) Math ‚Äì Standard & Edge Cases
    989 +    892 +
    990 +    893 +#### 2.1 Simple displayed equations
    991 +    894 +
    992 +    895 +$$
    993 +    896 +\int_{0}^{\infty} e^{-x^{2}}\,dx = \frac{\sqrt{\pi}}{2}
    994 +    897 +$$
    995 +    898 +
    996 +    899 +\[
    997 +    900 +\lim_{n\to\infty}\frac{1}{n}\sum_{k=1}^{n}k = \frac{1}{2}
    998 +    901 +\]
    999 +    902 +
    1000 +    903 +#### 2.2 Large operators with limits
    1001 +    904 +
    1002 +    905 +$$
    1003 +    906 +\sum_{i=1}^{n}\sum_{j=1}^{m} a_{ij}
    1004 +    907 +\qquad
    1005 +    908 +\prod_{k=1}^{\infty}\left(1+\frac{1}{k^{2}}\right)
    1006 +    909 +\qquad
    1007 +    910 +\bigcup_{i\in I} A_i
    1008 +    911 +\qquad
    1009 +    912 +\bigcap_{i=1}^{n} B_i
    1010 +    913 +$$
    1011 +    914 +
    1012 +    915 +$$
    1013 +    916 +\limsup_{x\to 0}\frac{\sin x}{x}=1,
    1014 +    917 +\qquad
    1015 +    918 +\liminf_{n\to\infty}\frac{a_n}{b_n}=0
    1016 +    919 +$$
    1017 +    920 +
    1018 +    921 +#### 2.3 Multi-line environments (numbered) ‚Äì align
    1019 +    922 +
    1020 +    923 +\begin{align}
    1021 +    924 +f(x) &= ax^{2}+bx+c \label{eq:quad}\\
    1022 +    925 +f'(x) &= 2ax+b \\
    1023 +    926 +\int_{0}^{1}x^{n}\,dx &= \frac{1}{n+1}\tag{*}
    1024 +    927 +\end{align}
    1025 +    928 +
    1026 +    929 +#### 2.4 Multi-line environments (unnumbered) ‚Äì align*
    1027 +    930 +
    1028 +    931 +\begin{align*}
    1029 +    932 +\cos^{2}\theta + \sin^{2}\theta &= 1 \\
    1030 +    933 +e^{i\pi}+1 &= 0
    1031 +    934 +\end{align*}
    1032 +    935 +
    1033 +    936 +#### 2.5 gather (centered, numbered)
    1034 +    937 +
    1035 +    938 +\begin{gather}
    1036 +    939 +\frac{d}{dx}\bigl(e^{x}\bigr)=e^{x} \\
    1037 +    940 +\Gamma\!\left(\tfrac{1}{2}\right)=\sqrt{\pi}
    1038 +    941 +\end{gather}
    1039 +    942 +
    1040 +    943 +#### 2.6 gather* (centered, no numbers)
    1041 +    944 +
    1042 +    945 +\begin{gather*}
    1043 +    946 +\sin\bigl(\tfrac{\pi}{2}\bigr)=1\\
    1044 +    947 +\log_{10} 1000 = 3
    1045 +    948 +\end{gather*}
    1046 +    949 +
    1047 +    950 +#### 2.7 multline (long equation broken across lines)
    1048 +    951 +
    1049 +    952 +\begin{multline}
    1050 +    953 +\sum_{k=1}^{n}\frac{1}{k}
    1051 +    954 += 1+\frac12+\frac13+\dots+\frac1n \\
    1052 +    955 +\approx \ln n + \gamma + \frac{1}{2n} - \frac{1}{12n^{2}}+\cdots
    1053 +    956 +\end{multline}
    1054 +    957 +
    1055 +    958 +#### 2.8 split inside equation
    1056 +    959 +
    1057 +    960 +\begin{equation}
    1058 +    961 +\begin{split}
    1059 +    962 +a+b &= c+d \\
    1060 +    963 +e+f &= g+h
    1061 +    964 +\end{split}
    1062 +    965 +\end{equation}
    1063 +    966 +
    1064 +    967 +#### 2.9 cases (piece-wise definitions)
    1065 +    968 +
    1066 +    969 +$$
    1067 +    970 +f(x)=
    1068 +    971 +\begin{cases}
    1069 +    972 +x^{2}          & \text{if } x\ge 0,\\[4pt]
    1070 +    973 +-x             & \text{if } x<0.
    1071 +    974 +\end{cases}
    1072 +    975 +$$
    1073 +    976 +
    1074 +    977 +$$
    1075 +    978 +|x| =
    1076 +    979 +\begin{cases}
    1077 +    980 +x & x \geq 0 \\
    1078 +    981 +-x & x < 0
    1079 +    982 +\end{cases}
    1080 +    983 +$$
    1081 +    984 +
    1082 +    985 +#### 2.10 array (matrix-like alignment without delimiters)
    1083 +    986 +
    1084 +    987 +$$
    1085 +    988 +\begin{array}{rcl}
    1086 +    989 +x^{2}+y^{2} &=& z^{2}\\
    1087 +    990 +a+b+c       &=& d
    1088 +    991 +\end{array}
    1089 +    992 +$$
    1090 +    993 +
    1091 +    994 +$$
    1092 +    995 +\begin{array}{c|c|c}
    1093 +    996 +\text{Column 1} & \text{Column 2} & \text{Column 3} \\
    1094 +    997 +\hline
    1095 +    998 +a & b & c \\
    1096 +    999 +d & e & f
    1097 +    1000 +\end{array}
    1098 +    1001 +$$
    1099 +    1002 +
    1100 +    1003 +#### 2.11 All Matrix Types: pmatrix, bmatrix, vmatrix, Vmatrix, Bmatrix
    1101 +    1004 +
    1102 +    1005 +$$
    1103 +    1006 +A=\begin{pmatrix}
    1104 +    1007 +1 & 0 & 0\\
    1105 +    1008 +0 & \cos\theta & -\sin\theta\\
    1106 +    1009 +0 & \sin\theta & \phantom{-}\cos\theta
    1107 +    1010 +\end{pmatrix},
    1108 +    1011 +\qquad
    1109 +    1012 +B=\begin{bmatrix}
    1110 +    1013 +a & b\\
    1111 +    1014 +c & d
    1112 +    1015 +\end{bmatrix}
    1113 +    1016 +$$
    1114 +    1017 +
    1115 +    1018 +$$
    1116 +    1019 +\det C=\begin{vmatrix}
    1117 +    1020 +x & y\\
    1118 +    1021 +z & w
    1119 +    1022 +\end{vmatrix},
    1120 +    1023 +\qquad
    1121 +    1024 +D=\begin{Vmatrix}
    1122 +    1025 +p & q\\
    1123 +    1026 +r & s
    1124 +    1027 +\end{Vmatrix},
    1125 +    1028 +\qquad
    1126 +    1029 +E=\begin{Bmatrix}
    1127 +    1030 +1 & 2\\
    1128 +    1031 +3 & 4
    1129 +    1032 +\end{Bmatrix}
    1130 +    1033 +$$
    1131 +    1034 +
    1132 +    1035 +#### 2.12 smallmatrix inside inline math
    1133 +    1036 +
    1134 +    1037 +The 2√ó2 identity: $\bigl(\begin{smallmatrix}1&0\\0&1\end{smallmatrix}\bigr)$ and rotation: $\bigl(\begin{smallmatrix}\cos\theta&-\sin\theta\\\sin\theta&\cos\theta\end{smallmatrix}\bigr)$.
    1135 +    1038 +
    1136 +    1039 +---
    1137 +    1040 +
    1138 +    1041 +### 3Ô∏è‚É£ Delimiters ‚Äì Size, Scaling, and Nesting
    1139 +    1042 +
    1140 +    1043 +**Auto-sizing with \left \right:**
    1141 +    1044 +
    1142 +    1045 +$$
    1143 +    1046 +\left(
    1144 +    1047 +  \frac{a}{b}
    1145 +    1048 +\right),
    1146 +    1049 +\quad
    1147 +    1050 +\left[
    1148 +    1051 +  \frac{1}{1+\displaystyle\frac{x}{y}}
    1149 +    1052 +\right],
    1150 +    1053 +\quad
    1151 +    1054 +\left\langle
    1152 +    1055 +  \sum_{i=1}^{n} i
    1153 +    1056 +\right\rangle,
    1154 +    1057 +\quad
    1155 +    1058 +\left\{
    1156 +    1059 +  \begin{aligned}
    1157 +    1060 +    x &> 0\\
    1158 +    1061 +    y &< 0
    1159 +    1062 +  \end{aligned}
    1160 +    1063 +\right\}
    1161 +    1064 +$$
    1162 +    1065 +
    1163 +    1066 +**Manual sizing (\big, \Big, \bigg, \Bigg):**
    1164 +    1067 +
    1165 +    1068 +$$
    1166 +    1069 +\big( a \big),\;
    1167 +    1070 +\Big[ b \Big],\;
    1168 +    1071 +\bigg\{ c \bigg\},\;
    1169 +    1072 +\Bigg| d \Bigg|
    1170 +    1073 +$$
    1171 +    1074 +
    1172 +    1075 +$$
    1173 +    1076 +\Bigl( \bigl( ( x ) \bigr) \Bigr)
    1174 +    1077 +\quad
    1175 +    1078 +\biggl\langle \Bigl\langle \bigl\langle \langle x \rangle \bigr\rangle \Bigr\rangle \biggr\rangle
    1176 +    1079 +$$
    1177 +    1080 +
    1178 +    1081 +**Floor, ceiling, and absolute value:**
    1179 +    1082 +
    1180 +    1083 +$$
    1181 +    1084 +\lfloor x \rfloor, \quad \lceil y \rceil, \quad |z|, \quad \|v\|
    1182 +    1085 +$$
    1183 +    1086 +
    1184 +    1087 +$$
    1185 +    1088 +\left\lfloor \frac{n}{2} \right\rfloor, \quad \left\lceil \log_2 n \right\rceil
    1186 +    1089 +$$
    1187 +    1090 +
    1188 +    1091 +---
    1189 +    1092 +
    1190 +    1093 +### 4Ô∏è‚É£ Advanced Symbolic Constructs
    1191 +    1094 +
    1192 +    1095 +| Symbol | LaTeX Code | Rendered |
    1193 +    1096 +|--------|------------|----------|
    1194 +    1097 +| **Implication** | `$A \implies B$` | $A \implies B$ |
    1195 +    1098 +| **Equivalence** | `$A \iff B$` | $A \iff B$ |
    1196 +    1099 +| **Logical operators** | `$p \land q,\; p \lor q,\; \neg p$` | $p \land q,\; p \lor q,\; \neg p$ |
    1197 +    1100 +| **Set builder** | `$\{x\in\mathbb{R}\mid x>0\}$` | $\{x\in\mathbb{R}\mid x>0\}$ |
    1198 +    1101 +| **Function arrow** | `$f\colon X\to Y$` | $f\colon X\to Y$ |
    1199 +    1102 +| **Partial derivative** | `$\frac{\partial f}{\partial x}$` | $\frac{\partial f}{\partial x}$ |
    1200 +    1103 +| **Nabla / gradient** | `$\nabla f$` | $\nabla f$ |
    1201 +    1104 +| **Laplacian** | `$\Delta u$, `$\nabla^2 u$` | $\Delta u$, $\nabla^2 u$ |
    1202 +    1105 +| **Infinity** | `$\infty$` | $\infty$ |
    1203 +    1106 +| **Ellipsis** | `$\dots,\; \cdots,\; \vdots,\; \ddots$` | $\dots,\; \cdots,\; \vdots,\; \ddots$ |
    1204 +    1107 +| **Relations** | `$x\sim y,\; x\approx y,\; x\equiv y$` | $x\sim y,\; x\approx y,\; x\equiv y$ |
    1205 +    1108 +| **Arrows with text** | `$\xrightarrow{\text{limit}}$` | $\xrightarrow{\text{limit}}$ |
    1206 +    1109 +| **Double-arrow** | `$\xleftrightarrow{AB}$` | $\xleftrightarrow{AB}$ |
    1207 +    1110 +| **Hook arrows** | `$\xhookrightarrow{f}$` | $\xhookrightarrow{f}$ |
    1208 +    1111 +| **Overset / Underset** | `$\overset{!}{=}$`, `$\underset{a}{\rightarrow}$` | $\overset{!}{=}$, $\underset{a}{\rightarrow}$ |
    1209 +    1112 +| **Stackrel** | `$\stackrel{\text{def}}{=}$` | $\stackrel{\text{def}}{=}$ |
    1210 +    1113 +| **Tensor indices** | `$T^{\mu\nu}_{\rho\sigma}$` | $T^{\mu\nu}_{\rho\sigma}$ |
    1211 +    1114 +| **Commutator** | `$[A, B]$` | $[A, B]$ |
    1212 +    1115 +| **Anticommutator** | `$\{A, B\}$` | $\{A, B\}$ |
    1213 +    1116 +
    1214 +    1117 +---
    1215 +    1118 +
    1216 +    1119 +### 5Ô∏è‚É£ Spacing Commands (fine-tuning)
    1217 +    1120 +
    1218 +    1121 +$$
    1219 +    1122 +a\!b\;c\,d\;e\quad f\qquad g
    1220 +    1123 +$$
    1221 +    1124 +
    1222 +    1125 +- `\!` negative thin space
    1223 +    1126 +- `\,` thin space
    1224 +    1127 +- `\:`, `\;` medium/thick space
    1225 +    1128 +- `\quad`, `\qquad` larger spaces
    1226 +    1129 +
    1227 +    1130 +**Proper integral spacing:** $\int f(x)\,dx$ vs $\int f(x)dx$
    1228 +    1131 +
    1229 +    1132 +---
    1230 +    1133 +
    1231 +    1134 +### 6Ô∏è‚É£ "Hacky" Math ‚Äì Edge Cases That Often Break Renderers
    1232 +    1135 +
    1233 +    1136 +| Description | LaTeX | Notes |
    1234 +    1137 +|-------------|-------|-------|
    1235 +    1138 +| **Empty fraction** | $\frac{}{x}$ | Missing numerator |
    1236 +    1139 +| **Phantom spacing** | $a\phantom{bcd}e$ | Invisible spacing |
    1237 +    1140 +| **Smash (suppress height)** | $\smash{\frac{a}{b}}c$ | Suppresses vertical extent |
    1238 +    1141 +| **Boxed with displaystyle** | $\boxed{\displaystyle\sum_{i=1}^{n}i}$ | Large operator inside box |
    1239 +    1142 +| **operatorname with limits** | $\operatorname*{argmax}_{x}$ | Custom operator with limits |
    1240 +    1143 +| **Complex nested delimiters** | $\left\langle\frac{\displaystyle\sum_{i=1}^{n}i}{\sqrt[3]{x^{2}+y^{2}}}\right\rangle$ | Deeply nested sizing |
    1241 +    1144 +| **Text with math and spaces** | $\text{if }x>0\text{ then }y=1$ | Mixed text/math |
    1242 +    1145 +| **Whole-block color** | See below | Color entire equation |
    1243 +    1146 +| **Custom tag** | See below | `\tag{}` with label |
    1244 +    1147 +
    1245 +    1148 +**Whole-block color test:**
    1246 +    1149 +
    1247 +    1150 +$$\color{magenta}{\int_{0}^{1}x^{2}\,dx = \frac{1}{3}}$$
    1248 +    1151 +
    1249 +    1152 +**Custom tag with reference:**
    1250 +    1153 +
    1251 +    1154 +\begin{equation}
    1252 +    1155 +E = mc^{2} \tag{Einstein}
    1253 +    1156 +\label{eq:einstein}
    1254 +    1157 +\end{equation}
    1255 +    1158 +
    1256 +    1159 +---
    1257 +    1160 +
    1258 +    1161 +### 7Ô∏è‚É£ Calculus & Analysis
    1259 +    1162 +
    1260 +    1163 +$$
    1261 +    1164 +\frac{d}{dx}\left( \int_{a}^{x} f(t)\,dt \right) = f(x)
    1262 +    1165 +$$
    1263 +    1166 +
    1264 +    1167 +$$
    1265 +    1168 +\nabla \times \vec{E} = -\frac{\partial \vec{B}}{\partial t}
    1266 +    1169 +$$
    1267 +    1170 +
    1268 +    1171 +$$
    1269 +    1172 +\int_{-\infty}^{\infty} e^{-x^2} dx = \sqrt{\pi}
    1270 +    1173 +$$
    1271 +    1174 +
    1272 +    1175 +$$
    1273 +    1176 +\oint_C \vec{F} \cdot d\vec{r} = \iint_S (\nabla \times \vec{F}) \cdot d\vec{S}
    1274 +    1177 +$$
    1275 +    1178 +
    1276 +    1179 +$$
    1277 +    1180 +\lim_{x \to 0} \frac{\sin x}{x} = 1
    1278 +    1181 +$$
    1279 +    1182 +
    1280 +    1183 +$$
    1281 +    1184 +\frac{\partial^2 u}{\partial t^2} = c^2 \nabla^2 u
    1282 +    1185 +$$
    1283 +    1186 +
    1284 +    1187 +---
    1285 +    1188 +
    1286 +    1189 +### 8Ô∏è‚É£ Continued Fractions
    1287 +    1190 +
    1288 +    1191 +$$
    1289 +    1192 +\cfrac{1}{1 + \cfrac{1}{1 + \cfrac{1}{1 + \cfrac{1}{1 + x}}}}
    1290 +    1193 +$$
    1291 +    1194 +
    1292 +    1195 +$$
    1293 +    1196 +\phi = 1 + \cfrac{1}{1 + \cfrac{1}{1 + \cfrac{1}{1 + \cdots}}}
    1294 +    1197 +$$
    1295 +    1198 +
    1296 +    1199 +---
    1297 +    1200 +
    1298 +    1201 +### 9Ô∏è‚É£ Special Functions and Symbols
    1299 +    1202 +
    1300 +    1203 +$$
    1301 +    1204 +\Gamma(n) = (n-1)! = \int_0^\infty t^{n-1}e^{-t}dt
    1302 +    1205 +$$
    1303 +    1206 +
    1304 +    1207 +$$
    1305 +    1208 +\mathcal{L}\{f(t)\} = \int_0^\infty f(t)e^{-st}dt = F(s)
    1306 +    1209 +$$
    1307 +    1210 +
    1308 +    1211 +$$
    1309 +    1212 +\mathcal{F}\{f(x)\} = \int_{-\infty}^{\infty} f(x)e^{-2\pi i \xi x}dx
    1310 +    1213 +$$
    1311 +    1214 +
    1312 +    1215 +$$
    1313 +    1216 +\forall x \in \mathbb{R}, \exists y \in \mathbb{N} : y > x
    1314 +    1217 +$$
    1315 +    1218 +
    1316 +    1219 +$$
    1317 +    1220 +\zeta(s) = \sum_{n=1}^{\infty} \frac{1}{n^s} = \prod_{p \text{ prime}} \frac{1}{1-p^{-s}}
    1318 +    1221 +$$
    1319 +    1222 +
    1320 +    1223 +---
    1321 +    1224 +
    1322 +    1225 +### üîü Math Inside Tables
    1323 +    1226 +
    1324 +    1227 +| Formula (inline) | Rendered Result |
    1325 +    1228 +|------------------|-----------------|
    1326 +    1229 +| `$a^2 + b^2 = c^2$` | $a^2 + b^2 = c^2$ |
    1327 +    1230 +| `$\displaystyle\int_0^1 x\,dx$` | $\displaystyle\int_0^1 x\,dx$ |
    1328 +    1231 +| `$\begin{cases}x>0\\x\le0\end{cases}$` | $\begin{cases}x>0\\x\le0\end{cases}$ |
    1329 +    1232 +| `$\frac{\partial^2 u}{\partial x^2} + \frac{\partial^2 u}{\partial y^2}=0$` | $\frac{\partial^2 u}{\partial x^2} + \frac{\partial^2 u}{\partial y^2}=0$ |
    1330 +    1233 +| `$\bigl(\begin{smallmatrix}a&b\\c&d\end{smallmatrix}\bigr)$` | $\bigl(\begin{smallmatrix}a&b\\c&d\end{smallmatrix}\bigr)$ |
    1331 +    1234 +
    1332 +    1235 +---
    1333 +    1236 +
    1334 +    1237 +### 1Ô∏è‚É£1Ô∏è‚É£ Footnote with Math
    1335 +    1238 +
    1336 +    1239 +> The series $\displaystyle\sum_{n=1}^{\infty}\frac{1}{n^{2}}$ converges to $\frac{\pi^{2}}{6}$[^mathfoot].
    1337 +    1240 +
    1338 +    1241 +[^mathfoot]: This is a footnote containing: $\zeta(2)=\sum_{n=1}^{\infty}\frac{1}{n^{2}}=\frac{\pi^{2}}{6}$
    1339 +    1242 +
    1340 +    1243 +---
    1341 +    1244 +
    1342 +    1245 +### 1Ô∏è‚É£2Ô∏è‚É£ Complex Physics Equations
    1343 +    1246 +
    1344 +    1247 +**Maxwell's Equations:**
    1345 +    1248 +
    1346 +    1249 +$$
    1347 +    1250 +\begin{aligned}
    1348 +    1251 +\nabla \cdot \vec{E} &= \frac{\rho}{\epsilon_0} \\
    1349 +    1252 +\nabla \cdot \vec{B} &= 0 \\
    1350 +    1253 +\nabla \times \vec{E} &= -\frac{\partial \vec{B}}{\partial t} \\
    1351 +    1254 +\nabla \times \vec{B} &= \mu_0\vec{J} + \mu_0\epsilon_0\frac{\partial \vec{E}}{\partial t}
    1352 +    1255 +\end{aligned}
    1353 +    1256 +$$
    1354 +    1257 +
    1355 +    1258 +**Schr√∂dinger Equation:**
    1356 +    1259 +
    1357 +    1260 +$$
    1358 +    1261 +i\hbar\frac{\partial}{\partial t}\Psi(\vec{r},t) = \left[-\frac{\hbar^2}{2m}\nabla^2 + V(\vec{r},t)\right]\Psi(\vec{r},t)
    1359 +    1262 +$$
    1360 +    1263 +
    1361 +    1264 +**Einstein Field Equations:**
    1362 +    1265 +
    1363 +    1266 +$$
    1364 +    1267 +R_{\mu\nu} - \frac{1}{2}Rg_{\mu\nu} + \Lambda g_{\mu\nu} = \frac{8\pi G}{c^4}T_{\mu\nu}
    1365 +    1268 +$$
    1366 +    1269 +
    1367 +    1270 +---
    1368 +    1271 +
    1369 +    1272 +### 1Ô∏è‚É£3Ô∏è‚É£ "All-in-One" Showcase
    1370 +    1273 +
    1371 +    1274 +$$
    1372 +    1275 +\boxed{
    1373 +    1276 +\begin{aligned}
    1374 +    1277 +\text{Solve }\;&\color{blue}{\underbrace{ax^{2}+bx+c}_{\text{quadratic}}=0} \\[4pt]
    1375 +    1278 +x &= \frac{-b\pm\sqrt{b^{2}-4ac}}{2a} \tag{Quadratic Formula}\\[6pt]
    1376 +    1279 +\text{Discriminant }&\Delta = b^{2}-4ac\\[6pt]
    1377 +    1280 +\text{Vertex }(h,k)&\text{ where }h=-\frac{b}{2a},\;k=-\frac{\Delta}{4a}\\[6pt]
    1378 +    1281 +\text{Nature of roots: }&\Delta\begin{cases}
    1379 +    1282 +>0 &\text{two distinct real roots}\\
    1380 +    1283 +=0 &\text{one real double root}\\
    1381 +    1284 +<0 &\text{two complex conjugates}
    1382 +    1285 +\end{cases}
    1383 +    1286 +\end{aligned}
    1384 +    1287 +}
    1385 +    1288 +$$
    1386 +    1289 +
    1387 +    1290 +---
    1388 +    1291 +
    1389 +    1292 +### 1Ô∏è‚É£4Ô∏è‚É£ Complex Math on Same Line
    1390 +    1293 +
    1391 +    1294 +The equation $\int_a^b f(x)dx = F(b) - F(a)$ shows that $\frac{d}{dx}F(x) = f(x)$ where $F$ is antiderivative of $f$.
    1392 +    1295 +
    1393 +    1296 +Physics: $\vec{F} = m\vec{a}$, $p = mv$, $KE = \frac{1}{2}mv^2$, $PE = mgh$, $\vec{L} = \vec{r} \times \vec{p}$
    1394 +    1297 +
    1395 +    1298 +Statistics: $\bar{x} = \frac{1}{n}\sum_{i=1}^n x_i$, $\sigma = \sqrt{\frac{1}{n}\sum(x_i - \bar{x})^2}$, $r = \frac{\sum(x_i-\bar{x})(y_i-\bar{y})}{\sqrt{\sum(x_i-\bar{x})^2\sum(y_i-\bar{y})^2}}$
    1396 +    1299 +
    1397 +    1300 +Probability: $P(A|B) = \frac{P(B|A)P(A)}{P(B)}$, $\mathbb{E}[X] = \sum_x x \cdot P(X=x)$, $\text{Var}(X) = \mathbb{E}[X^2] - (\mathbb{E}[X])^2$
    1398 +    1301 +
    1399 +    1302 +---
    1400 +    1303 +
    1401 +    1304 +## Tables
    1402 +    1305 +
    1403 +    1306 +### Basic Table
    1404 +    1307 +
    1405 +    1308 +| Header 1 | Header 2 | Header 3 |
    1406 +    1309 +|----------|----------|----------|
    1407 +    1310 +| Cell 1   | Cell 2   | Cell 3   |
    1408 +    1311 +| Cell 4   | Cell 5   | Cell 6   |
    1409 +    1312 +| Cell 7   | Cell 8   | Cell 9   |
    1410 +    1313 +
    1411 +    1314 +### Aligned Table
    1412 +    1315 +
    1413 +    1316 +| Left Aligned | Center Aligned | Right Aligned |
    1414 +    1317 +|:-------------|:--------------:|--------------:|
    1415 +    1318 +| Left         | Center         | Right         |
    1416 +    1319 +| Data         | Data           | Data          |
    1417 +    1320 +| More         | More           | More          |
    1418 +    1321 +
    1419 +    1322 +### Complex Table
    1420 +    1323 +
    1421 +    1324 +| Feature | Basic Plan | Pro Plan | Enterprise |
    1422 +    1325 +|:--------|:----------:|:--------:|:----------:|
    1423 +    1326 +| Users | 1 | 10 | Unlimited |
    1424 +    1327 +| Storage | 5 GB | 100 GB | 1 TB |
    1425 +    1328 +| Support | Email | Priority | 24/7 Phone |
    1426 +    1329 +| Price | Free | $9.99/mo | Custom |
    1427 +    1330 +| API Access | ‚ùå | ‚úÖ | ‚úÖ |
    1428 +    1331 +| Analytics | Basic | Advanced | Custom |
    1429 +    1332 +
    1430 +    1333 +### Table with Code and Formatting
    1431 +    1334 +
    1432 +    1335 +| Language | Hello World | File Extension |
    1433 +    1336 +|----------|-------------|----------------|
    1434 +    1337 +| Python | `print("Hello")` | `.py` |
    1435 +    1338 +| JavaScript | `console.log("Hello")` | `.js` |
    1436 +    1339 +| Java | `System.out.println("Hello")` | `.java` |
    1437 +    1340 +| C++ | `std::cout << "Hello"` | `.cpp` |
    1438 +    1341 +| **Rust** | `println!("Hello")` | `.rs` |
    1439 +    1342 +
    1440 +    1343 +---
    1441 +    1344 +
    1442 +    1345 +## Blockquotes
    1443 +    1346 +
    1444 +    1347 +> This is a simple blockquote.
    1445 +    1348 +
    1446 +    1349 +> This is a multi-line blockquote.
    1447 +    1350 +> It continues on this line.
    1448 +    1351 +> And this line too.
    1449 +    1352 +
    1450 +    1353 +> **Nested blockquote:**
    1451 +    1354 +>
    1452 +    1355 +> > This is nested inside.
    1453 +    1356 +> >
    1454 +    1357 +> > > And this is even deeper.
    1455 +    1358 +
    1456 +    1359 +> ### Blockquote with formatting
    1457 +    1360 +>
    1458 +    1361 +> This blockquote contains **bold**, *italic*, and `code`.
    1459 +    1362 +>
    1460 +    1363 +> - It can have lists
    1461 +    1364 +> - Multiple items
    1462 +    1365 +>
    1463 +    1366 +> ```python
    1464 +    1367 +> # Even code blocks
    1465 +    1368 +> print("Inside blockquote")
    1466 +    1369 +> ```
    1467 +    1370 +
    1468 +    1371 +---
    1469 +    1372 +
    1470 +    1373 +## Mermaid Diagrams
    1471 +    1374 +
    1472 +    1375 +### Flowchart (Top to Bottom)
    1473 +    1376 +
    1474 +    1377 +```mermaid
    1475 +    1378 +flowchart TB
    1476 +    1379 +    A[Start] --> B{Is it working?}
    1477 +    1380 +    B -->|Yes| C[Great!]
    1478 +    1381 +    B -->|No| D[Debug]
    1479 +    1382 +    D --> E[Fix the bug]
    1480 +    1383 +    E --> B
    1481 +    1384 +    C --> F[Deploy]
    1482 +    1385 +    F --> G[End]
    1483 +    1386 +```
    1484 +    1387 +
    1485 +    1388 +### Flowchart (Left to Right)
    1486 +    1389 +
    1487 +    1390 +```mermaid
    1488 +    1391 +flowchart LR
    1489 +    1392 +    A[Input] --> B[Process]
    1490 +    1393 +    B --> C{Valid?}
    1491 +    1394 +    C -->|Yes| D[Output]
    1492 +    1395 +    C -->|No| E[Error]
    1493 +    1396 +    E --> A
    1494 +    1397 +
    1495 +    1398 +    subgraph Processing
    1496 +    1399 +        B
    1497 +    1400 +        C
    1498 +    1401 +    end
    1499 +    1402 +```
    1500 +    1403 +
    1501 +    1404 +### Sequence Diagram
    1502 +    1405 +
    1503 +    1406 +```mermaid
    1504 +    1407 +sequenceDiagram
    1505 +    1408 +    autonumber
    1506 +    1409 +    participant U as User
    1507 +    1410 +    participant C as Client
    1508 +    1411 +    participant S as Server
    1509 +    1412 +    participant D as Database
    1510 +    1413 +
    1511 +    1414 +    U->>C: Click Login
    1512 +    1415 +    C->>S: POST /auth/login
    1513 +    1416 +    activate S
    1514 +    1417 +    S->>D: Query user
    1515 +    1418 +    D-->>S: User data
    1516 +    1419 +    S-->>C: JWT Token
    1517 +    1420 +    deactivate S
    1518 +    1421 +    C->>C: Store token
    1519 +    1422 +    C-->>U: Show dashboard
    1520 +    1423 +
    1521 +    1424 +    Note over U,C: User is now authenticated
    1522 +    1425 +
    1523 +    1426 +    U->>C: Request data
    1524 +    1427 +    C->>S: GET /api/data (with JWT)
    1525 +    1428 +    S->>S: Validate token
    1526 +    1429 +    S->>D: Fetch data
    1527 +    1430 +    D-->>S: Data
    1528 +    1431 +    S-->>C: JSON response
    1529 +    1432 +    C-->>U: Display data
    1530 +    1433 +```
    1531 +    1434 +
    1532 +    1435 +### Class Diagram
    1533 +    1436 +
    1534 +    1437 +```mermaid
    1535 +    1438 +classDiagram
    1536 +    1439 +    class Animal {
    1537 +    1440 +        +String name
    1538 +    1441 +        +int age
    1539 +    1442 +        +makeSound() void
    1540 +    1443 +        +move() void
    1541 +    1444 +    }
    1542 +    1445 +
    1543 +    1446 +    class Dog {
    1544 +    1447 +        +String breed
    1545 +    1448 +        +bark() void
    1546 +    1449 +        +fetch() void
    1547 +    1450 +    }
    1548 +    1451 +
    1549 +    1452 +    class Cat {
    1550 +    1453 +        +bool indoor
    1551 +    1454 +        +meow() void
    1552 +    1455 +        +scratch() void
    1553 +    1456 +    }
    1554 +    1457 +
    1555 +    1458 +    class Bird {
    1556 +    1459 +        +float wingspan
    1557 +    1460 +        +fly() void
    1558 +    1461 +        +sing() void
    1559 +    1462 +    }
    1560 +    1463 +
    1561 +    1464 +    Animal <|-- Dog
    1562 +    1465 +    Animal <|-- Cat
    1563 +    1466 +    Animal <|-- Bird
    1564 +    1467 +
    1565 +    1468 +    class Owner {
    1566 +    1469 +        +String name
    1567 +    1470 +        +List~Animal~ pets
    1568 +    1471 +        +adopt(Animal) void
    1569 +    1472 +    }
    1570 +    1473 +
    1571 +    1474 +    Owner "1" --> "*" Animal : owns
    1572 +    1475 +```
    1573 +    1476 +
    1574 +    1477 +### State Diagram
    1575 +    1478 +
    1576 +    1479 +```mermaid
    1577 +    1480 +stateDiagram-v2
    1578 +    1481 +    [*] --> Idle
    1579 +    1482 +
    1580 +    1483 +    Idle --> Processing : Submit
    1581 +    1484 +    Processing --> Success : Valid
    1582 +    1485 +    Processing --> Error : Invalid
    1583 +    1486 +
    1584 +    1487 +    Success --> Idle : Reset
    1585 +    1488 +    Error --> Idle : Retry
    1586 +    1489 +    Error --> [*] : Cancel
    1587 +    1490 +
    1588 +    1491 +    state Processing {
    1589 +    1492 +        [*] --> Validating
    1590 +    1493 +        Validating --> Saving : OK
    1591 +    1494 +        Saving --> [*]
    1592 +    1495 +    }
    1593 +    1496 +
    1594 +    1497 +    note right of Idle : Waiting for user input
    1595 +    1498 +    note left of Error : Display error message
    1596 +    1499 +```
    1597 +    1500 +
    1598 +    1501 +### Entity Relationship Diagram
    1599 +    1502 +
    1600 +    1503 +```mermaid
    1601 +    1504 +erDiagram
    1602 +    1505 +    CUSTOMER ||--o{ ORDER : places
    1603 +    1506 +    CUSTOMER {
    1604 +    1507 +        int id PK
    1605 +    1508 +        string name
    1606 +    1509 +        string email UK
    1607 +    1510 +        date created_at
    1608 +    1511 +    }
    1609 +    1512 +
    1610 +    1513 +    ORDER ||--|{ ORDER_ITEM : contains
    1611 +    1514 +    ORDER {
    1612 +    1515 +        int id PK
    1613 +    1516 +        int customer_id FK
    1614 +    1517 +        date order_date
    1615 +    1518 +        string status
    1616 +    1519 +        decimal total
    1617 +    1520 +    }
    1618 +    1521 +
    1619 +    1522 +    ORDER_ITEM }|--|| PRODUCT : references
    1620 +    1523 +    ORDER_ITEM {
    1621 +    1524 +        int id PK
    1622 +    1525 +        int order_id FK
    1623 +    1526 +        int product_id FK
    1624 +    1527 +        int quantity
    1625 +    1528 +        decimal price
    1626 +    1529 +    }
    1627 +    1530 +
    1628 +    1531 +    PRODUCT {
    1629 +    1532 +        int id PK
    1630 +    1533 +        string name
    1631 +    1534 +        string description
    1632 +    1535 +        decimal price
    1633 +    1536 +        int stock
    1634 +    1537 +    }
    1635 +    1538 +
    1636 +    1539 +    PRODUCT }o--|| CATEGORY : belongs_to
    1637 +    1540 +    CATEGORY {
    1638 +    1541 +        int id PK
    1639 +    1542 +        string name
    1640 +    1543 +        string description
    1641 +    1544 +    }
    1642 +    1545 +```
    1643 +    1546 +
    1644 +    1547 +### Gantt Chart
    1645 +    1548 +
    1646 +    1549 +```mermaid
    1647 +    1550 +gantt
    1648 +    1551 +    title Project Development Timeline
    1649 +    1552 +    dateFormat  YYYY-MM-DD
    1650 +    1553 +
    1651 +    1554 +    section Planning
    1652 +    1555 +    Requirements gathering    :a1, 2024-01-01, 14d
    1653 +    1556 +    System design            :a2, after a1, 10d
    1654 +    1557 +    Architecture review      :milestone, m1, after a2, 0d
    1655 +    1558 +
    1656 +    1559 +    section Development
    1657 +    1560 +    Backend development      :b1, after a2, 30d
    1658 +    1561 +    Frontend development     :b2, after a2, 25d
    1659 +    1562 +    API integration          :b3, after b1, 10d
    1660 +    1563 +
    1661 +    1564 +    section Testing
    1662 +    1565 +    Unit testing            :c1, after b1, 15d
    1663 +    1566 +    Integration testing     :c2, after b3, 10d
    1664 +    1567 +    UAT                     :c3, after c2, 7d
    1665 +    1568 +
    1666 +    1569 +    section Deployment
    1667 +    1570 +    Staging deployment      :d1, after c2, 3d
    1668 +    1571 +    Production deployment   :d2, after c3, 2d
    1669 +    1572 +    Go-live                 :milestone, m2, after d2, 0d
    1670 +    1573 +```
    1671 +    1574 +
    1672 +    1575 +### Pie Chart
    1673 +    1576 +
    1674 +    1577 +```mermaid
    1675 +    1578 +pie showData
    1676 +    1579 +    title Browser Market Share 2024
    1677 +    1580 +    "Chrome" : 65.7
    1678 +    1581 +    "Safari" : 18.2
    1679 +    1582 +    "Firefox" : 7.1
    1680 +    1583 +    "Edge" : 5.3
    1681 +    1584 +    "Other" : 3.7
    1682 +    1585 +```
    1683 +    1586 +
    1684 +    1587 +### Git Graph
    1685 +    1588 +
    1686 +    1589 +```mermaid
    1687 +    1590 +gitGraph
    1688 +    1591 +    commit id: "Initial"
    1689 +    1592 +    commit id: "Add README"
    1690 +    1593 +    branch develop
    1691 +    1594 +    checkout develop
    1692 +    1595 +    commit id: "Setup project"
    1693 +    1596 +    commit id: "Add tests"
    1694 +    1597 +    branch feature/auth
    1695 +    1598 +    checkout feature/auth
    1696 +    1599 +    commit id: "Add login"
    1697 +    1600 +    commit id: "Add signup"
    1698 +    1601 +    checkout develop
    1699 +    1602 +    merge feature/auth id: "Merge auth"
    1700 +    1603 +    branch feature/api
    1701 +    1604 +    checkout feature/api
    1702 +    1605 +    commit id: "REST endpoints"
    1703 +    1606 +    checkout develop
    1704 +    1607 +    merge feature/api id: "Merge API"
    1705 +    1608 +    checkout main
    1706 +    1609 +    merge develop id: "Release v1.0" tag: "v1.0.0"
    1707 +    1610 +    commit id: "Hotfix"
    1708 +    1611 +```
    1709 +    1612 +
    1710 +    1613 +### User Journey
    1711 +    1614 +
    1712 +    1615 +```mermaid
    1713 +    1616 +journey
    1714 +    1617 +    title User Shopping Experience
    1715 +    1618 +    section Discovery
    1716 +    1619 +      Browse homepage: 5: User
    1717 +    1620 +      Search for product: 4: User
    1718 +    1621 +      View search results: 4: User
    1719 +    1622 +    section Evaluation
    1720 +    1623 +      View product details: 5: User
    1721 +    1624 +      Read reviews: 4: User
    1722 +    1625 +      Compare prices: 3: User
    1723 +    1626 +    section Purchase
    1724 +    1627 +      Add to cart: 5: User
    1725 +    1628 +      Checkout: 3: User
    1726 +    1629 +      Payment: 2: User
    1727 +    1630 +      Confirmation: 5: User
    1728 +    1631 +    section Post-Purchase
    1729 +    1632 +      Track order: 4: User
    1730 +    1633 +      Receive product: 5: User
    1731 +    1634 +      Leave review: 3: User
    1732 +    1635 +```
    1733 +    1636 +
    1734 +    1637 +### Mindmap
    1735 +    1638 +
    1736 +    1639 +```mermaid
    1737 +    1640 +mindmap
    1738 +    1641 +  root((Project Management))
    1739 +    1642 +    Planning
    1740 +    1643 +      Requirements
    1741 +    1644 +      Timeline
    1742 +    1645 +      Resources
    1743 +    1646 +      Budget
    1744 +    1647 +    Execution
    1745 +    1648 +      Development
    1746 +    1649 +        Frontend
    1747 +    1650 +        Backend
    1748 +    1651 +        Database
    1749 +    1652 +      Testing
    1750 +    1653 +        Unit Tests
    1751 +    1654 +        Integration
    1752 +    1655 +        UAT
    1753 +    1656 +    Monitoring
    1754 +    1657 +      Progress Tracking
    1755 +    1658 +      Risk Management
    1756 +    1659 +      Quality Control
    1757 +    1660 +    Closure
    1758 +    1661 +      Documentation
    1759 +    1662 +      Deployment
    1760 +    1663 +      Retrospective
    1761 +    1664 +```
    1762 +    1665 +
    1763 +    1666 +### Timeline
    1764 +    1667 +
    1765 +    1668 +```mermaid
    1766 +    1669 +timeline
    1767 +    1670 +    title History of Web Development
    1768 +    1671 +    section 1990s
    1769 +    1672 +        1991 : First website created
    1770 +    1673 +        1994 : Netscape Navigator
    1771 +    1674 +        1995 : JavaScript invented
    1772 +    1675 +        1996 : CSS introduced
    1773 +    1676 +    section 2000s
    1774 +    1677 +        2004 : Web 2.0 era begins
    1775 +    1678 +        2006 : jQuery released
    1776 +    1679 +        2008 : Chrome browser
    1777 +    1680 +    section 2010s
    1778 +    1681 +        2010 : AngularJS
    1779 +    1682 +        2013 : React released
    1780 +    1683 +        2014 : Vue.js created
    1781 +    1684 +        2015 : ES6/ES2015
    1782 +    1685 +    section 2020s
    1783 +    1686 +        2020 : Deno released
    1784 +    1687 +        2022 : React 18
    1785 +    1688 +        2023 : AI integration
    1786 +    1689 +```
    1787 +    1690 +
    1788 +    1691 +### Quadrant Chart
    1789 +    1692 +
    1790 +    1693 +```mermaid
    1791 +    1694 +quadrantChart
    1792 +    1695 +    title Technology Evaluation Matrix
    1793 +    1696 +    x-axis Low Complexity --> High Complexity
    1794 +    1697 +    y-axis Low Value --> High Value
    1795 +    1698 +    quadrant-1 Invest heavily
    1796 +    1699 +    quadrant-2 Maintain
    1797 +    1700 +    quadrant-3 Reconsider
    1798 +    1701 +    quadrant-4 Optimize
    1799 +    1702 +    React: [0.8, 0.9]
    1800 +    1703 +    Vue: [0.5, 0.75]
    1801 +    1704 +    Angular: [0.85, 0.7]
    1802 +    1705 +    jQuery: [0.3, 0.3]
    1803 +    1706 +    Svelte: [0.4, 0.6]
    1804 +    1707 +    Next.js: [0.7, 0.85]
    1805 +    1708 +```
    1806 +    1709 +
    1807 +    1710 +### Requirement Diagram
    1808 +    1711 +
    1809 +    1712 +```mermaid
    1810 +    1713 +requirementDiagram
    1811 +    1714 +    requirement user_auth {
    1812 +    1715 +        id: REQ-001
    1813 +    1716 +        text: System shall authenticate users
    1814 +    1717 +        risk: high
    1815 +    1718 +        verifymethod: test
    1816 +    1719 +    }
    1817 +    1720 +
    1818 +    1721 +    requirement password_policy {
    1819 +    1722 +        id: REQ-002
    1820 +    1723 +        text: Passwords must be 8+ characters
    1821 +    1724 +        risk: medium
    1822 +    1725 +        verifymethod: inspection
    1823 +    1726 +    }
    1824 +    1727 +
    1825 +    1728 +    element auth_module {
    1826 +    1729 +        type: module
    1827 +    1730 +    }
    1828 +    1731 +
    1829 +    1732 +    element password_validator {
    1830 +    1733 +        type: function
    1831 +    1734 +    }
    1832 +    1735 +
    1833 +    1736 +    auth_module - satisfies -> user_auth
    1834 +    1737 +    password_validator - satisfies -> password_policy
    1835 +    1738 +    user_auth - contains -> password_policy
    1836 +    1739 +```
    1837 +    1740 +
    1838 +    1741 +### C4 Diagram (Context)
    1839 +    1742 +
    1840 +    1743 +```mermaid
    1841 +    1744 +C4Context
    1842 +    1745 +    title System Context Diagram
    1843 +    1746 +
    1844 +    1747 +    Person(user, "User", "A user of the system")
    1845 +    1748 +    System(system, "E-Commerce System", "Allows users to browse and purchase products")
    1846 +    1749 +    System_Ext(payment, "Payment Gateway", "Handles payment processing")
    1847 +    1750 +    System_Ext(email, "Email Service", "Sends notifications")
    1848 +    1751 +
    1849 +    1752 +    Rel(user, system, "Uses")
    1850 +    1753 +    Rel(system, payment, "Processes payments")
    1851 +    1754 +    Rel(system, email, "Sends emails")
    1852 +    1755 +```
    1853 +    1756 +
    1854 +    1757 +### XY Chart
    1855 +    1758 +
    1856 +    1759 +```mermaid
    1857 +    1760 +xychart-beta
    1858 +    1761 +    title "Sales Revenue Over Time"
    1859 +    1762 +    x-axis [Jan, Feb, Mar, Apr, May, Jun, Jul, Aug, Sep, Oct, Nov, Dec]
    1860 +    1763 +    y-axis "Revenue (in $1000)" 0 --> 150
    1861 +    1764 +    bar [52, 58, 63, 71, 82, 89, 97, 105, 112, 120, 135, 145]
    1862 +    1765 +    line [50, 55, 60, 68, 78, 85, 92, 100, 108, 115, 128, 140]
    1863 +    1766 +```
    1864 +    1767 +
    1865 +    1768 +### Block Diagram
    1866 +    1769 +
    1867 +    1770 +```mermaid
    1868 +    1771 +block-beta
    1869 +    1772 +    columns 3
    1870 +    1773 +
    1871 +    1774 +    Frontend:3
    1872 +    1775 +    block:client
    1873 +    1776 +        A["React App"]
    1874 +    1777 +        B["Mobile App"]
    1875 +    1778 +    end
    1876 +    1779 +
    1877 +    1780 +    space
    1878 +    1781 +
    1879 +    1782 +    API["API Gateway"]:3
    1880 +    1783 +
    1881 +    1784 +    block:services:3
    1882 +    1785 +        C["Auth Service"]
    1883 +    1786 +        D["Product Service"]
    1884 +    1787 +        E["Order Service"]
    1885 +    1788 +    end
    1886 +    1789 +
    1887 +    1790 +    block:data:3
    1888 +    1791 +        F[("PostgreSQL")]
    1889 +    1792 +        G[("Redis")]
    1890 +    1793 +        H[("S3")]
    1891 +    1794 +    end
    1892 +    1795 +```
    1893 +    1796 +
    1894 +    1797 +### Sankey Diagram
    1895 +    1798 +
    1896 +    1799 +```mermaid
    1897 +    1800 +sankey-beta
    1898 +    1801 +    %% Energy flow diagram
    1899 +    1802 +    Solar,Electricity,100
    1900 +    1803 +    Wind,Electricity,80
    1901 +    1804 +    Coal,Electricity,50
    1902 +    1805 +    Electricity,Residential,120
    1903 +    1806 +    Electricity,Commercial,70
    1904 +    1807 +    Electricity,Industrial,40
    1905 +    1808 +```
    1906 +    1809 +
    1907 +    1810 +---
    1908 +    1811 +
    1909 +    1812 +## Miscellaneous
    1910 +    1813 +
    1911 +    1814 +### Horizontal Rules
    1912 +    1815 +
    1913 +    1816 +Three hyphens:
    1914 +    1817 +
    1915 +    1818 +---
    1916 +    1819 +
    1917 +    1820 +Three asterisks:
    1918 +    1821 +
    1919 +    1822 +***
    1920 +    1823 +
    1921 +    1824 +Three underscores:
    1922 +    1825 +
    1923 +    1826 +___
    1924 +    1827 +
    1925 +    1828 +### Footnotes
    1926 +    1829 +
    1927 +    1830 +Here's a sentence with a footnote.[^1]
    1928 +    1831 +
    1929 +    1832 +Another sentence with a different footnote.[^2]
    1930 +    1833 +
    1931 +    1834 +Here's one with a longer identifier.[^bignote]
    1932 +    1835 +
    1933 +    1836 +[^1]: This is the first footnote.
    1934 +    1837 +
    1935 +    1838 +[^2]: This is the second footnote.
    1936 +    1839 +
    1937 +    1840 +[^bignote]: This is a longer footnote with multiple paragraphs.
    1938 +    1841 +
    1939 +    1842 +    Indent paragraphs to include them in the footnote.
    1940 +    1843 +
    1941 +    1844 +    `{ code }` can be included too.
    1942 +    1845 +
    1943 +    1846 +### Abbreviations (if supported)
    1944 +    1847 +
    1945 +    1848 +The HTML specification is maintained by the W3C.
    1946 +    1849 +
    1947 +    1850 +*[HTML]: Hyper Text Markup Language
    1948 +    1851 +*[W3C]: World Wide Web Consortium
    1949 +    1852 +
    1950 +    1853 +### Keyboard Keys (HTML)
    1951 +    1854 +
    1952 +    1855 +Press <kbd>Ctrl</kbd> + <kbd>C</kbd> to copy.
    1953 +    1856 +
    1954 +    1857 +Press <kbd>Cmd</kbd> + <kbd>Shift</kbd> + <kbd>P</kbd> to open command palette.
    1955 +    1858 +
    1956 +    1859 +### Details/Summary (Collapsible)
    1957 +    1860 +
    1958 +    1861 +<details>
    1959 +    1862 +<summary>Click to expand!</summary>
    1960 +    1863 +
    1961 +    1864 +This is hidden content that appears when you click the summary.
    1962 +    1865 +
    1963 +    1866 +- Item 1
    1964 +    1867 +- Item 2
    1965 +    1868 +- Item 3
    1966 +    1869 +
    1967 +    1870 +```python
    1968 +    1871 +print("Hidden code!")
    1969 +    1872 +```
    1970 +    1873 +
    1971 +    1874 +</details>
    1972 +    1875 +
    1973 +    1876 +<details open>
    1974 +    1877 +<summary>This is open by default</summary>
    1975 +    1878 +
    1976 +    1879 +This content is visible by default but can be collapsed.
    1977 +    1880 +
    1978 +    1881 +</details>
    1979 +    1882 +
    1980 +    1883 +### Comments (Not Rendered)
    1981 +    1884 +
    1982 +    1885 +[//]: # (This is a comment and won't be rendered)
    1983 +    1886 +
    1984 +    1887 +[comment]: <> (Another comment style)
    1985 +    1888 +
    1986 +    1889 +<!-- HTML comment style -->
    1987 +    1890 +
    1988 +    1891 +### Escape Characters
    1989 +    1892 +
    1990 +    1893 +\*Not italic\*
    1991 +    1894 +
    1992 +    1895 +\*\*Not bold\*\*
    1993 +    1896 +
    1994 +    1897 +\# Not a header
    1995 +    1898 +
    1996 +    1899 +\[Not a link\]
    1997 +    1900 +
    1998 +    1901 +\`Not code\`
    1999 +    1902 +
    2000 +    1903 +### Emojis (if supported)
    2001 +    1904 +
    2002 +    1905 +:smile: :heart: :thumbsup: :rocket: :star: :fire: :tada:
    2003 +    1906 +
    2004 +    1907 +Unicode emojis: üòÄ ‚ù§Ô∏è üëç üöÄ ‚≠ê üî• üéâ
    2005 +    1908 +
    2006 +    1909 +### Special Characters
    2007 +    1910 +
    2008 +    1911 +Copyright: ¬© | Registered: ¬Æ | Trademark: ‚Ñ¢
    2009 +    1912 +
    2010 +    1913 +Arrows: ‚Üí ‚Üê ‚Üë ‚Üì ‚Üî ‚áí ‚áê
    2011 +    1914 +
    2012 +    1915 +Math symbols: ¬± √ó √∑ ‚â† ‚âà ‚â§ ‚â• ‚àû ‚àë ‚àè ‚àö
    2013 +    1916 +
    2014 +    1917 +Currency: $ ‚Ç¨ ¬£ ¬• ‚Çπ ‚Çø
    2015 +    1918 +
    2016 +    1919 +### Anchor Links
    2017 +    1920 +
    2018 +    1921 +<a name="custom-anchor"></a>
    2019 +    1922 +
    2020 +    1923 +[Jump to custom anchor](#custom-anchor)
    2021 +    1924 +
    2022 +    1925 +[Jump to top](#markdown-rendering-test-document)
    2023 +    1926 +
    2024 +    1927 +### Raw HTML Block
    2025 +    1928 +
    2026 +    1929 +<div style="background: linear-gradient(to right, #667eea, #764ba2); padding: 20px; border-radius: 10px; color: white;">
    2027 +    1930 +    <h3 style="margin: 0;">Custom HTML Block</h3>
    2028 +    1931 +    <p>This is a custom styled div using raw HTML.</p>
    2029 +    1932 +    <button onclick="alert('Hello!')">Click me</button>
    2030 +    1933 +</div>
    2031 +    1934 +
    2032 +    1935 +### Embedded Video (HTML)
    2033 +    1936 +
    2034 +    1937 +<video width="320" height="240" controls>
    2035 +    1938 +    <source src="movie.mp4" type="video/mp4">
    2036 +    1939 +    Your browser does not support the video tag.
    2037 +    1940 +</video>
    2038 +    1941 +
    2039 +    1942 +### iFrame Embed
    2040 +    1943 +
    2041 +    1944 +<iframe width="560" height="315" src="https://www.youtube.com/embed/dQw4w9WgXcQ" frameborder="0" allowfullscreen></iframe>
    2042 +    1945 +
    2043 +    1946 +### Audio Embed
    2044 +    1947 +
    2045 +    1948 +<audio controls>
    2046 +    1949 +    <source src="audio.mp3" type="audio/mpeg">
    2047 +    1950 +    Your browser does not support the audio element.
    2048 +    1951 +</audio>
    2049 +    1952 +
    2050 +    1953 +### Progress Bar (HTML)
    2051 +    1954 +
    2052 +    1955 +<progress value="70" max="100">70%</progress>
    2053 +    1956 +
    2054 +    1957 +### Meter (HTML)
    2055 +    1958 +
    2056 +    1959 +<meter value="0.7" min="0" max="1">70%</meter>
    2057 +    1960 +
    2058 +    1961 +### Color Input Display
    2059 +    1962 +
    2060 +    1963 +<input type="color" value="#3498db"> Primary Color
    2061 +    1964 +<input type="color" value="#2ecc71"> Secondary Color
    2062 +    1965 +
    2063 +    1966 +---
    2064 +    1967 +
    2065 +    1968 +## End of Test Document
    2066 +    1969 +
    2067 +    1970 +This document covers all major markdown features including:
    2068 +    1971 +
    2069 +    1972 +- ‚úÖ Headers (H1-H6)
    2070 +    1973 +- ‚úÖ Text formatting (bold, italic, strikethrough, etc.)
    2071 +    1974 +- ‚úÖ Lists (ordered, unordered, nested, task lists)
    2072 +    1975 +- ‚úÖ Links and images
    2073 +    1976 +- ‚úÖ Code blocks (15+ languages)
    2074 +    1977 +- ‚úÖ **Comprehensive Math/LaTeX (40+ edge cases)**
    2075 +    1978 +  - Inline math (subscripts, superscripts, fractions, fonts, accents, vectors, braces, colors)
    2076 +    1979 +  - Display environments (align, gather, multline, split, cases, array)
    2077 +    1980 +  - All matrix types (pmatrix, bmatrix, vmatrix, Vmatrix, Bmatrix, smallmatrix)
    2078 +    1981 +  - Delimiter sizing (auto and manual: \big, \Big, \bigg, \Bigg)
    2079 +    1982 +  - Advanced symbols (logic, set theory, calculus, physics)
    2080 +    1983 +  - Edge cases (phantom, smash, boxed, custom tags, colors, nested delimiters)
    2081 +    1984 +  - Physics equations (Maxwell, Schr√∂dinger, Einstein field equations)
    2082 +    1985 +- ‚úÖ Tables (basic and complex)
    2083 +    1986 +- ‚úÖ Blockquotes (nested)
    2084 +    1987 +- ‚úÖ Mermaid diagrams (15+ types)
    2085 +    1988 +- ‚úÖ Footnotes (including with math)
    2086 +    1989 +- ‚úÖ HTML elements
    2087 +    1990 +- ‚úÖ Keyboard keys
    2088 +    1991 +- ‚úÖ Collapsible sections
    2089 +    1992 +- ‚úÖ Special characters and emojis
    2090 +    1993 +- ‚úÖ And more!
    2091 +    1994 +
    2092 +    1995 +---
    2093 +    1996 +
    2094 +    1997 +*Document generated for comprehensive markdown rendering testing purposes.*
    2095 +    1998  
13767 2096  
13768 2097  ```
13769 2098  
@@ -13809,4 +2138,4 @@ Please provide specific feedback on:
13809 2138  
13810 2139  ---
13811 2140  *Generated by AI Visual Code Review v2.0 - Unified Export Script*
13812     -*Files processed: 6/6 | Errors: 0 | Generated: 2025-12-09T01:41:21.353Z*
    2141 +*Files processed: 2/2 | Errors: 0 | Generated: 2025-12-09T01:50:29.002Z*
13813 2142  

```


### üìÑ `script.js`

**Type:** JavaScript Source File üü®

```diff
@@ -13,13 +13,18 @@ import 'prismjs/components/prism-bash';
 13  13  import 'prismjs/components/prism-c';
 14  14  import 'prismjs/components/prism-cpp';
 15  15  import 'prismjs/components/prism-css';
     16 +import 'prismjs/components/prism-go';
 16  17  import 'prismjs/components/prism-java';
 17  18  import 'prismjs/components/prism-javascript';
 18  19  import 'prismjs/components/prism-json';
 19  20  import 'prismjs/components/prism-markdown';
 20  21  import 'prismjs/components/prism-python';
     22 +import 'prismjs/components/prism-r';
     23 +import 'prismjs/components/prism-rust';
     24 +import 'prismjs/components/prism-scss';
 21  25  import 'prismjs/components/prism-sql';
 22  26  import 'prismjs/components/prism-typescript';
     27 +import 'prismjs/components/prism-yaml';
 23  28  import 'prismjs/themes/prism-tomorrow.css'; // Import Prism CSS
 24  29  
 25  30  import { StorageManager } from './src/js/core/StorageManager.js';
@@ -180,6 +185,7 @@ function configureMarkedExtensions() {
180 185                  displayMode: true,
181 186                  throwOnError: false,
182 187                  output: 'html',
    188 +                trust: true, // Allow custom styling
183 189                }) +
184 190                '</div>'
185 191              );
@@ -189,6 +195,40 @@ function configureMarkedExtensions() {
189 195            }
190 196          },
191 197        },
    198 +      {
    199 +        name: 'mathEnvironment',
    200 +        level: 'block',
    201 +        start(src) {
    202 +          return src.match(/^\\begin/)?.index;
    203 +        },
    204 +        tokenizer(src) {
    205 +          const match = src.match(/^(\\begin\{([a-zA-Z]+\*?)\}([\s\S]*?)\\end\{\2\})/);
    206 +          if (match) {
    207 +            return {
    208 +              type: 'mathEnvironment',
    209 +              raw: match[0],
    210 +              text: match[1], // Capture the inner content or full block? KaTeX needs full block for environments
    211 +            };
    212 +          }
    213 +        },
    214 +        renderer(token) {
    215 +          try {
    216 +            return (
    217 +              '<div style="margin: 1.5em 0;">' +
    218 +              katex.renderToString(token.text, {
    219 +                displayMode: true,
    220 +                throwOnError: false,
    221 +                output: 'html',
    222 +                trust: true,
    223 +              }) +
    224 +              '</div>'
    225 +            );
    226 +          } catch (e) {
    227 +            console.warn('KaTeX environment error:', e);
    228 +            return `<div style="color: red;">LaTeX Error: ${e.message}</div>`;
    229 +          }
    230 +        },
    231 +      },
192 232        {
193 233          name: 'mathInline',
194 234          level: 'inline',
195 235  

```

---

## ü§ñ AI Review Checklist

Please review these changes for:

### üîç Code Quality
- [ ] **Linting Compliance**: No unused imports/variables, proper formatting
- [ ] **Type Safety**: Proper typing throughout (TypeScript/Python type hints)
- [ ] **Best Practices**: Framework-specific conventions and patterns
- [ ] **Performance**: Efficient algorithms, proper memoization
- [ ] **Documentation**: Clear comments and function descriptions

### üêõ Potential Issues
- [ ] **Runtime Errors**: Type mismatches, null/undefined handling
- [ ] **Logic Bugs**: Incorrect calculations, edge cases
- [ ] **Memory Leaks**: Cleanup in lifecycle methods, event listeners
- [ ] **Error Handling**: Proper try-catch blocks, user feedback
- [ ] **Accessibility**: ARIA labels, keyboard navigation, screen readers

### üîí Security & Data
- [ ] **Input Validation**: Sanitization, XSS prevention, SQL injection
- [ ] **Authentication**: Proper access controls and permissions
- [ ] **Privacy**: No sensitive data exposure in logs/client
- [ ] **Dependencies**: Updated packages, vulnerability checks

### üì± UX/UI
- [ ] **Responsive Design**: Mobile/desktop/tablet compatibility
- [ ] **Loading States**: Proper feedback during async operations
- [ ] **Error Messages**: User-friendly error handling and recovery
- [ ] **Performance**: Fast loading, smooth animations

### üí° Suggestions & Improvements
Please provide specific feedback on:
1. Code organization and structure improvements
2. Performance optimization opportunities
3. Security considerations and hardening
4. Testing coverage and strategies
5. Documentation and maintainability

---
*Generated by AI Visual Code Review v2.0 - Unified Export Script*
*Files processed: 2/2 | Errors: 0 | Generated: 2025-12-09T01:56:34.125Z*
